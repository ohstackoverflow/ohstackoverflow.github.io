<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 2246) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-2246.html">
<link rel="prev" href="index-2247.html" type="text/html">
<link rel="next" href="index-2245.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/get-all-directories-within-directory-nodejs/" class="u-url">Get all directories within directory nodejs</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/get-all-directories-within-directory-nodejs/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T01:52:36+08:00" itemprop="datePublished" title="2023-03-04 01:52">2023-03-04 01:52</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I was hoping this would be a simple thing, but I cannot find anything out
there to do so.</p>
<p>I just want to get all folders/directories within a given folder/directory.</p>
<p>So for example:</p>
<div class="code"><pre class="code literal-block">&lt;MyFolder&gt;
|- SomeFolder
|- SomeOtherFolder
|- SomeFile.txt
|- SomeOtherFile.txt
|- x-directory
</pre></div>

<p>I would expect to get an array of:</p>
<div class="code"><pre class="code literal-block">["SomeFolder", "SomeOtherFolder", "x-directory"]
</pre></div>

<p>Or the above with the path if that was how it was served...</p>
<p>So does anything already exist to do the above?</p>
<p><br><br></p>
<h2>Answer</h2>
<p><strong>Promise</strong></p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="p">{</span> <span class="n">readdir</span> <span class="p">}</span> <span class="kn">from</span> <span class="s1">'fs/promises'</span>

<span class="n">const</span> <span class="n">getDirectories</span> <span class="o">=</span> <span class="k">async</span> <span class="n">source</span> <span class="o">=&gt;</span>
  <span class="p">(</span><span class="k">await</span> <span class="n">readdir</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="p">{</span> <span class="n">withFileTypes</span><span class="p">:</span> <span class="n">true</span> <span class="p">}))</span>
    <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">dirent</span> <span class="o">=&gt;</span> <span class="n">dirent</span><span class="o">.</span><span class="n">isDirectory</span><span class="p">())</span>
    <span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">dirent</span> <span class="o">=&gt;</span> <span class="n">dirent</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</pre></div>

<p><strong>Callback</strong></p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="p">{</span> <span class="n">readdir</span> <span class="p">}</span> <span class="kn">from</span> <span class="s1">'fs'</span>

<span class="n">const</span> <span class="n">getDirectories</span> <span class="o">=</span> <span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span> <span class="o">=&gt;</span>
  <span class="n">readdir</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="p">{</span> <span class="n">withFileTypes</span><span class="p">:</span> <span class="n">true</span> <span class="p">},</span> <span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">files</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">callback</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="n">callback</span><span class="p">(</span>
        <span class="n">files</span>
          <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">dirent</span> <span class="o">=&gt;</span> <span class="n">dirent</span><span class="o">.</span><span class="n">isDirectory</span><span class="p">())</span>
          <span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">dirent</span> <span class="o">=&gt;</span> <span class="n">dirent</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
      <span class="p">)</span>
    <span class="p">}</span>
  <span class="p">})</span>
</pre></div>

<p><strong>Syncronous</strong></p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="p">{</span> <span class="n">readdirSync</span> <span class="p">}</span> <span class="kn">from</span> <span class="s1">'fs'</span>

<span class="n">const</span> <span class="n">getDirectories</span> <span class="o">=</span> <span class="n">source</span> <span class="o">=&gt;</span>
  <span class="n">readdirSync</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="p">{</span> <span class="n">withFileTypes</span><span class="p">:</span> <span class="n">true</span> <span class="p">})</span>
    <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">dirent</span> <span class="o">=&gt;</span> <span class="n">dirent</span><span class="o">.</span><span class="n">isDirectory</span><span class="p">())</span>
    <span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">dirent</span> <span class="o">=&gt;</span> <span class="n">dirent</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>List directories using a path.</p>
<div class="code"><pre class="code literal-block"><span class="nv">function</span><span class="w"> </span><span class="nv">getDirectories</span><span class="ss">(</span><span class="nv">path</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nv">fs</span>.<span class="nv">readdirSync</span><span class="ss">(</span><span class="nv">path</span><span class="ss">)</span>.<span class="nv">filter</span><span class="ss">(</span><span class="nv">function</span><span class="w"> </span><span class="ss">(</span><span class="nv">file</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nv">fs</span>.<span class="nv">statSync</span><span class="ss">(</span><span class="nv">path</span><span class="o">+</span><span class="s1">'/'</span><span class="o">+</span><span class="nv">file</span><span class="ss">)</span>.<span class="nv">isDirectory</span><span class="ss">()</span><span class="c1">;</span>
<span class="w">  </span>}<span class="ss">)</span><span class="c1">;</span>
}
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-can-i-install-an-older-version-of-a-package-via-nuget/" class="u-url">How can I install an older version of a package via NuGet?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-can-i-install-an-older-version-of-a-package-via-nuget/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T01:51:20+08:00" itemprop="datePublished" title="2023-03-04 01:51">2023-03-04 01:51</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I want to install an older version of a package (<code>Newtonsoft.Json</code>). But NuGet
rolls back:</p>
<div class="code"><pre class="code literal-block">PM&gt; Install-Package Newtonsoft.Json -Version 4.0.5
Successfully installed 'Newtonsoft.Json 4.0.5'.
Install failed. Rolling back...
Install-Package : Already referencing a newer version of 'Newtonsoft.Json'.
</pre></div>

<p>How can I do it?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Try the following:</p>
<div class="code"><pre class="code literal-block">Uninstall-Package Newtonsoft.Json -Force
</pre></div>

<p>Followed by:</p>
<div class="code"><pre class="code literal-block"><span class="nv">Install</span><span class="o">-</span><span class="nv">Package</span><span class="w"> </span><span class="nv">Newtonsoft</span>.<span class="nv">Json</span><span class="w"> </span><span class="o">-</span><span class="nv">Version</span><span class="w"> </span><span class="o">&lt;</span><span class="nv">press</span><span class="w"> </span><span class="nv">tab</span><span class="w"> </span><span class="nv">key</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">autocomplete</span><span class="o">&gt;</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>As of <strong>NuGet 2.8</strong> , there is a feature to <strong>downgrade</strong> a package.</p>
<p>NuGet 2.8 Release Notes</p>
<p>Example:</p>
<p>The following command entered into the Package Manager Console will downgrade
the Couchbase client to version 1.3.1.0.</p>
<div class="code"><pre class="code literal-block">Update-Package CouchbaseNetClient -Version 1.3.1.0
</pre></div>

<p>Result:</p>
<div class="code"><pre class="code literal-block"><span class="n">Updating</span><span class="w"> </span><span class="err">'</span><span class="n">CouchbaseNetClient</span><span class="err">'</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="err">'</span><span class="mf">1.3.3</span><span class="err">'</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="err">'</span><span class="mf">1.3.1.0</span><span class="err">'</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">project</span><span class="w"> </span><span class="p">[</span><span class="n">project</span><span class="w"> </span><span class="n">name</span><span class="p">].</span>
<span class="n">Removing</span><span class="w"> </span><span class="err">'</span><span class="n">CouchbaseNetClient</span><span class="w"> </span><span class="mf">1.3.3</span><span class="err">'</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="p">[</span><span class="n">project</span><span class="w"> </span><span class="n">name</span><span class="p">].</span>
<span class="n">Successfully</span><span class="w"> </span><span class="n">removed</span><span class="w"> </span><span class="err">'</span><span class="n">CouchbaseNetClient</span><span class="w"> </span><span class="mf">1.3.3</span><span class="err">'</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="p">[</span><span class="n">project</span><span class="w"> </span><span class="n">name</span><span class="p">].</span>
</pre></div>

<p><strong>Something to note as per crimbo below:</strong></p>
<blockquote>
<p><em>This approach doesn't work for downgrading from one prerelease version to
other prerelease version - it only works for downgrading to a release
version</em></p>
</blockquote>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-do-i-generate-a-random-number-for-each-row-in-a-t-sql-select/" class="u-url">How do I generate a random number for each row in a T-SQL select?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-do-i-generate-a-random-number-for-each-row-in-a-t-sql-select/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T01:49:55+08:00" itemprop="datePublished" title="2023-03-04 01:49">2023-03-04 01:49</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I need a different random number for each row in my table. The following
seemingly obvious code uses the same random value for each row.</p>
<div class="code"><pre class="code literal-block">SELECT table_name, RAND() magic_number 
FROM information_schema.tables
</pre></div>

<p>I'd like to get an INT or a FLOAT out of this. The rest of the story is I'm
going to use this random number to create a random date offset from a known
date, e.g. 1-14 days offset from a start date.</p>
<p>This is for Microsoft SQL Server 2000.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Take a look at SQL Server - Set based random numbers which has a very detailed
explanation.</p>
<p>To summarize, the following code generates a random number between 0 and 13
inclusive with a uniform distribution:</p>
<div class="code"><pre class="code literal-block">ABS(CHECKSUM(NewId())) % 14
</pre></div>

<p>To change your range, just change the number at the end of the expression. Be
extra careful if you need a range that includes both positive and negative
numbers. If you do it wrong, it's possible to double-count the number 0.</p>
<p>A small warning for the math nuts in the room: there is a very slight bias in
this code. <code>CHECKSUM()</code> results in numbers that are uniform across the entire
range of the sql Int datatype, or at least as near so as my (the editor)
testing can show. However, there will be some bias when CHECKSUM() produces a
number at the very top end of that range. Any time you get a number between
the maximum possible integer and the last exact multiple of the size of your
desired range (14 in this case) before that maximum integer, those results are
favored over the remaining portion of your range that cannot be produced from
that last multiple of 14.</p>
<p>As an example, imagine the entire range of the Int type is only 19. 19 is the
largest possible integer you can hold. When CHECKSUM() results in 14-19, these
correspond to results 0-5. Those numbers would be <em>heavily</em> favored over 6-13,
because CHECKSUM() is twice as likely to generate them. It's easier to
demonstrate this visually. Below is the entire possible set of results for our
imaginary integer range:</p>
<div class="code"><pre class="code literal-block">Checksum Integer: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19
Range Result:     0 1 2 3 4 5 6 7 8 9 10 11 12 13  0  1  2  3  4  5
</pre></div>

<p>You can see here that there are more chances to produce some numbers than
others: bias. Thankfully, the actual range of the Int type is <em>much</em> larger...
so much so that in most cases the bias is nearly undetectable. However, it is
something to be aware of if you ever find yourself doing this for serious
security code.</p>
<p><br></p>
<h3>Suggest</h3>
<p>When called multiple times in a single batch, rand() returns the same number.</p>
<p>I'd suggest using convert(<code>varbinary</code>,<code>newid()</code>) as the seed argument:</p>
<div class="code"><pre class="code literal-block"><span class="n">SELECT</span><span class="w"> </span><span class="n">table_name</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">floor</span><span class="p">(</span><span class="mi">14</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">RAND</span><span class="p">(</span><span class="nb">convert</span><span class="p">(</span><span class="n">varbinary</span><span class="p">,</span><span class="w"> </span><span class="n">newid</span><span class="p">())))</span><span class="w"> </span><span class="n">magic_number</span><span class="w"> </span>
<span class="n">FROM</span><span class="w"> </span><span class="n">information_schema</span><span class="o">.</span><span class="n">tables</span>
</pre></div>

<p><code>newid()</code> is guaranteed to return a different value each time it's called,
even within the same batch, so using it as a seed will prompt rand() to give a
different value each time.</p>
<p>Edited to get a random whole number from 1 to 14.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-2247.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-2245.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
