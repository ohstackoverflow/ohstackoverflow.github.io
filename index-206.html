<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 206) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-206.html">
<link rel="prev" href="index-207.html" type="text/html">
<link rel="next" href="index-205.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-does-the-vim-write-with-sudo-trick-work/" class="u-url">How does the vim "write with sudo" trick work?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-does-the-vim-write-with-sudo-trick-work/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T00:50:08+08:00" itemprop="datePublished" title="2023-02-17 00:50">2023-02-17 00:50</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Many of you have probably seen the command that allows you to write on a file
that needs root permission, even when you forgot to open vim with sudo:</p>
<div class="code"><pre class="code literal-block">:w !sudo tee %
</pre></div>

<p>The thing is that I don't get what is exactly happening here.</p>
<p>I have already figured this: <code>w</code> is for this</p>
<div class="code"><pre class="code literal-block"><span class="w">                                                        </span><span class="o">*</span><span class="err">:</span><span class="n">w_c</span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="err">:</span><span class="n">write_c</span><span class="o">*</span>
<span class="err">:</span><span class="o">[</span><span class="n">range</span><span class="o">]</span><span class="n">w</span><span class="o">[</span><span class="n">rite</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">++opt</span><span class="o">]</span><span class="w"> </span><span class="err">!{</span><span class="n">cmd</span><span class="err">}</span>
<span class="w">                        </span><span class="k">Execute</span><span class="w"> </span><span class="err">{</span><span class="n">cmd</span><span class="err">}</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="o">[</span><span class="n">range</span><span class="o">]</span><span class="w"> </span><span class="n">lines</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">standard</span><span class="w"> </span><span class="k">input</span>
<span class="w">                        </span><span class="p">(</span><span class="n">note</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nf">space</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">front</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="s1">'!'</span><span class="p">).</span><span class="w">  </span><span class="err">{</span><span class="n">cmd</span><span class="err">}</span><span class="w"> </span><span class="k">is</span>
<span class="w">                        </span><span class="n">executed</span><span class="w"> </span><span class="ow">like</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="ss">":!{cmd}"</span><span class="p">,</span><span class="w"> </span><span class="ow">any</span><span class="w"> </span><span class="s1">'!'</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">replaced</span><span class="w"> </span><span class="k">with</span>
<span class="w">                        </span><span class="n">the</span><span class="w"> </span><span class="n">previous</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="o">|</span><span class="err">:!</span><span class="o">|</span><span class="p">.</span>
</pre></div>

<p>so it passes all the lines as standard input.</p>
<p>The <code>!sudo tee</code> part calls <code>tee</code> with administrator privileges.</p>
<p>For all to make sense, the <code>%</code> should output the filename (as a parameter for
<code>tee</code>), but I can't find references on the help for this behavior.</p>
<p><strong>tl;dr</strong> Could someone help me dissect this command?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>In <code>:w !sudo tee %</code>...</p>
<h3>
<code>%</code> means "the current file"</h3>
<p>As eugene y pointed out, <code>%</code> does indeed mean "the current file name", which
is passed to <code>tee</code> so that it knows which file to overwrite.</p>
<p>(In substitution commands, it's slightly different; as <code>:help :%</code> shows, it's
<code>equal to 1,$ (the entire file)</code> (thanks to @Orafu for pointing out that this
does not evaluate to the filename). For example, <code>:%s/foo/bar</code> means " <strong>in
the current file</strong> , replace occurrences of <code>foo</code> with <code>bar</code>." If you
highlight some text before typing <code>:s</code>, you'll see that the highlighted lines
take the place of <code>%</code> as your substitution range.)</p>
<h3>
<code>:w</code> isn't updating your file</h3>
<p>One confusing part of this trick is that you might think <code>:w</code> is modifying
your file, but it isn't. If you opened and modified <code>file1.txt</code>, then ran <code>:w
file2.txt</code>, it would be a "save as"; <code>file1.txt</code> wouldn't be modified, but the
current buffer contents would be sent to <code>file2.txt</code>.</p>
<p>Instead of <code>file2.txt</code>, you can <strong>substitute a shell command to receive the
buffer contents</strong>. For instance, <code>:w !cat</code> will just display the contents.</p>
<p>If Vim wasn't run with sudo access, its <code>:w</code> can't modify a protected file,
but if it passes the buffer contents to the shell, <strong>a command in the shell
<em>can</em> be run with sudo</strong>. In this case, we use <code>tee</code>.</p>
<h3>Understanding tee</h3>
<p>As for <code>tee</code>, picture the <code>tee</code> command as a T-shaped pipe in a normal bash
piping situation: it directs output to specified file(s) and <strong>also sends it
to standard output</strong> , which can be captured by the next piped command.</p>
<p>For example, in <code>ps -ax | tee processes.txt | grep 'foo'</code>, the list of
processes will be written to a text file <strong>and</strong> passed along to <code>grep</code>.</p>
<div class="code"><pre class="code literal-block"><span class="c">     </span><span class="nb">+-----------+</span><span class="c">    tee     </span><span class="nb">+------------+</span>
<span class="c">     |           |  </span><span class="nb">--------</span><span class="c">  |            |</span>
<span class="c">     | ps </span><span class="nb">-</span><span class="c">ax    |  </span><span class="nb">--------</span><span class="c">  | grep 'foo' |</span>
<span class="c">     |           |     ||     |            |</span>
<span class="c">     </span><span class="nb">+-----------+</span><span class="c">     ||     </span><span class="nb">+------------+</span>
<span class="c">                       ||   </span>
<span class="c">               </span><span class="nb">+---------------+</span>
<span class="c">               |               |</span>
<span class="c">               | processes</span><span class="nt">.</span><span class="c">txt |</span>
<span class="c">               |               |</span>
<span class="c">               </span><span class="nb">+---------------+</span>
</pre></div>

<p>(Diagram created with Asciiflow.)</p>
<p>See the <code>tee</code> man page for more info.</p>
<h3>Tee as a hack</h3>
<p>In the situation your question describes, <strong>using<code>tee</code> is a hack because we're
ignoring half of what it does</strong>. <code>sudo tee</code> writes to our file and also sends
the buffer contents to standard output, but <strong>we ignore standard output</strong>. We
don't need to pass anything to another piped command in this case; we're just
using <code>tee</code> as an alternate way of writing a file and so that we can call it
with <code>sudo</code>.</p>
<h3>Making this trick easy</h3>
<p>You can add this to your <code>.vimrc</code> to make this trick easy-to-use: just type
<code>:w!!</code>.</p>
<div class="code"><pre class="code literal-block">" Allow saving of files as sudo when I forgot to start vim using sudo.
cmap w!! w !sudo tee &gt; /dev/null %
</pre></div>

<p>The <code>&gt; /dev/null</code> part <strong>explicitly</strong> throws away the standard output, since,
as I said, we don't need to pass anything to another piped command.</p>
<p><br></p>
<h3>Suggest</h3>
<p>In the executed command line, <code>%</code> stands for the <strong>current file name</strong>. This
is documented in <code>:help cmdline-special</code>:</p>
<div class="code"><pre class="code literal-block"><span class="n">In</span><span class="w"> </span><span class="s">Ex</span><span class="w"> </span><span class="s">commands,</span><span class="w"> </span><span class="s">at</span><span class="w"> </span><span class="s">places</span><span class="w"> </span><span class="s">where</span><span class="w"> </span><span class="s">a</span><span class="w"> </span><span class="s">file</span><span class="w"> </span><span class="s">name</span><span class="w"> </span><span class="s">can</span><span class="w"> </span><span class="s">be</span><span class="w"> </span><span class="s">used,</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">following</span>
<span class="n">characters</span><span class="w"> </span><span class="s">have</span><span class="w"> </span><span class="s">a</span><span class="w"> </span><span class="s">special</span><span class="w"> </span><span class="s">meaning.</span>
<span class="w">        </span><span class="c">%       Is replaced with the current file name.</span>
</pre></div>

<p>As you've already found out, <code>:w !cmd</code> pipes the contents of the current
buffer to another command. What <code>tee</code> does is copy standard input to one or
more files, and also to standard output. Therefore, <code>:w !sudo tee % &gt;
/dev/null</code> effectively writes the contents of the current buffer to the
current file <strong>while being root</strong>. Another command that can be used for this
is <code>dd</code>:</p>
<div class="code"><pre class="code literal-block">:w !sudo dd of=% &gt; /dev/null
</pre></div>

<p>As a shortcut, you can add this mapping to your <code>.vimrc</code>:</p>
<div class="code"><pre class="code literal-block">" Force saving files that require root permission 
cnoremap w!! w !sudo tee &gt; /dev/null %
</pre></div>

<p>With the above you can type <code>:w!!&lt;Enter&gt;</code> to save the file as root.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-can-i-delete-using-inner-join-with-sql-server/" class="u-url">How can I delete using INNER JOIN with SQL Server?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-can-i-delete-using-inner-join-with-sql-server/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T00:49:22+08:00" itemprop="datePublished" title="2023-02-17 00:49">2023-02-17 00:49</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I want to <strong>delete</strong> using <code>INNER JOIN</code> in <strong>SQL Server 2008</strong>.</p>
<p>But I get this error:</p>
<blockquote>
<p>Msg 156, Level 15, State 1, Line 15<br><strong>Incorrect</strong> syntax near the <strong>keyword</strong> 'INNER'.</p>
</blockquote>
<p>My code:</p>
<div class="code"><pre class="code literal-block">DELETE 
FROM WorkRecord2 
INNER JOIN Employee 
        ON EmployeeRun=EmployeeNo
WHERE Company = '1' 
    AND Date = '2013-05-06'
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<p>You need to specify what table you are deleting from. Here is a version with
an alias:</p>
<div class="code"><pre class="code literal-block">DELETE w
FROM WorkRecord2 w
INNER JOIN Employee e
  ON EmployeeRun=EmployeeNo
WHERE Company = '1' AND Date = '2013-05-06'
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>Just add the name of the table between <code>DELETE</code> and <code>FROM</code> from where you want
to delete records, because we have to specify the table to delete. Also remove
the <code>ORDER BY</code> clause because there is nothing to order while deleting
records.</p>
<p>So your final query should be like this:</p>
<div class="code"><pre class="code literal-block">    DELETE WorkRecord2 
      FROM WorkRecord2 
INNER JOIN Employee 
        ON EmployeeRun=EmployeeNo
     WHERE Company = '1' 
       AND Date = '2013-05-06';
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/event-binding-on-dynamically-created-elements/" class="u-url">Event binding on dynamically created elements?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/event-binding-on-dynamically-created-elements/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T00:48:55+08:00" itemprop="datePublished" title="2023-02-17 00:48">2023-02-17 00:48</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p><strong>This question's answers are a community effort</strong>. Edit existing answers to
improve this post. It is not currently accepting new answers or interactions.</p>
<p>I have a bit of code where I am looping through all the select boxes on a page
and binding a <code>.hover</code> event to them to do a bit of twiddling with their width
on <code>mouse on/off</code>.</p>
<p>This happens on page ready and works just fine.</p>
<p>The problem I have is that any select boxes I add via Ajax or DOM after the
initial loop won't have the event bound.</p>
<p>I have found this plugin (jQuery Live Query Plugin), but before I add another
5k to my pages with a plugin, I want to see if anyone knows a way to do this,
either with jQuery directly or by another option.</p>
<p><br><br></p>
<h2>Answer</h2>
<p><strong>As of jQuery 1.7</strong> you should use <code>jQuery.fn.on</code> with the selector parameter
filled:</p>
<div class="code"><pre class="code literal-block">$(staticAncestors).on(eventName, dynamicChild, function() {});
</pre></div>

<p><em>Explanation:</em></p>
<p>This is called event delegation and works as followed. The event is attached
to a static parent (<code>staticAncestors</code>) of the element that should be handled.
This jQuery handler is triggered every time the event triggers on this element
or one of the descendant elements. The handler then checks if the element that
triggered the event matches your selector (<code>dynamicChild</code>). When there is a
match then your custom handler function is executed.</p>
<hr>
<p><strong>Prior to this</strong> , the recommended approach was to use <code>live()</code>:</p>
<div class="code"><pre class="code literal-block">$(selector).live( eventName, function(){} );
</pre></div>

<p>However, <code>live()</code> was deprecated in 1.7 in favour of <code>on()</code>, and completely
removed in 1.9. The <code>live()</code> signature:</p>
<div class="code"><pre class="code literal-block">$(selector).live( eventName, function(){} );
</pre></div>

<p>... can be replaced with the following <code>on()</code> signature:</p>
<div class="code"><pre class="code literal-block">$(document).on( eventName, selector, function(){} );
</pre></div>

<hr>
<p>For example, if your page was dynamically creating elements with the class
name <code>dosomething</code> you would bind the event to <strong>a parent which already
exists</strong> (this is the nub of the problem here, you need something that exists
to bind to, don't bind to the dynamic content), this can be (and the easiest
option) is <code>document</code>. Though bear in mind <code>document</code> may not be the most
efficient option.</p>
<div class="code"><pre class="code literal-block">$(document).on('mouseover mouseout', '.dosomething', function(){
    // what you want to happen when mouseover and mouseout 
    // occurs on elements that match '.dosomething'
});
</pre></div>

<p>Any parent that exists at the time the event is bound is fine. For example</p>
<div class="code"><pre class="code literal-block">$<span class="ss">(</span><span class="s1">'.buttons'</span><span class="ss">)</span>.<span class="nv">on</span><span class="ss">(</span><span class="s1">'click'</span>,<span class="w"> </span><span class="s1">'button'</span>,<span class="w"> </span><span class="nv">function</span><span class="ss">()</span>{
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="nv">something</span><span class="w"> </span><span class="nv">here</span>
}<span class="ss">)</span><span class="c1">;</span>
</pre></div>

<p>would apply to</p>
<div class="code"><pre class="code literal-block"><span class="nt">&lt;div</span><span class="w"> </span><span class="na">class=</span><span class="s">"buttons"</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="cm">&lt;!-- &lt;button&gt;s that are generated dynamically and added here --&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>There is a good explanation in the documentation of <code>jQuery.fn.on</code>.</p>
<p>In short:</p>
<blockquote>
<p>Event handlers are bound only to the currently selected elements; they must
exist on the page at the time your code makes the call to <code>.on()</code>.</p>
</blockquote>
<p>Thus in the following example <code>#dataTable tbody tr</code> must exist before the code
is generated.</p>
<div class="code"><pre class="code literal-block">$("#dataTable tbody tr").on("click", function(event){
    console.log($(this).text());
});
</pre></div>

<p>If new HTML is being injected into the page, it is preferable to use delegated
events to attach an event handler, as described next.</p>
<p><strong>Delegated events</strong> have the advantage that they can process events from
descendant elements that are added to the document at a later time. For
example, if the table exists, but the rows are added dynamically using code,
the following will handle it:</p>
<div class="code"><pre class="code literal-block">$("#dataTable tbody").on("click", "tr", function(event){
    console.log($(this).text());
});
</pre></div>

<p>In addition to their ability to handle events on descendant elements which are
not yet created, another advantage of delegated events is their potential for
much lower overhead when many elements must be monitored. On a data table with
1,000 rows in its <code>tbody</code>, the first code example attaches a handler to 1,000
elements.</p>
<p>A delegated-events approach (the second code example) attaches an event
handler to only one element, the <code>tbody</code>, and the event only needs to bubble
up one level (from the clicked <code>tr</code> to <code>tbody</code>).</p>
<p><strong>Note:</strong> Delegated events do not work for SVG.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-207.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-205.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
