<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 677) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-677.html">
<link rel="prev" href="index-678.html" type="text/html">
<link rel="next" href="index-676.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/what-is-monkey-patching/" class="u-url">What is monkey patching?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/what-is-monkey-patching/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T13:04:55+08:00" itemprop="datePublished" title="2023-02-17 13:04">2023-02-17 13:04</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I am trying to understand, what is monkey patching or a monkey patch?</p>
<p>Is that something like methods/operators overloading or delegating?</p>
<p>Does it have anything common with these things?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>No, it's not like any of those things. It's simply the dynamic replacement of
attributes at runtime.</p>
<p>For instance, consider a class that has a method <code>get_data</code>. This method does
an external lookup (on a database or web API, for example), and various other
methods in the class call it. However, in a unit test, you don't want to
depend on the external data source - so you dynamically replace the <code>get_data</code>
method with a stub that returns some fixed data.</p>
<p>Because Python classes are mutable, and methods are just attributes of the
class, you can do this as much as you like - and, in fact, you can even
replace classes and functions in a module in exactly the same way.</p>
<p>But, as a commenter pointed out, use caution when monkeypatching:</p>
<ol>
<li>
<p>If anything else besides your test logic calls <code>get_data</code> as well, it will also call your monkey-patched replacement rather than the original -- which can be good or bad. Just beware. </p>
</li>
<li>
<p>If some variable or attribute exists that also points to the <code>get_data</code> function by the time you replace it, this alias will not change its meaning and will continue to point to the original <code>get_data</code>. (Why? Python just rebinds the name <code>get_data</code> in your class to some other function object; other name bindings are not impacted at all.) </p>
</li>
</ol>
<p><br></p>
<h3>Suggest</h3>
<blockquote>
<p>A MonkeyPatch is a piece of Python code which extends or modifies other code
at runtime (typically at startup).</p>
</blockquote>
<p>A simple example looks like this:</p>
<div class="code"><pre class="code literal-block"><span class="kn">from</span> <span class="nn">SomeOtherProduct.SomeModule</span> <span class="kn">import</span> <span class="n">SomeClass</span>

<span class="k">def</span> <span class="nf">speak</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">"ook ook eee eee eee!"</span>

<span class="n">SomeClass</span><span class="o">.</span><span class="n">speak</span> <span class="o">=</span> <span class="n">speak</span>
</pre></div>

<p><strong>Source:</strong> MonkeyPatch page on Zope wiki.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/settimeout-or-setinterval/" class="u-url">setTimeout or setInterval?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/settimeout-or-setinterval/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T13:04:28+08:00" itemprop="datePublished" title="2023-02-17 13:04">2023-02-17 13:04</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>As far as I can tell, these two pieces of javascript behave the same way:</p>
<p><strong>Option A:</strong></p>
<div class="code"><pre class="code literal-block"><span class="k">function</span><span class="w"> </span><span class="nf">myTimeoutFunction</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">doStuff</span><span class="p">();</span>
<span class="w">    </span><span class="n">setTimeout</span><span class="p">(</span><span class="n">myTimeoutFunction</span><span class="p">,</span><span class="w"> </span><span class="mi">1000</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">myTimeoutFunction</span><span class="p">();</span>
</pre></div>

<p><strong>Option B:</strong></p>
<div class="code"><pre class="code literal-block"><span class="k">function</span><span class="w"> </span><span class="nf">myTimeoutFunction</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">doStuff</span><span class="p">();</span>
<span class="p">}</span>

<span class="n">myTimeoutFunction</span><span class="p">();</span>
<span class="n">setInterval</span><span class="p">(</span><span class="n">myTimeoutFunction</span><span class="p">,</span><span class="w"> </span><span class="mi">1000</span><span class="p">);</span>
</pre></div>

<p>Is there any difference between using setTimeout and setInterval?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>They essentially try to do the same thing, but the <code>setInterval</code> approach will
be more accurate than the <code>setTimeout</code> approach, since <code>setTimeout</code> waits
1000ms, runs the function and then sets another timeout. So the wait period is
actually a bit more than 1000ms (or a lot more if your function takes a long
time to execute).</p>
<p>Although one might think that <code>setInterval</code> will execute <strong>exactly</strong> every
1000ms, it is important to note that <code>setInterval</code> will also delay, since
JavaScript isn't a multi-threaded language, which means that - if there are
other parts of the script running - the interval will have to wait for that to
finish.</p>
<p>In this Fiddle, you can clearly see that the timeout will fall behind, while
the interval is almost all the time at almost 1 call/second (which the script
is trying to do). If you change the speed variable at the top to something
small like 20 (meaning it will try to run 50 times per second), the interval
will never quite reach an average of 50 iterations per second.</p>
<p>The delay is almost always negligible, but if you're programming something
really precise, you should go for a <em>self-adjusting timer</em> (which essentially
is a timeout-based timer that constantly adjusts itself for the delay it's
created)</p>
<p><br></p>
<h3>Suggest</h3>
<blockquote>
<p>Is there any difference?</p>
</blockquote>
<p>Yes. A Timeout executes a certain amount of time after setTimeout() is called;
an Interval executes a certain amount of time after the previous interval
fired.</p>
<p>You will notice the difference if your doStuff() function takes a while to
execute. For example, if we represent a call to setTimeout/setInterval with
<code>.</code>, a firing of the timeout/interval with <code>*</code> and JavaScript code execution
with <code>[-----]</code>, the timelines look like:</p>
<div class="code"><pre class="code literal-block">Timeout:

.    *  .    *  .    *  .    *  .
     [--]    [--]    [--]    [--]

Interval:

.    *    *    *    *    *    *
     [--] [--] [--] [--] [--] [--]
</pre></div>

<p>The next complication is if an interval fires whilst JavaScript is already
busy doing something (such as handling a previous interval). In this case, the
interval is remembered, and happens as soon as the previous handler finishes
and returns control to the browser. So for example for a doStuff() process
that is sometimes short ([-]) and sometimes long ([-----]):</p>
<div class="code"><pre class="code literal-block"><span class="nt">.</span><span class="c">    *    *    •    *    •    *    *</span>
<span class="c">     </span><span class="k">[</span><span class="nb">-</span><span class="k">]</span><span class="c">  </span><span class="k">[</span><span class="nb">-----</span><span class="k">][</span><span class="nb">-</span><span class="k">][</span><span class="nb">-----</span><span class="k">][</span><span class="nb">-</span><span class="k">][</span><span class="nb">-</span><span class="k">]</span><span class="c">  </span><span class="k">[</span><span class="nb">-</span><span class="k">]</span>
</pre></div>

<p>• represents an interval firing that couldn't execute its code straight away,
and was made pending instead.</p>
<p>So intervals try to ‘catch up’ to get back on schedule. But, they don't queue
one on top of each other: there can only ever be one execution pending per
interval. (If they all queued up, the browser would be left with an ever-
expanding list of outstanding executions!)</p>
<div class="code"><pre class="code literal-block">.    *    •    •    x    •    •    x
     [------][------][------][------]
</pre></div>

<p>x represents an interval firing that couldn't execute or be made pending, so
instead was discarded.</p>
<p>If your doStuff() function habitually takes longer to execute than the
interval that is set for it, the browser will eat 100% CPU trying to service
it, and may become less responsive.</p>
<blockquote>
<p>Which do you use and why?</p>
</blockquote>
<p>Chained-Timeout gives a guaranteed slot of free time to the browser; Interval
tries to ensure the function it is running executes as close as possible to
its scheduled times, at the expense of browser UI availability.</p>
<p>I would consider an interval for one-off animations I wanted to be as smooth
as possible, whilst chained timeouts are more polite for ongoing animations
that would take place all the time whilst the page is loaded. For less
demanding uses (such as a trivial updater firing every 30 seconds or
something), you can safely use either.</p>
<p>In terms of browser compatibility, setTimeout predates setInterval, but all
browsers you will meet today support both. The last straggler for many years
was IE Mobile in WinMo &lt;6.5, but hopefully that too is now behind us.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-check-if-object-property-exists-with-a-variable-holding-the-property-name/" class="u-url">How to check if object property exists with a variable holding the property name?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-check-if-object-property-exists-with-a-variable-holding-the-property-name/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T13:04:01+08:00" itemprop="datePublished" title="2023-02-17 13:04">2023-02-17 13:04</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I am checking for the existence of an object property with a variable holding
the property name in question.</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">myObj</span><span class="p">;</span>
<span class="n">myObj</span><span class="o">.</span><span class="n">prop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"exists"</span><span class="p">;</span>
<span class="k">var</span><span class="w"> </span><span class="n">myProp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"p"</span><span class="o">+</span><span class="s2">"r"</span><span class="o">+</span><span class="s2">"o"</span><span class="o">+</span><span class="s2">"p"</span><span class="p">;</span>

<span class="k">if</span><span class="p">(</span><span class="n">myObj</span><span class="o">.</span><span class="n">myProp</span><span class="p">){</span>
<span class="w">    </span><span class="n">alert</span><span class="p">(</span><span class="s2">"yes, i have that property"</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

<p>This is <code>undefined</code> because it's looking for <code>myObj.myProp</code> but I want it to
check for <code>myObj.prop</code></p>
<p><br><br></p>
<h2>Answer</h2>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">myProp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'prop'</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span><span class="n">myObj</span><span class="o">.</span><span class="n">hasOwnProperty</span><span class="p">(</span><span class="n">myProp</span><span class="p">)){</span>
<span class="w">    </span><span class="n">alert</span><span class="p">(</span><span class="s2">"yes, i have that property"</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>

<p>Or</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">myProp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'prop'</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span><span class="n">myProp</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">myObj</span><span class="p">){</span>
<span class="w">    </span><span class="n">alert</span><span class="p">(</span><span class="s2">"yes, i have that property"</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>

<p>Or</p>
<div class="code"><pre class="code literal-block"><span class="k">if</span><span class="ss">(</span><span class="s1">'prop'</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">myObj</span><span class="ss">)</span>{
<span class="w">    </span><span class="nv">alert</span><span class="ss">(</span><span class="s2">"yes, i have that property"</span><span class="ss">)</span><span class="c1">;</span>
}
</pre></div>

<p>Note that <code>hasOwnProperty</code> doesn't check for inherited properties, whereas
<code>in</code> does. For example <code>'constructor' in myObj</code> is true, but
<code>myObj.hasOwnProperty('constructor')</code> is not.</p>
<p><br></p>
<h3>Suggest</h3>
<p>You can use <strong>hasOwnProperty</strong> , but based on the reference you need
<strong>quotes</strong> when using this method:</p>
<div class="code"><pre class="code literal-block"><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">myObj</span>.<span class="nv">hasOwnProperty</span><span class="ss">(</span><span class="s1">'myProp'</span><span class="ss">))</span><span class="w"> </span>{
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="nv">something</span>
}
</pre></div>

<p>https://developer.mozilla.org/en-
US/docs/Web/JavaScript/Reference/Global_Objects/Object/hasOwnProperty</p>
<p>Another way is to use <strong>in</strong> operator, but you need <strong>quotes</strong> here as well:</p>
<div class="code"><pre class="code literal-block"><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="s1">'myProp'</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">myObj</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="nv">something</span>
}
</pre></div>

<p>https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/in</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-678.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-676.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
