<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 2268) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-2268.html">
<link rel="prev" href="index-2269.html" type="text/html">
<link rel="next" href="index-2267.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/using-linq-to-concatenate-strings/" class="u-url">Using LINQ to concatenate strings</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/using-linq-to-concatenate-strings/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T03:34:25+08:00" itemprop="datePublished" title="2023-03-04 03:34">2023-03-04 03:34</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>What is the most efficient way to write the old-school:</p>
<div class="code"><pre class="code literal-block"><span class="nv">StringBuilder</span><span class="w"> </span><span class="nv">sb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">StringBuilder</span><span class="ss">()</span><span class="c1">;</span>
<span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">strings</span>.<span class="nv">Count</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="ss">)</span>
{
<span class="w">    </span><span class="nv">foreach</span><span class="w"> </span><span class="ss">(</span><span class="nv">string</span><span class="w"> </span><span class="nv">s</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">strings</span><span class="ss">)</span>
<span class="w">    </span>{
<span class="w">        </span><span class="nv">sb</span>.<span class="nv">Append</span><span class="ss">(</span><span class="nv">s</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">", "</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">    </span>}
<span class="w">    </span><span class="nv">sb</span>.<span class="nv">Remove</span><span class="ss">(</span><span class="nv">sb</span>.<span class="nv">Length</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span>,<span class="w"> </span><span class="mi">2</span><span class="ss">)</span><span class="c1">;</span>
}
<span class="k">return</span><span class="w"> </span><span class="nv">sb</span>.<span class="nv">ToString</span><span class="ss">()</span><span class="c1">;</span>
</pre></div>

<p>...in LINQ?</p>
<p><br><br></p>
<h2>Answer</h2>
<p><strong>This answer shows usage of LINQ (<code>Aggregate</code>) as requested in the question
and is not intended for everyday use. Because this does not use a
<code>StringBuilder</code> it will have horrible performance for very long sequences. For
regular code use <code>String.Join</code> as shown in the other answer</strong></p>
<p>Use aggregate queries like this:</p>
<div class="code"><pre class="code literal-block"><span class="n">string</span><span class="p">[]</span><span class="w"> </span><span class="n">words</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"one"</span><span class="p">,</span><span class="w"> </span><span class="s2">"two"</span><span class="p">,</span><span class="w"> </span><span class="s2">"three"</span><span class="w"> </span><span class="p">};</span>
<span class="k">var</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">words</span><span class="o">.</span><span class="n">Aggregate</span><span class="p">(</span>
<span class="w">   </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">empty</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">handle</span><span class="w"> </span><span class="n">empty</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">case</span><span class="o">.</span>
<span class="w">   </span><span class="p">(</span><span class="n">current</span><span class="p">,</span><span class="w"> </span><span class="n">next</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">", "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">next</span><span class="p">);</span>
<span class="n">Console</span><span class="o">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">res</span><span class="p">);</span>
</pre></div>

<p>This outputs:</p>
<div class="code"><pre class="code literal-block">, one, two, three
</pre></div>

<p>An aggregate is a function that takes a collection of values and returns a
scalar value. Examples from T-SQL include min, max, and sum. Both VB and C#
have support for aggregates. Both VB and C# support aggregates as extension
methods. Using the dot-notation, one simply calls a method on an IEnumerable
object.</p>
<p>Remember that aggregate queries are executed immediately.</p>
<p>More information - MSDN: Aggregate Queries</p>
<hr>
<p>If you really want to use <code>Aggregate</code> use variant using <code>StringBuilder</code>
proposed in comment by CodeMonkeyKing which would be about the same code as
regular <code>String.Join</code> including good performance for large number of objects:</p>
<div class="code"><pre class="code literal-block"><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">words</span><span class="o">.</span><span class="n">Aggregate</span><span class="p">(</span>
<span class="w">     </span><span class="n">new</span><span class="w"> </span><span class="n">StringBuilder</span><span class="p">(),</span><span class="w"> </span>
<span class="w">     </span><span class="p">(</span><span class="n">current</span><span class="p">,</span><span class="w"> </span><span class="n">next</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">current</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">current</span><span class="o">.</span><span class="n">Length</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="err">?</span><span class="w"> </span><span class="s2">""</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">", "</span><span class="p">)</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">next</span><span class="p">))</span>
<span class="w">     </span><span class="o">.</span><span class="n">ToString</span><span class="p">();</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<div class="code"><pre class="code literal-block"><span class="k">return</span><span class="w"> </span><span class="nv">string</span>.<span class="nv">Join</span><span class="ss">(</span><span class="s2">", "</span>,<span class="w"> </span><span class="nv">strings</span>.<span class="nv">ToArray</span><span class="ss">())</span><span class="c1">;</span>
</pre></div>

<hr>
<p>In .Net 4, there's a new overload for <code>string.Join</code> that accepts
<code>IEnumerable&lt;string&gt;</code>. The code would then look like:</p>
<div class="code"><pre class="code literal-block"><span class="k">return</span><span class="w"> </span><span class="nv">string</span>.<span class="nv">Join</span><span class="ss">(</span><span class="s2">", "</span>,<span class="w"> </span><span class="nv">strings</span><span class="ss">)</span><span class="c1">;</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/using-str-replace-so-that-it-only-acts-on-the-first-match/" class="u-url">Using str_replace so that it only acts on the first match?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/using-str-replace-so-that-it-only-acts-on-the-first-match/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T03:32:46+08:00" itemprop="datePublished" title="2023-03-04 03:32">2023-03-04 03:32</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I want a version of <code>str_replace()</code> that only replaces the first occurrence of
<code>$search</code> in the <code>$subject</code>. Is there an easy solution to this, or do I need a
hacky solution?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Can be done with preg_replace:</p>
<div class="code"><pre class="code literal-block"><span class="k">function</span><span class="w"> </span><span class="nf">str_replace_first</span><span class="p">(</span>$search, $replace, $subject<span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span>$<span class="n">search</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">'/'</span><span class="p">.</span><span class="n">preg_quote</span><span class="p">(</span>$<span class="n">search</span><span class="p">,</span><span class="w"> </span><span class="s">'/'</span><span class="p">).</span><span class="o">'/</span><span class="s">';</span>
<span class="s">    return preg_replace($search, $replace, $subject, 1);</span>
<span class="s">}</span>

<span class="s">echo str_replace_first('</span><span class="n">abc</span><span class="o">'</span><span class="p">,</span><span class="w"> </span><span class="s">'123'</span><span class="p">,</span><span class="w"> </span><span class="s">'abcdef abcdef abcdef'</span><span class="p">);</span><span class="w"> </span>
<span class="o">//</span><span class="w"> </span><span class="n">outputs</span><span class="w"> </span><span class="s">'123def abcdef abcdef'</span>
</pre></div>

<p>The magic is in the optional fourth parameter [Limit]. From the documentation:</p>
<blockquote>
<p>[Limit] - The maximum possible replacements for each pattern in each subject
string. Defaults to -1 (no limit).</p>
</blockquote>
<p>Though, see zombat's answer for a more efficient method (roughly, 3-4x
faster).</p>
<p><br></p>
<h3>Suggest</h3>
<p>Can be done with preg_replace:</p>
<div class="code"><pre class="code literal-block"><span class="k">function</span><span class="w"> </span><span class="nf">str_replace_first</span><span class="p">(</span>$search, $replace, $subject<span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span>$<span class="n">search</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">'/'</span><span class="p">.</span><span class="n">preg_quote</span><span class="p">(</span>$<span class="n">search</span><span class="p">,</span><span class="w"> </span><span class="s">'/'</span><span class="p">).</span><span class="o">'/</span><span class="s">';</span>
<span class="s">    return preg_replace($search, $replace, $subject, 1);</span>
<span class="s">}</span>

<span class="s">echo str_replace_first('</span><span class="n">abc</span><span class="o">'</span><span class="p">,</span><span class="w"> </span><span class="s">'123'</span><span class="p">,</span><span class="w"> </span><span class="s">'abcdef abcdef abcdef'</span><span class="p">);</span><span class="w"> </span>
<span class="o">//</span><span class="w"> </span><span class="n">outputs</span><span class="w"> </span><span class="s">'123def abcdef abcdef'</span>
</pre></div>

<p>The magic is in the optional fourth parameter [Limit]. From the documentation:</p>
<blockquote>
<p>[Limit] - The maximum possible replacements for each pattern in each subject
string. Defaults to -1 (no limit).</p>
</blockquote>
<p>Though, see zombat's answer for a more efficient method (roughly, 3-4x
faster).</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/why-doesn-t-java-support-unsigned-ints/" class="u-url">Why doesn't Java support unsigned ints?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/why-doesn-t-java-support-unsigned-ints/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T03:31:15+08:00" itemprop="datePublished" title="2023-03-04 03:31">2023-03-04 03:31</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Why doesn't Java include support for unsigned integers?</p>
<p>It seems to me to be an odd omission, given that they allow one to write code
that is less likely to produce overflows on unexpectedly large input.</p>
<p>Furthermore, using unsigned integers can be a form of self-documentation,
since they indicate that the value which the unsigned int was intended to hold
is never supposed to be negative.</p>
<p>Lastly, in some cases, unsigned integers can be more efficient for certain
operations, such as division.</p>
<p>What's the downside to including these?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>This is from an interview with Gosling and others, about simplicity:</p>
<blockquote>
<p>Gosling: For me as a language designer, which I don't really count myself as
these days, what "simple" really ended up meaning was could I expect J.
Random Developer to hold the spec in his head. That definition says that,
for instance, Java isn't -- and in fact a lot of these languages end up with
a lot of corner cases, things that nobody really understands. Quiz any C
developer about unsigned, and pretty soon you discover that almost no C
developers actually understand what goes on with unsigned, what unsigned
arithmetic is. Things like that made C complex. The language part of Java
is, I think, pretty simple. The libraries you have to look up.</p>
</blockquote>
<p><br></p>
<h3>Suggest</h3>
<p>Reading between the lines, I think the logic was something like this:</p>
<ul>
<li>generally, the Java designers wanted to simplify the repertoire of data types available</li>
<li>for everyday purposes, they felt that the most common need was for signed data types</li>
<li>for implementing certain algorithms, unsigned arithmetic is sometimes needed, but the kind of programmers that would be implementing such algorithms would also have the knowledge to "work round" doing unsigned arithmetic with signed data types</li>
</ul>
<p>Mostly, I'd say it was a reasonable decision. Possibly, I would have:</p>
<ul>
<li>made byte unsigned, or at least have provided a signed/unsigned alternatives, possibly with different names, for this one data type (making it signed is good for consistency, but when do you ever need a signed byte?)</li>
<li>done away with 'short' (when did you last use 16-bit signed arithmetic?)</li>
</ul>
<p>Still, with a bit of kludging, operations on unsigned values up to 32 bits
aren't tooo bad, and most people don't need unsigned 64-bit division or
comparison.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-2269.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-2267.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
