<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 205) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-205.html">
<link rel="prev" href="index-206.html" type="text/html">
<link rel="next" href="index-204.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-do-you-access-the-matched-groups-in-a-javascript-regular-expression/" class="u-url">How do you access the matched groups in a JavaScript regular expression?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-do-you-access-the-matched-groups-in-a-javascript-regular-expression/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T00:48:25+08:00" itemprop="datePublished" title="2023-02-17 00:48">2023-02-17 00:48</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I want to match a portion of a string using a regular expression and then
access that parenthesized substring:</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">myString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"something format_abc"</span><span class="p">;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="s2">"abc"</span>

<span class="k">var</span><span class="w"> </span><span class="n">arr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">/</span><span class="p">(</span><span class="err">?</span><span class="p">:</span><span class="o">^|</span>\<span class="n">s</span><span class="p">)</span><span class="n">format_</span><span class="p">(</span><span class="o">.*</span><span class="err">?</span><span class="p">)(</span><span class="err">?</span><span class="p">:</span>\<span class="n">s</span><span class="o">|$</span><span class="p">)</span><span class="o">/.</span><span class="n">exec</span><span class="p">(</span><span class="n">myString</span><span class="p">);</span>

<span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">arr</span><span class="p">);</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">Prints</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">" format_abc"</span><span class="p">,</span><span class="w"> </span><span class="s2">"abc"</span><span class="p">]</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">far</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">good</span><span class="o">.</span>
<span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">Prints</span><span class="p">:</span><span class="w"> </span><span class="n">undefined</span><span class="w">  </span><span class="p">(</span><span class="err">???</span><span class="p">)</span>
<span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">Prints</span><span class="p">:</span><span class="w"> </span><span class="n">format_undefined</span><span class="w"> </span><span class="p">(</span><span class="o">!!!</span><span class="p">)</span>
</pre></div>

<p>What am I doing wrong?</p>
<hr>
<p>I've discovered that there was nothing wrong with the regular expression code
above: the actual string which I was testing against was this:</p>
<div class="code"><pre class="code literal-block">"date format_%A"
</pre></div>

<p>Reporting that "%A" is undefined seems a very strange behaviour, but it is not
directly related to this question, so I've opened a new one, <em>Why is a matched
substring returning "undefined" in JavaScript?</em>.</p>
<hr>
<p>The issue was that <code>console.log</code> takes its parameters like a <code>printf</code>
statement, and since the string I was logging (<code>"%A"</code>) had a special value, it
was trying to find the value of the next parameter.</p>
<p><br><br></p>
<h2>Answer</h2>
<h3>Update: 2019-09-10</h3>
<p>The old way to iterate over multiple matches was not very intuitive. This lead
to the proposal of the <code>String.prototype.matchAll</code> method. This new method is
in the ECMAScript 2020 specification. It gives us a clean API and solves
multiple problems. It is in major browsers and JS engines since Chrome 73+ /
Node 12+ and Firefox 67+.</p>
<p>The method returns an iterator and is used as follows:</p>
<div class="code"><pre class="code literal-block"><span class="k">const</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"something format_abc"</span><span class="p">;</span>
<span class="k">const</span><span class="w"> </span><span class="n">regexp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">/</span><span class="p">(</span><span class="err">?</span><span class="p">:</span><span class="o">^|</span>\<span class="n">s</span><span class="p">)</span><span class="n">format_</span><span class="p">(</span><span class="o">.*</span><span class="err">?</span><span class="p">)(</span><span class="err">?</span><span class="p">:</span>\<span class="n">s</span><span class="o">|$</span><span class="p">)</span><span class="o">/</span><span class="n">g</span><span class="p">;</span>
<span class="k">const</span><span class="w"> </span><span class="n">matches</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">string</span><span class="o">.</span><span class="n">matchAll</span><span class="p">(</span><span class="n">regexp</span><span class="p">);</span>

<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">matches</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="k">match</span><span class="p">);</span>
<span class="w">  </span><span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="k">match</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>

<p>As it returns an iterator, we can say it's lazy, this is useful when handling
particularly large numbers of capturing groups, or very large strings. But if
you need, the result can be easily transformed into an Array by using the
<em>spread syntax</em> or the <code>Array.from</code> method:</p>
<div class="code"><pre class="code literal-block"><span class="n">function</span><span class="w"> </span><span class="n">getFirstGroup</span><span class="p">(</span><span class="n">regexp</span><span class="p">,</span><span class="w"> </span><span class="nb">str</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">array</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="o">...</span><span class="n">str</span><span class="o">.</span><span class="n">matchAll</span><span class="p">(</span><span class="n">regexp</span><span class="p">)];</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">array</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="ow">or</span><span class="p">:</span>
<span class="n">function</span><span class="w"> </span><span class="n">getFirstGroup</span><span class="p">(</span><span class="n">regexp</span><span class="p">,</span><span class="w"> </span><span class="nb">str</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nb nb-Type">Array</span><span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">matchAll</span><span class="p">(</span><span class="n">regexp</span><span class="p">),</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
<span class="p">}</span>
</pre></div>

<p>In the meantime, while this proposal gets more wide support, you can use the
official shim package.</p>
<p>Also, the internal workings of the method are simple. An equivalent
implementation using a generator function would be as follows:</p>
<div class="code"><pre class="code literal-block"><span class="n">function</span><span class="o">*</span><span class="w"> </span><span class="n">matchAll</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">regexp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">flags</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">regexp</span><span class="o">.</span><span class="n">global</span><span class="w"> </span><span class="err">?</span><span class="w"> </span><span class="n">regexp</span><span class="o">.</span><span class="n">flags</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">regexp</span><span class="o">.</span><span class="n">flags</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">"g"</span><span class="p">;</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">re</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">RegExp</span><span class="p">(</span><span class="n">regexp</span><span class="p">,</span><span class="w"> </span><span class="n">flags</span><span class="p">);</span>
<span class="w">  </span><span class="n">let</span><span class="w"> </span><span class="k">match</span><span class="p">;</span>
<span class="w">  </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="k">match</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">re</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="nb">str</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nb">yield</span><span class="w"> </span><span class="k">match</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p>A copy of the original regexp is created; this is to avoid side-effects due to
the mutation of the <code>lastIndex</code> property when going through the multple
matches.</p>
<p>Also, we need to ensure the regexp has the <em>global</em> flag to avoid an infinite
loop.</p>
<p>I'm also happy to see that even this StackOverflow question was referenced in
the discussions of the proposal.</p>
<h3>original answer</h3>
<p>You can access capturing groups like this:</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">myString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"something format_abc"</span><span class="p">;</span>
<span class="k">var</span><span class="w"> </span><span class="n">myRegexp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">/</span><span class="p">(</span><span class="err">?</span><span class="p">:</span><span class="o">^|</span>\<span class="n">s</span><span class="p">)</span><span class="n">format_</span><span class="p">(</span><span class="o">.*</span><span class="err">?</span><span class="p">)(</span><span class="err">?</span><span class="p">:</span>\<span class="n">s</span><span class="o">|$</span><span class="p">)</span><span class="o">/</span><span class="n">g</span><span class="p">;</span>
<span class="k">var</span><span class="w"> </span><span class="n">myRegexp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">RegExp</span><span class="p">(</span><span class="s2">"(?:^|\s)format_(.*?)(?:\s|$)"</span><span class="p">,</span><span class="w"> </span><span class="s2">"g"</span><span class="p">);</span>
<span class="k">var</span><span class="w"> </span><span class="n">matches</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">myRegexp</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">myString</span><span class="p">);</span>
<span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">matches</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">abc</span>
</pre></div>

<p>And if there are multiple matches you can iterate over them:</p>
<div class="code"><pre class="code literal-block"><span class="nf">var</span><span class="w"> </span><span class="n">myString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">"something format_abc"</span><span class="p">;</span>
<span class="nf">var</span><span class="w"> </span><span class="n">myRegexp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">RegExp</span><span class="p">(</span><span class="ss">"(?:^|\s)format_(.*?)(?:\s|$)"</span><span class="p">,</span><span class="w"> </span><span class="ss">"g"</span><span class="p">);</span>
<span class="k">match</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">myRegexp</span><span class="p">.</span><span class="k">exec</span><span class="p">(</span><span class="n">myString</span><span class="p">);</span>
<span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="k">match</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">null</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">matched</span><span class="w"> </span><span class="nc">text</span><span class="err">:</span><span class="w"> </span><span class="k">match</span><span class="o">[</span><span class="n">0</span><span class="o">]</span>
<span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="k">start</span><span class="err">:</span><span class="w"> </span><span class="k">match</span><span class="p">.</span><span class="k">index</span>
<span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">capturing</span><span class="w"> </span><span class="k">group</span><span class="w"> </span><span class="nl">n</span><span class="p">:</span><span class="w"> </span><span class="k">match</span><span class="o">[</span><span class="n">n</span><span class="o">]</span>
<span class="w">  </span><span class="n">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="k">match</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="p">)</span>
<span class="w">  </span><span class="k">match</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">myRegexp</span><span class="p">.</span><span class="k">exec</span><span class="p">(</span><span class="n">myString</span><span class="p">);</span>
<span class="err">}</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>Here’s a method you can use to get the <em>n</em> ​th capturing group for each match:</p>
<div class="code"><pre class="code literal-block"><span class="k">function</span><span class="w"> </span><span class="n">getMatches</span><span class="p">(</span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="n">regex</span><span class="p">,</span><span class="w"> </span><span class="k">index</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">  </span><span class="k">index</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span><span class="k">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">first</span><span class="w"> </span><span class="n">capturing</span><span class="w"> </span><span class="k">group</span>
<span class="w">  </span><span class="nf">var</span><span class="w"> </span><span class="n">matches</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">[]</span><span class="p">;</span>
<span class="w">  </span><span class="nf">var</span><span class="w"> </span><span class="k">match</span><span class="p">;</span>
<span class="w">  </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="k">match</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">regex</span><span class="p">.</span><span class="k">exec</span><span class="p">(</span><span class="n">string</span><span class="p">))</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="n">matches</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="k">match</span><span class="o">[</span><span class="n">index</span><span class="o">]</span><span class="p">);</span>
<span class="w">  </span><span class="err">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">matches</span><span class="p">;</span>
<span class="err">}</span>


<span class="o">//</span><span class="w"> </span><span class="n">Example</span><span class="w"> </span><span class="err">:</span>
<span class="nf">var</span><span class="w"> </span><span class="n">myString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'something format_abc something format_def something format_ghi'</span><span class="p">;</span>
<span class="nf">var</span><span class="w"> </span><span class="n">myRegEx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">/</span><span class="p">(</span><span class="vm">?</span><span class="err">:</span><span class="o">^|</span><span class="err">\</span><span class="n">s</span><span class="p">)</span><span class="n">format_</span><span class="p">(.</span><span class="o">*</span><span class="vm">?</span><span class="p">)(</span><span class="vm">?</span><span class="err">:\</span><span class="n">s</span><span class="o">|</span><span class="err">$</span><span class="p">)</span><span class="o">/</span><span class="n">g</span><span class="p">;</span>

<span class="o">//</span><span class="w"> </span><span class="k">Get</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="k">array</span><span class="w"> </span><span class="n">containing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">first</span><span class="w"> </span><span class="n">capturing</span><span class="w"> </span><span class="k">group</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">every</span><span class="w"> </span><span class="k">match</span>
<span class="nf">var</span><span class="w"> </span><span class="n">matches</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getMatches</span><span class="p">(</span><span class="n">myString</span><span class="p">,</span><span class="w"> </span><span class="n">myRegEx</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="o">//</span><span class="w"> </span><span class="nf">Log</span><span class="w"> </span><span class="n">results</span>
<span class="n">document</span><span class="p">.</span><span class="k">write</span><span class="p">(</span><span class="n">matches</span><span class="p">.</span><span class="n">length</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">' matches found: '</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">JSON</span><span class="p">.</span><span class="n">stringify</span><span class="p">(</span><span class="n">matches</span><span class="p">))</span>
<span class="n">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="n">matches</span><span class="p">);</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/startswith-and-endswith-functions-in-php/" class="u-url">startsWith() and endsWith() functions in PHP</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/startswith-and-endswith-functions-in-php/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T00:47:53+08:00" itemprop="datePublished" title="2023-02-17 00:47">2023-02-17 00:47</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>How can I write two functions that would take a string and return if it starts
with the specified character/string or ends with it?</p>
<p>For example:</p>
<div class="code"><pre class="code literal-block">$str = '|apples}';

echo startsWith($str, '|'); //Returns true
echo endsWith($str, '}'); //Returns true
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<h3>PHP 8.0 and higher</h3>
<p>Since PHP 8.0 you can use the</p>
<p><code>str_starts_with</code> Manual and</p>
<p><code>str_ends_with</code> Manual</p>
<h6>Example</h6>
<p><code>echo str_starts_with($str, '|');</code></p>
<h3>PHP before 8.0</h3>
<div class="code"><pre class="code literal-block"><span class="nv">function</span><span class="w"> </span><span class="nv">startsWith</span><span class="ss">(</span><span class="w"> </span>$<span class="nv">haystack</span>,<span class="w"> </span>$<span class="nv">needle</span><span class="w"> </span><span class="ss">)</span><span class="w"> </span>{
<span class="w">     </span>$<span class="nv">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">strlen</span><span class="ss">(</span><span class="w"> </span>$<span class="nv">needle</span><span class="w"> </span><span class="ss">)</span><span class="c1">;</span>
<span class="w">     </span><span class="k">return</span><span class="w"> </span><span class="nv">substr</span><span class="ss">(</span><span class="w"> </span>$<span class="nv">haystack</span>,<span class="w"> </span><span class="mi">0</span>,<span class="w"> </span>$<span class="nv">length</span><span class="w"> </span><span class="ss">)</span><span class="w"> </span><span class="o">===</span><span class="w"> </span>$<span class="nv">needle</span><span class="c1">;</span>
}



<span class="nv">function</span><span class="w"> </span><span class="nv">endsWith</span><span class="ss">(</span><span class="w"> </span>$<span class="nv">haystack</span>,<span class="w"> </span>$<span class="nv">needle</span><span class="w"> </span><span class="ss">)</span><span class="w"> </span>{
<span class="w">    </span>$<span class="nv">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">strlen</span><span class="ss">(</span><span class="w"> </span>$<span class="nv">needle</span><span class="w"> </span><span class="ss">)</span><span class="c1">;</span>
<span class="w">    </span><span class="k">if</span><span class="ss">(</span><span class="w"> </span><span class="o">!</span>$<span class="nv">length</span><span class="w"> </span><span class="ss">)</span><span class="w"> </span>{
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nv">true</span><span class="c1">;</span>
<span class="w">    </span>}
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nv">substr</span><span class="ss">(</span><span class="w"> </span>$<span class="nv">haystack</span>,<span class="w"> </span><span class="o">-</span>$<span class="nv">length</span><span class="w"> </span><span class="ss">)</span><span class="w"> </span><span class="o">===</span><span class="w"> </span>$<span class="nv">needle</span><span class="c1">;</span>
}
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>You can use <code>substr_compare</code> function to check start-with and ends-with:</p>
<div class="code"><pre class="code literal-block"><span class="nv">function</span><span class="w"> </span><span class="nv">startsWith</span><span class="ss">(</span>$<span class="nv">haystack</span>,<span class="w"> </span>$<span class="nv">needle</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nv">substr_compare</span><span class="ss">(</span>$<span class="nv">haystack</span>,<span class="w"> </span>$<span class="nv">needle</span>,<span class="w"> </span><span class="mi">0</span>,<span class="w"> </span><span class="k">strlen</span><span class="ss">(</span>$<span class="nv">needle</span><span class="ss">))</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mi">0</span><span class="c1">;</span>
}
<span class="nv">function</span><span class="w"> </span><span class="nv">endsWith</span><span class="ss">(</span>$<span class="nv">haystack</span>,<span class="w"> </span>$<span class="nv">needle</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nv">substr_compare</span><span class="ss">(</span>$<span class="nv">haystack</span>,<span class="w"> </span>$<span class="nv">needle</span>,<span class="w"> </span><span class="o">-</span><span class="k">strlen</span><span class="ss">(</span>$<span class="nv">needle</span><span class="ss">))</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mi">0</span><span class="c1">;</span>
}
</pre></div>

<hr>
<p>This should be one of the fastest solutions on PHP 7 (benchmark script).
Tested against 8KB haystacks, various length needles and full, partial and no
match cases. <code>strncmp</code> is a touch faster for starts-with but it cannot check
ends-with.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-convert-a-string-to-lower-case-in-bash/" class="u-url">How to convert a string to lower case in Bash</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-convert-a-string-to-lower-case-in-bash/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T00:47:23+08:00" itemprop="datePublished" title="2023-02-17 00:47">2023-02-17 00:47</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Is there a way in bash to convert a string into a lower case string?</p>
<p>For example, if I have:</p>
<div class="code"><pre class="code literal-block">a="Hi all"
</pre></div>

<p>I want to convert it to:</p>
<div class="code"><pre class="code literal-block">"hi all"
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<p>The are various ways:</p>
<h3>POSIX standard</h3>
<h4>tr</h4>
<div class="code"><pre class="code literal-block">$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">"</span><span class="nv">$a</span><span class="s2">"</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>tr<span class="w"> </span><span class="s1">'[:upper:]'</span><span class="w"> </span><span class="s1">'[:lower:]'</span>
hi<span class="w"> </span>all
</pre></div>

<h4>AWK</h4>
<div class="code"><pre class="code literal-block">$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">"</span><span class="nv">$a</span><span class="s2">"</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">'{print tolower($0)}'</span>
hi<span class="w"> </span>all
</pre></div>

<h3>Non-POSIX</h3>
<p>You may run into portability issues with the following examples:</p>
<h4>Bash 4.0</h4>
<div class="code"><pre class="code literal-block">$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">"</span><span class="si">${</span><span class="nv">a</span><span class="p">,,</span><span class="si">}</span><span class="s2">"</span>
hi<span class="w"> </span>all
</pre></div>

<h4>sed</h4>
<div class="code"><pre class="code literal-block">$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">"</span><span class="nv">$a</span><span class="s2">"</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sed<span class="w"> </span>-e<span class="w"> </span><span class="s1">'s/\(.*\)/\L\1/'</span>
hi<span class="w"> </span>all
<span class="c1"># this also works:</span>
$<span class="w"> </span>sed<span class="w"> </span>-e<span class="w"> </span><span class="s1">'s/\(.*\)/\L\1/'</span><span class="w"> </span><span class="o">&lt;&lt;&lt;</span><span class="w"> </span><span class="s2">"</span><span class="nv">$a</span><span class="s2">"</span>
hi<span class="w"> </span>all
</pre></div>

<h4>Perl</h4>
<div class="code"><pre class="code literal-block">$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">"</span><span class="nv">$a</span><span class="s2">"</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>perl<span class="w"> </span>-ne<span class="w"> </span><span class="s1">'print lc'</span>
hi<span class="w"> </span>all
</pre></div>

<h4>Bash</h4>
<div class="code"><pre class="code literal-block">lc(){
<span class="w">    </span>case<span class="w"> </span>"$1"<span class="w"> </span>in
<span class="w">        </span>[A-Z])
<span class="w">        </span>n=$(printf<span class="w"> </span>"%d"<span class="w"> </span>"'$1")
<span class="w">        </span>n=$((n+32))
<span class="w">        </span>printf<span class="w"> </span>\\$(printf<span class="w"> </span>"%o"<span class="w"> </span>"<span class="nv">$n</span>")
<span class="w">        </span>;;
<span class="w">        </span>*)
<span class="w">        </span>printf<span class="w"> </span>"%s"<span class="w"> </span>"$1"
<span class="w">        </span>;;
<span class="w">    </span>esac
}
word="I<span class="w"> </span>Love<span class="w"> </span>Bash"
for((i=0;i<span class="err">&lt;</span><span class="cp">${</span><span class="c1">#word</span><span class="cp">}</span>;i++))
do
<span class="w">    </span>ch="<span class="cp">${</span><span class="n">word</span><span class="p">:</span><span class="err">$</span><span class="n">i</span><span class="p">:</span><span class="mi">1</span><span class="cp">}</span>"
<span class="w">    </span>lc<span class="w"> </span>"<span class="nv">$ch</span>"
done
</pre></div>

<p>Note: YMMV on this one. Doesn't work for me (GNU bash version 4.2.46 and
4.0.33 (and same behaviour 2.05b.0 but nocasematch is not implemented)) even
with using <code>shopt -u nocasematch;</code>. Unsetting that nocasematch causes [[
"fooBaR" == "FOObar" ]] to match OK BUT inside case weirdly [b-z] are
incorrectly matched by [A-Z]. Bash is confused by the double-negative
("unsetting nocasematch")! :-)</p>
<p><br></p>
<h3>Suggest</h3>
<p>In Bash 4:</p>
<p>To lowercase</p>
<div class="code"><pre class="code literal-block"><span class="err">$</span><span class="w"> </span><span class="n">string</span><span class="o">=</span><span class="ss">"A FEW WORDS"</span>
<span class="err">$</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="ss">"${string,}"</span>
<span class="n">a</span><span class="w"> </span><span class="n">FEW</span><span class="w"> </span><span class="n">WORDS</span>
<span class="err">$</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="ss">"${string,,}"</span>
<span class="n">a</span><span class="w"> </span><span class="n">few</span><span class="w"> </span><span class="n">words</span>
<span class="err">$</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="ss">"${string,,[AEIUO]}"</span>
<span class="n">a</span><span class="w"> </span><span class="n">FeW</span><span class="w"> </span><span class="n">WoRDS</span>

<span class="err">$</span><span class="w"> </span><span class="n">string</span><span class="o">=</span><span class="ss">"A Few Words"</span>
<span class="err">$</span><span class="w"> </span><span class="k">declare</span><span class="w"> </span><span class="o">-</span><span class="n">l</span><span class="w"> </span><span class="n">string</span>
<span class="err">$</span><span class="w"> </span><span class="n">string</span><span class="o">=</span><span class="err">$</span><span class="n">string</span><span class="p">;</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="ss">"$string"</span>
<span class="n">a</span><span class="w"> </span><span class="n">few</span><span class="w"> </span><span class="n">words</span>
</pre></div>

<p>To uppercase</p>
<div class="code"><pre class="code literal-block"><span class="err">$</span><span class="w"> </span><span class="n">string</span><span class="o">=</span><span class="ss">"a few words"</span>
<span class="err">$</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="ss">"${string^}"</span>
<span class="n">A</span><span class="w"> </span><span class="n">few</span><span class="w"> </span><span class="n">words</span>
<span class="err">$</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="ss">"${string^^}"</span>
<span class="n">A</span><span class="w"> </span><span class="n">FEW</span><span class="w"> </span><span class="n">WORDS</span>
<span class="err">$</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="ss">"${string^^[aeiou]}"</span>
<span class="n">A</span><span class="w"> </span><span class="n">fEw</span><span class="w"> </span><span class="n">wOrds</span>

<span class="err">$</span><span class="w"> </span><span class="n">string</span><span class="o">=</span><span class="ss">"A Few Words"</span>
<span class="err">$</span><span class="w"> </span><span class="k">declare</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="n">string</span>
<span class="err">$</span><span class="w"> </span><span class="n">string</span><span class="o">=</span><span class="err">$</span><span class="n">string</span><span class="p">;</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="ss">"$string"</span>
<span class="n">A</span><span class="w"> </span><span class="n">FEW</span><span class="w"> </span><span class="n">WORDS</span>
</pre></div>

<p>Toggle (undocumented, but optionally configurable at compile time)</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span><span class="nv">string</span><span class="o">=</span><span class="s2">"A Few Words"</span>
$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">"</span><span class="si">${</span><span class="nv">string</span><span class="p">~~</span><span class="si">}</span><span class="s2">"</span>
a<span class="w"> </span>fEW<span class="w"> </span>wORDS
$<span class="w"> </span><span class="nv">string</span><span class="o">=</span><span class="s2">"A FEW WORDS"</span>
$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">"</span><span class="si">${</span><span class="nv">string</span><span class="p">~</span><span class="si">}</span><span class="s2">"</span>
a<span class="w"> </span>FEW<span class="w"> </span>WORDS
$<span class="w"> </span><span class="nv">string</span><span class="o">=</span><span class="s2">"a few words"</span>
$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">"</span><span class="si">${</span><span class="nv">string</span><span class="p">~</span><span class="si">}</span><span class="s2">"</span>
A<span class="w"> </span>few<span class="w"> </span>words
</pre></div>

<p>Capitalize (undocumented, but optionally configurable at compile time)</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span><span class="nv">string</span><span class="o">=</span><span class="s2">"a few words"</span>
$<span class="w"> </span><span class="nb">declare</span><span class="w"> </span>-c<span class="w"> </span>string
$<span class="w"> </span><span class="nv">string</span><span class="o">=</span><span class="nv">$string</span>
$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">"</span><span class="nv">$string</span><span class="s2">"</span>
A<span class="w"> </span>few<span class="w"> </span>words
</pre></div>

<p>Title case:</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span><span class="nv">string</span><span class="o">=</span><span class="s2">"a few words"</span>
$<span class="w"> </span><span class="nv">string</span><span class="o">=(</span><span class="nv">$string</span><span class="o">)</span>
$<span class="w"> </span><span class="nv">string</span><span class="o">=</span><span class="s2">"</span><span class="si">${</span><span class="nv">string</span><span class="p">[@]^</span><span class="si">}</span><span class="s2">"</span>
$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">"</span><span class="nv">$string</span><span class="s2">"</span>
A<span class="w"> </span>Few<span class="w"> </span>Words

$<span class="w"> </span><span class="nb">declare</span><span class="w"> </span>-c<span class="w"> </span>string
$<span class="w"> </span><span class="nv">string</span><span class="o">=(</span>a<span class="w"> </span>few<span class="w"> </span>words<span class="o">)</span>
$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">"</span><span class="si">${</span><span class="nv">string</span><span class="p">[@]</span><span class="si">}</span><span class="s2">"</span>
A<span class="w"> </span>Few<span class="w"> </span>Words

$<span class="w"> </span><span class="nv">string</span><span class="o">=</span><span class="s2">"a FeW WOrdS"</span>
$<span class="w"> </span><span class="nv">string</span><span class="o">=</span><span class="si">${</span><span class="nv">string</span><span class="p">,,</span><span class="si">}</span>
$<span class="w"> </span><span class="nv">string</span><span class="o">=</span><span class="si">${</span><span class="nv">string</span><span class="p">~</span><span class="si">}</span>
$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">"</span><span class="nv">$string</span><span class="s2">"</span>
A<span class="w"> </span>few<span class="w"> </span>words
</pre></div>

<p>To turn off a <code>declare</code> attribute, use <code>+</code>. For example, <code>declare +c string</code>.
This affects subsequent assignments and not the current value.</p>
<p>The <code>declare</code> options change the attribute of the variable, but not the
contents. The reassignments in my examples update the contents to show the
changes.</p>
<p><strong>Edit:</strong></p>
<p>Added "toggle first character by word" (<code>${var~}</code>) as suggested by
<strong>ghostdog74</strong>.</p>
<p><strong>Edit:</strong> Corrected tilde behavior to match Bash 4.3.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-206.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-204.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
