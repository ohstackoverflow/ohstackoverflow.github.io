<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 1347) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-1347.html">
<link rel="prev" href="index-1348.html" type="text/html">
<link rel="next" href="index-1346.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/in-android-how-do-i-set-margins-in-dp-programmatically/" class="u-url">In Android, how do I set margins in dp programmatically?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/in-android-how-do-i-set-margins-in-dp-programmatically/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T07:13:37+08:00" itemprop="datePublished" title="2023-02-18 07:13">2023-02-18 07:13</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>In this, this and this thread I tried to find an answer on how to set the
margins on a single view. However, I was wondering if there isn't an easier
way. I'll explain why I rather wouldn't want to use this approach:</p>
<p>I have a custom Button which extends Button. If the background is set to
something else than the default background (by calling either
<code>setBackgroundResource(int id)</code> or <code>setBackgroundDrawable(Drawable d)</code>), I
want the margins to be 0. If I call this:</p>
<div class="code"><pre class="code literal-block">public void setBackgroundToDefault() {
    backgroundIsDefault = true;
    super.setBackgroundResource(android.R.drawable.btn_default);
    // Set margins somehow
}
</pre></div>

<p>I want the margins to reset to -3dp (I already read here how to convert from
pixels to dp, so once I know how to set margins in px, I can manage the
conversion myself). But since this is called in the <code>CustomButton</code> class, the
parent can vary from LinearLayout to TableLayout, and I'd rather not have him
get his parent and check the instanceof that parent. That'll also be quite
inperformant, I imagine.</p>
<p>Also, when calling (using LayoutParams) <code>parentLayout.addView(myCustomButton,
newParams)</code>, I don't know if this adds it to the correct position (haven't
tried however), say the middle button of a row of five.</p>
<p>Question: Is there any easier way to set the margin of a single Button
programmatically <strong>besides using LayoutParams?</strong></p>
<p>EDIT: I know of the LayoutParams way, but I'd like a solution that avoids
handling each different container type:</p>
<div class="code"><pre class="code literal-block"><span class="nv">ViewGroup</span>.<span class="nv">LayoutParams</span><span class="w"> </span><span class="nv">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">this</span>.<span class="nv">getLayoutParams</span><span class="ss">()</span><span class="c1">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">p</span><span class="w"> </span><span class="nv">instanceof</span><span class="w"> </span><span class="nv">LinearLayout</span>.<span class="nv">LayoutParams</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">        </span><span class="nv">LinearLayout</span>.<span class="nv">LayoutParams</span><span class="w"> </span><span class="nv">lp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">(</span><span class="nv">LinearLayout</span>.<span class="nv">LayoutParams</span><span class="ss">)</span><span class="nv">p</span><span class="c1">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">_default</span><span class="ss">)</span><span class="w"> </span><span class="nv">lp</span>.<span class="nv">setMargins</span><span class="ss">(</span><span class="nv">mc</span>.<span class="nv">oml</span>,<span class="w"> </span><span class="nv">mc</span>.<span class="nv">omt</span>,<span class="w"> </span><span class="nv">mc</span>.<span class="nv">omr</span>,<span class="w"> </span><span class="nv">mc</span>.<span class="nv">omb</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="nv">lp</span>.<span class="nv">setMargins</span><span class="ss">(</span><span class="nv">mc</span>.<span class="nv">ml</span>,<span class="w"> </span><span class="nv">mc</span>.<span class="nv">mt</span>,<span class="w"> </span><span class="nv">mc</span>.<span class="nv">mr</span>,<span class="w"> </span><span class="nv">mc</span>.<span class="nv">mb</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">        </span><span class="nv">this</span>.<span class="nv">setLayoutParams</span><span class="ss">(</span><span class="nv">lp</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">    </span>}
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">p</span><span class="w"> </span><span class="nv">instanceof</span><span class="w"> </span><span class="nv">RelativeLayout</span>.<span class="nv">LayoutParams</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">        </span><span class="nv">RelativeLayout</span>.<span class="nv">LayoutParams</span><span class="w"> </span><span class="nv">lp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">(</span><span class="nv">RelativeLayout</span>.<span class="nv">LayoutParams</span><span class="ss">)</span><span class="nv">p</span><span class="c1">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">_default</span><span class="ss">)</span><span class="w"> </span><span class="nv">lp</span>.<span class="nv">setMargins</span><span class="ss">(</span><span class="nv">mc</span>.<span class="nv">oml</span>,<span class="w"> </span><span class="nv">mc</span>.<span class="nv">omt</span>,<span class="w"> </span><span class="nv">mc</span>.<span class="nv">omr</span>,<span class="w"> </span><span class="nv">mc</span>.<span class="nv">omb</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="nv">lp</span>.<span class="nv">setMargins</span><span class="ss">(</span><span class="nv">mc</span>.<span class="nv">ml</span>,<span class="w"> </span><span class="nv">mc</span>.<span class="nv">mt</span>,<span class="w"> </span><span class="nv">mc</span>.<span class="nv">mr</span>,<span class="w"> </span><span class="nv">mc</span>.<span class="nv">mb</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">        </span><span class="nv">this</span>.<span class="nv">setLayoutParams</span><span class="ss">(</span><span class="nv">lp</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">    </span>}
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">p</span><span class="w"> </span><span class="nv">instanceof</span><span class="w"> </span><span class="nv">TableRow</span>.<span class="nv">LayoutParams</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">        </span><span class="nv">TableRow</span>.<span class="nv">LayoutParams</span><span class="w"> </span><span class="nv">lp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">(</span><span class="nv">TableRow</span>.<span class="nv">LayoutParams</span><span class="ss">)</span><span class="nv">p</span><span class="c1">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">_default</span><span class="ss">)</span><span class="w"> </span><span class="nv">lp</span>.<span class="nv">setMargins</span><span class="ss">(</span><span class="nv">mc</span>.<span class="nv">oml</span>,<span class="w"> </span><span class="nv">mc</span>.<span class="nv">omt</span>,<span class="w"> </span><span class="nv">mc</span>.<span class="nv">omr</span>,<span class="w"> </span><span class="nv">mc</span>.<span class="nv">omb</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="nv">lp</span>.<span class="nv">setMargins</span><span class="ss">(</span><span class="nv">mc</span>.<span class="nv">ml</span>,<span class="w"> </span><span class="nv">mc</span>.<span class="nv">mt</span>,<span class="w"> </span><span class="nv">mc</span>.<span class="nv">mr</span>,<span class="w"> </span><span class="nv">mc</span>.<span class="nv">mb</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">        </span><span class="nv">this</span>.<span class="nv">setLayoutParams</span><span class="ss">(</span><span class="nv">lp</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">    </span>}
}
</pre></div>

<p>Because <code>this.getLayoutParams();</code>returns a <code>ViewGroup.LayoutParams</code>, which do
not have the attributes <code>topMargin</code>, <code>bottomMargin</code>, <code>leftMargin</code>,
<code>rightMargin</code>. The mc instance you see is just a <code>MarginContainer</code> which
contains offset (-3dp) margins and (oml, omr, omt, omb) and the original
margins (ml, mr, mt, mb).</p>
<p><br><br></p>
<h2>Answer</h2>
<p>You should use <code>LayoutParams</code> to set your button margins:</p>
<div class="code"><pre class="code literal-block">LayoutParams params = new LayoutParams(
        LayoutParams.WRAP_CONTENT,      
        LayoutParams.WRAP_CONTENT
);
params.setMargins(left, top, right, bottom);
yourbutton.setLayoutParams(params);
</pre></div>

<p>Depending on what layout you're using you should use
<code>RelativeLayout.LayoutParams</code> or <code>LinearLayout.LayoutParams</code>.</p>
<p>And to convert your dp measure to pixel, try this:</p>
<div class="code"><pre class="code literal-block">Resources r = mContext.getResources();
int px = (int) TypedValue.applyDimension(
        TypedValue.COMPLEX_UNIT_DIP,
        yourdpmeasure, 
        r.getDisplayMetrics()
);
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>LayoutParams - NOT WORKING ! ! !</p>
<p>Need use type of: MarginLayoutParams</p>
<div class="code"><pre class="code literal-block">MarginLayoutParams params = (MarginLayoutParams) vector8.getLayoutParams();
params.width = 200; params.leftMargin = 100; params.topMargin = 200;
</pre></div>

<p>Code Example for MarginLayoutParams:</p>
<p>http://www.codota.com/android/classes/android.view.ViewGroup.MarginLayoutParams</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-can-i-get-form-data-with-javascript-jquery/" class="u-url">How can I get form data with JavaScript/jQuery?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-can-i-get-form-data-with-javascript-jquery/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T07:13:08+08:00" itemprop="datePublished" title="2023-02-18 07:13">2023-02-18 07:13</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Is there a simple, one-line way to get the data of a form as it would be if it
was to be submitted in the classic HTML-only way?</p>
<p>For example:</p>
<div class="code"><pre class="code literal-block"><span class="nt">&lt;form&gt;</span>
<span class="w">    </span><span class="nt">&lt;input</span><span class="w"> </span><span class="na">type=</span><span class="s">"radio"</span><span class="w"> </span><span class="na">name=</span><span class="s">"foo"</span><span class="w"> </span><span class="na">value=</span><span class="s">"1"</span><span class="w"> </span><span class="na">checked=</span><span class="s">"checked"</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;input</span><span class="w"> </span><span class="na">type=</span><span class="s">"radio"</span><span class="w"> </span><span class="na">name=</span><span class="s">"foo"</span><span class="w"> </span><span class="na">value=</span><span class="s">"0"</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;input</span><span class="w"> </span><span class="na">name=</span><span class="s">"bar"</span><span class="w"> </span><span class="na">value=</span><span class="s">"xxx"</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;select</span><span class="w"> </span><span class="na">name=</span><span class="s">"this"</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;option</span><span class="w"> </span><span class="na">value=</span><span class="s">"hi"</span><span class="w"> </span><span class="na">selected=</span><span class="s">"selected"</span><span class="nt">&gt;</span>Hi<span class="nt">&lt;/option&gt;</span>
<span class="w">        </span><span class="nt">&lt;option</span><span class="w"> </span><span class="na">value=</span><span class="s">"ho"</span><span class="nt">&gt;</span>Ho<span class="nt">&lt;/option&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</pre></div>

<p>Output:</p>
<div class="code"><pre class="code literal-block">{
    "foo": "1",
    "bar": "xxx",
    "this": "hi"
}
</pre></div>

<p>Something like this is too simple, since it does not (correctly) include
textareas, selects, radio buttons and checkboxes:</p>
<div class="code"><pre class="code literal-block"><span class="err">$</span><span class="p">(</span><span class="ss">"#form input"</span><span class="p">).</span><span class="k">each</span><span class="p">(</span><span class="k">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="k">data</span><span class="o">[</span><span class="n">theFieldName</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">theFieldValue</span><span class="p">;</span>
<span class="err">}</span><span class="p">);</span>
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<div class="code"><pre class="code literal-block">$('form').serialize() //this produces: "foo=1&amp;bar=xxx&amp;this=hi"
</pre></div>

<p>demo</p>
<p><br></p>
<h3>Suggest</h3>
<div class="code"><pre class="code literal-block">$('form').serialize() //this produces: "foo=1&amp;bar=xxx&amp;this=hi"
</pre></div>

<p>demo</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/possible-heap-pollution-via-varargs-parameter/" class="u-url">Possible heap pollution via varargs parameter</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/possible-heap-pollution-via-varargs-parameter/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T07:12:40+08:00" itemprop="datePublished" title="2023-02-18 07:12">2023-02-18 07:12</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I understand this occurs with Java 7 when using varargs with a generic type;</p>
<p>But my question is..</p>
<p>What exactly does Eclipse mean when it says "its use could potentially pollute
the heap?"</p>
<p>And</p>
<p>How does the new <code>@SafeVarargs</code> annotation prevent this?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Heap pollution is a technical term. It refers to references which have a type
that is not a supertype of the object they point to.</p>
<div class="code"><pre class="code literal-block">List&lt;A&gt; listOfAs = new ArrayList&lt;&gt;();
List&lt;B&gt; listOfBs = (List&lt;B&gt;)(Object)listOfAs; // points to a list of As
</pre></div>

<p>This can lead to "unexplainable" <code>ClassCastException</code>s.</p>
<div class="code"><pre class="code literal-block"><span class="c1">// if the heap never gets polluted, this should never throw a CCE</span>
<span class="n">B</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">listOfBs</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</pre></div>

<p><code>@SafeVarargs</code> does not prevent this at all. However, there are methods which
probably will not pollute the heap, the compiler just can't prove it.
Previously, callers of such APIs would get annoying warnings that were
completely pointless but had to be suppressed at every call site. Now the API
author can suppress it once at the declaration site.</p>
<p>However, if the method actually is <em>not</em> safe, users will no longer be warned.</p>
<p><br></p>
<h3>Suggest</h3>
<p>When you declare</p>
<p><code>public static &lt;T&gt; void foo(List&lt;T&gt;... bar)</code> the compiler converts it to</p>
<p><code>public static &lt;T&gt; void foo(List&lt;T&gt;[] bar)</code> then to</p>
<p><code>public static void foo(List[] bar)</code></p>
<p>The danger then arises that you'll mistakenly assign incorrect values into the
list and the compiler will not trigger any error. For example, if <code>T</code> is a
<code>String</code> then the following code will compile without error but will fail at
runtime:</p>
<div class="code"><pre class="code literal-block"><span class="c1">// First, strip away the array type (arrays allow this kind of upcasting)</span>
<span class="n">Object</span><span class="p">[]</span><span class="w"> </span><span class="n">objectArray</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">bar</span><span class="p">;</span>

<span class="c1">// Next, insert an element with an incorrect type into the array</span>
<span class="n">objectArray</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Arrays</span><span class="p">.</span><span class="n">asList</span><span class="p">(</span><span class="n">new</span><span class="w"> </span><span class="n">Integer</span><span class="p">(</span><span class="mi">42</span><span class="p">));</span>

<span class="c1">// Finally, try accessing the original array. A runtime error will occur</span>
<span class="c1">// (ClassCastException due to a casting from Integer to String)</span>
<span class="n">T</span><span class="w"> </span><span class="n">firstElement</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">bar</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="k">get</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</pre></div>

<p>If you reviewed the method to ensure that it doesn't contain such
vulnerabilities then you can annotate it with <code>@SafeVarargs</code> to suppress the
warning. For interfaces, use <code>@SuppressWarnings("unchecked")</code>.</p>
<p>If you get this error message:</p>
<blockquote>
<p>Varargs method could cause heap pollution from non-reifiable varargs
parameter</p>
</blockquote>
<p>and you are sure that your usage is safe then you should use
<code>@SuppressWarnings("varargs")</code> instead. See Is @SafeVarargs an appropriate
annotation for this method? and https://stackoverflow.com/a/14252221/14731 for
a nice explanation of this second kind of error.</p>
<p>References:</p>
<ul>
<li>http://docs.oracle.com/javase/7/docs/technotes/guides/language/non-reifiable-varargs.html</li>
<li>http://docs.oracle.com/javase/tutorial/java/generics/nonReifiableVarargsType.html#heap_pollution</li>
</ul>
</div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-1348.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-1346.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
