<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 566) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-566.html">
<link rel="prev" href="index-567.html" type="text/html">
<link rel="next" href="index-565.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/identify-if-a-string-is-a-number/" class="u-url">Identify if a string is a number</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/identify-if-a-string-is-a-number/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T10:06:09+08:00" itemprop="datePublished" title="2023-02-17 10:06">2023-02-17 10:06</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>If I have these strings:</p>
<ol>
<li>
<p><code>"abc"</code> = <code>false</code></p>
</li>
<li>
<p><code>"123"</code> = <code>true</code></p>
</li>
<li>
<p><code>"ab2"</code> = <code>false</code></p>
</li>
</ol>
<p>Is there a command, like <code>IsNumeric()</code> or something else, that can identify if
a string is a valid number?</p>
<p><br><br></p>
<h2>Answer</h2>
<div class="code"><pre class="code literal-block">int n;
bool isNumeric = int.TryParse("123", out n);
</pre></div>

<p><strong>Update</strong> As of C# 7:</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">isNumeric</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="o">.</span><span class="n">TryParse</span><span class="p">(</span><span class="s2">"123"</span><span class="p">,</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">n</span><span class="p">);</span>
</pre></div>

<p>or if you don't need the number you can discard the out parameter</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">isNumeric</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="o">.</span><span class="n">TryParse</span><span class="p">(</span><span class="s2">"123"</span><span class="p">,</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="n">_</span><span class="p">);</span>
</pre></div>

<p>The <em>var</em> s can be replaced by their respective types!</p>
<p><br></p>
<h3>Suggest</h3>
<p>This will return true if <code>input</code> is all numbers. Don't know if it's any better
than <code>TryParse</code>, but it will work.</p>
<div class="code"><pre class="code literal-block"><span class="n">Regex</span><span class="p">.</span><span class="n">IsMatch</span><span class="p">(</span><span class="n">input</span><span class="p">,</span><span class="w"> </span><span class="s">@"^\d+$"</span><span class="p">)</span>
</pre></div>

<p>If you just want to know if it has one or more numbers mixed in with
characters, leave off the <code>^</code> <code>+</code> and <code>$</code>.</p>
<div class="code"><pre class="code literal-block"><span class="n">Regex</span><span class="p">.</span><span class="n">IsMatch</span><span class="p">(</span><span class="n">input</span><span class="p">,</span><span class="w"> </span><span class="s">@"\d"</span><span class="p">)</span>
</pre></div>

<p><strong>Edit:</strong> Actually I think it is better than TryParse because a very long
string could potentially overflow TryParse.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-check-ios-version/" class="u-url">How to check iOS version?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-check-ios-version/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T10:05:39+08:00" itemprop="datePublished" title="2023-02-17 10:05">2023-02-17 10:05</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I want to check if the <code>iOS</code> version of the device is greater than <code>3.1.3</code> I
tried things like:</p>
<div class="code"><pre class="code literal-block"><span class="p">[[</span><span class="bp">UIDevice</span><span class="w"> </span><span class="n">currentDevice</span><span class="p">].</span><span class="n">systemVersion</span><span class="w"> </span><span class="n">floatValue</span><span class="p">]</span>
</pre></div>

<p>but it does not work, I just want a:</p>
<div class="code"><pre class="code literal-block"><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">version</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">3</span>.<span class="mi">1</span>.<span class="mi">3</span><span class="ss">)</span><span class="w"> </span>{<span class="w"> </span>}
</pre></div>

<p>How can I achieve this?</p>
<p><br><br></p>
<h2>Answer</h2>
<h4>The quick answer …</h4>
<p>As of Swift 2.0, you can use <code>#available</code> in an <code>if</code> or <code>guard</code> to protect
code that should only be run on certain systems.</p>
<p><code>if #available(iOS 9, *) {}</code>  </p>
<p>In Objective-C, you need to check the system version and perform a comparison.</p>
<p><code>[[NSProcessInfo processInfo] operatingSystemVersion]</code> in iOS 8 and above.</p>
<p>As of Xcode 9:</p>
<p><code>if (@available(iOS 9, *)) {}</code></p>
<h3>The full answer …</h3>
<p>In Objective-C, and Swift in rare cases, it's better to avoid relying on the
operating system version as an indication of device or OS capabilities. There
is usually a more reliable method of checking whether a particular feature or
class is available.</p>
<p><strong>Checking for the presence of APIs:</strong></p>
<p>For example, you can check if <code>UIPopoverController</code> is available on the
current device using <code>NSClassFromString</code>:</p>
<div class="code"><pre class="code literal-block"><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">NSClassFromString</span><span class="p">(</span><span class="s">@"UIPopoverController"</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Do something</span>
<span class="p">}</span>
</pre></div>

<p>For weakly linked classes, it is safe to message the class, directly. Notably,
this works for frameworks that aren't explicitly linked as "Required". For
missing classes, the expression evaluates to nil, failing the condition:</p>
<div class="code"><pre class="code literal-block"><span class="k">if</span><span class="w"> </span><span class="p">([</span><span class="bp">LAContext</span><span class="w"> </span><span class="k">class</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Do something</span>
<span class="p">}</span>
</pre></div>

<p>Some classes, like <code>CLLocationManager</code> and <code>UIDevice</code>, provide methods to
check device capabilities:</p>
<div class="code"><pre class="code literal-block"><span class="k">if</span><span class="w"> </span><span class="p">([</span><span class="bp">CLLocationManager</span><span class="w"> </span><span class="n">headingAvailable</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Do something</span>
<span class="p">}</span>
</pre></div>

<p><strong>Checking for the presence of symbols:</strong></p>
<p>Very occasionally, you must check for the presence of a constant. This came up
in iOS 8 with the introduction of <code>UIApplicationOpenSettingsURLString</code>, used
to load Settings app via <code>-openURL:</code>. The value didn't exist prior to iOS 8.
Passing nil to this API will crash, so you must take care to verify the
existence of the constant first:</p>
<div class="code"><pre class="code literal-block"><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">&amp;</span><span class="n">UIApplicationOpenSettingsURLString</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="p">[[</span><span class="bp">UIApplication</span><span class="w"> </span><span class="n">sharedApplication</span><span class="p">]</span><span class="w"> </span><span class="n">openURL</span><span class="o">:</span><span class="p">[</span><span class="bp">NSURL</span><span class="w"> </span><span class="n">URLWithString</span><span class="o">:</span><span class="n">UIApplicationOpenSettingsURLString</span><span class="p">]];</span>
<span class="p">}</span>
</pre></div>

<p><strong>Comparing against the operating system version:</strong></p>
<p>Let's assume you're faced with the relatively rare need to check the operating
system version. For projects targeting iOS 8 and above, <code>NSProcessInfo</code>
includes a method for performing version comparisons with less chance of
error:</p>
<div class="code"><pre class="code literal-block">- (BOOL)isOperatingSystemAtLeastVersion:(NSOperatingSystemVersion)version
</pre></div>

<p>Projects targeting older systems can use <code>systemVersion</code> on <code>UIDevice</code>. Apple
uses it in their GLSprite sample code.</p>
<div class="code"><pre class="code literal-block"><span class="c1">// A system version of 3.1 or greater is required to use CADisplayLink. The NSTimer</span>
<span class="c1">// class is used as fallback when it isn't available.</span>
<span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">reqSysVer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">@"3.1"</span><span class="p">;</span>
<span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">currSysVer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="bp">UIDevice</span><span class="w"> </span><span class="n">currentDevice</span><span class="p">]</span><span class="w"> </span><span class="n">systemVersion</span><span class="p">];</span>
<span class="k">if</span><span class="w"> </span><span class="p">([</span><span class="n">currSysVer</span><span class="w"> </span><span class="n">compare</span><span class="o">:</span><span class="n">reqSysVer</span><span class="w"> </span><span class="n">options</span><span class="o">:</span><span class="n">NSNumericSearch</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">NSOrderedAscending</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">displayLinkSupported</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">TRUE</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<p>If for whatever reason you decide that <code>systemVersion</code> is what you want, make
sure to treat it as an string or you risk truncating the patch revision number
(eg. 3.1.2 -&gt; 3.1).</p>
<p><br></p>
<h3>Suggest</h3>
<h4>The quick answer …</h4>
<p>As of Swift 2.0, you can use <code>#available</code> in an <code>if</code> or <code>guard</code> to protect
code that should only be run on certain systems.</p>
<p><code>if #available(iOS 9, *) {}</code>  </p>
<p>In Objective-C, you need to check the system version and perform a comparison.</p>
<p><code>[[NSProcessInfo processInfo] operatingSystemVersion]</code> in iOS 8 and above.</p>
<p>As of Xcode 9:</p>
<p><code>if (@available(iOS 9, *)) {}</code></p>
<h3>The full answer …</h3>
<p>In Objective-C, and Swift in rare cases, it's better to avoid relying on the
operating system version as an indication of device or OS capabilities. There
is usually a more reliable method of checking whether a particular feature or
class is available.</p>
<p><strong>Checking for the presence of APIs:</strong></p>
<p>For example, you can check if <code>UIPopoverController</code> is available on the
current device using <code>NSClassFromString</code>:</p>
<div class="code"><pre class="code literal-block"><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">NSClassFromString</span><span class="p">(</span><span class="s">@"UIPopoverController"</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Do something</span>
<span class="p">}</span>
</pre></div>

<p>For weakly linked classes, it is safe to message the class, directly. Notably,
this works for frameworks that aren't explicitly linked as "Required". For
missing classes, the expression evaluates to nil, failing the condition:</p>
<div class="code"><pre class="code literal-block"><span class="k">if</span><span class="w"> </span><span class="p">([</span><span class="bp">LAContext</span><span class="w"> </span><span class="k">class</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Do something</span>
<span class="p">}</span>
</pre></div>

<p>Some classes, like <code>CLLocationManager</code> and <code>UIDevice</code>, provide methods to
check device capabilities:</p>
<div class="code"><pre class="code literal-block"><span class="k">if</span><span class="w"> </span><span class="p">([</span><span class="bp">CLLocationManager</span><span class="w"> </span><span class="n">headingAvailable</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Do something</span>
<span class="p">}</span>
</pre></div>

<p><strong>Checking for the presence of symbols:</strong></p>
<p>Very occasionally, you must check for the presence of a constant. This came up
in iOS 8 with the introduction of <code>UIApplicationOpenSettingsURLString</code>, used
to load Settings app via <code>-openURL:</code>. The value didn't exist prior to iOS 8.
Passing nil to this API will crash, so you must take care to verify the
existence of the constant first:</p>
<div class="code"><pre class="code literal-block"><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">&amp;</span><span class="n">UIApplicationOpenSettingsURLString</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="p">[[</span><span class="bp">UIApplication</span><span class="w"> </span><span class="n">sharedApplication</span><span class="p">]</span><span class="w"> </span><span class="n">openURL</span><span class="o">:</span><span class="p">[</span><span class="bp">NSURL</span><span class="w"> </span><span class="n">URLWithString</span><span class="o">:</span><span class="n">UIApplicationOpenSettingsURLString</span><span class="p">]];</span>
<span class="p">}</span>
</pre></div>

<p><strong>Comparing against the operating system version:</strong></p>
<p>Let's assume you're faced with the relatively rare need to check the operating
system version. For projects targeting iOS 8 and above, <code>NSProcessInfo</code>
includes a method for performing version comparisons with less chance of
error:</p>
<div class="code"><pre class="code literal-block">- (BOOL)isOperatingSystemAtLeastVersion:(NSOperatingSystemVersion)version
</pre></div>

<p>Projects targeting older systems can use <code>systemVersion</code> on <code>UIDevice</code>. Apple
uses it in their GLSprite sample code.</p>
<div class="code"><pre class="code literal-block"><span class="c1">// A system version of 3.1 or greater is required to use CADisplayLink. The NSTimer</span>
<span class="c1">// class is used as fallback when it isn't available.</span>
<span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">reqSysVer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">@"3.1"</span><span class="p">;</span>
<span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">currSysVer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="bp">UIDevice</span><span class="w"> </span><span class="n">currentDevice</span><span class="p">]</span><span class="w"> </span><span class="n">systemVersion</span><span class="p">];</span>
<span class="k">if</span><span class="w"> </span><span class="p">([</span><span class="n">currSysVer</span><span class="w"> </span><span class="n">compare</span><span class="o">:</span><span class="n">reqSysVer</span><span class="w"> </span><span class="n">options</span><span class="o">:</span><span class="n">NSNumericSearch</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">NSOrderedAscending</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">displayLinkSupported</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">TRUE</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<p>If for whatever reason you decide that <code>systemVersion</code> is what you want, make
sure to treat it as an string or you risk truncating the patch revision number
(eg. 3.1.2 -&gt; 3.1).</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/android-os-fileuriexposedexception-file-storage-emulated-0-test-txt-exposed-beyond-app-through-intent-getdata/" class="u-url">android.os.FileUriExposedException: file:///storage/emulated/0/test.txt exposed beyond app through Intent.getData()</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/android-os-fileuriexposedexception-file-storage-emulated-0-test-txt-exposed-beyond-app-through-intent-getdata/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T10:04:49+08:00" itemprop="datePublished" title="2023-02-17 10:04">2023-02-17 10:04</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>The app is crashing when I'm trying to open a file. It works below Android
Nougat, but on Android Nougat it crashes. It only crashes when I try to open a
file from the SD card, not from the system partition. Some permission problem?</p>
<p>Sample code:</p>
<div class="code"><pre class="code literal-block">File file = new File("/storage/emulated/0/test.txt");
Intent intent = new Intent(Intent.ACTION_VIEW);
intent.setDataAndType(Uri.fromFile(file), "text/*");
intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
startActivity(intent); // Crashes on this line
</pre></div>

<p>Log:</p>
<blockquote>
<p>android.os.FileUriExposedException: file:///storage/emulated/0/test.txt
exposed beyond app through Intent.getData()</p>
</blockquote>
<p><strong>Edit:</strong></p>
<p>When targeting Android Nougat, <code>file://</code> URIs are not allowed anymore. We
should use <code>content://</code> URIs instead. However, my app needs to open files in
root directories. Any ideas?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>If your <code>targetSdkVersion &gt;= 24</code>, then we have to use <code>FileProvider</code> class to
give access to the particular file or folder to make them accessible for other
apps. We create our own class inheriting <code>FileProvider</code> in order to make sure
our FileProvider doesn't conflict with FileProviders declared in imported
dependencies as described here.</p>
<p>Steps to replace <code>file://</code> URI with <code>content://</code> URI:</p>
<ul>
<li>
<p>Add a FileProvider <code>&lt;provider&gt;</code> tag in <code>AndroidManifest.xml</code> under <code>&lt;application&gt;</code> tag. Specify a unique authority for the <code>android:authorities</code> attribute to avoid conflicts, imported dependencies might specify <code>${applicationId}.provider</code> and other commonly used authorities.</p>
<p>&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;manifest xmlns:android="http://schemas.android.com/apk/res/android"
    ...
    &lt;application
        ...
        <provider android:name="androidx.core.content.FileProvider" android:authorities="${applicationId}.provider" android:exported="false" android:granturipermissions="true"><meta-data android:name="android.support.FILE_PROVIDER_PATHS" android:resource="@xml/provider_paths"></meta-data></provider></p>
</li>
<li>
<p>Then create a <code>provider_paths.xml</code> file in <code>res/xml</code> folder. A folder may be needed to be created if it doesn't exist yet. The content of the file is shown below. It describes that we would like to share access to the External Storage at root folder <code>(path=".")</code> with the name <strong>external_files</strong>.</p>
<p>&lt;?xml version="1.0" encoding="utf-8"?&gt;
<paths><external-path name="external_files" path="."></external-path></paths></p>
</li>
<li>
<p>The final step is to change the line of code below in</p>
<div class="code"><pre class="code literal-block"> Uri photoURI = Uri.fromFile(createImageFile());
</pre></div>

</li>
</ul>
<p>to</p>
<div class="code"><pre class="code literal-block">     Uri photoURI = FileProvider.getUriForFile(context, context.getApplicationContext().getPackageName() + ".provider", createImageFile());
</pre></div>

<ul>
<li>
<strong>Edit:</strong> If you're using an intent to make the system open your file, you may need to add the following line of code:<div class="code"><pre class="code literal-block"> intent.addFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION);
</pre></div>

</li>
</ul>
<p>Please refer to the full code and solution that have been explained here.</p>
<p><br></p>
<h3>Suggest</h3>
<p>Besides the solution using the <code>FileProvider</code>, there is another way to work
around this. Simply put</p>
<div class="code"><pre class="code literal-block">StrictMode.VmPolicy.Builder builder = new StrictMode.VmPolicy.Builder();
StrictMode.setVmPolicy(builder.build());
</pre></div>

<p>in <code>Application.onCreate()</code>. In this way the VM ignores the file <code>URI</code>
exposure.</p>
<p><strong>Method</strong></p>
<div class="code"><pre class="code literal-block">builder.detectFileUriExposure()
</pre></div>

<p>enables the file exposure check, which is also the default behavior if we
don't setup a VmPolicy.</p>
<p>I encountered a problem that if I use a <code>content://</code> <code>URI</code> to send something,
some apps just can't understand it. And downgrading the <code>target SDK</code> version
is not allowed. In this case my solution is useful.</p>
<p><strong>Update:</strong></p>
<p>As mentioned in the comment, StrictMode is diagnostic tool, and is not
supposed to be used for this problem. When I posted this answer a year ago,
many apps can only receive File uris. They just crash when I tried to send a
FileProvider uri to them. This is fixed in most apps now, so we should go with
the FileProvider solution.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-567.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-565.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
