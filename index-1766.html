<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 1766) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-1766.html">
<link rel="prev" href="index-1767.html" type="text/html">
<link rel="next" href="index-1765.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/pg-tblspc-missing-after-installation-of-latest-version-of-os-x-yosemite-or-el-capitan/" class="u-url">`pg_tblspc` missing after installation of latest version of OS X (Yosemite or El Capitan)</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/pg-tblspc-missing-after-installation-of-latest-version-of-os-x-yosemite-or-el-capitan/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T08:52:16+08:00" itemprop="datePublished" title="2023-03-03 08:52">2023-03-03 08:52</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I use postgres from homebrew in my OS X, but when I reboot my system,
sometimes the postgres doesn't start after the reboot, and so I manually tried
to start it with <code>postgres -D /usr/local/var/postgres</code>, but then the error
occurred with the following message: <code>FATAL: could not open directory
"pg_tblspc": No such file or directory</code>.</p>
<p>The last time it occurred, I couldn't get it to the original state, so I
decided to uninstall the whole postgres system and then re-installed it and
created users, tables, datasets, etc... It was so disgusting, but it
frequently occurs on my system, say once in a few months.</p>
<p>So why does it lose the <code>pg_tblspc</code> file frequently? And is there anything
that I can do to avoid the loss of the file?</p>
<p>I haven't upgraded my homebrew and postgres to the latest version (i.e. I've
been using the same version). Also, all the things that I did on the postgres
database is delete the table and populate the new data every day. I haven't
changed the user, password, etc...</p>
<p>EDIT (mbannert): I felt the need to add this, since the thread is the top hit
on google for this issue and for many the symptom is different. Homebrewers
likely will encounter this error message:</p>
<div class="code"><pre class="code literal-block">No such file or directory
Is the server running locally and accepting
connections on Unix domain socket "/tmp/.s.PGSQL.5432"?
</pre></div>

<p>So, if you just experienced this after the Yosemite upgrade you now you're
covered for now reading this thread.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Solved... in part.</p>
<p>Apparently, Installing the latest versions of OS X (e.g. Yosemite or El
Capitan) removes some directories in <code>/usr/local/var/postgres</code>.</p>
<p>To fix this you simply recreate the missing directories:</p>
<div class="code"><pre class="code literal-block"><span class="n">mkdir</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">postgres</span><span class="o">/</span><span class="n">pg_commit_ts</span>
<span class="n">mkdir</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">postgres</span><span class="o">/</span><span class="n">pg_dynshmem</span>
<span class="n">mkdir</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">postgres</span><span class="o">/</span><span class="n">pg_logical</span><span class="o">/</span><span class="n">mappings</span>
<span class="n">mkdir</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">postgres</span><span class="o">/</span><span class="n">pg_logical</span><span class="o">/</span><span class="n">snapshots</span>
<span class="n">mkdir</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">postgres</span><span class="o">/</span><span class="n">pg_replslot</span>
<span class="n">mkdir</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">postgres</span><span class="o">/</span><span class="n">pg_serial</span>
<span class="n">mkdir</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">postgres</span><span class="o">/</span><span class="n">pg_snapshots</span>
<span class="n">mkdir</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">postgres</span><span class="o">/</span><span class="n">pg_stat</span>
<span class="n">mkdir</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">postgres</span><span class="o">/</span><span class="n">pg_stat_tmp</span>
<span class="n">mkdir</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">postgres</span><span class="o">/</span><span class="n">pg_tblspc</span>
<span class="n">mkdir</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">postgres</span><span class="o">/</span><span class="n">pg_twophase</span>
</pre></div>

<p>Or, more concisely ( <em>thanks to Nate</em> ):</p>
<div class="code"><pre class="code literal-block"><span class="n">mkdir</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">postgres</span><span class="o">/</span><span class="p">{{</span><span class="n">pg_commit_ts</span><span class="p">,</span><span class="n">pg_dynshmem</span><span class="p">,</span><span class="n">pg_replslot</span><span class="p">,</span><span class="n">pg_serial</span><span class="p">,</span><span class="n">pg_snapshots</span><span class="p">,</span><span class="n">pg_stat</span><span class="p">,</span><span class="n">pg_stat_tmp</span><span class="p">,</span><span class="n">pg_tblspc</span><span class="p">,</span><span class="n">pg_twophase</span><span class="p">},</span><span class="n">pg_logical</span><span class="o">/</span><span class="p">{</span><span class="n">mappings</span><span class="p">,</span><span class="n">snapshots</span><span class="p">}}</span>
</pre></div>

<p>Rerunning <code>pg_ctl start -D /usr/local/var/postgres</code> now starts the server
normally and, at least for me, without any data loss.</p>
<p><strong>UPDATE</strong></p>
<p>On my system, some of those directories are empty even when Postgres is
running. Maybe, as part of some "cleaning" operation, Yosemite removes any
empty directories? In any case, I went ahead and created a '.keep' file in
each directory to prevent future deletion.</p>
<div class="code"><pre class="code literal-block"><span class="n">touch</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">postgres</span><span class="o">/</span><span class="p">{{</span><span class="n">pg_commit_ts</span><span class="p">,</span><span class="n">pg_dynshmem</span><span class="p">,</span><span class="n">pg_replslot</span><span class="p">,</span><span class="n">pg_serial</span><span class="p">,</span><span class="n">pg_snapshots</span><span class="p">,</span><span class="n">pg_stat</span><span class="p">,</span><span class="n">pg_stat_tmp</span><span class="p">,</span><span class="n">pg_tblspc</span><span class="p">,</span><span class="n">pg_twophase</span><span class="p">},</span><span class="n">pg_logical</span><span class="o">/</span><span class="p">{</span><span class="n">mappings</span><span class="p">,</span><span class="n">snapshots</span><span class="p">}}</span><span class="o">/.</span><span class="n">keep</span>
</pre></div>

<p><em><strong>Note</strong> : Creating the <code>.keep</code> file in those directories will create some
noise in your logfile, but doesn't appear to negatively affect anything else.</em></p>
<p><br></p>
<h3>Suggest</h3>
<p>Donavan's answer is spot on, I just wanted to add that as i did different
things with the database (e.g. <code>rake db:test</code>), it went looking for different
directories that haven't been mentioned above and would choke when they
weren't present, in my case <code>pg_logical/mappings</code>, so you may want to setup a
terminal running:</p>
<div class="code"><pre class="code literal-block"><span class="n">tail</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">postgres</span><span class="o">/</span><span class="n">server</span><span class="o">.</span><span class="n">log</span>
</pre></div>

<p>and watch it for missing folders while you go thru your typical database
activities.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-print-to-console-in-pytest/" class="u-url">How to print to console in pytest?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-print-to-console-in-pytest/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T08:51:52+08:00" itemprop="datePublished" title="2023-03-03 08:51">2023-03-03 08:51</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I'm trying to use TDD (test-driven development) with <code>pytest</code>. <code>pytest</code> will
not <code>print</code> to the console when I use <code>print</code>.</p>
<p>I am using <code>pytest my_tests.py</code> to run it.</p>
<p>The <code>documentation</code> seems to say that it should work by default:
http://pytest.org/latest/capture.html</p>
<p>But:</p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="nn">myapplication</span> <span class="k">as</span> <span class="nn">tum</span>

<span class="k">class</span> <span class="nc">TestBlogger</span><span class="p">:</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">setup_class</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user</span> <span class="o">=</span> <span class="s2">"alice"</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">tum</span><span class="o">.</span><span class="n">Blogger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="p">)</span>
        <span class="nb">print</span> <span class="s2">"This should be printed, but it won't be!"</span>

    <span class="k">def</span> <span class="nf">test_inherit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">tum</span><span class="o">.</span><span class="n">Blogger</span><span class="p">,</span> <span class="n">tum</span><span class="o">.</span><span class="n">Site</span><span class="p">)</span>
        <span class="n">links</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">get_links</span><span class="p">(</span><span class="n">posts</span><span class="p">)</span>
        <span class="nb">print</span> <span class="nb">len</span><span class="p">(</span><span class="n">links</span><span class="p">)</span>   <span class="c1"># This won't print either.</span>
</pre></div>

<p>Nothing gets printed to my standard output console (just the normal progress
and how many many tests passed/failed).</p>
<p>And the script that I'm testing contains print:</p>
<div class="code"><pre class="code literal-block"><span class="k">class</span> <span class="n">Blogger</span>(<span class="n">Site</span>):
    <span class="n">get_links</span>(<span class="nb">self</span>, <span class="n">posts</span>):
        <span class="nb">print</span> <span class="n">len</span>(<span class="n">posts</span>)   <span class="c1"># It won't get printed in the test.</span>
</pre></div>

<p>In <code>unittest</code> module, everything gets printed by default, which is exactly
what I need. However, I wish to use <code>pytest</code> for other reasons.</p>
<p><strong>Does anyone know how to make the print statements get shown?</strong></p>
<p><br><br></p>
<h2>Answer</h2>
<p>By default, <code>py.test</code> captures the result of standard out so that it can
control how it prints it out. If it didn't do this, it would spew out a lot of
text without the context of what test printed that text.</p>
<p>However, if a test fails, it will include a section in the resulting report
that shows what was printed to standard out in that particular test.</p>
<p>For example,</p>
<div class="code"><pre class="code literal-block"><span class="nv">def</span><span class="w"> </span><span class="nv">test_good</span><span class="ss">()</span>:
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">range</span><span class="ss">(</span><span class="mi">1000</span><span class="ss">)</span>:
<span class="w">        </span><span class="nv">print</span><span class="ss">(</span><span class="nv">i</span><span class="ss">)</span>

<span class="nv">def</span><span class="w"> </span><span class="nv">test_bad</span><span class="ss">()</span>:
<span class="w">    </span><span class="nv">print</span><span class="ss">(</span><span class="s1">'this should fail!'</span><span class="ss">)</span>
<span class="w">    </span><span class="nv">assert</span><span class="w"> </span><span class="nv">False</span>
</pre></div>

<p>Results in the following output:</p>
<div class="code"><pre class="code literal-block">&gt;&gt;&gt; py.test tmp.py
============================= test session starts ==============================
platform darwin -- Python 2.7.6 -- py-1.4.20 -- pytest-2.5.2
plugins: cache, cov, pep8, xdist
collected 2 items

tmp.py .F

=================================== FAILURES ===================================
___________________________________ test_bad ___________________________________

    def test_bad():
        print('this should fail!')
&gt;       assert False
E       assert False

tmp.py:7: AssertionError
------------------------------- Captured stdout --------------------------------
this should fail!
====================== 1 failed, 1 passed in 0.04 seconds ======================
</pre></div>

<p>Note the <code>Captured stdout</code> section.</p>
<p>If you would like to see <code>print</code> statements as they are executed, you can pass
the <code>-s</code> flag to <code>py.test</code>. However, note that this can sometimes be difficult
to parse.</p>
<div class="code"><pre class="code literal-block"><span class="err">&gt;&gt;&gt;</span><span class="w"> </span><span class="nf">py.test</span><span class="w"> </span><span class="no">tmp.py</span><span class="w"> </span><span class="p">-</span><span class="no">s</span>
<span class="err">=============================</span><span class="w"> </span><span class="nf">test</span><span class="w"> </span><span class="no">session</span><span class="w"> </span><span class="no">starts</span><span class="w"> </span><span class="err">==============================</span>
<span class="nf">platform</span><span class="w"> </span><span class="no">darwin</span><span class="w"> </span><span class="p">--</span><span class="w"> </span><span class="no">Python</span><span class="w"> </span><span class="mi">2</span><span class="no">.7.6</span><span class="w"> </span><span class="p">--</span><span class="w"> </span><span class="no">py-1.4.20</span><span class="w"> </span><span class="p">--</span><span class="w"> </span><span class="no">pytest-2.5.2</span>
<span class="nl">plugins:</span><span class="w"> </span><span class="nf">cache</span><span class="p">,</span><span class="w"> </span><span class="no">cov</span><span class="p">,</span><span class="w"> </span><span class="no">pep8</span><span class="p">,</span><span class="w"> </span><span class="no">xdist</span>
<span class="nf">collected</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="no">items</span>

<span class="nf">tmp.py</span><span class="w"> </span><span class="mi">0</span>
<span class="err">1</span>
<span class="err">2</span>
<span class="err">3</span>
<span class="na">...</span><span class="w"> </span><span class="no">and</span><span class="w"> </span><span class="no">so</span><span class="w"> </span><span class="no">on</span><span class="w"> </span><span class="no">...</span>
<span class="err">997</span>
<span class="err">998</span>
<span class="err">999</span>
<span class="na">.this</span><span class="w"> </span><span class="no">should</span><span class="w"> </span><span class="no">fail</span><span class="p">!</span>
<span class="nf">F</span>

<span class="err">===================================</span><span class="w"> </span><span class="nf">FAILURES</span><span class="w"> </span><span class="err">===================================</span>
<span class="nf">___________________________________</span><span class="w"> </span><span class="no">test_bad</span><span class="w"> </span><span class="no">___________________________________</span>

<span class="w">    </span><span class="nf">def</span><span class="w"> </span><span class="no">test_bad</span><span class="p">():</span>
<span class="w">        </span><span class="nf">print</span><span class="p">(</span><span class="err">'</span><span class="no">this</span><span class="w"> </span><span class="no">should</span><span class="w"> </span><span class="no">fail</span><span class="p">!</span><span class="err">'</span><span class="p">)</span>
<span class="err">&gt;</span><span class="w">       </span><span class="nf">assert</span><span class="w"> </span><span class="no">False</span>
<span class="nf">E</span><span class="w">       </span><span class="no">assert</span><span class="w"> </span><span class="no">False</span>

<span class="nl">tmp.py:</span><span class="err">7:</span><span class="w"> </span><span class="nf">AssertionError</span>
<span class="err">======================</span><span class="w"> </span><span class="err">1</span><span class="w"> </span><span class="nf">failed</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="no">passed</span><span class="w"> </span><span class="no">in</span><span class="w"> </span><span class="mi">0</span><span class="no">.02</span><span class="w"> </span><span class="no">seconds</span><span class="w"> </span><span class="err">======================</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>Use the <code>-s</code> option:</p>
<div class="code"><pre class="code literal-block">pytest -s
</pre></div>

<h3>Detailed answer</h3>
<p>From the docs:</p>
<blockquote>
<p>During test execution any output sent to <strong>stdout</strong> and <strong>stderr</strong> is
captured. If a test or a setup method fails its according captured output
will usually be shown along with the failure traceback.</p>
</blockquote>
<p><code>pytest</code> has the option <code>--capture=method</code> in which <code>method</code> is per-test
capturing method, and could be one of the following: <code>fd</code>, <code>sys</code> or <code>no</code>.
<code>pytest</code> also has the option <code>-s</code> which is a shortcut for <code>--capture=no</code>, and
this is the option that will allow you to see your print statements in the
console.</p>
<div class="code"><pre class="code literal-block"><span class="nv">pytest</span><span class="w"> </span><span class="o">--</span><span class="nv">capture</span><span class="o">=</span><span class="nv">no</span><span class="w">     </span>#<span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="nv">print</span><span class="w"> </span><span class="nv">statements</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">console</span>
<span class="nv">pytest</span><span class="w"> </span><span class="o">-</span><span class="nv">s</span><span class="w">               </span>#<span class="w"> </span><span class="nv">equivalent</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">previous</span><span class="w"> </span><span class="nv">command</span>
</pre></div>

<h4>Setting capturing methods or disabling capturing</h4>
<p>There are two ways in which <code>pytest</code> can perform capturing:</p>
<ol>
<li>
<p><strong>file descriptor (FD) level capturing</strong> (default): All writes going to the operating system file descriptors 1 and 2 will be captured.</p>
</li>
<li>
<p><strong>sys level capturing</strong> : Only writes to Python files sys.stdout and sys.stderr will be captured. No capturing of writes to filedescriptors is performed.</p>
<p>pytest -s            # disable all capturing
pytest --capture=sys # replace sys.stdout/stderr with in-mem files
pytest --capture=fd  # also point filedescriptors 1 and 2 to temp file</p>
</li>
</ol>
</div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/passing-arguments-to-c-generic-new-of-templated-type/" class="u-url">Passing arguments to C# generic new() of templated type</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/passing-arguments-to-c-generic-new-of-templated-type/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T08:51:26+08:00" itemprop="datePublished" title="2023-03-03 08:51">2023-03-03 08:51</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I'm trying to create a new object of type T via its constructor when adding to
the list.</p>
<p>I'm getting a compile error: The error message is:</p>
<blockquote>
<p>'T': cannot provide arguments when creating an instance of a variable</p>
</blockquote>
<p>But my classes do have a constructor argument! How can I make this work?</p>
<div class="code"><pre class="code literal-block">public static string GetAllItems&lt;T&gt;(...) where T : new()
{
   ...
   List&lt;T&gt; tabListItems = new List&lt;T&gt;();
   foreach (ListItem listItem in listCollection) 
   {
       tabListItems.Add(new T(listItem)); // error here.
   } 
   ...
}
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<p>In order to create an instance of a generic type in a function you must
constrain it with the "new" flag.</p>
<div class="code"><pre class="code literal-block">public static string GetAllItems&lt;T&gt;(...) where T : new()
</pre></div>

<p>However that will only work when you want to call the constructor which has no
parameters. Not the case here. Instead you'll have to provide another
parameter which allows for the creation of object based on parameters. The
easiest is a function.</p>
<div class="code"><pre class="code literal-block">public static string GetAllItems&lt;T&gt;(..., Func&lt;ListItem,T&gt; del) {
  ...
  List&lt;T&gt; tabListItems = new List&lt;T&gt;();
  foreach (ListItem listItem in listCollection) 
  {
    tabListItems.Add(del(listItem));
  }
  ...
}
</pre></div>

<p>You can then call it like so</p>
<div class="code"><pre class="code literal-block">GetAllItems&lt;Foo&gt;(..., l =&gt; new Foo(l));
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>in .Net 3.5 and after you could use the activator class:</p>
<div class="code"><pre class="code literal-block">(T)Activator.CreateInstance(typeof(T), args)
</pre></div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-1767.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-1765.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
