<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 190) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-190.html">
<link rel="prev" href="index-191.html" type="text/html">
<link rel="next" href="index-189.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/insert-into-values-select-from/" class="u-url">Insert into ... values ( SELECT ... FROM ... )</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/insert-into-values-select-from/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T00:22:35+08:00" itemprop="datePublished" title="2023-02-17 00:22">2023-02-17 00:22</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I am trying to <code>INSERT INTO</code> a table using the input from another table.
Although this is entirely feasible for many database engines, I always seem to
struggle to remember the correct syntax for the <code>SQL</code> engine of the day
(MySQL, Oracle, SQL Server, Informix, and DB2).</p>
<p>Is there a silver-bullet syntax coming from an SQL standard (for example,
SQL-92) that would allow me to insert the values without worrying about the
underlying database?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Try:</p>
<div class="code"><pre class="code literal-block">INSERT INTO table1 ( column1 )
SELECT  col1
FROM    table2
</pre></div>

<p>This is standard ANSI SQL and should work on any DBMS</p>
<p>It definitely works for:</p>
<ul>
<li>Oracle</li>
<li>MS SQL Server</li>
<li>MySQL</li>
<li>Postgres</li>
<li>SQLite v3</li>
<li>Teradata</li>
<li>DB2</li>
<li>Sybase</li>
<li>Vertica</li>
<li>HSQLDB</li>
<li>H2</li>
<li>AWS RedShift</li>
<li>SAP HANA</li>
<li>Google Spanner</li>
</ul>
<p><br></p>
<h3>Suggest</h3>
<p>Claude Houle's answer: should work fine, and you can also have multiple
columns and other data as well:</p>
<div class="code"><pre class="code literal-block">INSERT INTO table1 ( column1, column2, someInt, someVarChar )
SELECT  table2.column1, table2.column2, 8, 'some string etc.'
FROM    table2
WHERE   table2.ID = 7;
</pre></div>

<p>I've only used this syntax with Access, SQL 2000/2005/Express, MySQL, and
PostgreSQL, so those should be covered. It should also work with SQLite3.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-do-i-check-if-an-object-has-a-specific-property-in-javascript/" class="u-url">How do I check if an object has a specific property in JavaScript?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-do-i-check-if-an-object-has-a-specific-property-in-javascript/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T00:22:00+08:00" itemprop="datePublished" title="2023-02-17 00:22">2023-02-17 00:22</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>How do I check if an object has a specific property in JavaScript?</p>
<p>Consider:</p>
<div class="code"><pre class="code literal-block"><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>{<span class="s1">'key'</span>:<span class="w"> </span><span class="mi">1</span>}<span class="c1">;</span>
<span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="w"> </span><span class="nv">x</span>.<span class="nv">hasOwnProperty</span><span class="ss">(</span><span class="s1">'key'</span><span class="ss">)</span><span class="w"> </span><span class="ss">)</span><span class="w"> </span>{
<span class="w">    </span><span class="o">//</span><span class="k">Do</span><span class="w"> </span><span class="nv">this</span>
}
</pre></div>

<p>Is that the best way to do it?</p>
<p><br><br></p>
<h2>Answer</h2>
<h3>2022 UPDATE</h3>
<h3><code>Object.hasOwn()</code></h3>
<blockquote>
<p><code>Object.hasOwn()</code> is recommended over <code>Object.hasOwnProperty()</code> because it
works for objects created using <code>Object.create(null)</code> and with objects that
have overridden the inherited <code>hasOwnProperty()</code> method. While it is
possible to workaround these problems by calling
<code>Object.prototype.hasOwnProperty()</code> on an external object, <code>Object.hasOwn()</code>
is more intuitive.</p>
</blockquote>
<h5>Example</h5>
<div class="code"><pre class="code literal-block"><span class="k">const</span><span class="w"> </span><span class="n">object1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">prop</span><span class="p">:</span><span class="w"> </span><span class="s1">'exists'</span>
<span class="p">};</span>

<span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="nb nb-Type">Object</span><span class="o">.</span><span class="n">hasOwn</span><span class="p">(</span><span class="n">object1</span><span class="p">,</span><span class="w"> </span><span class="s1">'prop'</span><span class="p">));</span>
<span class="o">//</span><span class="w"> </span><span class="n">expected</span><span class="w"> </span><span class="n">output</span><span class="p">:</span><span class="w"> </span><span class="bp">true</span>
</pre></div>

<hr>
<h3>Original answer</h3>
<p>I'm really confused by the answers that have been given - most of them are
just outright incorrect. Of course you can have object properties that have
undefined, null, or false values. So simply reducing the property check to
<code>typeof this[property]</code> or, even worse, <code>x.key</code> will give you completely
misleading results.</p>
<p>It depends on what you're looking for. If you want to know if an object
physically contains a property (and it is not coming from somewhere up on the
prototype chain) then <code>object.hasOwnProperty</code> is the way to go. All modern
browsers support it. (It was missing in older versions of Safari - 2.0.1 and
older - but those versions of the browser are rarely used any more.)</p>
<p>If what you're looking for is if an object has a property on it that is
iterable (when you iterate over the properties of the object, it will appear)
then doing: <code>prop in object</code> will give you your desired effect.</p>
<p>Since using <code>hasOwnProperty</code> is probably what you want, and considering that
you may want a fallback method, I present to you the following solution:</p>
<div class="code"><pre class="code literal-block"><span class="nf">var</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="nl">a</span><span class="p">:</span><span class="w"> </span><span class="n">undefined</span><span class="p">,</span>
<span class="w">    </span><span class="nl">b</span><span class="p">:</span><span class="w"> </span><span class="k">null</span><span class="p">,</span>
<span class="w">    </span><span class="nl">c</span><span class="p">:</span><span class="w"> </span><span class="k">false</span>
<span class="err">}</span><span class="p">;</span>

<span class="o">//</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="ow">all</span><span class="w"> </span><span class="k">found</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nf">var</span><span class="w"> </span><span class="n">prop</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="n">document</span><span class="p">.</span><span class="n">writeln</span><span class="p">(</span><span class="w"> </span><span class="ss">"Object1: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">prop</span><span class="w"> </span><span class="p">);</span>
<span class="err">}</span>

<span class="k">function</span><span class="w"> </span><span class="k">Class</span><span class="p">()</span><span class="err">{</span>
<span class="w">    </span><span class="n">this</span><span class="p">.</span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">undefined</span><span class="p">;</span>
<span class="w">    </span><span class="n">this</span><span class="p">.</span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">null</span><span class="p">;</span>
<span class="w">    </span><span class="n">this</span><span class="p">.</span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">false</span><span class="p">;</span>
<span class="err">}</span>

<span class="k">Class</span><span class="p">.</span><span class="n">prototype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="nl">a</span><span class="p">:</span><span class="w"> </span><span class="n">undefined</span><span class="p">,</span>
<span class="w">    </span><span class="nl">b</span><span class="p">:</span><span class="w"> </span><span class="k">true</span><span class="p">,</span>
<span class="w">    </span><span class="nl">c</span><span class="p">:</span><span class="w"> </span><span class="k">true</span><span class="p">,</span>
<span class="w">    </span><span class="nl">d</span><span class="p">:</span><span class="w"> </span><span class="k">true</span><span class="p">,</span>
<span class="w">    </span><span class="nl">e</span><span class="p">:</span><span class="w"> </span><span class="k">true</span>
<span class="err">}</span><span class="p">;</span>

<span class="nf">var</span><span class="w"> </span><span class="n">obj2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="k">Class</span><span class="p">();</span>

<span class="o">//</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="k">found</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nf">var</span><span class="w"> </span><span class="n">prop</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">obj2</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="n">document</span><span class="p">.</span><span class="n">writeln</span><span class="p">(</span><span class="w"> </span><span class="ss">"Object2: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">prop</span><span class="w"> </span><span class="p">);</span>
<span class="err">}</span>

<span class="k">function</span><span class="w"> </span><span class="n">hasOwnProperty</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="w"> </span><span class="n">prop</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="nf">var</span><span class="w"> </span><span class="n">proto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obj</span><span class="p">.</span><span class="n">__proto__</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">obj</span><span class="p">.</span><span class="k">constructor</span><span class="p">.</span><span class="n">prototype</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">prop</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">obj</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">        </span><span class="p">(</span><span class="err">!</span><span class="p">(</span><span class="n">prop</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">proto</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">proto</span><span class="o">[</span><span class="n">prop</span><span class="o">]</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="n">obj</span><span class="o">[</span><span class="n">prop</span><span class="o">]</span><span class="p">);</span>
<span class="err">}</span>

<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="k">Object</span><span class="p">.</span><span class="n">prototype</span><span class="p">.</span><span class="n">hasOwnProperty</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="nf">var</span><span class="w"> </span><span class="n">hasOwnProperty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="w"> </span><span class="n">prop</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">obj</span><span class="p">.</span><span class="n">hasOwnProperty</span><span class="p">(</span><span class="n">prop</span><span class="p">);</span>
<span class="w">    </span><span class="err">}</span>
<span class="err">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="k">found</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">modern</span><span class="w"> </span><span class="n">browsers</span>
<span class="o">//</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="k">found</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">Safari</span><span class="w"> </span><span class="mf">2.0.1</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">older</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nf">var</span><span class="w"> </span><span class="n">prop</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">obj2</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">hasOwnProperty</span><span class="p">(</span><span class="n">obj2</span><span class="p">,</span><span class="w"> </span><span class="n">prop</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="n">document</span><span class="p">.</span><span class="n">writeln</span><span class="p">(</span><span class="w"> </span><span class="ss">"Object2 w/ hasOwn: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">prop</span><span class="w"> </span><span class="p">);</span>
<span class="w">    </span><span class="err">}</span>
<span class="err">}</span>
</pre></div>

<p>The above is a working, cross-browser, solution to <code>hasOwnProperty()</code>, with
one caveat: It is unable to distinguish between cases where an identical
property is on the prototype and on the instance - it just assumes that it's
coming from the prototype. You could shift it to be more lenient or strict,
based upon your situation, but at the very least this should be more helpful.</p>
<p><br></p>
<h3>Suggest</h3>
<p>With Underscore.js or (even better) Lodash:</p>
<div class="code"><pre class="code literal-block">_.has(x, 'key');
</pre></div>

<p>Which calls <code>Object.prototype.hasOwnProperty</code>, but (a) is shorter to type, and
(b) uses "a safe reference to <code>hasOwnProperty</code>" (i.e. it works even if
<code>hasOwnProperty</code> is overwritten).</p>
<p>In particular, Lodash defines <code>_.has</code> as:</p>
<div class="code"><pre class="code literal-block"><span class="nv">function</span><span class="w"> </span><span class="nv">has</span><span class="ss">(</span><span class="nv">object</span>,<span class="w"> </span><span class="nv">key</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nv">object</span><span class="w"> </span>?<span class="w"> </span><span class="nv">hasOwnProperty</span>.<span class="nv">call</span><span class="ss">(</span><span class="nv">object</span>,<span class="w"> </span><span class="nv">key</span><span class="ss">)</span><span class="w"> </span>:<span class="w"> </span><span class="nv">false</span><span class="c1">;</span>
}
<span class="o">//</span><span class="w"> </span><span class="nv">hasOwnProperty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">Object</span>.<span class="nv">prototype</span>.<span class="nv">hasOwnProperty</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-can-i-avoid-java-code-in-jsp-files-using-jsp-2/" class="u-url">How can I avoid Java code in JSP files, using JSP 2?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-can-i-avoid-java-code-in-jsp-files-using-jsp-2/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T00:21:18+08:00" itemprop="datePublished" title="2023-02-17 00:21">2023-02-17 00:21</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I know that something like the following three lines</p>
<div class="code"><pre class="code literal-block"><span class="cp">&lt;%=</span><span class="w"> </span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span><span class="w"> </span><span class="n">request</span><span class="o">.</span><span class="n">getParameter</span><span class="p">(</span><span class="s2">"name"</span><span class="p">)</span><span class="w"> </span><span class="cp">%&gt;</span>
<span class="cp">&lt;%</span><span class="o">!</span><span class="w"> </span><span class="n">counter</span><span class="o">++</span><span class="p">;</span><span class="w"> </span><span class="cp">%&gt;</span>
</pre></div>

<p>is an old school way of coding and in JSP version 2 there exists a method to
avoid Java code in JSP files. What are the alternative JSP 2 lines, and what
is this technique called?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>The use of <em>scriptlets</em> (those <code>&lt;% %&gt;</code> things) in JSP is indeed highly
discouraged since the birth of <em>taglibs</em> (like JSTL) and EL (Expression
Language, those <code>${}</code> things) way back in 2001.</p>
<p>The major disadvantages of <em>scriptlets</em> are:</p>
<ol>
<li>
<strong>Reusability:</strong> you can't reuse scriptlets.</li>
<li>
<strong>Replaceability:</strong> you can't make scriptlets abstract.</li>
<li>
<strong>OO-ability:</strong> you can't make use of inheritance/composition.</li>
<li>
<strong>Debuggability:</strong> if scriptlet throws an exception halfway, all you get is a blank page.</li>
<li>
<strong>Testability:</strong> scriptlets are not unit-testable.</li>
<li>
<strong>Maintainability:</strong> per saldo more time is needed to maintain mingled/cluttered/duplicated code logic.</li>
</ol>
<p><del>Sun</del> Oracle itself also recommends in the JSP coding conventions to avoid
use of <em>scriptlets</em> whenever the same functionality is possible by (tag)
classes. Here are several cites of relevance:</p>
<blockquote>
<p>From JSP 1.2 Specification, it is highly recommended that the JSP Standard
Tag Library (JSTL) be used in your web application to help <strong>reduce the need
for JSP scriptlets</strong> in your pages. Pages that use JSTL are, in general,
easier to read and maintain.</p>
<p>...</p>
<p>Where possible, <strong>avoid JSP scriptlets</strong> whenever tag libraries provide
equivalent functionality. This makes pages easier to read and maintain,
helps to separate business logic from presentation logic, and will make your
pages easier to evolve into JSP 2.0-style pages (JSP 2.0 Specification
supports but de-emphasizes the use of scriptlets).</p>
<p>...</p>
<p>In the spirit of adopting the model-view-controller (MVC) design pattern to
reduce coupling between the presentation tier from the business logic, <strong>JSP
scriptlets should not be used</strong> for writing business logic. Rather, JSP
scriptlets are used if necessary to transform data (also called "value
objects") returned from processing the client's requests into a proper
client-ready format. Even then, this would be better done with a front
controller servlet or a custom tag.</p>
</blockquote>
<hr>
<p><strong>How to replace <em>scriptlets</em> entirely depends on the sole purpose of the
code/logic. More than often this code is to be placed in a fullworthy Java
class:</strong></p>
<ul>
<li>If you want to invoke the <strong>same</strong> Java code on <em>every</em> request, less-or-more regardless of the requested page, e.g. checking if a user is logged in, then implement a filter and write code accordingly in <code>doFilter()</code> method. E.g.:<div class="code"><pre class="code literal-block"><span class="w">  </span><span class="nv">public</span><span class="w"> </span><span class="nv">void</span><span class="w"> </span><span class="nv">doFilter</span><span class="ss">(</span><span class="nv">ServletRequest</span><span class="w"> </span><span class="nv">request</span>,<span class="w"> </span><span class="nv">ServletResponse</span><span class="w"> </span><span class="nv">response</span>,<span class="w"> </span><span class="nv">FilterChain</span><span class="w"> </span><span class="nv">chain</span><span class="ss">)</span><span class="w"> </span><span class="nv">throws</span><span class="w"> </span><span class="nv">ServletException</span>,<span class="w"> </span><span class="nv">IOException</span><span class="w"> </span>{
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="ss">(((</span><span class="nv">HttpServletRequest</span><span class="ss">)</span><span class="w"> </span><span class="nv">request</span><span class="ss">)</span>.<span class="nv">getSession</span><span class="ss">()</span>.<span class="nv">getAttribute</span><span class="ss">(</span><span class="s2">"user"</span><span class="ss">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nv">null</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">      </span><span class="ss">((</span><span class="nv">HttpServletResponse</span><span class="ss">)</span><span class="w"> </span><span class="nv">response</span><span class="ss">)</span>.<span class="nv">sendRedirect</span><span class="ss">(</span><span class="s2">"login"</span><span class="ss">)</span><span class="c1">; // Not logged in, redirect to login page.</span>
<span class="w">  </span>}<span class="w"> </span><span class="k">else</span><span class="w"> </span>{
<span class="w">      </span><span class="nv">chain</span>.<span class="nv">doFilter</span><span class="ss">(</span><span class="nv">request</span>,<span class="w"> </span><span class="nv">response</span><span class="ss">)</span><span class="c1">; // Logged in, just continue request.</span>
<span class="w">  </span>}
</pre></div>

<p>}</p>
</li>
</ul>
<p>When mapped on an appropriate <code>&lt;url-pattern&gt;</code> covering the JSP pages of
interest, then you don't need to copypaste the same piece of code overall JSP
pages.</p>
<hr>
<ul>
<li>If you want to invoke some Java code to <strong>process a GET request</strong> , e.g. preloading some list from a database to display in some table, if necessary based on some query parameters, then implement a servlet and write code accordingly in <code>doGet()</code> method. E.g.:<div class="code"><pre class="code literal-block">  protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
  try {
      List&lt;Product&gt; products = productService.list(); // Obtain all products.
      request.setAttribute("products", products); // Store products in request scope.
      request.getRequestDispatcher("/WEB-INF/products.jsp").forward(request, response); // Forward to JSP page to display them in a HTML table.
  } catch (SQLException e) {
      throw new ServletException("Retrieving products failed!", e);
  }
</pre></div>

<p>}</p>
</li>
</ul>
<p>This way dealing with exceptions is easier. The DB is not accessed in the
midst of JSP rendering, but far before the JSP is been displayed. You still
have the possibility to change the response whenever the DB access throws an
exception. In the above example, the default error 500 page will be displayed
which you can anyway customize by an <code>&lt;error-page&gt;</code> in <code>web.xml</code>.</p>
<hr>
<ul>
<li>If you want to invoke some Java code to <strong>process a POST request</strong> , such as gathering data from a submitted HTML form and doing some business stuff with it (conversion, validation, saving in DB, etcetera), then implement a servlet and write code accordingly in <code>doPost()</code> method. E.g.:<div class="code"><pre class="code literal-block"><span class="w">  </span><span class="nv">protected</span><span class="w"> </span><span class="nv">void</span><span class="w"> </span><span class="nv">doPost</span><span class="ss">(</span><span class="nv">HttpServletRequest</span><span class="w"> </span><span class="nv">request</span>,<span class="w"> </span><span class="nv">HttpServletResponse</span><span class="w"> </span><span class="nv">response</span><span class="ss">)</span><span class="w"> </span><span class="nv">throws</span><span class="w"> </span><span class="nv">ServletException</span>,<span class="w"> </span><span class="nv">IOException</span><span class="w"> </span>{
<span class="w">  </span><span class="nv">String</span><span class="w"> </span><span class="nv">username</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">request</span>.<span class="nv">getParameter</span><span class="ss">(</span><span class="s2">"username"</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">  </span><span class="nv">String</span><span class="w"> </span><span class="nv">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">request</span>.<span class="nv">getParameter</span><span class="ss">(</span><span class="s2">"password"</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">  </span><span class="nv">User</span><span class="w"> </span><span class="nv">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">userService</span>.<span class="nv">find</span><span class="ss">(</span><span class="nv">username</span>,<span class="w"> </span><span class="nv">password</span><span class="ss">)</span><span class="c1">;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">user</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nv">null</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">      </span><span class="nv">request</span>.<span class="nv">getSession</span><span class="ss">()</span>.<span class="nv">setAttribute</span><span class="ss">(</span><span class="s2">"user"</span>,<span class="w"> </span><span class="nv">user</span><span class="ss">)</span><span class="c1">; // Login user.</span>
<span class="w">      </span><span class="nv">response</span>.<span class="nv">sendRedirect</span><span class="ss">(</span><span class="s2">"home"</span><span class="ss">)</span><span class="c1">; // Redirect to home page.</span>
<span class="w">  </span>}<span class="w"> </span><span class="k">else</span><span class="w"> </span>{
<span class="w">      </span><span class="nv">request</span>.<span class="nv">setAttribute</span><span class="ss">(</span><span class="s2">"message"</span>,<span class="w"> </span><span class="s2">"Unknown username/password. Please retry."</span><span class="ss">)</span><span class="c1">; // Store error message in request scope.</span>
<span class="w">      </span><span class="nv">request</span>.<span class="nv">getRequestDispatcher</span><span class="ss">(</span><span class="s2">"/WEB-INF/login.jsp"</span><span class="ss">)</span>.<span class="nv">forward</span><span class="ss">(</span><span class="nv">request</span>,<span class="w"> </span><span class="nv">response</span><span class="ss">)</span><span class="c1">; // Forward to JSP page to redisplay login form with error.</span>
<span class="w">  </span>}
</pre></div>

<p>}</p>
</li>
</ul>
<p>This way dealing with different result page destinations is easier:
redisplaying the form with validation errors in case of an error (in this
particular example you can redisplay it using <code>${message}</code> in EL), or just
taking to the desired target page in case of success.</p>
<hr>
<ul>
<li>If you want to invoke some Java code to <strong>control</strong> the execution plan and/or the destination of the request and the response, then implement a servlet according to the MVC's Front Controller Pattern. E.g.:<div class="code"><pre class="code literal-block"><span class="w">  </span><span class="nv">protected</span><span class="w"> </span><span class="nv">void</span><span class="w"> </span><span class="nv">service</span><span class="ss">(</span><span class="nv">HttpServletRequest</span><span class="w"> </span><span class="nv">request</span>,<span class="w"> </span><span class="nv">HttpServletResponse</span><span class="w"> </span><span class="nv">response</span><span class="ss">)</span><span class="w"> </span><span class="nv">throws</span><span class="w"> </span><span class="nv">ServletException</span>,<span class="w"> </span><span class="nv">IOException</span><span class="w"> </span>{
<span class="w">  </span><span class="nv">try</span><span class="w"> </span>{
<span class="w">      </span><span class="nv">Action</span><span class="w"> </span><span class="nv">action</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">ActionFactory</span>.<span class="nv">getAction</span><span class="ss">(</span><span class="nv">request</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">      </span><span class="nv">String</span><span class="w"> </span><span class="nv">view</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">action</span>.<span class="nv">execute</span><span class="ss">(</span><span class="nv">request</span>,<span class="w"> </span><span class="nv">response</span><span class="ss">)</span><span class="c1">;</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">view</span>.<span class="nv">equals</span><span class="ss">(</span><span class="nv">request</span>.<span class="nv">getPathInfo</span><span class="ss">()</span>.<span class="nv">substring</span><span class="ss">(</span><span class="mi">1</span><span class="ss">))</span><span class="w"> </span>{
<span class="w">          </span><span class="nv">request</span>.<span class="nv">getRequestDispatcher</span><span class="ss">(</span><span class="s2">"/WEB-INF/"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nv">view</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">".jsp"</span><span class="ss">)</span>.<span class="nv">forward</span><span class="ss">(</span><span class="nv">request</span>,<span class="w"> </span><span class="nv">response</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">      </span>}<span class="w"> </span><span class="k">else</span><span class="w"> </span>{
<span class="w">          </span><span class="nv">response</span>.<span class="nv">sendRedirect</span><span class="ss">(</span><span class="nv">view</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">      </span>}
<span class="w">  </span>}<span class="w"> </span><span class="nv">catch</span><span class="w"> </span><span class="ss">(</span><span class="nv">Exception</span><span class="w"> </span><span class="nv">e</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">      </span><span class="nv">throw</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">ServletException</span><span class="ss">(</span><span class="s2">"Executing action failed."</span>,<span class="w"> </span><span class="nv">e</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">  </span>}
</pre></div>

<p>}</p>
</li>
</ul>
<p>Or just adopt an MVC framework like JSF, Spring MVC, Wicket, etc so that you
end up with just a JSP/Facelets page and a JavaBean class without the need for
a custom servlet.</p>
<hr>
<ul>
<li>If you want to invoke some Java code to <strong>control the flow</strong> inside a JSP page, then you need to grab an (existing) flow control taglib like JSTL core. E.g. displaying <code>List&lt;Product&gt;</code> in a table:<div class="code"><pre class="code literal-block"><span class="x">  </span><span class="cp">&lt;%</span><span class="err">@</span><span class="w"> </span><span class="n">taglib</span><span class="w"> </span><span class="n">uri</span><span class="o">=</span><span class="s2">"http://java.sun.com/jsp/jstl/core"</span><span class="w"> </span><span class="n">prefix</span><span class="o">=</span><span class="s2">"c"</span><span class="w"> </span><span class="cp">%&gt;</span>
</pre></div>

<p>...
  </p>
<table><foreach items="${products}" var="product"><tr>
<td>${product.name}</td>
              <td>${product.description}</td>
              <td>${product.price}</td>
          </tr></foreach></table>
</li>
</ul>
<p>With XML-style tags which fit nicely among all that HTML, the code is better
readable (and thus better maintainable) than a bunch of scriptlets with
various opening and closing braces ( <em>"Where the heck does this closing brace
belong to?"</em> ). An easy aid is to configure your web application to throw an
exception whenever <em>scriptlets</em> are still been used by adding the following
piece to <code>web.xml</code>:</p>
<div class="code"><pre class="code literal-block"><span class="w">      </span><span class="nt">&lt;jsp-config&gt;</span>
<span class="w">      </span><span class="nt">&lt;jsp-property-group&gt;</span>
<span class="w">          </span><span class="nt">&lt;url-pattern&gt;</span>*.jsp<span class="nt">&lt;/url-pattern&gt;</span>
<span class="w">          </span><span class="nt">&lt;scripting-invalid&gt;</span>true<span class="nt">&lt;/scripting-invalid&gt;</span>
<span class="w">      </span><span class="nt">&lt;/jsp-property-group&gt;</span>
<span class="w">  </span><span class="nt">&lt;/jsp-config&gt;</span>
</pre></div>

<p>In Facelets, the successor of JSP, which is part of the Java EE provided MVC
framework JSF, it is already <strong>not</strong> possible to use <em>scriptlets</em>. This way
you're automatically forced to do things "the right way".</p>
<hr>
<ul>
<li>If you want to invoke some Java code to <strong>access and display</strong> "backend" data inside a JSP page, then you need to use EL (Expression Language), those <code>${}</code> things. E.g. redisplaying submitted input values:<div class="code"><pre class="code literal-block"><span class="w">  </span><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"foo"</span> <span class="na">value=</span><span class="s">"</span><span class="cp">${</span><span class="n">param</span><span class="o">.</span><span class="n">foo</span><span class="cp">}</span><span class="s">"</span> <span class="nt">/&gt;</span>
</pre></div>

</li>
</ul>
<p>The <code>${param.foo}</code> displays the outcome of <code>request.getParameter("foo")</code>.</p>
<hr>
<ul>
<li>If you want to invoke some <strong>utility</strong> Java code directly in the JSP page (typically <code>public static</code> methods), then you need to define them as EL functions. There's a standard functions taglib in JSTL, but you can also easily create functions yourself. Here's an example how JSTL <code>fn:escapeXml</code> is useful to prevent XSS attacks.<div class="code"><pre class="code literal-block"><span class="x">  </span><span class="cp">&lt;%</span><span class="err">@</span><span class="w"> </span><span class="n">taglib</span><span class="w"> </span><span class="n">uri</span><span class="o">=</span><span class="s2">"http://java.sun.com/jsp/jstl/functions"</span><span class="w"> </span><span class="n">prefix</span><span class="o">=</span><span class="s2">"fn"</span><span class="w"> </span><span class="cp">%&gt;</span>
</pre></div>

<p>...
  <input type="text" name="foo" value="${fn:escapeXml(param.foo)}"></p>
</li>
</ul>
<p>Note that the XSS sensitivity is in no way specifically related to
Java/JSP/JSTL/EL/whatever, this problem needs to be taken into account in
<strong>every</strong> web application you develop. The problem of <em>scriptlets</em> is that it
provides no way of builtin preventions, at least not using the standard Java
API. JSP's successor Facelets has already implicit HTML escaping, so you don't
need to worry about XSS holes in Facelets.</p>
<h4>See also:</h4>
<ul>
<li>What's the difference between JSP, Servlet and JSF?</li>
<li>How does Servlet, ServletContext, HttpSession and HttpServletRequest/Response work?</li>
<li>Basic MVC example with JSP, Servlet and JDBC</li>
<li>Design patterns in Java web applications</li>
<li>Hidden features of JSP/Servlet</li>
</ul>
<p><br></p>
<h3>Suggest</h3>
<p><strong>As a Safeguard: Disable Scriptlets For Good</strong></p>
<p>As another question is discussing, you can and always should disable
scriptlets in your <code>web.xml</code> web application descriptor.</p>
<p>I would always do that in order to prevent any developer adding scriptlets,
especially in bigger companies where you will lose overview sooner or later.
The <code>web.xml</code> settings look like this:</p>
<div class="code"><pre class="code literal-block"><span class="nt">&lt;jsp-config&gt;</span>
<span class="w">  </span><span class="nt">&lt;jsp-property-group&gt;</span>
<span class="w">    </span><span class="nt">&lt;url-pattern&gt;</span>*.jsp<span class="nt">&lt;/url-pattern&gt;</span>
<span class="w">     </span><span class="nt">&lt;scripting-invalid&gt;</span>true<span class="nt">&lt;/scripting-invalid&gt;</span>
<span class="w">  </span><span class="nt">&lt;/jsp-property-group&gt;</span>
<span class="nt">&lt;/jsp-config&gt;</span>
</pre></div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-191.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-189.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
