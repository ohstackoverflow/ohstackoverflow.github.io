<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 1566) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-1566.html">
<link rel="prev" href="index-1567.html" type="text/html">
<link rel="next" href="index-1565.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/get-the-index-of-the-object-inside-an-array-matching-a-condition/" class="u-url">Get the index of the object inside an array, matching a condition</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/get-the-index-of-the-object-inside-an-array-matching-a-condition/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T04:05:48+08:00" itemprop="datePublished" title="2023-03-03 04:05">2023-03-03 04:05</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I have an array like this:</p>
<div class="code"><pre class="code literal-block">[{prop1:"abc",prop2:"qwe"},{prop1:"bnmb",prop2:"yutu"},{prop1:"zxvz",prop2:"qwrq"},...]
</pre></div>

<p>How can I get the index of the object that matches a condition, without
iterating over the entire array?</p>
<p>For instance, given <code>prop2=="yutu"</code>, I want to get index <code>1</code>.</p>
<p>I saw <code>.indexOf()</code> but think it's used for simple arrays like
<code>["a1","a2",...]</code>. I also checked <code>$.grep()</code> but this returns objects, not the
index.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>As of 2016, you're supposed to use <code>Array.findIndex</code> (an ES2015/ES6 standard)
for this:</p>
<div class="code"><pre class="code literal-block"><span class="nt">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="cp">[</span>
<span class="w">  </span><span class="p">{</span><span class="nx">prop1</span><span class="p">:</span><span class="s2">"abc"</span><span class="p">,</span><span class="nx">prop2</span><span class="p">:</span><span class="s2">"qwe"</span><span class="p">},</span>
<span class="w">  </span><span class="p">{</span><span class="nx">prop1</span><span class="p">:</span><span class="s2">"bnmb"</span><span class="p">,</span><span class="nx">prop2</span><span class="p">:</span><span class="s2">"yutu"</span><span class="p">},</span>
<span class="w">  </span><span class="p">{</span><span class="nx">prop1</span><span class="p">:</span><span class="s2">"zxvz"</span><span class="p">,</span><span class="nx">prop2</span><span class="p">:</span><span class="s2">"qwrq"</span><span class="p">}</span><span class="cp">]</span><span class="o">;</span>

<span class="nt">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">a</span><span class="p">.</span><span class="nc">findIndex</span><span class="o">(</span><span class="nt">x</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nt">x</span><span class="p">.</span><span class="nc">prop2</span><span class="w"> </span><span class="o">===</span><span class="s2">"yutu"</span><span class="o">);</span>

<span class="nt">console</span><span class="p">.</span><span class="nc">log</span><span class="o">(</span><span class="nt">index</span><span class="o">);</span>
</pre></div>

<p>It's supported in Google Chrome, Firefox and Edge. For Internet Explorer,
there's a polyfill on the linked page.</p>
<p><strong>Performance note</strong></p>
<p>Function calls are expensive, therefore with really big arrays a simple loop
will perform much better than <code>findIndex</code>:</p>
<div class="code"><pre class="code literal-block"><span class="n">let</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">[]</span><span class="p">;</span>

<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">let</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">1e6</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">    </span><span class="n">test</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="err">{</span><span class="nl">prop</span><span class="p">:</span><span class="w"> </span><span class="n">i</span><span class="err">}</span><span class="p">);</span>


<span class="n">let</span><span class="w"> </span><span class="k">search</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">test</span><span class="p">.</span><span class="n">length</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="n">let</span><span class="w"> </span><span class="nf">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span>

<span class="n">console</span><span class="p">.</span><span class="nc">time</span><span class="p">(</span><span class="s1">'findIndex/predefined function'</span><span class="p">);</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">fn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">obj</span><span class="p">.</span><span class="n">prop</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="k">search</span><span class="p">;</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">let</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nf">count</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">        </span><span class="n">test</span><span class="p">.</span><span class="n">findIndex</span><span class="p">(</span><span class="n">fn</span><span class="p">);</span>
<span class="n">console</span><span class="p">.</span><span class="n">timeEnd</span><span class="p">(</span><span class="s1">'findIndex/predefined function'</span><span class="p">);</span>


<span class="n">console</span><span class="p">.</span><span class="nc">time</span><span class="p">(</span><span class="s1">'findIndex/dynamic function'</span><span class="p">);</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">let</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nf">count</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">        </span><span class="n">test</span><span class="p">.</span><span class="n">findIndex</span><span class="p">(</span><span class="n">obj</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">obj</span><span class="p">.</span><span class="n">prop</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="k">search</span><span class="p">);</span>
<span class="n">console</span><span class="p">.</span><span class="n">timeEnd</span><span class="p">(</span><span class="s1">'findIndex/dynamic function'</span><span class="p">);</span>


<span class="n">console</span><span class="p">.</span><span class="nc">time</span><span class="p">(</span><span class="s1">'loop'</span><span class="p">);</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">let</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nf">count</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">let</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">test</span><span class="p">.</span><span class="n">length</span><span class="p">;</span><span class="w"> </span><span class="k">index</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">test</span><span class="o">[</span><span class="n">index</span><span class="o">]</span><span class="p">.</span><span class="n">prop</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="k">search</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">                </span><span class="k">break</span><span class="p">;</span>
<span class="w">            </span><span class="err">}</span>
<span class="w">        </span><span class="err">}</span>
<span class="w">    </span><span class="err">}</span>
<span class="n">console</span><span class="p">.</span><span class="n">timeEnd</span><span class="p">(</span><span class="s1">'loop'</span><span class="p">);</span>
</pre></div>

<p>As with most optimizations, this should be applied with care and only when
actually needed.</p>
<p><br></p>
<h3>Suggest</h3>
<blockquote>
<p>How can I get the index of the object tha match a condition (without iterate
along the array)?</p>
</blockquote>
<p>You cannot, <em>something</em> has to iterate through the array (at least once).</p>
<p>If the condition changes a lot, then you'll have to loop through and look at
the objects therein to see if they match the condition. However, on a system
with ES5 features (or if you install a shim), that iteration can be done
fairly concisely:</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">index</span><span class="p">;</span>
<span class="n">yourArray</span><span class="o">.</span><span class="n">some</span><span class="p">(</span><span class="n">function</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">prop2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"yutu"</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="bp">true</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">});</span>
</pre></div>

<p>That uses the new(ish) <code>Array#some</code> function, which loops through the entries
in the array until the function you give it returns true. The function I've
given it saves the index of the matching entry, then returns <code>true</code> to stop
the iteration.</p>
<p>Or of course, just use a <code>for</code> loop. Your various iteration options are
covered in this other answer.</p>
<p>But if you're always going to be using the same property for this lookup, and
if the property values are unique, you can loop just once and create an object
to map them:</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">prop2map</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{};</span>
<span class="n">yourArray</span><span class="o">.</span><span class="n">forEach</span><span class="p">(</span><span class="n">function</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">prop2map</span><span class="p">[</span><span class="n">entry</span><span class="o">.</span><span class="n">prop2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">entry</span><span class="p">;</span>
<span class="p">});</span>
</pre></div>

<p>(Or, again, you could use a <code>for</code> loop or any of your other options.)</p>
<p>Then if you need to find the entry with <code>prop2 = "yutu"</code>, you can do this:</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prop2map</span><span class="p">[</span><span class="s2">"yutu"</span><span class="p">];</span>
</pre></div>

<p>I call this "cross-indexing" the array. Naturally, if you remove or add
entries (or change their <code>prop2</code> values), you need to update your mapping
object as well.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-do-i-get-the-parent-directory-in-python/" class="u-url">How do I get the parent directory in Python?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-do-i-get-the-parent-directory-in-python/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T04:05:21+08:00" itemprop="datePublished" title="2023-03-03 04:05">2023-03-03 04:05</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Could someone tell me how to get the parent directory of a path in Python in a
cross platform way. E.g.</p>
<div class="code"><pre class="code literal-block"><span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Program</span><span class="w"> </span><span class="n">Files</span><span class="w"> </span><span class="o">---&gt;</span><span class="w"> </span><span class="n">C</span><span class="o">:</span><span class="err">\</span>
</pre></div>

<p>and</p>
<div class="code"><pre class="code literal-block"><span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="w"> </span><span class="o">---&gt;</span><span class="w"> </span><span class="n">C</span><span class="o">:</span><span class="err">\</span>
</pre></div>

<p>If the directory doesn't have a parent directory, it returns the directory
itself. The question might seem simple but I couldn't dig it up through
Google.</p>
<p><br><br></p>
<h2>Answer</h2>
<h2><strong>Python 3.4</strong></h2>
<p>Use the <code>pathlib</code> module.</p>
<div class="code"><pre class="code literal-block"><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">"/here/your/path/file.txt"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">absolute</span><span class="p">())</span>
</pre></div>

<h2><strong>Old answer</strong></h2>
<p>Try this:</p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="nn">os</span>
<span class="nb">print</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">yourpath</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">pardir</span><span class="p">))</span>
</pre></div>

<p>where <code>yourpath</code> is the path you want the parent for.</p>
<p><br></p>
<h3>Suggest</h3>
<p>Using <code>os.path.dirname</code>:</p>
<div class="code"><pre class="code literal-block"><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="nv">os</span>.<span class="nv">path</span>.<span class="k">dirname</span><span class="ss">(</span><span class="nv">r</span><span class="s1">'C:\Program Files'</span><span class="ss">)</span>
<span class="s1">'C:\\'</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="nv">os</span>.<span class="nv">path</span>.<span class="k">dirname</span><span class="ss">(</span><span class="s1">'C:\\'</span><span class="ss">)</span>
<span class="s1">'C:\\'</span>
<span class="o">&gt;&gt;&gt;</span>
</pre></div>

<p>Caveat: <code>os.path.dirname()</code> gives different results depending on whether a
trailing slash is included in the path. This may or may not be the semantics
you want. Cf. @kender's answer using <code>os.path.join(yourpath, os.pardir)</code>.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-redirect-to-a-404-in-rails/" class="u-url">How to redirect to a 404 in Rails?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-redirect-to-a-404-in-rails/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T04:04:56+08:00" itemprop="datePublished" title="2023-03-03 04:04">2023-03-03 04:04</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I'd like to 'fake' a 404 page in Rails. In PHP, I would just send a header
with the error code as such:</p>
<div class="code"><pre class="code literal-block">header("HTTP/1.0 404 Not Found");
</pre></div>

<p>How is that done with Rails?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Don't render 404 yourself, there's no reason to; Rails has this functionality
built in already. If you want to show a 404 page, create a <code>render_404</code> method
(or <code>not_found</code> as I called it) in <code>ApplicationController</code> like this:</p>
<div class="code"><pre class="code literal-block"><span class="nv">def</span><span class="w"> </span><span class="nv">not_found</span>
<span class="w">  </span><span class="nv">raise</span><span class="w"> </span><span class="nv">ActionController</span>::<span class="nv">RoutingError</span>.<span class="nv">new</span><span class="ss">(</span><span class="s1">'Not Found'</span><span class="ss">)</span>
<span class="k">end</span>
</pre></div>

<p>Rails also handles <code>AbstractController::ActionNotFound</code>, and
<code>ActiveRecord::RecordNotFound</code> the same way.</p>
<p>This does two things better:</p>
<p>1) It uses Rails' built in <code>rescue_from</code> handler to render the 404 page, and
2) it interrupts the execution of your code, letting you do nice things like:</p>
<div class="code"><pre class="code literal-block">  user = User.find_by_email(params[:email]) or not_found
  user.do_something!
</pre></div>

<p>without having to write ugly conditional statements.</p>
<p>As a bonus, it's also super easy to handle in tests. For example, in an rspec
integration test:</p>
<div class="code"><pre class="code literal-block"># RSpec 1

lambda {
  visit '/something/you/want/to/404'
}.should raise_error(ActionController::RoutingError)

# RSpec 2+

expect {
  get '/something/you/want/to/404'
}.to raise_error(ActionController::RoutingError)
</pre></div>

<p>And minitest:</p>
<div class="code"><pre class="code literal-block"><span class="nv">assert_raises</span><span class="ss">(</span><span class="nv">ActionController</span>::<span class="nv">RoutingError</span><span class="ss">)</span><span class="w"> </span><span class="k">do</span><span class="w"> </span>
<span class="w">  </span><span class="nv">get</span><span class="w"> </span><span class="s1">'/something/you/want/to/404'</span>
<span class="k">end</span>
</pre></div>

<p>OR refer more info from Rails render 404 not found from a controller action</p>
<p><br></p>
<h3>Suggest</h3>
<h3>HTTP 404 Status</h3>
<p>To return a 404 header, just use the <code>:status</code> option for the render method.</p>
<div class="code"><pre class="code literal-block"><span class="nv">def</span><span class="w"> </span><span class="nv">action</span>
<span class="w">  </span>#<span class="w"> </span><span class="nv">here</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">code</span>

<span class="w">  </span><span class="nv">render</span><span class="w"> </span>:<span class="nv">status</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="mi">404</span>
<span class="k">end</span>
</pre></div>

<p>If you want to render the standard 404 page you can extract the feature in a
method.</p>
<div class="code"><pre class="code literal-block"><span class="n">def render_404</span>
<span class="n">  respond_to do |format|</span>
<span class="n">    format.html { render :file =&gt; "#{Rails.root}/public/404", :layout =&gt; false, :status =&gt; :not_found }</span>
<span class="n">    format.xml  { head :not_found }</span>
<span class="n">    format.any  { head :not_found }</span>
<span class="n">  end</span>
<span class="n">end</span>
</pre></div>

<p>and call it in your action</p>
<div class="code"><pre class="code literal-block"><span class="nv">def</span><span class="w"> </span><span class="nv">action</span>
<span class="w">  </span>#<span class="w"> </span><span class="nv">here</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">code</span>

<span class="w">  </span><span class="nv">render_404</span>
<span class="k">end</span>
</pre></div>

<p>If you want the action to render the error page and stop, simply use a return
statement.</p>
<div class="code"><pre class="code literal-block"><span class="nv">def</span><span class="w"> </span><span class="nv">action</span>
<span class="w">  </span><span class="nv">render_404</span><span class="w"> </span><span class="nv">and</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nb">params</span>[:<span class="nv">something</span>].<span class="nv">blank</span>?

<span class="w">  </span>#<span class="w"> </span><span class="nv">here</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">code</span><span class="w"> </span><span class="nv">that</span><span class="w"> </span><span class="nv">will</span><span class="w"> </span><span class="nv">never</span><span class="w"> </span><span class="nv">be</span><span class="w"> </span><span class="nv">executed</span>
<span class="k">end</span>
</pre></div>

<h3>ActiveRecord and HTTP 404</h3>
<p>Also remember that Rails rescues some ActiveRecord errors, such as the
<code>ActiveRecord::RecordNotFound</code> displaying the 404 error page.</p>
<p>It means you don't need to rescue this action yourself</p>
<div class="code"><pre class="code literal-block"><span class="nv">def</span><span class="w"> </span><span class="k">show</span>
<span class="w">  </span><span class="nv">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">User</span>.<span class="nv">find</span><span class="ss">(</span><span class="nb">params</span>[:<span class="nv">id</span>]<span class="ss">)</span>
<span class="k">end</span>
</pre></div>

<p><code>User.find</code> raises an <code>ActiveRecord::RecordNotFound</code> when the user doesn't
exist. This is a very powerful feature. Look at the following code</p>
<div class="code"><pre class="code literal-block"><span class="nv">def</span><span class="w"> </span><span class="k">show</span>
<span class="w">  </span><span class="nv">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">User</span>.<span class="nv">find_by_email</span><span class="ss">(</span><span class="nb">params</span>[:<span class="nv">email</span>]<span class="ss">)</span><span class="w"> </span><span class="nv">or</span><span class="w"> </span><span class="nv">raise</span><span class="ss">(</span><span class="s2">"not found"</span><span class="ss">)</span>
<span class="w">  </span>#<span class="w"> </span>...
<span class="k">end</span>
</pre></div>

<p>You can simplify it by delegating to Rails the check. Simply use the bang
version.</p>
<div class="code"><pre class="code literal-block"><span class="nv">def</span><span class="w"> </span><span class="k">show</span>
<span class="w">  </span><span class="nv">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">User</span>.<span class="nv">find_by_email</span><span class="o">!</span><span class="ss">(</span><span class="nb">params</span>[:<span class="nv">email</span>]<span class="ss">)</span>
<span class="w">  </span>#<span class="w"> </span>...
<span class="k">end</span>
</pre></div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-1567.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-1565.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
