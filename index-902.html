<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 902) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-902.html">
<link rel="prev" href="index-903.html" type="text/html">
<link rel="next" href="index-901.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-extract-numbers-from-a-string-in-python/" class="u-url">How to extract numbers from a string in Python?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-extract-numbers-from-a-string-in-python/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T19:04:01+08:00" itemprop="datePublished" title="2023-02-17 19:04">2023-02-17 19:04</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I would like to extract all the numbers contained in a string. Which is better
suited for the purpose, regular expressions or the <code>isdigit()</code> method?</p>
<p>Example:</p>
<div class="code"><pre class="code literal-block">line = "hello 12 hi 89"
</pre></div>

<p>Result:</p>
<div class="code"><pre class="code literal-block">[12, 89]
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<p>If you only want to extract only positive integers, try the following:</p>
<div class="code"><pre class="code literal-block"><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="nv">txt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"h3110 23 cat 444.4 rabbit 11 2 dog"</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span>[<span class="nv">int</span><span class="ss">(</span><span class="nv">s</span><span class="ss">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">s</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">txt</span>.<span class="nv">split</span><span class="ss">()</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nv">s</span>.<span class="nv">isdigit</span><span class="ss">()</span>]
[<span class="mi">23</span>,<span class="w"> </span><span class="mi">11</span>,<span class="w"> </span><span class="mi">2</span>]
</pre></div>

<p>I would argue that this is better than the regex example because you don't
need another module and it's more readable because you don't need to parse
(and learn) the regex mini-language.</p>
<p>This will not recognize floats, negative integers, or integers in hexadecimal
format. If you can't accept these limitations, jmnas's answer below will do
the trick.</p>
<p><br></p>
<h3>Suggest</h3>
<p>If you only want to extract only positive integers, try the following:</p>
<div class="code"><pre class="code literal-block"><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="nv">txt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"h3110 23 cat 444.4 rabbit 11 2 dog"</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span>[<span class="nv">int</span><span class="ss">(</span><span class="nv">s</span><span class="ss">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">s</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">txt</span>.<span class="nv">split</span><span class="ss">()</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nv">s</span>.<span class="nv">isdigit</span><span class="ss">()</span>]
[<span class="mi">23</span>,<span class="w"> </span><span class="mi">11</span>,<span class="w"> </span><span class="mi">2</span>]
</pre></div>

<p>I would argue that this is better than the regex example because you don't
need another module and it's more readable because you don't need to parse
(and learn) the regex mini-language.</p>
<p>This will not recognize floats, negative integers, or integers in hexadecimal
format. If you can't accept these limitations, jmnas's answer below will do
the trick.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/response-to-preflight-request-doesn-t-pass-access-control-check/" class="u-url">Response to preflight request doesn't pass access control check</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/response-to-preflight-request-doesn-t-pass-access-control-check/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T19:03:31+08:00" itemprop="datePublished" title="2023-02-17 19:03">2023-02-17 19:03</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I'm getting this error using ngResource to call a REST API on Amazon Web
Services:</p>
<blockquote>
<p>XMLHttpRequest cannot load
http://server.apiurl.com:8000/s/login?login=facebook. Response to preflight
request doesn't pass access control check: No 'Access-Control-Allow-Origin'
header is present on the requested resource. Origin 'http://localhost' is
therefore not allowed access. <em>Error 405</em></p>
</blockquote>
<p>Service:</p>
<div class="code"><pre class="code literal-block"><span class="n">socialMarkt</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="s1">'loginService'</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="s1">'$resource'</span><span class="p">,</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="p">(</span><span class="o">$</span><span class="n">resource</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">apiAddress</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"http://server.apiurl.com:8000/s/login/"</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">$</span><span class="n">resource</span><span class="p">(</span><span class="n">apiAddress</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">login</span><span class="p">:</span><span class="w"> </span><span class="s2">"facebook"</span><span class="p">,</span>
<span class="w">        </span><span class="n">access_token</span><span class="p">:</span><span class="w"> </span><span class="s2">"@access_token"</span><span class="p">,</span>
<span class="w">        </span><span class="n">facebook_id</span><span class="p">:</span><span class="w"> </span><span class="s2">"@facebook_id"</span>
<span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">getUser</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">method</span><span class="p">:</span><span class="w"> </span><span class="s1">'POST'</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">});</span>
<span class="p">}]);</span>
</pre></div>

<p>Controller:</p>
<div class="code"><pre class="code literal-block"><span class="k">[...]</span>
<span class="na">loginService.getUser(JSON.stringify(fbObj)),</span>
<span class="w">    </span><span class="na">function (data) {</span>
<span class="w">        </span><span class="na">console.log(data);</span>
<span class="w">    </span><span class="na">},</span>
<span class="w">    </span><span class="na">function (result) {</span>
<span class="w">        </span><span class="na">console.error('Error', result.status);</span>
<span class="w">    </span><span class="na">}</span>
<span class="k">[...]</span>
</pre></div>

<p>I'm using Chrome. What else can I do in order to fix this problem?</p>
<p>I've even configured the server to accept headers from origin <code>localhost</code>.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>You are running into CORS issues.</p>
<p>There are several ways to fix or workaround this.</p>
<ol>
<li>Turn off CORS. For example: How to turn off CORS in Chrome</li>
<li>Use a plugin for your browser</li>
<li>Use a proxy, such as nginx. Example of how to set up</li>
<li>Go through the necessary setup for your server. This is more a factor of the web server you have loaded on your EC2 instance (presuming this is what you mean by "Amazon web service"). For your specific server, you can refer to the enable CORS website.</li>
</ol>
<p>More verbosely, you are trying to access <em>api.serverurl.com</em> from localhost.
This is the exact definition of a cross-domain request.</p>
<p>By either turning it off just to get your work done (OK, but poor security for
you if you visit other sites and just kicks the can down the road) or you can
use a proxy which makes your browser think all requests come from the local
host when really you have a local server that then calls the remote server.</p>
<p>So <em>api.serverurl.com</em> might become <em>localhost:8000/api</em> , and your local
nginx or other proxy will send to the correct destination.</p>
<hr>
<p>Now by popular demand, 100% more CORS information—the same great taste!</p>
<hr>
<p>Bypassing CORS is exactly what is shown for those simply learning the front
end. <em>HTTP Example with Promises</em></p>
<p><br></p>
<h3>Suggest</h3>
<p>My "API Server" is a PHP application, so to solve this problem I found the
below solution to work:</p>
<p>Place these lines in file <em>index.php</em> :</p>
<div class="code"><pre class="code literal-block"><span class="nt">header</span><span class="o">(</span><span class="s1">'Access-Control-Allow-Origin: *'</span><span class="o">);</span>
<span class="nt">header</span><span class="o">(</span><span class="s1">'Access-Control-Allow-Methods: GET, POST, PATCH, PUT, DELETE, OPTIONS'</span><span class="o">);</span>
<span class="nt">header</span><span class="o">(</span><span class="s1">'Access-Control-Allow-Headers: Origin, Content-Type, X-Auth-Token'</span><span class="o">);</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/are-the-days-of-passing-const-std-string-as-a-parameter-over/" class="u-url">Are the days of passing const std::string &amp; as a parameter over?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/are-the-days-of-passing-const-std-string-as-a-parameter-over/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T19:02:57+08:00" itemprop="datePublished" title="2023-02-17 19:02">2023-02-17 19:02</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I heard a recent talk by Herb Sutter who suggested that the reasons to pass
<code>std::vector</code> and <code>std::string</code> by <code>const &amp;</code> are largely gone. He suggested
that writing a function such as the following is now preferable:</p>
<div class="code"><pre class="code literal-block"><span class="nt">std</span><span class="p">::</span><span class="nd">string</span><span class="w"> </span><span class="nt">do_something</span><span class="w"> </span><span class="o">(</span><span class="w"> </span><span class="nt">std</span><span class="p">::</span><span class="nd">string</span><span class="w"> </span><span class="nt">inval</span><span class="w"> </span><span class="o">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="n">std</span><span class="p">:</span><span class="o">:</span><span class="n">string</span><span class="w"> </span><span class="n">return_val</span><span class="p">;</span>
<span class="w">   </span><span class="err">//</span><span class="w"> </span><span class="err">...</span><span class="w"> </span><span class="err">do</span><span class="w"> </span><span class="err">stuff</span><span class="w"> </span><span class="err">...</span>
<span class="w">   </span><span class="err">return</span><span class="w"> </span><span class="err">return_val</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<p>I understand that the <code>return_val</code> will be an rvalue at the point the function
returns and can therefore be returned using move semantics, which are very
cheap. However, <code>inval</code> is still much larger than the size of a reference
(which is usually implemented as a pointer). This is because a <code>std::string</code>
has various components including a pointer into the heap and a member <code>char[]</code>
for short string optimization. So it seems to me that passing by reference is
still a good idea.</p>
<p>Can anyone explain why Herb might have said this?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>The reason Herb said what he said is because of cases like this.</p>
<p>Let's say I have function <code>A</code> which calls function <code>B</code>, which calls function
<code>C</code>. And <code>A</code> passes a string through <code>B</code> and into <code>C</code>. <code>A</code> does not know or
care about <code>C</code>; all <code>A</code> knows about is <code>B</code>. That is, <code>C</code> is an implementation
detail of <code>B</code>.</p>
<p>Let's say that A is defined as follows:</p>
<div class="code"><pre class="code literal-block">void A()
{
  B("value");
}
</pre></div>

<p>If B and C take the string by <code>const&amp;</code>, then it looks something like this:</p>
<div class="code"><pre class="code literal-block"><span class="n">void</span><span class="w"> </span><span class="n">B</span><span class="p">(</span><span class="n">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="k">string</span><span class="w"> </span><span class="o">&amp;</span><span class="n">str</span><span class="p">)</span>
<span class="err">{</span>
<span class="w">  </span><span class="n">C</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
<span class="err">}</span>

<span class="n">void</span><span class="w"> </span><span class="n">C</span><span class="p">(</span><span class="n">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="k">string</span><span class="w"> </span><span class="o">&amp;</span><span class="n">str</span><span class="p">)</span>
<span class="err">{</span>
<span class="w">  </span><span class="o">//</span><span class="k">Do</span><span class="w"> </span><span class="n">something</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n n-Quoted">`str`</span><span class="p">.</span><span class="w"> </span><span class="n">Does</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="n">store</span><span class="w"> </span><span class="n">it</span><span class="p">.</span>
<span class="err">}</span>
</pre></div>

<p>All well and good. You're just passing pointers around, no copying, no moving,
everyone's happy. <code>C</code> takes a <code>const&amp;</code> because it doesn't store the string. It
simply uses it.</p>
<p>Now, I want to make one simple change: <code>C</code> needs to store the string
somewhere.</p>
<div class="code"><pre class="code literal-block"><span class="n">void</span><span class="w"> </span><span class="n">C</span><span class="p">(</span><span class="n">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="k">string</span><span class="w"> </span><span class="o">&amp;</span><span class="n">str</span><span class="p">)</span>
<span class="err">{</span>
<span class="w">  </span><span class="o">//</span><span class="k">Do</span><span class="w"> </span><span class="n">something</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n n-Quoted">`str`</span><span class="p">.</span>
<span class="w">  </span><span class="n">m_str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">str</span><span class="p">;</span>
<span class="err">}</span>
</pre></div>

<p>Hello, copy constructor and potential memory allocation (ignore the Short
String Optimization (SSO)). C++11's move semantics are supposed to make it
possible to remove needless copy-constructing, right? And <code>A</code> passes a
temporary; there's no reason why <code>C</code> should have to <em>copy</em> the data. It should
just abscond with what was given to it.</p>
<p>Except it can't. Because it takes a <code>const&amp;</code>.</p>
<p>If I change <code>C</code> to take its parameter by value, that just causes <code>B</code> to do the
copy into that parameter; I gain nothing.</p>
<p>So if I had just passed <code>str</code> by value through all of the functions, relying
on <code>std::move</code> to shuffle the data around, we wouldn't have this problem. If
someone wants to hold on to it, they can. If they don't, oh well.</p>
<p>Is it more expensive? Yes; moving into a value is more expensive than using
references. Is it less expensive than the copy? Not for small strings with
SSO. Is it worth doing?</p>
<p>It depends on your use case. How much do you hate memory allocations?</p>
<p><br></p>
<h3>Suggest</h3>
<blockquote>
<p>Are the days of passing const std::string &amp; as a parameter over?</p>
</blockquote>
<p><strong>No</strong>. Many people take this advice (including Dave Abrahams) beyond the
domain it applies to, and simplify it to apply to <em>all</em> <code>std::string</code>
parameters -- <em>Always</em> passing <code>std::string</code> by value is not a "best practice"
for any and all arbitrary parameters and applications because the
optimizations these talks/articles focus on apply <em>only to a restricted set of
cases</em>.</p>
<p>If you're returning a value, mutating the parameter, or taking the value, then
passing by value could save expensive copying and offer syntactical
convenience.</p>
<p>As ever, passing by const reference saves much copying <em>when you don't need a
copy</em>.</p>
<p>Now to the specific example:</p>
<blockquote>
<p>However inval is still quite a lot larger than the size of a reference
(which is usually implemented as a pointer). This is because a std::string
has various components including a pointer into the heap and a member char[]
for short string optimization. So it seems to me that passing by reference
is still a good idea. Can anyone explain why Herb might have said this?</p>
</blockquote>
<p>If stack size is a concern (and assuming this is not inlined/optimized),
<code>return_val</code> + <code>inval</code> &gt; <code>return_val</code> -- IOW, peak stack usage can be
<em>reduced</em> by passing by value here (note: oversimplification of ABIs).
Meanwhile, passing by const reference can disable the optimizations. The
primary reason here is not to avoid stack growth, but to ensure the
optimization can be performed <em>where it is applicable</em>.</p>
<p>The days of passing by const reference aren't over -- the rules just more
complicated than they once were. If performance is important, you'll be wise
to consider how you pass these types, based on the details you use in your
implementations.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-903.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-901.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
