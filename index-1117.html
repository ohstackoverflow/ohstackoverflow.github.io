<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 1117) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-1117.html">
<link rel="prev" href="index-1118.html" type="text/html">
<link rel="next" href="index-1116.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/is-javascript-s-new-keyword-considered-harmful/" class="u-url">Is JavaScript's "new" keyword considered harmful?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/is-javascript-s-new-keyword-considered-harmful/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T01:38:40+08:00" itemprop="datePublished" title="2023-02-18 01:38">2023-02-18 01:38</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>In another question, a user pointed out that the <code>new</code> keyword was dangerous
to use and proposed a solution to object creation that did not use <code>new</code>. I
didn't believe that was true, mostly because I've used Prototype,
Script.aculo.us and other excellent JavaScript libraries, and everyone of them
used the <code>new</code> keyword.</p>
<p>In spite of that, yesterday I was watching Douglas Crockford's talk at YUI
theater and he said the exactly same thing, that he didn't use the <code>new</code>
keyword anymore in his code (Crockford on JavaScript - Act III: Function the
Ultimate - 50:23 minutes).</p>
<p>Is it 'bad' to use the <code>new</code> keyword? What are the advantages and
disadvantages of using it?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Crockford has done a lot to popularize good JavaScript techniques. His
opinionated stance on key elements of the language have sparked many useful
discussions. That said, there are far too many people that take each
proclamation of "bad" or "harmful" as gospel, refusing to look beyond one
man's opinion. It can be a bit frustrating at times.</p>
<p>Use of the functionality provided by the <code>new</code> keyword has several advantages
over building each object from scratch:</p>
<ol>
<li>Prototype inheritance. While often looked at with a mix of suspicion and derision by those accustomed to class-based OO languages, JavaScript's native inheritance technique is a simple and surprisingly effective means of code re-use. And the <code>new</code> keyword is the canonical (and only available cross-platform) means of using it.</li>
<li>Performance. This is a side-effect of #1: if I want to add 10 methods to every object I create, I <em>could</em> just write a creation function that manually assigns each method to each new object... Or, I could assign them to the creation function's <code>prototype</code> and use <code>new</code> to stamp out new objects. Not only is this faster (no code needed for each and every method on the prototype), it avoids ballooning each object with separate properties for each method. On slower machines (or especially, slower JS interpreters) when many objects are being created this can mean a significant savings in time and memory.</li>
</ol>
<p>And yes, <code>new</code> has one crucial disadvantage, ably described by other answers:
if you forget to use it, your code will break without warning. Fortunately,
that disadvantage is easily mitigated - simply add a bit of code to the
function itself:</p>
<div class="code"><pre class="code literal-block"><span class="k">function</span><span class="w"> </span><span class="nf">foo</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">   </span><span class="o">//</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">accidentally</span><span class="w"> </span><span class="n">omits</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">keyword</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">will</span><span class="w"> </span>
<span class="w">   </span><span class="o">//</span><span class="w"> </span><span class="n">silently</span><span class="w"> </span><span class="n">correct</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">problem</span><span class="k">...</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span>!<span class="p">(</span><span class="n">this</span><span class="w"> </span><span class="n">instanceof</span><span class="w"> </span><span class="n">foo</span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">foo</span><span class="p">();</span>

<span class="w">   </span><span class="o">//</span><span class="w"> </span><span class="n">constructor</span><span class="w"> </span><span class="n">logic</span><span class="w"> </span><span class="n">follows</span><span class="k">...</span>
<span class="p">}</span>
</pre></div>

<p>Now you can have the advantages of <code>new</code> without having to worry about
problems caused by accidentally misuse.</p>
<p>John Resig goes into detail on this technique in his Simple "Class"
Instantiation post, as well as including a means of building this behavior
into your "classes" by default. Definitely worth a read... as is his upcoming
book, Secrets of the JavaScript Ninja, which finds hidden gold in this and
many other "harmful" features of the JavaScript language (the <strong>chapter</strong> on
<code>with</code> is especially enlightening for those of us who initially dismissed this
much-maligned feature as a gimmick).</p>
<h3>A general-purpose sanity check</h3>
<p>You could even add an assertion to the check if the thought of broken code
silently working bothers you. Or, as some commented, use the check to
introduce a runtime exception:</p>
<div class="code"><pre class="code literal-block"><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="w"> </span><span class="o">!</span><span class="ss">(</span><span class="nv">this</span><span class="w"> </span><span class="nv">instanceof</span><span class="w"> </span><span class="nv">arguments</span>.<span class="nv">callee</span><span class="ss">)</span><span class="w"> </span><span class="ss">)</span><span class="w"> </span>
<span class="w">   </span><span class="nv">throw</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">Error</span><span class="ss">(</span><span class="s2">"Constructor called as a function"</span><span class="ss">)</span><span class="c1">;</span>
</pre></div>

<p>Note that this snippet is able to avoid hard-coding the constructor function
name, as unlike the previous example it has no need to actually instantiate
the object - therefore, it can be copied into each target function without
modification.</p>
<h4>ES5 taketh away</h4>
<p>As Sean McMillan, stephenbez and jrh noted, the use of <code>arguments.callee</code> is
invalid in ES5's strict mode. So the above pattern will throw an error if you
use it in that context.</p>
<h4>ES6 and an entirely harmless <code>new</code>
</h4>
<p>ES6 introduces Classes to JavaScript - no, not in the weird Java-aping way
that old-school Crockford did, but in spirit much more like the light-weight
way he (and others) later adopted, taking the best parts of prototypal
inheritance and baking common patterns into the language itself.</p>
<p>...and part of that includes a safe <code>new</code>:</p>
<div class="code"><pre class="code literal-block"><span class="k">class</span><span class="w"> </span><span class="n">foo</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">constructor</span><span class="p">()</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="n">constructor</span><span class="w"> </span><span class="n">logic</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">ONLY</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">hit</span><span class="w"> </span>
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">properly</span><span class="w"> </span><span class="n">constructed</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="n">new</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">bad</span><span class="w"> </span><span class="n">invocation</span>
<span class="n">foo</span><span class="p">();</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">throws</span><span class="p">,</span><span class="w"> </span>
<span class="o">//</span><span class="w"> </span><span class="n">Uncaught</span><span class="w"> </span><span class="n">TypeError</span><span class="p">:</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">constructors</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">invoked</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="s1">'new'</span>
</pre></div>

<p>But what if you don't <em>want</em> to use the new sugar? What if you just want to
update your perfectly fine old-style prototypal code with the sort of safety
checks shown above such that they keep working in strict mode?</p>
<p>Well, as Nick Parsons notes, ES6 provides a handy check for that as well, in
the form of <code>new.target</code>:</p>
<div class="code"><pre class="code literal-block"><span class="k">function</span><span class="w"> </span><span class="nf">foo</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span>!<span class="p">(</span><span class="n">new</span><span class="p">.</span><span class="n">target</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span>
<span class="w">     </span><span class="nb">throw</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">Error</span><span class="p">(</span><span class="s">"Constructor called as a function"</span><span class="p">);</span>

<span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">constructor</span><span class="w"> </span><span class="n">logic</span><span class="w"> </span><span class="n">follows</span><span class="k">...</span>
<span class="p">}</span>
</pre></div>

<p>So whichever approach you choose, you can - with a bit of thought and good
hygiene - use <code>new</code> without harm.</p>
<p><br></p>
<h3>Suggest</h3>
<p>I have just read some parts of Crockford's book "JavaScript: The Good Parts".
I get the feeling that he considers everything that ever has bitten him as
harmful:</p>
<p>About switch fall through:</p>
<blockquote>
<p>I never allow switch cases to fall through to the next case. I once found a
bug in my code caused by an unintended fall through immediately after having
made a vigorous speech about why fall through was sometimes useful. (page
97, ISBN 978-0-596-51774-8)</p>
</blockquote>
<p>About ++ and --:</p>
<blockquote>
<p>The ++ (increment) and -- (decrement) operators have been known to
contribute to bad code by encouraging excessive trickiness. They are second
only to faulty architecture in enabling viruses and other security menaces.
(page 122)</p>
</blockquote>
<p>About new:</p>
<blockquote>
<p>If you forget to include the <em>new</em> prefix when calling a constructor
function, then <em>this</em> will not be bound to the new object. Sadly, <em>this</em>
will be bound to the global object, so instead of augmenting your new
object, you will be clobbering global variables. That is really bad. There
is no compile warning, and there is no runtime warning. (page 49)</p>
</blockquote>
<p>There are more, but I hope you get the picture.</p>
<p>My answer to your question: <strong>No, it's not harmful.</strong> but if you forget to use
it when you should you could have some problems. If you are developing in a
good environment you notice that.</p>
<p>In the 5th edition of ECMAScript there is support for strict mode. In strict
mode, <code>this</code> is no longer bound to the global object, but to <code>undefined</code>.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-can-i-write-a-test-which-expects-an-error-to-be-thrown-in-jasmine/" class="u-url">How can I write a test which expects an 'Error' to be thrown in Jasmine?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-can-i-write-a-test-which-expects-an-error-to-be-thrown-in-jasmine/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T01:38:15+08:00" itemprop="datePublished" title="2023-02-18 01:38">2023-02-18 01:38</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I'm trying to write a test for the Jasmine Test Framework which expects an
error. At the moment I'm using a Jasmine Node.js integration from GitHub.</p>
<p>In my Node.js module I have the following code:</p>
<div class="code"><pre class="code literal-block">throw new Error("Parsing is not possible");
</pre></div>

<p>Now I try to write a test which expects this error:</p>
<div class="code"><pre class="code literal-block">describe('my suite...', function() {
    [..]
    it('should not parse foo', function() {
    [..]
        expect(parser.parse(raw)).toThrow(new Error("Parsing is not possible"));
    });
});
</pre></div>

<p>I tried also <code>Error()</code> and some other variants and just can't figure out how
to make it work.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Try using an anonymous function instead:</p>
<div class="code"><pre class="code literal-block">expect( function(){ parser.parse(raw); } ).toThrow(new Error("Parsing is not possible"));
</pre></div>

<p>you should be passing a function into the <code>expect(...)</code> call. Your incorrect
code:</p>
<div class="code"><pre class="code literal-block"><span class="c1">// incorrect:</span>
<span class="n">expect</span><span class="p">(</span><span class="n">parser</span><span class="p">.</span><span class="n">parse</span><span class="p">(</span><span class="n">raw</span><span class="p">)).</span><span class="n">toThrow</span><span class="p">(</span><span class="n">new</span><span class="w"> </span><span class="n">Error</span><span class="p">(</span><span class="s">"Parsing is not possible"</span><span class="p">));</span>
</pre></div>

<p>is trying to actually <strong>call</strong> <code>parser.parse(raw)</code> in an attempt to pass the
result into <code>expect(...)</code>,</p>
<p><br></p>
<h3>Suggest</h3>
<p>You are using:</p>
<div class="code"><pre class="code literal-block">expect(fn).toThrow(e)
</pre></div>

<p>But if you'll have a look on the function comment (expected is string):</p>
<div class="code"><pre class="code literal-block"><span class="mf">294</span><span class="w"> </span><span class="o">/**</span>
<span class="mf">295</span><span class="w">  </span><span class="o">*</span><span class="w"> </span><span class="n">Matcher</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">checks</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nb">exp</span><span class="n">ected</span><span class="w"> </span><span class="n">exception</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">thrown</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">actual</span><span class="mf">.</span>
<span class="mf">296</span><span class="w">  </span><span class="o">*</span>
<span class="mf">297</span><span class="w">  </span><span class="o">*</span><span class="w"> </span><span class="err">@</span><span class="n">param</span><span class="w"> </span><span class="err">{</span><span class="n">String</span><span class="err">}</span><span class="w"> </span><span class="nb">exp</span><span class="n">ected</span>
<span class="mf">298</span><span class="w">  </span><span class="o">*/</span>
<span class="mf">299</span><span class="w"> </span><span class="n">jasmine</span><span class="mf">.</span><span class="n">Matchers</span><span class="mf">.</span><span class="n">prototype</span><span class="mf">.</span><span class="kr">to</span><span class="n">Throw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">function</span><span class="p">(</span><span class="nb">exp</span><span class="n">ected</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
</pre></div>

<p>I suppose you should probably write it like this (using lambda - anonymous
function):</p>
<div class="code"><pre class="code literal-block">expect(function() { parser.parse(raw); } ).toThrow("Parsing is not possible");
</pre></div>

<p>This is confirmed in the following example:</p>
<div class="code"><pre class="code literal-block">expect(function () {throw new Error("Parsing is not possible")}).toThrow("Parsing is not possible");
</pre></div>

<p>Douglas Crockford strongly recommends this approach, instead of using "throw
new Error()" (prototyping way):</p>
<div class="code"><pre class="code literal-block">throw {
   name: "Error",
   message: "Parsing is not possible"
}
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-convert-java-string-into-byte/" class="u-url">How to convert Java String into byte[]?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-convert-java-string-into-byte/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T01:37:52+08:00" itemprop="datePublished" title="2023-02-18 01:37">2023-02-18 01:37</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Is there any way to convert Java <code>String</code> to a <code>byte[]</code> ( <em>not</em> the boxed
<code>Byte[]</code>)?</p>
<p>In trying this:</p>
<div class="code"><pre class="code literal-block">System.out.println(response.split("\r\n\r\n")[1]);
System.out.println("******");
System.out.println(response.split("\r\n\r\n")[1].getBytes().toString());
</pre></div>

<p>and I'm getting separate outputs. Unable to display 1st output as it is a gzip
string.</p>
<div class="code"><pre class="code literal-block"><span class="o">&lt;</span><span class="n">A</span><span class="w"> </span><span class="n">Gzip</span><span class="w"> </span><span class="n">String</span><span class="o">&gt;</span>
<span class="o">******</span>
<span class="p">[</span><span class="n">B</span><span class="mi">@38</span><span class="n">ee9f13</span>
</pre></div>

<p>The second is an address. Is there anything I'm doing wrong? I need the result
in a <code>byte[]</code> to feed it to gzip decompressor, which is as follows.</p>
<div class="code"><pre class="code literal-block"><span class="nv">String</span><span class="w"> </span><span class="nv">decompressGZIP</span><span class="ss">(</span><span class="nv">byte</span>[]<span class="w"> </span><span class="nv">gzip</span><span class="ss">)</span><span class="w"> </span><span class="nv">throws</span><span class="w"> </span><span class="nv">IOException</span><span class="w"> </span>{
<span class="w">    </span><span class="nv">java</span>.<span class="nv">util</span>.<span class="nv">zip</span>.<span class="nv">Inflater</span><span class="w"> </span><span class="nv">inf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">java</span>.<span class="nv">util</span>.<span class="nv">zip</span>.<span class="nv">Inflater</span><span class="ss">()</span><span class="c1">;</span>
<span class="w">    </span><span class="nv">java</span>.<span class="nv">io</span>.<span class="nv">ByteArrayInputStream</span><span class="w"> </span><span class="nv">bytein</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">java</span>.<span class="nv">io</span>.<span class="nv">ByteArrayInputStream</span><span class="ss">(</span><span class="nv">gzip</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">    </span><span class="nv">java</span>.<span class="nv">util</span>.<span class="nv">zip</span>.<span class="nv">GZIPInputStream</span><span class="w"> </span><span class="nv">gzin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">java</span>.<span class="nv">util</span>.<span class="nv">zip</span>.<span class="nv">GZIPInputStream</span><span class="ss">(</span><span class="nv">bytein</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">    </span><span class="nv">java</span>.<span class="nv">io</span>.<span class="nv">ByteArrayOutputStream</span><span class="w"> </span><span class="nv">byteout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">java</span>.<span class="nv">io</span>.<span class="nv">ByteArrayOutputStream</span><span class="ss">()</span><span class="c1">;</span>
<span class="w">    </span><span class="nv">int</span><span class="w"> </span><span class="nv">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="c1">;</span>
<span class="w">    </span><span class="nv">byte</span><span class="w"> </span><span class="nv">buf</span>[]<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">byte</span>[<span class="mi">1024</span>]<span class="c1">;</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="ss">(</span><span class="nv">res</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">        </span><span class="nv">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">gzin</span>.<span class="nv">read</span><span class="ss">(</span><span class="nv">buf</span>,<span class="w"> </span><span class="mi">0</span>,<span class="w"> </span><span class="nv">buf</span>.<span class="nv">length</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">res</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">            </span><span class="nv">byteout</span>.<span class="nv">write</span><span class="ss">(</span><span class="nv">buf</span>,<span class="w"> </span><span class="mi">0</span>,<span class="w"> </span><span class="nv">res</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">        </span>}
<span class="w">    </span>}
<span class="w">    </span><span class="nv">byte</span><span class="w"> </span><span class="nv">uncompressed</span>[]<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">byteout</span>.<span class="nv">toByteArray</span><span class="ss">()</span><span class="c1">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="ss">(</span><span class="nv">uncompressed</span>.<span class="nv">toString</span><span class="ss">())</span><span class="c1">;</span>
}
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<p>The object your method <code>decompressGZIP()</code> needs is a <code>byte[]</code>.</p>
<p>So the basic, technical answer to the question you have asked is:</p>
<div class="code"><pre class="code literal-block">byte[] b = string.getBytes();
byte[] b = string.getBytes(Charset.forName("UTF-8"));
byte[] b = string.getBytes(StandardCharsets.UTF_8); // Java 7+ only
</pre></div>

<hr>
<p>However the problem you appear to be wrestling with is that this doesn't
display very well. Calling <code>toString()</code> will just give you the default
<code>Object.toString()</code> which is the class name + memory address. In your result
<code>[B@38ee9f13</code>, the <code>[B</code> means <code>byte[]</code> and <code>38ee9f13</code> is the memory address,
separated by an <code>@</code>.</p>
<p>For display purposes you can use:</p>
<div class="code"><pre class="code literal-block">Arrays.toString(bytes);
</pre></div>

<p>But this will just display as a sequence of comma-separated integers, which
may or may not be what you want.</p>
<p>To get a readable <code>String</code> back from a <code>byte[]</code>, use:</p>
<div class="code"><pre class="code literal-block">String string = new String(byte[] bytes, Charset charset);
</pre></div>

<hr>
<p>The reason the <code>Charset</code> version is favoured, is that all <code>String</code> objects in
Java are stored internally as UTF-16. When converting to a <code>byte[]</code> you will
get a different breakdown of bytes for the given glyphs of that <code>String</code>,
depending upon the chosen charset.</p>
<p><br></p>
<h3>Suggest</h3>
<div class="code"><pre class="code literal-block">  String example = "Convert Java String";
  byte[] bytes = example.getBytes();
</pre></div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-1118.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-1116.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
