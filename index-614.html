<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 614) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-614.html">
<link rel="prev" href="index-615.html" type="text/html">
<link rel="next" href="index-613.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- æ¨¡æ€æ¡†ï¼ˆModalï¼‰ --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—
				</button>
				<h4 class="modal-title" id="myModalLabel">
					æŸ¥æ‰¾ç»“æœ
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				æŸ¥æ‰¾ä¸­ï¼Œè¯·ç¨å...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					å…³é—­
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/test-for-existence-of-nested-javascript-object-key/" class="u-url">Test for existence of nested JavaScript object key</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/test-for-existence-of-nested-javascript-object-key/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T11:22:56+08:00" itemprop="datePublished" title="2023-02-17 11:22">2023-02-17 11:22</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>If I have a reference to an object:</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{};</span>
</pre></div>

<p>that will potentially (but not immediately) have nested objects, something
like:</p>
<div class="code"><pre class="code literal-block"><span class="p">{</span><span class="n">level1</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="n">level2</span><span class="o">:</span><span class="w"> </span><span class="err">{</span><span class="n">level3</span><span class="o">:</span><span class="w"> </span><span class="s2">"level3"</span><span class="p">}</span><span class="err">}}</span><span class="o">;</span>
</pre></div>

<p>What is the best way to check for the existence of property in deeply nested
objects?</p>
<p><code>alert(test.level1);</code> yields <code>undefined</code>, but
<code>alert(test.level1.level2.level3);</code> fails.</p>
<p>Iâ€™m currently doing something like this:</p>
<div class="code"><pre class="code literal-block"><span class="k">if</span><span class="ss">(</span><span class="nv">test</span>.<span class="nv">level1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nv">test</span>.<span class="nv">level1</span>.<span class="nv">level2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nv">test</span>.<span class="nv">level1</span>.<span class="nv">level2</span>.<span class="nv">level3</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">    </span><span class="nv">alert</span><span class="ss">(</span><span class="nv">test</span>.<span class="nv">level1</span>.<span class="nv">level2</span>.<span class="nv">level3</span><span class="ss">)</span><span class="c1">;</span>
}
</pre></div>

<p>but I was wondering if thereâ€™s a better way.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>You have to do it step by step if you don't want a <code>TypeError</code> because if one
of the members is <code>null</code> or <code>undefined</code>, and you try to access a member, an
exception will be thrown.</p>
<p>You can either simply <code>catch</code> the exception, or make a function to test the
existence of multiple levels, something like this:</p>
<div class="code"><pre class="code literal-block"><span class="k">function</span><span class="w"> </span><span class="n">checkNested</span><span class="p">(</span><span class="n">obj</span><span class="w"> </span><span class="cm">/*, level1, level2, ... levelN*/</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">  </span><span class="nf">var</span><span class="w"> </span><span class="n">args</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">Array</span><span class="p">.</span><span class="n">prototype</span><span class="p">.</span><span class="n">slice</span><span class="p">.</span><span class="k">call</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nf">var</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">args</span><span class="p">.</span><span class="n">length</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="err">!</span><span class="n">obj</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="err">!</span><span class="n">obj</span><span class="p">.</span><span class="n">hasOwnProperty</span><span class="p">(</span><span class="n">args</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">))</span><span class="w"> </span><span class="err">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="k">false</span><span class="p">;</span>
<span class="w">    </span><span class="err">}</span>
<span class="w">    </span><span class="n">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obj</span><span class="o">[</span><span class="n">args[i</span><span class="o">]</span><span class="err">]</span><span class="p">;</span>
<span class="w">  </span><span class="err">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="k">true</span><span class="p">;</span>
<span class="err">}</span>

<span class="nf">var</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{</span><span class="nl">level1</span><span class="p">:</span><span class="err">{</span><span class="nl">level2</span><span class="p">:</span><span class="err">{</span><span class="nl">level3</span><span class="p">:</span><span class="s1">'level3'</span><span class="err">}}</span><span class="w"> </span><span class="err">}</span><span class="p">;</span>

<span class="n">checkNested</span><span class="p">(</span><span class="n">test</span><span class="p">,</span><span class="w"> </span><span class="s1">'level1'</span><span class="p">,</span><span class="w"> </span><span class="s1">'level2'</span><span class="p">,</span><span class="w"> </span><span class="s1">'level3'</span><span class="p">);</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="k">true</span>
<span class="n">checkNested</span><span class="p">(</span><span class="n">test</span><span class="p">,</span><span class="w"> </span><span class="s1">'level1'</span><span class="p">,</span><span class="w"> </span><span class="s1">'level2'</span><span class="p">,</span><span class="w"> </span><span class="s1">'foo'</span><span class="p">);</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="k">false</span>
</pre></div>

<p><strong>ES6 UPDATE:</strong></p>
<p>Here is a shorter version of the original function, using ES6 features and
recursion (it's also in proper tail call form):</p>
<div class="code"><pre class="code literal-block"><span class="k">function</span><span class="w"> </span><span class="n">checkNested</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="w"> </span><span class="k">level</span><span class="p">,</span><span class="w">  </span><span class="p">...</span><span class="n">rest</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">obj</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="n">undefined</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="k">false</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">rest</span><span class="p">.</span><span class="n">length</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">obj</span><span class="p">.</span><span class="n">hasOwnProperty</span><span class="p">(</span><span class="k">level</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="k">true</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">checkNested</span><span class="p">(</span><span class="n">obj</span><span class="o">[</span><span class="n">level</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="n">rest</span><span class="p">)</span>
<span class="err">}</span>
</pre></div>

<p>However, if you want to get the value of a nested property and not only check
its existence, here is a simple one-line function:</p>
<div class="code"><pre class="code literal-block"><span class="k">function</span><span class="w"> </span><span class="n">getNested</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">args</span><span class="p">.</span><span class="n">reduce</span><span class="p">((</span><span class="n">obj</span><span class="p">,</span><span class="w"> </span><span class="k">level</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">obj</span><span class="o">[</span><span class="n">level</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">obj</span><span class="p">)</span>
<span class="err">}</span>

<span class="n">const</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="nl">level1</span><span class="p">:</span><span class="err">{</span><span class="w"> </span><span class="nl">level2</span><span class="p">:</span><span class="err">{</span><span class="w"> </span><span class="nl">level3</span><span class="p">:</span><span class="s1">'level3'</span><span class="err">}</span><span class="w"> </span><span class="err">}</span><span class="w"> </span><span class="err">}</span><span class="p">;</span>
<span class="n">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="n">getNested</span><span class="p">(</span><span class="n">test</span><span class="p">,</span><span class="w"> </span><span class="s1">'level1'</span><span class="p">,</span><span class="w"> </span><span class="s1">'level2'</span><span class="p">,</span><span class="w"> </span><span class="s1">'level3'</span><span class="p">));</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s1">'level3'</span>
<span class="n">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="n">getNested</span><span class="p">(</span><span class="n">test</span><span class="p">,</span><span class="w"> </span><span class="s1">'level1'</span><span class="p">,</span><span class="w"> </span><span class="s1">'level2'</span><span class="p">,</span><span class="w"> </span><span class="s1">'level3'</span><span class="p">,</span><span class="w"> </span><span class="s1">'length'</span><span class="p">));</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="mi">6</span>
<span class="n">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="n">getNested</span><span class="p">(</span><span class="n">test</span><span class="p">,</span><span class="w"> </span><span class="s1">'level1'</span><span class="p">,</span><span class="w"> </span><span class="s1">'level2'</span><span class="p">,</span><span class="w"> </span><span class="s1">'foo'</span><span class="p">));</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">undefined</span>
<span class="n">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="n">getNested</span><span class="p">(</span><span class="n">test</span><span class="p">,</span><span class="w"> </span><span class="s1">'a'</span><span class="p">,</span><span class="w"> </span><span class="s1">'b'</span><span class="p">));</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">undefined</span>
</pre></div>

<p>The above function allows you to get the value of nested properties, otherwise
will return <code>undefined</code>.</p>
<p><strong>UPDATE 2019-10-17:</strong></p>
<p>The optional chaining proposal reached Stage 3 on the ECMAScript committee
process, this will allow you to safely access deeply nested properties, by
using the token <code>?.</code>, the new <em>optional chaining operator</em> :</p>
<div class="code"><pre class="code literal-block"><span class="k">const</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obj</span><span class="err">?</span><span class="o">.</span><span class="n">level1</span><span class="err">?</span><span class="o">.</span><span class="n">level2</span><span class="err">?</span><span class="o">.</span><span class="n">level3</span>
</pre></div>

<p>If any of the levels accessed is <code>null</code> or <code>undefined</code> the expression will
resolve to <code>undefined</code> by itself.</p>
<p>The proposal also allows you to handle method calls safely:</p>
<div class="code"><pre class="code literal-block">obj?.level1?.method();
</pre></div>

<p>The above expression will produce <code>undefined</code> if <code>obj</code>, <code>obj.level1</code>, or
<code>obj.level1.method</code> are <code>null</code> or <code>undefined</code>, otherwise it will call the
function.</p>
<p><del>You can start playing with this feature with Babel using the optional
chaining plugin.</del></p>
<p>Since Babel 7.8.0, ES2020 is supported by default</p>
<p>Check this example on the Babel REPL.</p>
<p><strong>ğŸ‰ğŸ‰UPDATE: December 2019 ğŸ‰ğŸ‰</strong></p>
<p>The optional chaining proposal finally reached Stage 4 in the December 2019
meeting of the TC39 committee. This means this feature will be part of the
<strong>ECMAScript 2020</strong> Standard.</p>
<p><br></p>
<h3>Suggest</h3>
<p>Here is a pattern I picked up from Oliver Steele:</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">level3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(((</span><span class="n">test</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">{})</span><span class="o">.</span><span class="n">level1</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">{})</span><span class="o">.</span><span class="n">level2</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">{})</span><span class="o">.</span><span class="n">level3</span><span class="p">;</span>
<span class="n">alert</span><span class="p">(</span><span class="w"> </span><span class="n">level3</span><span class="w"> </span><span class="p">);</span>
</pre></div>

<p>In fact that whole article is a discussion of how you can do this in
javascript. He settles on using the above syntax (which isn't that hard to
read once you get used to it) as an idiom.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/why-is-python-setup-py-saying-invalid-command-bdist-wheel-on-travis-ci/" class="u-url">Why is python setup.py saying invalid command 'bdist_wheel' on Travis CI?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/why-is-python-setup-py-saying-invalid-command-bdist-wheel-on-travis-ci/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T11:22:28+08:00" itemprop="datePublished" title="2023-02-17 11:22">2023-02-17 11:22</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>My Python package has a <code>setup.py</code> which builds fine locally on Ubuntu Trusty
and on a fresh Vagrant Ubuntu Trusty VM when I provision it like this:</p>
<div class="code"><pre class="code literal-block"><span class="n">sudo</span><span class="w"> </span><span class="n">apt</span><span class="o">-</span><span class="n">get</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="n">python</span><span class="w"> </span><span class="n">python</span><span class="o">-</span><span class="n">dev</span><span class="w"> </span><span class="o">--</span><span class="n">force</span><span class="o">-</span><span class="n">yes</span><span class="w"> </span><span class="o">--</span><span class="n">assume</span><span class="o">-</span><span class="n">yes</span><span class="w"> </span><span class="o">--</span><span class="n">fix</span><span class="o">-</span><span class="n">broken</span>
<span class="n">curl</span><span class="w"> </span><span class="o">--</span><span class="n">silent</span><span class="w"> </span><span class="o">--</span><span class="n">show</span><span class="o">-</span><span class="n">error</span><span class="w"> </span><span class="o">--</span><span class="n">retry</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">bootstrap</span><span class="o">.</span><span class="n">pypa</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">get</span><span class="o">-</span><span class="n">pip</span><span class="o">.</span><span class="n">py</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">python2</span><span class="o">.</span><span class="mi">7</span>
<span class="n">sudo</span><span class="w"> </span><span class="o">-</span><span class="n">H</span><span class="w"> </span><span class="n">pip</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="n">setuptools</span><span class="w"> </span><span class="n">wheel</span><span class="w"> </span><span class="n">virtualenv</span><span class="w"> </span><span class="o">--</span><span class="n">upgrade</span>
</pre></div>

<p>But when I do the same on a Travis CI Trusty Beta VM:</p>
<div class="code"><pre class="code literal-block"><span class="o">-</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">apt</span><span class="o">-</span><span class="n">get</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="n">python</span><span class="w"> </span><span class="n">python</span><span class="o">-</span><span class="n">dev</span><span class="w"> </span><span class="o">--</span><span class="n">force</span><span class="o">-</span><span class="n">yes</span><span class="w"> </span><span class="o">--</span><span class="n">assume</span><span class="o">-</span><span class="n">yes</span><span class="w"> </span><span class="o">--</span><span class="n">fix</span><span class="o">-</span><span class="n">broken</span>
<span class="o">-</span><span class="w"> </span><span class="n">curl</span><span class="w"> </span><span class="o">--</span><span class="n">silent</span><span class="w"> </span><span class="o">--</span><span class="n">show</span><span class="o">-</span><span class="n">error</span><span class="w"> </span><span class="o">--</span><span class="n">retry</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">bootstrap</span><span class="o">.</span><span class="n">pypa</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">get</span><span class="o">-</span><span class="n">pip</span><span class="o">.</span><span class="n">py</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">python2</span><span class="o">.</span><span class="mi">7</span>
<span class="o">-</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="o">-</span><span class="n">H</span><span class="w"> </span><span class="n">pip</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="n">setuptools</span><span class="w"> </span><span class="n">wheel</span><span class="w"> </span><span class="n">virtualenv</span><span class="w"> </span><span class="o">--</span><span class="n">upgrade</span>
</pre></div>

<p>I get:</p>
<div class="code"><pre class="code literal-block"><span class="n">python2</span><span class="mf">.7</span><span class="w"> </span><span class="n">setup</span><span class="p">.</span><span class="n">py</span><span class="w"> </span><span class="n">bdist_wheel</span>
<span class="k">usage</span><span class="err">:</span><span class="w"> </span><span class="n">setup</span><span class="p">.</span><span class="n">py</span><span class="w"> </span><span class="o">[</span><span class="n">global_opts</span><span class="o">]</span><span class="w"> </span><span class="n">cmd1</span><span class="w"> </span><span class="o">[</span><span class="n">cmd1_opts</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">cmd2 [cmd2_opts</span><span class="o">]</span><span class="w"> </span><span class="p">...</span><span class="err">]</span>
<span class="w">   </span><span class="ow">or</span><span class="err">:</span><span class="w"> </span><span class="n">setup</span><span class="p">.</span><span class="n">py</span><span class="w"> </span><span class="o">--</span><span class="n">help</span><span class="w"> </span><span class="o">[</span><span class="n">cmd1 cmd2 ...</span><span class="o">]</span>
<span class="w">   </span><span class="ow">or</span><span class="err">:</span><span class="w"> </span><span class="n">setup</span><span class="p">.</span><span class="n">py</span><span class="w"> </span><span class="o">--</span><span class="n">help</span><span class="o">-</span><span class="n">commands</span>
<span class="w">   </span><span class="ow">or</span><span class="err">:</span><span class="w"> </span><span class="n">setup</span><span class="p">.</span><span class="n">py</span><span class="w"> </span><span class="n">cmd</span><span class="w"> </span><span class="o">--</span><span class="n">help</span>
<span class="nl">error</span><span class="p">:</span><span class="w"> </span><span class="n">invalid</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="s1">'bdist_wheel'</span>
</pre></div>

<p>This Why can I not create a wheel in python? is related but note I am
installing wheel and upgrading setuptools.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Had to install the <code>wheel</code> package. Everything was up to date but still giving
the error.</p>
<div class="code"><pre class="code literal-block">pip install wheel
</pre></div>

<p>then</p>
<div class="code"><pre class="code literal-block">python setup.py bdist_wheel
</pre></div>

<p>worked without issues.</p>
<p><br></p>
<h3>Suggest</h3>
<p>On a AWS <code>Ubuntu 18.04 new machine</code>, below installations are required:</p>
<div class="code"><pre class="code literal-block">sudo apt-get install gcc libpq-dev -y
sudo apt-get install python-dev  python-pip -y
sudo apt-get install python3-dev python3-pip python3-venv python3-wheel -y
pip3 install wheel
</pre></div>

<p>Especially the last line is a must.<br>
However before 3 lines might be required as prerequisites.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/could-not-find-a-declaration-file-for-module-module-name-path-to-module-name-js-implicitly-has-an-any-type/" class="u-url">Could not find a declaration file for module 'module-name'. '/path/to/module-name.js' implicitly has an 'any' type</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/could-not-find-a-declaration-file-for-module-module-name-path-to-module-name-js-implicitly-has-an-any-type/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T11:21:59+08:00" itemprop="datePublished" title="2023-02-17 11:21">2023-02-17 11:21</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I read how TypeScript module resolution works.</p>
<p>I have the following repository: @ts-stack/di. After compiling the directory
structure is as follows:</p>
<div class="code"><pre class="code literal-block">â”œâ”€â”€ dist
â”‚Â Â  â”œâ”€â”€ annotations.d.ts
â”‚Â Â  â”œâ”€â”€ annotations.js
â”‚Â Â  â”œâ”€â”€ index.d.ts
â”‚Â Â  â”œâ”€â”€ index.js
â”‚Â Â  â”œâ”€â”€ injector.d.ts
â”‚Â Â  â”œâ”€â”€ injector.js
â”‚Â Â  â”œâ”€â”€ profiler.d.ts
â”‚Â Â  â”œâ”€â”€ profiler.js
â”‚Â Â  â”œâ”€â”€ providers.d.ts
â”‚Â Â  â”œâ”€â”€ providers.js
â”‚Â Â  â”œâ”€â”€ util.d.ts
â”‚Â Â  â””â”€â”€ util.js
â”œâ”€â”€ LICENSE
â”œâ”€â”€ package.json
â”œâ”€â”€ README.md
â”œâ”€â”€ src
â”‚Â Â  â”œâ”€â”€ annotations.ts
â”‚Â Â  â”œâ”€â”€ index.ts
â”‚Â Â  â”œâ”€â”€ injector.ts
â”‚Â Â  â”œâ”€â”€ profiler.ts
â”‚Â Â  â”œâ”€â”€ providers.ts
â”‚Â Â  â””â”€â”€ util.ts
â””â”€â”€ tsconfig.json
</pre></div>

<p>In my package.json I wrote <code>"main": "dist/index.js"</code>.</p>
<p>In Node.js everything works fine, but TypeScript:</p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="p">{</span><span class="n">Injector</span><span class="p">}</span> <span class="kn">from</span> <span class="s1">'@ts-stack/di'</span><span class="p">;</span>
</pre></div>

<blockquote>
<p>Could not find a declaration file for module '@ts-stack/di'.
'/path/to/node_modules/@ts-stack/di/dist/index.js' implicitly has an 'any'
type.</p>
</blockquote>
<p>And yet, if I import as follows, then everything works:</p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="p">{</span><span class="n">Injector</span><span class="p">}</span> <span class="kn">from</span> <span class="s1">'/path/to/node_modules/@ts-stack/di/dist/index.js'</span><span class="p">;</span>
</pre></div>

<p>What am I doing wrong?</p>
<p><br><br></p>
<h2>Answer</h2>
<h4>For the situation where you are installing your own npm package</h4>
<p>If you're using a third party package, see my answer below.</p>
<p>Remove <code>.js</code> from <code>"main": "dist/index.js"</code> in <code>package.json</code>.</p>
<div class="code"><pre class="code literal-block">"main": "dist/index",
</pre></div>

<p>Also add <code>typings</code> in <code>package.json</code> per the TypeScript docs:</p>
<div class="code"><pre class="code literal-block">"main": "dist/index",
"typings": "dist/index",
</pre></div>

<p>The folder <code>dist</code> is where the TS compiler stores your module's files.</p>
<p><br></p>
<h3>Suggest</h3>
<p>If you're importing a third-party module <code>'foo'</code> that doesn't provide any
typings, either in the library itself, or in the <code>@types/foo</code> package
(generated from the DefinitelyTyped repository), then you can make this error
go away by declaring the module in a file with a <code>.d.ts</code> extension. TypeScript
looks for <code>.d.ts</code> files in the same places that it will look for normal <code>.ts</code>
files: as specified under "files", "include", and "exclude" in the
<code>tsconfig.json</code>.</p>
<div class="code"><pre class="code literal-block"><span class="c1">// foo.d.ts</span>
<span class="n">declare</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="s">'foo'</span><span class="p">;</span>
</pre></div>

<p>Then when you import <code>foo</code> it'll just be typed as <code>any</code>.</p>
<hr>
<p>Alternatively, if you want to roll your own typings you can do that too:</p>
<div class="code"><pre class="code literal-block"><span class="o">//</span><span class="w"> </span><span class="n">foo</span><span class="o">.</span><span class="n">d</span><span class="o">.</span><span class="n">ts</span>
<span class="n">declare</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="s1">'foo'</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">export</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">getRandomNumber</span><span class="p">():</span><span class="w"> </span><span class="n">number</span>
<span class="p">}</span>
</pre></div>

<p>Then this will compile correctly:</p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="p">{</span> <span class="n">getRandomNumber</span> <span class="p">}</span> <span class="kn">from</span> <span class="s1">'foo'</span><span class="p">;</span>
<span class="n">const</span> <span class="n">x</span> <span class="o">=</span> <span class="n">getRandomNumber</span><span class="p">();</span> <span class="o">//</span> <span class="n">x</span> <span class="ow">is</span> <span class="n">inferred</span> <span class="k">as</span> <span class="n">number</span>
</pre></div>

<p>You don't have to provide full typings for the module, just enough for the
bits that you're actually using (and want proper typings for), so it's
particularly easy to do if you're using a fairly small amount of API.</p>
<hr>
<p>On the other hand, if you don't care about the typings of external libraries
and want all libraries without typings to be imported as <code>any</code>, you can add
this to a file with a <code>.d.ts</code> extension:</p>
<div class="code"><pre class="code literal-block">declare module '*';
</pre></div>

<p>The benefit (and downside) of this is that you can import absolutely anything
and TS will compile.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-615.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-613.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents Â© 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
