<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 332) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-332.html">
<link rel="prev" href="index-333.html" type="text/html">
<link rel="next" href="index-331.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/chu-li-java-lang-outofmemoryerror-permgen-space-cuo-wu/" class="u-url">处理“java.lang.OutOfMemoryError: PermGen space”错误</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/chu-li-java-lang-outofmemoryerror-permgen-space-cuo-wu/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T04:15:11+08:00" itemprop="datePublished" title="2023-02-17 04:15">2023-02-17 04:15</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>最近我在我的网络应用程序中遇到了这个错误：</p>
<blockquote>
<p>java.lang.OutOfMemoryError: PermGen 空间</p>
</blockquote>
<p>这是一个典型的 Hibernate/JPA + IceFaces/JSF 应用程序，运行在 Tomcat 6 和 JDK 1.6
上。显然，这可能在重新部署应用程序几次后发生。</p>
<p>是什么原因导致它以及如何避免它？我该如何解决这个问题？</p>
<p><br><br></p>
<h2>解答</h2>
<p>解决方案是在启动 Tomcat 时将这些标志添加到 JVM 命令行：</p>
<div class="code"><pre class="code literal-block"><span class="o">-</span><span class="n">XX</span><span class="p">:</span><span class="o">+</span><span class="n">CMSClassUnloadingEnabled</span><span class="w"> </span><span class="o">-</span><span class="n">XX</span><span class="p">:</span><span class="o">+</span><span class="n">CMSPermGenSweepingEnabled</span>
</pre></div>

<p>您可以通过关闭 tomcat 服务，然后进入 Tomcat/bin 目录并运行 tomcat6w.exe
来做到这一点。在“Java”选项卡下，将参数添加到“Java 选项”框中。单击“确定”，然后重新启动服务。</p>
<p>如果您收到错误消息， <em>则指定的服务不存在作为已安装的服务，</em> 您应该运行：</p>
<div class="code"><pre class="code literal-block">tomcat6w //ES//servicename
</pre></div>

<p>其中 _ <strong>servicename</strong>_ 是在 services.msc 中查看的服务器名称</p>
<p>来源：orx 对Eric 的 Agile Answers 的评论。</p>
<p><br></p>
<h3>更多建议</h3>
<p>你最好尝试 <strong><code>-XX:MaxPermSize=128M</code></strong> 而不是<code>-XX:MaxPermGen=128M</code>。</p>
<p>我不能说出这个内存池的具体用途，但它与加载到 JVM 中的类的数量有关。（因此为 tomcat
启用类卸载可以解决问题。）如果您的应用程序在运行时生成和编译类，则更有可能需要比默认值更大的内存池。</p>
<p><br><br><a href="posts/dealing-with-java-lang-outofmemoryerror-permgen-space-error/">查看原文</a></p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/tui-chu-ying-yong-cheng-xu-shi-fou-ling-ren-bu-yue/" class="u-url">退出应用程序是否令人不悦？</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/tui-chu-ying-yong-cheng-xu-shi-fou-ling-ren-bu-yue/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T04:14:43+08:00" itemprop="datePublished" title="2023-02-17 04:14">2023-02-17 04:14</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>继续尝试学习 Android，我刚刚阅读了以下内容：</p>
<blockquote>
<p>问题： <em>用户是否可以选择终止应用程序，除非我们放入一个菜单选项来终止它？ 如果不存在这样的选项，用户如何终止应用程序？</em></p>
<p>回答：（Romain Guy）： <em>用户没有，系统自动处理。 这就是 Activity 生命周期（尤其是
onPause/onStop/onDestroy）的用途。无论您做什么，都不要放置“退出”或“退出”应用程序按钮。它对Android的应用程序模型没有用。这也与核心应用程序的工作方式相反。</em></p>
</blockquote>
<p>呵呵，我在 Android 世界中迈出的每一步都会遇到某种问题 =(</p>
<p>显然，您无法退出 Android 中的应用程序（但 Android
系统可以随时完全破坏您的应用程序）。那是怎么回事？我开始认为不可能编写一个作为“普通应用程序”运行的应用程序——用户可以在他/她决定退出时退出该应用程序。这不是应该依赖操作系统来做的事情。</p>
<p>我尝试创建的应用程序不是 Android Market
的应用程序。它不是一个供大众“广泛使用”的应用程序，它是一个将在非常狭窄的业务领域中使用的业务应用程序。</p>
<p>我真的很期待为 Android 平台开发，因为它解决了 Windows Mobile 和 .NET
中存在的许多问题。然而，上周对我来说有点令人失望……我希望我不必放弃 Android，但它现在看起来不太好 =(</p>
<p>有没有办法让我 <strong>真正</strong> 退出应用程序？</p>
<p><br><br></p>
<h2>解答</h2>
<p>这最终将解决您的问题，但我首先想解决您在撰写本文时已经给出的各种答案的各种评论中提出的一些问题。我无意改变你的想法——相反，这些是为将来阅读这篇文章的其他人准备的。</p>
<blockquote>
<p>关键是我不能让 Android 确定我的应用程序何时终止。那一定是用户的选择。</p>
</blockquote>
<p>数百万人对环境根据需要关闭应用程序的模型非常满意。这些用户根本不会考虑“终止”Android 应用程序，就像他们不会考虑“终止”网页或“终止”恒温器一样。</p>
<p>iPhone 用户的情况大致相同，因为按下 iPhone 按钮并不一定“感觉”应用程序已终止，因为许多 iPhone
应用程序会从用户停止的地方开始，即使应用程序真的被关闭了（因为 iPhone 只允许目前一次一个第三方应用程序）。</p>
<blockquote>
<p>正如我上面所说的，我的应用程序中发生了很多事情（数据被推送到设备，列出了应该始终存在的任务，等等）。</p>
</blockquote>
<p>我不知道“列出始终应该存在的任务列表”是什么意思，但是“将数据推送到设备”是一个令人愉快的小说，无论如何都不应该通过活动来完成。使用计划任务（通过<code>AlarmManager</code>）更新您的数据以获得最大的可靠性。</p>
<blockquote>
<p>我们的用户每次接到电话并且 Android 决定终止该应用程序时都需要登录，但不能这样做。</p>
</blockquote>
<p>有许多处理此问题的 iPhone 和 Android 应用程序。通常，这是因为他们持有登录凭据，而不是强制用户每次都手动登录。</p>
<blockquote>
<p>例如，我们希望在退出应用程序时检查更新</p>
</blockquote>
<p>这在任何操作系统上都是错误的。就您所知，您的应用程序“退出”的原因是因为操作系统正在关闭，然后您的更新过程将在中途失败。通常，这不是一件好事。要么在启动时检查更新，要么完全异步地检查更新（例如，通过计划任务），从不在退出时检查更新。</p>
<blockquote>
<p>一些评论表明，点击后退按钮根本不会终止应用程序（请参阅上面我的问题中的链接）。</p>
</blockquote>
<p>按下后退按钮不会“终止应用程序”。当用户按下 BACK 按钮时，它会完成屏幕上的活动。</p>
<blockquote>
<p>它应该只在用户想要终止它时终止——永远不要以任何其他方式终止。如果你不能在 Android 中编写行为类似的应用程序，那么我认为 Android
不能用于编写真正的应用程序 =(</p>
</blockquote>
<p>那么 Web
应用程序也不能。或者WebOS，如果我正确理解他们的模型（还没有机会玩一个）。在所有这些中，用户不会“终止”任何东西——他们只是离开。iPhone
有点不同，因为它目前只允许一次运行一件事（除了少数例外），因此离开的行为意味着应用程序的相当立即终止。</p>
<blockquote>
<p>有没有办法让我真正退出应用程序？</p>
</blockquote>
<p>正如其他人告诉您的那样，用户（通过
BACK）或您的代码（通过<code>finish()</code>）可以关闭您当前运行的活动。对于正确编写的应用程序，用户通常不需要任何其他东西，就像他们使用 Web
应用程序不需要“退出”选项一样。</p>
<hr>
<p>根据定义，没有两个应用程序环境是相同的。这意味着随着新趋势的出现和其他趋势的消失，您可以看到环境中的趋势。</p>
<p>例如，越来越多的运动试图消除“文件”的概念。大多数 Web 应用程序不会强迫用户考虑文件。iPhone 应用程序通常不会强迫用户想到文件。Android
应用程序通常不会强迫用户想到文件。等等。</p>
<p>同样，越来越多的运动试图消除“终止”应用程序的概念。大多数 Web 应用程序不会强制用户注销，而是在用户一段时间不活动后隐式注销。Android
也是如此，在较小程度上，iPhone（可能还有 WebOS）也是如此。</p>
<p>这需要更加重视应用程序设计，关注业务目标，而不是坚持与以前的应用程序环境绑定的实施模型。没有时间或不愿意这样做的开发人员会对破坏他们现有心智模型的新环境感到沮丧。这不是任何一种环境的错，就像风暴绕过它而不是穿过它是一座山的错一样。</p>
<p>例如，一些开发环境，如Hypercard和 Smalltalk，将应用程序和开发工具混合在一个设置中。除了应用程序的语言扩展（例如，
Excel中的VBA、AutoCAD 中的
Lisp）之外，这个概念并没有流行起来。因此，那些想出假设应用程序本身存在开发工具的心智模型的开发人员要么必须改变他们的模型，要么将自己限制在他们的模型适用的环境中。</p>
<p>所以，当你写：</p>
<blockquote>
<p>连同我发现的其他乱七八糟的事情，我认为开发我们的 Android 应用程序不会发生。</p>
</blockquote>
<p>这似乎是最好的，对你来说，现在。同样，我会建议您不要尝试将您的应用程序移植到 Web，因为您在 Android 上报告的一些相同问题也会在 Web
应用程序中发现（例如，没有“终止”）。或者，相反，如果有一天您 <em>将</em> 应用程序移植到 Web，您可能会发现 Web 应用程序的流程可能更适合
Android，此时您可以重新访问 Android 端口。</p>
<p><br></p>
<h3>更多建议</h3>
<p>我只想在这里为该线程的未来读者添加一个更正。很长一段时间我都无法理解这种特殊的细微差别，所以我想确保你们不会犯同样的错误：</p>
<p><strong><code>System.exit()</code> 如果您在堆栈上有多个活动，则不会终止您的应用程序。</strong>实际发生的是 <strong>进程被杀死并立即重新启动</strong>
，堆栈上的活动减少了一个。当您的应用程序被“强制关闭”对话框终止时，甚至当您尝试从 DDMS
中终止进程时，也会发生这种情况。据我所知，这是一个完全没有记录的事实。</p>
<p>简短的回答是，如果你想退出你的应用程序，你必须跟踪堆栈中的所有活动以及<code>finish()</code>用户想要退出时的所有活动（不，没有办法遍历活动堆栈，所以你必须自己管理所有这些）。即使这样实际上也不会终止进程或您可能拥有的任何悬空引用。它只是完成活动。另外，我不确定是否<code>Process.killProcess(Process.myPid())</code>效果更好；我还没有测试过。</p>
<p>另一方面，如果您可以让 Activity
保留在您的堆栈中，那么还有另一种方法可以让事情变得非常简单：只需将您的进程置于后台<code>Activity.moveTaskToBack(true)</code>并显示主屏幕。</p>
<p>长答案涉及解释这种行为背后的哲学。该哲学源于许多假设：</p>
<ol>
<li>首先，这只会在您的应用程序位于前台时发生。如果它在后台，进程就会终止。但是，如果它在前台，操作系统会假定用户想继续做他/她正在做的事情。（如果你想从 DDMS 中终止进程，你应该先点击主页按钮，然后终止它）</li>
<li>它还假定每个活动都独立于所有其他活动。这通常是正确的，例如在您的应用程序启动浏览器活动的情况下，它是完全独立的并且不是您编写的。浏览器活动可能会也可能不会在同一个任务上创建，具体取决于其清单属性。</li>
<li>它假定您的每项活动都是完全自力更生的，并且可以立即终止/恢复。（我很不喜欢这个特定的假设，因为我的应用程序有很多依赖大量缓存数据的活动，这些数据太大而无法在 期间有效序列化<code>onSaveInstanceState</code>，但是你会怎么做？）对于大多数编写良好的 Android 应用程序来说，这应该是正确的，因为您永远不知道您的应用程序何时会在后台被终止。</li>
<li>最后一个因素与其说是一个假设，不如说是操作系统的限制： <em>显式杀死应用程序与应用程序崩溃相同，也与 Android 杀死应用程序以回收内存相同。</em> 这最终导致我们的致命一击：由于 Android 无法判断应用程序是退出、崩溃还是在后台被杀死，它假定用户想要返回他们离开的地方，因此 ActivityManager 重新启动进程。</li>
</ol>
<p>仔细想想，这对平台来说是合适的。首先，这正是当进程在后台被终止并且用户返回到它时发生的情况，因此需要在它停止的地方重新启动它。其次，这是当应用程序崩溃并显示可怕的强制关闭对话框时发生的情况。</p>
<p>假设我希望我的用户能够拍照并上传。我从我的活动中启动相机活动，并要求它返回图像。相机被推到我当前任务的顶部（而不是在它自己的任务中创建）。如果相机出现错误并崩溃，是否会导致整个应用程序崩溃？从用户的角度来看，只有
Camera 出现故障，他们应该返回到之前的 Activity。所以它只是用堆栈中所有相同的活动重新启动进程，减去相机。由于您的 Activity <em>应该</em>
被设计成可以随时终止和恢复它们，所以这应该不是问题。不幸的是，并不是所有的应用程序都可以这样设计，所以它 <em>是</em> 对我们许多人来说都是一个问题，不管
Romain Guy 或其他人告诉你什么。因此，我们需要使用变通方法。</p>
<p>所以，我的结束建议：</p>
<ul>
<li>不要试图终止进程。调用<code>finish()</code>所有活动或调用<code>moveTaskToBack(true)</code>.</li>
<li>如果您的进程崩溃或被杀死，并且像我一样，您需要内存中现在丢失的数据，您将需要返回到根活动。为此，您应该<code>startActivity()</code>使用包含标志的 Intent进行调用<code>Intent.FLAG_ACTIVITY_CLEAR_TOP</code>。</li>
<li>如果你想从 Eclipse DDMS 的角度杀死你的应用程序，它最好不要在前台，否则它会自行重启。您应该先按主页按钮，然后 <em>终止</em> 进程。</li>
</ul>
<p><br><br><a href="posts/is-quitting-an-application-frowned-upon/">查看原文</a></p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/php-mi-ma-de-an-quan-ha-xi-he-yan/" class="u-url">PHP 密码的安全哈希和盐</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/php-mi-ma-de-an-quan-ha-xi-he-yan/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T04:14:13+08:00" itemprop="datePublished" title="2023-02-17 04:14">2023-02-17 04:14</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>目前据说 MD5 是部分不安全的。考虑到这一点，我想知道使用哪种机制来保护密码。</p>
<p>这个问题，“双重散列”密码是否比仅散列一次更不安全？建议多次散列可能是个好主意，而How to implement password protection
for individual files?建议使用盐。</p>
<p>我正在使用
PHP。我想要一个安全快速的密码加密系统。将密码散列一百万次可能更安全，但也更慢。如何在速度与安全之间取得良好的平衡？此外，我更希望结果具有恒定数量的字符。</p>
<ol>
<li>散列机制必须在 PHP 中可用</li>
<li>一定是安全的</li>
<li>它可以使用盐（在这种情况下，所有的盐都一样好吗？有什么方法可以生成好的盐吗？）</li>
</ol>
<p>另外，我是否应该在数据库中存储两个字段（例如，一个使用 MD5，另一个使用 SHA）？它会使它更安全还是更不安全？</p>
<p>以防我不够清楚，我想知道要使用哪些哈希函数以及如何选择好的盐以拥有安全快速的密码保护机制。</p>
<p><em>没有完全涵盖我的问题的相关问题：</em></p>
<p>PHP简单密码加密<br>
中SHA 和MD5的区别  </p>
<p><br><br></p>
<h2>解答</h2>
<blockquote>
<p><strong>免责声明</strong> ：此答案写于 2008 年。</p>
<p>从那时起，PHP
就为我们提供了<code>password_hash</code>并且<code>password_verify</code>，自从它们被引入以来，它们就是推荐的密码散列和检查方法。</p>
<p>不过，答案的理论仍然是一本好书。</p>
</blockquote>
<h3>长话短说</h3>
<h4>不要做</h4>
<ul>
<li>不要限制用户可以输入哪些字符作为密码。只有白痴才会这样做。</li>
<li>不要限制密码的长度。如果您的用户想要一个带有 supercalifragilisticexpialidocious 的句子，请不要阻止他们使用它。</li>
<li>不要去除或转义密码中的 HTML 和特殊字符。</li>
<li>切勿以纯文本形式存储用户密码。</li>
<li>永远不要通过电子邮件向您的用户发送密码， <em>除非他们丢失了密码，而您发送了一个临时密码。</em>
</li>
<li>永远不要以任何方式记录密码。</li>
<li>切勿使用SHA1或 MD5 甚至 SHA256散列密码！现代破解者可以超过 60 和 1800 亿哈希/秒（分别）。</li>
<li>不要将bcrypt 和hash() 的 <em>原始</em> 输出混合使用，要么使用十六进制输出，要么使用 base64_encode。（这适用于任何可能包含流氓的输入<code>\0</code>，这会严重削弱安全性。）</li>
</ul>
<h4>操作系统</h4>
<ul>
<li>尽可能使用 scrypt；bcrypt 如果你不能。</li>
<li>如果您不能将 bcrypt 或 scrypt 与 SHA2 哈希一起使用，请使用 PBKDF2。</li>
<li>当数据库受到威胁时，重置每个人的密码。</li>
<li>实施合理的 8-10 个字符的最小长度，另外还需要至少 1 个大写字母、1 个小写字母、一个数字和一个符号。这将提高密码的熵，进而使其更难破解。（请参阅“什么是好的密码？”部分进行讨论。）</li>
</ul>
<h3>为什么还要散列密码？</h3>
<p>散列密码背后的目标很简单：通过破坏数据库来防止恶意访问用户帐户。因此，密码散列的目标是通过花费太多时间或金钱来计算纯文本密码来阻止黑客或破解者。时间/成本是您武器库中最好的威慑力量。</p>
<p>您希望对用户帐户进行良好、健壮的散列的另一个原因是，为您提供足够的时间来更改系统中的所有密码。如果您的数据库遭到破坏，如果不更改数据库中的每个密码，您将需要足够的时间至少
<em>锁定</em> 系统。</p>
<p>Whitehat Security 的 CTO Jeremiah Grossman在最近一次密码恢复需要暴力破解密码保护后在 White Hat
Security 博客上表示：</p>
<blockquote>
<p>有趣的是，在经历这场噩梦的过程中，我学到了很多我不知道的关于密码破解、存储和复杂性的知识。 _我开始明白为什么密码存储比密码复杂性重要得多。
如果您不知道密码是如何存储的，那么您真正可以依赖的就是复杂性。_这可能是密码和加密专业人士的常识，但对于普通的 InfoSec
或网络安全专家来说，我对此表示高度怀疑。</p>
</blockquote>
<p>（强调我的。）</p>
<h3>什么才是 <em>好的</em> 密码？</h3>
<p>熵。（并不是说我完全赞同兰德尔的观点。）</p>
<p>简而言之，熵是密码内的变化量。当密码仅为小写罗马字母时，即只有 26 个字符。那变化不大。字母数字密码更好，有 36
个字符。但是允许大小写，加上符号，大概是96个字符。这比仅仅写字母要好得多。一个问题是，为了让我们的密码更容易记住，我们插入了模式——这减少了熵。哎呀！</p>
<p>密码熵很容易近似。使用全范围的 ascii 字符（大约 96 个可输入字符）产生每个字符 6.6 的熵，对于未来的安全来说，8
个字符的密码仍然太低（52.679 位熵）。但好消息是：更长的密码和带有 unicode 字符的密码确实会增加密码的熵并使其更难破解。</p>
<p>在Crypto StackExchange站点上对密码熵进行了更长时间的讨论。一个好的谷歌搜索也会出现很多结果。</p>
<p>在我与@popnoodles 交谈的评论中，他指出使用 X 多个字母、数字、符号等 <em>强制执行</em> X
长度的密码策略，实际上可以通过使密码方案更具可预测性来减少熵。我同意。随机性，尽可能真正地随机，总是最安全但最不令人难忘的解决方案。</p>
<p>据我所知，制作世界上最好的密码是第 22 条军规。它要么不令人难忘、太容易预测、太短、Unicode 字符太多（很难在
Windows/移动设备上键入）、太长等。没有任何密码能真正满足我们的目的，因此我们必须像保护它们一样保护它们在诺克斯堡。</p>
<h3>最佳实践</h3>
<p>Bcrypt 和scrypt是当前的最佳实践。Scrypt迟早会比 bcrypt 更好，但它还没有被 Linux/Unix
或网络服务器视为标准采用，也没有发布对其算法的深入评论。但是，该算法的未来看起来确实很有希望。如果您正在使用 Ruby，那么可以使用scrypt
gem来帮助您，而 Node.js 现在有自己的scrypt包。您可以通过Scrypt扩展或Libsodium扩展（两者都在 PECL 中可用）在 PHP
中使用 Scrypt。</p>
<p>如果您想了解如何使用 bcrypt，我强烈建议您阅读crypt 函数的文档，或者为自己找到一个好的
包装器或使用类似PHPASS的东西来实现更旧的实现。我建议至少进行 12 轮 bcrypt，如果不是 15 到 18 轮的话。</p>
<p>当我了解到 bcrypt 仅使用 blowfish 的密钥计划，并具有可变成本机制时，我改变了使用 bcrypt
的想法。后者让您可以通过增加河豚已经很昂贵的密钥计划来增加暴力破解密码的成本。</p>
<h3>平均做法</h3>
<p>我几乎无法想象这种情况了。PHPASS支持 PHP 3.0.18 到 5.3，因此它可用于几乎所有可以想象的安装 — 如果您 <em>不确定</em> 您的环境是否支持
bcrypt，则应该使用它。</p>
<p>但是假设您根本不能使用 bcrypt 或 PHPASS。然后怎样呢？</p>
<p>尝试使用您的环境/应用程序/用户感知可以容忍的最大轮数实施PDKBF2 。我推荐的最低数量是 2500
发。此外，确保使用hash_hmac()（如果可用）以使操作更难重现。</p>
<h3>未来实践</h3>
<p>PHP 5.5 中包含一个完整的密码保护库，它消除了使用 bcrypt 的任何痛苦。虽然我们大多数人在大多数常见环境中都坚持使用 PHP 5.2 和
5.3，尤其是共享主机，@ircmaxell 已经为即将推出的 API 构建了一个兼容层，该 API 向后兼容 PHP 5.3.7。</p>
<h3>密码学回顾和免责声明</h3>
<p><em>实际破解</em>
散列密码所需的计算能力并不存在。计算机“破解”密码的唯一方法是重新创建密码并模拟用于保护密码的散列算法。哈希的速度与其被暴力破解的能力线性相关。更糟糕的是，大多数哈希算法都可以轻松并行化以更快地执行。这就是为什么像
bcrypt 和 scrypt 这样昂贵的方案如此重要的原因。</p>
<p><strong>您不可能预见所有威胁或攻击途径，因此您必须尽最大努力预先</strong> 保护您的用户。如果你不这样做，那么你甚至可能会错过你被攻击的事实，直到为时已晚......
<em>你要承担责任</em>
。为了避免这种情况，一开始就表现得偏执。攻击您自己的软件（内部）并尝试窃取用户凭据，或修改其他用户的帐户或访问他们的数据。如果您不测试系统的安全性，那么除了您自己，您不能责怪任何人。</p>
<p>最后：我不是密码学家。无论我说什么都是我的观点，但我碰巧认为它是基于良好的常识……以及大量阅读。请记住，尽可能多疑，让事情尽可能难以入侵，然后，如果您仍然担心，请联系白帽黑客或密码学家，看看他们对您的代码/系统有何看法。</p>
<p><br></p>
<h3>更多建议</h3>
<p>一个更短和更安全的答案 - <strong>根本不要编写自己的密码机制</strong> ，使用久经考验的机制。</p>
<ul>
<li>PHP 5.5 或更高版本：password_hash()质量好，是 PHP 核心的一部分。</li>
<li>PHP 4.x（过时）：OpenWall 的phpass库比大多数自定义代码要好得多——用于 WordPress、Drupal 等。</li>
</ul>
<p>大多数程序员只是不具备在不引入漏洞的情况下安全地编写加密相关代码的专业知识。</p>
<p><strong>快速自测：</strong> 什么是密码扩展以及您应该使用多少次迭代？如果您不知道答案，您应该使用<code>password_hash()</code>，因为由于更快的 CPU
以及使用GPU 和 FPGA以每秒数十亿次猜测的速度破解密码（使用 GPU ).</p>
<p>截至 2012 年，您可以使用安装在 5 台台式机上的 25 个 GPU在 6 小时内破解所有 8 个字符的 Windows
密码。这是暴力破解，即枚举和检查 <em>每个 8 字符的 Windows 密码</em> ，包括特殊字符，不是字典攻击。使用现代
GPU，您当然可以破解更多密码或使用更少 GPU——或者以合理的成本在云中租用 GPU 几个小时。</p>
<p>还有很多运行在普通CPU上的Windows密码彩虹表攻击，速度非常快。</p>
<p>这一切都是因为 Windows <em>仍然</em> 不会加盐或扩展其密码，即使在 Windows 10 中也是如此。2021年依然如此，千万不要重蹈微软的覆辙！</p>
<p><strong>也可以看看：</strong></p>
<ul>
<li>很好的答案，更多关于为什么<code>password_hash()</code>或者<code>phpass</code>是最好的方法。</li>
<li>很好的博客文章，为包括 bcrypt、scrypt 和 PBKDF2 在内的主要算法提供推荐的“工作因素”（迭代次数）。</li>
</ul>
<p><br><br><a href="posts/secure-hash-and-salt-for-php-passwords/">查看原文</a></p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-333.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-331.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
