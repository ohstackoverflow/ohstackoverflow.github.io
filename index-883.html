<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 883) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-883.html">
<link rel="prev" href="index-884.html" type="text/html">
<link rel="next" href="index-882.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/what-is-the-max-size-of-localstorage-values/" class="u-url">What is the max size of localStorage values?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/what-is-the-max-size-of-localstorage-values/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T18:32:41+08:00" itemprop="datePublished" title="2023-02-17 18:32">2023-02-17 18:32</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Since <code>localStorage</code> (currently) only supports strings as values, and in order
to do that the objects need to be stringified (stored as JSON-string) before
they can be stored, is there a defined limitation regarding the length of the
values.</p>
<p>Does anyone know if there is a definition which applies to all browsers?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Quoting from the Wikipedia article on Web Storage:</p>
<blockquote>
<p>Web storage can be viewed simplistically as an improvement on cookies,
providing much greater storage capacity ( <strong>10 MB per origin in Google
Chrome(https://plus.google.com/u/0/+FrancoisBeaufort/posts/S5Q9HqDB8bh),
Mozilla Firefox, and Opera; 10 MB per storage area in Internet Explorer</strong> )
and better programmatic interfaces.</p>
</blockquote>
<p>And also quoting from a John Resig article [posted January 2007]:</p>
<blockquote>
<p><strong>Storage Space</strong></p>
<p>It is implied that, with DOM Storage, you have considerably more storage
space than the typical user agent limitations imposed upon Cookies. However,
the amount that is provided is not defined in the specification, nor is it
meaningfully broadcast by the user agent.</p>
<p>If you look at the Mozilla source code we can see that 5120KB is the default
storage size for an entire domain. This gives you considerably more space to
work with than a typical 2KB cookie.</p>
<p><strong>However, the size of this storage area can be customized by the user</strong> (so
a 5MB storage area is not guaranteed, nor is it implied) and the user agent
(Opera, for example, may only provide 3MB - but only time will tell.)</p>
</blockquote>
<p><br></p>
<h3>Suggest</h3>
<p>Actually Opera doesn't have 5MB limit. It offers to increase limit as
applications requires more. User can even choose "Unlimited storage" for a
domain.</p>
<p>You can easily test localStorage limits/quota yourself.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-should-i-deal-with-package-xxx-is-not-available-for-r-version-x-y-z-warning/" class="u-url">How should I deal with "package 'xxx' is not available (for R version x.y.z)" warning?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-should-i-deal-with-package-xxx-is-not-available-for-r-version-x-y-z-warning/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T18:32:13+08:00" itemprop="datePublished" title="2023-02-17 18:32">2023-02-17 18:32</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I tried to install a package, using</p>
<div class="code"><pre class="code literal-block">install.packages("foobarbaz")
</pre></div>

<p>but received the warning</p>
<div class="code"><pre class="code literal-block"><span class="nv">Warning</span><span class="w"> </span><span class="nv">message</span>:
<span class="nv">package</span><span class="w"> </span><span class="s1">'foobarbaz'</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">not</span><span class="w"> </span><span class="nv">available</span><span class="w"> </span><span class="ss">(</span><span class="k">for</span><span class="w"> </span><span class="nv">R</span><span class="w"> </span><span class="nv">version</span><span class="w"> </span><span class="nv">x</span>.<span class="nv">y</span>.<span class="nv">z</span><span class="ss">)</span>
</pre></div>

<p>Why doesn't R think that the package is available?</p>
<p>See also these questions referring to specific instances of this problem:</p>
<p>My package doesn't work for R 2.15.2<br>
package 'Rbbg' is not available (for R version 2.15.2)<br>
package is not available (for R version 2.15.2)<br>
package doMC NOT available for R version 3.0.0 warning in install.packages<br>
Dependency ‘Rglpk’ is not available for package ‘fPortfolio’<br>
What to do when a package is not available for our R version?<br>
Is the bigvis package for R not available for R version 3.0.1?<br>
package ‘syncwave’/‘mvcwt’ is not available (for R version 3.0.2)<br>
package ‘diamonds’ is not available (for R version 3.0.0)<br>
Is the plyr package for R not available for R version 3.0.2?<br>
Package bigmemory not installing on R 64 3.0.2<br>
package "makeR" is not available (for version 3.0.2)<br>
package ‘RTN’ is not available (for R version 3.0.1)<br>
Trouble Installing geoR package<br>
package ‘twitterR’ is not available (for R version 3.1.0)<br>
How to install 'Rcpp, package? I got "package is not available"<br>
package ‘dataset’ is not available (for R version 3.1.1)<br>
"package ‘rhipe’ is not available (for R version 3.1.2)"</p>
<p><br><br></p>
<h2>Answer</h2>
<p><strong>1. You can't spell</strong></p>
<p>The first thing to test is <em>have you spelled the name of the package
correctly?</em> Package names are case sensitive in R.</p>
<hr>
<p><strong>2. You didn't look in the right repository</strong></p>
<p>Next, you should check to see if the package is available. Type</p>
<div class="code"><pre class="code literal-block">setRepositories()
</pre></div>

<p>See also ?setRepositories.</p>
<p>To see which repositories R will look in for your package, and optionally
select some additional ones. At the very least, you will usually want <code>CRAN</code>
to be selected, and <code>CRAN (extras)</code> if you use Windows, and the <code>Bioc*</code>
repositories if you do any biological analyses.</p>
<p>To permanently change this, add a line like <code>setRepositories(ind = c(1:6, 8))</code>
to your <code>Rprofile.site</code> file.</p>
<hr>
<p><strong>3. The package is not in the repositories you selected</strong></p>
<p>Return all the available packages using</p>
<div class="code"><pre class="code literal-block"><span class="n">ap</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">available.packages</span><span class="p">()</span>
</pre></div>

<p>See also Names of R's available packages, ?available.packages.</p>
<p>Since this is a large matrix, you may wish to use the data viewer to examine
it. Alternatively, you can quickly check to see if the package is available by
testing against the row names.</p>
<div class="code"><pre class="code literal-block">View(ap)
"foobarbaz" %in% rownames(ap)
</pre></div>

<p>Alternatively, the list of available packages can be seen in a browser for
CRAN, CRAN (extras), Bioconductor, R-forge, RForge, and GitHub.</p>
<p>Another possible warnings message you may get when interacting with CRAN
mirrors is:</p>
<div class="code"><pre class="code literal-block"><span class="n">Warning</span><span class="o">:</span><span class="w"> </span><span class="n">unable</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">repository</span>
</pre></div>

<p>Which may indicate the selected CRAN repository is currently be unavailable.
You can select a different mirror with <code>chooseCRANmirror()</code> and try the
installation again.</p>
<hr>
<p>There are several reasons why a package may not be available.</p>
<hr>
<p><strong>4. You don't want a package</strong></p>
<p>Perhaps you don't really want a package. It is common to be confused about the
difference between a package and a library, or a package and a dataset.</p>
<blockquote>
<p>A package is a standardized collection of material extending R, e.g.
providing code, data, or documentation. A library is a place (directory)
where R knows to find packages it can use</p>
</blockquote>
<p>To see available datasets, type</p>
<div class="code"><pre class="code literal-block">data()
</pre></div>

<hr>
<p><strong>5. R or Bioconductor is out of date</strong></p>
<p>It may have a dependency on a more recent version of R (or one of the packages
that it imports/depends upon does). Look at</p>
<div class="code"><pre class="code literal-block">ap["foobarbaz", "Depends"]
</pre></div>

<p>and consider updating your R installation to the current version. On Windows,
this is most easily done via the <code>installr</code> package.</p>
<div class="code"><pre class="code literal-block">library(installr)
updateR()
</pre></div>

<p>(Of course, you may need to <code>install.packages("installr")</code> first.)</p>
<p>Equivalently for Bioconductor packages, you may need to update your
Bioconductor installation.</p>
<div class="code"><pre class="code literal-block">source("http://bioconductor.org/biocLite.R")
biocLite("BiocUpgrade")
</pre></div>

<hr>
<p><strong>6. The package is out of date</strong></p>
<p>It may have been archived (if it is no longer maintained and no longer passes
<code>R CMD check</code> tests).</p>
<p>In this case, you can load an old version of the package using
<code>install_version()</code></p>
<div class="code"><pre class="code literal-block">library(remotes)
install_version("foobarbaz", "0.1.2")
</pre></div>

<p>An alternative is to install from the GitHub CRAN mirror.</p>
<div class="code"><pre class="code literal-block">library(remotes)
install_github("cran/foobarbaz")
</pre></div>

<hr>
<p><strong>7. There is no Windows/OS X/Linux binary</strong></p>
<p>It may not have a Windows binary due to requiring additional software that
CRAN does not have. Additionally, some packages are available only via the
sources for some or all platforms. In this case, there may be a version in the
<code>CRAN (extras)</code> repository (see <code>setRepositories</code> above).</p>
<p>If the package requires compiling code (e.g. C, C++, FORTRAN) then on Windows
install Rtools or on OS X install the developer tools accompanying XCode, and
install the source version of the package via:</p>
<div class="code"><pre class="code literal-block"><span class="nv">install</span>.<span class="nv">packages</span><span class="ss">(</span><span class="s2">"foobarbaz"</span>,<span class="w"> </span><span class="nv">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"source"</span><span class="ss">)</span>

#<span class="w"> </span><span class="nv">Or</span><span class="w"> </span><span class="nv">equivalently</span>,<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">Bioconductor</span><span class="w"> </span><span class="nv">packages</span>:
<span class="nv">source</span><span class="ss">(</span><span class="s2">"http://bioconductor.org/biocLite.R"</span><span class="ss">)</span>
<span class="nv">biocLite</span><span class="ss">(</span><span class="s2">"foobarbaz"</span>,<span class="w"> </span><span class="nv">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"source"</span><span class="ss">)</span>
</pre></div>

<p>On CRAN, you can tell if you'll need special tools to build the package from
source by looking at the <code>NeedsCompilation</code> flag in the description.</p>
<hr>
<p><strong>8. The package is on GitHub/Bitbucket/Gitorious</strong></p>
<p>It may have a repository on GitHub/Bitbucket/Gitorious. These packages require
the <code>remotes</code> package to install.</p>
<div class="code"><pre class="code literal-block">library(remotes)
install_github("packageauthor/foobarbaz")
install_bitbucket("packageauthor/foobarbaz")
install_gitorious("packageauthor/foobarbaz")
</pre></div>

<p>(As with <code>installr</code>, you may need to <code>install.packages("remotes")</code> first.)</p>
<hr>
<p><strong>9. There is no source version of the package</strong></p>
<p>Although the binary version of your package is available, the source version
is not. You can turn off this check by setting</p>
<div class="code"><pre class="code literal-block">options(install.packages.check.source = "no")
</pre></div>

<p>as described in this SO answer by imanuelc and the Details section of
<code>?install.packages</code>.</p>
<hr>
<p><strong>10. The package is in a non-standard repository</strong></p>
<p>Your package is in a non-standard repository (e.g. <code>Rbbg</code>). Assuming that it
is reasonably compliant with CRAN standards, you can still download it using
<code>install.packages</code>; you just have to specify the repository URL.</p>
<div class="code"><pre class="code literal-block">install.packages("Rbbg", repos = "http://r.findata.org")
</pre></div>

<p><code>RHIPE</code> on the other hand isn't in a CRAN-like repository and has its own
installation instructions.</p>
<p><br></p>
<h3>Suggest</h3>
<p>In the R 3.2.3 (new in 2016) there was a bug, preventing it some times from
finding correct package. The workaround is to set repository manually:</p>
<div class="code"><pre class="code literal-block">install.packages("lubridate", dependencies=TRUE, repos='http://cran.rstudio.com/')
</pre></div>

<p>Found solution in other question</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/what-is-mocking/" class="u-url">What is Mocking?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/what-is-mocking/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T18:31:48+08:00" itemprop="datePublished" title="2023-02-17 18:31">2023-02-17 18:31</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>What is Mocking? .</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Prologue: If you look up the noun <em>mock</em> in the dictionary you will find that
one of the definitions of the word is <em>something made as an imitation</em>.</p>
<hr>
<p>Mocking is primarily used in unit testing. An object under test may have
dependencies on other (complex) objects. To isolate the behaviour of the
object you want to test you replace the other objects by mocks that simulate
the behaviour of the real objects. This is useful if the real objects are
impractical to incorporate into the unit test.</p>
<p>In short, mocking is creating objects that simulate the behaviour of real
objects.</p>
<hr>
<p>At times you may want to distinguish between <em>mocking</em> as opposed to
<em>stubbing</em>. There may be some disagreement about this subject but my
definition of a stub is a "minimal" simulated object. The stub implements just
enough behaviour to allow the object under test to execute the test.</p>
<p>A mock is like a stub but the test will also verify that the object under test
calls the mock as expected. Part of the test is verifying that the mock was
used correctly.</p>
<p>To give an example: You can stub a database by implementing a simple in-memory
structure for storing records. The object under test can then read and write
records to the database stub to allow it to execute the test. This could test
some behaviour of the object not related to the database and the database stub
would be included just to let the test run.</p>
<p>If you instead want to verify that the object under test writes some specific
data to the database you will have to mock the database. Your test would then
incorporate assertions about what was written to the database mock.</p>
<p><br></p>
<h3>Suggest</h3>
<p>Other answers explain what mocking is. Let me walk you through it with
different <em>examples</em>. And believe me, it's actually far more simpler than you
think.</p>
<p><strong>tl;dr</strong> It's an instance of the original class. It has other data injected
into so you avoid testing the injected parts and solely <em>focus</em> on testing the
<strong>implementation details</strong> of your class/functions.</p>
<h2>Simple example:</h2>
<div class="code"><pre class="code literal-block"><span class="k">class</span><span class="w"> </span><span class="n">Foo</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">func</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="p">(</span><span class="n">num1</span><span class="p">:</span><span class="w"> </span><span class="n">Int</span><span class="p">,</span><span class="w"> </span><span class="n">num2</span><span class="p">:</span><span class="w"> </span><span class="n">Int</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Int</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">Line</span><span class="w"> </span><span class="n">A</span><span class="w"> </span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">num1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">num2</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">Line</span><span class="w"> </span><span class="n">B</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="n">let</span><span class="w"> </span><span class="n">unit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Foo</span><span class="p">()</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">unit</span><span class="w"> </span><span class="n">under</span><span class="w"> </span><span class="n">test</span>
<span class="n">assertEqual</span><span class="p">(</span><span class="n">unit</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="mi">6</span><span class="p">)</span>
</pre></div>

<p>As you can see, I'm not testing LineA ie I'm not validating the input
parameters. I'm not validating to see if num1, num2 are an Integer. I have no
asserts against that.</p>
<p>I'm only testing to see if LineB (my <em>implementation</em> ) given the mocked
values <code>1</code> and <code>5</code> is doing as I expect.</p>
<p>Obviously in the real word this can become much more complex. The parameters
can be a custom object like a Person, Address, or the implementation details
can be more than a single <code>+</code>. But the logic of testing would be the same.</p>
<h3>Non-coding Example:</h3>
<p>Assume you're building a machine that identifies the type and brand name of
electronic devices for an airport security. The machine does this by
processing what it sees with its camera.</p>
<p>Now your manager walks in the door and asks you to unit-test it.</p>
<p>Then you as a developer you can either bring 1000 real objects, like a MacBook
pro, Google Nexus, a banana, an iPad etc in front of it and test and see if it
all works.</p>
<p>But you can also use <strong>mocked</strong> objects, like an identical looking MacBook pro
(with no real internal parts) or a plastic banana in front of it. You can save
yourself from investing in 1000 real laptops and rotting bananas.</p>
<p>The point is you're not trying to test if the banana is fake or not. Nor
testing if the laptop is fake or not. All you're doing is testing if your
machine once it sees a banana it would say <code>not an electronic device</code> and for
a MacBook Pro it would say: <code>Laptop, Apple</code>. To the machine, the outcome of
its detection should be the same for fake/mocked electronics and real
electronics. If your machine also factored in the internals of a laptop (x-ray
scan) or banana then your mocks' internals need to look the same as well. But
you could also use a MacBook that no longer works.</p>
<p>Had your machine tested whether or not devices can power on then well you'd
need real devices.</p>
<p>The logic mentioned above applies to unit-testing of actual code as well. That
is a function should work the same with real values you get from <em>real</em> input
(and interactions) or <em>mocked</em> values you inject during unit-testing. And just
as how you save yourself from using a real banana or MacBook, with unit-tests
(and mocking) you save yourself from having to do something that causes your
server to return a status code of 500, 403, 200, etc (forcing your server to
trigger 500 is only when server is down, while 200 is when server is up.</p>
<p>It gets difficult to run 100 network focused tests if you have to constantly
wait 10 seconds between switching over server up and down). So instead you
inject/mock a response with status code 500, 200, 403, etc and test your
unit/function with a injected/mocked value.</p>
<p><strong>Be aware:</strong></p>
<p>Sometimes you don't correctly mock the actual object. Or you don't mock every
possibility. E.g. your fake laptops are dark, and your machine accurately
works with them, but then it doesn't work accurately with <em>white</em> fake
laptops. Later when you ship this machine to customers they complain that it
doesn't work all the time. You get random reports that it's not working. It
takes you 3 months to figure out that the color of fake laptops need to be
more varied so you can test your modules appropriately.</p>
<p>For a true coding example, your implementation may be different for status
code 200 with image data returned vs 200 with image data not returned. For
this reason it's good to use an IDE that provides code coverage e.g. the image
below shows that your unit-tests don't ever go through the lines marked with
<em>brown</em>.</p>
<p><img alt="enter image description here" src="images/ias4p.jpg"></p>
<p>image source</p>
<h3>Real world coding Example:</h3>
<p>Let's say you are writing an iOS application and have network calls.Your job
is to test <em>your</em> application. To test/identify whether or not the network
calls work as expected is NOT YOUR RESPONSIBILITY . It's another party's
(server team) responsibility to test it. You must remove this (network)
dependency and yet continue to test all your code that works <em>around</em> it.</p>
<p>A network call can return different status codes 404, 500, 200, 303, etc with
a JSON response.</p>
<p>Your app is suppose to work for <em>all</em> of them (in case of errors, your app
should throw its expected error). What you do with mocking is you create
'imaginary—similar to real' network responses (like a 200 code with a JSON
file) and test your code <em>without</em> 'making the real network call and waiting
for your network response'. You manually hardcode/return the network response
for ALL kinds of network responses and see if your app is working as you
expect. (you <em>never</em> assume/test a 200 with incorrect data, because that is
not your responsibility, your responsibility is to test <em>your</em> app with a
correct 200, or in case of a 400, 500, you test if your app throws the right
error)</p>
<p>This creating imaginary—similar to real is known as mocking.</p>
<p>In order to do this, you <strong>can't</strong> use your original code (your original code
doesn't have the pre-inserted responses, right?). You <strong>must</strong> add something
to it, inject/insert that dummy data which isn't normally needed (or a part of
your class).</p>
<p>So you create an instance the original class and add whatever (here being the
network HTTPResponse, data OR in the case of failure, you pass the correct
errorString, HTTPResponse) you need to it and then test the <em>mocked</em> class.</p>
<p>Long story short, mocking is to <em>simplify</em> and <em>limit</em> what you are testing
and also make you feed what a class depends on. In this example you <strong>avoid
testing</strong> the <strong>network calls themselves</strong> , and instead <strong>test</strong> whether or
not your app works as you expect <strong>with the injected outputs/responses</strong> —— by
<em>mocking</em> classes</p>
<p>Needless to say, you test each network response separately.</p>
<hr>
<p>Now a question that I always had in my mind was: The contracts/end points and
basically the JSON response of my APIs get updated constantly. How can I write
unit tests which take this into consideration?</p>
<p>To elaborate more on this: let’s say model requires a key/field named
<code>username</code>. You test this and your test passes. 2 weeks later backend changes
the key's name to <code>id</code>. Your tests still passes. right? or not?</p>
<p>Is it the backend developer’s responsibility to update the mocks. Should it be
part of our agreement that they provide updated mocks?</p>
<p>The answer to the above issue is that: unit tests + your development process
as a client-side developer should/would catch outdated mocked response. If you
ask me how? well the answer is:</p>
<p>Our actual app would fail (or not fail yet not have the desired behavior)
without using updated APIs...hence if that fails...we will make changes on our
development code. Which again leads to our tests failing....which we’ll have
to correct it. (Actually if we are to do the TDD process correctly we are to
not write any code about the field unless we write the test for it...and see
it fail and then go and write the actual development code for it.)</p>
<p>This all means that backend doesn’t have to say: “hey we updated the
mocks”...it <em>eventually</em> happens through your code development/debugging.
‌ّBecause it’s all part of the development process! Though if backend provides
the mocked response for you then it's easier.</p>
<p>My whole point on this is that (if you can’t automate getting updated mocked
API response then) human interaction is likely required ie <strong>manual</strong> updates
of JSONs and having short meetings to make sure their values are up to date
will become part of your process</p>
<p>This section was written thanks to a slack discussion in our CocoaHead meetup
group</p>
<h3>Confusion:</h3>
<p>It took me a while to not get confused between 'unit test for a class' and the
'stubs/mocks of a class'. E.g. in our codebase we have:</p>
<ul>
<li>class Device</li>
<li>class DeviceTests</li>
<li>class MockDevice</li>
<li>class DeviceManager</li>
</ul>
<hr>
<ul>
<li>
<code>class Device</code> is the actual class itself.</li>
<li>
<code>class DeviceTests</code> is where we write unit-tests for the <code>Device</code> class</li>
<li>
<code>class MockDevice</code> is a <em>mock</em> class of <code>Device</code>. We use it only for the purpose of testing. e.g. if our <code>DeviceManager</code> needs to get <em>unit-tested</em> then we need dummy/mock instances of the <code>Device</code> class. The <code>MockDevice</code> can be used to fulfill the need of dummy/mock instances.</li>
</ul>
<p>tldr you use mock classes/objects to test <em>other</em> objects. You don't use mock
objects to test themselves.</p>
<hr>
<p><strong>For iOS devs only:</strong></p>
<p>A very good example of mocking is this Practical Protocol-Oriented talk by
Natasha Muraschev. Just skip to minute 18:30, though the slides may become out
of sync with the actual video 🤷‍♂️</p>
<p>I really like this part from the transcript:</p>
<blockquote>
<p>Because this is testing...we do want to make sure that the <code>get</code> function
from the <code>Gettable</code> is called, <strong>because it can return and the function
could theoretically assign an array of food items from anywhere</strong>. We need
to make sure that it is called;</p>
</blockquote>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-884.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-882.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
