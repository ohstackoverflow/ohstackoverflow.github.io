<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 247) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-247.html">
<link rel="prev" href="index-248.html" type="text/html">
<link rel="next" href="index-246.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/unicodeencodeerror-ascii-codec-can-t-encode-character-u-xa0-in-position-20-ordinal-not-in-range-128/" class="u-url">UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 20: ordinal not in range(128)</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/unicodeencodeerror-ascii-codec-can-t-encode-character-u-xa0-in-position-20-ordinal-not-in-range-128/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T02:01:24+08:00" itemprop="datePublished" title="2023-02-17 02:01">2023-02-17 02:01</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I'm having problems dealing with unicode characters from text fetched from
different web pages (on different sites). I am using BeautifulSoup.</p>
<p>The problem is that the error is not always reproducible; it sometimes works
with some pages, and sometimes, it barfs by throwing a <code>UnicodeEncodeError</code>. I
have tried just about everything I can think of, and yet I have not found
anything that works consistently without throwing some kind of Unicode-related
error.</p>
<p>One of the sections of code that is causing problems is shown below:</p>
<div class="code"><pre class="code literal-block"><span class="nv">agent_telno</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">agent</span>.<span class="nv">find</span><span class="ss">(</span><span class="s1">'div'</span>,<span class="w"> </span><span class="s1">'agent_contact_number'</span><span class="ss">)</span>
<span class="nv">agent_telno</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">''</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nv">agent_telno</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="nv">agent_telno</span>.<span class="nv">contents</span>[<span class="mi">0</span>]
<span class="nv">p</span>.<span class="nv">agent_info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">str</span><span class="ss">(</span><span class="nv">agent_contact</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">' '</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nv">agent_telno</span><span class="ss">)</span>.<span class="nv">strip</span><span class="ss">()</span>
</pre></div>

<p>Here is a stack trace produced on SOME strings when the snippet above is run:</p>
<div class="code"><pre class="code literal-block">Traceback (most recent call last):
  File "foobar.py", line 792, in &lt;module&gt;
    p.agent_info = str(agent_contact + ' ' + agent_telno).strip()
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 20: ordinal not in range(128)
</pre></div>

<p>I suspect that this is because some pages (or more specifically, pages from
some of the sites) may be encoded, whilst others may be unencoded. All the
sites are based in the UK and provide data meant for UK consumption - so there
are no issues relating to internalization or dealing with text written in
anything other than English.</p>
<p>Does anyone have any ideas as to how to solve this so that I can CONSISTENTLY
fix this problem?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Read the Python Unicode HOWTO. This error is the very first example.</p>
<p>Do not use <code>str()</code> to convert from unicode to encoded text / bytes.</p>
<p>Instead, use <code>.encode()</code> to encode the string:</p>
<div class="code"><pre class="code literal-block">p.agent_info = u' '.join((agent_contact, agent_telno)).encode('utf-8').strip()
</pre></div>

<p>or work entirely in unicode.</p>
<p><br></p>
<h3>Suggest</h3>
<p>This is a classic python unicode pain point! Consider the following:</p>
<div class="code"><pre class="code literal-block">a = u'bats\u00E0'
print a
 =&gt; batsà
</pre></div>

<p>All good so far, but if we call str(a), let's see what happens:</p>
<div class="code"><pre class="code literal-block">str(a)
Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;
UnicodeEncodeError: 'ascii' codec can't encode character u'\xe0' in position 4: ordinal not in range(128)
</pre></div>

<p>Oh dip, that's not gonna do anyone any good! To fix the error, encode the
bytes explicitly with .encode and tell python what codec to use:</p>
<div class="code"><pre class="code literal-block">a.encode('utf-8')
 =&gt; 'bats\xc3\xa0'
print a.encode('utf-8')
 =&gt; batsà
</pre></div>

<p>Voil\u00E0!</p>
<p>The issue is that when you call str(), python uses the default character
encoding to try and encode the bytes you gave it, which in your case are
sometimes representations of unicode characters. To fix the problem, you have
to tell python how to deal with the string you give it by using
.encode('whatever_unicode'). Most of the time, you should be fine using utf-8.</p>
<p>For an excellent exposition on this topic, see Ned Batchelder's PyCon talk
here: http://nedbatchelder.com/text/unipain.html</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/what-s-a-quick-way-to-comment-uncomment-lines-in-vim/" class="u-url">What's a quick way to comment/uncomment lines in Vim?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/what-s-a-quick-way-to-comment-uncomment-lines-in-vim/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T02:00:37+08:00" itemprop="datePublished" title="2023-02-17 02:00">2023-02-17 02:00</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I have a Ruby code file open in vi, there are lines commented out with <code>#</code>:</p>
<div class="code"><pre class="code literal-block"><span class="k">class</span> <span class="n">Search</span> &lt; <span class="n">ActiveRecord::Migration</span>
  <span class="n">def</span> <span class="nb">self</span>.<span class="n">up</span>
    <span class="c1"># create_table :searches do |t|</span>
    <span class="c1">#   t.integer :user_id</span>
    <span class="c1">#   t.string :name</span>
    <span class="c1">#   t.string :all_of</span>
    <span class="c1">#   t.string :any_of</span>
    <span class="c1">#   t.string :none_of</span>
    <span class="c1">#   t.string :exact_phrase</span>
    <span class="c1"># </span>
    <span class="c1">#   t.timestamps</span>
    <span class="c1"># end</span>
  <span class="nb">end</span>

  <span class="n">def</span> <span class="nb">self</span>.<span class="n">down</span>
    <span class="c1"># drop_table :searches</span>
  <span class="nb">end</span>
<span class="nb">end</span>
</pre></div>

<p>Say I want to uncomment all the lines in the first <code>def ... end</code> section.
What's an efficient way to do that in Vim?</p>
<p>In general, I'm looking for an easy and fluid way to comment and uncomment
lines. Here I'm dealing with Ruby code, but it could be JavaScript (<code>//</code>) or
Haml (<code>-#</code>).</p>
<p><br><br></p>
<h2>Answer</h2>
<p>I use the NERD Commenter script. It lets you easily comment, uncomment or
toggle comments in your code.</p>
<p>As mentioned in the comments:</p>
<blockquote>
<p>for anyone who is confused by the usage, default leader is "\" so 10\cc will
comment ten lines and 10\cu will uncomment those ten lines</p>
</blockquote>
<p><br></p>
<h3>Suggest</h3>
<h3>To comment out blocks in vim:</h3>
<ul>
<li>press <code>Esc</code> (to leave editing or other mode)</li>
<li>hit <code>ctrl</code>+<code>v</code> (visual block mode)</li>
<li>use the <code>↑</code>/<code>↓</code> arrow keys to select lines you want (it won't highlight everything - it's OK!)</li>
<li>
<code>Shift</code>+<code>i</code> (capital I)</li>
<li>insert the text you want, e.g. <code>%</code>
</li>
<li>press <code>Esc``Esc</code>
</li>
</ul>
<hr>
<h3>To uncomment blocks in vim:</h3>
<ul>
<li>press <code>Esc</code> (to leave editing or other mode)</li>
<li>hit <code>ctrl</code>+<code>v</code> (visual block mode)</li>
<li>use the <code>↑</code>/<code>↓</code> arrow keys to select the lines to uncomment. </li>
</ul>
<p><em>If you want to select multiple characters, use one or combine these methods:</em></p>
<div class="code"><pre class="code literal-block"><span class="o">*</span><span class="w"> </span><span class="n">_use</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">left</span><span class="o">/</span><span class="n">right</span><span class="w"> </span><span class="n">arrow</span><span class="w"> </span><span class="n">keys</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">select</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">text_</span>
<span class="o">*</span><span class="w"> </span><span class="n">_to</span><span class="w"> </span><span class="n">select</span><span class="w"> </span><span class="n">chunks</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">text</span><span class="w"> </span><span class="n">use</span><span class="err">`</span><span class="w"> </span><span class="n">shift</span><span class="err">`</span><span class="w"> </span><span class="n">\+</span><span class="w"> </span><span class="err">`←`</span><span class="o">/</span><span class="err">`→`</span><span class="w"> </span><span class="n">arrow</span><span class="w"> </span><span class="n">key_</span>
<span class="o">*</span><span class="w"> </span><span class="n">_you</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">repeatedly</span><span class="w"> </span><span class="n">push</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">delete</span><span class="w"> </span><span class="n">keys</span><span class="w"> </span><span class="n">below</span><span class="p">,</span><span class="w"> </span><span class="n">like</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">regular</span><span class="w"> </span><span class="n">delete</span><span class="w"> </span><span class="n">button_</span>
</pre></div>

<ul>
<li>press <code>d</code> or <code>x</code> to delete characters, repeatedly if necessary</li>
</ul>
</div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/get-the-current-year-in-javascript/" class="u-url">Get the current year in JavaScript</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/get-the-current-year-in-javascript/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T01:59:49+08:00" itemprop="datePublished" title="2023-02-17 01:59">2023-02-17 01:59</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>How do I get the current year in JavaScript?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Create a <strong><code>new Date()</code></strong> object and call <strong><code>getFullYear()</code></strong> :</p>
<div class="code"><pre class="code literal-block">new Date().getFullYear()  // returns the current year
</pre></div>

<hr>
<p><strong>Example usage:</strong> a page footer that always shows the current year:</p>
<div class="code"><pre class="code literal-block">document.getElementById("year").innerHTML<span class="w"> </span>=<span class="w"> </span>new<span class="w"> </span>Date().getFullYear();


footer<span class="w"> </span>{
<span class="w">  </span>text-align:<span class="w"> </span>center;
<span class="w">  </span>font-family:<span class="w"> </span>sans-serif;
}


<span class="nt">&lt;footer&gt;</span>
<span class="w">    </span>©<span class="nt">&lt;span</span><span class="w"> </span><span class="na">id=</span><span class="s">"year"</span><span class="nt">&gt;&lt;/span&gt;</span><span class="w"> </span>by<span class="w"> </span>Donald<span class="w"> </span>Duck
<span class="nt">&lt;/footer&gt;</span>
</pre></div>

<p>See also, the <code>Date()</code> constructor's <strong>full list of methods</strong>.</p>
<p><br></p>
<h3>Suggest</h3>
<div class="code"><pre class="code literal-block"><span class="o">//</span><span class="w"> </span><span class="n">Return</span><span class="w"> </span><span class="n">today</span><span class="s1">'s date and time</span>
<span class="k">var</span><span class="w"> </span><span class="n">currentTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">Date</span><span class="p">()</span>

<span class="o">//</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">month</span><span class="w"> </span><span class="p">(</span><span class="n">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mi">11</span><span class="p">)</span>
<span class="k">var</span><span class="w"> </span><span class="n">month</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">currentTime</span><span class="o">.</span><span class="n">getMonth</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>

<span class="o">//</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">day</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">month</span><span class="w"> </span><span class="p">(</span><span class="n">from</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mi">31</span><span class="p">)</span>
<span class="k">var</span><span class="w"> </span><span class="n">day</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">currentTime</span><span class="o">.</span><span class="n">getDate</span><span class="p">()</span>

<span class="o">//</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">year</span><span class="w"> </span><span class="p">(</span><span class="n">four</span><span class="w"> </span><span class="n">digits</span><span class="p">)</span>
<span class="k">var</span><span class="w"> </span><span class="n">year</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">currentTime</span><span class="o">.</span><span class="n">getFullYear</span><span class="p">()</span>

<span class="o">//</span><span class="w"> </span><span class="n">write</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">MM</span><span class="o">/</span><span class="n">dd</span><span class="o">/</span><span class="n">yyyy</span>
<span class="n">document</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">month</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">"/"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">day</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">"/"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">year</span><span class="p">)</span>
</pre></div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-248.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-246.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
