<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 786) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-786.html">
<link rel="prev" href="index-787.html" type="text/html">
<link rel="next" href="index-785.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/do-i-use-img-object-or-embed-for-svg-files/" class="u-url">Do I use &lt;img&gt;, &lt;object&gt;, or &lt;embed&gt; for SVG files?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/do-i-use-img-object-or-embed-for-svg-files/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T15:57:29+08:00" itemprop="datePublished" title="2023-02-17 15:57">2023-02-17 15:57</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Should I use <code>&lt;img&gt;</code>, <code>&lt;object&gt;</code>, or <code>&lt;embed&gt;</code> for loading SVG files into a
page in a way similar to loading a <code>jpg</code>, <code>gif</code> or <code>png</code>?</p>
<p>What is the code for each to ensure it works as well as possible? <em>(I'm seeing
references to including the mimetype or pointing to fallback SVG renderers in
my research and not seeing a good state of the art reference).</em></p>
<p>Assume I am checking for SVG support with Modernizr and falling back (probably
doing a replacement with a plain <code>&lt;img&gt;</code> tag)for non SVG-capable browsers.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>I can recommend the SVG Primer (published by the W3C), which covers this
topic: http://www.w3.org/Graphics/SVG/IG/resources/svgprimer.html#SVG_in_HTML</p>
<p>If you use <code>&lt;object&gt;</code> then you get raster fallback for free*:</p>
<div class="code"><pre class="code literal-block"><span class="nt">&lt;object</span><span class="w"> </span><span class="na">data=</span><span class="s">"your.svg"</span><span class="w"> </span><span class="na">type=</span><span class="s">"image/svg+xml"</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;img</span><span class="w"> </span><span class="na">src=</span><span class="s">"yourfallback.jpg"</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="nt">&lt;/object&gt;</span>
</pre></div>

<p>*) Well, not quite for free, because some browsers download both resources, see Larry's suggestion below for how to get around that.</p>
<p><strong>2014 update:</strong></p>
<ul>
<li>If you want a non-interactive svg, use <code>&lt;img&gt;</code> with script fallbacks to png version (for older IE and android &lt; 3). One clean and simple way to do that:</li>
</ul>
<p><code>&lt;img src="your.svg" onerror="this.src='your.png'"&gt;</code>.</p>
<p>This will behave much like a GIF image, and if your browser supports
declarative animations (SMIL) then those will play.</p>
<ul>
<li>
<p>If you want an interactive svg, use either <code>&lt;iframe&gt;</code> or <code>&lt;object&gt;</code>. </p>
</li>
<li>
<p>If you need to provide older browsers the ability to use an svg plugin, then use <code>&lt;embed&gt;</code>.</p>
</li>
<li>
<p>For svg in css <code>background-image</code> and similar properties, modernizr is one choice for switching to fallback images, another is depending on multiple backgrounds to do it automatically:</p>
<div class="code"><pre class="code literal-block"><span class="nt">div</span><span class="w"> </span><span class="p">{</span>
<span class="k">background-image</span><span class="p">:</span><span class="w"> </span><span class="nb">url</span><span class="p">(</span><span class="sx">fallback.png</span><span class="p">);</span>
<span class="k">background-image</span><span class="p">:</span><span class="w"> </span><span class="nb">url</span><span class="p">(</span><span class="sx">your.svg</span><span class="p">),</span><span class="w"> </span><span class="kc">none</span><span class="p">;</span>
</pre></div>

<p>}</p>
</li>
</ul>
<p><strong><em>Note</em></strong> <em>: the multiple backgrounds strategy doesn't work on Android 2.3
because it supports multiple backgrounds but not svg.</em></p>
<p>An additional good read is this blogpost on svg fallbacks.</p>
<p><br></p>
<h3>Suggest</h3>
<p>From IE9 and above you can use SVG in a ordinary IMG tag..</p>
<p>https://caniuse.com/svg-img</p>
<div class="code"><pre class="code literal-block">&lt;img src="/static/image.svg"&gt;
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/implementing-inotifypropertychanged-does-a-better-way-exist/" class="u-url">Implementing INotifyPropertyChanged - does a better way exist?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/implementing-inotifypropertychanged-does-a-better-way-exist/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T15:56:59+08:00" itemprop="datePublished" title="2023-02-17 15:56">2023-02-17 15:56</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Microsoft should have implemented something snappy for
<code>INotifyPropertyChanged</code>, like in the automatic properties, just specify
<code>{get; set; notify;}</code> I think it makes a lot of sense to do it. Or are there
any complications to do it?</p>
<p>Can we ourselves implement something like 'notify' in our properties. Is there
a graceful solution for implementing <strong><code>INotifyPropertyChanged</code></strong> in your
class or the only way to do it is by raising the <code>PropertyChanged</code> event in
each property.</p>
<p>If not can we write something to auto-generate the piece of code to raise
<code>PropertyChanged</code> event?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Without using something like postsharp, the minimal version I use uses
something like:</p>
<div class="code"><pre class="code literal-block"><span class="nv">public</span><span class="w"> </span><span class="nv">class</span><span class="w"> </span><span class="nv">Data</span><span class="w"> </span>:<span class="w"> </span><span class="nv">INotifyPropertyChanged</span>
{
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="nv">boiler</span><span class="o">-</span><span class="nv">plate</span>
<span class="w">    </span><span class="nv">public</span><span class="w"> </span><span class="nv">event</span><span class="w"> </span><span class="nv">PropertyChangedEventHandler</span><span class="w"> </span><span class="nv">PropertyChanged</span><span class="c1">;</span>
<span class="w">    </span><span class="nv">protected</span><span class="w"> </span><span class="nv">virtual</span><span class="w"> </span><span class="nv">void</span><span class="w"> </span><span class="nv">OnPropertyChanged</span><span class="ss">(</span><span class="nv">string</span><span class="w"> </span><span class="nv">propertyName</span><span class="ss">)</span>
<span class="w">    </span>{
<span class="w">        </span><span class="nv">PropertyChangedEventHandler</span><span class="w"> </span><span class="nv">handler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">PropertyChanged</span><span class="c1">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">handler</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nv">null</span><span class="ss">)</span><span class="w"> </span><span class="nv">handler</span><span class="ss">(</span><span class="nv">this</span>,<span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">PropertyChangedEventArgs</span><span class="ss">(</span><span class="nv">propertyName</span><span class="ss">))</span><span class="c1">;</span>
<span class="w">    </span>}
<span class="w">    </span><span class="nv">protected</span><span class="w"> </span><span class="nv">bool</span><span class="w"> </span><span class="nv">SetField</span><span class="o">&lt;</span><span class="nv">T</span><span class="o">&gt;</span><span class="ss">(</span><span class="nv">ref</span><span class="w"> </span><span class="nv">T</span><span class="w"> </span><span class="nv">field</span>,<span class="w"> </span><span class="nv">T</span><span class="w"> </span><span class="nv">value</span>,<span class="w"> </span><span class="nv">string</span><span class="w"> </span><span class="nv">propertyName</span><span class="ss">)</span>
<span class="w">    </span>{
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">EqualityComparer</span><span class="o">&lt;</span><span class="nv">T</span><span class="o">&gt;</span>.<span class="nv">Default</span>.<span class="nv">Equals</span><span class="ss">(</span><span class="nv">field</span>,<span class="w"> </span><span class="nv">value</span><span class="ss">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nv">false</span><span class="c1">;</span>
<span class="w">        </span><span class="nv">field</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">value</span><span class="c1">;</span>
<span class="w">        </span><span class="nv">OnPropertyChanged</span><span class="ss">(</span><span class="nv">propertyName</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nv">true</span><span class="c1">;</span>
<span class="w">    </span>}

<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="nv">props</span>
<span class="w">    </span><span class="nv">private</span><span class="w"> </span><span class="nv">string</span><span class="w"> </span><span class="nv">name</span><span class="c1">;</span>
<span class="w">    </span><span class="nv">public</span><span class="w"> </span><span class="nv">string</span><span class="w"> </span><span class="nv">Name</span>
<span class="w">    </span>{
<span class="w">        </span><span class="nv">get</span><span class="w"> </span>{<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nv">name</span><span class="c1">; }</span>
<span class="w">        </span><span class="nv">set</span><span class="w"> </span>{<span class="w"> </span><span class="nv">SetField</span><span class="ss">(</span><span class="nv">ref</span><span class="w"> </span><span class="nv">name</span>,<span class="w"> </span><span class="nv">value</span>,<span class="w"> </span><span class="s2">"Name"</span><span class="ss">)</span><span class="c1">; }</span>
<span class="w">    </span>}
}
</pre></div>

<p>Each property is then just something like:</p>
<div class="code"><pre class="code literal-block"><span class="nv">private</span><span class="w"> </span><span class="nv">string</span><span class="w"> </span><span class="nv">name</span><span class="c1">;</span>
<span class="nv">public</span><span class="w"> </span><span class="nv">string</span><span class="w"> </span><span class="nv">Name</span>
{
<span class="w">    </span><span class="nv">get</span><span class="w"> </span>{<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nv">name</span><span class="c1">; }</span>
<span class="w">    </span><span class="nv">set</span><span class="w"> </span>{<span class="w"> </span><span class="nv">SetField</span><span class="ss">(</span><span class="nv">ref</span><span class="w"> </span><span class="nv">name</span>,<span class="w"> </span><span class="nv">value</span>,<span class="w"> </span><span class="s2">"Name"</span><span class="ss">)</span><span class="c1">; }</span>
}
</pre></div>

<p>which isn't huge; it can also be used as a base-class if you want. The <code>bool</code>
return from <code>SetField</code> tells you if it was a no-op, in case you want to apply
other logic.</p>
<hr>
<p>or even easier with C# 5:</p>
<div class="code"><pre class="code literal-block"><span class="n">protected</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="n">SetField</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">(</span><span class="k">ref</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="n">field</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="k">value</span><span class="p">,</span>
<span class="w">    </span><span class="o">[</span><span class="n">CallerMemberName</span><span class="o">]</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">propertyName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">null</span><span class="p">)</span>
<span class="err">{</span><span class="p">...</span><span class="err">}</span>
</pre></div>

<p>which can be called like this:</p>
<div class="code"><pre class="code literal-block">set { SetField(ref name, value); }
</pre></div>

<p>with which the compiler will add the <code>"Name"</code> automatically.</p>
<hr>
<p>C# 6.0 makes the implementation easier:</p>
<div class="code"><pre class="code literal-block"><span class="n">protected</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="n">OnPropertyChanged</span><span class="p">(</span><span class="o">[</span><span class="n">CallerMemberName</span><span class="o">]</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">propertyName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">null</span><span class="p">)</span>
<span class="err">{</span>
<span class="w">    </span><span class="n">PropertyChanged</span><span class="vm">?</span><span class="p">.</span><span class="n">Invoke</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PropertyChangedEventArgs</span><span class="p">(</span><span class="n">propertyName</span><span class="p">));</span>
<span class="err">}</span>
</pre></div>

<hr>
<p>...and now with C#7:</p>
<div class="code"><pre class="code literal-block"><span class="n">protected</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="n">OnPropertyChanged</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">propertyName</span><span class="p">)</span>
<span class="w">   </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">PropertyChanged</span><span class="vm">?</span><span class="p">.</span><span class="n">Invoke</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PropertyChangedEventArgs</span><span class="p">(</span><span class="n">propertyName</span><span class="p">));</span>

<span class="n">protected</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="n">SetField</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">(</span><span class="k">ref</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="n">field</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="k">value</span><span class="p">,</span><span class="o">[</span><span class="n">CallerMemberName</span><span class="o">]</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">propertyName</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="k">null</span><span class="p">)</span>
<span class="err">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">EqualityComparer</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">.</span><span class="k">Default</span><span class="p">.</span><span class="k">Equals</span><span class="p">(</span><span class="n">field</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="k">false</span><span class="p">;</span>
<span class="w">    </span><span class="n">field</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">value</span><span class="p">;</span>
<span class="w">    </span><span class="n">OnPropertyChanged</span><span class="p">(</span><span class="n">propertyName</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">true</span><span class="p">;</span>
<span class="err">}</span>

<span class="n">private</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="k">public</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">Name</span>
<span class="err">{</span>
<span class="w">    </span><span class="k">get</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="w">    </span><span class="k">set</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">SetField</span><span class="p">(</span><span class="k">ref</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="p">);</span>
<span class="err">}</span>
</pre></div>

<hr>
<p>And, with C# 8 and Nullable reference types, it would look like this:</p>
<div class="code"><pre class="code literal-block"><span class="k">public</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="n">PropertyChangedEventHandler</span><span class="vm">?</span><span class="w"> </span><span class="n">PropertyChanged</span><span class="p">;</span>

<span class="n">protected</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="n">OnPropertyChanged</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">propertyName</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">PropertyChanged</span><span class="vm">?</span><span class="p">.</span><span class="n">Invoke</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PropertyChangedEventArgs</span><span class="p">(</span><span class="n">propertyName</span><span class="p">));</span>

<span class="n">protected</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="n">SetField</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">(</span><span class="k">ref</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="n">field</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="k">value</span><span class="p">,</span><span class="w"> </span><span class="o">[</span><span class="n">CallerMemberName</span><span class="o">]</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">propertyName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">""</span><span class="p">)</span>
<span class="err">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">EqualityComparer</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">.</span><span class="k">Default</span><span class="p">.</span><span class="k">Equals</span><span class="p">(</span><span class="n">field</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="k">false</span><span class="p">;</span>
<span class="w">    </span><span class="n">field</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">value</span><span class="p">;</span>
<span class="w">    </span><span class="n">OnPropertyChanged</span><span class="p">(</span><span class="n">propertyName</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">true</span><span class="p">;</span>
<span class="err">}</span>

<span class="n">private</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="k">public</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">Name</span>
<span class="err">{</span>
<span class="w">    </span><span class="k">get</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="w">    </span><span class="k">set</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">SetField</span><span class="p">(</span><span class="k">ref</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="p">);</span>
<span class="err">}</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<h3>As of .Net 4.5 there is finally an easy way to do this.</h3>
<p>.Net 4.5 introduces a new Caller Information Attributes.</p>
<div class="code"><pre class="code literal-block"><span class="n">private</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="n">OnPropertyChanged</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">(</span><span class="o">[</span><span class="n">CallerMemberName</span><span class="o">]</span><span class="n">string</span><span class="w"> </span><span class="n">caller</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">null</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">     </span><span class="o">//</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">sure</span><span class="w"> </span><span class="k">only</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">call</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">value</span><span class="w"> </span><span class="n">actually</span><span class="w"> </span><span class="n">changes</span>

<span class="w">     </span><span class="nf">var</span><span class="w"> </span><span class="n">handler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PropertyChanged</span><span class="p">;</span>
<span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">handler</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">null</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="n">handler</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PropertyChangedEventArgs</span><span class="p">(</span><span class="n">caller</span><span class="p">));</span>
<span class="w">     </span><span class="err">}</span>
<span class="err">}</span>
</pre></div>

<p>It's probably a good idea to add a comparer to the function as well.</p>
<div class="code"><pre class="code literal-block">EqualityComparer&lt;T&gt;.Default.Equals
</pre></div>

<p>More examples here and here</p>
<p>Also see Caller Information (C# and Visual Basic)</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/check-if-pull-needed-in-git/" class="u-url">Check if pull needed in Git</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/check-if-pull-needed-in-git/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T15:56:30+08:00" itemprop="datePublished" title="2023-02-17 15:56">2023-02-17 15:56</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>How do I check whether the remote repository has changed and I need to pull?</p>
<p>Now I use this simple script:</p>
<div class="code"><pre class="code literal-block">git pull --dry-run | grep -q -v 'Already up-to-date.' &amp;&amp; changed=1
</pre></div>

<p>But it is rather heavy.</p>
<p>Is there a better way? The ideal solution would check all the remote branches,
and return names of the changed branches and the number of new commits in each
one.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>First use <code>git remote update</code>, to bring your remote refs up to date. Then you
can do one of several things, such as:</p>
<ol>
<li>
<p><code>git status -uno</code> will tell you whether the branch you are tracking is ahead, behind or has diverged. If it says nothing, the local and remote are the same.</p>
</li>
<li>
<p><code>git show-branch *master</code> will show you the commits in all of the branches whose names end in 'master' (eg <em>master</em> and <em>origin/master</em> ).</p>
</li>
</ol>
<p>If you use <code>-v</code> with <code>git remote update</code> (<code>git remote -v update</code>) you can see
which branches got updated, so you don't really need any further commands.</p>
<p>However, it looks like you want to do this in a script or program and end up
with a true/false value. If so, there are ways to check the relationship
between your current <em>HEAD</em> commit and the head of the branch you're tracking,
although since there are four possible outcomes you can't reduce it to a
yes/no answer. However, if you're prepared to do a <code>pull --rebase</code> then you
can treat "local is behind" and "local has diverged" as "need to pull", and
the other two ("local is ahead" and "same") as "don't need to pull".</p>
<p>You can get the commit id of any ref using <code>git rev-parse &lt;ref&gt;</code>, so you can
do this for <em>master</em> and <em>origin/master</em> and compare them. If they're equal,
the branches are the same. If they're unequal, you want to know which is ahead
of the other. Using <code>git merge-base master origin/master</code> will tell you the
common ancestor of both branches, and if they haven't diverged this will be
the same as one or the other. If you get three different ids, the branches
have diverged.</p>
<p>To do this properly, eg in a script, you need to be able to refer to the
current branch, and the remote branch it's tracking. The bash prompt-setting
function in <code>/etc/bash_completion.d</code> has some useful code for getting branch
names. However, you probably don't actually need to get the names. Git has
some neat shorthands for referring to branches and commits (as documented in
<code>git rev-parse --help</code>). In particular, you can use <code>@</code> for the current branch
(assuming you're not in a detached-head state) and <code>@{u}</code> for its upstream
branch (eg <code>origin/master</code>). So <code>git merge-base @ @{u}</code> will return the (hash
of the) commit at which the current branch and its upstream diverge and <code>git
rev-parse @</code> and <code>git rev-parse @{u}</code> will give you the hashes of the two
tips. This can be summarized in the following script:</p>
<div class="code"><table class="codetable">
<tr>
<td class="linenos linenodiv"><a href="posts/check-if-pull-needed-in-git/#-1"><code data-line-number=" 1"></code></a></td>
<td class="code"><code><span class="ch">#!/bin/sh</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/check-if-pull-needed-in-git/#-2"><code data-line-number=" 2"></code></a></td>
<td class="code"><code>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/check-if-pull-needed-in-git/#-3"><code data-line-number=" 3"></code></a></td>
<td class="code"><code><span class="nv">UPSTREAM</span><span class="o">=</span><span class="si">${</span><span class="nv">1</span><span class="k">:-</span><span class="s1">'@{u}'</span><span class="si">}</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/check-if-pull-needed-in-git/#-4"><code data-line-number=" 4"></code></a></td>
<td class="code"><code><span class="nv">LOCAL</span><span class="o">=</span><span class="k">$(</span>git<span class="w"> </span>rev-parse<span class="w"> </span>@<span class="k">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/check-if-pull-needed-in-git/#-5"><code data-line-number=" 5"></code></a></td>
<td class="code"><code><span class="nv">REMOTE</span><span class="o">=</span><span class="k">$(</span>git<span class="w"> </span>rev-parse<span class="w"> </span><span class="s2">"</span><span class="nv">$UPSTREAM</span><span class="s2">"</span><span class="k">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/check-if-pull-needed-in-git/#-6"><code data-line-number=" 6"></code></a></td>
<td class="code"><code><span class="nv">BASE</span><span class="o">=</span><span class="k">$(</span>git<span class="w"> </span>merge-base<span class="w"> </span>@<span class="w"> </span><span class="s2">"</span><span class="nv">$UPSTREAM</span><span class="s2">"</span><span class="k">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/check-if-pull-needed-in-git/#-7"><code data-line-number=" 7"></code></a></td>
<td class="code"><code>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/check-if-pull-needed-in-git/#-8"><code data-line-number=" 8"></code></a></td>
<td class="code"><code><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$LOCAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$REMOTE</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/check-if-pull-needed-in-git/#-9"><code data-line-number=" 9"></code></a></td>
<td class="code"><code><span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">"Up-to-date"</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/check-if-pull-needed-in-git/#-10"><code data-line-number="10"></code></a></td>
<td class="code"><code><span class="k">elif</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$LOCAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$BASE</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/check-if-pull-needed-in-git/#-11"><code data-line-number="11"></code></a></td>
<td class="code"><code><span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">"Need to pull"</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/check-if-pull-needed-in-git/#-12"><code data-line-number="12"></code></a></td>
<td class="code"><code><span class="k">elif</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$REMOTE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$BASE</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/check-if-pull-needed-in-git/#-13"><code data-line-number="13"></code></a></td>
<td class="code"><code><span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">"Need to push"</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/check-if-pull-needed-in-git/#-14"><code data-line-number="14"></code></a></td>
<td class="code"><code><span class="k">else</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/check-if-pull-needed-in-git/#-15"><code data-line-number="15"></code></a></td>
<td class="code"><code><span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">"Diverged"</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/check-if-pull-needed-in-git/#-16"><code data-line-number="16"></code></a></td>
<td class="code"><code><span class="k">fi</span>
</code></td>
</tr>
</table></div>
<p><em>Note:</em> older versions of git didn't allow <code>@</code> on its own, so you may have to
use <code>@{0}</code> instead.</p>
<p>The line <code>UPSTREAM=${1:-'@{u}'}</code> allows you optionally to pass an upstream
branch explicitly, in case you want to check against a different remote branch
than the one configured for the current branch. This would typically be of the
form <em>remotename/branchname</em>. If no parameter is given, the value defaults to
<code>@{u}</code>.</p>
<p>The script assumes that you've done a <code>git fetch</code> or <code>git remote update</code>
first, to bring the tracking branches up to date. I didn't build this into the
script because it's more flexible to be able to do the fetching and the
comparing as separate operations, for example if you want to compare without
fetching because you already fetched recently.</p>
<p><br></p>
<h3>Suggest</h3>
<h3>If you have an upstream branch</h3>
<div class="code"><pre class="code literal-block">git fetch &lt;remote&gt;
git status
</pre></div>

<h3>If you don't have an upstream branch</h3>
<p>Compare the two branches:</p>
<div class="code"><pre class="code literal-block">git fetch &lt;remote&gt;
git log &lt;local_branch_name&gt;..&lt;remote_branch_name&gt; --oneline
</pre></div>

<p>For example:</p>
<div class="code"><pre class="code literal-block"><span class="nv">git</span><span class="w"> </span><span class="nv">fetch</span><span class="w"> </span><span class="nv">origin</span>

#<span class="w"> </span><span class="nv">See</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nv">there</span><span class="w"> </span><span class="nv">are</span><span class="w"> </span><span class="nv">any</span><span class="w"> </span><span class="nv">incoming</span><span class="w"> </span><span class="nv">changes</span>
<span class="nv">git</span><span class="w"> </span><span class="nv">log</span><span class="w"> </span><span class="nv">HEAD</span>..<span class="nv">origin</span><span class="o">/</span><span class="nv">master</span><span class="w"> </span><span class="o">--</span><span class="nv">oneline</span>
</pre></div>

<p>(I'm assuming <code>origin/master</code> is your remote tracking branch)</p>
<p>If any commits are listed in the output above, then you have incoming changes
-- you need to merge. If no commits are listed by <code>git log</code> then there is
nothing to merge.</p>
<p>Note that this will work even if you are on a feature branch -- that does not
have a tracking remote, since if explicitly refers to <code>origin/master</code> instead
of implicitly using the <em>upstream branch</em> remembered by Git.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-787.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-785.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
