<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 516) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-516.html">
<link rel="prev" href="index-517.html" type="text/html">
<link rel="next" href="index-515.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/cong-javascript-zhong-de-zi-fu-chuan-zhong-qu-chu-suo-you-fei-shu-zi-zi-fu/" class="u-url">从 JavaScript 中的字符串中去除所有非数字字符</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/cong-javascript-zhong-de-zi-fu-chuan-zhong-qu-chu-suo-you-fei-shu-zi-zi-fu/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T08:59:12+08:00" itemprop="datePublished" title="2023-02-17 08:59">2023-02-17 08:59</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>考虑一个非 DOM 场景，您希望使用 JavaScript/ECMAScript 从字符串中删除所有非数字字符。<code>0 - 9</code>应保留范围内的任何字符。</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">myString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'abc123.8&lt;blah&gt;'</span><span class="p">;</span>

<span class="o">//</span><span class="n">desired</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="mi">1238</span>
</pre></div>

<p>你将如何在纯 JavaScript 中实现这一点？请记住这是一个非 DOM 场景，因此 jQuery 和其他涉及浏览器和按键事件的解决方案不适合。</p>
<p><br><br></p>
<h2>解答</h2>
<p>将字符串的<code>.replace</code>方法与正则表达式一起使用<code>\D</code>，这是一个匹配所有非数字的速记字符类：</p>
<div class="code"><pre class="code literal-block">myString = myString.replace(/\D/g,'');
</pre></div>

<p><br></p>
<h3>更多建议</h3>
<p>如果你需要这个来为浮点数留下点，使用这个</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"-12345.50 €"</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="o">/</span><span class="p">[</span><span class="o">^</span>\<span class="n">d</span><span class="o">.-</span><span class="p">]</span><span class="o">/</span><span class="n">g</span><span class="p">,</span><span class="w"> </span><span class="s1">''</span><span class="p">);</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">gives</span><span class="w"> </span><span class="s2">"-12345.50"</span>
</pre></div>

<p><br><br><a href="posts/strip-all-non-numeric-characters-from-string-in-javascript/">查看原文</a></p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/xcode-xiang-mu-de-git-hu-lue-wen-jian/" class="u-url">Xcode 项目的 Git 忽略文件</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/xcode-xiang-mu-de-git-hu-lue-wen-jian/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T08:58:46+08:00" itemprop="datePublished" title="2023-02-17 08:58">2023-02-17 08:58</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p><em>将Git与</em> <em>Xcode</em> 结合<code>.gitignore</code>使用时，我应该包含哪些文件？ <strong> </strong></p>
<p><br><br></p>
<h2>解答</h2>
<p>我之前使用的是投票最高的答案，但它需要一些清理，所以这里为 Xcode 4 重做，并进行了一些改进。</p>
<p>我已经研究了这个列表中的 <em>每个</em> 文件，但其中有几个文件不存在于 Apple 的官方 Xcode 文档中，所以我不得不继续访问 Apple 邮件列表。</p>
<p>Apple
继续添加未记录的文件，可能会破坏我们的实时项目。这个恕我直言是不可接受的，现在我已经开始记录每次他们这样做时针对它的错误。我知道他们不在乎，但也许这会让他们中的一个感到羞耻，从而更公平地对待开发人员。</p>
<hr>
<p>如果您需要自定义，这里有一个您可以分叉的要点： https: //gist.github.com/3786883</p>
<hr>
<div class="code"><pre class="code literal-block"><span class="c1">#########################</span>
<span class="c1"># .gitignore file for Xcode4 and Xcode5 Source projects</span>
<span class="c1">#</span>
<span class="c1"># Apple bugs, waiting for Apple to fix/respond:</span>
<span class="c1">#</span>
<span class="c1">#    15564624 - what does the xccheckout file in Xcode5 do? Where's the documentation?</span>
<span class="c1">#</span>
<span class="c1"># Version 2.6</span>
<span class="c1"># For latest version, see: http://stackoverflow.com/questions/49478/git-ignore-file-for-xcode-projects</span>
<span class="c1">#</span>
<span class="c1"># 2015 updates:</span>
<span class="c1"># - Fixed typo in "xccheckout" line - thanks to @lyck for pointing it out!</span>
<span class="c1"># - Fixed the .idea optional ignore. Thanks to @hashier for pointing this out</span>
<span class="c1"># - Finally added "xccheckout" to the ignore. Apple still refuses to answer support requests about this, but in practice it seems you should ignore it.</span>
<span class="c1"># - minor tweaks from Jona and Coeur (slightly more precise xc* filtering/names)</span>
<span class="c1"># 2014 updates:</span>
<span class="c1"># - appended non-standard items DISABLED by default (uncomment if you use those tools)</span>
<span class="c1"># - removed the edit that an SO.com moderator made without bothering to ask me</span>
<span class="c1"># - researched CocoaPods .lock more carefully, thanks to Gokhan Celiker</span>
<span class="c1"># 2013 updates:</span>
<span class="c1"># - fixed the broken "save personal Schemes"</span>
<span class="c1"># - added line-by-line explanations for EVERYTHING (some were missing)</span>
<span class="c1">#</span>
<span class="c1"># NB: if you are storing "built" products, this WILL NOT WORK,</span>
<span class="c1"># and you should use a different .gitignore (or none at all)</span>
<span class="c1"># This file is for SOURCE projects, where there are many extra</span>
<span class="c1"># files that we want to exclude</span>
<span class="c1">#</span>
<span class="c1">#########################</span>

<span class="c1">#####</span>
<span class="c1"># OS X temporary files that should never be committed</span>
<span class="c1">#</span>
<span class="c1"># c.f. http://www.westwind.com/reference/os-x/invisibles.html</span>

<span class="o">.</span><span class="n">DS_Store</span>

<span class="c1"># c.f. http://www.westwind.com/reference/os-x/invisibles.html</span>

<span class="o">.</span><span class="n">Trashes</span>

<span class="c1"># c.f. http://www.westwind.com/reference/os-x/invisibles.html</span>

<span class="o">*.</span><span class="n">swp</span>

<span class="c1">#</span>
<span class="c1"># *.lock - this is used and abused by many editors for many different things.</span>
<span class="c1">#    For the main ones I use (e.g. Eclipse), it should be excluded</span>
<span class="c1">#    from source-control, but YMMV.</span>
<span class="c1">#   (lock files are usually local-only file-synchronization on the local FS that should NOT go in git)</span>
<span class="c1"># c.f. the "OPTIONAL" section at bottom though, for tool-specific variations!</span>
<span class="c1">#</span>
<span class="c1"># In particular, if you're using CocoaPods, you'll want to comment-out this line:</span>
<span class="o">*.</span><span class="n">lock</span>


<span class="c1">#</span>
<span class="c1"># profile - REMOVED temporarily (on double-checking, I can't find it in OS X docs?)</span>
<span class="c1">#profile</span>


<span class="c1">####</span>
<span class="c1"># Xcode temporary files that should never be committed</span>
<span class="c1"># </span>
<span class="c1"># NB: NIB/XIB files still exist even on Storyboard projects, so we want this...</span>

<span class="o">*~.</span><span class="n">nib</span>


<span class="c1">####</span>
<span class="c1"># Xcode build files -</span>
<span class="c1">#</span>
<span class="c1"># NB: slash on the end, so we only remove the FOLDER, not any files that were badly named "DerivedData"</span>

<span class="n">DerivedData</span><span class="o">/</span>

<span class="c1"># NB: slash on the end, so we only remove the FOLDER, not any files that were badly named "build"</span>

<span class="n">build</span><span class="o">/</span>


<span class="c1">#####</span>
<span class="c1"># Xcode private settings (window sizes, bookmarks, breakpoints, custom executables, smart groups)</span>
<span class="c1">#</span>
<span class="c1"># This is complicated:</span>
<span class="c1">#</span>
<span class="c1"># SOMETIMES you need to put this file in version control.</span>
<span class="c1"># Apple designed it poorly - if you use "custom executables", they are</span>
<span class="c1">#  saved in this file.</span>
<span class="c1"># 99% of projects do NOT use those, so they do NOT want to version control this file.</span>
<span class="c1">#  ..but if you're in the 1%, comment out the line "*.pbxuser"</span>

<span class="c1"># .pbxuser: http://lists.apple.com/archives/xcode-users/2004/Jan/msg00193.html</span>

<span class="o">*.</span><span class="n">pbxuser</span>

<span class="c1"># .mode1v3: http://lists.apple.com/archives/xcode-users/2007/Oct/msg00465.html</span>

<span class="o">*.</span><span class="n">mode1v3</span>

<span class="c1"># .mode2v3: http://lists.apple.com/archives/xcode-users/2007/Oct/msg00465.html</span>

<span class="o">*.</span><span class="n">mode2v3</span>

<span class="c1"># .perspectivev3: http://stackoverflow.com/questions/5223297/xcode-projects-what-is-a-perspectivev3-file</span>

<span class="o">*.</span><span class="n">perspectivev3</span>

<span class="c1">#    NB: also, whitelist the default ones, some projects need to use these</span>
<span class="o">!</span><span class="n">default</span><span class="o">.</span><span class="n">pbxuser</span>
<span class="o">!</span><span class="n">default</span><span class="o">.</span><span class="n">mode1v3</span>
<span class="o">!</span><span class="n">default</span><span class="o">.</span><span class="n">mode2v3</span>
<span class="o">!</span><span class="n">default</span><span class="o">.</span><span class="n">perspectivev3</span>


<span class="c1">####</span>
<span class="c1"># Xcode 4 - semi-personal settings</span>
<span class="c1">#</span>
<span class="c1"># Apple Shared data that Apple put in the wrong folder</span>
<span class="c1"># c.f. http://stackoverflow.com/a/19260712/153422</span>
<span class="c1">#     FROM ANSWER: Apple says "don't ignore it"</span>
<span class="c1">#     FROM COMMENTS: Apple is wrong; Apple code is too buggy to trust; there are no known negative side-effects to ignoring Apple's unofficial advice and instead doing the thing that actively fixes bugs in Xcode</span>
<span class="c1"># Up to you, but ... current advice: ignore it.</span>
<span class="o">*.</span><span class="n">xccheckout</span>

<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1"># OPTION 1: ---------------------------------</span>
<span class="c1">#     throw away ALL personal settings (including custom schemes!</span>
<span class="c1">#     - unless they are "shared")</span>
<span class="c1"># As per build/ and DerivedData/, this ought to have a trailing slash</span>
<span class="c1">#</span>
<span class="c1"># NB: this is exclusive with OPTION 2 below</span>
<span class="n">xcuserdata</span><span class="o">/</span>

<span class="c1"># OPTION 2: ---------------------------------</span>
<span class="c1">#     get rid of ALL personal settings, but KEEP SOME OF THEM</span>
<span class="c1">#     - NB: you must manually uncomment the bits you want to keep</span>
<span class="c1">#</span>
<span class="c1"># NB: this *requires* git v1.8.2 or above; you may need to upgrade to latest OS X,</span>
<span class="c1">#    or manually install git over the top of the OS X version</span>
<span class="c1"># NB: this is exclusive with OPTION 1 above</span>
<span class="c1">#</span>
<span class="c1">#xcuserdata/**/*</span>

<span class="c1">#     (requires option 2 above): Personal Schemes</span>
<span class="c1">#</span>
<span class="c1">#!xcuserdata/**/xcschemes/*</span>

<span class="c1">####</span>
<span class="c1"># Xcode 4 workspaces - more detailed</span>
<span class="c1">#</span>
<span class="c1"># Workspaces are important! They are a core feature of Xcode - don't exclude them :)</span>
<span class="c1">#</span>
<span class="c1"># Workspace layout is quite spammy. For reference:</span>
<span class="c1">#</span>
<span class="c1"># /(root)/</span>
<span class="c1">#   /(project-name).xcodeproj/</span>
<span class="c1">#     project.pbxproj</span>
<span class="c1">#     /project.xcworkspace/</span>
<span class="c1">#       contents.xcworkspacedata</span>
<span class="c1">#       /xcuserdata/</span>
<span class="c1">#         /(your name)/xcuserdatad/</span>
<span class="c1">#           UserInterfaceState.xcuserstate</span>
<span class="c1">#     /xcshareddata/</span>
<span class="c1">#       /xcschemes/</span>
<span class="c1">#         (shared scheme name).xcscheme</span>
<span class="c1">#     /xcuserdata/</span>
<span class="c1">#       /(your name)/xcuserdatad/</span>
<span class="c1">#         (private scheme).xcscheme</span>
<span class="c1">#         xcschememanagement.plist</span>
<span class="c1">#</span>
<span class="c1">#</span>

<span class="c1">####</span>
<span class="c1"># Xcode 4 - Deprecated classes</span>
<span class="c1">#</span>
<span class="c1"># Allegedly, if you manually "deprecate" your classes, they get moved here.</span>
<span class="c1">#</span>
<span class="c1"># We're using source-control, so this is a "feature" that we do not want!</span>

<span class="o">*.</span><span class="n">moved</span><span class="o">-</span><span class="n">aside</span>

<span class="c1">####</span>
<span class="c1"># OPTIONAL: Some well-known tools that people use side-by-side with Xcode / iOS development</span>
<span class="c1">#</span>
<span class="c1"># NB: I'd rather not include these here, but gitignore's design is weak and doesn't allow</span>
<span class="c1">#     modular gitignore: you have to put EVERYTHING in one file.</span>
<span class="c1">#</span>
<span class="c1"># COCOAPODS:</span>
<span class="c1">#</span>
<span class="c1"># c.f. http://guides.cocoapods.org/using/using-cocoapods.html#what-is-a-podfilelock</span>
<span class="c1"># c.f. http://guides.cocoapods.org/using/using-cocoapods.html#should-i-ignore-the-pods-directory-in-source-control</span>
<span class="c1">#</span>
<span class="c1">#!Podfile.lock</span>
<span class="c1">#</span>
<span class="c1"># RUBY:</span>
<span class="c1">#</span>
<span class="c1"># c.f. http://yehudakatz.com/2010/12/16/clarifying-the-roles-of-the-gemspec-and-gemfile/</span>
<span class="c1">#</span>
<span class="c1">#!Gemfile.lock</span>
<span class="c1">#</span>
<span class="c1"># IDEA:</span>
<span class="c1">#</span>
<span class="c1"># c.f. https://www.jetbrains.com/objc/help/managing-projects-under-version-control.html?search=workspace.xml</span>
<span class="c1"># </span>
<span class="c1">#.idea/workspace.xml</span>
<span class="c1">#</span>
<span class="c1"># TEXTMATE:</span>
<span class="c1">#</span>
<span class="c1"># -- UNVERIFIED: c.f. http://stackoverflow.com/a/50283/153422</span>
<span class="c1">#</span>
<span class="c1">#tm_build_errors</span>

<span class="c1">####</span>
<span class="c1"># UNKNOWN: recommended by others, but I can't discover what these files are</span>
<span class="c1">#</span>
</pre></div>

<p><br></p>
<h3>更多建议</h3>
<p>基于本 Mercurial 指南，我的 .gitignore 包括：</p>
<div class="code"><pre class="code literal-block"><span class="na">.DS_Store</span>
<span class="err">*</span><span class="na">.swp</span>
<span class="err">*~</span><span class="na">.nib</span>

<span class="nf">build</span><span class="err">/</span>

<span class="err">*</span><span class="na">.pbxuser</span>
<span class="err">*</span><span class="na">.perspective</span>
<span class="err">*</span><span class="na">.perspectivev3</span>
</pre></div>

<p>我还选择包括：</p>
<div class="code"><pre class="code literal-block">*.mode1v3
*.mode2v3
</pre></div>

<p>根据这个 Apple 邮件列表帖子，这是“特定于用户的项目设置”。</p>
<p>对于 Xcode 4：</p>
<div class="code"><pre class="code literal-block">xcuserdata
</pre></div>

<p><br><br><a href="posts/git-ignore-file-for-xcode-projects/">查看原文</a></p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/c-zhong-struct-he-typedef-struct-de-qu-bie/" class="u-url">C++ 中“struct”和“typedef struct”的区别？</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/c-zhong-struct-he-typedef-struct-de-qu-bie/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T08:58:17+08:00" itemprop="datePublished" title="2023-02-17 08:58">2023-02-17 08:58</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>在 <strong>C++</strong> 中，有什么区别：</p>
<div class="code"><pre class="code literal-block">struct Foo { ... };
</pre></div>

<p>和：</p>
<div class="code"><pre class="code literal-block">typedef struct { ... } Foo;
</pre></div>

<p><br><br></p>
<h2>解答</h2>
<p>在 C++ 中，只有细微的差别。它是 C 的遗留物，在其中有所作为。</p>
<p>C 语言标准（C89 §3.1.2.3、C99 §6.2.3和C11 §6.2.3）要求为不同类别的标识符使用单独的命名空间，包括 <em>标记标识符</em>
（用于<code>struct</code>/ <code>union</code>/ <code>enum</code>）和 <em>普通标识符</em> （用于<code>typedef</code>和其他标识符） .</p>
<p>如果你只是说：</p>
<div class="code"><pre class="code literal-block">struct Foo { ... };
Foo x;
</pre></div>

<p>你会得到一个编译器错误，因为<code>Foo</code>它只在标签命名空间中定义。</p>
<p>您必须将其声明为：</p>
<div class="code"><pre class="code literal-block">struct Foo x;
</pre></div>

<p>任何时候你想引用 a <code>Foo</code>，你总是必须称它为 a <code>struct Foo</code>。这很快就会变得烦人，所以你可以添加一个<code>typedef</code>：</p>
<div class="code"><pre class="code literal-block">struct Foo { ... };
typedef struct Foo Foo;
</pre></div>

<p>Now <code>struct Foo</code>（在标记命名空间中）和 just plain
<code>Foo</code>（在普通标识符命名空间中）指的是同一个东西，你可以自由地声明<code>Foo</code>不带<code>struct</code>关键字的类型对象。</p>
<hr>
<p>构造：</p>
<div class="code"><pre class="code literal-block">typedef struct Foo { ... } Foo;
</pre></div>

<p>只是声明和的缩写<code>typedef</code>。</p>
<hr>
<p>最后，</p>
<div class="code"><pre class="code literal-block">typedef struct { ... } Foo;
</pre></div>

<p>声明一个匿名结构并<code>typedef</code>为其创建一个。因此，使用此构造，它在标记命名空间中没有名称，只有 typedef
命名空间中的名称。这意味着它也不能提前声明。 <em>如果要进行前向声明，则必须在标记名称空间中为其命名</em> 。</p>
<hr>
<p>在 C++ 中，所有<code>struct</code>// <code>union</code>/声明的行为就像它们被隐式'ed
一样，只要该名称没有被另一个具有相同名称的声明隐藏<code>enum</code>。有关完整详细信息，请参阅Michael Burr 的回答。<code>class``typedef</code></p>
<p><br></p>
<h3>更多建议</h3>
<p>在这篇 DDJ 文章中，Dan Saks 解释了一个小区域，如果您不对结构（和类！）进行类型定义，错误可能会在该区域蔓延：</p>
<blockquote>
<p>如果你愿意，你可以想象 C++ 为每个标签名称生成一个 typedef，例如</p>
<div class="code"><pre class="code literal-block">typedef class string string;
</pre></div>

<p>不幸的是，这并不完全准确。我希望事情就这么简单，但事实并非如此。C++ 无法在不引入与 C 不兼容的情况下为结构、联合或枚举生成此类类型定义。</p>
<p>例如，假设一个 C 程序同时声明了一个函数和一个名为 status 的结构：</p>
<div class="code"><pre class="code literal-block">int status(); struct status;
</pre></div>

<p>同样，这可能是不好的做法，但它是 C。在这个程序中，状态（本身）指的是函数；struct status 指的是类型。</p>
<p>如果 C++ 确实自动为标签生成 typedef，那么当您将此程序编译为 C++ 时，编译器将生成：</p>
<div class="code"><pre class="code literal-block">typedef struct status status;
</pre></div>

<p>不幸的是，这个类型名称会与函数名称冲突，程序将无法编译。这就是为什么 C++ 不能简单地为每个标记生成一个 typedef。</p>
<p>在 C++ 中，标签就像 typedef
名称一样，只是程序可以声明一个对象、函数或枚举器，其名称和作用域与标签相同。在这种情况下，对象、函数或枚举器名称会隐藏标记名称。程序只能通过在标签名称前面使用关键字
class、struct、union 或
enum（视情况而定）来引用标签名称。由这些关键字之一后跟一个标记组成的类型名称是详细类型说明符。例如，struct status 和 enum
month 是详细的类型说明符。</p>
<p>因此，一个包含以下两者的 C 程序：</p>
<div class="code"><pre class="code literal-block">int status(); struct status;
</pre></div>

<p>编译为 C++ 时表现相同。仅名称 status 指的是功能。程序只能通过使用 elaborated-type-specifier struct
status 来引用类型。</p>
<p>那么这如何让错误潜入程序呢？考虑清单 1中的程序。这个程序定义了一个 foo 类，它有一个默认构造函数，以及一个将 foo 对象转换为 char
const * 的转换运算符。表达方式</p>
<div class="code"><pre class="code literal-block">p = foo();
</pre></div>

<p>in main 应该构造一个 foo 对象并应用转换运算符。后续输出语句</p>
<div class="code"><pre class="code literal-block">cout &lt;&lt; p &lt;&lt; '\n';
</pre></div>

<p>应该显示类 foo，但它没有。它显示函数 foo。</p>
<p>出现这个令人惊讶的结果是因为该程序包含清单 2中所示的标头 lib.h。此标头定义了一个也名为 foo 的函数。函数名 foo 隐藏了类名 foo，所以
main 中对 foo 的引用指的是函数，而不是类。main 只能通过使用详细类型说明符来引用该类，如</p>
<div class="code"><pre class="code literal-block">p = class foo();
</pre></div>

<p>在整个程序中避免这种混淆的方法是为类名 foo 添加以下 typedef：</p>
<div class="code"><pre class="code literal-block">typedef class foo foo;
</pre></div>

<p>紧接在类定义之前或之后。此 typedef 会导致类型名称 foo 和函数名称 foo（来自库）之间发生冲突，从而触发编译时错误。</p>
<p>我知道没有人会理所当然地编写这些
typedef。这需要很多纪律。由于诸如清单1中的错误的发生率可能非常小，因此您绝不会遇到这个问题。但是，如果您的软件中的一个错误可能会导致人身伤害，那么无论错误发生的可能性有多大，您都应该编写
typedef。</p>
<p>我无法想象为什么有人会想要在与类相同的范围内隐藏带有函数或对象名称的类名。C 中的隐藏规则是一个错误，它们不应该扩展到 C++
中的类。事实上，您可以纠正错误，但这需要额外的编程纪律和不必要的努力。</p>
</blockquote>
<p><br><br><a href="posts/difference-between-struct-and-typedef-struct-in-c/">查看原文</a></p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-517.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-515.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
