<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 1798) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-1798.html">
<link rel="prev" href="index-1799.html" type="text/html">
<link rel="next" href="index-1797.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-do-i-get-a-value-of-datetime-today-in-python-that-is-timezone-aware/" class="u-url">How do I get a value of datetime.today() in Python that is "timezone aware"?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-do-i-get-a-value-of-datetime-today-in-python-that-is-timezone-aware/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T09:36:37+08:00" itemprop="datePublished" title="2023-03-03 09:36">2023-03-03 09:36</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I am trying to subtract one date value from the value of
<code>datetime.datetime.today()</code> to calculate how long ago something was. But it
complains:</p>
<div class="code"><pre class="code literal-block"><span class="n">TypeError</span><span class="o">:</span><span class="w"> </span><span class="n">can</span><span class="err">'</span><span class="n">t</span><span class="w"> </span><span class="n">subtract</span><span class="w"> </span><span class="n">offset</span><span class="o">-</span><span class="n">naive</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">offset</span><span class="o">-</span><span class="n">aware</span><span class="w"> </span><span class="n">datetimes</span>
</pre></div>

<p>The return value from <code>datetime.datetime.today()</code> doesn't seem to be "timezone
aware", while my other date value is. How do I get a return value from
<code>datetime.datetime.today()</code> that is timezone aware?</p>
<p>The ideal solution would be for it to automatically know the timezone.</p>
<p>Right now, it's giving me the time in local time, which happens to be PST,
i.e. UTC - 8 hours. Worst case, is there a way I can manually enter a timezone
value into the <code>datetime</code> object returned by <code>datetime.datetime.today()</code> and
set it to UTC-8?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>In the standard library, there is no cross-platform way to create aware
timezones without creating your own timezone class. ( <strong>Edit:</strong> Python 3.9
introduces <code>zoneinfo</code> in the standard library which does provide this
functionality.)</p>
<p>On Windows, there's <code>win32timezone.utcnow()</code>, but that's part of pywin32. I
would rather suggest to use the pytz library, which has a constantly updated
database of most timezones.</p>
<p>Working with local timezones can be very tricky (see "Further reading" links
below), so you may rather want to use UTC throughout your application,
especially for arithmetic operations like calculating the difference between
two time points.</p>
<p>You can get the current date/time like so:</p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="nn">pytz</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">tzinfo</span><span class="o">=</span><span class="n">pytz</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
</pre></div>

<p>Mind that <code>datetime.today()</code> and <code>datetime.now()</code> return the <em>local</em> time, not
the UTC time, so applying <code>.replace(tzinfo=pytz.utc)</code> to them would not be
correct.</p>
<p>Another nice way to do it is:</p>
<div class="code"><pre class="code literal-block">datetime.now(pytz.utc)
</pre></div>

<p>which is a bit shorter and does the same.</p>
<hr>
<p>Further reading/watching why to prefer UTC in many cases:</p>
<ul>
<li>pytz documentation</li>
<li>What Every Developer Should Know About Time – development hints for many real-life use cases</li>
<li>The Problem with Time &amp; Timezones - Computerphile – funny, eye-opening explanation about the complexity of working with timezones (video)</li>
</ul>
<p><br></p>
<h3>Suggest</h3>
<p>Get the current time, in a specific timezone:</p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">pytz</span>
<span class="n">my_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">pytz</span><span class="o">.</span><span class="n">timezone</span><span class="p">(</span><span class="s1">'US/Pacific'</span><span class="p">))</span>
</pre></div>

<p>Remember to install <code>pytz</code> first.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/what-is-the-use-of-go-in-sql-server-management-studio-transact-sql/" class="u-url">What is the use of GO in SQL Server Management Studio &amp; Transact SQL?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/what-is-the-use-of-go-in-sql-server-management-studio-transact-sql/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T09:36:12+08:00" itemprop="datePublished" title="2023-03-03 09:36">2023-03-03 09:36</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>SQL Server Management Studio always inserts a GO command when I create a query
using the right click "Script As" menu. Why? What does GO actually do?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>It is a batch terminator, you can however change it to whatever you want <img alt="alt
text" src="https://imgur.com/TpChF.png"></p>
<p><br></p>
<h3>Suggest</h3>
<p>Since Management Studio 2005 it seems that you can use <code>GO</code> with an <code>int</code>
parameter, like:</p>
<div class="code"><pre class="code literal-block"><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">mytable</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">VALUES</span>
<span class="k">GO</span><span class="w"> </span><span class="mi">10</span>
</pre></div>

<p>The above will insert 10 rows into <code>mytable</code>. Generally speaking, <strong><code>GO</code> will
execute the related sql commands <code>n</code> times</strong>.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-add-leading-zeros/" class="u-url">How to add leading zeros?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-add-leading-zeros/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T09:35:47+08:00" itemprop="datePublished" title="2023-03-03 09:35">2023-03-03 09:35</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I have a set of data which looks something like this:</p>
<div class="code"><pre class="code literal-block"><span class="n">anim</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">25499</span><span class="p">,</span><span class="m">25500</span><span class="p">,</span><span class="m">25501</span><span class="p">,</span><span class="m">25502</span><span class="p">,</span><span class="m">25503</span><span class="p">,</span><span class="m">25504</span><span class="p">)</span>
<span class="n">sex</span><span class="w">  </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">)</span>
<span class="n">wt</span><span class="w">   </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0.8</span><span class="p">,</span><span class="m">1.2</span><span class="p">,</span><span class="m">1.0</span><span class="p">,</span><span class="m">2.0</span><span class="p">,</span><span class="m">1.8</span><span class="p">,</span><span class="m">1.4</span><span class="p">)</span>
<span class="n">data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="n">anim</span><span class="p">,</span><span class="n">sex</span><span class="p">,</span><span class="n">wt</span><span class="p">)</span>

<span class="n">data</span>
<span class="w">   </span><span class="n">anim</span><span class="w"> </span><span class="n">sex</span><span class="w">  </span><span class="n">wt</span><span class="w"> </span><span class="n">anim2</span>
<span class="m">1</span><span class="w"> </span><span class="m">25499</span><span class="w">   </span><span class="m">1</span><span class="w"> </span><span class="m">0.8</span><span class="w">     </span><span class="m">2</span>
<span class="m">2</span><span class="w"> </span><span class="m">25500</span><span class="w">   </span><span class="m">2</span><span class="w"> </span><span class="m">1.2</span><span class="w">     </span><span class="m">2</span>
<span class="m">3</span><span class="w"> </span><span class="m">25501</span><span class="w">   </span><span class="m">2</span><span class="w"> </span><span class="m">1.0</span><span class="w">     </span><span class="m">2</span>
<span class="m">4</span><span class="w"> </span><span class="m">25502</span><span class="w">   </span><span class="m">1</span><span class="w"> </span><span class="m">2.0</span><span class="w">     </span><span class="m">2</span>
<span class="m">5</span><span class="w"> </span><span class="m">25503</span><span class="w">   </span><span class="m">2</span><span class="w"> </span><span class="m">1.8</span><span class="w">     </span><span class="m">2</span>
<span class="m">6</span><span class="w"> </span><span class="m">25504</span><span class="w">   </span><span class="m">1</span><span class="w"> </span><span class="m">1.4</span><span class="w">     </span><span class="m">2</span>
</pre></div>

<p>I would like a zero to be added before each animal id:</p>
<div class="code"><pre class="code literal-block">data
   anim sex  wt anim2
1 025499   1 0.8     2
2 025500   2 1.2     2
3 025501   2 1.0     2
4 025502   1 2.0     2
5 025503   2 1.8     2
6 025504   1 1.4     2
</pre></div>

<p>And for interest sake, what if I need to add two or three zeros before the
animal id's?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>The short version: use <code>formatC</code> or <code>sprintf</code>.</p>
<hr>
<p>The longer version:</p>
<p>There are several functions available for formatting numbers, including adding
leading zeroes. Which one is best depends upon what other formatting you want
to do.</p>
<p>The example from the question is quite easy since all the values have the same
number of digits to begin with, so let's try a harder example of making powers
of 10 width 8 too.</p>
<div class="code"><pre class="code literal-block"><span class="n">anim</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">25499</span><span class="o">:</span><span class="m">25504</span>
<span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="m">0</span><span class="o">:</span><span class="m">5</span><span class="p">)</span>
</pre></div>

<hr>
<p><strong><code>paste</code></strong> (and it's variant <code>paste0</code>) are often the first string
manipulation functions that you come across. They aren't really designed for
manipulating numbers, but they can be used for that. In the simple case where
we always have to prepend a single zero, <code>paste0</code> is the best solution.</p>
<div class="code"><pre class="code literal-block">paste0("0", anim)
## [1] "025499" "025500" "025501" "025502" "025503" "025504"
</pre></div>

<p>For the case where there are a variable number of digits in the numbers, you
have to manually calculate how many zeroes to prepend, which is horrible
enough that you should only do it out of morbid curiosity.</p>
<hr>
<p><strong><code>str_pad</code></strong> from <code>stringr</code> works similarly to <code>paste</code>, making it more
explicit that you want to pad things.</p>
<div class="code"><pre class="code literal-block">library(stringr)
str_pad(anim, 6, pad = "0")
## [1] "025499" "025500" "025501" "025502" "025503" "025504"
</pre></div>

<p>Again, it isn't really designed for use with numbers, so the harder case
requires a little thinking about. We ought to just be able to say "pad with
zeroes to width 8", but look at this output:</p>
<div class="code"><pre class="code literal-block">str_pad(x, 8, pad = "0")
## [1] "00000001" "00000010" "00000100" "00001000" "00010000" "0001e+05"
</pre></div>

<p>You need to set the scientific penalty option so that numbers are always
formatted using fixed notation (rather than scientific notation).</p>
<div class="code"><pre class="code literal-block">library(withr)
with_options(
  c(scipen = 999), 
  str_pad(x, 8, pad = "0")
)
## [1] "00000001" "00000010" "00000100" "00001000" "00010000" "00100000"
</pre></div>

<hr>
<p><strong><code>stri_pad</code></strong> in <code>stringi</code> works exactly like <code>str_pad</code> from <code>stringr</code>.</p>
<hr>
<p><strong><code>formatC</code></strong> is an interface to the C function <code>printf</code>. Using it requires
some knowledge of the arcana of that underlying function (see link). In this
case, the important points are the <code>width</code> argument, <code>format</code> being <code>"d"</code> for
"integer", and a <code>"0"</code> <code>flag</code> for prepending zeroes.</p>
<div class="code"><pre class="code literal-block">formatC(anim, width = 6, format = "d", flag = "0")
## [1] "025499" "025500" "025501" "025502" "025503" "025504"
formatC(x, width = 8, format = "d", flag = "0")
## [1] "00000001" "00000010" "00000100" "00001000" "00010000" "00100000"
</pre></div>

<p>This is my favourite solution, since it is easy to tinker with changing the
width, and the function is powerful enough to make other formatting changes.</p>
<hr>
<p><strong><code>sprintf</code></strong> is an interface to the C function of the same name; like
<code>formatC</code> but with a different syntax.</p>
<div class="code"><pre class="code literal-block"><span class="k">sprintf</span><span class="ss">(</span><span class="s2">"%06d"</span>,<span class="w"> </span><span class="nv">anim</span><span class="ss">)</span>
##<span class="w"> </span>[<span class="mi">1</span>]<span class="w"> </span><span class="s2">"025499"</span><span class="w"> </span><span class="s2">"025500"</span><span class="w"> </span><span class="s2">"025501"</span><span class="w"> </span><span class="s2">"025502"</span><span class="w"> </span><span class="s2">"025503"</span><span class="w"> </span><span class="s2">"025504"</span>
<span class="k">sprintf</span><span class="ss">(</span><span class="s2">"%08d"</span>,<span class="w"> </span><span class="nv">x</span><span class="ss">)</span>
##<span class="w"> </span>[<span class="mi">1</span>]<span class="w"> </span><span class="s2">"00000001"</span><span class="w"> </span><span class="s2">"00000010"</span><span class="w"> </span><span class="s2">"00000100"</span><span class="w"> </span><span class="s2">"00001000"</span><span class="w"> </span><span class="s2">"00010000"</span><span class="w"> </span><span class="s2">"00100000"</span>
</pre></div>

<p>The main advantage of <code>sprintf</code> is that you can embed formatted numbers inside
longer bits of text.</p>
<div class="code"><pre class="code literal-block"><span class="k">sprintf</span><span class="ss">(</span>
<span class="w">  </span><span class="s2">"Animal ID %06d was a %s."</span>,<span class="w"> </span>
<span class="w">  </span><span class="nv">anim</span>,<span class="w"> </span>
<span class="w">  </span><span class="nv">sample</span><span class="ss">(</span><span class="nv">c</span><span class="ss">(</span><span class="s2">"lion"</span>,<span class="w"> </span><span class="s2">"tiger"</span><span class="ss">)</span>,<span class="w"> </span><span class="nv">length</span><span class="ss">(</span><span class="nv">anim</span><span class="ss">)</span>,<span class="w"> </span><span class="nv">replace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">TRUE</span><span class="ss">)</span>
<span class="ss">)</span>
##<span class="w"> </span>[<span class="mi">1</span>]<span class="w"> </span><span class="s2">"Animal ID 025499 was a tiger."</span><span class="w"> </span><span class="s2">"Animal ID 025500 was a tiger."</span>
##<span class="w"> </span>[<span class="mi">3</span>]<span class="w"> </span><span class="s2">"Animal ID 025501 was a lion."</span><span class="w">  </span><span class="s2">"Animal ID 025502 was a tiger."</span>
##<span class="w"> </span>[<span class="mi">5</span>]<span class="w"> </span><span class="s2">"Animal ID 025503 was a tiger."</span><span class="w"> </span><span class="s2">"Animal ID 025504 was a lion."</span>
</pre></div>

<p>See also goodside's answer.</p>
<hr>
<p>For completeness it is worth mentioning the other formatting functions that
are occasionally useful, but have no method of prepending zeroes.</p>
<p><strong><code>format</code></strong> , a generic function for formatting any kind of object, with a
method for numbers. It works a little bit like <code>formatC</code>, but with yet another
interface.</p>
<p><strong><code>prettyNum</code></strong> is yet another formatting function, mostly for creating manual
axis tick labels. It works particularly well for wide ranges of numbers.</p>
<p>The <strong><code>scales</code></strong> package has several functions such as <code>percent</code>,
<code>date_format</code> and <code>dollar</code> for specialist format types.</p>
<p><br></p>
<h3>Suggest</h3>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-1799.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-1797.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
