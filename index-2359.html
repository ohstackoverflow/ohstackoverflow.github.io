<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 2359) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-2359.html">
<link rel="prev" href="index-2360.html" type="text/html">
<link rel="next" href="index-2358.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/javascript-global-event-mechanism/" class="u-url">JavaScript global event mechanism</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/javascript-global-event-mechanism/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T10:18:02+08:00" itemprop="datePublished" title="2023-03-04 10:18">2023-03-04 10:18</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I would like to catch every undefined function error thrown. Is there a global
error handling facility in JavaScript? The use case is catching function calls
from flash that are not defined.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Does this help you:</p>
<div class="code"><pre class="code literal-block"><span class="nt">&lt;script</span><span class="w"> </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
window.onerror<span class="w"> </span>=<span class="w"> </span>function()<span class="w"> </span>{
<span class="w">    </span>alert("Error<span class="w"> </span>caught");
};

xxx();
<span class="nt">&lt;/script&gt;</span>
</pre></div>

<p>I'm not sure how it handles Flash errors though...</p>
<p>Update: it doesn't work in Opera, but I'm hacking Dragonfly right now to see
what it gets. Suggestion about hacking Dragonfly came from this question:</p>
<p>Mimic Window. onerror in Opera using javascript</p>
<p><br></p>
<h3>Suggest</h3>
<p>Does this help you:</p>
<div class="code"><pre class="code literal-block"><span class="nt">&lt;script</span><span class="w"> </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
window.onerror<span class="w"> </span>=<span class="w"> </span>function()<span class="w"> </span>{
<span class="w">    </span>alert("Error<span class="w"> </span>caught");
};

xxx();
<span class="nt">&lt;/script&gt;</span>
</pre></div>

<p>I'm not sure how it handles Flash errors though...</p>
<p>Update: it doesn't work in Opera, but I'm hacking Dragonfly right now to see
what it gets. Suggestion about hacking Dragonfly came from this question:</p>
<p>Mimic Window. onerror in Opera using javascript</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-retry-after-exception/" class="u-url">How to retry after exception?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-retry-after-exception/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T10:16:26+08:00" itemprop="datePublished" title="2023-03-04 10:16">2023-03-04 10:16</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I have a loop starting with <code>for i in range(0, 100)</code>. Normally it runs
correctly, but sometimes it fails due to network conditions. Currently I have
it set so that on failure, it will <code>continue</code> in the except clause (continue
on to the next number for <code>i</code>).</p>
<p>Is it possible for me to reassign the same number to <code>i</code> and run through the
failed iteration of the loop again?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Do a <code>while True</code> inside your for loop, put your <code>try</code> code inside, and break
from that <code>while</code> loop only when your code succeeds.</p>
<div class="code"><pre class="code literal-block"><span class="k">for</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">range</span><span class="ss">(</span><span class="mi">0</span>,<span class="mi">100</span><span class="ss">)</span>:
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="nv">True</span>:
<span class="w">        </span><span class="nv">try</span>:
<span class="w">            </span>#<span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="nv">stuff</span>
<span class="w">        </span><span class="nv">except</span><span class="w"> </span><span class="nv">SomeSpecificException</span>:
<span class="w">            </span><span class="k">continue</span>
<span class="w">        </span><span class="k">break</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>I prefer to limit the number of retries, so that if there's a problem with
that specific item you will eventually continue onto the next one, thus:</p>
<div class="code"><pre class="code literal-block"><span class="k">for</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">range</span><span class="ss">(</span><span class="mi">100</span><span class="ss">)</span>:
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="nv">attempt</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">range</span><span class="ss">(</span><span class="mi">10</span><span class="ss">)</span>:
<span class="w">    </span><span class="nv">try</span>:
<span class="w">      </span>#<span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="nv">thing</span>
<span class="w">    </span><span class="nv">except</span>:
<span class="w">      </span>#<span class="w"> </span><span class="nv">perhaps</span><span class="w"> </span><span class="nv">reconnect</span>,<span class="w"> </span><span class="nv">etc</span>.
<span class="w">    </span><span class="k">else</span>:
<span class="w">      </span><span class="k">break</span>
<span class="w">  </span><span class="k">else</span>:
<span class="w">    </span>#<span class="w"> </span><span class="nv">we</span><span class="w"> </span><span class="nv">failed</span><span class="w"> </span><span class="nv">all</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">attempts</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nv">deal</span><span class="w"> </span><span class="nv">with</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">consequences</span>.
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/mongodb-is-it-possible-to-make-a-case-insensitive-query/" class="u-url">MongoDB: Is it possible to make a case-insensitive query?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/mongodb-is-it-possible-to-make-a-case-insensitive-query/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T10:14:42+08:00" itemprop="datePublished" title="2023-03-04 10:14">2023-03-04 10:14</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Example:</p>
<div class="code"><pre class="code literal-block">&gt; db.stuff.save({"foo":"bar"});

&gt; db.stuff.find({"foo":"bar"}).count();
1
&gt; db.stuff.find({"foo":"BAR"}).count();
0
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<p>You could use a regex.</p>
<p>In your example that would be:</p>
<div class="code"><pre class="code literal-block"><span class="nt">db</span><span class="p">.</span><span class="nc">stuff</span><span class="p">.</span><span class="nc">find</span><span class="o">(</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">foo</span><span class="p">:</span><span class="w"> </span><span class="o">/^</span><span class="n">bar</span><span class="err">$</span><span class="o">/</span><span class="n">i</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">);</span>
</pre></div>

<p>I must say, though, maybe you could just downcase (or upcase) the value on the
way in rather than incurring the extra cost every time you find it. Obviously
this wont work for people's names and such, but maybe use-cases like tags.</p>
<p><br></p>
<h3>Suggest</h3>
<p><strong>UPDATE:</strong></p>
<p>The original answer is now obsolete. Mongodb now supports advanced full text
searching, with many features.</p>
<p><strong>ORIGINAL ANSWER:</strong></p>
<p>It should be noted that searching with regex's case insensitive /i means that
mongodb cannot search by index, so queries against large datasets can take a
long time.</p>
<p>Even with small datasets, it's not very efficient. You take a far bigger cpu
hit than your query warrants, which could become an issue if you are trying to
achieve scale.</p>
<p>As an alternative, you can store an uppercase copy and search against that.
For instance, I have a User table that has a username which is mixed case, but
the id is an uppercase copy of the username. This ensures case-sensitive
duplication is impossible (having both "Foo" and "foo" will not be allowed),
and I can search by id = username.toUpperCase() to get a case-insensitive
search for username.</p>
<p>If your field is large, such as a message body, duplicating data is probably
not a good option. I believe using an extraneous indexer like Apache Lucene is
the best option in that case.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-2360.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-2358.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
