<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 1109) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-1109.html">
<link rel="prev" href="index-1110.html" type="text/html">
<link rel="next" href="index-1108.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/is-it-possible-to-force-excel-recognize-utf-8-csv-files-automatically/" class="u-url">Is it possible to force Excel recognize UTF-8 CSV files automatically?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/is-it-possible-to-force-excel-recognize-utf-8-csv-files-automatically/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T01:27:55+08:00" itemprop="datePublished" title="2023-02-18 01:27">2023-02-18 01:27</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I'm developing a part of an application that's responsible for exporting some
data into CSV files. The application always uses UTF-8 because of its
multilingual nature at all levels. But opening such CSV files (containing e.g.
diacritics, cyrillic letters, Greek letters) in Excel does not achieve the
expected results showing something like <code>Г„/Г¤, Г–/Г¶</code>. And I don't know how
to force Excel understand that the open CSV file is encoded in UTF-8. I also
tried specifying UTF-8 BOM <code>EF BB BF</code>, but Excel ignores that.</p>
<p>Is there any workaround?</p>
<p>P.S. Which tools may potentially behave like Excel does?</p>
<hr>
<p>UPDATE</p>
<p>I have to say that I've confused the community with the formulation of the
question. When I was asking this question, I asked for a way of opening a
UTF-8 CSV file in Excel without any problems for a user, in a fluent and
transparent way. However, I used a wrong formulation asking for doing it
<em>automatically</em>. That is very confusing and it clashes with VBA macro
automation. There are two answers for this questions that I appreciate the
most: the very first answer by Alex
https://stackoverflow.com/a/6002338/166589, and I've accepted this answer; and
the second one by Mark https://stackoverflow.com/a/6488070/166589 that have
appeared a little later. From the usability point of view, Excel seemed to
have lack of a good user-friendly UTF-8 CSV support, so I consider <em>both</em>
answers are correct, and I have accepted Alex's answer first because it really
stated that Excel was not able to do that transparently. That is what I
confused with <em>automatically</em> here. Mark's answer promotes a more complicated
way for more advanced users to achieve the expected result. Both answers are
great, but Alex's one fits my not clearly specified question a little better.</p>
<hr>
<p>UPDATE 2</p>
<p>Five months later after the last edit, I've noticed that Alex's answer has
disappeared for some reason. I really hope it wasn't a technical issue and I
hope there is no more discussion on which answer is greater now. So I'm
accepting Mark's answer as the best one.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Alex is correct, but as you have to export to csv, you can give the users this
advice when opening the csv files:</p>
<ol>
<li>Save the exported file as a csv</li>
<li>Open Excel</li>
<li>Import the data using Data--&gt;Import External Data --&gt; Import Data</li>
<li>Select the file type of "csv" and browse to your file </li>
<li>In the import wizard change the File_Origin to "65001 UTF" (or choose correct language character identifier) </li>
<li>Change the Delimiter to comma</li>
<li>Select where to import to and Finish</li>
</ol>
<p>This way the special characters should show correctly.</p>
<p><br></p>
<h3>Suggest</h3>
<p>The UTF-8 Byte-order mark will clue Excel 2007+ in to the fact that you're
using UTF-8. (See this SO post).</p>
<p>In case anybody is having the same issues I was, .NET's UTF8 encoding class
does not output a byte-order marker in a <code>GetBytes()</code> call. You need to use
streams (or use a workaround) to get the BOM to output.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-do-i-list-the-symbols-in-a-so-file/" class="u-url">How do I list the symbols in a .so file</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-do-i-list-the-symbols-in-a-so-file/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T01:27:32+08:00" itemprop="datePublished" title="2023-02-18 01:27">2023-02-18 01:27</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>How do I list the symbols being exported from a .so file? If possible, I'd
also like to know their source (e.g. if they are pulled in from a static
library).</p>
<p>I'm using gcc 4.0.2, if that makes a difference.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>The standard tool for listing symbols is <code>nm</code>, you can use it simply like
this:</p>
<div class="code"><pre class="code literal-block">nm -gD yourLib.so
</pre></div>

<p>If you want to see symbols of a C++ library, add the "-C" option which
demangle the symbols (it's far more readable demangled).</p>
<div class="code"><pre class="code literal-block">nm -gDC yourLib.so
</pre></div>

<p>If your .so file is in elf format, you have two options:</p>
<p>Either <code>objdump</code> (<code>-C</code> is also useful for demangling C++):</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span>objdump<span class="w"> </span>-TC<span class="w"> </span>libz.so

libz.so:<span class="w">     </span>file<span class="w"> </span>format<span class="w"> </span>elf64-x86-64

DYNAMIC<span class="w"> </span>SYMBOL<span class="w"> </span>TABLE:
<span class="m">0000000000002010</span><span class="w"> </span>l<span class="w">    </span>d<span class="w">  </span>.init<span class="w">  </span><span class="m">0000000000000000</span><span class="w">              </span>.init
<span class="m">0000000000000000</span><span class="w">      </span>DF<span class="w"> </span>*UND*<span class="w">  </span><span class="m">0000000000000000</span><span class="w">  </span>GLIBC_2.2.5<span class="w"> </span>free
<span class="m">0000000000000000</span><span class="w">      </span>DF<span class="w"> </span>*UND*<span class="w">  </span><span class="m">0000000000000000</span><span class="w">  </span>GLIBC_2.2.5<span class="w"> </span>__errno_location
<span class="m">0000000000000000</span><span class="w">  </span>w<span class="w">   </span>D<span class="w">  </span>*UND*<span class="w">  </span><span class="m">0000000000000000</span><span class="w">              </span>_ITM_deregisterTMCloneTable
</pre></div>

<p>Or use <code>readelf</code>:</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span>readelf<span class="w"> </span>-Ws<span class="w"> </span>libz.so
Symbol<span class="w"> </span>table<span class="w"> </span><span class="s1">'.dynsym'</span><span class="w"> </span>contains<span class="w"> </span><span class="m">112</span><span class="w"> </span>entries:
<span class="w">   </span>Num:<span class="w">    </span>Value<span class="w">          </span>Size<span class="w"> </span>Type<span class="w">    </span>Bind<span class="w">   </span>Vis<span class="w">      </span>Ndx<span class="w"> </span>Name
<span class="w">     </span><span class="m">0</span>:<span class="w"> </span><span class="m">0000000000000000</span><span class="w">     </span><span class="m">0</span><span class="w"> </span>NOTYPE<span class="w">  </span>LOCAL<span class="w">  </span>DEFAULT<span class="w">  </span>UND
<span class="w">     </span><span class="m">1</span>:<span class="w"> </span><span class="m">0000000000002010</span><span class="w">     </span><span class="m">0</span><span class="w"> </span>SECTION<span class="w"> </span>LOCAL<span class="w">  </span>DEFAULT<span class="w">   </span><span class="m">10</span>
<span class="w">     </span><span class="m">2</span>:<span class="w"> </span><span class="m">0000000000000000</span><span class="w">     </span><span class="m">0</span><span class="w"> </span>FUNC<span class="w">    </span>GLOBAL<span class="w"> </span>DEFAULT<span class="w">  </span>UND<span class="w"> </span>free@GLIBC_2.2.5<span class="w"> </span><span class="o">(</span><span class="m">14</span><span class="o">)</span>
<span class="w">     </span><span class="m">3</span>:<span class="w"> </span><span class="m">0000000000000000</span><span class="w">     </span><span class="m">0</span><span class="w"> </span>FUNC<span class="w">    </span>GLOBAL<span class="w"> </span>DEFAULT<span class="w">  </span>UND<span class="w"> </span>__errno_location@GLIBC_2.2.5<span class="w"> </span><span class="o">(</span><span class="m">14</span><span class="o">)</span>
<span class="w">     </span><span class="m">4</span>:<span class="w"> </span><span class="m">0000000000000000</span><span class="w">     </span><span class="m">0</span><span class="w"> </span>NOTYPE<span class="w">  </span>WEAK<span class="w">   </span>DEFAULT<span class="w">  </span>UND<span class="w"> </span>_ITM_deregisterTMCloneTable
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>If your <code>.so</code> file is in elf format, you can use readelf program to extract
symbol information from the binary. This command will give you the symbol
table:</p>
<div class="code"><pre class="code literal-block">readelf -Ws /usr/lib/libexample.so
</pre></div>

<p>You only should extract those that are defined in this <code>.so</code> file, not in the
libraries referenced by it. Seventh column should contain a number in this
case. You can extract it by using a simple regex:</p>
<div class="code"><pre class="code literal-block">readelf -Ws /usr/lib/libstdc++.so.6 | grep '^\([[:space:]]\+[^[:space:]]\+\)\{6\}[[:space:]]\+[[:digit:]]\+'
</pre></div>

<p>or, as proposed by Caspin,:</p>
<div class="code"><pre class="code literal-block">readelf -Ws /usr/lib/libstdc++.so.6 | awk '{print $8}';
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/htmlentities-vs-htmlspecialchars/" class="u-url">htmlentities() vs. htmlspecialchars()</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/htmlentities-vs-htmlspecialchars/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T01:27:07+08:00" itemprop="datePublished" title="2023-02-18 01:27">2023-02-18 01:27</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>What are the differences between <code>htmlspecialchars()</code> and <code>htmlentities()</code>.
When should I use one or the other?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>From the PHP documentation for htmlentities:</p>
<blockquote>
<p>This function is identical to <code>htmlspecialchars()</code> in all ways, except with
<code>htmlentities()</code>, all characters which have HTML character entity
equivalents are translated into these entities.</p>
</blockquote>
<p>From the PHP documentation for htmlspecialchars:</p>
<blockquote>
<p>Certain characters have special significance in HTML, and should be
represented by HTML entities if they are to preserve their meanings. This
function returns a string with some of these conversions made; the
translations made are those most useful for everyday web programming. If you
require all HTML character entities to be translated, use <code>htmlentities()</code>
instead.</p>
</blockquote>
<p>The difference is what gets encoded. The choices are everything (entities) or
"special" characters, like ampersand, double and single quotes, less than, and
greater than (specialchars).</p>
<p>I prefer to use <code>htmlspecialchars</code> whenever possible.</p>
<p>For example:</p>
<div class="code"><pre class="code literal-block"><span class="w">    </span><span class="nt">echo</span><span class="w"> </span><span class="nt">htmlentities</span><span class="o">(</span><span class="s1">'&lt;Il était une fois un être&gt;.'</span><span class="o">);</span>
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="nt">Output</span><span class="o">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nt">lt</span><span class="o">;</span><span class="nt">Il</span><span class="w"> </span><span class="o">&amp;</span><span class="nt">eacute</span><span class="o">;</span><span class="nt">tait</span><span class="w"> </span><span class="nt">une</span><span class="w"> </span><span class="nt">fois</span><span class="w"> </span><span class="nt">un</span><span class="w"> </span><span class="o">&amp;</span><span class="nt">ecirc</span><span class="o">;</span><span class="nt">tre</span><span class="o">&amp;</span><span class="nt">gt</span><span class="o">;.</span>
<span class="w">    </span><span class="o">//</span><span class="w">                </span><span class="o">^^^^^^^^</span><span class="w">                 </span><span class="o">^^^^^^^</span>

<span class="w">    </span><span class="nt">echo</span><span class="w"> </span><span class="nt">htmlspecialchars</span><span class="o">(</span><span class="s1">'&lt;Il était une fois un être&gt;.'</span><span class="o">);</span>
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="nt">Output</span><span class="o">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nt">lt</span><span class="o">;</span><span class="nt">Il</span><span class="w"> </span><span class="nt">était</span><span class="w"> </span><span class="nt">une</span><span class="w"> </span><span class="nt">fois</span><span class="w"> </span><span class="nt">un</span><span class="w"> </span><span class="nt">être</span><span class="o">&amp;</span><span class="nt">gt</span><span class="o">;.</span>
<span class="w">    </span><span class="o">//</span><span class="w">                </span><span class="o">^</span><span class="w">                 </span><span class="o">^</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>From the PHP documentation for htmlentities:</p>
<blockquote>
<p>This function is identical to <code>htmlspecialchars()</code> in all ways, except with
<code>htmlentities()</code>, all characters which have HTML character entity
equivalents are translated into these entities.</p>
</blockquote>
<p>From the PHP documentation for htmlspecialchars:</p>
<blockquote>
<p>Certain characters have special significance in HTML, and should be
represented by HTML entities if they are to preserve their meanings. This
function returns a string with some of these conversions made; the
translations made are those most useful for everyday web programming. If you
require all HTML character entities to be translated, use <code>htmlentities()</code>
instead.</p>
</blockquote>
<p>The difference is what gets encoded. The choices are everything (entities) or
"special" characters, like ampersand, double and single quotes, less than, and
greater than (specialchars).</p>
<p>I prefer to use <code>htmlspecialchars</code> whenever possible.</p>
<p>For example:</p>
<div class="code"><pre class="code literal-block"><span class="w">    </span><span class="nt">echo</span><span class="w"> </span><span class="nt">htmlentities</span><span class="o">(</span><span class="s1">'&lt;Il était une fois un être&gt;.'</span><span class="o">);</span>
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="nt">Output</span><span class="o">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nt">lt</span><span class="o">;</span><span class="nt">Il</span><span class="w"> </span><span class="o">&amp;</span><span class="nt">eacute</span><span class="o">;</span><span class="nt">tait</span><span class="w"> </span><span class="nt">une</span><span class="w"> </span><span class="nt">fois</span><span class="w"> </span><span class="nt">un</span><span class="w"> </span><span class="o">&amp;</span><span class="nt">ecirc</span><span class="o">;</span><span class="nt">tre</span><span class="o">&amp;</span><span class="nt">gt</span><span class="o">;.</span>
<span class="w">    </span><span class="o">//</span><span class="w">                </span><span class="o">^^^^^^^^</span><span class="w">                 </span><span class="o">^^^^^^^</span>

<span class="w">    </span><span class="nt">echo</span><span class="w"> </span><span class="nt">htmlspecialchars</span><span class="o">(</span><span class="s1">'&lt;Il était une fois un être&gt;.'</span><span class="o">);</span>
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="nt">Output</span><span class="o">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nt">lt</span><span class="o">;</span><span class="nt">Il</span><span class="w"> </span><span class="nt">était</span><span class="w"> </span><span class="nt">une</span><span class="w"> </span><span class="nt">fois</span><span class="w"> </span><span class="nt">un</span><span class="w"> </span><span class="nt">être</span><span class="o">&amp;</span><span class="nt">gt</span><span class="o">;.</span>
<span class="w">    </span><span class="o">//</span><span class="w">                </span><span class="o">^</span><span class="w">                 </span><span class="o">^</span>
</pre></div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-1110.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-1108.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
