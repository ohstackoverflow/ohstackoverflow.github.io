<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 1168) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-1168.html">
<link rel="prev" href="index-1169.html" type="text/html">
<link rel="next" href="index-1167.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/defining-and-using-a-variable-in-batch-file/" class="u-url">Defining and using a variable in batch file</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/defining-and-using-a-variable-in-batch-file/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T02:52:24+08:00" itemprop="datePublished" title="2023-02-18 02:52">2023-02-18 02:52</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I'm trying to define and use a variable in a batch file. It looks like it
should be simple:</p>
<div class="code"><pre class="code literal-block"><span class="nv">@echo</span><span class="w"> </span><span class="k">off</span>

<span class="k">set</span><span class="w"> </span><span class="n">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">"bob"</span>
<span class="n">echo</span><span class="w"> </span><span class="n">We</span><span class="err">'</span><span class="n">re</span><span class="w"> </span><span class="n">working</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="ss">"%location%"</span>
</pre></div>

<p>The output I get is the following:</p>
<div class="code"><pre class="code literal-block">We're working with ""
</pre></div>

<p>What's going on here? Why is my variable not being echo'd?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>The space before the <code>=</code> is interpreted as part of the name, and the space
after it (as well as the quotation marks) are interpreted as part of the
value. So the variable you’ve created can be referenced with <code>%location %</code>. If
that’s not what you want, remove the extra space(s) in the definition.</p>
<p><br></p>
<h3>Suggest</h3>
<p>The spaces are significant. You created a variable named <code>'location '</code> with a
value of<br><code>' "bob"'</code>. <em>Note - enclosing single quotes were added to show location of
space.</em></p>
<p>If you want quotes in your value, then your code should look like</p>
<div class="code"><pre class="code literal-block">set location="bob"
</pre></div>

<p>If you don't want quotes, then your code should look like</p>
<div class="code"><pre class="code literal-block">set location=bob
</pre></div>

<p>Or better yet</p>
<div class="code"><pre class="code literal-block">set "location=bob"
</pre></div>

<p>The last syntax prevents inadvertent trailing spaces from getting in the
value, and also protects against special characters like <code>&amp;</code> <code>|</code> etc.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/new-self-vs-new-static/" class="u-url">New self vs. new static</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/new-self-vs-new-static/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T02:52:03+08:00" itemprop="datePublished" title="2023-02-18 02:52">2023-02-18 02:52</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I am converting a PHP 5.3 library to work on PHP 5.2. The main thing standing
in my way is the use of late static binding like <code>return new
static($options);</code> , if I convert this to <code>return new self($options)</code> will I
get the same results?</p>
<p>What is the difference between <code>new self</code> and <code>new static</code>?</p>
<p><br><br></p>
<h2>Answer</h2>
<blockquote>
<p>will I get the same results?</p>
</blockquote>
<p>Not really. I don't know of a workaround for PHP 5.2, though.</p>
<blockquote>
<p>What is the difference between <code>new self</code> and <code>new static</code>?</p>
</blockquote>
<p><code>self</code> refers to the same class in which the <code>new</code> keyword is actually
written.</p>
<p><code>static</code>, in PHP 5.3's late static bindings, refers to whatever class in the
hierarchy you called the method on.</p>
<p>In the following example, <code>B</code> inherits both methods from <code>A</code>. The <code>self</code>
invocation is bound to <code>A</code> because it's defined in <code>A</code>'s implementation of the
first method, whereas <code>static</code> is bound to the called class (also see
<code>get_called_class()</code>).</p>
<div class="code"><pre class="code literal-block"><span class="k">class</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">get_self</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="bp">self</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">get_static</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="k">static</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">class</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">{}</span>

<span class="n">echo</span><span class="w"> </span><span class="n">get_class</span><span class="p">(</span><span class="n">B</span><span class="p">::</span><span class="n">get_self</span><span class="p">());</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">A</span>
<span class="n">echo</span><span class="w"> </span><span class="n">get_class</span><span class="p">(</span><span class="n">B</span><span class="p">::</span><span class="n">get_static</span><span class="p">());</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">B</span>
<span class="n">echo</span><span class="w"> </span><span class="n">get_class</span><span class="p">(</span><span class="n">A</span><span class="p">::</span><span class="n">get_self</span><span class="p">());</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">A</span>
<span class="n">echo</span><span class="w"> </span><span class="n">get_class</span><span class="p">(</span><span class="n">A</span><span class="p">::</span><span class="n">get_static</span><span class="p">());</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">A</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>If the method of this code is not static, you can get a work-around in 5.2 by
using <code>get_class($this)</code>.</p>
<div class="code"><pre class="code literal-block"><span class="k">class</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">public</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">create1</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="o">$</span><span class="k">class</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_class</span><span class="p">(</span><span class="o">$</span><span class="n">this</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="o">$</span><span class="k">class</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">public</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">create2</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="k">static</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">class</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">{</span>

<span class="p">}</span>

<span class="o">$</span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">B</span><span class="p">();</span>
<span class="n">var_dump</span><span class="p">(</span><span class="n">get_class</span><span class="p">(</span><span class="o">$</span><span class="n">b</span><span class="o">-&gt;</span><span class="n">create1</span><span class="p">()),</span><span class="w"> </span><span class="n">get_class</span><span class="p">(</span><span class="o">$</span><span class="n">b</span><span class="o">-&gt;</span><span class="n">create2</span><span class="p">()));</span>
</pre></div>

<p>The results:</p>
<div class="code"><pre class="code literal-block">string(1) "B"
string(1) "B"
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/why-is-an-options-request-sent-and-can-i-disable-it/" class="u-url">Why is an OPTIONS request sent and can I disable it?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/why-is-an-options-request-sent-and-can-i-disable-it/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T02:51:38+08:00" itemprop="datePublished" title="2023-02-18 02:51">2023-02-18 02:51</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I am building a web API. I found whenever I use Chrome to POST, GET to my API,
there is always an OPTIONS request sent before the real request, which is
quite annoying. Currently, I get the server to ignore any OPTIONS requests.
Now my question is what's good to send an OPTIONS request to double the
server's load? Is there any way to completely stop the browser from sending
OPTIONS requests?</p>
<p><br><br></p>
<h2>Answer</h2>
<p><strong>edit 2018-09-13</strong> : added some precisions about this pre-flight request and
how to avoid it at the end of this reponse.</p>
<p><code>OPTIONS</code> requests are what we call <code>pre-flight</code> requests in <code>Cross-origin
resource sharing (CORS)</code>.</p>
<p>They are necessary when you're making requests across different origins in
specific situations.</p>
<p>This pre-flight request is made by some browsers as a safety measure to ensure
that the request being done is trusted by the server. Meaning the server
understands that the method, origin and headers being sent on the request are
safe to act upon.</p>
<p>Your server should not ignore but handle these requests whenever you're
attempting to do cross origin requests.</p>
<p>A good resource can be found here http://enable-cors.org/</p>
<p>A way to handle these to get comfortable is to ensure that for any path with
<code>OPTIONS</code> method the server sends a response with this header</p>
<p><code>Access-Control-Allow-Origin: *</code></p>
<p>This will tell the browser that the server is willing to answer requests from
any origin.</p>
<p>For more information on how to add CORS support to your server see the
following flowchart</p>
<p>http://www.html5rocks.com/static/images/cors_server_flowchart.png</p>
<p><img alt="CORS Flowchart" src="images/6jsKY.png"></p>
<hr>
<p><strong>edit 2018-09-13</strong></p>
<p>CORS <code>OPTIONS</code> request is triggered only in somes cases, as explained in MDN
docs:</p>
<blockquote>
<p>Some requests don’t trigger a CORS preflight. Those are called “simple
requests” in this article, though the Fetch spec (which defines CORS)
doesn’t use that term. A request that doesn’t trigger a CORS preflight—a so-
called “simple request”—is one that meets all the following conditions:</p>
<p>The only allowed methods are:</p>
<ul>
<li>GET</li>
<li>HEAD</li>
<li>POST
</li>
</ul>
<p>Apart from the headers set automatically by the user agent (for example,
Connection, User-Agent, or any of the other headers with names defined in
the Fetch spec as a “forbidden header name”), the only headers which are
allowed to be manually set are those which the Fetch spec defines as being a
“CORS-safelisted request-header”, which are:</p>
<ul>
<li>Accept</li>
<li>Accept-Language</li>
<li>Content-Language</li>
<li>Content-Type (but note the additional requirements below)</li>
<li>DPR</li>
<li>Downlink</li>
<li>Save-Data</li>
<li>Viewport-Width</li>
<li>Width
</li>
</ul>
<p>The only allowed values for the Content-Type header are:</p>
<ul>
<li>application/x-www-form-urlencoded</li>
<li>multipart/form-data</li>
<li>text/plain
</li>
</ul>
<p>No event listeners are registered on any XMLHttpRequestUpload object used in
the request; these are accessed using the XMLHttpRequest.upload property.</p>
<p>No ReadableStream object is used in the request.</p>
</blockquote>
<p><br></p>
<h3>Suggest</h3>
<p>Have gone through this issue, below is my conclusion to this issue and my
solution.</p>
<p>According to the CORS strategy (highly recommend you read about it) You can't
just force the browser to stop sending OPTIONS request if it thinks it needs
to.</p>
<p>There are two ways you can work around it:</p>
<ol>
<li>Make sure your request is a "simple request"</li>
<li>Set <code>Access-Control-Max-Age</code> for the OPTIONS request</li>
</ol>
<h3>Simple request</h3>
<p>A simple cross-site request is one that meets all the following conditions:</p>
<p>The only allowed methods are:</p>
<ul>
<li>GET</li>
<li>HEAD</li>
<li>POST</li>
</ul>
<p>Apart from the headers set automatically by the user agent (e.g. Connection,
User-Agent, etc.), the only headers which are allowed to be manually set are:</p>
<ul>
<li>Accept</li>
<li>Accept-Language</li>
<li>Content-Language</li>
<li>Content-Type</li>
</ul>
<p>The only allowed values for the Content-Type header are:</p>
<ul>
<li>application/x-www-form-urlencoded</li>
<li>multipart/form-data</li>
<li>text/plain</li>
</ul>
<p>A simple request will not cause a pre-flight OPTIONS request.</p>
<h3>Set a cache for the OPTIONS check</h3>
<p>You can set a <code>Access-Control-Max-Age</code> for the OPTIONS request, so that it
will not check the permission again until it is expired.</p>
<blockquote>
<p>Access-Control-Max-Age gives the value in seconds for how long the response
to the preflight request can be cached for without sending another preflight
request.</p>
</blockquote>
<h4>Limitation Noted</h4>
<ul>
<li>For Chrome, the maximum seconds for <code>Access-Control-Max-Age</code> is <code>600</code> which is 10 minutes, according to chrome source code</li>
<li>
<code>Access-Control-Max-Age</code> only works for one resource every time, for example, <code>GET</code> requests with same URL path but different queries will be treated as different resources. So the request to the second resource will still trigger a preflight request.</li>
</ul>
</div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-1169.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-1167.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
