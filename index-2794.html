<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 2794) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-2794.html">
<link rel="prev" href="index-2795.html" type="text/html">
<link rel="next" href="index-2793.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/super-raises-typeerror-must-be-type-not-classobj-for-new-style-class/" class="u-url">super() raises "TypeError: must be type, not classobj" for new-style class</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/super-raises-typeerror-must-be-type-not-classobj-for-new-style-class/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-05T18:25:26+08:00" itemprop="datePublished" title="2023-03-05 18:25">2023-03-05 18:25</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>The following use of <code>super()</code> raises a TypeError: why?</p>
<div class="code"><pre class="code literal-block"><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span>  <span class="nn">HTMLParser</span> <span class="kn">import</span> <span class="n">HTMLParser</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">TextParser</span><span class="p">(</span><span class="n">HTMLParser</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="o">...</span>         <span class="nb">super</span><span class="p">(</span><span class="n">TextParser</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="o">...</span>         <span class="bp">self</span><span class="o">.</span><span class="n">all_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="o">...</span>         
<span class="o">&gt;&gt;&gt;</span> <span class="n">TextParser</span><span class="p">()</span>
<span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="ne">TypeError</span><span class="p">:</span> <span class="n">must</span> <span class="n">be</span> <span class="nb">type</span><span class="p">,</span> <span class="ow">not</span> <span class="n">classobj</span>
</pre></div>

<p>There is a similar question on StackOverflow: Python super() raises TypeError,
where the error is explained by the fact that the user class is not a new-
style class. However, the class above is a new-style class, as it inherits
from <code>object</code>:</p>
<div class="code"><pre class="code literal-block">&gt;&gt;&gt; isinstance(HTMLParser(), object)
True
</pre></div>

<p>What am I missing? How can I use <code>super()</code>, here?</p>
<p>Using <code>HTMLParser.__init__(self)</code> instead of <code>super(TextParser,
self).__init__()</code> would work, but I would like to understand the TypeError.</p>
<p>PS: Joachim pointed out that being a new-style-class instance is not
equivalent to being an <code>object</code>. I read the opposite many times, hence my
confusion (example of new-style class instance test based on <code>object</code> instance
test: https://stackoverflow.com/revisions/2655651/3).</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Alright, it's the usual "<code>super()</code> cannot be used with an old-style class".</p>
<p>However, the important point is that <strong>the correct test</strong> for "is this a new-
style <strong>instance</strong> (i.e. object)?" is</p>
<div class="code"><pre class="code literal-block">&gt;&gt;&gt; class OldStyle: pass
&gt;&gt;&gt; instance = OldStyle()
&gt;&gt;&gt; issubclass(instance.__class__, object)
False
</pre></div>

<p>and not (as in the question):</p>
<div class="code"><pre class="code literal-block">&gt;&gt;&gt; isinstance(instance, object)
True
</pre></div>

<p>For <strong>classes</strong> , the correct "is this a new-style class" test is:</p>
<div class="code"><pre class="code literal-block">&gt;&gt;&gt; issubclass(OldStyle, object)  # OldStyle is not a new-style class
False
&gt;&gt;&gt; issubclass(int, object)  # int is a new-style class
True
</pre></div>

<p>The <strong>crucial point</strong> is that with old-style classes, the <em>class</em> of an
instance and its <em>type</em> are distinct. Here, <code>OldStyle().__class__</code> is
<code>OldStyle</code>, which does not inherit from <code>object</code>, while <code>type(OldStyle())</code> is
the <code>instance</code> type, which <em>does</em> inherit from <code>object</code>. Basically, an old-
style class just creates objects of type <code>instance</code> (whereas a new-style class
creates objects whose type is the class itself). This is probably why the
instance <code>OldStyle()</code> is an <code>object</code>: its <code>type()</code> inherits from <code>object</code> (the
fact that its class does <em>not</em> inherit from <code>object</code> does not count: old-style
classes merely construct new objects of type <code>instance</code>). Partial reference:
https://stackoverflow.com/a/9699961/42973.</p>
<p>PS: The difference between a new-style class and an old-style one can also be
seen with:</p>
<div class="code"><pre class="code literal-block">&gt;&gt;&gt; type(OldStyle)  # OldStyle creates objects but is not itself a type
classobj
&gt;&gt;&gt; isinstance(OldStyle, type)
False
&gt;&gt;&gt; type(int)  # A new-style class is a type
type
</pre></div>

<p>(old-style classes are <em>not</em> types, so they cannot be the type of their
instances).</p>
<p><br></p>
<h3>Suggest</h3>
<p>super() can be used only in the new-style classes, which means the root class
needs to inherit from the 'object' class.</p>
<p>For example, the top class need to be like this:</p>
<div class="code"><pre class="code literal-block"><span class="k">class</span> <span class="n">SomeClass</span>(<span class="n">object</span>):
    <span class="n">def</span> <span class="n">__init__</span>(<span class="nb">self</span>):
        ....
</pre></div>

<p>not</p>
<div class="code"><pre class="code literal-block"><span class="k">class</span> <span class="n">SomeClass</span>():
    <span class="n">def</span> <span class="n">__init__</span>(<span class="nb">self</span>):
        ....
</pre></div>

<p>So, the solution is that call the parent's <strong>init</strong> method directly, like this
way:</p>
<div class="code"><pre class="code literal-block"><span class="k">class</span> <span class="n">TextParser</span>(<span class="n">HTMLParser</span>):
    <span class="n">def</span> <span class="n">__init__</span>(<span class="nb">self</span>):
        <span class="n">HTMLParser</span>.<span class="n">__init__</span>(<span class="nb">self</span>)
        <span class="nb">self</span>.<span class="n">all_data</span> = []
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/understanding-implicit-in-scala/" class="u-url">Understanding implicit in Scala</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/understanding-implicit-in-scala/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-05T18:23:52+08:00" itemprop="datePublished" title="2023-03-05 18:23">2023-03-05 18:23</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I was making my way through the Scala playframework tutorial and I came across
this snippet of code which had me puzzled:</p>
<div class="code"><pre class="code literal-block">def newTask = Action { implicit request =&gt;
taskForm.bindFromRequest.fold(
        errors =&gt; BadRequest(views.html.index(Task.all(), errors)),
        label =&gt; {
          Task.create(label)
          Redirect(routes.Application.tasks())
        } 
  )
}
</pre></div>

<p>So I decided to investigate and came across this post.</p>
<p>I still don't get it.</p>
<p>What is the difference between this:</p>
<div class="code"><pre class="code literal-block">implicit def double2Int(d : Double) : Int = d.toInt
</pre></div>

<p>and</p>
<div class="code"><pre class="code literal-block">def double2IntNonImplicit(d : Double) : Int = d.toInt
</pre></div>

<p>other than the obvious fact they have different method names.</p>
<p>When should I use <code>implicit</code> and why?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>I'll explain the main use cases of implicits below, but for more detail see
the relevant chapter of Programming in Scala.</p>
<p><strong>Implicit parameters</strong></p>
<p>The final parameter list on a method can be marked <code>implicit</code>, which means the
values will be taken from the context in which they are called. If there is no
implicit value of the right type in scope, it will not compile. Since the
implicit value must resolve to a single value and to avoid clashes, it's a
good idea to make the type specific to its purpose, e.g. don't require your
methods to find an implicit <code>Int</code>!</p>
<p>example:</p>
<div class="code"><pre class="code literal-block"><span class="w">  </span>//<span class="w"> </span>probably<span class="w"> </span>in<span class="w"> </span>a<span class="w"> </span>library
class<span class="w"> </span>Prefixer(val<span class="w"> </span>prefix:<span class="w"> </span>String)
def<span class="w"> </span>addPrefix(s:<span class="w"> </span>String)(implicit<span class="w"> </span>p:<span class="w"> </span>Prefixer)<span class="w"> </span>=<span class="w"> </span>p.prefix<span class="w"> </span>+<span class="w"> </span>s

<span class="w">  </span>//<span class="w"> </span>then<span class="w"> </span>probably<span class="w"> </span>in<span class="w"> </span>your<span class="w"> </span>application
implicit<span class="w"> </span>val<span class="w"> </span>myImplicitPrefixer<span class="w"> </span>=<span class="w"> </span>new<span class="w"> </span>Prefixer("***")
addPrefix("abc")<span class="w">  </span>//<span class="w"> </span>returns<span class="w"> </span>"***abc"
</pre></div>

<p><strong>Implicit conversions</strong></p>
<p>When the compiler finds an expression of the wrong type for the context, it
will look for an implicit <code>Function</code> value of a type that will allow it to
typecheck. So if an <code>A</code> is required and it finds a <code>B</code>, it will look for an
implicit value of type <code>B =&gt; A</code> in scope (it also checks some other places
like in the <code>B</code> and <code>A</code> companion objects, if they exist). Since <code>def</code>s can be
"eta-expanded" into <code>Function</code> objects, an <code>implicit def xyz(arg: B): A</code> will
do as well.</p>
<p>So the difference between your methods is that the one marked <code>implicit</code> will
be inserted for you by the compiler when a <code>Double</code> is found but an <code>Int</code> is
required.</p>
<div class="code"><pre class="code literal-block">implicit<span class="w"> </span>def<span class="w"> </span>doubleToInt(d:<span class="w"> </span>Double)<span class="w"> </span>=<span class="w"> </span>d.toInt
val<span class="w"> </span>x:<span class="w"> </span>Int<span class="w"> </span>=<span class="w"> </span>42.0
</pre></div>

<p>will work the same as</p>
<div class="code"><pre class="code literal-block">def<span class="w"> </span>doubleToInt(d:<span class="w"> </span>Double)<span class="w"> </span>=<span class="w"> </span>d.toInt
val<span class="w"> </span>x:<span class="w"> </span>Int<span class="w"> </span>=<span class="w"> </span>doubleToInt(42.0)
</pre></div>

<p>In the second we've inserted the conversion manually; in the first the
compiler did the same automatically. The conversion is required because of the
type annotation on the left hand side.</p>
<hr>
<p>Regarding your first snippet from Play:</p>
<p>Actions are explained on this page from the Play documentation (see also API
docs). You are using</p>
<div class="code"><pre class="code literal-block"><span class="n">apply</span><span class="p">(</span><span class="nl">block</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">Request</span><span class="o">[</span><span class="n">AnyContent</span><span class="o">]</span><span class="p">)</span><span class="w"> </span><span class="err">⇒</span><span class="w"> </span><span class="k">Result</span><span class="p">)</span><span class="err">:</span><span class="w"> </span><span class="k">Action</span><span class="o">[</span><span class="n">AnyContent</span><span class="o">]</span>
</pre></div>

<p>on the <code>Action</code> object (which is the companion to the trait of the same name).</p>
<p>So we need to supply a Function as the argument, which can be written as a
literal in the form</p>
<div class="code"><pre class="code literal-block">request =&gt; ...
</pre></div>

<p>In a function literal, the part before the <code>=&gt;</code> is a value declaration, and
can be marked <code>implicit</code> if you want, just like in any other <code>val</code>
declaration. Here, <code>request</code> <em>doesn't</em> have to be marked <code>implicit</code> for this
to type check, but by doing so it will be <em>available as an implicit value</em> for
any methods that might need it within the function (and of course, it can be
used explicitly as well). In this particular case, this has been done because
the <code>bindFromRequest</code> method on the Form class requires an implicit <code>Request</code>
argument.</p>
<p><br></p>
<h3>Suggest</h3>
<p><strong>WARNING:</strong> contains sarcasm judiciously! YMMV...</p>
<p>Luigi's answer is complete and correct. This one is only to extend it a bit
with an example of how you can gloriously overuse <em>implicits</em> , as it happens
quite often in Scala projects. Actually so often, you can probably even find
it in one of the <em>"Best Practice"</em> guides.</p>
<div class="code"><pre class="code literal-block"><span class="nb">object</span> <span class="n">HelloWorld</span> <span class="p">{</span>
  <span class="n">case</span> <span class="k">class</span> <span class="nc">Text</span><span class="p">(</span><span class="n">content</span><span class="p">:</span> <span class="n">String</span><span class="p">)</span>
  <span class="n">case</span> <span class="k">class</span> <span class="nc">Prefix</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="n">String</span><span class="p">)</span>

  <span class="n">implicit</span> <span class="k">def</span> <span class="nf">String2Text</span><span class="p">(</span><span class="n">content</span><span class="p">:</span> <span class="n">String</span><span class="p">)(</span><span class="n">implicit</span> <span class="n">prefix</span><span class="p">:</span> <span class="n">Prefix</span><span class="p">)</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">Text</span><span class="p">(</span><span class="n">prefix</span><span class="o">.</span><span class="n">text</span> <span class="o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class="n">content</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="k">def</span> <span class="nf">printText</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="n">Text</span><span class="p">):</span> <span class="n">Unit</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">println</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="n">Array</span><span class="p">[</span><span class="n">String</span><span class="p">]):</span> <span class="n">Unit</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">printText</span><span class="p">(</span><span class="s2">"World!"</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="o">//</span> <span class="n">Best</span> <span class="n">to</span> <span class="n">hide</span> <span class="n">this</span> <span class="n">line</span> <span class="n">somewhere</span> <span class="n">below</span> <span class="n">a</span> <span class="n">pile</span> <span class="n">of</span> <span class="n">completely</span> <span class="n">unrelated</span> <span class="n">code</span><span class="o">.</span>
  <span class="o">//</span> <span class="n">Better</span> <span class="n">yet</span><span class="p">,</span> <span class="kn">import</span> <span class="nn">its</span> <span class="n">package</span> <span class="kn">from</span> <span class="nn">another</span> <span class="n">distant</span> <span class="n">place</span><span class="o">.</span>
  <span class="n">implicit</span> <span class="n">val</span> <span class="n">prefixLOL</span> <span class="o">=</span> <span class="n">Prefix</span><span class="p">(</span><span class="s2">"Hello"</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/maven-artifact-and-groupid-naming/" class="u-url">Maven artifact and groupId naming</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/maven-artifact-and-groupid-naming/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-05T18:22:41+08:00" itemprop="datePublished" title="2023-03-05 18:22">2023-03-05 18:22</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I'm currently in the process of moving some project from Ant to Maven.
Conformist as I am, I want to use well-established conventions for finding
<code>groupId</code> and <code>artifactId</code>, but I can't find any detailed conventions (there
are some, but they don't cover the points I'm wondering about).</p>
<p>Take this project for instance, first the Java package:
<code>com.mycompany.teatimer</code></p>
<p><em>Tea timer</em> is actually two words, but the Java package naming conventions
forbid the insertion of underscores or hyphens, so I'm writing it all
together.</p>
<p>I chose the <code>groupId</code> identical to the package ID because I think that's a
good idea. Is it?</p>
<p>Finally, I have to pick an <code>artifactId</code>, I currently went for <code>teatimer</code>. But
when I look at other Maven projects, they use hyphens to split words in
<code>artifactId</code>s, like this: <code>tea-timer</code>. But it does look weird when
concatenated to the <code>groupId</code>: <code>com.mycompany.teatimer.tea-timer</code>.</p>
<p>How would you do this?</p>
<p>Another example:</p>
<p>Package name: <code>com.mycompany.awesomeinhouseframework</code></p>
<p><code>groupId</code>: <code>com.mycompany.awesomeinhouseframework</code> (?)</p>
<p><code>artifactId</code>: <code>awesome-inhouse-framework</code> (?)</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Your convention seems to be reasonable. If I were searching for your framework
in the Maven repo, I would look for <code>awesome-inhouse-framework-x.y.jar</code> in
<code>com.mycompany.awesomeinhouseframework</code> group directory. And I would find it
there according to your convention.</p>
<p>Two simple rules work for me:</p>
<ul>
<li>reverse-domain-packages for groupId (since such are quite unique) with all the constrains regarding Java packages names</li>
<li>project name as artifactId (keeping in mind that it should be jar-name friendly i.e. not contain characters that maybe invalid for a file name or just look weird)</li>
</ul>
<p><br></p>
<h3>Suggest</h3>
<p>Your convention seems to be reasonable. If I were searching for your framework
in the Maven repo, I would look for <code>awesome-inhouse-framework-x.y.jar</code> in
<code>com.mycompany.awesomeinhouseframework</code> group directory. And I would find it
there according to your convention.</p>
<p>Two simple rules work for me:</p>
<ul>
<li>reverse-domain-packages for groupId (since such are quite unique) with all the constrains regarding Java packages names</li>
<li>project name as artifactId (keeping in mind that it should be jar-name friendly i.e. not contain characters that maybe invalid for a file name or just look weird)</li>
</ul>
</div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-2795.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-2793.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
