<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 69) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-69.html">
<link rel="prev" href="index-70.html" type="text/html">
<link rel="next" href="index-68.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/ru-he-cong-docker-rong-qi-nei-bu-lian-jie-dao-ji-qi-de-ben-di-zhu-ji/" class="u-url">如何从 Docker 容器内部连接到机器的本地主机？</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/ru-he-cong-docker-rong-qi-nei-bu-lian-jie-dao-ji-qi-de-ben-di-zhu-ji/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-16T20:19:08+08:00" itemprop="datePublished" title="2023-02-16 20:19">2023-02-16 20:19</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>我有一个在 docker 容器中运行的 Nginx。我有一个在主机系统上运行的 MySql。我想从我的容器中连接到 MySql。MySql
仅绑定到本地主机设备。</p>
<p>有没有办法从这个 docker 容器连接到这个 MySql 或本地主机上的任何其他程序？</p>
<p>这个问题不同于“How to get the IP address of the docker host from inside a docker
container”，因为 docker 主机的 IP 地址可能是网络中的公共 IP 或私有 IP，这可能会或可能无法从 docker
容器内访问（我的意思是公共 IP，如果托管在 AWS 或其他东西上）。即使你有 docker 主机的 IP 地址，这并不意味着你可以从容器内连接到
docker 主机，因为你的 Docker 网络可能是 overlay、host、bridge、macvlan、none 等，这限制了可达性那个IP地址。</p>
<p><br><br></p>
<h2>解答</h2>
<p><strong>编辑：</strong></p>
<p>如果您使用的是Docker-for-mac或Docker-for-Windows
18.03+，请使用主机<code>host.docker.internal</code>（而不是<code>127.0.0.1</code>连接字符串中的）连接到您的 mysql 服务。</p>
<p><code>host.docker.internal</code> <strong>如果您使用的是 Docker-for-Linux 20.10.0+，如果</strong> 您使用该选项启动
Docker 容器，则也可以使用主机<code>--add-host host.docker.internal:host-gateway</code>。</p>
<p>否则，请阅读下文</p>
<hr>
<h3>TLDR</h3>
<p><code>--network="host"</code>在你的命令中使用<code>docker run</code>，然后<code>127.0.0.1</code>在你的 docker 容器中将指向你的 docker
主机。</p>
<p>注意：根据文档，此模式仅适用于 Docker for Linux 。</p>
<hr>
<h2>docker容器网络模式注意事项</h2>
<p>Docker在运行容器时提供不同的网络模式。根据您选择的模式，您将以不同方式连接到在 docker 主机上运行的 MySQL 数据库。</p>
<h3>docker run --network="bridge" （默认）</h3>
<p>Docker 创建一个默认命名的网桥<code>docker0</code>。docker 主机和 docker 容器在该桥上都有一个 IP 地址。</p>
<p>在 Docker 主机上，键入<code>sudo ip addr show docker0</code>您将得到如下所示的输出：</p>
<div class="code"><pre class="code literal-block"><span class="o">[</span><span class="n">vagrant@docker:~</span><span class="o">]</span><span class="w"> </span><span class="err">$</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">ip</span><span class="w"> </span><span class="n">addr</span><span class="w"> </span><span class="n">show</span><span class="w"> </span><span class="n">docker0</span>
<span class="mi">4</span><span class="err">:</span><span class="w"> </span><span class="nl">docker0</span><span class="p">:</span><span class="w"> </span><span class="o">&lt;</span><span class="n">BROADCAST</span><span class="p">,</span><span class="n">MULTICAST</span><span class="p">,</span><span class="n">UP</span><span class="p">,</span><span class="n">LOWER_UP</span><span class="o">&gt;</span><span class="w"> </span><span class="n">mtu</span><span class="w"> </span><span class="mi">1500</span><span class="w"> </span><span class="n">qdisc</span><span class="w"> </span><span class="n">noqueue</span><span class="w"> </span><span class="k">state</span><span class="w"> </span><span class="n">UP</span><span class="w"> </span><span class="k">group</span><span class="w"> </span><span class="k">default</span>
<span class="w">    </span><span class="n">link</span><span class="o">/</span><span class="n">ether</span><span class="w"> </span><span class="mi">56</span><span class="err">:</span><span class="mi">84</span><span class="err">:</span><span class="mi">7</span><span class="nl">a</span><span class="p">:</span><span class="nl">fe</span><span class="p">:</span><span class="mi">97</span><span class="err">:</span><span class="mi">99</span><span class="w"> </span><span class="n">brd</span><span class="w"> </span><span class="nl">ff</span><span class="p">:</span><span class="nl">ff</span><span class="p">:</span><span class="nl">ff</span><span class="p">:</span><span class="nl">ff</span><span class="p">:</span><span class="nl">ff</span><span class="p">:</span><span class="n">ff</span>
<span class="w">    </span><span class="n">inet</span><span class="w"> </span><span class="mf">172.17.42.1</span><span class="o">/</span><span class="mi">16</span><span class="w"> </span><span class="k">scope</span><span class="w"> </span><span class="k">global</span><span class="w"> </span><span class="n">docker0</span>
<span class="w">       </span><span class="n">valid_lft</span><span class="w"> </span><span class="n">forever</span><span class="w"> </span><span class="n">preferred_lft</span><span class="w"> </span><span class="n">forever</span>
<span class="w">    </span><span class="n">inet6</span><span class="w"> </span><span class="nl">fe80</span><span class="p">:</span><span class="err">:</span><span class="mi">5484</span><span class="err">:</span><span class="mi">7</span><span class="nl">aff</span><span class="p">:</span><span class="nl">fefe</span><span class="p">:</span><span class="mi">9799</span><span class="o">/</span><span class="mi">64</span><span class="w"> </span><span class="k">scope</span><span class="w"> </span><span class="n">link</span>
<span class="w">       </span><span class="n">valid_lft</span><span class="w"> </span><span class="n">forever</span><span class="w"> </span><span class="n">preferred_lft</span><span class="w"> </span><span class="n">forever</span>
</pre></div>

<p><code>172.17.42.1</code>所以这里我的 docker 主机在网络接口上有 IP 地址<code>docker0</code>。</p>
<p>现在启动一个新容器并在其上获取一个 shell：<code>docker run --rm -it ubuntu:trusty bash</code>并在容器类型中<code>ip
addr show eth0</code>发现其主要网络接口是如何设置的：</p>
<div class="code"><pre class="code literal-block"><span class="n">root</span><span class="nv">@e77f6a1b3740</span><span class="err">:</span><span class="o">/</span><span class="err">#</span><span class="w"> </span><span class="n">ip</span><span class="w"> </span><span class="n">addr</span><span class="w"> </span><span class="n">show</span><span class="w"> </span><span class="n">eth0</span>
<span class="mi">863</span><span class="err">:</span><span class="w"> </span><span class="nl">eth0</span><span class="p">:</span><span class="w"> </span><span class="o">&lt;</span><span class="n">BROADCAST</span><span class="p">,</span><span class="n">UP</span><span class="p">,</span><span class="n">LOWER_UP</span><span class="o">&gt;</span><span class="w"> </span><span class="n">mtu</span><span class="w"> </span><span class="mi">1500</span><span class="w"> </span><span class="n">qdisc</span><span class="w"> </span><span class="n">pfifo_fast</span><span class="w"> </span><span class="k">state</span><span class="w"> </span><span class="n">UP</span><span class="w"> </span><span class="k">group</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="n">qlen</span><span class="w"> </span><span class="mi">1000</span>
<span class="w">    </span><span class="n">link</span><span class="o">/</span><span class="n">ether</span><span class="w"> </span><span class="mi">66</span><span class="err">:</span><span class="mi">32</span><span class="err">:</span><span class="mi">13</span><span class="err">:</span><span class="nl">f0</span><span class="p">:</span><span class="nl">f1</span><span class="p">:</span><span class="n">e3</span><span class="w"> </span><span class="n">brd</span><span class="w"> </span><span class="nl">ff</span><span class="p">:</span><span class="nl">ff</span><span class="p">:</span><span class="nl">ff</span><span class="p">:</span><span class="nl">ff</span><span class="p">:</span><span class="nl">ff</span><span class="p">:</span><span class="n">ff</span>
<span class="w">    </span><span class="n">inet</span><span class="w"> </span><span class="mf">172.17.1.192</span><span class="o">/</span><span class="mi">16</span><span class="w"> </span><span class="k">scope</span><span class="w"> </span><span class="k">global</span><span class="w"> </span><span class="n">eth0</span>
<span class="w">       </span><span class="n">valid_lft</span><span class="w"> </span><span class="n">forever</span><span class="w"> </span><span class="n">preferred_lft</span><span class="w"> </span><span class="n">forever</span>
<span class="w">    </span><span class="n">inet6</span><span class="w"> </span><span class="nl">fe80</span><span class="p">:</span><span class="err">:</span><span class="mi">6432</span><span class="err">:</span><span class="mi">13</span><span class="nl">ff</span><span class="p">:</span><span class="nl">fef0</span><span class="p">:</span><span class="n">f1e3</span><span class="o">/</span><span class="mi">64</span><span class="w"> </span><span class="k">scope</span><span class="w"> </span><span class="n">link</span>
<span class="w">       </span><span class="n">valid_lft</span><span class="w"> </span><span class="n">forever</span><span class="w"> </span><span class="n">preferred_lft</span><span class="w"> </span><span class="n">forever</span>
</pre></div>

<p>这里我的容器有 IP 地址<code>172.17.1.192</code>。现在查看路由表：</p>
<div class="code"><pre class="code literal-block"><span class="n">root</span><span class="nv">@e77f6a1b3740</span><span class="err">:</span><span class="o">/</span><span class="err">#</span><span class="w"> </span><span class="n">route</span>
<span class="n">Kernel</span><span class="w"> </span><span class="n">IP</span><span class="w"> </span><span class="n">routing</span><span class="w"> </span><span class="nc">table</span>
<span class="n">Destination</span><span class="w">     </span><span class="n">Gateway</span><span class="w">         </span><span class="n">Genmask</span><span class="w">         </span><span class="n">Flags</span><span class="w"> </span><span class="n">Metric</span><span class="w"> </span><span class="k">Ref</span><span class="w">    </span><span class="k">Use</span><span class="w"> </span><span class="n">Iface</span>
<span class="k">default</span><span class="w">         </span><span class="mf">172.17.42.1</span><span class="w">     </span><span class="mf">0.0.0.0</span><span class="w">         </span><span class="n">UG</span><span class="w">    </span><span class="mi">0</span><span class="w">      </span><span class="mi">0</span><span class="w">        </span><span class="mi">0</span><span class="w"> </span><span class="n">eth0</span>
<span class="mf">172.17.0.0</span><span class="w">      </span><span class="o">*</span><span class="w">               </span><span class="mf">255.255.0.0</span><span class="w">     </span><span class="n">U</span><span class="w">     </span><span class="mi">0</span><span class="w">      </span><span class="mi">0</span><span class="w">        </span><span class="mi">0</span><span class="w"> </span><span class="n">eth0</span>
</pre></div>

<p>因此 docker 主机的 IP 地址<code>172.17.42.1</code>被设置为默认路由，并且可以从您的容器访问。</p>
<div class="code"><pre class="code literal-block"><span class="n">root</span><span class="nv">@e77f6a1b3740</span><span class="err">:</span><span class="o">/</span><span class="err">#</span><span class="w"> </span><span class="n">ping</span><span class="w"> </span><span class="mf">172.17.42.1</span>
<span class="n">PING</span><span class="w"> </span><span class="mf">172.17.42.1</span><span class="w"> </span><span class="p">(</span><span class="mf">172.17.42.1</span><span class="p">)</span><span class="w"> </span><span class="mi">56</span><span class="p">(</span><span class="mi">84</span><span class="p">)</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">data</span><span class="p">.</span>
<span class="mi">64</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mf">172.17.42.1</span><span class="err">:</span><span class="w"> </span><span class="n">icmp_seq</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="n">ttl</span><span class="o">=</span><span class="mi">64</span><span class="w"> </span><span class="nc">time</span><span class="o">=</span><span class="mf">0.070</span><span class="w"> </span><span class="n">ms</span>
<span class="mi">64</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mf">172.17.42.1</span><span class="err">:</span><span class="w"> </span><span class="n">icmp_seq</span><span class="o">=</span><span class="mi">2</span><span class="w"> </span><span class="n">ttl</span><span class="o">=</span><span class="mi">64</span><span class="w"> </span><span class="nc">time</span><span class="o">=</span><span class="mf">0.201</span><span class="w"> </span><span class="n">ms</span>
<span class="mi">64</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mf">172.17.42.1</span><span class="err">:</span><span class="w"> </span><span class="n">icmp_seq</span><span class="o">=</span><span class="mi">3</span><span class="w"> </span><span class="n">ttl</span><span class="o">=</span><span class="mi">64</span><span class="w"> </span><span class="nc">time</span><span class="o">=</span><span class="mf">0.116</span><span class="w"> </span><span class="n">ms</span>
</pre></div>

<h3>docker run --network="主机"</h3>
<p>或者，您可以运行网络设置为<code>host</code>. 这样的容器将与 docker
主机共享网络堆栈，并且从容器的角度来看，<code>localhost</code>（或<code>127.0.0.1</code>）将引用 docker 主机。</p>
<p>请注意，在 docker 容器中打开的任何端口都会在 docker 主机上打开。而这不需要<code>-p</code>or<code>-P</code> <code>docker run</code>选项。</p>
<p>我的 docker 主机上的 IP 配置：</p>
<div class="code"><pre class="code literal-block"><span class="o">[</span><span class="n">vagrant@docker:~</span><span class="o">]</span><span class="w"> </span><span class="err">$</span><span class="w"> </span><span class="n">ip</span><span class="w"> </span><span class="n">addr</span><span class="w"> </span><span class="n">show</span><span class="w"> </span><span class="n">eth0</span>
<span class="mi">2</span><span class="err">:</span><span class="w"> </span><span class="nl">eth0</span><span class="p">:</span><span class="w"> </span><span class="o">&lt;</span><span class="n">BROADCAST</span><span class="p">,</span><span class="n">MULTICAST</span><span class="p">,</span><span class="n">UP</span><span class="p">,</span><span class="n">LOWER_UP</span><span class="o">&gt;</span><span class="w"> </span><span class="n">mtu</span><span class="w"> </span><span class="mi">1500</span><span class="w"> </span><span class="n">qdisc</span><span class="w"> </span><span class="n">pfifo_fast</span><span class="w"> </span><span class="k">state</span><span class="w"> </span><span class="n">UP</span><span class="w"> </span><span class="k">group</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="n">qlen</span><span class="w"> </span><span class="mi">1000</span>
<span class="w">    </span><span class="n">link</span><span class="o">/</span><span class="n">ether</span><span class="w"> </span><span class="mi">08</span><span class="err">:</span><span class="mi">00</span><span class="err">:</span><span class="mi">27</span><span class="err">:</span><span class="mi">98</span><span class="err">:</span><span class="nl">dc</span><span class="p">:</span><span class="n">aa</span><span class="w"> </span><span class="n">brd</span><span class="w"> </span><span class="nl">ff</span><span class="p">:</span><span class="nl">ff</span><span class="p">:</span><span class="nl">ff</span><span class="p">:</span><span class="nl">ff</span><span class="p">:</span><span class="nl">ff</span><span class="p">:</span><span class="n">ff</span>
<span class="w">    </span><span class="n">inet</span><span class="w"> </span><span class="mf">10.0.2.15</span><span class="o">/</span><span class="mi">24</span><span class="w"> </span><span class="n">brd</span><span class="w"> </span><span class="mf">10.0.2.255</span><span class="w"> </span><span class="k">scope</span><span class="w"> </span><span class="k">global</span><span class="w"> </span><span class="n">eth0</span>
<span class="w">       </span><span class="n">valid_lft</span><span class="w"> </span><span class="n">forever</span><span class="w"> </span><span class="n">preferred_lft</span><span class="w"> </span><span class="n">forever</span>
<span class="w">    </span><span class="n">inet6</span><span class="w"> </span><span class="nl">fe80</span><span class="p">:</span><span class="err">:</span><span class="nl">a00</span><span class="p">:</span><span class="mi">27</span><span class="nl">ff</span><span class="p">:</span><span class="nl">fe98</span><span class="p">:</span><span class="n">dcaa</span><span class="o">/</span><span class="mi">64</span><span class="w"> </span><span class="k">scope</span><span class="w"> </span><span class="n">link</span>
<span class="w">       </span><span class="n">valid_lft</span><span class="w"> </span><span class="n">forever</span><span class="w"> </span><span class="n">preferred_lft</span><span class="w"> </span><span class="n">forever</span>
</pre></div>

<p><strong>从主机</strong> 模式下的 docker 容器：</p>
<div class="code"><pre class="code literal-block"><span class="o">[</span><span class="n">vagrant@docker:~</span><span class="o">]</span><span class="w"> </span><span class="err">$</span><span class="w"> </span><span class="n">docker</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="o">--</span><span class="n">rm</span><span class="w"> </span><span class="o">-</span><span class="n">it</span><span class="w"> </span><span class="o">--</span><span class="n">network</span><span class="o">=</span><span class="k">host</span><span class="w"> </span><span class="nl">ubuntu</span><span class="p">:</span><span class="n">trusty</span><span class="w"> </span><span class="n">ip</span><span class="w"> </span><span class="n">addr</span><span class="w"> </span><span class="n">show</span><span class="w"> </span><span class="n">eth0</span>
<span class="mi">2</span><span class="err">:</span><span class="w"> </span><span class="nl">eth0</span><span class="p">:</span><span class="w"> </span><span class="o">&lt;</span><span class="n">BROADCAST</span><span class="p">,</span><span class="n">MULTICAST</span><span class="p">,</span><span class="n">UP</span><span class="p">,</span><span class="n">LOWER_UP</span><span class="o">&gt;</span><span class="w"> </span><span class="n">mtu</span><span class="w"> </span><span class="mi">1500</span><span class="w"> </span><span class="n">qdisc</span><span class="w"> </span><span class="n">pfifo_fast</span><span class="w"> </span><span class="k">state</span><span class="w"> </span><span class="n">UP</span><span class="w"> </span><span class="k">group</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="n">qlen</span><span class="w"> </span><span class="mi">1000</span>
<span class="w">    </span><span class="n">link</span><span class="o">/</span><span class="n">ether</span><span class="w"> </span><span class="mi">08</span><span class="err">:</span><span class="mi">00</span><span class="err">:</span><span class="mi">27</span><span class="err">:</span><span class="mi">98</span><span class="err">:</span><span class="nl">dc</span><span class="p">:</span><span class="n">aa</span><span class="w"> </span><span class="n">brd</span><span class="w"> </span><span class="nl">ff</span><span class="p">:</span><span class="nl">ff</span><span class="p">:</span><span class="nl">ff</span><span class="p">:</span><span class="nl">ff</span><span class="p">:</span><span class="nl">ff</span><span class="p">:</span><span class="n">ff</span>
<span class="w">    </span><span class="n">inet</span><span class="w"> </span><span class="mf">10.0.2.15</span><span class="o">/</span><span class="mi">24</span><span class="w"> </span><span class="n">brd</span><span class="w"> </span><span class="mf">10.0.2.255</span><span class="w"> </span><span class="k">scope</span><span class="w"> </span><span class="k">global</span><span class="w"> </span><span class="n">eth0</span>
<span class="w">       </span><span class="n">valid_lft</span><span class="w"> </span><span class="n">forever</span><span class="w"> </span><span class="n">preferred_lft</span><span class="w"> </span><span class="n">forever</span>
<span class="w">    </span><span class="n">inet6</span><span class="w"> </span><span class="nl">fe80</span><span class="p">:</span><span class="err">:</span><span class="nl">a00</span><span class="p">:</span><span class="mi">27</span><span class="nl">ff</span><span class="p">:</span><span class="nl">fe98</span><span class="p">:</span><span class="n">dcaa</span><span class="o">/</span><span class="mi">64</span><span class="w"> </span><span class="k">scope</span><span class="w"> </span><span class="n">link</span>
<span class="w">       </span><span class="n">valid_lft</span><span class="w"> </span><span class="n">forever</span><span class="w"> </span><span class="n">preferred_lft</span><span class="w"> </span><span class="n">forever</span>
</pre></div>

<p>如您所见，docker 主机和 docker 容器共享完全相同的网络接口，因此具有相同的 IP 地址。</p>
<hr>
<h2>从容器连接到 MySQL</h2>
<h3>桥接模式</h3>
<p><em>要以桥接模式</em> 从容器访问在 docker 主机上运行的 MySQL ，您需要确保 MySQL 服务正在侦听<code>172.17.42.1</code>IP 地址上的连接。</p>
<p>为此，请确保您有<code>bind-address = 172.17.42.1</code>或<code>bind-address = 0.0.0.0</code>在您的 MySQL 配置文件
(my.cnf) 中。</p>
<p>如果需要使用网关的 IP 地址设置环境变量，可以在容器中运行以下代码：</p>
<div class="code"><pre class="code literal-block"><span class="k">export</span><span class="w"> </span><span class="n">DOCKER_HOST_IP</span><span class="o">=$</span><span class="p">(</span><span class="n">route</span><span class="w"> </span><span class="o">-</span><span class="n">n</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">awk</span><span class="w"> </span><span class="s1">'/UG[ </span><span class="se">\t</span><span class="s1">]/{print $2}'</span><span class="p">)</span>
</pre></div>

<p>然后在您的应用程序中，使用<code>DOCKER_HOST_IP</code>环境变量打开与 MySQL 的连接。</p>
<p><strong>注意：</strong> 如果你使用<code>bind-address = 0.0.0.0</code>你的 MySQL 服务器将监听所有网络接口上的连接。这意味着可以从
Internet 访问您的 MySQL 服务器；确保相应地设置防火墙规则。</p>
<p><strong>注意 2：</strong> 如果您使用<code>bind-address = 172.17.42.1</code>MySQL 服务器，则不会侦听与<code>127.0.0.1</code>. 在想要连接到
MySQL 的 docker 主机上运行的进程必须使用<code>172.17.42.1</code>IP 地址。</p>
<h3>主机模式</h3>
<p><em>要以主机模式</em> 从容器访问在 docker 主机上运行的 MySQL ，您可以保留<code>bind-address = 127.0.0.1</code>MySQL
配置并<code>127.0.0.1</code>从您的容器连接：</p>
<div class="code"><pre class="code literal-block"><span class="o">[</span><span class="n">vagrant@docker:~</span><span class="o">]</span><span class="w"> </span><span class="err">$</span><span class="w"> </span><span class="n">docker</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="o">--</span><span class="n">rm</span><span class="w"> </span><span class="o">-</span><span class="n">it</span><span class="w"> </span><span class="o">--</span><span class="n">network</span><span class="o">=</span><span class="k">host</span><span class="w"> </span><span class="n">mysql</span><span class="w"> </span><span class="n">mysql</span><span class="w"> </span><span class="o">-</span><span class="n">h</span><span class="w"> </span><span class="mf">127.0.0.1</span><span class="w"> </span><span class="o">-</span><span class="n">uroot</span><span class="w"> </span><span class="o">-</span><span class="n">p</span>
<span class="n">Enter</span><span class="w"> </span><span class="nl">password</span><span class="p">:</span>
<span class="n">Welcome</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">MySQL</span><span class="w"> </span><span class="n">monitor</span><span class="p">.</span><span class="w">  </span><span class="n">Commands</span><span class="w"> </span><span class="k">end</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="err">\</span><span class="n">g</span><span class="p">.</span>
<span class="n">Your</span><span class="w"> </span><span class="n">MySQL</span><span class="w"> </span><span class="k">connection</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="mi">36</span>
<span class="n">Server</span><span class="w"> </span><span class="nl">version</span><span class="p">:</span><span class="w"> </span><span class="mf">5.5.41</span><span class="o">-</span><span class="mi">0</span><span class="n">ubuntu0</span><span class="mf">.14.04.1</span><span class="w"> </span><span class="p">(</span><span class="n">Ubuntu</span><span class="p">)</span>

<span class="n">Copyright</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="mi">2000</span><span class="p">,</span><span class="w"> </span><span class="mi">2014</span><span class="p">,</span><span class="w"> </span><span class="n">Oracle</span><span class="w"> </span><span class="ow">and</span><span class="o">/</span><span class="ow">or</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">affiliates</span><span class="p">.</span><span class="w"> </span><span class="ow">All</span><span class="w"> </span><span class="n">rights</span><span class="w"> </span><span class="n">reserved</span><span class="p">.</span>

<span class="n">Oracle</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">registered</span><span class="w"> </span><span class="n">trademark</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">Oracle</span><span class="w"> </span><span class="n">Corporation</span><span class="w"> </span><span class="ow">and</span><span class="o">/</span><span class="ow">or</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">affiliates</span><span class="p">.</span><span class="w"> </span><span class="n">Other</span><span class="w"> </span><span class="k">names</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">trademarks</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">their</span><span class="w"> </span><span class="n">respective</span><span class="w"> </span><span class="n">owners</span><span class="p">.</span>

<span class="n">Type</span><span class="w"> </span><span class="s1">'help;'</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s1">'\h'</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">help</span><span class="p">.</span><span class="w"> </span><span class="n">Type</span><span class="w"> </span><span class="s1">'\c'</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">clear</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">current</span><span class="w"> </span><span class="k">input</span><span class="w"> </span><span class="k">statement</span><span class="p">.</span>

<span class="n">mysql</span><span class="o">&gt;</span>
</pre></div>

<p><strong>注意：</strong> 不要使用<code>mysql -h 127.0.0.1</code>，不要使用<code>mysql -h localhost</code>；否则 MySQL 客户端将尝试使用
unix 套接字进行连接。</p>
<p><br></p>
<h3>更多建议</h3>
<h2>适用于所有平台</h2>
<p><strong>Docker v 20.10 及更高版本（自 2020 年 12 月 14 日起）</strong></p>
<p><code>host.docker.internal</code>使用您的内部 IP 地址或连接到将解析为主机使用的内部 IP 地址的特殊 DNS 名称。</p>
<p><em>在 Linux 上，使用 <strong>Docker</strong> 命令，添加<code>--add-host=host.docker.internal:host-
gateway</code>到您的 Docker 命令以启用此功能。</em></p>
<p><em>要在 Linux 上的 <strong>Docker Compose</strong> 中启用此功能，请将以下行添加到容器定义中：</em></p>
<div class="code"><pre class="code literal-block">extra_hosts:
    - "host.docker.internal:host-gateway"
</pre></div>

<h3>对于较旧的 macOS 和 Windows 版本的 Docker</h3>
<p><strong>Docker v 18.03 及更高版本（自 2018 年 3 月 21 日起）</strong></p>
<p><code>host.docker.internal</code>使用您的内部 IP 地址或连接到将解析为主机使用的内部 IP 地址的特殊 DNS 名称。</p>
<p>Linux 支持待定https://github.com/docker/for-linux/issues/264</p>
<h3>对于旧的 macOS 版本的 Docker</h3>
<p><strong>适用于 Mac 的 Docker v 17.12 到 v 18.02</strong></p>
<p>与上面相同，但<code>docker.for.mac.host.internal</code>改为使用。</p>
<p><strong>适用于 Mac 的 Docker v 17.06 到 v 17.11</strong></p>
<p>与上面相同，但<code>docker.for.mac.localhost</code>改为使用。</p>
<p><strong>适用于 Mac 17.05 及以下版本的 Docker</strong></p>
<p>要从 docker 容器访问主机，您必须将 IP 别名附加到您的网络接口。你可以绑定任何你想要的 IP，只要确保你没有将它用于其他任何东西。</p>
<p><code>sudo ifconfig lo0 alias 123.123.123.123/24</code></p>
<p>然后确保您的服务器正在侦听上述 IP 或<code>0.0.0.0</code>. 如果它在本地主机上侦听，<code>127.0.0.1</code>它将不会接受连接。</p>
<p>然后只要把你的docker容器指向这个IP就可以访问宿主机了！</p>
<p><code>curl -X GET 123.123.123.123:3000</code>要进行测试，您可以在容器内运行类似的东西。</p>
<p>别名将在每次重新启动时重置，因此如有必要，请创建启动脚本。</p>
<p>此处的解决方案和更多文档：https ://docs.docker.com/docker-for-mac/networking/#use-cases-
and-workarounds</p>
<p><br><br><a href="posts/from-inside-of-a-docker-container-how-do-i-connect-to-the-localhost-of-the-machine/">查看原文</a></p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/cong-php-zhong-de-shu-zu-zhong-shan-chu-yi-ge-yuan-su/" class="u-url">从 PHP 中的数组中删除一个元素</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/cong-php-zhong-de-shu-zu-zhong-shan-chu-yi-ge-yuan-su/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-16T20:18:29+08:00" itemprop="datePublished" title="2023-02-16 20:18">2023-02-16 20:18</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>有没有一种简单的方法可以使用 PHP 从数组中删除元素，从而<code>foreach ($array)</code>不再包含该元素？</p>
<p>我认为将其设置为<code>null</code>即可，但显然它不起作用。</p>
<p><br><br></p>
<h2>解答</h2>
<p>有多种删除数组元素的方法，其中一些方法比其他方法对某些特定任务更有用。</p>
<h3>删除单个数组元素</h3>
<p>如果只想删除一个数组元素，可以使用<code>unset()</code>或<code>\array_splice()</code>。</p>
<p>如果您知道值但不知道删除元素的键，您可以使用它<code>\array_search()</code>来获取键。这仅在元素不出现多次时才有效，因为<code>\array_search</code>仅返回第一次命中。</p>
<h4><code>unset()</code></h4>
<p>请注意，当您使用<code>unset()</code>数组键时不会改变。<code>\array_values()</code>如果你想重新索引你可以使用after
的键<code>unset()</code>，它会将所有键转换为从 0 开始的数字枚举键。</p>
<p>代码：</p>
<div class="code"><pre class="code literal-block">$array = [0 =&gt; "a", 1 =&gt; "b", 2 =&gt; "c"];
unset($array[1]);
          // ↑ Key which you want to delete
</pre></div>

<p>输出：</p>
<div class="code"><pre class="code literal-block">[
    [0] =&gt; a
    [2] =&gt; c
]
</pre></div>

<h4>
<code>\array_splice()</code>方法</h4>
<p>如果您使用<code>\array_splice()</code>键将自动重新索引，但关联键不会改变 — 与 相反<code>\array_values()</code>，它将所有键转换为数字键。</p>
<p><code>\array_splice()</code>需要 <em>offset</em> 而不是 <em>key</em> 作为第二个参数。</p>
<p>代码：</p>
<div class="code"><pre class="code literal-block">$array = [0 =&gt; "a", 1 =&gt; "b", 2 =&gt; "c"];
\array_splice($array, 1, 1);
                   // ↑ Offset which you want to delete
</pre></div>

<p>输出：</p>
<div class="code"><pre class="code literal-block">[
    [0] =&gt; a
    [1] =&gt; c
]
</pre></div>

<p><code>array_splice()</code>, 同<code>unset()</code>, 通过引用获取数组。您不会将这些函数的返回值分配回数组。</p>
<h3>删除多个数组元素</h3>
<p>如果你想删除多个数组元素并且不想调用<code>unset()</code>or<code>\array_splice()</code>多次，你可以使用函数<code>\array_diff()</code>or<code>\array_diff_key()</code>取决于你是否知道要删除的元素的值或键。</p>
<h4>
<code>\array_diff()</code>方法</h4>
<p>如果您知道要删除的数组元素的值，则可以使用<code>\array_diff()</code>. 和以前一样，<code>unset()</code>它不会改变数组的键。</p>
<p>代码：</p>
<div class="code"><pre class="code literal-block">$array = [0 =&gt; "a", 1 =&gt; "b", 2 =&gt; "c", 3 =&gt; "c"];
$array = \array_diff($array, ["a", "c"]);
                          // └────────┘
                          // Array values which you want to delete
</pre></div>

<p>输出：</p>
<div class="code"><pre class="code literal-block">[
    [1] =&gt; b
]
</pre></div>

<h4>
<code>\array_diff_key()</code>方法</h4>
<p>如果您知道要删除的元素的键，那么您想要使用<code>\array_diff_key()</code>. 您必须确保将键作为键而不是值传递给第二个参数。键不会重建索引。</p>
<p>代码：</p>
<div class="code"><pre class="code literal-block">$array = [0 =&gt; "a", 1 =&gt; "b", 2 =&gt; "c"];
$array = \array_diff_key($array, [0 =&gt; "xy", "2" =&gt; "xy"]);
                               // ↑           ↑
                               // Array keys which you want to delete
</pre></div>

<p>输出：</p>
<div class="code"><pre class="code literal-block">[
    [1] =&gt; b
]
</pre></div>

<p>如果你想使用<code>unset()</code>或<code>\array_splice()</code>删除具有相同值的多个元素，你可以使用<code>\array_keys()</code>获取特定值的所有键，然后删除所有元素。</p>
<h4>
<code>\array_filter()</code>方法</h4>
<p>如果要删除数组中具有特定值的所有元素，可以使用<code>\array_filter()</code>.</p>
<p>代码：</p>
<div class="code"><pre class="code literal-block"><span class="mh">$a</span><span class="nv">rray</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>[<span class="mi">0</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">"a"</span>,<span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">"b"</span>,<span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">"c"</span>]<span class="c1">;</span>
<span class="mh">$a</span><span class="nv">rray</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>\<span class="nv">array_filter</span><span class="ss">(</span><span class="mh">$a</span><span class="nv">rray</span>,<span class="w"> </span><span class="nv">static</span><span class="w"> </span><span class="nv">function</span><span class="w"> </span><span class="ss">(</span><span class="mh">$e</span><span class="nv">lement</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mh">$e</span><span class="nv">lement</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s2">"b"</span><span class="c1">;</span>
<span class="w">    </span><span class="o">//</span><span class="w">                   </span>↑
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="nv">Array</span><span class="w"> </span><span class="nv">value</span><span class="w"> </span><span class="nv">which</span><span class="w"> </span><span class="nv">you</span><span class="w"> </span><span class="nv">want</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">delete</span>
}<span class="ss">)</span><span class="c1">;</span>
</pre></div>

<p>输出：</p>
<div class="code"><pre class="code literal-block">[
    [0] =&gt; a
    [1] =&gt; c
]
</pre></div>

<p><br></p>
<h3>更多建议</h3>
<p>应该注意的是，<code>unset()</code>它将保持索引不变，这是您在使用字符串索引（数组作为哈希表）时所期望的，但在处理整数索引数组时可能会非常令人惊讶：</p>
<div class="code"><pre class="code literal-block"><span class="o">$</span><span class="n">array</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">array</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="n">unset</span><span class="p">(</span><span class="o">$</span><span class="n">array</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
<span class="n">var_dump</span><span class="p">(</span><span class="o">$</span><span class="n">array</span><span class="p">);</span>
<span class="o">/*</span><span class="w"> </span><span class="n">array</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=&gt;</span>
<span class="w">  </span><span class="nb nb-Type">int</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="w">  </span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=&gt;</span>
<span class="w">  </span><span class="nb nb-Type">int</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">  </span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">=&gt;</span>
<span class="w">  </span><span class="nb nb-Type">int</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="p">}</span><span class="w"> </span><span class="o">*/</span>

<span class="o">$</span><span class="n">array</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">array</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="n">array_splice</span><span class="p">(</span><span class="o">$</span><span class="n">array</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="n">var_dump</span><span class="p">(</span><span class="o">$</span><span class="n">array</span><span class="p">);</span>
<span class="o">/*</span><span class="w"> </span><span class="n">array</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=&gt;</span>
<span class="w">  </span><span class="nb nb-Type">int</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="w">  </span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=&gt;</span>
<span class="w">  </span><span class="nb nb-Type">int</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">  </span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">=&gt;</span>
<span class="w">  </span><span class="nb nb-Type">int</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="p">}</span><span class="w"> </span><span class="o">*/</span>
</pre></div>

<p><code>array_splice()</code>如果您想标准化整数键，可以使用So。另一种选择是使用<code>array_values()</code>after <code>unset()</code>：</p>
<div class="code"><pre class="code literal-block"><span class="o">$</span><span class="n">array</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">array</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>

<span class="n">unset</span><span class="p">(</span><span class="o">$</span><span class="n">array</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
<span class="o">$</span><span class="n">array</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">array_values</span><span class="p">(</span><span class="o">$</span><span class="n">array</span><span class="p">);</span>
<span class="n">var_dump</span><span class="p">(</span><span class="o">$</span><span class="n">array</span><span class="p">);</span>
<span class="o">/*</span><span class="w"> </span><span class="n">array</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=&gt;</span>
<span class="w">  </span><span class="nb nb-Type">int</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="w">  </span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=&gt;</span>
<span class="w">  </span><span class="nb nb-Type">int</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">  </span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">=&gt;</span>
<span class="w">  </span><span class="nb nb-Type">int</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="p">}</span><span class="w"> </span><span class="o">*/</span>
</pre></div>

<p><br><br><a href="posts/deleting-an-element-from-an-array-in-php/">查看原文</a></p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/ru-he-jiang-lie-biao-chai-fen-wei-da-xiao-xiang-deng-de-kuai/" class="u-url">如何将列表拆分为大小相等的块？</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/ru-he-jiang-lie-biao-chai-fen-wei-da-xiao-xiang-deng-de-kuai/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-16T20:17:47+08:00" itemprop="datePublished" title="2023-02-16 20:17">2023-02-16 20:17</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>如何将任意长度的列表拆分为大小相等的块？</p>
<hr>
<p>如果数据结果将直接用于循环并且不需要存储，请参阅如何以块为单位迭代列表。</p>
<p>对于与字符串输入相同的问题，请参阅每第 n 个字符拆分字符串？. 尽管有一些变化，但通常适用相同的技术。</p>
<p><br><br></p>
<h2>解答</h2>
<p>这是一个生成大小均匀的块的生成器：</p>
<div class="code"><pre class="code literal-block"><span class="k">def</span> <span class="nf">chunks</span><span class="p">(</span><span class="n">lst</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Yield successive n-sized chunks from lst."""</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">lst</span><span class="p">),</span> <span class="n">n</span><span class="p">):</span>
        <span class="k">yield</span> <span class="n">lst</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">n</span><span class="p">]</span>



<span class="kn">import</span> <span class="nn">pprint</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">chunks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">75</span><span class="p">),</span> <span class="mi">10</span><span class="p">)))</span>
<span class="p">[[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">],</span>
 <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">29</span><span class="p">],</span>
 <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="mi">39</span><span class="p">],</span>
 <span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">49</span><span class="p">],</span>
 <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">59</span><span class="p">],</span>
 <span class="p">[</span><span class="mi">60</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">69</span><span class="p">],</span>
 <span class="p">[</span><span class="mi">70</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">74</span><span class="p">]]</span>
</pre></div>

<p>对于 Python 2，使用<code>xrange</code>而不是<code>range</code>：</p>
<div class="code"><pre class="code literal-block"><span class="nv">def</span><span class="w"> </span><span class="nv">chunks</span><span class="ss">(</span><span class="nv">lst</span>,<span class="w"> </span><span class="nv">n</span><span class="ss">)</span>:
<span class="w">    </span><span class="s2">"""Yield successive n-sized chunks from lst."""</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">xrange</span><span class="ss">(</span><span class="mi">0</span>,<span class="w"> </span><span class="nv">len</span><span class="ss">(</span><span class="nv">lst</span><span class="ss">)</span>,<span class="w"> </span><span class="nv">n</span><span class="ss">)</span>:
<span class="w">        </span><span class="nv">yield</span><span class="w"> </span><span class="nv">lst</span>[<span class="nv">i</span>:<span class="nv">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nv">n</span>]
</pre></div>

<hr>
<p>下面是一个列表理解单行。不过，上面的方法更可取，因为使用命名函数可以使代码更容易理解。对于 Python 3：</p>
<div class="code"><pre class="code literal-block">[<span class="nv">lst</span>[<span class="nv">i</span>:<span class="nv">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nv">n</span>]<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">range</span><span class="ss">(</span><span class="mi">0</span>,<span class="w"> </span><span class="nv">len</span><span class="ss">(</span><span class="nv">lst</span><span class="ss">)</span>,<span class="w"> </span><span class="nv">n</span><span class="ss">)</span>]
</pre></div>

<p>对于 Python 2：</p>
<div class="code"><pre class="code literal-block">[<span class="nv">lst</span>[<span class="nv">i</span>:<span class="nv">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nv">n</span>]<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">xrange</span><span class="ss">(</span><span class="mi">0</span>,<span class="w"> </span><span class="nv">len</span><span class="ss">(</span><span class="nv">lst</span><span class="ss">)</span>,<span class="w"> </span><span class="nv">n</span><span class="ss">)</span>]
</pre></div>

<p><br></p>
<h3>更多建议</h3>
<p>超级简单的东西：</p>
<div class="code"><pre class="code literal-block"><span class="nv">def</span><span class="w"> </span><span class="nv">chunks</span><span class="ss">(</span><span class="nv">xs</span>,<span class="w"> </span><span class="nv">n</span><span class="ss">)</span>:
<span class="w">    </span><span class="nv">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">max</span><span class="ss">(</span><span class="mi">1</span>,<span class="w"> </span><span class="nv">n</span><span class="ss">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="ss">(</span><span class="nv">xs</span>[<span class="nv">i</span>:<span class="nv">i</span><span class="o">+</span><span class="nv">n</span>]<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">range</span><span class="ss">(</span><span class="mi">0</span>,<span class="w"> </span><span class="nv">len</span><span class="ss">(</span><span class="nv">xs</span><span class="ss">)</span>,<span class="w"> </span><span class="nv">n</span><span class="ss">))</span>
</pre></div>

<p>对于 Python 2，使用<code>xrange()</code>而不是<code>range()</code>.</p>
<p><br><br><a href="posts/how-do-i-split-a-list-into-equally-sized-chunks/">查看原文</a></p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-70.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-68.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
