<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 1954) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-1954.html">
<link rel="prev" href="index-1955.html" type="text/html">
<link rel="next" href="index-1953.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/why-aren-t-variable-length-arrays-part-of-the-c-standard/" class="u-url">Why aren't variable-length arrays part of the C++ standard?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/why-aren-t-variable-length-arrays-part-of-the-c-standard/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T13:22:26+08:00" itemprop="datePublished" title="2023-03-03 13:22">2023-03-03 13:22</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I haven't used C very much in the last few years. When I read this question
today I came across some C syntax which I wasn't familiar with.</p>
<p>Apparently in C99 the following syntax is valid:</p>
<div class="code"><pre class="code literal-block"><span class="n">void</span><span class="w"> </span><span class="n">foo</span><span class="p">(</span><span class="nc">int</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="nc">int</span><span class="w"> </span><span class="k">values</span><span class="o">[</span><span class="n">n</span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="o">//</span><span class="k">Declare</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">variable</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="k">array</span>
<span class="err">}</span>
</pre></div>

<p>This seems like a pretty useful feature. Was there ever a discussion about
adding it to the C++ standard, and if so, why it was omitted?</p>
<p>Some potential reasons:</p>
<ul>
<li>Hairy for compiler vendors to implement</li>
<li>Incompatible with some other part of the standard</li>
<li>Functionality can be emulated with other C++ constructs</li>
</ul>
<p>The C++ standard states that array size must be a constant expression
(8.3.4.1).</p>
<p>Yes, of course I realize that in the toy example one could use
<code>std::vector&lt;int&gt; values(m);</code>, but this allocates memory from the heap and not
the stack. And if I want a multidimensional array like:</p>
<div class="code"><pre class="code literal-block"><span class="n">void</span><span class="w"> </span><span class="n">foo</span><span class="p">(</span><span class="nc">int</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="nc">int</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="nc">int</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="nc">int</span><span class="w"> </span><span class="k">values</span><span class="o">[</span><span class="n">x</span><span class="o">][</span><span class="n">y</span><span class="o">][</span><span class="n">z</span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="k">Declare</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">variable</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="k">array</span>
<span class="err">}</span>
</pre></div>

<p>the <code>vector</code> version becomes pretty clumsy:</p>
<div class="code"><pre class="code literal-block">void foo(int x, int y, int z) {
    vector&lt; vector&lt; vector&lt;int&gt; &gt; &gt; values( /* Really painful expression here. */);
}
</pre></div>

<p>The slices, rows and columns will also potentially be spread all over memory.</p>
<p>Looking at the discussion at <code>comp.std.c++</code> it's clear that this question is
pretty controversial with some very heavyweight names on both sides of the
argument. It's certainly not obvious that a <code>std::vector</code> is always a better
solution.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>There recently was a discussion about this kicked off in usenet: Why no VLAs
in C++0x.</p>
<p>I agree with those people that seem to agree that having to create a potential
large array on the stack, which usually has only little space available, isn't
good. The argument is, if you know the size beforehand, you can use a static
array. And if you don't know the size beforehand, you will write unsafe code.</p>
<p>C99 VLAs could provide a small benefit of being able to create small arrays
without wasting space or calling constructors for unused elements, but they
will introduce rather large changes to the type system (you need to be able to
specify types depending on runtime values - this does not yet exist in current
C++, except for <code>new</code> operator type-specifiers, but they are treated
specially, so that the runtime-ness doesn't escape the scope of the <code>new</code>
operator).</p>
<p>You can use <code>std::vector</code>, but it is not quite the same, as it uses dynamic
memory, and making it use one's own stack-allocator isn't exactly easy
(alignment is an issue, too). It also doesn't solve the same problem, because
a vector is a resizable container, whereas VLAs are fixed-size. The C++
Dynamic Array proposal is intended to introduce a library based solution, as
alternative to a language based VLA. However, it's not going to be part of
C++0x, as far as I know.</p>
<p><br></p>
<h3>Suggest</h3>
<p>There recently was a discussion about this kicked off in usenet: Why no VLAs
in C++0x.</p>
<p>I agree with those people that seem to agree that having to create a potential
large array on the stack, which usually has only little space available, isn't
good. The argument is, if you know the size beforehand, you can use a static
array. And if you don't know the size beforehand, you will write unsafe code.</p>
<p>C99 VLAs could provide a small benefit of being able to create small arrays
without wasting space or calling constructors for unused elements, but they
will introduce rather large changes to the type system (you need to be able to
specify types depending on runtime values - this does not yet exist in current
C++, except for <code>new</code> operator type-specifiers, but they are treated
specially, so that the runtime-ness doesn't escape the scope of the <code>new</code>
operator).</p>
<p>You can use <code>std::vector</code>, but it is not quite the same, as it uses dynamic
memory, and making it use one's own stack-allocator isn't exactly easy
(alignment is an issue, too). It also doesn't solve the same problem, because
a vector is a resizable container, whereas VLAs are fixed-size. The C++
Dynamic Array proposal is intended to introduce a library based solution, as
alternative to a language based VLA. However, it's not going to be part of
C++0x, as far as I know.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/python-list-vs-array-when-to-use/" class="u-url">Python list vs. array – when to use?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/python-list-vs-array-when-to-use/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T13:22:03+08:00" itemprop="datePublished" title="2023-03-03 13:22">2023-03-03 13:22</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>If you are creating a 1d array, you can implement it as a list, or else use
the 'array' module in the standard library. I have always used lists for 1d
arrays.</p>
<p>What is the reason or circumstance where I would want to use the array module
instead?</p>
<p>Is it for performance and memory optimization, or am I missing something
obvious?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Basically, Python lists are very flexible and can hold completely
heterogeneous, arbitrary data, and they can be appended to very efficiently,
in amortized constant time. If you need to shrink and grow your list time-
efficiently and without hassle, they are the way to go. But they use <strong>a lot
more space than C arrays</strong> , in part because each item in the list requires
the construction of an individual Python object, even for data that could be
represented with simple C types (e.g. <code>float</code> or <code>uint64_t</code>).</p>
<p>The <code>array.array</code> type, on the other hand, is just a thin wrapper on C arrays.
It can hold only homogeneous data (that is to say, all of the same type) and
so it uses only <code>sizeof(one object) * length</code> bytes of memory. Mostly, you
should use it when you need to expose a C array to an extension or a system
call (for example, <code>ioctl</code> or <code>fctnl</code>).</p>
<p><code>array.array</code> is also a reasonable way to represent a <strong>mutable</strong> string in
Python 2.x (<code>array('B', bytes)</code>). However, Python 2.6+ and 3.x offer a mutable
<em>byte</em> string as <code>bytearray</code>.</p>
<p>However, if you want to do <strong>math</strong> on a homogeneous array of numeric data,
then you're much better off using NumPy, which can automatically vectorize
operations on complex multi-dimensional arrays.</p>
<p><strong>To make a long story short</strong> : <code>array.array</code> is useful when you need a
homogeneous C array of data for reasons <em>other than doing math</em>.</p>
<p><br></p>
<h3>Suggest</h3>
<p>For almost all cases the normal list is the right choice. The arrays module is
more like a thin wrapper over C arrays, which give you kind of strongly typed
containers (see docs), with access to more C-like types such as
signed/unsigned short or double, which are not part of the built-in types. I'd
say use the arrays module only if you really need it, in all other cases stick
with lists.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/does-python-support-short-circuiting/" class="u-url">Does Python support short-circuiting?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/does-python-support-short-circuiting/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T13:21:42+08:00" itemprop="datePublished" title="2023-03-03 13:21">2023-03-03 13:21</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Does Python support short-circuiting in boolean expressions?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Yep, both <code>and</code> and <code>or</code> operators short-circuit -- see the docs.</p>
<p><br></p>
<h3>Suggest</h3>
<h4>Short-circuiting behavior in operator <code>and</code>, <code>or</code>:</h4>
<p>Let's first define a useful function to determine if something is executed or
not. A simple function that accepts an argument, prints a message and returns
the input, unchanged.</p>
<div class="code"><pre class="code literal-block"><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="nv">def</span><span class="w"> </span><span class="nv">fun</span><span class="ss">(</span><span class="nv">i</span><span class="ss">)</span>:
...<span class="w">     </span><span class="nv">print</span><span class="w"> </span><span class="s2">"executed"</span>
...<span class="w">     </span><span class="k">return</span><span class="w"> </span><span class="nv">i</span>
...
</pre></div>

<p>One can observe the Python's short-circuiting behavior of <code>and</code>, <code>or</code>
operators in the following example:</p>
<div class="code"><pre class="code literal-block">&gt;&gt;&gt; fun(1)
executed
1
&gt;&gt;&gt; 1 or fun(1)    # due to short-circuiting  "executed" not printed
1
&gt;&gt;&gt; 1 and fun(1)   # fun(1) called and "executed" printed 
executed
1
&gt;&gt;&gt; 0 and fun(1)   # due to short-circuiting  "executed" not printed 
0
</pre></div>

<p><strong>Note:</strong> The following values are considered by the interpreter to mean
false:</p>
<div class="code"><pre class="code literal-block">        False    None    0    ""    ()    []     {}
</pre></div>

<h4>Short-circuiting behavior in function: <code>any()</code>, <code>all()</code>:</h4>
<p>Python's <code>any()</code> and <code>all()</code> functions also support short-circuiting. As shown
in the docs; they evaluate each element of a sequence in-order, until finding
a result that allows an early exit in the evaluation. Consider examples below
to understand both.</p>
<p>The function <code>any()</code> checks if any element is True. It stops executing as soon
as a True is encountered and returns True.</p>
<div class="code"><pre class="code literal-block"><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="nv">any</span><span class="ss">(</span><span class="nv">fun</span><span class="ss">(</span><span class="nv">i</span><span class="ss">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span>[<span class="mi">1</span>,<span class="w"> </span><span class="mi">2</span>,<span class="w"> </span><span class="mi">3</span>,<span class="w"> </span><span class="mi">4</span>]<span class="ss">)</span><span class="w">   </span>#<span class="w"> </span><span class="nv">bool</span><span class="ss">(</span><span class="mi">1</span><span class="ss">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">True</span>
<span class="nv">executed</span>
<span class="nv">True</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="nv">any</span><span class="ss">(</span><span class="nv">fun</span><span class="ss">(</span><span class="nv">i</span><span class="ss">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span>[<span class="mi">0</span>,<span class="w"> </span><span class="mi">2</span>,<span class="w"> </span><span class="mi">3</span>,<span class="w"> </span><span class="mi">4</span>]<span class="ss">)</span><span class="w">   </span>
<span class="nv">executed</span><span class="w">                               </span>#<span class="w"> </span><span class="nv">bool</span><span class="ss">(</span><span class="mi">0</span><span class="ss">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">False</span>
<span class="nv">executed</span><span class="w">                               </span>#<span class="w"> </span><span class="nv">bool</span><span class="ss">(</span><span class="mi">2</span><span class="ss">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">True</span>
<span class="nv">True</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="nv">any</span><span class="ss">(</span><span class="nv">fun</span><span class="ss">(</span><span class="nv">i</span><span class="ss">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span>[<span class="mi">0</span>,<span class="w"> </span><span class="mi">0</span>,<span class="w"> </span><span class="mi">3</span>,<span class="w"> </span><span class="mi">4</span>]<span class="ss">)</span>
<span class="nv">executed</span>
<span class="nv">executed</span>
<span class="nv">executed</span>
<span class="nv">True</span>
</pre></div>

<p>The function <code>all()</code> checks all elements are True and stops executing as soon
as a False is encountered:</p>
<div class="code"><pre class="code literal-block"><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="nv">all</span><span class="ss">(</span><span class="nv">fun</span><span class="ss">(</span><span class="nv">i</span><span class="ss">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span>[<span class="mi">0</span>,<span class="w"> </span><span class="mi">0</span>,<span class="w"> </span><span class="mi">3</span>,<span class="w"> </span><span class="mi">4</span>]<span class="ss">)</span>
<span class="nv">executed</span>
<span class="nv">False</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="nv">all</span><span class="ss">(</span><span class="nv">fun</span><span class="ss">(</span><span class="nv">i</span><span class="ss">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span>[<span class="mi">1</span>,<span class="w"> </span><span class="mi">0</span>,<span class="w"> </span><span class="mi">3</span>,<span class="w"> </span><span class="mi">4</span>]<span class="ss">)</span>
<span class="nv">executed</span>
<span class="nv">executed</span>
<span class="nv">False</span>
</pre></div>

<h4>Short-circuiting behavior in Chained Comparison:</h4>
<p>Additionally, in Python</p>
<blockquote>
<p>Comparisons can be chained arbitrarily; for example, <code>x &lt; y &lt;= z</code> is
equivalent to <code>x &lt; y and y &lt;= z</code>, except that <code>y</code> is evaluated only once
(but in both cases <code>z</code> is not evaluated at all when <code>x &lt; y</code> is found to be
false).</p>
</blockquote>
<div class="code"><pre class="code literal-block">&gt;&gt;&gt; 5 &gt; 6 &gt; fun(3)    # same as:  5 &gt; 6 and 6 &gt; fun(3)
False                 # 5 &gt; 6 is False so fun() not called and "executed" NOT printed
&gt;&gt;&gt; 5 &lt; 6 &gt; fun(3)    # 5 &lt; 6 is True 
executed              # fun(3) called and "executed" printed
True
&gt;&gt;&gt; 4 &lt;= 6 &gt; fun(7)   # 4 &lt;= 6 is True  
executed              # fun(3) called and "executed" printed
False
&gt;&gt;&gt; 5 &lt; fun(6) &lt; 3    # only prints "executed" once
executed
False
&gt;&gt;&gt; 5 &lt; fun(6) and fun(6) &lt; 3 # prints "executed" twice, because the second part executes it again
executed
executed
False
</pre></div>

<p><strong>Edit:</strong><br>
One more interesting point to note <strong>:-</strong> Logical <code>and</code>, <code>or</code> operators in
Python returns an operand's <strong>value</strong> instead of a Boolean (<code>True</code> or
<code>False</code>). For example:</p>
<blockquote>
<p>Operation <code>x and y</code> gives the result <code>if x is false, then x, else y</code></p>
</blockquote>
<p>Unlike in other languages e.g. <code>&amp;&amp;</code>, <code>||</code> operators in C that return either 0
or 1.</p>
<p>Examples:</p>
<div class="code"><pre class="code literal-block">&gt;&gt;&gt; 3 and 5    # Second operand evaluated and returned 
5                   
&gt;&gt;&gt; 3  and ()
()
&gt;&gt;&gt; () and 5   # Second operand NOT evaluated as first operand () is  false
()             # so first operand returned
</pre></div>

<p>Similarly <code>or</code> operator return left most value for which <code>bool(value)</code> ==
<code>True</code> else right most false value (according to short-circuiting behavior),
examples:</p>
<div class="code"><pre class="code literal-block">&gt;&gt;&gt; 2 or 5    # left most operand bool(2) == True
2    
&gt;&gt;&gt; 0 or 5    # bool(0) == False and bool(5) == True
5
&gt;&gt;&gt; 0 or ()
()
</pre></div>

<p>So, how is this useful? One example is given in Practical Python By Magnus Lie
Hetland:<br>
Let’s say a user is supposed to enter his or her name, but may opt to enter
nothing, in which case you want to use the default value <code>'&lt;Unknown&gt;'</code>. You
could use an if statement, but you could also state things very succinctly:</p>
<div class="code"><pre class="code literal-block">In [171]: name = raw_input('Enter Name: ') or '&lt;Unknown&gt;'
Enter Name:

In [172]: name
Out[172]: '&lt;Unknown&gt;'
</pre></div>

<p>In other words, if the return value from <code>raw_input</code> is true (not an empty
string), it is assigned to name (nothing changes); otherwise, the default
<code>'&lt;Unknown&gt;'</code> is assigned to <code>name</code>.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-1955.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-1953.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
