<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 1639) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-1639.html">
<link rel="prev" href="index-1640.html" type="text/html">
<link rel="next" href="index-1638.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/android-basics-running-code-in-the-ui-thread/" class="u-url">Android basics: running code in the UI thread</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/android-basics-running-code-in-the-ui-thread/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T05:48:52+08:00" itemprop="datePublished" title="2023-03-03 05:48">2023-03-03 05:48</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>In the viewpoint of running code in the UI thread, is there any difference
between:</p>
<div class="code"><pre class="code literal-block">MainActivity.this.runOnUiThread(new Runnable() {
    public void run() {
        Log.d("UI thread", "I am the UI thread");
    }
});
</pre></div>

<p>or</p>
<div class="code"><pre class="code literal-block">MainActivity.this.myView.post(new Runnable() {
    public void run() {
        Log.d("UI thread", "I am the UI thread");
    }
});
</pre></div>

<p>and</p>
<div class="code"><pre class="code literal-block"><span class="n">private</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">BackgroundTask</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="n">AsyncTask</span><span class="o">&lt;</span><span class="nb nb-Type">String</span><span class="p">,</span><span class="w"> </span><span class="n">Void</span><span class="p">,</span><span class="w"> </span><span class="n">Bitmap</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">protected</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="w"> </span><span class="n">onPostExecute</span><span class="p">(</span><span class="n">Bitmap</span><span class="w"> </span><span class="n">result</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Log</span><span class="o">.</span><span class="n">d</span><span class="p">(</span><span class="s2">"UI thread"</span><span class="p">,</span><span class="w"> </span><span class="s2">"I am the UI thread"</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<p>None of those are precisely the same, though they will all have the same net
effect.</p>
<p>The difference between the first and the second is that if you happen to be
<em>on</em> the main application thread when executing the code, the first one
(<code>runOnUiThread()</code>) will execute the <code>Runnable</code> immediately. The second one
(<code>post()</code>) always puts the <code>Runnable</code> at the end of the event queue, even if
you are already on the main application thread.</p>
<p>The third one, assuming you create and execute an instance of
<code>BackgroundTask</code>, will waste a lot of time grabbing a thread out of the thread
pool, to execute a default no-op <code>doInBackground()</code>, before eventually doing
what amounts to a <code>post()</code>. This is by far the least efficient of the three.
Use <code>AsyncTask</code> if you actually have work to do in a background thread, not
just for the use of <code>onPostExecute()</code>.</p>
<p><br></p>
<h3>Suggest</h3>
<p>I like the one from HPP comment, it can be used anywhere without any
parameter:</p>
<div class="code"><pre class="code literal-block"><span class="k">new</span><span class="w"> </span><span class="n">Handler</span><span class="p">(</span><span class="n">Looper</span><span class="p">.</span><span class="n">getMainLooper</span><span class="p">()).</span><span class="n">post</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Runnable</span><span class="p">()</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="nv">@Override</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="n">run</span><span class="p">()</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="nf">Log</span><span class="p">.</span><span class="n">d</span><span class="p">(</span><span class="ss">"UI thread"</span><span class="p">,</span><span class="w"> </span><span class="ss">"I am the UI thread"</span><span class="p">);</span>
<span class="w">    </span><span class="err">}</span>
<span class="err">}</span><span class="p">);</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-does-free-know-how-much-to-free/" class="u-url">How does free know how much to free?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-does-free-know-how-much-to-free/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T05:48:29+08:00" itemprop="datePublished" title="2023-03-03 05:48">2023-03-03 05:48</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>In C programming, you can pass any kind of pointer you like as an argument to
free, how does it know the size of the allocated memory to free? Whenever I
pass a pointer to some function, I have to also pass the size (ie an array of
10 elements needs to receive 10 as a parameter to know the size of the array),
but I do not have to pass the size to the free function. Why not, and can I
use this same technique in my own functions to save me from needing to cart
around the extra variable of the array's length?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>When you call <code>malloc()</code>, you specify the amount of memory to allocate. The
amount of memory actually used is slightly more than this, and includes extra
information that records (at least) how big the block is. You can't (reliably)
access that other information - and nor should you :-).</p>
<p>When you call <code>free()</code>, it simply looks at the extra information to find out
how big the block is.</p>
<p><br></p>
<h3>Suggest</h3>
<p>Most implementations of C memory allocation functions will store accounting
information for each block, either in-line or separately.</p>
<p>One typical way (in-line) is to actually allocate both a header and the memory
you asked for, padded out to some minimum size. So for example, if you asked
for 20 bytes, the system may allocate a 48-byte block:</p>
<ul>
<li>16-byte header containing size, special marker, checksum, pointers to next/previous block and so on.</li>
<li>32 bytes data area (your 20 bytes padded out to a multiple of 16).</li>
</ul>
<p>The address then given to you is the address of the data area. Then, when you
free the block, <code>free</code> will simply take the address you give it and, assuming
you haven't stuffed up that address or the memory around it, check the
accounting information immediately before it. Graphically, that would be along
the lines of:</p>
<div class="code"><pre class="code literal-block"><span class="c"> ____ The allocated block ____</span>
<span class="c">/                             \</span>
<span class="nb">+--------+--------------------+</span>
<span class="c">| Header | Your data area </span><span class="nt">...</span><span class="c"> |</span>
<span class="nb">+--------+--------------------+</span>
<span class="c">          ^</span>
<span class="c">          |</span>
<span class="c">          </span><span class="nb">+--</span><span class="c"> The address you are given</span>
</pre></div>

<p>Keep in mind the size of the header and the padding are totally implementation
defined (actually, the entire thing is implementation-defined (a) but the in-
line accounting option is a common one).</p>
<p>The checksums and special markers that exist in the accounting information are
often the cause of errors like "Memory arena corrupted" or "Double free" if
you overwrite them or free them twice.</p>
<p>The padding (to make allocation more efficient) is why you can sometimes write
a little bit beyond the end of your requested space without causing problems
(still, don't do that, it's undefined behaviour and, just because it works
sometimes, doesn't mean it's okay to do it).</p>
<hr>
<p>(a) I've written implementations of <code>malloc</code> in embedded systems where you got
128 bytes no matter what you asked for (that was the size of the largest
structure in the system), assuming you asked for 128 bytes or less (requests
for more would be met with a NULL return value). A very simple bit-mask (i.e.,
not in-line) was used to decide whether a 128-byte chunk was allocated or not.</p>
<p>Others I've developed had different pools for 16-byte chunks, 64-bytes chunks,
256-byte chunks and 1K chunks, again using a bit-mask to decide what blocks
were used or available.</p>
<p>Both these options managed to reduce the overhead of the accounting
information and to increase the speed of <code>malloc</code> and <code>free</code> (no need to
coalesce adjacent blocks when freeing), particularly important in the
environment we were working in.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/what-is-the-convention-for-word-separator-in-java-package-names/" class="u-url">What is the convention for word separator in Java package names?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/what-is-the-convention-for-word-separator-in-java-package-names/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T05:48:05+08:00" itemprop="datePublished" title="2023-03-03 05:48">2023-03-03 05:48</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>How should one separate words in package names? Which of the following are
correct?</p>
<ol>
<li>
<code>com.stackoverflow.my_package</code> (<code>Snake Case</code> using underscore)</li>
<li>
<code>com.stackoverflow.my-package</code> (<code>Kebab Case</code> using hyphens)</li>
<li>
<code>com.stackoverflow.myPackage</code> (<code>Camel Case</code>)</li>
<li>
<code>com.stackoverflow.MyPackage</code> (<code>Pascal Case</code>)</li>
</ol>
<p>What is the general standard?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Here's what the official naming conventions document prescribes:</p>
<blockquote>
<h4>Packages</h4>
<p>The prefix of a unique package name is always written in all-lowercase ASCII
letters and should be one of the top-level domain names, currently <code>com</code>,
<code>edu</code>, <code>gov</code>, <code>mil</code>, <code>net</code>, <code>org</code>, or one of the English two-letter codes
identifying countries as specified in ISO Standard 3166, 1981.</p>
<p>Subsequent components of the package name vary according to an
organization's own internal naming conventions. Such conventions might
specify that certain directory name components be division, department,
project, machine, or login names.</p>
<h4>Examples</h4>
<ul>
<li><code>com.sun.eng</code></li>
<li><code>com.apple.quicktime.v2</code></li>
<li>
<code>edu.cmu.cs.bovik.cheese</code>
</li>
</ul>
</blockquote>
<h4>References</h4>
<ul>
<li>java.sun.com - Code Conventions/Naming</li>
</ul>
<hr>
<p>Note that in particular, anything following the top-level domain prefix isn't
specified by the above document. The JLS also agrees with this by giving the
following examples:</p>
<blockquote>
<ul>
<li><code>com.sun.sunsoft.DOE</code></li>
<li><code>gov.whitehouse.socks.mousefinder</code></li>
<li><code>com.JavaSoft.jag.Oak</code></li>
<li><code>org.npr.pledge.driver</code></li>
<li>
<code>uk.ac.city.rugby.game</code>
</li>
</ul>
</blockquote>
<p>The following excerpt is also relevant:</p>
<blockquote>
<p>In some cases, the internet domain name may not be a valid package name.
Here are some suggested conventions for dealing with these situations:</p>
<ul>
<li>If the domain name contains a hyphen, or any other special character not
allowed in an identifier, convert it into an underscore.</li>
<li>If any of the resulting package name components are keywords then append
underscore to them.</li>
<li>If any of the resulting package name components start with a digit, or
any other character that is not allowed as an initial character of an
identifier, have an underscore prefixed to the component.
</li>
</ul>
</blockquote>
<h4>References</h4>
<ul>
<li>JLS 6.1 Package Names</li>
</ul>
<p><br></p>
<h3>Suggest</h3>
<p>Here's what the official naming conventions document prescribes:</p>
<blockquote>
<h4>Packages</h4>
<p>The prefix of a unique package name is always written in all-lowercase ASCII
letters and should be one of the top-level domain names, currently <code>com</code>,
<code>edu</code>, <code>gov</code>, <code>mil</code>, <code>net</code>, <code>org</code>, or one of the English two-letter codes
identifying countries as specified in ISO Standard 3166, 1981.</p>
<p>Subsequent components of the package name vary according to an
organization's own internal naming conventions. Such conventions might
specify that certain directory name components be division, department,
project, machine, or login names.</p>
<h4>Examples</h4>
<ul>
<li><code>com.sun.eng</code></li>
<li><code>com.apple.quicktime.v2</code></li>
<li>
<code>edu.cmu.cs.bovik.cheese</code>
</li>
</ul>
</blockquote>
<h4>References</h4>
<ul>
<li>java.sun.com - Code Conventions/Naming</li>
</ul>
<hr>
<p>Note that in particular, anything following the top-level domain prefix isn't
specified by the above document. The JLS also agrees with this by giving the
following examples:</p>
<blockquote>
<ul>
<li><code>com.sun.sunsoft.DOE</code></li>
<li><code>gov.whitehouse.socks.mousefinder</code></li>
<li><code>com.JavaSoft.jag.Oak</code></li>
<li><code>org.npr.pledge.driver</code></li>
<li>
<code>uk.ac.city.rugby.game</code>
</li>
</ul>
</blockquote>
<p>The following excerpt is also relevant:</p>
<blockquote>
<p>In some cases, the internet domain name may not be a valid package name.
Here are some suggested conventions for dealing with these situations:</p>
<ul>
<li>If the domain name contains a hyphen, or any other special character not
allowed in an identifier, convert it into an underscore.</li>
<li>If any of the resulting package name components are keywords then append
underscore to them.</li>
<li>If any of the resulting package name components start with a digit, or
any other character that is not allowed as an initial character of an
identifier, have an underscore prefixed to the component.
</li>
</ul>
</blockquote>
<h4>References</h4>
<ul>
<li>JLS 6.1 Package Names</li>
</ul>
</div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-1640.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-1638.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
