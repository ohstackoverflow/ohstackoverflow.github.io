<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 1173) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-1173.html">
<link rel="prev" href="index-1174.html" type="text/html">
<link rel="next" href="index-1172.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-sort-pandas-dataframe-from-one-column/" class="u-url">how to sort pandas dataframe from one column</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-sort-pandas-dataframe-from-one-column/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T02:58:53+08:00" itemprop="datePublished" title="2023-02-18 02:58">2023-02-18 02:58</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I have a data frame like this:</p>
<div class="code"><pre class="code literal-block">print(df)

        0          1     2
0   354.7      April   4.0
1    55.4     August   8.0
2   176.5   December  12.0
3    95.5   February   2.0
4    85.6    January   1.0
5     152       July   7.0
6   238.7       June   6.0
7   104.8      March   3.0
8   283.5        May   5.0
9   278.8   November  11.0
10  249.6    October  10.0
11  212.7  September   9.0
</pre></div>

<p>As you can see, months are not in calendar order. So I created a second column
to get the month number corresponding to each month (1-12). From there, how
can I sort this data frame according to calendar months' order?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Use <code>sort_values</code> to sort the df by a specific column's values:</p>
<div class="code"><pre class="code literal-block">In [18]:
df.sort_values('2')

Out[18]:
        0          1     2
4    85.6    January   1.0
3    95.5   February   2.0
7   104.8      March   3.0
0   354.7      April   4.0
8   283.5        May   5.0
6   238.7       June   6.0
5   152.0       July   7.0
1    55.4     August   8.0
11  212.7  September   9.0
10  249.6    October  10.0
9   278.8   November  11.0
2   176.5   December  12.0
</pre></div>

<p>If you want to sort by two columns, pass a list of column labels to
<code>sort_values</code> with the column labels ordered according to sort priority. If
you use <code>df.sort_values(['2', '0'])</code>, the result would be sorted by column <code>2</code>
then column <code>0</code>. Granted, this does not really make sense for this example
because each value in <code>df['2']</code> is unique.</p>
<p><br></p>
<h3>Suggest</h3>
<p>I tried the solutions above and I do not achieve results, so I found a
different solution that works for me. The <code>ascending=False</code> is to order the
dataframe in <strong>descending</strong> order, <strong>by default it is<code>True</code></strong>. I am using
python 3.6.6 and pandas 0.23.4 versions.</p>
<div class="code"><pre class="code literal-block">final_df = df.sort_values(by=['2'], ascending=False)
</pre></div>

<p>You can see more details in pandas documentation here.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/what-is-the-difference-between-a-strongly-typed-language-and-a-statically-typed-language/" class="u-url">What is the difference between a strongly typed language and a statically typed language?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/what-is-the-difference-between-a-strongly-typed-language-and-a-statically-typed-language/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T02:58:28+08:00" itemprop="datePublished" title="2023-02-18 02:58">2023-02-18 02:58</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Also, does one imply the other?</p>
<p><br><br></p>
<h2>Answer</h2>
<blockquote>
<p>What is the difference between a strongly typed language and a statically
typed language?</p>
</blockquote>
<p>A statically typed language has a type system that is checked at compile time
by the implementation (a compiler or interpreter). The type check rejects some
programs, and programs that pass the check usually come with some guarantees;
for example, the compiler guarantees not to use integer arithmetic
instructions on floating-point numbers.</p>
<p>There is no real agreement on what "strongly typed" means, although the most
widely used definition in the professional literature is that in a "strongly
typed" language, it is not possible for the programmer to work around the
restrictions imposed by the type system. This term is almost always used to
describe statically typed languages.</p>
<h3>Static vs dynamic</h3>
<p>The opposite of statically typed is "dynamically typed", which means that</p>
<ol>
<li>Values used at run time are classified into types.</li>
<li>There are restrictions on how such values can be used.</li>
<li>When those restrictions are violated, the violation is reported as a (dynamic) type error.</li>
</ol>
<p>For example, Lua, a dynamically typed language, has a string type, a number
type, and a Boolean type, among others. In Lua every value belongs to
<em>exactly</em> one type, but this is not a requirement for all dynamically typed
languages. In Lua, it is permissible to concatenate two strings, but it is not
permissible to concatenate a string and a Boolean.</p>
<h3>Strong vs weak</h3>
<p>The opposite of "strongly typed" is "weakly typed", which means you can work
around the type system. C is notoriously weakly typed because any pointer type
is convertible to any other pointer type simply by casting. Pascal was
intended to be strongly typed, but an oversight in the design (untagged
variant records) introduced a loophole into the type system, so technically it
is weakly typed. Examples of truly strongly typed languages include CLU,
Standard ML, and Haskell. Standard ML has in fact undergone several revisions
to remove loopholes in the type system that were discovered after the language
was widely deployed.</p>
<h2>What's really going on here?</h2>
<p>Overall, it turns out to be not that useful to talk about "strong" and "weak".
Whether a type system has a loophole is less important than the exact number
and nature of the loopholes, how likely they are to come up in practice, and
what are the consequences of exploiting a loophole. In practice, <strong>it's best
to avoid the terms "strong" and "weak" altogether</strong> , because</p>
<ul>
<li>
<p>Amateurs often conflate them with "static" and "dynamic".</p>
</li>
<li>
<p>Apparently "weak typing" is used by some persons to talk about the relative prevalance or absence of implicit conversions.</p>
</li>
<li>
<p>Professionals can't agree on exactly what the terms mean.</p>
</li>
<li>
<p>Overall you are unlikely to inform or enlighten your audience.</p>
</li>
</ul>
<p>The sad truth is that when it comes to type systems, <strong>"strong" and "weak"
don't have a universally agreed on technical meaning.</strong> If you want to discuss
the relative strength of type systems, it is better to discuss exactly what
guarantees are and are not provided. For example, a good question to ask is
this: "is every value of a given type (or class) guaranteed to have been
created by calling one of that type's constructors?" In C the answer is no. In
CLU, F#, and Haskell it is yes. For C++ I am not sure—I would like to know.</p>
<p>By contrast, <em>static typing</em> means that programs are <em>checked before being
executed</em> , and a program might be rejected before it starts. <em>Dynamic typing</em>
means that the types of <em>values</em> are checked <em>during</em> execution, and a poorly
typed operation might cause the program to halt or otherwise signal an error
at run time. A primary reason for static typing is to rule out programs that
might have such "dynamic type errors".</p>
<blockquote>
<p>Does one imply the other?</p>
</blockquote>
<p>On a pedantic level, no, because the word "strong" doesn't really mean
anything. But in practice, people almost always do one of two things:</p>
<ul>
<li>
<p>They (incorrectly) use "strong" and "weak" to mean "static" and "dynamic", in which case they (incorrectly) are using "strongly typed" and "statically typed" interchangeably.</p>
</li>
<li>
<p>They use "strong" and "weak" to compare properties of static type systems. It is very rare to hear someone talk about a "strong" or "weak" dynamic type system. Except for FORTH, which doesn't really have any sort of a type system, I can't think of a dynamically typed language where the type system can be subverted. Sort of by definition, those checks are bulit into the execution engine, and every operation gets checked for sanity before being executed. </p>
</li>
</ul>
<p>Either way, if a person calls a language "strongly typed", that person is very
likely to be talking about a statically typed language.</p>
<p><br></p>
<h3>Suggest</h3>
<p>This is often misunderstood so let me clear it up.</p>
<h3>Static/Dynamic Typing</h3>
<p><strong>Static typing</strong> is where the type is bound to the <em>variable</em>. Types are
checked at compile time.</p>
<p><strong>Dynamic typing</strong> is where the type is bound to the <em>value</em>. Types are
checked at run time.</p>
<p>So in Java for example:</p>
<div class="code"><pre class="code literal-block">String s = "abcd";
</pre></div>

<p><code>s</code> will "forever" be a <code>String</code>. During its life it may point to different
<code>String</code>s (since <code>s</code> is a reference in Java). It may have a <code>null</code> value but
it will never refer to an <code>Integer</code> or a <code>List</code>. That's static typing.</p>
<p>In PHP:</p>
<div class="code"><pre class="code literal-block">$s = "abcd";          // $s is a string
$s = 123;             // $s is now an integer
$s = array(1, 2, 3);  // $s is now an array
$s = new DOMDocument; // $s is an instance of the DOMDocument class
</pre></div>

<p>That's dynamic typing.</p>
<h3>Strong/Weak Typing</h3>
<p>(Edit alert!)</p>
<p><strong>Strong typing</strong> is a phrase with no widely agreed upon meaning. Most
programmers who use this term to mean something other than static typing use
it to imply that there is a type discipline that is enforced by the compiler.
For example, CLU has a strong type system that does not allow client code to
create a value of abstract type except by using the constructors provided by
the type. C has a somewhat strong type system, but it can be "subverted" to a
degree because a program can always cast a value of one pointer type to a
value of another pointer type. So for example, in C you can take a value
returned by <code>malloc()</code> and cheerfully cast it to <code>FILE*</code>, and the compiler
won't try to stop you—or even warn you that you are doing anything dodgy.</p>
<p>(The original answer said something about a value "not changing type at run
time". I have known many language designers and compiler writers and have not
known one that talked about values changing type at run time, except possibly
some very advanced research in type systems, where this is known as the
"strong update problem".)</p>
<p><strong>Weak typing</strong> implies that the compiler does not enforce a typing discpline,
or perhaps that enforcement can easily be subverted.</p>
<p>The original of this answer conflated weak typing with <strong>implicit conversion</strong>
(sometimes also called "implicit promotion"). For example, in Java:</p>
<div class="code"><pre class="code literal-block">String s = "abc" + 123; // "abc123";
</pre></div>

<p>This is code is an example of implicit promotion: 123 is implicitly converted
to a string before being concatenated with <code>"abc"</code>. It can be argued the Java
compiler rewrites that code as:</p>
<div class="code"><pre class="code literal-block">String s = "abc" + new Integer(123).toString();
</pre></div>

<p>Consider a classic PHP "starts with" problem:</p>
<div class="code"><pre class="code literal-block"><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">strpos</span><span class="ss">(</span><span class="s1">'abcdef'</span>,<span class="w"> </span><span class="s1">'abc'</span><span class="ss">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nv">false</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="nv">not</span><span class="w"> </span><span class="nv">found</span>
}
</pre></div>

<p>The error here is that <code>strpos()</code> returns the index of the match, being 0. 0
is coerced into boolean <code>false</code> and thus the condition is actually true. The
solution is to use <code>===</code> instead of <code>==</code> to avoid implicit conversion.</p>
<p>This example illustrates how a combination of implicit conversion and dynamic
typing can lead programmers astray.</p>
<p>Compare that to Ruby:</p>
<div class="code"><pre class="code literal-block">val = "abc" + 123
</pre></div>

<p>which is a runtime error because in Ruby the <em>object</em> 123 is <em>not</em> implicitly
converted just because it happens to be passed to a <code>+</code> method. In Ruby the
programmer must make the conversion explicit:</p>
<div class="code"><pre class="code literal-block">val = "abc" + 123.to_s
</pre></div>

<p>Comparing PHP and Ruby is a good illustration here. Both are dynamically typed
languages but PHP has lots of implicit conversions and Ruby (perhaps
surprisingly if you're unfamiliar with it) doesn't.</p>
<h3>Static/Dynamic vs Strong/Weak</h3>
<p>The point here is that the static/dynamic axis is independent of the
strong/weak axis. People confuse them probably in part because strong vs weak
typing is not only less clearly defined, there is no real consensus on exactly
what is meant by strong and weak. For this reason strong/weak typing is far
more of a shade of grey rather than black or white.</p>
<p>So to answer your question: another way to look at this that's <em>mostly</em>
correct is to say that static typing is compile-time type safety and strong
typing is runtime type safety.</p>
<p>The reason for this is that variables in a statically typed language have a
type that must be declared and can be checked at compile time. A strongly-
typed language has values that have a type at run time, and it's difficult for
the programmer to subvert the type system without a dynamic check.</p>
<p>But it's important to understand that a language can be Static/Strong,
Static/Weak, Dynamic/Strong or Dynamic/Weak.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/use-mockito-to-mock-some-methods-but-not-others/" class="u-url">Use Mockito to mock some methods but not others</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/use-mockito-to-mock-some-methods-but-not-others/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T02:58:03+08:00" itemprop="datePublished" title="2023-02-18 02:58">2023-02-18 02:58</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Is there any way, using Mockito, to mock some methods in a class, but not
others?</p>
<p>For example, in this (admittedly contrived) <code>Stock</code> class I want to mock the
<code>getPrice()</code> and <code>getQuantity()</code> return values (as shown in the test snippet
below) but I want the <code>getValue()</code> to perform the multiplication as coded in
the <code>Stock</code> class</p>
<div class="code"><pre class="code literal-block"><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">Stock</span><span class="w"> </span><span class="err">{</span>
<span class="w">  </span><span class="n">private</span><span class="w"> </span><span class="n">final</span><span class="w"> </span><span class="k">double</span><span class="w"> </span><span class="n">price</span><span class="p">;</span>
<span class="w">  </span><span class="n">private</span><span class="w"> </span><span class="n">final</span><span class="w"> </span><span class="nc">int</span><span class="w"> </span><span class="n">quantity</span><span class="p">;</span>

<span class="w">  </span><span class="n">Stock</span><span class="p">(</span><span class="k">double</span><span class="w"> </span><span class="n">price</span><span class="p">,</span><span class="w"> </span><span class="nc">int</span><span class="w"> </span><span class="n">quantity</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="n">this</span><span class="p">.</span><span class="n">price</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">price</span><span class="p">;</span>
<span class="w">    </span><span class="n">this</span><span class="p">.</span><span class="n">quantity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">quantity</span><span class="p">;</span>
<span class="w">  </span><span class="err">}</span>

<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">double</span><span class="w"> </span><span class="n">getPrice</span><span class="p">()</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">price</span><span class="p">;</span>
<span class="w">  </span><span class="err">}</span>

<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="nc">int</span><span class="w"> </span><span class="n">getQuantity</span><span class="p">()</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">quantity</span><span class="p">;</span>
<span class="w">  </span><span class="err">}</span>
<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">double</span><span class="w"> </span><span class="n">getValue</span><span class="p">()</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">getPrice</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">getQuantity</span><span class="p">();</span>
<span class="w">  </span><span class="err">}</span>

<span class="w">  </span><span class="nv">@Test</span>
<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="n">getValueTest</span><span class="p">()</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="n">Stock</span><span class="w"> </span><span class="n">stock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mock</span><span class="p">(</span><span class="n">Stock</span><span class="p">.</span><span class="k">class</span><span class="p">);</span>
<span class="w">    </span><span class="k">when</span><span class="p">(</span><span class="n">stock</span><span class="p">.</span><span class="n">getPrice</span><span class="p">()).</span><span class="n">thenReturn</span><span class="p">(</span><span class="mf">100.00</span><span class="p">);</span>
<span class="w">    </span><span class="k">when</span><span class="p">(</span><span class="n">stock</span><span class="p">.</span><span class="n">getQuantity</span><span class="p">()).</span><span class="n">thenReturn</span><span class="p">(</span><span class="mi">200</span><span class="p">);</span>
<span class="w">    </span><span class="k">double</span><span class="w"> </span><span class="k">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stock</span><span class="p">.</span><span class="n">getValue</span><span class="p">();</span>
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="n">Unfortunately</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="n">assert</span><span class="w"> </span><span class="n">fails</span><span class="p">,</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">mock</span><span class="w"> </span><span class="n">Stock</span><span class="w"> </span><span class="n">getValue</span><span class="p">()</span><span class="w"> </span><span class="k">method</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">perform</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Stock</span><span class="p">.</span><span class="n">getValue</span><span class="p">()</span><span class="w"> </span><span class="n">calculation</span><span class="w"> </span><span class="n">code</span><span class="p">.</span>
<span class="w">    </span><span class="n">assertEquals</span><span class="p">(</span><span class="ss">"Stock value not correct"</span><span class="p">,</span><span class="w"> </span><span class="mf">100.00</span><span class="o">*</span><span class="mi">200</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="p">,</span><span class="w"> </span><span class="mf">.00001</span><span class="p">);</span>
<span class="err">}</span>
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<p>To directly answer your question, yes, you can mock some methods without
mocking others. This is called a <strong>partial mock</strong>. See the Mockito
documentation on partial mocks for more information.</p>
<p>For your example, you can do something like the following, in your test:</p>
<div class="code"><pre class="code literal-block">Stock stock = mock(Stock.class);
when(stock.getPrice()).thenReturn(100.00);    // Mock implementation
when(stock.getQuantity()).thenReturn(200);    // Mock implementation
when(stock.getValue()).thenCallRealMethod();  // Real implementation
</pre></div>

<p>In that case, each method implementation is mocked, unless specify
<code>thenCallRealMethod()</code> in the <code>when(..)</code> clause.</p>
<p>There is also a possibility the other way around with <strong>spy</strong> instead of
<strong>mock</strong> :</p>
<div class="code"><pre class="code literal-block">Stock stock = spy(Stock.class);
when(stock.getPrice()).thenReturn(100.00);    // Mock implementation
when(stock.getQuantity()).thenReturn(200);    // Mock implementation
// All other method call will use the real implementations
</pre></div>

<p>In that case, all method implementation are the real one, except if you have
defined a mocked behaviour with <code>when(..)</code>.</p>
<p>There is one important pitfall when you use <code>when(Object)</code> with spy like in
the previous example. The real method will be called (because
<code>stock.getPrice()</code> is evaluated before <code>when(..)</code> at runtime). This can be a
problem if your method contains logic that should not be called. You can write
the previous example like this:</p>
<div class="code"><pre class="code literal-block">Stock stock = spy(Stock.class);
doReturn(100.00).when(stock).getPrice();    // Mock implementation
doReturn(200).when(stock).getQuantity();    // Mock implementation
// All other method call will use the real implementations
</pre></div>

<hr>
<p>Another possibility may be to use <code>org.mockito.Mockito.CALLS_REAL_METHODS</code>,
such as:</p>
<div class="code"><pre class="code literal-block">Stock MOCK_STOCK = Mockito.mock( Stock.class, CALLS_REAL_METHODS );
</pre></div>

<p>This delegates unstubbed calls to real implementations.</p>
<hr>
<p>However, with your example, I believe it will still fail, since the
implementation of <code>getValue()</code> relies on <code>quantity</code> and <code>price</code>, rather than
<code>getQuantity()</code> and <code>getPrice()</code>, which is what you've mocked.</p>
<p>Another possibility is to avoid mocks altogether:</p>
<div class="code"><pre class="code literal-block"><span class="nv">@Test</span>
<span class="k">public</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="n">getValueTest</span><span class="p">()</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="n">Stock</span><span class="w"> </span><span class="n">stock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Stock</span><span class="p">(</span><span class="mf">100.00</span><span class="p">,</span><span class="w"> </span><span class="mi">200</span><span class="p">);</span>
<span class="w">    </span><span class="k">double</span><span class="w"> </span><span class="k">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stock</span><span class="p">.</span><span class="n">getValue</span><span class="p">();</span>
<span class="w">    </span><span class="n">assertEquals</span><span class="p">(</span><span class="ss">"Stock value not correct"</span><span class="p">,</span><span class="w"> </span><span class="mf">100.00</span><span class="o">*</span><span class="mi">200</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="p">,</span><span class="w"> </span><span class="mf">.00001</span><span class="p">);</span>
<span class="err">}</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>Partial mocking of a class is also supported via <strong>Spy</strong> in mockito</p>
<div class="code"><pre class="code literal-block"><span class="nt">List</span><span class="w"> </span><span class="nt">list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">new</span><span class="w"> </span><span class="nt">LinkedList</span><span class="o">();</span>
<span class="nt">List</span><span class="w"> </span><span class="nt">spy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">spy</span><span class="o">(</span><span class="nt">list</span><span class="o">);</span>

<span class="o">//</span><span class="nt">optionally</span><span class="o">,</span><span class="w"> </span><span class="nt">you</span><span class="w"> </span><span class="nt">can</span><span class="w"> </span><span class="nt">stub</span><span class="w"> </span><span class="nt">out</span><span class="w"> </span><span class="nt">some</span><span class="w"> </span><span class="nt">methods</span><span class="o">:</span>
<span class="nt">when</span><span class="o">(</span><span class="nt">spy</span><span class="p">.</span><span class="nc">size</span><span class="o">())</span><span class="p">.</span><span class="nc">thenReturn</span><span class="o">(</span><span class="nt">100</span><span class="o">);</span>

<span class="o">//</span><span class="nt">using</span><span class="w"> </span><span class="nt">the</span><span class="w"> </span><span class="nt">spy</span><span class="w"> </span><span class="nt">calls</span><span class="w"> </span><span class="nt">real</span><span class="w"> </span><span class="nt">methods</span>
<span class="nt">spy</span><span class="p">.</span><span class="nc">add</span><span class="o">(</span><span class="s2">"one"</span><span class="o">);</span>
<span class="nt">spy</span><span class="p">.</span><span class="nc">add</span><span class="o">(</span><span class="s2">"two"</span><span class="o">);</span>

<span class="o">//</span><span class="nt">size</span><span class="o">()</span><span class="w"> </span><span class="nt">method</span><span class="w"> </span><span class="nt">was</span><span class="w"> </span><span class="nt">stubbed</span><span class="w"> </span><span class="nt">-</span><span class="w"> </span><span class="nt">100</span><span class="w"> </span><span class="nt">is</span><span class="w"> </span><span class="nt">printed</span>
<span class="nt">System</span><span class="p">.</span><span class="nc">out</span><span class="p">.</span><span class="nc">println</span><span class="o">(</span><span class="nt">spy</span><span class="p">.</span><span class="nc">size</span><span class="o">());</span>
</pre></div>

<p>Check the <code>1.10.19</code> and <code>2.7.22</code> docs for detailed explanation.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-1174.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-1172.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
