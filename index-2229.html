<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 2229) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-2229.html">
<link rel="prev" href="index-2230.html" type="text/html">
<link rel="next" href="index-2228.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-do-i-handle-newlines-in-json/" class="u-url">How do I handle newlines in JSON?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-do-i-handle-newlines-in-json/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T00:28:30+08:00" itemprop="datePublished" title="2023-03-04 00:28">2023-03-04 00:28</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I've generated some JSON and I'm trying to pull it into an object in
JavaScript. I keep getting errors. Here's what I have:</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'{"count" : 1, "stack" : "sometext</span><span class="se">\n\n</span><span class="s1">"}'</span><span class="p">;</span>
<span class="k">var</span><span class="w"> </span><span class="n">dataObj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eval</span><span class="p">(</span><span class="s1">'('</span><span class="o">+</span><span class="n">data</span><span class="o">+</span><span class="s1">')'</span><span class="p">);</span>
</pre></div>

<p>This gives me an error:</p>
<div class="code"><pre class="code literal-block">unterminated string literal
</pre></div>

<p>With <code>JSON.parse(data)</code>, I see similar error messages: "<code>Unexpected token ↵</code>"
in Chrome, and "<code>unterminated string literal</code>" in Firefox and IE.</p>
<p>When I take out the <code>\n</code> after <code>sometext</code> the error goes away in both cases. I
can't seem to figure out why the <code>\n</code> makes <code>eval</code> and <code>JSON.parse</code> fail.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>This is what you want:</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'{"count" : 1, "stack" : "sometext</span><span class="se">\\</span><span class="s1">n</span><span class="se">\\</span><span class="s1">n"}'</span><span class="p">;</span>
</pre></div>

<p>You need to escape the <code>\</code> in your string (turning it into a double-<code>\</code>),
otherwise it will become a newline in the JSON source, not the JSON data.</p>
<p><br></p>
<h3>Suggest</h3>
<p>You will need to have a function which replaces <code>\n</code> to <code>\\n</code> in case <code>data</code>
is not a string literal.</p>
<div class="code"><pre class="code literal-block"><span class="n">function</span><span class="w"> </span><span class="n">jsonEscape</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nb">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="o">/</span>\<span class="n">n</span><span class="o">/</span><span class="n">g</span><span class="p">,</span><span class="w"> </span><span class="s2">"</span><span class="se">\\\\</span><span class="s2">n"</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="o">/</span>\<span class="n">r</span><span class="o">/</span><span class="n">g</span><span class="p">,</span><span class="w"> </span><span class="s2">"</span><span class="se">\\\\</span><span class="s2">r"</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="o">/</span>\<span class="n">t</span><span class="o">/</span><span class="n">g</span><span class="p">,</span><span class="w"> </span><span class="s2">"</span><span class="se">\\\\</span><span class="s2">t"</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">var</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'{"count" : 1, "stack" : "sometext</span><span class="se">\n\n</span><span class="s1">"}'</span><span class="p">;</span>
<span class="k">var</span><span class="w"> </span><span class="n">dataObj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JSON</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">jsonEscape</span><span class="p">(</span><span class="n">data</span><span class="p">));</span>
</pre></div>

<p>Resulting <code>dataObj</code> will be</p>
<div class="code"><pre class="code literal-block">Object {count: 1, stack: "sometext\n\n"}
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/maximum-on-http-header-values/" class="u-url">Maximum on HTTP header values?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/maximum-on-http-header-values/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T00:27:15+08:00" itemprop="datePublished" title="2023-03-04 00:27">2023-03-04 00:27</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Is there an accepted maximum allowed size for HTTP headers? If so, what is it?
If not, is this something that's server specific or is the accepted standard
to allow headers of any size?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>No, HTTP does not define any limit. However most web servers do limit size of
headers they accept. For example in Apache default limit is 8KB, in IIS it's
16K. Server will return <code>413 Entity Too Large</code> error if headers size exceeds
that limit.</p>
<p>Related question: How big can a user agent string get?</p>
<p><br></p>
<h3>Suggest</h3>
<p>As vartec says above, the HTTP spec does not define a limit, however many
servers do by default. This means, practically speaking, the lower limit is
<strong>8K</strong>. For most servers, this limit applies to the <strong>sum of the request line
and <em>ALL</em> header fields</strong> (so keep your cookies short).</p>
<ul>
<li>Apache 2.0, 2.2: <strong>8K</strong>
</li>
<li>nginx: <strong>4K</strong> - 8K</li>
<li>IIS: varies by version, <strong>8K</strong> - 16K</li>
<li>Tomcat: varies by version, <strong>8K</strong> - 48K (?!)</li>
</ul>
<p>It's worth noting that nginx uses the system page size by default, which is 4K
on most systems. You can check with this tiny program:</p>
<p>pagesize.c:</p>
<div class="code"><pre class="code literal-block"><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;unistd.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">pageSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getpagesize</span><span class="p">();</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">"Page size on your system = %i bytes</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="w"> </span><span class="n">pageSize</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<p>Compile with <code>gcc -o pagesize pagesize.c</code> then run <code>./pagesize</code>. My ubuntu
server from Linode dutifully informs me the answer is 4k.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-do-i-print-my-java-object-without-getting-sometype-2f92e0f4/" class="u-url">How do I print my Java object without getting "SomeType@2f92e0f4"?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-do-i-print-my-java-object-without-getting-sometype-2f92e0f4/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T00:25:56+08:00" itemprop="datePublished" title="2023-03-04 00:25">2023-03-04 00:25</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I have a class defined as follows:</p>
<div class="code"><pre class="code literal-block"><span class="n">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">Person</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">private</span><span class="w"> </span><span class="nb nb-Type">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>

<span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">constructor</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">getter</span><span class="o">/</span><span class="n">setter</span><span class="w"> </span><span class="n">omitted</span>
<span class="p">}</span>
</pre></div>

<p>I tried to print an instance of my class:</p>
<div class="code"><pre class="code literal-block">System.out.println(myPerson);
</pre></div>

<p>but I got the following output: <code>com.foo.Person@2f92e0f4</code>.</p>
<p>A similar thing happened when I tried to print an array of <code>Person</code> objects:</p>
<div class="code"><pre class="code literal-block">Person[] people = //...
System.out.println(people);
</pre></div>

<p>I got the output: <code>[Lcom.foo.Person;@28a418fc</code></p>
<p>What does this output mean? How do I change this output so it contains the
name of my person? And how do I print collections of my objects?</p>
<p><strong>Note</strong> : this is intended as a canonical Q&amp;A about this subject.</p>
<p><br><br></p>
<h2>Answer</h2>
<h2>Background</h2>
<p>All Java objects have a <code>toString()</code> method, which is invoked when you try to
print the object.</p>
<div class="code"><pre class="code literal-block">System.out.println(myObject);  // invokes myObject.toString()
</pre></div>

<p>This method is defined in the <code>Object</code> class (the superclass of all Java
objects). The <code>Object.toString()</code> method returns a fairly ugly looking string,
composed of the name of the class, an <code>@</code> symbol and the hashcode of the
object in hexadecimal. The code for this looks like:</p>
<div class="code"><pre class="code literal-block"><span class="c1">// Code of Object.toString()</span>
<span class="n">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">toString</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">getClass</span><span class="p">().</span><span class="n">getName</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">"@"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Integer</span><span class="p">.</span><span class="n">toHexString</span><span class="p">(</span><span class="n">hashCode</span><span class="p">());</span>
<span class="p">}</span>
</pre></div>

<p>A result such as <code>com.foo.MyType@2f92e0f4</code> can therefore be explained as:</p>
<ul>
<li>
<code>com.foo.MyType</code> - the name of the class, i.e. the class is <code>MyType</code> in the package <code>com.foo</code>.</li>
<li>
<code>@</code> - joins the string together</li>
<li>
<code>2f92e0f4</code> the hashcode of the object.</li>
</ul>
<p>The name of array classes look a little different, which is explained well in
the Javadocs for <code>Class.getName()</code>. For instance, <code>[Ljava.lang.String</code> means:</p>
<ul>
<li>
<code>[</code> - an single-dimensional array (as opposed to <code>[[</code> or <code>[[[</code> etc.)</li>
<li>
<code>L</code> - the array contains a class or interface</li>
<li>
<code>java.lang.String</code> - the type of objects in the array</li>
</ul>
<hr>
<h2>Customizing the Output</h2>
<p>To print something different when you call <code>System.out.println(myObject)</code>, you
must override the <code>toString()</code> method in your own class. Here's a simple
example:</p>
<div class="code"><pre class="code literal-block"><span class="n">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">Person</span><span class="w"> </span><span class="p">{</span>

<span class="w">  </span><span class="n">private</span><span class="w"> </span><span class="nb nb-Type">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>

<span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">constructors</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">methods</span><span class="w"> </span><span class="n">omitted</span>

<span class="w">  </span><span class="err">@</span><span class="n">Override</span>
<span class="w">  </span><span class="n">public</span><span class="w"> </span><span class="nb nb-Type">String</span><span class="w"> </span><span class="n">toString</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p>Now if we print a <code>Person</code>, we see their name rather than
<code>com.foo.Person@12345678</code>.</p>
<p>Bear in mind that <code>toString()</code> is just <em>one</em> way for an object to be converted
to a string. Typically this output should fully describe your object in a
clear and concise manner. A better <code>toString()</code> for our <code>Person</code> class might
be:</p>
<div class="code"><pre class="code literal-block"><span class="nv">@Override</span>
<span class="k">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">toString</span><span class="p">()</span><span class="w"> </span><span class="err">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">getClass</span><span class="p">().</span><span class="n">getSimpleName</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="ss">"[name="</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="ss">"]"</span><span class="p">;</span>
<span class="err">}</span>
</pre></div>

<p>Which would print, e.g., <code>Person[name=Henry]</code>. That's a really useful piece of
data for debugging/testing.</p>
<p>If you want to focus on just one aspect of your object or include a lot of
jazzy formatting, you might be better to define a separate method instead,
e.g. <code>String toElegantReport() {...}</code>.</p>
<hr>
<h2>Auto-generating the Output</h2>
<p>Many IDEs offer support for auto-generating a <code>toString()</code> method, based on
the fields in the class. See docs for Eclipse and IntelliJ, for example.</p>
<p>Several popular Java libraries offer this feature as well. Some examples
include:</p>
<ul>
<li>
<p><code>ToStringBuilder</code> from Apache Commons Lang</p>
</li>
<li>
<p><code>MoreObjects.ToStringHelper</code> from Google Guava</p>
</li>
<li>
<p><code>@ToString</code> annotation from Project Lombok</p>
</li>
</ul>
<hr>
<h2>Printing groups of objects</h2>
<p>So you've created a nice <code>toString()</code> for your class. What happens if that
class is placed into an array or a collection?</p>
<h3>Arrays</h3>
<p>If you have an array of objects, you can call <code>Arrays.toString()</code> to produce a
simple representation of the contents of the array. For instance, consider
this array of <code>Person</code> objects:</p>
<div class="code"><pre class="code literal-block">Person[] people = { new Person("Fred"), new Person("Mike") };
System.out.println(Arrays.toString(people));

// Prints: [Fred, Mike]
</pre></div>

<p>Note: this is a call to a <em>static</em> method called <code>toString()</code> in the Arrays
class, which is different to what we've been discussing above.</p>
<p>If you have a <strong>multi-dimensional array</strong> , you can use
<code>Arrays.deepToString()</code> to achieve the same sort of output.</p>
<h3>Collections</h3>
<p>Most collections will produce a pretty output based on calling <code>.toString()</code>
on every element.</p>
<div class="code"><pre class="code literal-block">List&lt;Person&gt; people = new ArrayList&lt;&gt;();
people.add(new Person("Alice"));
people.add(new Person("Bob"));    
System.out.println(people);

// Prints [Alice, Bob]
</pre></div>

<p>So you just need to ensure your list elements define a nice <code>toString()</code> as
discussed above.</p>
<p><br></p>
<h3>Suggest</h3>
<p>I think apache provides a better util class which provides a function to get
the string</p>
<div class="code"><pre class="code literal-block">ReflectionToStringBuilder.toString(object)
</pre></div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-2230.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-2228.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
