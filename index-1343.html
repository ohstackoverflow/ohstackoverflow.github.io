<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 1343) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-1343.html">
<link rel="prev" href="index-1344.html" type="text/html">
<link rel="next" href="index-1342.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/hashset-vs-list-performance/" class="u-url">HashSet vs. List performance</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/hashset-vs-list-performance/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T07:07:40+08:00" itemprop="datePublished" title="2023-02-18 07:07">2023-02-18 07:07</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>It's clear that a search performance of the generic <code>HashSet&lt;T&gt;</code> class is
higher than of the generic <code>List&lt;T&gt;</code> class. Just compare the hash-based key
with the linear approach in the <code>List&lt;T&gt;</code> class.</p>
<p>However calculating a hash key may itself take some CPU cycles, so for a small
amount of items the linear search can be a real alternative to the
<code>HashSet&lt;T&gt;</code>.</p>
<p>My question: where is the break-even?</p>
<p>To simplify the scenario (and to be fair) let's assume that the <code>List&lt;T&gt;</code>
class uses the element's <code>Equals()</code> method to identify an item.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>A lot of people are saying that once you get to the size where speed is
actually a concern that <code>HashSet&lt;T&gt;</code> will always beat <code>List&lt;T&gt;</code>, but that
depends on what you are doing.</p>
<p>Let's say you have a <code>List&lt;T&gt;</code> that will only ever have on average 5 items in
it. Over a large number of cycles, if a single item is added or removed each
cycle, you may well be better off using a <code>List&lt;T&gt;</code>.</p>
<p>I did a test for this on my machine, and, well, it has to be very very small
to get an advantage from <code>List&lt;T&gt;</code>. For a list of short strings, the advantage
went away after size 5, for objects after size 20.</p>
<div class="code"><pre class="code literal-block"><span class="mf">1</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="kr">LIST</span><span class="w"> </span><span class="n">strs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">617</span><span class="n">ms</span>
<span class="mf">1</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="n">HASHSET</span><span class="w"> </span><span class="n">strs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">1332</span><span class="n">ms</span>

<span class="mf">2</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="kr">LIST</span><span class="w"> </span><span class="n">strs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">781</span><span class="n">ms</span>
<span class="mf">2</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="n">HASHSET</span><span class="w"> </span><span class="n">strs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">1354</span><span class="n">ms</span>

<span class="mf">3</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="kr">LIST</span><span class="w"> </span><span class="n">strs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">950</span><span class="n">ms</span>
<span class="mf">3</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="n">HASHSET</span><span class="w"> </span><span class="n">strs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">1405</span><span class="n">ms</span>

<span class="mf">4</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="kr">LIST</span><span class="w"> </span><span class="n">strs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">1126</span><span class="n">ms</span>
<span class="mf">4</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="n">HASHSET</span><span class="w"> </span><span class="n">strs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">1441</span><span class="n">ms</span>

<span class="mf">5</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="kr">LIST</span><span class="w"> </span><span class="n">strs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">1370</span><span class="n">ms</span>
<span class="mf">5</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="n">HASHSET</span><span class="w"> </span><span class="n">strs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">1452</span><span class="n">ms</span>

<span class="mf">6</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="kr">LIST</span><span class="w"> </span><span class="n">strs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">1481</span><span class="n">ms</span>
<span class="mf">6</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="n">HASHSET</span><span class="w"> </span><span class="n">strs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">1418</span><span class="n">ms</span>

<span class="mf">7</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="kr">LIST</span><span class="w"> </span><span class="n">strs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">1581</span><span class="n">ms</span>
<span class="mf">7</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="n">HASHSET</span><span class="w"> </span><span class="n">strs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">1464</span><span class="n">ms</span>

<span class="mf">8</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="kr">LIST</span><span class="w"> </span><span class="n">strs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">1726</span><span class="n">ms</span>
<span class="mf">8</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="n">HASHSET</span><span class="w"> </span><span class="n">strs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">1398</span><span class="n">ms</span>

<span class="mf">9</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="kr">LIST</span><span class="w"> </span><span class="n">strs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">1901</span><span class="n">ms</span>
<span class="mf">9</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="n">HASHSET</span><span class="w"> </span><span class="n">strs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">1433</span><span class="n">ms</span>

<span class="mf">1</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="kr">LIST</span><span class="w"> </span><span class="n">objs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">614</span><span class="n">ms</span>
<span class="mf">1</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="n">HASHSET</span><span class="w"> </span><span class="n">objs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">1993</span><span class="n">ms</span>

<span class="mf">4</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="kr">LIST</span><span class="w"> </span><span class="n">objs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">837</span><span class="n">ms</span>
<span class="mf">4</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="n">HASHSET</span><span class="w"> </span><span class="n">objs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">1914</span><span class="n">ms</span>

<span class="mf">7</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="kr">LIST</span><span class="w"> </span><span class="n">objs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">1070</span><span class="n">ms</span>
<span class="mf">7</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="n">HASHSET</span><span class="w"> </span><span class="n">objs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">1900</span><span class="n">ms</span>

<span class="mf">10</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="kr">LIST</span><span class="w"> </span><span class="n">objs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">1267</span><span class="n">ms</span>
<span class="mf">10</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="n">HASHSET</span><span class="w"> </span><span class="n">objs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">1904</span><span class="n">ms</span>

<span class="mf">13</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="kr">LIST</span><span class="w"> </span><span class="n">objs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">1494</span><span class="n">ms</span>
<span class="mf">13</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="n">HASHSET</span><span class="w"> </span><span class="n">objs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">1893</span><span class="n">ms</span>

<span class="mf">16</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="kr">LIST</span><span class="w"> </span><span class="n">objs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">1695</span><span class="n">ms</span>
<span class="mf">16</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="n">HASHSET</span><span class="w"> </span><span class="n">objs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">1879</span><span class="n">ms</span>

<span class="mf">19</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="kr">LIST</span><span class="w"> </span><span class="n">objs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">1902</span><span class="n">ms</span>
<span class="mf">19</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="n">HASHSET</span><span class="w"> </span><span class="n">objs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">1950</span><span class="n">ms</span>

<span class="mf">22</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="kr">LIST</span><span class="w"> </span><span class="n">objs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">2136</span><span class="n">ms</span>
<span class="mf">22</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="n">HASHSET</span><span class="w"> </span><span class="n">objs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">1893</span><span class="n">ms</span>

<span class="mf">25</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="kr">LIST</span><span class="w"> </span><span class="n">objs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">2357</span><span class="n">ms</span>
<span class="mf">25</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="n">HASHSET</span><span class="w"> </span><span class="n">objs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">1826</span><span class="n">ms</span>

<span class="mf">28</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="kr">LIST</span><span class="w"> </span><span class="n">objs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">2555</span><span class="n">ms</span>
<span class="mf">28</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="n">HASHSET</span><span class="w"> </span><span class="n">objs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">1865</span><span class="n">ms</span>

<span class="mf">31</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="kr">LIST</span><span class="w"> </span><span class="n">objs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">2755</span><span class="n">ms</span>
<span class="mf">31</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="n">HASHSET</span><span class="w"> </span><span class="n">objs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">1963</span><span class="n">ms</span>

<span class="mf">34</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="kr">LIST</span><span class="w"> </span><span class="n">objs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">3025</span><span class="n">ms</span>
<span class="mf">34</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="n">HASHSET</span><span class="w"> </span><span class="n">objs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">1874</span><span class="n">ms</span>

<span class="mf">37</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="kr">LIST</span><span class="w"> </span><span class="n">objs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">3195</span><span class="n">ms</span>
<span class="mf">37</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="n">HASHSET</span><span class="w"> </span><span class="n">objs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">1958</span><span class="n">ms</span>

<span class="mf">40</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="kr">LIST</span><span class="w"> </span><span class="n">objs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">3401</span><span class="n">ms</span>
<span class="mf">40</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="n">HASHSET</span><span class="w"> </span><span class="n">objs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">1855</span><span class="n">ms</span>

<span class="mf">43</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="kr">LIST</span><span class="w"> </span><span class="n">objs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">3618</span><span class="n">ms</span>
<span class="mf">43</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="n">HASHSET</span><span class="w"> </span><span class="n">objs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">1869</span><span class="n">ms</span>

<span class="mf">46</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="kr">LIST</span><span class="w"> </span><span class="n">objs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">3883</span><span class="n">ms</span>
<span class="mf">46</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="n">HASHSET</span><span class="w"> </span><span class="n">objs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">2046</span><span class="n">ms</span>

<span class="mf">49</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="kr">LIST</span><span class="w"> </span><span class="n">objs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">4218</span><span class="n">ms</span>
<span class="mf">49</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="n">HASHSET</span><span class="w"> </span><span class="n">objs</span><span class="w"> </span><span class="n">time</span><span class="p">:</span><span class="w"> </span><span class="mf">1873</span><span class="n">ms</span>
</pre></div>

<p>Here is that data displayed as a graph:</p>
<p><img alt="enter image description here" src="images/O4ly9.png"></p>
<p>Here's the code:</p>
<div class="code"><pre class="code literal-block"><span class="nt">static</span><span class="w"> </span><span class="nt">void</span><span class="w"> </span><span class="nt">Main</span><span class="o">(</span><span class="nt">string</span><span class="cp">[]</span><span class="w"> </span><span class="nt">args</span><span class="o">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="err">int</span><span class="w"> </span><span class="err">times</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">10000000</span><span class="p">;</span>

<span class="w">    </span><span class="err">for</span><span class="w"> </span><span class="err">(int</span><span class="w"> </span><span class="err">listSize</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">1</span><span class="p">;</span><span class="w"> </span><span class="err">listSize</span><span class="w"> </span><span class="err">&lt;</span><span class="w"> </span><span class="err">10</span><span class="p">;</span><span class="w"> </span><span class="err">listSize++)</span>
<span class="w">    </span><span class="err">{</span>
<span class="w">        </span><span class="err">List&lt;string&gt;</span><span class="w"> </span><span class="err">list</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">new</span><span class="w"> </span><span class="err">List&lt;string&gt;()</span><span class="p">;</span>
<span class="w">        </span><span class="err">HashSet&lt;string&gt;</span><span class="w"> </span><span class="err">hashset</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">new</span><span class="w"> </span><span class="err">HashSet&lt;string&gt;()</span><span class="p">;</span>

<span class="w">        </span><span class="err">for</span><span class="w"> </span><span class="err">(int</span><span class="w"> </span><span class="err">i</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">0</span><span class="p">;</span><span class="w"> </span><span class="err">i</span><span class="w"> </span><span class="err">&lt;</span><span class="w"> </span><span class="err">listSize</span><span class="p">;</span><span class="w"> </span><span class="err">i++)</span>
<span class="w">        </span><span class="err">{</span>
<span class="w">            </span><span class="err">list.Add("string"</span><span class="w"> </span><span class="err">+</span><span class="w"> </span><span class="err">i.ToString())</span><span class="p">;</span>
<span class="w">            </span><span class="err">hashset.Add("string"</span><span class="w"> </span><span class="err">+</span><span class="w"> </span><span class="err">i.ToString())</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nt">Stopwatch</span><span class="w"> </span><span class="nt">timer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">new</span><span class="w"> </span><span class="nt">Stopwatch</span><span class="o">();</span>
<span class="w">        </span><span class="nt">timer</span><span class="p">.</span><span class="nc">Start</span><span class="o">();</span>
<span class="w">        </span><span class="nt">for</span><span class="w"> </span><span class="o">(</span><span class="nt">int</span><span class="w"> </span><span class="nt">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">0</span><span class="o">;</span><span class="w"> </span><span class="nt">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nt">times</span><span class="o">;</span><span class="w"> </span><span class="nt">i</span><span class="o">++)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="err">list.Remove("string0")</span><span class="p">;</span>
<span class="w">            </span><span class="err">list.Add("string0")</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="nt">timer</span><span class="p">.</span><span class="nc">Stop</span><span class="o">();</span>
<span class="w">        </span><span class="nt">Console</span><span class="p">.</span><span class="nc">WriteLine</span><span class="o">(</span><span class="nt">listSize</span><span class="p">.</span><span class="nc">ToString</span><span class="o">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">" item LIST strs time: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nt">timer</span><span class="p">.</span><span class="nc">ElapsedMilliseconds</span><span class="p">.</span><span class="nc">ToString</span><span class="o">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">"ms"</span><span class="o">);</span>

<span class="w">        </span><span class="nt">timer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">new</span><span class="w"> </span><span class="nt">Stopwatch</span><span class="o">();</span>
<span class="w">        </span><span class="nt">timer</span><span class="p">.</span><span class="nc">Start</span><span class="o">();</span>
<span class="w">        </span><span class="nt">for</span><span class="w"> </span><span class="o">(</span><span class="nt">int</span><span class="w"> </span><span class="nt">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">0</span><span class="o">;</span><span class="w"> </span><span class="nt">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nt">times</span><span class="o">;</span><span class="w"> </span><span class="nt">i</span><span class="o">++)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="err">hashset.Remove("string0")</span><span class="p">;</span>
<span class="w">            </span><span class="err">hashset.Add("string0")</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="nt">timer</span><span class="p">.</span><span class="nc">Stop</span><span class="o">();</span>
<span class="w">        </span><span class="nt">Console</span><span class="p">.</span><span class="nc">WriteLine</span><span class="o">(</span><span class="nt">listSize</span><span class="p">.</span><span class="nc">ToString</span><span class="o">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">" item HASHSET strs time: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nt">timer</span><span class="p">.</span><span class="nc">ElapsedMilliseconds</span><span class="p">.</span><span class="nc">ToString</span><span class="o">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">"ms"</span><span class="o">);</span>
<span class="w">        </span><span class="nt">Console</span><span class="p">.</span><span class="nc">WriteLine</span><span class="o">();</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="nt">for</span><span class="w"> </span><span class="o">(</span><span class="nt">int</span><span class="w"> </span><span class="nt">listSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">1</span><span class="o">;</span><span class="w"> </span><span class="nt">listSize</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nt">50</span><span class="o">;</span><span class="w"> </span><span class="nt">listSize</span><span class="o">+=</span><span class="nt">3</span><span class="o">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="err">List&lt;object&gt;</span><span class="w"> </span><span class="err">list</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">new</span><span class="w"> </span><span class="err">List&lt;object&gt;()</span><span class="p">;</span>
<span class="w">        </span><span class="err">HashSet&lt;object&gt;</span><span class="w"> </span><span class="err">hashset</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">new</span><span class="w"> </span><span class="err">HashSet&lt;object&gt;()</span><span class="p">;</span>

<span class="w">        </span><span class="err">for</span><span class="w"> </span><span class="err">(int</span><span class="w"> </span><span class="err">i</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">0</span><span class="p">;</span><span class="w"> </span><span class="err">i</span><span class="w"> </span><span class="err">&lt;</span><span class="w"> </span><span class="err">listSize</span><span class="p">;</span><span class="w"> </span><span class="err">i++)</span>
<span class="w">        </span><span class="err">{</span>
<span class="w">            </span><span class="err">list.Add(new</span><span class="w"> </span><span class="err">object())</span><span class="p">;</span>
<span class="w">            </span><span class="err">hashset.Add(new</span><span class="w"> </span><span class="err">object())</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nt">object</span><span class="w"> </span><span class="nt">objToAddRem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">list</span><span class="cp">[</span><span class="mi">0</span><span class="cp">]</span><span class="o">;</span>

<span class="w">        </span><span class="nt">Stopwatch</span><span class="w"> </span><span class="nt">timer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">new</span><span class="w"> </span><span class="nt">Stopwatch</span><span class="o">();</span>
<span class="w">        </span><span class="nt">timer</span><span class="p">.</span><span class="nc">Start</span><span class="o">();</span>
<span class="w">        </span><span class="nt">for</span><span class="w"> </span><span class="o">(</span><span class="nt">int</span><span class="w"> </span><span class="nt">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">0</span><span class="o">;</span><span class="w"> </span><span class="nt">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nt">times</span><span class="o">;</span><span class="w"> </span><span class="nt">i</span><span class="o">++)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="err">list.Remove(objToAddRem)</span><span class="p">;</span>
<span class="w">            </span><span class="err">list.Add(objToAddRem)</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="nt">timer</span><span class="p">.</span><span class="nc">Stop</span><span class="o">();</span>
<span class="w">        </span><span class="nt">Console</span><span class="p">.</span><span class="nc">WriteLine</span><span class="o">(</span><span class="nt">listSize</span><span class="p">.</span><span class="nc">ToString</span><span class="o">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">" item LIST objs time: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nt">timer</span><span class="p">.</span><span class="nc">ElapsedMilliseconds</span><span class="p">.</span><span class="nc">ToString</span><span class="o">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">"ms"</span><span class="o">);</span>

<span class="w">        </span><span class="nt">timer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">new</span><span class="w"> </span><span class="nt">Stopwatch</span><span class="o">();</span>
<span class="w">        </span><span class="nt">timer</span><span class="p">.</span><span class="nc">Start</span><span class="o">();</span>
<span class="w">        </span><span class="nt">for</span><span class="w"> </span><span class="o">(</span><span class="nt">int</span><span class="w"> </span><span class="nt">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">0</span><span class="o">;</span><span class="w"> </span><span class="nt">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nt">times</span><span class="o">;</span><span class="w"> </span><span class="nt">i</span><span class="o">++)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="err">hashset.Remove(objToAddRem)</span><span class="p">;</span>
<span class="w">            </span><span class="err">hashset.Add(objToAddRem)</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="nt">timer</span><span class="p">.</span><span class="nc">Stop</span><span class="o">();</span>
<span class="w">        </span><span class="nt">Console</span><span class="p">.</span><span class="nc">WriteLine</span><span class="o">(</span><span class="nt">listSize</span><span class="p">.</span><span class="nc">ToString</span><span class="o">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">" item HASHSET objs time: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nt">timer</span><span class="p">.</span><span class="nc">ElapsedMilliseconds</span><span class="p">.</span><span class="nc">ToString</span><span class="o">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">"ms"</span><span class="o">);</span>
<span class="w">        </span><span class="nt">Console</span><span class="p">.</span><span class="nc">WriteLine</span><span class="o">();</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="nt">Console</span><span class="p">.</span><span class="nc">ReadLine</span><span class="o">();</span>
<span class="err">}</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>It's essentially pointless to compare two structures for <em>performance</em> that
behave differently. Use the structure that conveys the intent. Even if you say
your <code>List&lt;T&gt;</code> wouldn't have duplicates and iteration order doesn't matter
making it comparable to a <code>HashSet&lt;T&gt;</code>, its still a poor choice to use
<code>List&lt;T&gt;</code> because its relatively less fault tolerant.</p>
<p>That said, I will inspect <em>some other aspects</em> of performance,</p>
<div class="code"><pre class="code literal-block"><span class="nb">+------------+--------+-------------+-----------+----------+----------+-----------+</span>
<span class="c">| Collection | Random | Containment | Insertion | Addition |  Removal | Memory    |</span>
<span class="c">|            | access |             |           |          |          |           |</span>
<span class="nb">+------------+--------+-------------+-----------+----------+----------+-----------+</span>
<span class="c">| List</span><span class="nv">&lt;</span><span class="c">T</span><span class="nv">&gt;</span><span class="c">    | O(1)   | O(n)        | O(n)      | O(1)*    | O(n)     | Lesser    |</span>
<span class="c">| HashSet</span><span class="nv">&lt;</span><span class="c">T</span><span class="nv">&gt;</span><span class="c"> | O(n)   | O(1)        | n/a       | O(1)     | O(1)     | Greater** |</span>
<span class="nb">+------------+--------+-------------+-----------+----------+----------+-----------+</span>
</pre></div>

<ul>
<li>
<p>Even though addition is O(1) in both cases, it will be relatively slower in HashSet since it involves cost of precomputing hash code before storing it.</p>
</li>
<li>
<p>The superior scalability of HashSet has a memory cost. Every entry is stored as a new object along with its hash code. This article might give you an idea.</p>
</li>
</ul>
</div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-do-i-determine-if-my-python-shell-is-executing-in-32bit-or-64bit/" class="u-url">How do I determine if my python shell is executing in 32bit or 64bit?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-do-i-determine-if-my-python-shell-is-executing-in-32bit-or-64bit/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T07:07:12+08:00" itemprop="datePublished" title="2023-02-18 07:07">2023-02-18 07:07</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>How can I tell what mode the shell is in, from within the shell?</p>
<p>I've tried looking at the platform module, but it seems only to tell you about
"the bit architecture and the linkage format used for the executable". My
binary is compiled as 64bit (I'm running on OS X 10.6), so it seems to always
report 64bit even though I'm using the methods described here to force 32bit
mode.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>One way is to look at <code>sys.maxsize</code> as documented here:</p>
<div class="code"><pre class="code literal-block"><span class="err">$</span> <span class="n">python</span><span class="o">-</span><span class="mi">32</span> <span class="o">-</span><span class="n">c</span> <span class="s1">'import sys;print("</span><span class="si">%x</span><span class="s1">" </span><span class="si">% s</span><span class="s1">ys.maxsize, sys.maxsize &gt; 2**32)'</span>
<span class="p">(</span><span class="s1">'7fffffff'</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="err">$</span> <span class="n">python</span><span class="o">-</span><span class="mi">64</span> <span class="o">-</span><span class="n">c</span> <span class="s1">'import sys;print("</span><span class="si">%x</span><span class="s1">" </span><span class="si">% s</span><span class="s1">ys.maxsize, sys.maxsize &gt; 2**32)'</span>
<span class="p">(</span><span class="s1">'7fffffffffffffff'</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>

<p>On Windows, run the same commands formatted as follows:</p>
<div class="code"><pre class="code literal-block"><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s2">"import sys;print(</span><span class="se">\"</span><span class="si">%x</span><span class="se">\"</span><span class="s2"> </span><span class="si">% s</span><span class="s2">ys.maxsize, sys.maxsize &gt; 2**32)"</span>
</pre></div>

<p><code>sys.maxsize</code> was introduced in Python 2.6. If you need a test for older
systems, this slightly more complicated test should work on all Python 2 and 3
releases:</p>
<div class="code"><pre class="code literal-block"><span class="err">$</span> <span class="n">python</span><span class="o">-</span><span class="mi">32</span> <span class="o">-</span><span class="n">c</span> <span class="s1">'import struct;print( 8 * struct.calcsize("P"))'</span>
<span class="mi">32</span>
<span class="err">$</span> <span class="n">python</span><span class="o">-</span><span class="mi">64</span> <span class="o">-</span><span class="n">c</span> <span class="s1">'import struct;print( 8 * struct.calcsize("P"))'</span>
<span class="mi">64</span>
</pre></div>

<p>BTW, you might be tempted to use <code>platform.architecture()</code> for this.
Unfortunately, its results are not always reliable, particularly in the case
of OS X universal binaries.</p>
<div class="code"><pre class="code literal-block"><span class="err">$</span> <span class="n">arch</span> <span class="o">-</span><span class="n">x86_64</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">python2</span><span class="mf">.6</span> <span class="o">-</span><span class="n">c</span> <span class="s1">'import sys,platform; print platform.architecture()[0], sys.maxsize &gt; 2**32'</span>
<span class="mi">64</span><span class="n">bit</span> <span class="kc">True</span>
<span class="err">$</span> <span class="n">arch</span> <span class="o">-</span><span class="n">i386</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">python2</span><span class="mf">.6</span> <span class="o">-</span><span class="n">c</span> <span class="s1">'import sys,platform; print platform.architecture()[0], sys.maxsize &gt; 2**32'</span>
<span class="mi">64</span><span class="n">bit</span> <span class="kc">False</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>When starting the Python interpreter in the terminal/command line you may also
see a line like:</p>
<p><code>Python 2.7.2 (default, Jun 12 2011, 14:24:46) [MSC v.1500 64 bit (AMD64)] on
win32</code></p>
<p>Where <code>[MSC v.1500 64 bit (AMD64)]</code> means 64-bit Python. Works for my
particular setup.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/why-are-hexadecimal-numbers-prefixed-with-0x/" class="u-url">Why are hexadecimal numbers prefixed with 0x?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/why-are-hexadecimal-numbers-prefixed-with-0x/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T07:06:49+08:00" itemprop="datePublished" title="2023-02-18 07:06">2023-02-18 07:06</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Why are hexadecimal numbers prefixed as <code>0x</code>? I understand the usage of the
prefix but I don't understand the significance of why <code>0x</code> was chosen.</p>
<p><br><br></p>
<h2>Answer</h2>
<p><strong>Short story:</strong> The <code>0</code> tells the parser it's dealing with a constant (and
not an identifier/reserved word). Something is still needed to specify the
number base: the <code>x</code> is an arbitrary choice.</p>
<p><strong>Long story:</strong> In the 60's, the prevalent programming number systems were
decimal and <em>octal</em> — mainframes had 12, 24 or 36 bits per byte, which is
nicely divisible by 3 = log2(8).</p>
<p>The BCPL language used the syntax <code>8 1234</code> for octal numbers. When Ken
Thompson created B from BCPL, he used the <code>0</code> prefix instead. This is great
because</p>
<ol>
<li>an integer constant now always consists of a single token,</li>
<li>the parser can still tell right away it's got a constant,</li>
<li>the parser can immediately tell the base (<code>0</code> is the same in both bases),</li>
<li>it's mathematically sane (<code>00005 == 05</code>), and</li>
<li>no precious special characters are needed (as in <code>#123</code>).</li>
</ol>
<p>When C was created from B, the need for hexadecimal numbers arose (the PDP-11
had 16-bit words) and all of the points above were still valid. Since octals
were still needed for other machines, <code>0x</code> was arbitrarily chosen (<code>00</code> was
probably ruled out as awkward).</p>
<p>C# is a descendant of C, so it inherits the syntax.</p>
<p><br></p>
<h3>Suggest</h3>
<p><em>Note: I don't know the correct answer, but the below is just my personal
speculation!</em></p>
<p>As has been mentioned a 0 before a number means it's octal:</p>
<div class="code"><pre class="code literal-block"><span class="mf">04524</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">octal</span><span class="p">,</span><span class="w"> </span><span class="n">leading</span><span class="w"> </span><span class="mf">0</span>
</pre></div>

<p>Imagine needing to come up with a system to denote hexadecimal numbers, and
note we're working in a C style environment. How about ending with h like
assembly? Unfortunately you can't - it would allow you to make tokens which
are valid identifiers (eg. you could name a variable the same thing) which
would make for some nasty ambiguities.</p>
<div class="code"><pre class="code literal-block"><span class="mf">8000</span><span class="n">h</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">hex</span>
<span class="n">FF00h</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">oops</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">val</span><span class="n">id</span><span class="w"> </span><span class="n">identifier</span><span class="err">!</span><span class="w">  </span><span class="n">Hex</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">named</span><span class="w"> </span><span class="n">FF00h</span><span class="err">?</span>
</pre></div>

<p>You can't lead with a character for the same reason:</p>
<div class="code"><pre class="code literal-block">xFF00 // also valid identifier
</pre></div>

<p>Using a hash was probably thrown out because it conflicts with the
preprocessor:</p>
<div class="code"><pre class="code literal-block">#define ...
#FF00 // invalid preprocessor token?
</pre></div>

<p>In the end, for whatever reason, they decided to put an x after a leading 0 to
denote hexadecimal. It is unambiguous since it still starts with a number
character so can't be a valid identifier, and is probably based off the octal
convention of a leading 0.</p>
<div class="code"><pre class="code literal-block"><span class="mf">0</span><span class="n">xFF00</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="kd">def</span><span class="n">initely</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">identifier</span><span class="err">!</span>
</pre></div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-1344.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-1342.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
