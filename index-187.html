<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 187) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-187.html">
<link rel="prev" href="index-188.html" type="text/html">
<link rel="next" href="index-186.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/ru-he-shi-yong-jsp-2-bi-mian-jsp-wen-jian-zhong-de-java-dai-ma/" class="u-url">如何使用 JSP 2 避免 JSP 文件中的 Java 代码？</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/ru-he-shi-yong-jsp-2-bi-mian-jsp-wen-jian-zhong-de-java-dai-ma/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T00:21:45+08:00" itemprop="datePublished" title="2023-02-17 00:21">2023-02-17 00:21</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>我知道类似以下三行的内容</p>
<div class="code"><pre class="code literal-block"><span class="cp">&lt;%=</span><span class="w"> </span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span><span class="w"> </span><span class="n">request</span><span class="o">.</span><span class="n">getParameter</span><span class="p">(</span><span class="s2">"name"</span><span class="p">)</span><span class="w"> </span><span class="cp">%&gt;</span>
<span class="cp">&lt;%</span><span class="o">!</span><span class="w"> </span><span class="n">counter</span><span class="o">++</span><span class="p">;</span><span class="w"> </span><span class="cp">%&gt;</span>
</pre></div>

<p>是一种老派的编码方式，在 JSP 版本 2 中有一种方法可以避免在 JSP 文件中使用 Java 代码。替代的 JSP 2 行是什么，这种技术叫什么？</p>
<p><br><br></p>
<h2>解答</h2>
<p>自 2001 年 <em>taglib</em> （如JSTL）和EL（表达式语言，那些东西）诞生以来，在JSP中使用 <em>scriptlet</em>
（那些东西）确实是非常不鼓励的。<code>&lt;% %&gt;</code> __<code>${}</code></p>
<p><em>Scriptlet</em> 的主要缺点是：</p>
<ol>
<li>
<strong>可重用性：</strong> 您不能重用 scriptlet。</li>
<li>
<strong>可替换性：</strong> 您不能使 scriptlet 抽象。</li>
<li>
<strong>面向对象的能力：</strong> 你不能利用继承/组合。</li>
<li>
<strong>可调试性：</strong> 如果 scriptlet 中途抛出异常，您得到的只是一个空白页面。</li>
<li>
<strong>可测试性：</strong> 小脚本不可单元测试。</li>
<li>
<strong>可维护性：</strong> 每个 saldo 需要更多时间来维护混合/混乱/重复的代码逻辑。</li>
</ol>
<p><del>Sun</del> Oracle 本身也在JSP 编码约定中建议，只要（标记）类可以实现相同的功能，就避免使用 <em>scriptlet 。</em>
以下是几个相关的引用：</p>
<blockquote>
<p>根据 JSP 1.2 规范，强烈建议在 Web 应用程序中使用 JSP 标准标记库 (JSTL)，以帮助减少页面中 <strong>对 JSP scriptlet
的需求。</strong> 通常，使用 JSTL 的页面更易于阅读和维护。</p>
<p>...</p>
<p>只要标记库提供等效功能，就应尽可能 <strong>避免使用 JSP scriptlet 。</strong>
这使页面更易于阅读和维护，有助于将业务逻辑与表示逻辑分开，并使您的页面更容易演变成 JSP 2.0 样式的页面（JSP 2.0 规范支持但不强调使用
scriptlet）。</p>
<p>...</p>
<p>本着采用模型-视图-控制器 (MVC) 设计模式以减少业务逻辑表示层之间耦合的精神， <strong>不应使用 JSP scriptlet</strong>
来编写业务逻辑。相反，JSP scriptlet
在必要时用于将处理客户端请求返回的数据（也称为“值对象”）转换为适合客户端的格式。即便如此，最好使用前端控制器 servlet 或自定义标记来完成。</p>
</blockquote>
<hr>
<p><strong>如何替换 <em>scriptlet</em> 完全取决于代码/逻辑的唯一目的。这段代码通常被放在一个完全有价值的 Java 类中：</strong></p>
<ul>
<li>如果您想在 <em>每个请求上调用</em> <strong>相同的</strong> Java 代码，或多或少与请求的页面无关，例如检查用户是否已登录，那么实现一个过滤器并在方法中相应地编写代码。例如： __<code>doFilter()</code><div class="code"><pre class="code literal-block"><span class="w">  </span><span class="nv">public</span><span class="w"> </span><span class="nv">void</span><span class="w"> </span><span class="nv">doFilter</span><span class="ss">(</span><span class="nv">ServletRequest</span><span class="w"> </span><span class="nv">request</span>,<span class="w"> </span><span class="nv">ServletResponse</span><span class="w"> </span><span class="nv">response</span>,<span class="w"> </span><span class="nv">FilterChain</span><span class="w"> </span><span class="nv">chain</span><span class="ss">)</span><span class="w"> </span><span class="nv">throws</span><span class="w"> </span><span class="nv">ServletException</span>,<span class="w"> </span><span class="nv">IOException</span><span class="w"> </span>{
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="ss">(((</span><span class="nv">HttpServletRequest</span><span class="ss">)</span><span class="w"> </span><span class="nv">request</span><span class="ss">)</span>.<span class="nv">getSession</span><span class="ss">()</span>.<span class="nv">getAttribute</span><span class="ss">(</span><span class="s2">"user"</span><span class="ss">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nv">null</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">      </span><span class="ss">((</span><span class="nv">HttpServletResponse</span><span class="ss">)</span><span class="w"> </span><span class="nv">response</span><span class="ss">)</span>.<span class="nv">sendRedirect</span><span class="ss">(</span><span class="s2">"login"</span><span class="ss">)</span><span class="c1">; // Not logged in, redirect to login page.</span>
<span class="w">  </span>}<span class="w"> </span><span class="k">else</span><span class="w"> </span>{
<span class="w">      </span><span class="nv">chain</span>.<span class="nv">doFilter</span><span class="ss">(</span><span class="nv">request</span>,<span class="w"> </span><span class="nv">response</span><span class="ss">)</span><span class="c1">; // Logged in, just continue request.</span>
<span class="w">  </span>}
</pre></div>

<p>}</p>
</li>
</ul>
<p>当映射到一个适当<code>&lt;url-pattern&gt;</code>覆盖感兴趣的 JSP 页面时，您就不需要复制粘贴整个 JSP 页面的同一段代码。</p>
<hr>
<ul>
<li>如果你想调用一些 Java 代码来 <strong>处理 GET 请求</strong> ，例如从数据库中预加载一些列表以显示在一些表中，如果需要的话，可以根据一些查询参数，然后实现一个servlet并在方法中编写相应的代码<code>doGet()</code>。例如：<div class="code"><pre class="code literal-block">  protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
  try {
      List&lt;Product&gt; products = productService.list(); // Obtain all products.
      request.setAttribute("products", products); // Store products in request scope.
      request.getRequestDispatcher("/WEB-INF/products.jsp").forward(request, response); // Forward to JSP page to display them in a HTML table.
  } catch (SQLException e) {
      throw new ServletException("Retrieving products failed!", e);
  }
</pre></div>

<p>}</p>
</li>
</ul>
<p>这种处理异常的方式更容易。在 JSP 呈现过程中不访问数据库，而是在显示 JSP
之前访问数据库。每当数据库访问抛出异常时，您仍然可以更改响应。在上面的示例中，将显示默认错误 500 页面，您可以通过<code>&lt;error-
page&gt;</code>in对其进行自定义<code>web.xml</code>。</p>
<hr>
<ul>
<li>如果你想调用一些 Java 代码来 <strong>处理 POST 请求</strong> ，例如从提交的 HTML 表单中收集数据并用它做一些业务（转换、验证、保存在 DB 中等），那么实现一个servlet并相应地编写代码在方法中<code>doPost()</code>。例如：<div class="code"><pre class="code literal-block"><span class="w">  </span><span class="nv">protected</span><span class="w"> </span><span class="nv">void</span><span class="w"> </span><span class="nv">doPost</span><span class="ss">(</span><span class="nv">HttpServletRequest</span><span class="w"> </span><span class="nv">request</span>,<span class="w"> </span><span class="nv">HttpServletResponse</span><span class="w"> </span><span class="nv">response</span><span class="ss">)</span><span class="w"> </span><span class="nv">throws</span><span class="w"> </span><span class="nv">ServletException</span>,<span class="w"> </span><span class="nv">IOException</span><span class="w"> </span>{
<span class="w">  </span><span class="nv">String</span><span class="w"> </span><span class="nv">username</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">request</span>.<span class="nv">getParameter</span><span class="ss">(</span><span class="s2">"username"</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">  </span><span class="nv">String</span><span class="w"> </span><span class="nv">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">request</span>.<span class="nv">getParameter</span><span class="ss">(</span><span class="s2">"password"</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">  </span><span class="nv">User</span><span class="w"> </span><span class="nv">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">userService</span>.<span class="nv">find</span><span class="ss">(</span><span class="nv">username</span>,<span class="w"> </span><span class="nv">password</span><span class="ss">)</span><span class="c1">;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">user</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nv">null</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">      </span><span class="nv">request</span>.<span class="nv">getSession</span><span class="ss">()</span>.<span class="nv">setAttribute</span><span class="ss">(</span><span class="s2">"user"</span>,<span class="w"> </span><span class="nv">user</span><span class="ss">)</span><span class="c1">; // Login user.</span>
<span class="w">      </span><span class="nv">response</span>.<span class="nv">sendRedirect</span><span class="ss">(</span><span class="s2">"home"</span><span class="ss">)</span><span class="c1">; // Redirect to home page.</span>
<span class="w">  </span>}<span class="w"> </span><span class="k">else</span><span class="w"> </span>{
<span class="w">      </span><span class="nv">request</span>.<span class="nv">setAttribute</span><span class="ss">(</span><span class="s2">"message"</span>,<span class="w"> </span><span class="s2">"Unknown username/password. Please retry."</span><span class="ss">)</span><span class="c1">; // Store error message in request scope.</span>
<span class="w">      </span><span class="nv">request</span>.<span class="nv">getRequestDispatcher</span><span class="ss">(</span><span class="s2">"/WEB-INF/login.jsp"</span><span class="ss">)</span>.<span class="nv">forward</span><span class="ss">(</span><span class="nv">request</span>,<span class="w"> </span><span class="nv">response</span><span class="ss">)</span><span class="c1">; // Forward to JSP page to redisplay login form with error.</span>
<span class="w">  </span>}
</pre></div>

<p>}</p>
</li>
</ul>
<p>这种处理不同结果页面目标的方式更容易：在出现错误的情况下重新显示带有验证错误的表单（在此特定示例中，您可以使用 EL
重新显示它），或者在成功的情况下直接转到所需的<code>${message}</code>目标页面。</p>
<hr>
<ul>
<li>如果你想调用一些 Java 代码来 <strong>控制</strong> 执行计划和/或请求和响应的目的地，那么根据MVC 的 Front Controller Pattern实现一个servlet。例如：<div class="code"><pre class="code literal-block"><span class="w">  </span><span class="nv">protected</span><span class="w"> </span><span class="nv">void</span><span class="w"> </span><span class="nv">service</span><span class="ss">(</span><span class="nv">HttpServletRequest</span><span class="w"> </span><span class="nv">request</span>,<span class="w"> </span><span class="nv">HttpServletResponse</span><span class="w"> </span><span class="nv">response</span><span class="ss">)</span><span class="w"> </span><span class="nv">throws</span><span class="w"> </span><span class="nv">ServletException</span>,<span class="w"> </span><span class="nv">IOException</span><span class="w"> </span>{
<span class="w">  </span><span class="nv">try</span><span class="w"> </span>{
<span class="w">      </span><span class="nv">Action</span><span class="w"> </span><span class="nv">action</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">ActionFactory</span>.<span class="nv">getAction</span><span class="ss">(</span><span class="nv">request</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">      </span><span class="nv">String</span><span class="w"> </span><span class="nv">view</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">action</span>.<span class="nv">execute</span><span class="ss">(</span><span class="nv">request</span>,<span class="w"> </span><span class="nv">response</span><span class="ss">)</span><span class="c1">;</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">view</span>.<span class="nv">equals</span><span class="ss">(</span><span class="nv">request</span>.<span class="nv">getPathInfo</span><span class="ss">()</span>.<span class="nv">substring</span><span class="ss">(</span><span class="mi">1</span><span class="ss">))</span><span class="w"> </span>{
<span class="w">          </span><span class="nv">request</span>.<span class="nv">getRequestDispatcher</span><span class="ss">(</span><span class="s2">"/WEB-INF/"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nv">view</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">".jsp"</span><span class="ss">)</span>.<span class="nv">forward</span><span class="ss">(</span><span class="nv">request</span>,<span class="w"> </span><span class="nv">response</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">      </span>}<span class="w"> </span><span class="k">else</span><span class="w"> </span>{
<span class="w">          </span><span class="nv">response</span>.<span class="nv">sendRedirect</span><span class="ss">(</span><span class="nv">view</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">      </span>}
<span class="w">  </span>}<span class="w"> </span><span class="nv">catch</span><span class="w"> </span><span class="ss">(</span><span class="nv">Exception</span><span class="w"> </span><span class="nv">e</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">      </span><span class="nv">throw</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">ServletException</span><span class="ss">(</span><span class="s2">"Executing action failed."</span>,<span class="w"> </span><span class="nv">e</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">  </span>}
</pre></div>

<p>}</p>
</li>
</ul>
<p>或者只是采用 MVC 框架，如JSF、Spring MVC、Wicket等，这样您最终只需要一个 JSP/Facelets 页面和一个 JavaBean
类，而无需自定义 servlet。</p>
<hr>
<ul>
<li>如果您想调用一些 Java 代码来 <strong>控制 JSP 页面内的流程</strong> ，那么您需要获取一个（现有的）流程控制标签库，例如JSTL core。<code>List&lt;Product&gt;</code>例如在表格中显示：<div class="code"><pre class="code literal-block"><span class="x">  </span><span class="cp">&lt;%</span><span class="err">@</span><span class="w"> </span><span class="n">taglib</span><span class="w"> </span><span class="n">uri</span><span class="o">=</span><span class="s2">"http://java.sun.com/jsp/jstl/core"</span><span class="w"> </span><span class="n">prefix</span><span class="o">=</span><span class="s2">"c"</span><span class="w"> </span><span class="cp">%&gt;</span>
</pre></div>

<p>...
  </p>
<table><foreach items="${products}" var="product"><tr>
<td>${product.name}</td>
              <td>${product.description}</td>
              <td>${product.price}</td>
          </tr></foreach></table>
</li>
</ul>
<p>使用 XML 样式的标签可以很好地适应所有 HTML，代码比一堆带有各种左大括号和右大括号的 scriptlet 更易读（因此更易于维护）（“
<em>这个右大括号到底属于哪里？”</em> ）。一个简单的帮助是将您的 Web 应用程序配置为在仍然使用 <em>scriptlet</em>
时抛出异常，方法是将以下内容添加到<code>web.xml</code>：</p>
<div class="code"><pre class="code literal-block"><span class="w">      </span><span class="nt">&lt;jsp-config&gt;</span>
<span class="w">      </span><span class="nt">&lt;jsp-property-group&gt;</span>
<span class="w">          </span><span class="nt">&lt;url-pattern&gt;</span>*.jsp<span class="nt">&lt;/url-pattern&gt;</span>
<span class="w">          </span><span class="nt">&lt;scripting-invalid&gt;</span>true<span class="nt">&lt;/scripting-invalid&gt;</span>
<span class="w">      </span><span class="nt">&lt;/jsp-property-group&gt;</span>
<span class="w">  </span><span class="nt">&lt;/jsp-config&gt;</span>
</pre></div>

<p>在JSP 的后继者Facelets中，它是 Java EE 提供的 MVC 框架JSF的一部分，已经 <strong>不可能</strong> 使用 <em>scriptlet</em>
了。这样你就会自动被迫以“正确的方式”做事。</p>
<hr>
<ul>
<li>如果你想调用一些 Java 代码来 <strong>访问和显示</strong> JSP 页面内的“后端”数据，那么你需要使用 EL（表达式语言），那些<code>${}</code>东西。例如重新显示提交的输入值：<div class="code"><pre class="code literal-block"><span class="w">  </span><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"foo"</span> <span class="na">value=</span><span class="s">"</span><span class="cp">${</span><span class="n">param</span><span class="o">.</span><span class="n">foo</span><span class="cp">}</span><span class="s">"</span> <span class="nt">/&gt;</span>
</pre></div>

</li>
</ul>
<p>显示<code>${param.foo}</code>结果<code>request.getParameter("foo")</code>。</p>
<hr>
<ul>
<li>如果您想在 JSP 页面中直接调用一些 <strong>实用程序</strong><code>public static</code>Java 代码（通常是方法），那么您需要将它们定义为 EL 函数。JSTL 中有一个标准的函数标签库，但您也可以轻松地自己创建函数。<code>fn:escapeXml</code>下面是一个 JSTL 如何用于防止XSS 攻击的示例。<div class="code"><pre class="code literal-block"><span class="x">  </span><span class="cp">&lt;%</span><span class="err">@</span><span class="w"> </span><span class="n">taglib</span><span class="w"> </span><span class="n">uri</span><span class="o">=</span><span class="s2">"http://java.sun.com/jsp/jstl/functions"</span><span class="w"> </span><span class="n">prefix</span><span class="o">=</span><span class="s2">"fn"</span><span class="w"> </span><span class="cp">%&gt;</span>
</pre></div>

<p>...
  <input type="text" name="foo" value="${fn:escapeXml(param.foo)}"></p>
</li>
</ul>
<p><strong>请注意，XSS 敏感性与 Java/JSP/JSTL/EL/等等没有任何具体关系，在您开发的每个</strong> Web 应用程序中都需要考虑这个问题。
<em>scriptlet</em> 的问题是它没有提供内置的预防方法，至少没有使用标准的 Java
API。JSP的后继者Facelets已经隐含了HTML转义，所以不用担心Facelets中的XSS漏洞。</p>
<h4>也可以看看：</h4>
<ul>
<li>JSP、Servlet 和 JSF 有什么区别？</li>
<li>Servlet、ServletContext、HttpSession 和 HttpServletRequest/Response 是如何工作的？</li>
<li>JSP、Servlet 和 JDBC 的基本 MVC 示例</li>
<li>Java Web 应用程序中的设计模式</li>
<li>JSP/Servlet的隐藏特性</li>
</ul>
<p><br></p>
<h3>更多建议</h3>
<p><strong>作为保护措施：永久禁用 Scriptlet</strong></p>
<p>正如另一个问题所讨论的那样，您可以并且始终应该在您的 Web 应用程序描述符中禁用 scriptlet <code>web.xml</code>。</p>
<p>我会一直这样做，以防止任何开发人员添加 scriptlet，尤其是在您迟早会失去概览的大公司中。设置<code>web.xml</code>如下所示：</p>
<div class="code"><pre class="code literal-block"><span class="nt">&lt;jsp-config&gt;</span>
<span class="w">  </span><span class="nt">&lt;jsp-property-group&gt;</span>
<span class="w">    </span><span class="nt">&lt;url-pattern&gt;</span>*.jsp<span class="nt">&lt;/url-pattern&gt;</span>
<span class="w">     </span><span class="nt">&lt;scripting-invalid&gt;</span>true<span class="nt">&lt;/scripting-invalid&gt;</span>
<span class="w">  </span><span class="nt">&lt;/jsp-property-group&gt;</span>
<span class="nt">&lt;/jsp-config&gt;</span>
</pre></div>

<p><br><br><a href="posts/how-can-i-avoid-java-code-in-jsp-files-using-jsp-2/">查看原文</a></p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/cong-dui-xiang-shu-zu-zhong-ti-qu-shu-xing-zhi-zuo-wei-shu-zu/" class="u-url">从对象数组中提取属性值作为数组</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/cong-dui-xiang-shu-zu-zhong-ti-qu-shu-xing-zhi-zuo-wei-shu-zu/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T00:21:11+08:00" itemprop="datePublished" title="2023-02-17 00:21">2023-02-17 00:21</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>我有具有以下结构的 JavaScript 对象数组：</p>
<div class="code"><pre class="code literal-block"><span class="nt">objArray</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="cp">[</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">foo</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nx">bar</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">foo</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="nx">bar</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">foo</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="nx">bar</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">}</span><span class="w"> </span><span class="cp">]</span><span class="o">;</span>
</pre></div>

<p>我想从每个对象中提取一个字段，并获得一个包含值的数组，例如 field<code>foo</code>会给出 array <code>[ 1, 3, 5 ]</code>。</p>
<p>我可以用这种简单的方法做到这一点：</p>
<div class="code"><pre class="code literal-block"><span class="k">function</span><span class="w"> </span><span class="n">getFields</span><span class="p">(</span><span class="k">input</span><span class="p">,</span><span class="w"> </span><span class="n">field</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="nf">var</span><span class="w"> </span><span class="k">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">[]</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nf">var</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="k">input</span><span class="p">.</span><span class="n">length</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span>
<span class="w">        </span><span class="k">output</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="k">input</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">field</span><span class="o">]</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">output</span><span class="p">;</span>
<span class="err">}</span>

<span class="nf">var</span><span class="w"> </span><span class="k">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getFields</span><span class="p">(</span><span class="n">objArray</span><span class="p">,</span><span class="w"> </span><span class="ss">"foo"</span><span class="p">);</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="k">returns</span><span class="w"> </span><span class="o">[</span><span class="n"> 1, 3, 5 </span><span class="o">]</span>
</pre></div>

<p>是否有更优雅或更惯用的方法来执行此操作，从而不需要自定义实用程序函数？</p>
<hr>
<p>注意建议的 duplicate，它涵盖了如何将单个 <em>对象</em> 转换为数组。</p>
<p><br><br></p>
<h2>解答</h2>
<p>这是实现它的较短方法：</p>
<div class="code"><pre class="code literal-block">let result = objArray.map(a =&gt; a.foo);
</pre></div>

<p>或者</p>
<div class="code"><pre class="code literal-block">let result = objArray.map(({ foo }) =&gt; foo)
</pre></div>

<p>您也可以检查<code>Array.prototype.map()</code>.</p>
<p><br></p>
<h3>更多建议</h3>
<p>是的，但它依赖于 JavaScript 的 ES5 特性。这意味着它不适用于 IE8 或更早版本。</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">objArray</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">function</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="k">return</span><span class="w"> </span><span class="n">a</span><span class="o">.</span><span class="n">foo</span><span class="p">;});</span>
</pre></div>

<p>在 ES6 兼容的 JS 解释器上，为了简洁起见，你可以使用 <em>箭头函数</em> ：</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">objArray</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">a</span><span class="o">.</span><span class="n">foo</span><span class="p">);</span>
</pre></div>

<p>Array.prototype.map 文档</p>
<p><br><br><a href="posts/from-an-array-of-objects-extract-value-of-a-property-as-array/">查看原文</a></p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/yong-yu-geng-xin-he-shan-chu-de-http-zhuang-tai-dai-ma/" class="u-url">用于更新和删除的 HTTP 状态代码？</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/yong-yu-geng-xin-he-shan-chu-de-http-zhuang-tai-dai-ma/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T00:19:58+08:00" itemprop="datePublished" title="2023-02-17 00:19">2023-02-17 00:19</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p><code>UPDATE</code>我应该为( <code>PUT</code>) 和<code>DELETE</code>（例如产品成功更新）设置什么状态代码？</p>
<p><br><br></p>
<h2>解答</h2>
<p>对于 <strong>PUT</strong> 请求： <strong>HTTP 200</strong> ， <strong>HTTP 204</strong> 应该意味着“资源更新成功”。如果 <strong>PUT</strong>
请求创建了新资源，则为 <strong>HTTP 201 。</strong> ****</p>
<p>对于 <strong>DELETE</strong> 请求： <strong>HTTP 200</strong> 或 <strong>HTTP 204</strong> 应表示“资源已成功删除”。</p>
<p><strong>HTTP 202</strong> 也可以通过任一操作返回，这意味着该指令已被服务器接受，但尚未完全应用。操作稍后可能会失败，因此客户端不应该完全假设它是成功的。</p>
<p>接收到它无法识别但以 2 开头的状态代码的客户端应将其视为 200 OK。</p>
<blockquote>
<p><strong>放</strong></p>
<p>如果修改了现有资源，则应该发送 200（OK）或 204（No Content）响应代码以指示请求成功完成。</p>
<p><strong>删除</strong></p>
<p>如果响应包含描述状态的实体，则成功的响应应该为 200（OK），如果操作尚未执行，则为 202（已接受），如果操作已执行但响应不包含，则为
204（无内容）一个实体。</p>
</blockquote>
<p>资料来源：IETF：RFC-9110 方法定义</p>
<blockquote>
<p><strong>HTTP 200 OK：</strong> 成功 HTTP 请求的标准响应。实际响应将取决于所使用的请求方法。</p>
<p><strong>HTTP 204 No Content：</strong> 服务器成功处理了请求，但没有返回任何内容</p>
</blockquote>
<p>来源：HTTP 状态代码列表：2xx 成功</p>
<p><br></p>
<h3>更多建议</h3>
<p>简短回答：对于 PUT 和 DELETE，您应该发送 200（确定）或 204（无内容）。</p>
<p>长答案：这是一个完整的决策图（点击放大）。</p>
<p><img alt="HTTP 1.1
决策图" src="https://camo.githubusercontent.com/c26df6d372790e9f24d7e16d2cfa16a142985109b237bbc0f482c47a717019fe/68747470733a2f2f7261776769746875622e636f6d2f666f722d4745542f687474702d6465636973696f6e2d6469616772616d2f6d61737465722f6874747064642e66736d2e706e67"></p>
<p>来源： https: //github.com/for-GET/http-decision-diagram</p>
<p><br><br><a href="posts/http-status-code-for-update-and-delete/">查看原文</a></p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-188.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-186.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
