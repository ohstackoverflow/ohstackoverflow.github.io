<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 809) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-809.html">
<link rel="prev" href="index-810.html" type="text/html">
<link rel="next" href="index-808.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-do-i-compare-strings-in-java/" class="u-url">How do I compare strings in Java?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-do-i-compare-strings-in-java/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T16:32:38+08:00" itemprop="datePublished" title="2023-02-17 16:32">2023-02-17 16:32</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p><strong>This question's answers are a community effort</strong>. Edit existing answers to
improve this post. It is not currently accepting new answers or interactions.</p>
<p>I've been using the <code>==</code> operator in my program to compare all my strings so
far. However, I ran into a bug, changed one of them into <code>.equals()</code> instead,
and it fixed the bug.</p>
<p>Is <code>==</code> bad? When should it and should it not be used? What's the difference?</p>
<p><br><br></p>
<h2>Answer</h2>
<p><code>==</code> tests for reference equality (whether they are the same object).</p>
<p><code>.equals()</code> tests for value equality (whether they contain the same data).</p>
<p>Objects.equals() checks for <code>null</code> before calling <code>.equals()</code> so you don't
have to (available as of JDK7, also available in Guava).</p>
<p>Consequently, if you want to test whether two strings have the same value you
will probably want to use <code>Objects.equals()</code>.</p>
<div class="code"><pre class="code literal-block"><span class="c1">// These two have the same value</span>
<span class="n">new</span><span class="w"> </span><span class="n">String</span><span class="p">(</span><span class="s">"test"</span><span class="p">).</span><span class="n">equals</span><span class="p">(</span><span class="s">"test"</span><span class="p">)</span><span class="w"> </span><span class="c1">// --&gt; true</span>

<span class="c1">// ... but they are not the same object</span>
<span class="n">new</span><span class="w"> </span><span class="n">String</span><span class="p">(</span><span class="s">"test"</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">"test"</span><span class="w"> </span><span class="c1">// --&gt; false</span>

<span class="c1">// ... neither are these</span>
<span class="n">new</span><span class="w"> </span><span class="n">String</span><span class="p">(</span><span class="s">"test"</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">String</span><span class="p">(</span><span class="s">"test"</span><span class="p">)</span><span class="w"> </span><span class="c1">// --&gt; false</span>

<span class="c1">// ... but these are because literals are interned by </span>
<span class="c1">// the compiler and thus refer to the same object</span>
<span class="s">"test"</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">"test"</span><span class="w"> </span><span class="c1">// --&gt; true</span>

<span class="c1">// ... string literals are concatenated by the compiler</span>
<span class="c1">// and the results are interned.</span>
<span class="s">"test"</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">"te"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">"st"</span><span class="w"> </span><span class="c1">// --&gt; true</span>

<span class="c1">// ... but you should really just call Objects.equals()</span>
<span class="n">Objects</span><span class="p">.</span><span class="n">equals</span><span class="p">(</span><span class="s">"test"</span><span class="p">,</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">String</span><span class="p">(</span><span class="s">"test"</span><span class="p">))</span><span class="w"> </span><span class="c1">// --&gt; true</span>
<span class="n">Objects</span><span class="p">.</span><span class="n">equals</span><span class="p">(</span><span class="nb">null</span><span class="p">,</span><span class="w"> </span><span class="s">"test"</span><span class="p">)</span><span class="w"> </span><span class="c1">// --&gt; false</span>
<span class="n">Objects</span><span class="p">.</span><span class="n">equals</span><span class="p">(</span><span class="nb">null</span><span class="p">,</span><span class="w"> </span><span class="nb">null</span><span class="p">)</span><span class="w"> </span><span class="c1">// --&gt; true</span>
</pre></div>

<p>You almost <strong>always</strong> want to use <code>Objects.equals()</code>. In the <strong>rare</strong>
situation where you <strong>know</strong> you're dealing with interned strings, you <em>can</em>
use <code>==</code>.</p>
<p>From JLS 3.10.5. <em>String Literals</em> :</p>
<blockquote>
<p>Moreover, a string literal always refers to the <em>same</em> instance of class
<code>String</code>. This is because string literals - or, more generally, strings that
are the values of constant expressions (§15.28) - are "interned" so as to
share unique instances, using the method <code>String.intern</code>.</p>
</blockquote>
<p>Similar examples can also be found in JLS 3.10.5-1.</p>
<h4>Other Methods To Consider</h4>
<p>String.equalsIgnoreCase() value equality that ignores case. Beware, however,
that this method can have unexpected results in various locale-related cases,
see this question.</p>
<p>String.contentEquals() compares the content of the <code>String</code> with the content
of any <code>CharSequence</code> (available since Java 1.5). Saves you from having to
turn your StringBuffer, etc into a String before doing the equality
comparison, but leaves the null checking to you.</p>
<p><br></p>
<h3>Suggest</h3>
<p><code>==</code> tests object references, <code>.equals()</code> tests the string values.</p>
<p>Sometimes it looks as if <code>==</code> compares values, because Java does some behind-
the-scenes stuff to make sure identical in-line strings are actually the same
object.</p>
<p>For example:</p>
<div class="code"><pre class="code literal-block">String fooString1 = new String("foo");
String fooString2 = new String("foo");

// Evaluates to false
fooString1 == fooString2;

// Evaluates to true
fooString1.equals(fooString2);

// Evaluates to true, because Java uses the same object
"bar" == "bar";
</pre></div>

<p><strong>But beware of nulls!</strong></p>
<p><code>==</code> handles <code>null</code> strings fine, but calling <code>.equals()</code> from a null string
will cause an exception:</p>
<div class="code"><pre class="code literal-block">String nullString1 = null;
String nullString2 = null;

// Evaluates to true
System.out.print(nullString1 == nullString2);

// Throws a NullPointerException
System.out.print(nullString1.equals(nullString2));
</pre></div>

<p>So if you know that <code>fooString1</code> may be null, tell the reader that by writing</p>
<div class="code"><pre class="code literal-block">System.out.print(fooString1 != null &amp;&amp; fooString1.equals("bar"));
</pre></div>

<p>The following are shorter, but it’s less obvious that it checks for null:</p>
<div class="code"><pre class="code literal-block">System.out.print("bar".equals(fooString1));  // "bar" is never null
System.out.print(Objects.equals(fooString1, "bar"));  // Java 7 required
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-does-zalgo-text-work/" class="u-url">How does Zalgo text work?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-does-zalgo-text-work/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T16:32:12+08:00" itemprop="datePublished" title="2023-02-17 16:32">2023-02-17 16:32</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I've seen weirdly formatted text called Zalgo like below written on various
forums. It's kind of annoying to look at, but it really bothers me because it
undermines my notion of what a character is supposed to be. My understanding
is that a character is supposed to move horizontally across a line and stay
within a certain "container". Obviously the Zalgo text is moving vertically
and doesn't seem to be restricted to any space.</p>
<p>Is this a bug/flaw/exploit/hack in Unicode? Are these individual characters
with weird properties? "What" is happening here?</p>
<blockquote>
<p>H̡̫̤̤̣͉̤ͭ̓̓̇͗̎̀ơ̯̗̱̘̮͒̄̀̈ͤ̀͡w͓̲͙͖̥͉̹͋ͬ̊ͦ̂̀̚
͎͉͖̌ͯͅͅd̳̘̿̃̔̏ͣ͂̉̕ŏ̖̙͋ͤ̊͗̓͟͜e͈͕̯̮̙̣͓͌ͭ̍̐̃͒s͙͔̺͇̗̱̿̊̇͞
̸̤͓̞̱̫ͩͩ͑̋̀ͮͥͦ̊Z̆̊͊҉҉̠̱̦̩͕ą̟̹͈̺̹̋̅ͯĺ̡̘̹̻̩̩͋͘g̪͚͗ͬ͒o̢̖͇̬͍͇͓̔͋͊̓
̢͈͙͂ͣ̏̿͐͂ͯ͠t̛͓̖̻̲ͤ̈ͣ͝e͋̄ͬ̽͜҉͚̭͇ͅx͎̬̠͇̌ͤ̓̂̓͐͐́͋͡ț̗̹̝̄̌̀ͧͩ̕͢
̮̗̩̳̱̾w͎̭̤͍͇̰̄͗ͭ̃͗ͮ̐o̢̯̻̰̼͕̾ͣͬ̽̔̍͟ͅr̢̪͙͍̠̀ͅǩ̵̶̗̮̮ͪ́?̙͉̥̬͙̟̮͕ͤ̌͗ͩ̕͡  </p>
</blockquote>
<p><br><br></p>
<h2>Answer</h2>
<p>The text uses combining characters, also known as combining marks. See section
2.11 of <em>Combining Characters in the Unicode Standard</em> (PDF).</p>
<p>In Unicode, character rendering does not use a simple character cell model
where each glyph fits into a box with given height. Combining marks may be
rendered above, below, or inside a base character</p>
<p>So you can easily construct a character sequence, consisting of a base
character and “combining above” marks, of any length, to reach any desired
visual height, assuming that the rendering software conforms to the Unicode
rendering model. Such a sequence has no meaning of course, and even a monkey
could produce it (e.g., given a keyboard with suitable driver).</p>
<p>And you can mix “combining above” and “combining below” marks.</p>
<p>The sample text in the question starts with:</p>
<ul>
<li>LATIN CAPITAL LETTER H - <code>&amp;#x48;</code>
</li>
<li>COMBINING LATIN SMALL LETTER T - <code>&amp;#x36d;</code>
</li>
<li>COMBINING GREEK KORONIS - <code>&amp;#x343;</code>
</li>
<li>COMBINING COMMA ABOVE - <code>&amp;#x313;</code>
</li>
<li>COMBINING DOT ABOVE - <code>&amp;#x307;</code>
</li>
</ul>
<p><br></p>
<h3>Suggest</h3>
<p>Zalgo text works because of combining characters. These are special characters
that allow to modify character that comes before.</p>
<p><img alt="enter image description here" src="images/WZFq0.png"></p>
<p>OR</p>
<p>y + ̆ = y̆ which actually is</p>
<div class="code"><pre class="code literal-block">y + &amp;#x0306; = y&amp;#x0306;
</pre></div>

<p>Since you can stack them one atop the other you can produce the following:  </p>
<p>y̆̆̆̆̆̆̆̆̆̆̆̆̆̆̆̆̆̆</p>
<p>which actually is:</p>
<div class="code"><pre class="code literal-block">y&amp;#x0306;&amp;#x0306;&amp;#x0306;&amp;#x0306;&amp;#x0306;&amp;#x0306;&amp;#x0306;&amp;#x0306;&amp;#x0306;&amp;#x0306;&amp;#x0306;&amp;#x0306;&amp;#x0306;&amp;#x0306;&amp;#x0306;&amp;#x0306;&amp;#x0306;&amp;#x0306;
</pre></div>

<p>The same goes for putting stuff underneath:  </p>
<p>y̰̰̰̰̰̰̰̰̰̰̰̰̰̰̰̆̆̆̆̆̆̆̆̆̆̆̆̆̆̆̆̆̆</p>
<p>that in fact is:</p>
<div class="code"><pre class="code literal-block">y&amp;#x0306;&amp;#x0306;&amp;#x0306;&amp;#x0306;&amp;#x0306;&amp;#x0306;&amp;#x0306;&amp;#x0306;&amp;#x0306;&amp;#x0306;&amp;#x0306;&amp;#x0306;&amp;#x0306;&amp;#x0306;&amp;#x0306;&amp;#x0306;&amp;#x0306;&amp;#x0306;&amp;#x0330;&amp;#x0330;&amp;#x0330;&amp;#x0330;&amp;#x0330;&amp;#x0330;&amp;#x0330;&amp;#x0330;&amp;#x0330;&amp;#x0330;&amp;#x0330;&amp;#x0330;&amp;#x0330;&amp;#x0330;&amp;#x0330;
</pre></div>

<p>In Unicode, the main block of combining diacritics for European languages and
the International Phonetic Alphabet is U+0300–U+036F.</p>
<p>More about it here</p>
<p>To produce a list of combining diacritical marks you can use the following
script (since links keep on dying)</p>
<div class="code"><pre class="code literal-block"><span class="k">for</span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">768</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="mi">879</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">){</span><span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">new</span><span class="w"> </span><span class="n">DOMParser</span><span class="p">()</span><span class="o">.</span><span class="n">parseFromString</span><span class="p">(</span><span class="s2">"&amp;#"</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="s2">";"</span><span class="p">,</span><span class="w"> </span><span class="s2">"text/html"</span><span class="p">)</span><span class="o">.</span><span class="n">documentElement</span><span class="o">.</span><span class="n">textContent</span><span class="w"> </span><span class="o">+</span><span class="s2">"  "</span><span class="o">+</span><span class="s2">"&amp;#"</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="s2">";"</span><span class="p">);}</span>
</pre></div>

<p>Also check em out  </p>
<p>Mͣͭͣ̾ Vͣͥͭ͛ͤͮͥͨͥͧ̾</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/what-is-the-runtime-performance-cost-of-a-docker-container/" class="u-url">What is the runtime performance cost of a Docker container?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/what-is-the-runtime-performance-cost-of-a-docker-container/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T16:31:06+08:00" itemprop="datePublished" title="2023-02-17 16:31">2023-02-17 16:31</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I'd like to comprehensively understand the run-time performance cost of a
Docker container. I've found references to networking anecdotally being ~100µs
slower.</p>
<p>I've also found references to the run-time cost being "negligible" and "close
to zero" but I'd like to know more precisely what those costs are. Ideally I'd
like to know what Docker is abstracting with a performance cost and things
that are abstracted without a performance cost. Networking, CPU, memory, etc.</p>
<p>Furthermore, if there are abstraction costs, are there ways to get around the
abstraction cost. For example, perhaps I can mount a disk directly vs.
virtually in Docker.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>An excellent 2014 IBM research paper “An Updated Performance Comparison of
Virtual Machines and Linux Containers” by Felter et al. provides a comparison
between bare metal, KVM, and Docker containers. The general result is:
<strong>Docker is nearly identical to native performance and faster than KVM in
every category.</strong></p>
<p>The exception to this is Docker’s NAT — if you use port mapping (e.g., <code>docker
run -p 8080:8080</code>), then you can expect a minor hit in latency, as shown
below. However, you can now use the host network stack (e.g., <code>docker run
--net=host</code>) when launching a Docker container, which will perform identically
to the Native column (as shown in the Redis latency results lower down).</p>
<p><img alt="Docker NAT overhead" src="images/4yRh1m.png"></p>
<p>They also ran latency tests on a few specific services, such as Redis. You can
see that above 20 client threads, highest latency overhead goes Docker NAT,
then KVM, then a rough tie between Docker host/native.</p>
<p><img alt="Docker Redis Latency Overhead" src="images/9RH9lm.png"></p>
<p>Just because it’s a really useful paper, here are some other figures. Please
download it for full access.</p>
<p>Taking a look at Disk I/O:</p>
<p><img alt="Docker vs. KVM vs. Native I/O Performance" src="images/2Ftytm.png"></p>
<p>Now looking at CPU overhead:</p>
<p><img alt="Docker CPU Overhead" src="images/wZZH6m.png"></p>
<p>Now some examples of memory (read the paper for details, memory can be extra
tricky):</p>
<p><img alt="Docker Memory Comparison" src="images/aHPVkm.png"></p>
<p><br></p>
<h3>Suggest</h3>
<p>Docker isn't virtualization, as such -- instead, it's an abstraction on top of
the kernel's support for different process namespaces, device namespaces,
etc.; one namespace isn't inherently more expensive or inefficient than
another, so what actually makes Docker have a performance impact is a matter
of what's actually <em>in</em> those namespaces.</p>
<hr>
<p>Docker's choices in terms of how it configures namespaces for its containers
have costs, but those costs are all directly associated with benefits -- you
can give them up, but in doing so you also give up the associated benefit:</p>
<ul>
<li>Layered filesystems are expensive -- exactly what the costs are vary with each one (and Docker supports multiple backends), and with your usage patterns (merging multiple large directories, or merging a very deep set of filesystems will be particularly expensive), but they're not free. On the other hand, a great deal of Docker's functionality -- being able to build guests off other guests in a copy-on-write manner, and getting the storage advantages implicit in same -- ride on paying this cost.</li>
<li>DNAT gets expensive at scale -- but gives you the benefit of being able to configure your guest's networking independently of your host's and have a convenient interface for forwarding only the ports you want between them. You can replace this with a bridge to a physical interface, but again, lose the benefit.</li>
<li>Being able to run each software stack with its dependencies installed in the most convenient manner -- independent of the host's distro, libc, and other library versions -- is a great benefit, but needing to load shared libraries more than once (when their versions differ) has the cost you'd expect.</li>
</ul>
<p>And so forth. How much these costs actually impact you in your environment --
with your network access patterns, your memory constraints, etc -- is an item
for which it's difficult to provide a generic answer.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-810.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-808.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
