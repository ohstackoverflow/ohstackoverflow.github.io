<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 1851) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-1851.html">
<link rel="prev" href="index-1852.html" type="text/html">
<link rel="next" href="index-1850.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-can-i-set-node-env-production-on-windows/" class="u-url">How can I set NODE_ENV=production on Windows?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-can-i-set-node-env-production-on-windows/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T10:51:40+08:00" itemprop="datePublished" title="2023-03-03 10:51">2023-03-03 10:51</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>In Ubuntu it's quite simple; I can run the application using:</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span><span class="nv">NODE_ENV</span><span class="o">=</span>production<span class="w"> </span>node<span class="w"> </span>myapp/app.js
</pre></div>

<p>However, this doesn't work on Windows. Is there a configuration file where I
can set the attribute?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Current versions of Windows use Powershell as the default shell, so use:</p>
<div class="code"><pre class="code literal-block">$env:NODE_ENV="production"
</pre></div>

<p>Per @jsalonen's answer below. If you're in CMD (which is no longer
maintained), use</p>
<div class="code"><pre class="code literal-block">set NODE_ENV=production
</pre></div>

<p>This should be executed in the command prompt where you intend to run your
Node.js application.</p>
<p>The above line would set the environment variable NODE_ENV for the command
prompt where you execute the command.</p>
<p>To set environment variables globally so they persist beyond just the single
command prompt, you can find the tool from System in Control Panel (or by
typing 'environment' into the search box in the start menu).</p>
<p><br></p>
<h3>Suggest</h3>
<p>I just found a nice Node.js package that can help a lot to define environment
variables using a unique syntax, cross platform.</p>
<p>https://www.npmjs.com/package/cross-env</p>
<p>It allow you to write something like this:</p>
<div class="code"><pre class="code literal-block">cross-env NODE_ENV=production my-command
</pre></div>

<p>Which is pretty convenient! No Windows or Unix specific commands any more!</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/using-mockito-with-multiple-calls-to-the-same-method-with-the-same-arguments/" class="u-url">Using Mockito with multiple calls to the same method with the same arguments</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/using-mockito-with-multiple-calls-to-the-same-method-with-the-same-arguments/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T10:51:15+08:00" itemprop="datePublished" title="2023-03-03 10:51">2023-03-03 10:51</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Is there a way to have a stubbed method return different objects on subsequent
invocations? I'd like to do this to test nondeterminate responses from an
<code>ExecutorCompletionService</code>. i.e. to test that irrespective of the return
order of the methods, the outcome remains constant.</p>
<p>The code I'm looking to test looks something like this.</p>
<div class="code"><pre class="code literal-block"><span class="c1">// Create an completion service so we can group these tasks together</span>
<span class="n">ExecutorCompletionService</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">completionService</span><span class="w"> </span><span class="p">=</span>
<span class="w">        </span><span class="n">new</span><span class="w"> </span><span class="n">ExecutorCompletionService</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">(</span><span class="n">service</span><span class="p">);</span>

<span class="c1">// Add all these tasks to the completion service</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">Callable</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ts</span><span class="p">)</span>
<span class="w">    </span><span class="n">completionService</span><span class="p">.</span><span class="n">submit</span><span class="p">(</span><span class="n">request</span><span class="p">);</span>

<span class="c1">// As an when each call finished, add it to the response set.</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nb">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">calls</span><span class="p">.</span><span class="nb">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">T</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">completionService</span><span class="p">.</span><span class="n">take</span><span class="p">().</span><span class="k">get</span><span class="p">();</span>
<span class="w">        </span><span class="c1">// do some stuff that I want to test</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(...)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">}</span><span class="w">        </span>
<span class="p">}</span>
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<p>You can do that using the <code>thenAnswer</code> method (when chaining with <code>when</code>):</p>
<div class="code"><pre class="code literal-block"><span class="nv">when</span><span class="ss">(</span><span class="nv">someMock</span>.<span class="nv">someMethod</span><span class="ss">())</span>.<span class="nv">thenAnswer</span><span class="ss">(</span><span class="nv">new</span><span class="w"> </span><span class="nv">Answer</span><span class="ss">()</span><span class="w"> </span>{
<span class="w">    </span><span class="nv">private</span><span class="w"> </span><span class="nv">int</span><span class="w"> </span><span class="nv">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="c1">;</span>

<span class="w">    </span><span class="nv">public</span><span class="w"> </span><span class="nv">Object</span><span class="w"> </span><span class="nv">answer</span><span class="ss">(</span><span class="nv">InvocationOnMock</span><span class="w"> </span><span class="nv">invocation</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">count</span><span class="o">++</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="ss">)</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="c1">;</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">2</span><span class="c1">;</span>
<span class="w">    </span>}
}<span class="ss">)</span><span class="c1">;</span>
</pre></div>

<p>Or using the equivalent, static <code>doAnswer</code> method:</p>
<div class="code"><pre class="code literal-block"><span class="nv">doAnswer</span><span class="ss">(</span><span class="nv">new</span><span class="w"> </span><span class="nv">Answer</span><span class="ss">()</span><span class="w"> </span>{
<span class="w">    </span><span class="nv">private</span><span class="w"> </span><span class="nv">int</span><span class="w"> </span><span class="nv">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="c1">;</span>

<span class="w">    </span><span class="nv">public</span><span class="w"> </span><span class="nv">Object</span><span class="w"> </span><span class="nv">answer</span><span class="ss">(</span><span class="nv">InvocationOnMock</span><span class="w"> </span><span class="nv">invocation</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">count</span><span class="o">++</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="ss">)</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="c1">;</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">2</span><span class="c1">;</span>
<span class="w">    </span>}
}<span class="ss">)</span>.<span class="nv">when</span><span class="ss">(</span><span class="nv">someMock</span><span class="ss">)</span>.<span class="nv">someMethod</span><span class="ss">()</span><span class="c1">;</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>You can do that using the <code>thenAnswer</code> method (when chaining with <code>when</code>):</p>
<div class="code"><pre class="code literal-block"><span class="nv">when</span><span class="ss">(</span><span class="nv">someMock</span>.<span class="nv">someMethod</span><span class="ss">())</span>.<span class="nv">thenAnswer</span><span class="ss">(</span><span class="nv">new</span><span class="w"> </span><span class="nv">Answer</span><span class="ss">()</span><span class="w"> </span>{
<span class="w">    </span><span class="nv">private</span><span class="w"> </span><span class="nv">int</span><span class="w"> </span><span class="nv">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="c1">;</span>

<span class="w">    </span><span class="nv">public</span><span class="w"> </span><span class="nv">Object</span><span class="w"> </span><span class="nv">answer</span><span class="ss">(</span><span class="nv">InvocationOnMock</span><span class="w"> </span><span class="nv">invocation</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">count</span><span class="o">++</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="ss">)</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="c1">;</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">2</span><span class="c1">;</span>
<span class="w">    </span>}
}<span class="ss">)</span><span class="c1">;</span>
</pre></div>

<p>Or using the equivalent, static <code>doAnswer</code> method:</p>
<div class="code"><pre class="code literal-block"><span class="nv">doAnswer</span><span class="ss">(</span><span class="nv">new</span><span class="w"> </span><span class="nv">Answer</span><span class="ss">()</span><span class="w"> </span>{
<span class="w">    </span><span class="nv">private</span><span class="w"> </span><span class="nv">int</span><span class="w"> </span><span class="nv">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="c1">;</span>

<span class="w">    </span><span class="nv">public</span><span class="w"> </span><span class="nv">Object</span><span class="w"> </span><span class="nv">answer</span><span class="ss">(</span><span class="nv">InvocationOnMock</span><span class="w"> </span><span class="nv">invocation</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">count</span><span class="o">++</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="ss">)</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="c1">;</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">2</span><span class="c1">;</span>
<span class="w">    </span>}
}<span class="ss">)</span>.<span class="nv">when</span><span class="ss">(</span><span class="nv">someMock</span><span class="ss">)</span>.<span class="nv">someMethod</span><span class="ss">()</span><span class="c1">;</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/can-you-use-a-trailing-comma-in-a-json-object/" class="u-url">Can you use a trailing comma in a JSON object?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/can-you-use-a-trailing-comma-in-a-json-object/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T10:50:44+08:00" itemprop="datePublished" title="2023-03-03 10:50">2023-03-03 10:50</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>When manually generating a JSON object or array, it's often easier to leave a
trailing comma on the last item in the object or array. For example, code to
output from an array of strings might look like (in a C++ like pseudocode):</p>
<div class="code"><pre class="code literal-block"><span class="nv">s</span>.<span class="nv">append</span><span class="ss">(</span><span class="s2">"["</span><span class="ss">)</span><span class="c1">;</span>
<span class="k">for</span><span class="w"> </span><span class="ss">(</span><span class="nv">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="c1">; i &lt; 5; ++i) {</span>
<span class="w">    </span><span class="nv">s</span>.<span class="nv">appendF</span><span class="ss">(</span><span class="s2">"\"</span><span class="o">%</span><span class="nv">d</span>\<span class="s2">","</span>,<span class="w"> </span><span class="nv">i</span><span class="ss">)</span><span class="c1">;</span>
}
<span class="nv">s</span>.<span class="nv">append</span><span class="ss">(</span><span class="s2">"]"</span><span class="ss">)</span><span class="c1">;</span>
</pre></div>

<p>giving you a string like</p>
<div class="code"><pre class="code literal-block">[0,1,2,3,4,5,]
</pre></div>

<p>Is this allowed?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Unfortunately the JSON specification does not allow a trailing comma. There
are a few browsers that will allow it, but generally you need to worry about
all browsers.</p>
<p>In general I try turn the problem around, and add the comma before the actual
value, so you end up with code that looks like this:</p>
<div class="code"><pre class="code literal-block"><span class="nv">s</span>.<span class="nv">append</span><span class="ss">(</span><span class="s2">"["</span><span class="ss">)</span><span class="c1">;</span>
<span class="k">for</span><span class="w"> </span><span class="ss">(</span><span class="nv">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="c1">; i &lt; 5; ++i) {</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">i</span><span class="ss">)</span><span class="w"> </span><span class="nv">s</span>.<span class="nv">append</span><span class="ss">(</span><span class="s2">","</span><span class="ss">)</span><span class="c1">; // add the comma only if this isn't the first entry</span>
<span class="w">  </span><span class="nv">s</span>.<span class="nv">appendF</span><span class="ss">(</span><span class="s2">"\"</span><span class="o">%</span><span class="nv">d</span>\<span class="s2">""</span>,<span class="w"> </span><span class="nv">i</span><span class="ss">)</span><span class="c1">;</span>
}
<span class="nv">s</span>.<span class="nv">append</span><span class="ss">(</span><span class="s2">"]"</span><span class="ss">)</span><span class="c1">;</span>
</pre></div>

<p>That extra one line of code in your for loop is hardly expensive...</p>
<p>Another alternative I've used when output a structure to JSON from a
dictionary of some form is to always append a comma after each entry (as you
are doing above) and then add a dummy entry at the end that has not trailing
comma (but that is just lazy ;-&gt;).</p>
<p>Doesn't work well with an array unfortunately.</p>
<p><br></p>
<h3>Suggest</h3>
<p>No. The JSON spec, as maintained at http://json.org, does not allow trailing
commas. From what I've seen, some parsers may silently allow them when reading
a JSON string, while others will throw errors. For interoperability, you
shouldn't include it.</p>
<p>The code above could be restructured, either to remove the trailing comma when
adding the array terminator or to add the comma before items, skipping that
for the first one.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-1852.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-1850.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
