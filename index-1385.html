<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 1385) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-1385.html">
<link rel="prev" href="index-1386.html" type="text/html">
<link rel="next" href="index-1384.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/pseudocode-interpreter/" class="u-url">Pseudocode interpreter?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/pseudocode-interpreter/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-28T02:53:22+08:00" itemprop="datePublished" title="2023-02-28 02:53">2023-02-28 02:53</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Like lots of you guys on SO, I often write in several languages. And when it
comes to planning stuff, (or even answering some SO questions), I actually
think and write in some unspecified hybrid language. Although I used to be
taught to do this using flow diagrams or UML-like diagrams, in retrospect, I
find <strong>"my"</strong> pseudocode language has components of <code>C</code>, <code>Python</code>, <code>Java</code>,
<code>bash</code>, <code>Matlab</code>, <code>perl</code>, <code>Basic</code>. I seem to unconsciously select the idiom
best suited to expressing the concept/algorithm.</p>
<p>Common idioms might include Java-like braces for scope, pythonic list
comprehensions or indentation, C++like inheritance, C#-style lambdas, matlab-
like slices and matrix operations.</p>
<p>I noticed that it's actually quite easy for people to recognise exactly what
I'm triying to do, and quite easy for people to intelligently translate into
other languages. Of course, that step involves considering the corner cases,
and the moments where each language behaves idiosyncratically.</p>
<p>But in reality, most of these languages share a subset of keywords and library
functions which generally behave identically - maths functions, type names,
<code>while</code>/<code>for</code>/<code>if</code> etc. Clearly I'd have to exclude many 'odd' languages like
lisp, APL derivatives, but...</p>
<p>So my questions are,</p>
<ol>
<li>
<p>Does code already exist that <strong>recognises the programming language</strong> of a text file? (Surely this must be a less complicated task than eclipse's syntax trees or than google translate's language guessing feature, right?) In fact, does the SO syntax highlighter do anything like this?</p>
</li>
<li>
<p>Is it <strong>theoretically possible</strong> to create a single interpreter or compiler that recognises what language idiom you're using at any moment and (maybe "intelligently") executes or translates to a runnable form. And flags the corner cases where my syntax is ambiguous with regards to behaviour. Immediate difficulties I see include: knowing when to switch between indentation-dependent and brace-dependent modes, recognising funny operators (like <code>*pointer</code> vs <code>*kwargs</code>) and knowing when to use list vs array-like representations.</p>
</li>
<li>
<p>Is there any language or interpreter in existence, that can manage this kind of flexible interpreting? </p>
</li>
<li>
<p>Have I missed an obvious obstacle to this being possible?</p>
</li>
</ol>
<h3>edit</h3>
<p>Thanks all for your answers and ideas. I am planning to write a constraint-
based heuristic translator that could, <em>potentially</em> , "solve" code for the
intended meaning and translate into real python code. It will notice keywords
from many common languages, and will use syntactic clues to disambiguate the
human's intentions - like spacing, brackets, optional helper words like <code>let</code>
or <code>then</code>, context of how variables are previously used etc, plus knowledge of
common conventions (like capital names, i for iteration, and some simplistic
limited understanding of naming of variables/methods e.g containing the word
<code>get</code>, <code>asynchronous</code>, <code>count</code>, <code>last</code>, <code>previous</code>, <code>my</code> etc). In real
pseudocode, variable naming is as informative as the operations themselves!</p>
<p>Using these clues it will create assumptions as to the implementation of each
operation (like 0/1 based indexing, when should exceptions be caught or
ignored, what variables ought to be const/global/local, where to start and end
execution, and what bits should be in separate threads, notice when numerical
units match / need converting). Each assumption will have a given certainty -
and the program will <strong>list the assumptions</strong> on each statement, as it coaxes
what you write into something executable!</p>
<p>For each assumption, you can 'clarify' your code if you don't like the initial
interpretation. The libraries issue is very interesting. My translator, like
some IDE's, will read all definitions available from all modules, use some
statistics about which classes/methods are used most frequently and in what
contexts, and just guess! (adding a note to the program to say why it guessed
as such...) I guess it should attempt to execute everything, and warn you
about what it doesn't like. It should <strong>allow anything</strong> , but let you know
what the several alternative interpretations are, if you're being ambiguous.</p>
<p>It will certainly be some time before it can manage such unusual examples like
@Albin Sunnanbo's <code>ImportantCustomer</code> example. But I'll let you know how I get
on!</p>
<p><br><br></p>
<h2>Answer</h2>
<ol>
<li>To detect what programming language is used: Detecting programming language from a snippet</li>
<li>I think it should be possible. The approach in 1. could be leveraged to do this, I think. I would try to do it iteratively: detect the syntax used in the first line/clause of code, "compile" it to intermediate form based on that detection, along with any important syntax (e.g. begin/end wrappers). Then the next line/clause etc. Basically write a parser that attempts to recognize each "chunk". Ambiguity could be flagged by the same algorithm.</li>
<li>I doubt that this has been done ... seems like the cognitive load of learning to write e.g. python-compatible pseudocode would be much easier than trying to debug the cases where your interpreter fails.</li>
<li>a. I think the biggest problem is that most pseudocode is invalid in any language. For example, I might completely skip object initialization in a block of pseudocode because for a human reader it is almost always straightforward to infer. But for your case it might be completely invalid in the language syntax of choice, and it might be impossible to automatically determine e.g. the class of the object (it might not even exist). Etc.<br>
b. I think the best you can hope for is an interpreter that "works" (subject
to 4a) for <em>your</em> pseudocode only, no-one else's.</li>
</ol>
<p>Note that I don't think that 4a,4b are necessarily obstacles to it being
possible. I just think it won't be useful for any practical purpose.</p>
<p><br></p>
<h3>Suggest</h3>
<ol>
<li>To detect what programming language is used: Detecting programming language from a snippet</li>
<li>I think it should be possible. The approach in 1. could be leveraged to do this, I think. I would try to do it iteratively: detect the syntax used in the first line/clause of code, "compile" it to intermediate form based on that detection, along with any important syntax (e.g. begin/end wrappers). Then the next line/clause etc. Basically write a parser that attempts to recognize each "chunk". Ambiguity could be flagged by the same algorithm.</li>
<li>I doubt that this has been done ... seems like the cognitive load of learning to write e.g. python-compatible pseudocode would be much easier than trying to debug the cases where your interpreter fails.</li>
<li>a. I think the biggest problem is that most pseudocode is invalid in any language. For example, I might completely skip object initialization in a block of pseudocode because for a human reader it is almost always straightforward to infer. But for your case it might be completely invalid in the language syntax of choice, and it might be impossible to automatically determine e.g. the class of the object (it might not even exist). Etc.<br>
b. I think the best you can hope for is an interpreter that "works" (subject
to 4a) for <em>your</em> pseudocode only, no-one else's.</li>
</ol>
<p>Note that I don't think that 4a,4b are necessarily obstacles to it being
possible. I just think it won't be useful for any practical purpose.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/differences-between-backtracking-and-brute-force-search/" class="u-url">Differences between backtracking and brute-force search</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/differences-between-backtracking-and-brute-force-search/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-28T02:53:05+08:00" itemprop="datePublished" title="2023-02-28 02:53">2023-02-28 02:53</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I'm currently taking a course in algorithms, and I'm having some difficulty
understanding the exact definitions of brute-force search and backtracking. As
I understand it, the following is true:</p>
<ul>
<li>
<em>Brute-force search</em> ( <em>BFS</em> ) is a type of algorithm which computes every possible solution to a problem and then selects one that fulfills the requirements.</li>
<li>
<em>Explicit</em> constraints give the possible values for each choice (e.g., choices 1-3 are limited to <code>{1, 2}</code>, choice 4 is limited to <code>{3, 4, 5}</code>, etc.), which determines how the search's "execution tree" is shaped.</li>
<li>
<em>Implicit</em> constraints relate the different choices to eachother (e.g., choice 2 must be greater than choice 1, etc.), which is used in BFS to remove potential solutions.</li>
<li>
<em>Backtracking</em> is an extension to BFS in which the <em>implicit</em> constraints are evaluated after every choice (as opposed to <em>after</em> all solutions have been generated), which means that potential solutions can be discarded before they have been 'finished'.</li>
</ul>
<p>Basically, all I'm wondering is whether this is accurate or not, and, if it
isn't, I'd really appreciate some clarification. Thanks in advance.</p>
<p><br><br></p>
<h2>Answer</h2>
<p><strong>Short answer</strong> : If I read the question correctly, you are <strong>correct</strong>.</p>
<p>Well like you say <strong><em>explicit constraints</em></strong> are constraints on the <em>domain</em>
of each variable so <em>x i∈Si</em>. Note that <em>S i</em> does not have to be stated as a
collection. You could for instance state that <em>S 0</em> is the set of all prime
numbers less than 25.</p>
<p><strong><em>Implicit constraints</em></strong> on the other hand, are predicates that are defined
over <em>two or more variables</em> <em>P(x 1,x2,...,xn)</em>. For instance <em>x 2&lt;x3</em>. But it
can also be defined over more variables (for example three).</p>
<p><strong><em>Brute force search</em></strong> only takes the <em>explicit</em> constraints into account:
it assigns all possible values from <em>S i</em> to a variable <em>x i</em> and this for
<em>all</em> variables. After it has constructed such a <em>configuration</em> , it verifies
that all <em>implicit constraints are satisfied</em>.</p>
<p><strong><em>Backtracking</em></strong> on the other hand aims to optimize this process. From the
moment that all variables over which an <em>implicit constraint</em> is defined are
assigned, it verifies that constraint. If the constraint fails, then it
immediately assigns a different value to one of the variables. The advantage
is that if for instance brute force has assigned 2 to <em>x 1=2</em> and 5 to <em>x
2=5</em>, and the implicit constraint <em>x 1 &gt; x2</em> fails, then it will not assign
values to <em>x 3,x4,...</em> only to find out that for all configurations for these
values it fail.</p>
<p>Of course there is some bookkeeping involved in backtracking: you need to find
out which constraints "fire" when a certain value is set. But for a lot of
<em>constraint programming</em> problems (like for instance SAT), there exists
efficient algorithms to do that (with <em>watched literals</em> , etc.). Furthermore
constraint programming libraries like <em>Gecode</em> also have advanced queuing
mechanisms such that fast constraints are evaluated first, etc.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/fine-tuning-parameters-in-logistic-regression/" class="u-url">Fine-tuning parameters in Logistic Regression</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/fine-tuning-parameters-in-logistic-regression/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-28T02:52:40+08:00" itemprop="datePublished" title="2023-02-28 02:52">2023-02-28 02:52</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I am running a logistic regression with a tf-idf being ran on a text column.
This is the only column I use in my logistic regression. How can I ensure the
parameters for this are tuned as well as possible?</p>
<p>I would like to be able to run through a set of steps which would ultimately
allow me say that my Logistic Regression classifier is running as well as it
possibly can.</p>
<div class="code"><pre class="code literal-block"><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span><span class="p">,</span><span class="n">preprocessing</span><span class="p">,</span><span class="n">cross_validation</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">TfidfVectorizer</span>
<span class="kn">import</span> <span class="nn">sklearn.linear_model</span> <span class="k">as</span> <span class="nn">lm</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">p</span>
<span class="n">loadData</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">f</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">),</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">' '</span><span class="p">)</span>

<span class="nb">print</span> <span class="s2">"loading data.."</span>
<span class="n">traindata</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="s1">'train.tsv'</span><span class="p">))[:,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">testdata</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="s1">'test.tsv'</span><span class="p">))[:,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="s1">'train.tsv'</span><span class="p">))[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="n">tfv</span> <span class="o">=</span> <span class="n">TfidfVectorizer</span><span class="p">(</span><span class="n">min_df</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">max_features</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">strip_accents</span><span class="o">=</span><span class="s1">'unicode'</span><span class="p">,</span>
                      <span class="n">analyzer</span><span class="o">=</span><span class="s1">'word'</span><span class="p">,</span> <span class="n">token_pattern</span><span class="o">=</span><span class="sa">r</span><span class="s1">'\w{1,}'</span><span class="p">,</span> 
                      <span class="n">ngram_range</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">use_idf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">smooth_idf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                      <span class="n">sublinear_tf</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">rd</span> <span class="o">=</span> <span class="n">lm</span><span class="o">.</span><span class="n">LogisticRegression</span><span class="p">(</span><span class="n">penalty</span><span class="o">=</span><span class="s1">'l2'</span><span class="p">,</span> <span class="n">dual</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> 
                           <span class="n">C</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fit_intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">intercept_scaling</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> 
                           <span class="n">class_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="n">X_all</span> <span class="o">=</span> <span class="n">traindata</span> <span class="o">+</span> <span class="n">testdata</span>
<span class="n">lentrain</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">traindata</span><span class="p">)</span>

<span class="nb">print</span> <span class="s2">"fitting pipeline"</span>
<span class="n">tfv</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_all</span><span class="p">)</span>
<span class="nb">print</span> <span class="s2">"transforming data"</span>
<span class="n">X_all</span> <span class="o">=</span> <span class="n">tfv</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_all</span><span class="p">)</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">X_all</span><span class="p">[:</span><span class="n">lentrain</span><span class="p">]</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">X_all</span><span class="p">[</span><span class="n">lentrain</span><span class="p">:]</span>

<span class="nb">print</span> <span class="s2">"20 Fold CV Score: "</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cross_validation</span><span class="o">.</span><span class="n">cross_val_score</span><span class="p">(</span><span class="n">rd</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">'roc_auc'</span><span class="p">))</span>

<span class="nb">print</span> <span class="s2">"training on full data"</span>
<span class="n">rd</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">rd</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">testfile</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'test.tsv'</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">"</span><span class="se">\t</span><span class="s2">"</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s1">'?'</span><span class="p">],</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">pred_df</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">testfile</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'label'</span><span class="p">])</span>
<span class="n">pred_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">'benchmark.csv'</span><span class="p">)</span>
<span class="nb">print</span> <span class="s2">"submission file created.."</span>
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<p>You can use grid search to find out the best <code>C</code> value for you. Basically
smaller <code>C</code> specify stronger regularization.</p>
<div class="code"><pre class="code literal-block">&gt;&gt;&gt; param_grid = {'C': [0.001, 0.01, 0.1, 1, 10, 100, 1000] }
&gt;&gt;&gt; clf = GridSearchCV(LogisticRegression(penalty='l2'), param_grid)
GridSearchCV(cv=None,
             estimator=LogisticRegression(C=1.0, intercept_scaling=1,   
               dual=False, fit_intercept=True, penalty='l2', tol=0.0001),
             param_grid={'C': [0.001, 0.01, 0.1, 1, 10, 100, 1000]})
</pre></div>

<p>See the GridSearchCv document for more details on your application.</p>
<p><br></p>
<h3>Suggest</h3>
<p>You may use below code for more general details:</p>
<div class="code"><pre class="code literal-block"><span class="nv">LR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">LogisticRegression</span><span class="ss">()</span>
<span class="nv">LRparam_grid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>{
<span class="w">    </span><span class="s1">'C'</span>:<span class="w"> </span>[<span class="mi">0</span>.<span class="mi">001</span>,<span class="w"> </span><span class="mi">0</span>.<span class="mi">01</span>,<span class="w"> </span><span class="mi">0</span>.<span class="mi">1</span>,<span class="w"> </span><span class="mi">1</span>,<span class="w"> </span><span class="mi">10</span>,<span class="w"> </span><span class="mi">100</span>,<span class="w"> </span><span class="mi">1000</span>],
<span class="w">    </span><span class="s1">'penalty'</span>:<span class="w"> </span>[<span class="s1">'l1'</span>,<span class="w"> </span><span class="s1">'l2'</span>],
<span class="w">    </span>#<span class="w"> </span><span class="s1">'max_iter'</span>:<span class="w"> </span><span class="nv">list</span><span class="ss">(</span><span class="nv">range</span><span class="ss">(</span><span class="mi">100</span>,<span class="mi">800</span>,<span class="mi">100</span><span class="ss">))</span>,
<span class="w">    </span><span class="s1">'solver'</span>:<span class="w"> </span>[<span class="s1">'newton-cg'</span>,<span class="w"> </span><span class="s1">'lbfgs'</span>,<span class="w"> </span><span class="s1">'liblinear'</span>,<span class="w"> </span><span class="s1">'sag'</span>,<span class="w"> </span><span class="s1">'saga'</span>]
}
<span class="nv">LR_search</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">GridSearchCV</span><span class="ss">(</span><span class="nv">LR</span>,<span class="w"> </span><span class="nv">param_grid</span><span class="o">=</span><span class="nv">LRparam_grid</span>,<span class="w"> </span><span class="nv">refit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">True</span>,<span class="w"> </span><span class="nv">verbose</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span>,<span class="w"> </span><span class="nv">cv</span><span class="o">=</span><span class="mi">5</span><span class="ss">)</span>

#<span class="w"> </span><span class="nv">fitting</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">model</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">grid</span><span class="w"> </span><span class="nv">search</span><span class="w"> </span>
<span class="nv">LR_search</span>.<span class="nv">fit</span><span class="ss">(</span><span class="nv">X_train</span><span class="w"> </span>,<span class="w"> </span><span class="nv">y_train</span><span class="ss">)</span>
<span class="nv">LR_search</span>.<span class="nv">best_params_</span>
#<span class="w"> </span><span class="nv">summarize</span>
<span class="nv">print</span><span class="ss">(</span><span class="s1">'Mean Accuracy: %.3f'</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="nv">LR_search</span>.<span class="nv">best_score_</span><span class="ss">)</span>
<span class="nv">print</span><span class="ss">(</span><span class="s1">'Config: %s'</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="nv">LR_search</span>.<span class="nv">best_params_</span><span class="ss">)</span>
</pre></div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-1386.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-1384.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
