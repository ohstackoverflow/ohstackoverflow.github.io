<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 814) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-814.html">
<link rel="prev" href="index-815.html" type="text/html">
<link rel="next" href="index-813.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/interop-type-cannot-be-embedded/" class="u-url">Interop type cannot be embedded</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/interop-type-cannot-be-embedded/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T16:40:11+08:00" itemprop="datePublished" title="2023-02-17 16:40">2023-02-17 16:40</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I am creating a web application on the .NET 4.0 framework (beta2) in C#.</p>
<p>When I try to use a assembly called "ActiveHomeScriptLib", I get the following
error:</p>
<blockquote>
<p>Interop type 'ActiveHomeScriptLib.ActiveHomeClass' cannot be embedded. Use
the applicable interface instead.</p>
</blockquote>
<p>When I change the framework to version 3.5, I don't have any errors.</p>
<p>What is an Interop Type and why does this only occur when I use the 4.0
framework?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>.NET 4.0 allows primary interop assemblies (or rather, the bits of it that you
need) to be embedded into your assembly so that you don't need to deploy them
alongside your application.</p>
<p>For whatever reason, this assembly can't be embedded - but it sounds like
that's not a problem for you. Just open the Properties tab for the assembly in
Visual Studio 2010 and set "Embed Interop Types" to "False".</p>
<p>EDIT: See also Michael Gustus's answer, removing the <code>Class</code> suffix from the
types you're using.</p>
<p><br></p>
<h3>Suggest</h3>
<p>In most cases, this error is the result of code which tries to instantiate a
COM object. For example, here is a piece of code starting up Excel:</p>
<div class="code"><pre class="code literal-block">Excel.ApplicationClass xlapp = new Excel.ApplicationClass();
</pre></div>

<p>Typically, in .NET 4 you just need to remove the 'Class' suffix and compile
the code:</p>
<div class="code"><pre class="code literal-block">Excel.Application xlapp = new Excel.Application();
</pre></div>

<p>An MSDN explanation is here.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/finding-the-max-value-of-an-attribute-in-an-array-of-objects/" class="u-url">Finding the max value of an attribute in an array of objects</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/finding-the-max-value-of-an-attribute-in-an-array-of-objects/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T16:39:44+08:00" itemprop="datePublished" title="2023-02-17 16:39">2023-02-17 16:39</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I'm looking for a really quick, clean and efficient way to get the max "y"
value in the following JSON slice:</p>
<div class="code"><pre class="code literal-block">[
  {
    "x": "8/11/2009",
    "y": 0.026572007
  },
  {
    "x": "8/12/2009",
    "y": 0.025057454
  },
  {
    "x": "8/13/2009",
    "y": 0.024530916
  },
  {
    "x": "8/14/2009",
    "y": 0.031004457
  }
]
</pre></div>

<p>Is a for-loop the only way to go about it? I'm keen on somehow using
<code>Math.max</code>.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>To find the maximum <code>y</code> value of the objects in <code>array</code>:</p>
<div class="code"><pre class="code literal-block"><span class="w">    </span><span class="nv">Math</span>.<span class="nv">max</span>.<span class="nv">apply</span><span class="ss">(</span><span class="nv">Math</span>,<span class="w"> </span><span class="nv">array</span>.<span class="nv">map</span><span class="ss">(</span><span class="nv">function</span><span class="ss">(</span><span class="nv">o</span><span class="ss">)</span><span class="w"> </span>{<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nv">o</span>.<span class="nv">y</span><span class="c1">; }))</span>
</pre></div>

<p>or in more modern JavaScript:</p>
<div class="code"><pre class="code literal-block">    Math.max(...array.map(o =&gt; o.y))
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<h3>Find the object whose property "Y" has the greatest value in an array of</h3>
<p>objects</p>
<p>One way would be to use Array reduce..</p>
<div class="code"><pre class="code literal-block"><span class="k">const</span><span class="w"> </span><span class="nb">max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">function</span><span class="p">(</span><span class="n">prev</span><span class="p">,</span><span class="w"> </span><span class="n">current</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">prev</span><span class="o">.</span><span class="n">y</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">current</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="err">?</span><span class="w"> </span><span class="n">prev</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">current</span>
<span class="p">})</span><span class="w"> </span><span class="o">//</span><span class="n">returns</span><span class="w"> </span><span class="n">object</span>
</pre></div>

<p>https://developer.mozilla.org/en-
US/docs/Web/JavaScript/Reference/Global_Objects/Array/Reduce
http://caniuse.com/#search=reduce (IE9 and above)</p>
<p>If you don't need to support IE (only Edge), or can use a pre-compiler such as
Babel you could use the more terse syntax.</p>
<div class="code"><pre class="code literal-block"><span class="k">const</span><span class="w"> </span><span class="nb">max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="o">.</span><span class="n">reduce</span><span class="p">((</span><span class="n">prev</span><span class="p">,</span><span class="w"> </span><span class="n">current</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">prev</span><span class="o">.</span><span class="n">y</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">current</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="err">?</span><span class="w"> </span><span class="n">prev</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">current</span><span class="p">)</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/can-an-abstract-class-have-a-constructor/" class="u-url">Can an abstract class have a constructor?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/can-an-abstract-class-have-a-constructor/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T16:39:16+08:00" itemprop="datePublished" title="2023-02-17 16:39">2023-02-17 16:39</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Can an abstract class have a constructor?</p>
<p>If so, how can it be used and for what purposes?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Yes, an abstract class can have a constructor. Consider this:</p>
<div class="code"><pre class="code literal-block"><span class="n">abstract</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">Product</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="w">    </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">multiplyBy</span><span class="p">;</span>
<span class="w">    </span><span class="n">public</span><span class="w"> </span><span class="n">Product</span><span class="p">(</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">multiplyBy</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">this</span><span class="o">.</span><span class="n">multiplyBy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">multiplyBy</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">public</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">mutiply</span><span class="p">(</span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">       </span><span class="k">return</span><span class="w"> </span><span class="n">multiplyBy</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">val</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">class</span><span class="w"> </span><span class="n">TimesTwo</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="n">Product</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">public</span><span class="w"> </span><span class="n">TimesTwo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">super</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">class</span><span class="w"> </span><span class="n">TimesWhat</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="n">Product</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">public</span><span class="w"> </span><span class="n">TimesWhat</span><span class="p">(</span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">what</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">super</span><span class="p">(</span><span class="n">what</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p>The superclass <code>Product</code> is abstract and has a constructor. The concrete class
<code>TimesTwo</code> has a constructor that just hardcodes the value 2. The concrete
class <code>TimesWhat</code> has a constructor that allows the caller to specify the
value.</p>
<p>Abstract constructors will frequently be used to enforce class constraints or
invariants such as the minimum fields required to setup the class.</p>
<blockquote>
<p>NOTE: As there is no default (or no-arg) constructor in the parent abstract
class, the constructor used in subclass must explicitly call the parent
constructor.</p>
</blockquote>
<p><br></p>
<h3>Suggest</h3>
<p>You would define a constructor in an abstract class if you are in one of these
situations:</p>
<ul>
<li>you want to perform some initialization (to fields of the abstract class) before the instantiation of a subclass actually takes place</li>
<li>you have defined final fields in the abstract class but you did not initialize them in the declaration itself; in this case, you MUST have a constructor to initialize these fields</li>
</ul>
<p>Note that:</p>
<ul>
<li>you may define more than one constructor (with different arguments)</li>
<li>you can (should?) define all your constructors protected (making them public is pointless anyway)</li>
<li>your subclass constructor(s) can call one constructor of the abstract class; it may even <strong>have to</strong> call it (if there is no no-arg constructor in the abstract class)</li>
</ul>
<p>In any case, don't forget that if you don't define a constructor, then the
compiler will automatically generate one for you (this one is public, has no
argument, and does nothing).</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-815.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-813.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
