<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 2283) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-2283.html">
<link rel="prev" href="index-2284.html" type="text/html">
<link rel="next" href="index-2282.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/pass-mouse-events-through-absolutely-positioned-element/" class="u-url">Pass mouse events through absolutely-positioned element</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/pass-mouse-events-through-absolutely-positioned-element/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T04:39:39+08:00" itemprop="datePublished" title="2023-03-04 04:39">2023-03-04 04:39</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I'm attempting to capture mouse events on an element with another absolutely-
positioned element on top of it.</p>
<p>Right now, events on the absolutely-positioned element hit it and bubble up to
its parent, but I want it to be "transparent" to these mouse events and
forward them on to whatever is behind it. How should I implement this?</p>
<p><br><br></p>
<h2>Answer</h2>
<div class="code"><pre class="code literal-block"><span class="nt">pointer-events</span><span class="o">:</span><span class="w"> </span><span class="nt">none</span><span class="o">;</span>
</pre></div>

<p>Is a CSS property that makes events "pass through" the HTML-element to which
the property is applied. It makes the event occur on the element "below".</p>
<p>See for details: https://developer.mozilla.org/en-US/docs/Web/CSS/pointer-
events</p>
<p>It is supported by almost all browsers, including IE11; global support was
~98.2% in 05/'21): http://caniuse.com/#feat=pointer-events (thanks to @s4y for
providing the link in the comments).</p>
<p><br></p>
<h3>Suggest</h3>
<p>Also nice to know...<br>
Pointer-events can be disabled for a parent element (probably transparent div)
and yet be enabled for child elements. This is helpful if you work with
multiple overlapping div layers, where you want to be able click the child
elements of any layer. For this all parenting divs get <code>pointer-events: none</code>
and click-children get pointer-events reenabled by <code>pointer-events: all</code></p>
<div class="code"><pre class="code literal-block">.parent<span class="w"> </span>{
<span class="w">    </span>pointer-events:none;<span class="w">        </span>
}
.child<span class="w"> </span>{
<span class="w">    </span>pointer-events:all;
}

<span class="nt">&lt;div</span><span class="w"> </span><span class="na">class=</span><span class="s">"some-container"</span><span class="nt">&gt;</span>
<span class="w">   </span><span class="nt">&lt;ul</span><span class="w"> </span><span class="na">class=</span><span class="s">"layer-0 parent"</span><span class="nt">&gt;</span>
<span class="w">     </span><span class="nt">&lt;li</span><span class="w"> </span><span class="na">class=</span><span class="s">"click-me child"</span><span class="nt">&gt;&lt;/li&gt;</span>
<span class="w">     </span><span class="nt">&lt;li</span><span class="w"> </span><span class="na">class=</span><span class="s">"click-me child"</span><span class="nt">&gt;&lt;/li&gt;</span>
<span class="w">   </span><span class="nt">&lt;/ul&gt;</span>

<span class="w">   </span><span class="nt">&lt;ul</span><span class="w"> </span><span class="na">class=</span><span class="s">"layer-1 parent"</span><span class="nt">&gt;</span>
<span class="w">     </span><span class="nt">&lt;li</span><span class="w"> </span><span class="na">class=</span><span class="s">"click-me-also child"</span><span class="nt">&gt;&lt;/li&gt;</span>
<span class="w">     </span><span class="nt">&lt;li</span><span class="w"> </span><span class="na">class=</span><span class="s">"click-me-also child"</span><span class="nt">&gt;&lt;/li&gt;</span>
<span class="w">   </span><span class="nt">&lt;/ul&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/fastest-way-to-list-all-primes-below-n/" class="u-url">Fastest way to list all primes below N</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/fastest-way-to-list-all-primes-below-n/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T04:37:52+08:00" itemprop="datePublished" title="2023-03-04 04:37">2023-03-04 04:37</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>This is the best algorithm I could come up.</p>
<div class="code"><pre class="code literal-block"><span class="k">def</span> <span class="nf">get_primes</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">numbers</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">primes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">while</span> <span class="n">numbers</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">numbers</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="n">primes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">numbers</span><span class="o">.</span><span class="n">difference_update</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">primes</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">timeit</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="n">stmt</span><span class="o">=</span><span class="s1">'get_primes.get_primes(1000000)'</span><span class="p">,</span> <span class="n">setup</span><span class="o">=</span><span class="s1">'import   get_primes'</span><span class="p">)</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="mf">1.1499958793645562</span>
</pre></div>

<p>Can it be made even faster?</p>
<p>This code has a flaw: Since <code>numbers</code> is an unordered set, there is no
guarantee that <code>numbers.pop()</code> will remove the lowest number from the set.
Nevertheless, it works (at least for me) for some input numbers:</p>
<div class="code"><pre class="code literal-block">&gt;&gt;&gt; sum(get_primes(2000000))
142913828922L
#That's the correct sum of all numbers below 2 million
&gt;&gt;&gt; 529 in get_primes(1000)
False
&gt;&gt;&gt; 529 in get_primes(530)
True
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<p><strong>Warning:</strong> <code>timeit</code> results may vary due to differences in hardware or
version of Python.</p>
<p>Below is a script which compares a number of implementations:</p>
<ul>
<li>ambi_sieve_plain, </li>
<li>rwh_primes, </li>
<li>rwh_primes1, </li>
<li>rwh_primes2, </li>
<li>sieveOfAtkin, </li>
<li>sieveOfEratosthenes, </li>
<li>sundaram3, </li>
<li>sieve_wheel_30, </li>
<li>ambi_sieve (requires numpy) </li>
<li>primesfrom3to (requires numpy) </li>
<li>primesfrom2to (requires numpy) </li>
</ul>
<p>Many thanks to stephan for bringing sieve_wheel_30 to my attention. Credit
goes to Robert William Hanks for primesfrom2to, primesfrom3to, rwh_primes,
rwh_primes1, and rwh_primes2.</p>
<p>Of the plain Python methods tested, <strong>with psyco</strong> , for n=1000000,
<strong>rwh_primes1</strong> was the fastest tested.</p>
<div class="code"><pre class="code literal-block">+---------------------+-------+
| Method              | ms    |
+---------------------+-------+
| rwh_primes1         | 43.0  |
| sieveOfAtkin        | 46.4  |
| rwh_primes          | 57.4  |
| sieve_wheel_30      | 63.0  |
| rwh_primes2         | 67.8  |    
| sieveOfEratosthenes | 147.0 |
| ambi_sieve_plain    | 152.0 |
| sundaram3           | 194.0 |
+---------------------+-------+
</pre></div>

<p>Of the plain Python methods tested, <strong>without psyco</strong> , for n=1000000,
<strong>rwh_primes2</strong> was the fastest.</p>
<div class="code"><pre class="code literal-block">+---------------------+-------+
| Method              | ms    |
+---------------------+-------+
| rwh_primes2         | 68.1  |
| rwh_primes1         | 93.7  |
| rwh_primes          | 94.6  |
| sieve_wheel_30      | 97.4  |
| sieveOfEratosthenes | 178.0 |
| ambi_sieve_plain    | 286.0 |
| sieveOfAtkin        | 314.0 |
| sundaram3           | 416.0 |
+---------------------+-------+
</pre></div>

<p>Of all the methods tested, <em>allowing numpy</em> , for n=1000000, <strong>primesfrom2to</strong>
was the fastest tested.</p>
<div class="code"><pre class="code literal-block"><span class="nb">+---------------------+-------+</span>
<span class="c">| Method              | ms    |</span>
<span class="nb">+---------------------+-------+</span>
<span class="c">| primesfrom2to       | 15</span><span class="nt">.</span><span class="c">9  |</span>
<span class="c">| primesfrom3to       | 18</span><span class="nt">.</span><span class="c">4  |</span>
<span class="c">| ambi_sieve          | 29</span><span class="nt">.</span><span class="c">3  |</span>
<span class="nb">+---------------------+-------+</span>
</pre></div>

<p>Timings were measured using the command:</p>
<div class="code"><pre class="code literal-block"><span class="n">python</span> <span class="o">-</span><span class="n">mtimeit</span> <span class="o">-</span><span class="n">s</span><span class="s2">"import primes"</span> <span class="s2">"primes.</span><span class="si">{method}</span><span class="s2">(1000000)"</span>
</pre></div>

<p>with <code>{method}</code> replaced by each of the method names.</p>
<p>primes.py:</p>
<div class="code"><table class="codetable">
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-1"><code data-line-number="  1"></code></a></td>
<td class="code"><code><span class="ch">#!/usr/bin/env python</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-2"><code data-line-number="  2"></code></a></td>
<td class="code"><code><span class="kn">import</span> <span class="nn">psyco</span><span class="p">;</span> <span class="n">psyco</span><span class="o">.</span><span class="n">full</span><span class="p">()</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-3"><code data-line-number="  3"></code></a></td>
<td class="code"><code><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">ceil</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-4"><code data-line-number="  4"></code></a></td>
<td class="code"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-5"><code data-line-number="  5"></code></a></td>
<td class="code"><code>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-6"><code data-line-number="  6"></code></a></td>
<td class="code"><code><span class="k">def</span> <span class="nf">rwh_primes</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-7"><code data-line-number="  7"></code></a></td>
<td class="code"><code>    <span class="c1"># https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n-in-python/3035188#3035188</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-8"><code data-line-number="  8"></code></a></td>
<td class="code"><code><span class="w">    </span><span class="sd">""" Returns  a list of primes &lt; n """</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-9"><code data-line-number="  9"></code></a></td>
<td class="code"><code>    <span class="n">sieve</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-10"><code data-line-number=" 10"></code></a></td>
<td class="code"><code>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-11"><code data-line-number=" 11"></code></a></td>
<td class="code"><code>        <span class="k">if</span> <span class="n">sieve</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-12"><code data-line-number=" 12"></code></a></td>
<td class="code"><code>            <span class="n">sieve</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">i</span><span class="p">::</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span><span class="o">*</span><span class="p">((</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-13"><code data-line-number=" 13"></code></a></td>
<td class="code"><code>    <span class="k">return</span> <span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="k">if</span> <span class="n">sieve</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-14"><code data-line-number=" 14"></code></a></td>
<td class="code"><code>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-15"><code data-line-number=" 15"></code></a></td>
<td class="code"><code><span class="k">def</span> <span class="nf">rwh_primes1</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-16"><code data-line-number=" 16"></code></a></td>
<td class="code"><code>    <span class="c1"># https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n-in-python/3035188#3035188</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-17"><code data-line-number=" 17"></code></a></td>
<td class="code"><code><span class="w">    </span><span class="sd">""" Returns  a list of primes &lt; n """</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-18"><code data-line-number=" 18"></code></a></td>
<td class="code"><code>    <span class="n">sieve</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-19"><code data-line-number=" 19"></code></a></td>
<td class="code"><code>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-20"><code data-line-number=" 20"></code></a></td>
<td class="code"><code>        <span class="k">if</span> <span class="n">sieve</span><span class="p">[</span><span class="n">i</span><span class="o">/</span><span class="mi">2</span><span class="p">]:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-21"><code data-line-number=" 21"></code></a></td>
<td class="code"><code>            <span class="n">sieve</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">i</span><span class="o">/</span><span class="mi">2</span><span class="p">::</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="p">((</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-22"><code data-line-number=" 22"></code></a></td>
<td class="code"><code>    <span class="k">return</span> <span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="k">if</span> <span class="n">sieve</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-23"><code data-line-number=" 23"></code></a></td>
<td class="code"><code>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-24"><code data-line-number=" 24"></code></a></td>
<td class="code"><code><span class="k">def</span> <span class="nf">rwh_primes2</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-25"><code data-line-number=" 25"></code></a></td>
<td class="code"><code>    <span class="c1"># https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n-in-python/3035188#3035188</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-26"><code data-line-number=" 26"></code></a></td>
<td class="code"><code><span class="w">    </span><span class="sd">""" Input n&gt;=6, Returns a list of primes, 2 &lt;= p &lt; n """</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-27"><code data-line-number=" 27"></code></a></td>
<td class="code"><code>    <span class="n">correction</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span><span class="o">%</span><span class="mi">6</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-28"><code data-line-number=" 28"></code></a></td>
<td class="code"><code>    <span class="n">n</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span><span class="n">n</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="n">n</span><span class="o">+</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="n">n</span><span class="o">+</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">:</span><span class="n">n</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">:</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">}[</span><span class="n">n</span><span class="o">%</span><span class="mi">6</span><span class="p">]</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-29"><code data-line-number=" 29"></code></a></td>
<td class="code"><code>    <span class="n">sieve</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-30"><code data-line-number=" 30"></code></a></td>
<td class="code"><code>    <span class="n">sieve</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-31"><code data-line-number=" 31"></code></a></td>
<td class="code"><code>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-32"><code data-line-number=" 32"></code></a></td>
<td class="code"><code>      <span class="k">if</span> <span class="n">sieve</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-33"><code data-line-number=" 33"></code></a></td>
<td class="code"><code>        <span class="n">k</span><span class="o">=</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="o">|</span><span class="mi">1</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-34"><code data-line-number=" 34"></code></a></td>
<td class="code"><code>        <span class="n">sieve</span><span class="p">[</span>      <span class="p">((</span><span class="n">k</span><span class="o">*</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>      <span class="p">::</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span><span class="o">*</span><span class="p">((</span><span class="n">n</span><span class="o">/</span><span class="mi">6</span><span class="o">-</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="mi">6</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-35"><code data-line-number=" 35"></code></a></td>
<td class="code"><code>        <span class="n">sieve</span><span class="p">[(</span><span class="n">k</span><span class="o">*</span><span class="n">k</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">k</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="mi">3</span><span class="p">::</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span><span class="o">*</span><span class="p">((</span><span class="n">n</span><span class="o">/</span><span class="mi">6</span><span class="o">-</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">k</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">k</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="mi">6</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-36"><code data-line-number=" 36"></code></a></td>
<td class="code"><code>    <span class="k">return</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="o">|</span><span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">/</span><span class="mi">3</span><span class="o">-</span><span class="n">correction</span><span class="p">)</span> <span class="k">if</span> <span class="n">sieve</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-37"><code data-line-number=" 37"></code></a></td>
<td class="code"><code>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-38"><code data-line-number=" 38"></code></a></td>
<td class="code"><code><span class="k">def</span> <span class="nf">sieve_wheel_30</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-39"><code data-line-number=" 39"></code></a></td>
<td class="code"><code>    <span class="c1"># http://zerovolt.com/?p=88</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-40"><code data-line-number=" 40"></code></a></td>
<td class="code"><code><span class="w">    </span><span class="sd">''' Returns a list of primes &lt;= N using wheel criterion 2*3*5 = 30</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-41"><code data-line-number=" 41"></code></a></td>
<td class="code"><code>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-42"><code data-line-number=" 42"></code></a></td>
<td class="code"><code><span class="sd">Copyright 2009 by zerovolt.com</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-43"><code data-line-number=" 43"></code></a></td>
<td class="code"><code><span class="sd">This code is free for non-commercial purposes, in which case you can just leave this comment as a credit for my work.</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-44"><code data-line-number=" 44"></code></a></td>
<td class="code"><code><span class="sd">If you need this code for commercial purposes, please contact me by sending an email to: info [at] zerovolt [dot] com.'''</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-45"><code data-line-number=" 45"></code></a></td>
<td class="code"><code>    <span class="n">__smallp</span> <span class="o">=</span> <span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-46"><code data-line-number=" 46"></code></a></td>
<td class="code"><code>    <span class="mi">61</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">107</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">113</span><span class="p">,</span> <span class="mi">127</span><span class="p">,</span> <span class="mi">131</span><span class="p">,</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">139</span><span class="p">,</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-47"><code data-line-number=" 47"></code></a></td>
<td class="code"><code>    <span class="mi">149</span><span class="p">,</span> <span class="mi">151</span><span class="p">,</span> <span class="mi">157</span><span class="p">,</span> <span class="mi">163</span><span class="p">,</span> <span class="mi">167</span><span class="p">,</span> <span class="mi">173</span><span class="p">,</span> <span class="mi">179</span><span class="p">,</span> <span class="mi">181</span><span class="p">,</span> <span class="mi">191</span><span class="p">,</span> <span class="mi">193</span><span class="p">,</span> <span class="mi">197</span><span class="p">,</span> <span class="mi">199</span><span class="p">,</span> <span class="mi">211</span><span class="p">,</span> <span class="mi">223</span><span class="p">,</span> <span class="mi">227</span><span class="p">,</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-48"><code data-line-number=" 48"></code></a></td>
<td class="code"><code>    <span class="mi">229</span><span class="p">,</span> <span class="mi">233</span><span class="p">,</span> <span class="mi">239</span><span class="p">,</span> <span class="mi">241</span><span class="p">,</span> <span class="mi">251</span><span class="p">,</span> <span class="mi">257</span><span class="p">,</span> <span class="mi">263</span><span class="p">,</span> <span class="mi">269</span><span class="p">,</span> <span class="mi">271</span><span class="p">,</span> <span class="mi">277</span><span class="p">,</span> <span class="mi">281</span><span class="p">,</span> <span class="mi">283</span><span class="p">,</span> <span class="mi">293</span><span class="p">,</span> <span class="mi">307</span><span class="p">,</span> <span class="mi">311</span><span class="p">,</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-49"><code data-line-number=" 49"></code></a></td>
<td class="code"><code>    <span class="mi">313</span><span class="p">,</span> <span class="mi">317</span><span class="p">,</span> <span class="mi">331</span><span class="p">,</span> <span class="mi">337</span><span class="p">,</span> <span class="mi">347</span><span class="p">,</span> <span class="mi">349</span><span class="p">,</span> <span class="mi">353</span><span class="p">,</span> <span class="mi">359</span><span class="p">,</span> <span class="mi">367</span><span class="p">,</span> <span class="mi">373</span><span class="p">,</span> <span class="mi">379</span><span class="p">,</span> <span class="mi">383</span><span class="p">,</span> <span class="mi">389</span><span class="p">,</span> <span class="mi">397</span><span class="p">,</span> <span class="mi">401</span><span class="p">,</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-50"><code data-line-number=" 50"></code></a></td>
<td class="code"><code>    <span class="mi">409</span><span class="p">,</span> <span class="mi">419</span><span class="p">,</span> <span class="mi">421</span><span class="p">,</span> <span class="mi">431</span><span class="p">,</span> <span class="mi">433</span><span class="p">,</span> <span class="mi">439</span><span class="p">,</span> <span class="mi">443</span><span class="p">,</span> <span class="mi">449</span><span class="p">,</span> <span class="mi">457</span><span class="p">,</span> <span class="mi">461</span><span class="p">,</span> <span class="mi">463</span><span class="p">,</span> <span class="mi">467</span><span class="p">,</span> <span class="mi">479</span><span class="p">,</span> <span class="mi">487</span><span class="p">,</span> <span class="mi">491</span><span class="p">,</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-51"><code data-line-number=" 51"></code></a></td>
<td class="code"><code>    <span class="mi">499</span><span class="p">,</span> <span class="mi">503</span><span class="p">,</span> <span class="mi">509</span><span class="p">,</span> <span class="mi">521</span><span class="p">,</span> <span class="mi">523</span><span class="p">,</span> <span class="mi">541</span><span class="p">,</span> <span class="mi">547</span><span class="p">,</span> <span class="mi">557</span><span class="p">,</span> <span class="mi">563</span><span class="p">,</span> <span class="mi">569</span><span class="p">,</span> <span class="mi">571</span><span class="p">,</span> <span class="mi">577</span><span class="p">,</span> <span class="mi">587</span><span class="p">,</span> <span class="mi">593</span><span class="p">,</span> <span class="mi">599</span><span class="p">,</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-52"><code data-line-number=" 52"></code></a></td>
<td class="code"><code>    <span class="mi">601</span><span class="p">,</span> <span class="mi">607</span><span class="p">,</span> <span class="mi">613</span><span class="p">,</span> <span class="mi">617</span><span class="p">,</span> <span class="mi">619</span><span class="p">,</span> <span class="mi">631</span><span class="p">,</span> <span class="mi">641</span><span class="p">,</span> <span class="mi">643</span><span class="p">,</span> <span class="mi">647</span><span class="p">,</span> <span class="mi">653</span><span class="p">,</span> <span class="mi">659</span><span class="p">,</span> <span class="mi">661</span><span class="p">,</span> <span class="mi">673</span><span class="p">,</span> <span class="mi">677</span><span class="p">,</span> <span class="mi">683</span><span class="p">,</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-53"><code data-line-number=" 53"></code></a></td>
<td class="code"><code>    <span class="mi">691</span><span class="p">,</span> <span class="mi">701</span><span class="p">,</span> <span class="mi">709</span><span class="p">,</span> <span class="mi">719</span><span class="p">,</span> <span class="mi">727</span><span class="p">,</span> <span class="mi">733</span><span class="p">,</span> <span class="mi">739</span><span class="p">,</span> <span class="mi">743</span><span class="p">,</span> <span class="mi">751</span><span class="p">,</span> <span class="mi">757</span><span class="p">,</span> <span class="mi">761</span><span class="p">,</span> <span class="mi">769</span><span class="p">,</span> <span class="mi">773</span><span class="p">,</span> <span class="mi">787</span><span class="p">,</span> <span class="mi">797</span><span class="p">,</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-54"><code data-line-number=" 54"></code></a></td>
<td class="code"><code>    <span class="mi">809</span><span class="p">,</span> <span class="mi">811</span><span class="p">,</span> <span class="mi">821</span><span class="p">,</span> <span class="mi">823</span><span class="p">,</span> <span class="mi">827</span><span class="p">,</span> <span class="mi">829</span><span class="p">,</span> <span class="mi">839</span><span class="p">,</span> <span class="mi">853</span><span class="p">,</span> <span class="mi">857</span><span class="p">,</span> <span class="mi">859</span><span class="p">,</span> <span class="mi">863</span><span class="p">,</span> <span class="mi">877</span><span class="p">,</span> <span class="mi">881</span><span class="p">,</span> <span class="mi">883</span><span class="p">,</span> <span class="mi">887</span><span class="p">,</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-55"><code data-line-number=" 55"></code></a></td>
<td class="code"><code>    <span class="mi">907</span><span class="p">,</span> <span class="mi">911</span><span class="p">,</span> <span class="mi">919</span><span class="p">,</span> <span class="mi">929</span><span class="p">,</span> <span class="mi">937</span><span class="p">,</span> <span class="mi">941</span><span class="p">,</span> <span class="mi">947</span><span class="p">,</span> <span class="mi">953</span><span class="p">,</span> <span class="mi">967</span><span class="p">,</span> <span class="mi">971</span><span class="p">,</span> <span class="mi">977</span><span class="p">,</span> <span class="mi">983</span><span class="p">,</span> <span class="mi">991</span><span class="p">,</span> <span class="mi">997</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-56"><code data-line-number=" 56"></code></a></td>
<td class="code"><code>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-57"><code data-line-number=" 57"></code></a></td>
<td class="code"><code>    <span class="n">wheel</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-58"><code data-line-number=" 58"></code></a></td>
<td class="code"><code>    <span class="n">const</span> <span class="o">=</span> <span class="mi">30</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-59"><code data-line-number=" 59"></code></a></td>
<td class="code"><code>    <span class="k">if</span> <span class="n">N</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-60"><code data-line-number=" 60"></code></a></td>
<td class="code"><code>        <span class="k">return</span> <span class="p">[]</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-61"><code data-line-number=" 61"></code></a></td>
<td class="code"><code>    <span class="k">if</span> <span class="n">N</span> <span class="o">&lt;=</span> <span class="n">const</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-62"><code data-line-number=" 62"></code></a></td>
<td class="code"><code>        <span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-63"><code data-line-number=" 63"></code></a></td>
<td class="code"><code>        <span class="k">while</span> <span class="n">__smallp</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">N</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-64"><code data-line-number=" 64"></code></a></td>
<td class="code"><code>            <span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-65"><code data-line-number=" 65"></code></a></td>
<td class="code"><code>        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">__smallp</span><span class="p">[:</span><span class="n">pos</span><span class="p">])</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-66"><code data-line-number=" 66"></code></a></td>
<td class="code"><code>    <span class="c1"># make the offsets list</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-67"><code data-line-number=" 67"></code></a></td>
<td class="code"><code>    <span class="n">offsets</span> <span class="o">=</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-68"><code data-line-number=" 68"></code></a></td>
<td class="code"><code>    <span class="c1"># prepare the list</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-69"><code data-line-number=" 69"></code></a></td>
<td class="code"><code>    <span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-70"><code data-line-number=" 70"></code></a></td>
<td class="code"><code>    <span class="n">dim</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">N</span> <span class="o">//</span> <span class="n">const</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-71"><code data-line-number=" 71"></code></a></td>
<td class="code"><code>    <span class="n">tk1</span>  <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">]</span> <span class="o">*</span> <span class="n">dim</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-72"><code data-line-number=" 72"></code></a></td>
<td class="code"><code>    <span class="n">tk7</span>  <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">]</span> <span class="o">*</span> <span class="n">dim</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-73"><code data-line-number=" 73"></code></a></td>
<td class="code"><code>    <span class="n">tk11</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">]</span> <span class="o">*</span> <span class="n">dim</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-74"><code data-line-number=" 74"></code></a></td>
<td class="code"><code>    <span class="n">tk13</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">]</span> <span class="o">*</span> <span class="n">dim</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-75"><code data-line-number=" 75"></code></a></td>
<td class="code"><code>    <span class="n">tk17</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">]</span> <span class="o">*</span> <span class="n">dim</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-76"><code data-line-number=" 76"></code></a></td>
<td class="code"><code>    <span class="n">tk19</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">]</span> <span class="o">*</span> <span class="n">dim</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-77"><code data-line-number=" 77"></code></a></td>
<td class="code"><code>    <span class="n">tk23</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">]</span> <span class="o">*</span> <span class="n">dim</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-78"><code data-line-number=" 78"></code></a></td>
<td class="code"><code>    <span class="n">tk29</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">]</span> <span class="o">*</span> <span class="n">dim</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-79"><code data-line-number=" 79"></code></a></td>
<td class="code"><code>    <span class="n">tk1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-80"><code data-line-number=" 80"></code></a></td>
<td class="code"><code>    <span class="c1"># help dictionary d</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-81"><code data-line-number=" 81"></code></a></td>
<td class="code"><code>    <span class="c1"># d[a , b] = c  ==&gt; if I want to find the smallest useful multiple of (30*pos)+a</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-82"><code data-line-number=" 82"></code></a></td>
<td class="code"><code>    <span class="c1"># on tkc, then I need the index given by the product of [(30*pos)+a][(30*pos)+b]</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-83"><code data-line-number=" 83"></code></a></td>
<td class="code"><code>    <span class="c1"># in general. If b &lt; a, I need [(30*pos)+a][(30*(pos+1))+b]</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-84"><code data-line-number=" 84"></code></a></td>
<td class="code"><code>    <span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-85"><code data-line-number=" 85"></code></a></td>
<td class="code"><code>    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">offsets</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-86"><code data-line-number=" 86"></code></a></td>
<td class="code"><code>        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">offsets</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-87"><code data-line-number=" 87"></code></a></td>
<td class="code"><code>            <span class="n">res</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span> <span class="o">%</span> <span class="n">const</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-88"><code data-line-number=" 88"></code></a></td>
<td class="code"><code>            <span class="k">if</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">offsets</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-89"><code data-line-number=" 89"></code></a></td>
<td class="code"><code>                <span class="n">d</span><span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="n">res</span><span class="p">)]</span> <span class="o">=</span> <span class="n">y</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-90"><code data-line-number=" 90"></code></a></td>
<td class="code"><code>    <span class="c1"># another help dictionary: gives tkx calling tmptk[x]</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-91"><code data-line-number=" 91"></code></a></td>
<td class="code"><code>    <span class="n">tmptk</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="n">tk1</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span><span class="n">tk7</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span><span class="n">tk11</span><span class="p">,</span> <span class="mi">13</span><span class="p">:</span><span class="n">tk13</span><span class="p">,</span> <span class="mi">17</span><span class="p">:</span><span class="n">tk17</span><span class="p">,</span> <span class="mi">19</span><span class="p">:</span><span class="n">tk19</span><span class="p">,</span> <span class="mi">23</span><span class="p">:</span><span class="n">tk23</span><span class="p">,</span> <span class="mi">29</span><span class="p">:</span><span class="n">tk29</span><span class="p">}</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-92"><code data-line-number=" 92"></code></a></td>
<td class="code"><code>    <span class="n">pos</span><span class="p">,</span> <span class="n">prime</span><span class="p">,</span> <span class="n">lastadded</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">ceil</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">N</span><span class="p">)))</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-93"><code data-line-number=" 93"></code></a></td>
<td class="code"><code>    <span class="c1"># inner functions definition</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-94"><code data-line-number=" 94"></code></a></td>
<td class="code"><code>    <span class="k">def</span> <span class="nf">del_mult</span><span class="p">(</span><span class="n">tk</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">step</span><span class="p">):</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-95"><code data-line-number=" 95"></code></a></td>
<td class="code"><code>        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">tk</span><span class="p">),</span> <span class="n">step</span><span class="p">):</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-96"><code data-line-number=" 96"></code></a></td>
<td class="code"><code>            <span class="n">tk</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-97"><code data-line-number=" 97"></code></a></td>
<td class="code"><code>    <span class="c1"># end of inner functions definition</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-98"><code data-line-number=" 98"></code></a></td>
<td class="code"><code>    <span class="n">cpos</span> <span class="o">=</span> <span class="n">const</span> <span class="o">*</span> <span class="n">pos</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-99"><code data-line-number=" 99"></code></a></td>
<td class="code"><code>    <span class="k">while</span> <span class="n">prime</span> <span class="o">&lt;</span> <span class="n">stop</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-100"><code data-line-number="100"></code></a></td>
<td class="code"><code>        <span class="c1"># 30k + 7</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-101"><code data-line-number="101"></code></a></td>
<td class="code"><code>        <span class="k">if</span> <span class="n">tk7</span><span class="p">[</span><span class="n">pos</span><span class="p">]:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-102"><code data-line-number="102"></code></a></td>
<td class="code"><code>            <span class="n">prime</span> <span class="o">=</span> <span class="n">cpos</span> <span class="o">+</span> <span class="mi">7</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-103"><code data-line-number="103"></code></a></td>
<td class="code"><code>            <span class="n">p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prime</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-104"><code data-line-number="104"></code></a></td>
<td class="code"><code>            <span class="n">lastadded</span> <span class="o">=</span> <span class="mi">7</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-105"><code data-line-number="105"></code></a></td>
<td class="code"><code>            <span class="k">for</span> <span class="n">off</span> <span class="ow">in</span> <span class="n">offsets</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-106"><code data-line-number="106"></code></a></td>
<td class="code"><code>                <span class="n">tmp</span> <span class="o">=</span> <span class="n">d</span><span class="p">[(</span><span class="mi">7</span><span class="p">,</span> <span class="n">off</span><span class="p">)]</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-107"><code data-line-number="107"></code></a></td>
<td class="code"><code>                <span class="n">start</span> <span class="o">=</span> <span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="n">prime</span><span class="p">)</span> <span class="k">if</span> <span class="n">off</span> <span class="o">==</span> <span class="mi">7</span> <span class="k">else</span> <span class="p">(</span><span class="n">prime</span> <span class="o">*</span> <span class="p">(</span><span class="n">const</span> <span class="o">*</span> <span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">tmp</span> <span class="o">&lt;</span> <span class="mi">7</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">tmp</span><span class="p">)</span> <span class="p">)</span><span class="o">//</span><span class="n">const</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-108"><code data-line-number="108"></code></a></td>
<td class="code"><code>                <span class="n">del_mult</span><span class="p">(</span><span class="n">tmptk</span><span class="p">[</span><span class="n">off</span><span class="p">],</span> <span class="n">start</span><span class="p">,</span> <span class="n">prime</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-109"><code data-line-number="109"></code></a></td>
<td class="code"><code>        <span class="c1"># 30k + 11</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-110"><code data-line-number="110"></code></a></td>
<td class="code"><code>        <span class="k">if</span> <span class="n">tk11</span><span class="p">[</span><span class="n">pos</span><span class="p">]:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-111"><code data-line-number="111"></code></a></td>
<td class="code"><code>            <span class="n">prime</span> <span class="o">=</span> <span class="n">cpos</span> <span class="o">+</span> <span class="mi">11</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-112"><code data-line-number="112"></code></a></td>
<td class="code"><code>            <span class="n">p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prime</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-113"><code data-line-number="113"></code></a></td>
<td class="code"><code>            <span class="n">lastadded</span> <span class="o">=</span> <span class="mi">11</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-114"><code data-line-number="114"></code></a></td>
<td class="code"><code>            <span class="k">for</span> <span class="n">off</span> <span class="ow">in</span> <span class="n">offsets</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-115"><code data-line-number="115"></code></a></td>
<td class="code"><code>                <span class="n">tmp</span> <span class="o">=</span> <span class="n">d</span><span class="p">[(</span><span class="mi">11</span><span class="p">,</span> <span class="n">off</span><span class="p">)]</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-116"><code data-line-number="116"></code></a></td>
<td class="code"><code>                <span class="n">start</span> <span class="o">=</span> <span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="n">prime</span><span class="p">)</span> <span class="k">if</span> <span class="n">off</span> <span class="o">==</span> <span class="mi">11</span> <span class="k">else</span> <span class="p">(</span><span class="n">prime</span> <span class="o">*</span> <span class="p">(</span><span class="n">const</span> <span class="o">*</span> <span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">tmp</span> <span class="o">&lt;</span> <span class="mi">11</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">tmp</span><span class="p">)</span> <span class="p">)</span><span class="o">//</span><span class="n">const</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-117"><code data-line-number="117"></code></a></td>
<td class="code"><code>                <span class="n">del_mult</span><span class="p">(</span><span class="n">tmptk</span><span class="p">[</span><span class="n">off</span><span class="p">],</span> <span class="n">start</span><span class="p">,</span> <span class="n">prime</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-118"><code data-line-number="118"></code></a></td>
<td class="code"><code>        <span class="c1"># 30k + 13</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-119"><code data-line-number="119"></code></a></td>
<td class="code"><code>        <span class="k">if</span> <span class="n">tk13</span><span class="p">[</span><span class="n">pos</span><span class="p">]:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-120"><code data-line-number="120"></code></a></td>
<td class="code"><code>            <span class="n">prime</span> <span class="o">=</span> <span class="n">cpos</span> <span class="o">+</span> <span class="mi">13</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-121"><code data-line-number="121"></code></a></td>
<td class="code"><code>            <span class="n">p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prime</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-122"><code data-line-number="122"></code></a></td>
<td class="code"><code>            <span class="n">lastadded</span> <span class="o">=</span> <span class="mi">13</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-123"><code data-line-number="123"></code></a></td>
<td class="code"><code>            <span class="k">for</span> <span class="n">off</span> <span class="ow">in</span> <span class="n">offsets</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-124"><code data-line-number="124"></code></a></td>
<td class="code"><code>                <span class="n">tmp</span> <span class="o">=</span> <span class="n">d</span><span class="p">[(</span><span class="mi">13</span><span class="p">,</span> <span class="n">off</span><span class="p">)]</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-125"><code data-line-number="125"></code></a></td>
<td class="code"><code>                <span class="n">start</span> <span class="o">=</span> <span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="n">prime</span><span class="p">)</span> <span class="k">if</span> <span class="n">off</span> <span class="o">==</span> <span class="mi">13</span> <span class="k">else</span> <span class="p">(</span><span class="n">prime</span> <span class="o">*</span> <span class="p">(</span><span class="n">const</span> <span class="o">*</span> <span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">tmp</span> <span class="o">&lt;</span> <span class="mi">13</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">tmp</span><span class="p">)</span> <span class="p">)</span><span class="o">//</span><span class="n">const</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-126"><code data-line-number="126"></code></a></td>
<td class="code"><code>                <span class="n">del_mult</span><span class="p">(</span><span class="n">tmptk</span><span class="p">[</span><span class="n">off</span><span class="p">],</span> <span class="n">start</span><span class="p">,</span> <span class="n">prime</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-127"><code data-line-number="127"></code></a></td>
<td class="code"><code>        <span class="c1"># 30k + 17</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-128"><code data-line-number="128"></code></a></td>
<td class="code"><code>        <span class="k">if</span> <span class="n">tk17</span><span class="p">[</span><span class="n">pos</span><span class="p">]:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-129"><code data-line-number="129"></code></a></td>
<td class="code"><code>            <span class="n">prime</span> <span class="o">=</span> <span class="n">cpos</span> <span class="o">+</span> <span class="mi">17</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-130"><code data-line-number="130"></code></a></td>
<td class="code"><code>            <span class="n">p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prime</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-131"><code data-line-number="131"></code></a></td>
<td class="code"><code>            <span class="n">lastadded</span> <span class="o">=</span> <span class="mi">17</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-132"><code data-line-number="132"></code></a></td>
<td class="code"><code>            <span class="k">for</span> <span class="n">off</span> <span class="ow">in</span> <span class="n">offsets</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-133"><code data-line-number="133"></code></a></td>
<td class="code"><code>                <span class="n">tmp</span> <span class="o">=</span> <span class="n">d</span><span class="p">[(</span><span class="mi">17</span><span class="p">,</span> <span class="n">off</span><span class="p">)]</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-134"><code data-line-number="134"></code></a></td>
<td class="code"><code>                <span class="n">start</span> <span class="o">=</span> <span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="n">prime</span><span class="p">)</span> <span class="k">if</span> <span class="n">off</span> <span class="o">==</span> <span class="mi">17</span> <span class="k">else</span> <span class="p">(</span><span class="n">prime</span> <span class="o">*</span> <span class="p">(</span><span class="n">const</span> <span class="o">*</span> <span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">tmp</span> <span class="o">&lt;</span> <span class="mi">17</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">tmp</span><span class="p">)</span> <span class="p">)</span><span class="o">//</span><span class="n">const</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-135"><code data-line-number="135"></code></a></td>
<td class="code"><code>                <span class="n">del_mult</span><span class="p">(</span><span class="n">tmptk</span><span class="p">[</span><span class="n">off</span><span class="p">],</span> <span class="n">start</span><span class="p">,</span> <span class="n">prime</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-136"><code data-line-number="136"></code></a></td>
<td class="code"><code>        <span class="c1"># 30k + 19</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-137"><code data-line-number="137"></code></a></td>
<td class="code"><code>        <span class="k">if</span> <span class="n">tk19</span><span class="p">[</span><span class="n">pos</span><span class="p">]:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-138"><code data-line-number="138"></code></a></td>
<td class="code"><code>            <span class="n">prime</span> <span class="o">=</span> <span class="n">cpos</span> <span class="o">+</span> <span class="mi">19</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-139"><code data-line-number="139"></code></a></td>
<td class="code"><code>            <span class="n">p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prime</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-140"><code data-line-number="140"></code></a></td>
<td class="code"><code>            <span class="n">lastadded</span> <span class="o">=</span> <span class="mi">19</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-141"><code data-line-number="141"></code></a></td>
<td class="code"><code>            <span class="k">for</span> <span class="n">off</span> <span class="ow">in</span> <span class="n">offsets</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-142"><code data-line-number="142"></code></a></td>
<td class="code"><code>                <span class="n">tmp</span> <span class="o">=</span> <span class="n">d</span><span class="p">[(</span><span class="mi">19</span><span class="p">,</span> <span class="n">off</span><span class="p">)]</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-143"><code data-line-number="143"></code></a></td>
<td class="code"><code>                <span class="n">start</span> <span class="o">=</span> <span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="n">prime</span><span class="p">)</span> <span class="k">if</span> <span class="n">off</span> <span class="o">==</span> <span class="mi">19</span> <span class="k">else</span> <span class="p">(</span><span class="n">prime</span> <span class="o">*</span> <span class="p">(</span><span class="n">const</span> <span class="o">*</span> <span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">tmp</span> <span class="o">&lt;</span> <span class="mi">19</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">tmp</span><span class="p">)</span> <span class="p">)</span><span class="o">//</span><span class="n">const</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-144"><code data-line-number="144"></code></a></td>
<td class="code"><code>                <span class="n">del_mult</span><span class="p">(</span><span class="n">tmptk</span><span class="p">[</span><span class="n">off</span><span class="p">],</span> <span class="n">start</span><span class="p">,</span> <span class="n">prime</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-145"><code data-line-number="145"></code></a></td>
<td class="code"><code>        <span class="c1"># 30k + 23</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-146"><code data-line-number="146"></code></a></td>
<td class="code"><code>        <span class="k">if</span> <span class="n">tk23</span><span class="p">[</span><span class="n">pos</span><span class="p">]:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-147"><code data-line-number="147"></code></a></td>
<td class="code"><code>            <span class="n">prime</span> <span class="o">=</span> <span class="n">cpos</span> <span class="o">+</span> <span class="mi">23</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-148"><code data-line-number="148"></code></a></td>
<td class="code"><code>            <span class="n">p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prime</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-149"><code data-line-number="149"></code></a></td>
<td class="code"><code>            <span class="n">lastadded</span> <span class="o">=</span> <span class="mi">23</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-150"><code data-line-number="150"></code></a></td>
<td class="code"><code>            <span class="k">for</span> <span class="n">off</span> <span class="ow">in</span> <span class="n">offsets</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-151"><code data-line-number="151"></code></a></td>
<td class="code"><code>                <span class="n">tmp</span> <span class="o">=</span> <span class="n">d</span><span class="p">[(</span><span class="mi">23</span><span class="p">,</span> <span class="n">off</span><span class="p">)]</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-152"><code data-line-number="152"></code></a></td>
<td class="code"><code>                <span class="n">start</span> <span class="o">=</span> <span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="n">prime</span><span class="p">)</span> <span class="k">if</span> <span class="n">off</span> <span class="o">==</span> <span class="mi">23</span> <span class="k">else</span> <span class="p">(</span><span class="n">prime</span> <span class="o">*</span> <span class="p">(</span><span class="n">const</span> <span class="o">*</span> <span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">tmp</span> <span class="o">&lt;</span> <span class="mi">23</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">tmp</span><span class="p">)</span> <span class="p">)</span><span class="o">//</span><span class="n">const</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-153"><code data-line-number="153"></code></a></td>
<td class="code"><code>                <span class="n">del_mult</span><span class="p">(</span><span class="n">tmptk</span><span class="p">[</span><span class="n">off</span><span class="p">],</span> <span class="n">start</span><span class="p">,</span> <span class="n">prime</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-154"><code data-line-number="154"></code></a></td>
<td class="code"><code>        <span class="c1"># 30k + 29</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-155"><code data-line-number="155"></code></a></td>
<td class="code"><code>        <span class="k">if</span> <span class="n">tk29</span><span class="p">[</span><span class="n">pos</span><span class="p">]:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-156"><code data-line-number="156"></code></a></td>
<td class="code"><code>            <span class="n">prime</span> <span class="o">=</span> <span class="n">cpos</span> <span class="o">+</span> <span class="mi">29</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-157"><code data-line-number="157"></code></a></td>
<td class="code"><code>            <span class="n">p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prime</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-158"><code data-line-number="158"></code></a></td>
<td class="code"><code>            <span class="n">lastadded</span> <span class="o">=</span> <span class="mi">29</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-159"><code data-line-number="159"></code></a></td>
<td class="code"><code>            <span class="k">for</span> <span class="n">off</span> <span class="ow">in</span> <span class="n">offsets</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-160"><code data-line-number="160"></code></a></td>
<td class="code"><code>                <span class="n">tmp</span> <span class="o">=</span> <span class="n">d</span><span class="p">[(</span><span class="mi">29</span><span class="p">,</span> <span class="n">off</span><span class="p">)]</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-161"><code data-line-number="161"></code></a></td>
<td class="code"><code>                <span class="n">start</span> <span class="o">=</span> <span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="n">prime</span><span class="p">)</span> <span class="k">if</span> <span class="n">off</span> <span class="o">==</span> <span class="mi">29</span> <span class="k">else</span> <span class="p">(</span><span class="n">prime</span> <span class="o">*</span> <span class="p">(</span><span class="n">const</span> <span class="o">*</span> <span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">tmp</span> <span class="o">&lt;</span> <span class="mi">29</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">tmp</span><span class="p">)</span> <span class="p">)</span><span class="o">//</span><span class="n">const</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-162"><code data-line-number="162"></code></a></td>
<td class="code"><code>                <span class="n">del_mult</span><span class="p">(</span><span class="n">tmptk</span><span class="p">[</span><span class="n">off</span><span class="p">],</span> <span class="n">start</span><span class="p">,</span> <span class="n">prime</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-163"><code data-line-number="163"></code></a></td>
<td class="code"><code>        <span class="c1"># now we go back to top tk1, so we need to increase pos by 1</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-164"><code data-line-number="164"></code></a></td>
<td class="code"><code>        <span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-165"><code data-line-number="165"></code></a></td>
<td class="code"><code>        <span class="n">cpos</span> <span class="o">=</span> <span class="n">const</span> <span class="o">*</span> <span class="n">pos</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-166"><code data-line-number="166"></code></a></td>
<td class="code"><code>        <span class="c1"># 30k + 1</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-167"><code data-line-number="167"></code></a></td>
<td class="code"><code>        <span class="k">if</span> <span class="n">tk1</span><span class="p">[</span><span class="n">pos</span><span class="p">]:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-168"><code data-line-number="168"></code></a></td>
<td class="code"><code>            <span class="n">prime</span> <span class="o">=</span> <span class="n">cpos</span> <span class="o">+</span> <span class="mi">1</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-169"><code data-line-number="169"></code></a></td>
<td class="code"><code>            <span class="n">p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prime</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-170"><code data-line-number="170"></code></a></td>
<td class="code"><code>            <span class="n">lastadded</span> <span class="o">=</span> <span class="mi">1</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-171"><code data-line-number="171"></code></a></td>
<td class="code"><code>            <span class="k">for</span> <span class="n">off</span> <span class="ow">in</span> <span class="n">offsets</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-172"><code data-line-number="172"></code></a></td>
<td class="code"><code>                <span class="n">tmp</span> <span class="o">=</span> <span class="n">d</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="n">off</span><span class="p">)]</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-173"><code data-line-number="173"></code></a></td>
<td class="code"><code>                <span class="n">start</span> <span class="o">=</span> <span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="n">prime</span><span class="p">)</span> <span class="k">if</span> <span class="n">off</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="p">(</span><span class="n">prime</span> <span class="o">*</span> <span class="p">(</span><span class="n">const</span> <span class="o">*</span> <span class="n">pos</span> <span class="o">+</span> <span class="n">tmp</span><span class="p">)</span> <span class="p">)</span><span class="o">//</span><span class="n">const</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-174"><code data-line-number="174"></code></a></td>
<td class="code"><code>                <span class="n">del_mult</span><span class="p">(</span><span class="n">tmptk</span><span class="p">[</span><span class="n">off</span><span class="p">],</span> <span class="n">start</span><span class="p">,</span> <span class="n">prime</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-175"><code data-line-number="175"></code></a></td>
<td class="code"><code>    <span class="c1"># time to add remaining primes</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-176"><code data-line-number="176"></code></a></td>
<td class="code"><code>    <span class="c1"># if lastadded == 1, remove last element and start adding them from tk1</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-177"><code data-line-number="177"></code></a></td>
<td class="code"><code>    <span class="c1"># this way we don't need an "if" within the last while</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-178"><code data-line-number="178"></code></a></td>
<td class="code"><code>    <span class="k">if</span> <span class="n">lastadded</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-179"><code data-line-number="179"></code></a></td>
<td class="code"><code>        <span class="n">p</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-180"><code data-line-number="180"></code></a></td>
<td class="code"><code>    <span class="c1"># now complete for every other possible prime</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-181"><code data-line-number="181"></code></a></td>
<td class="code"><code>    <span class="k">while</span> <span class="n">pos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">tk1</span><span class="p">):</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-182"><code data-line-number="182"></code></a></td>
<td class="code"><code>        <span class="n">cpos</span> <span class="o">=</span> <span class="n">const</span> <span class="o">*</span> <span class="n">pos</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-183"><code data-line-number="183"></code></a></td>
<td class="code"><code>        <span class="k">if</span> <span class="n">tk1</span><span class="p">[</span><span class="n">pos</span><span class="p">]:</span> <span class="n">p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cpos</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-184"><code data-line-number="184"></code></a></td>
<td class="code"><code>        <span class="k">if</span> <span class="n">tk7</span><span class="p">[</span><span class="n">pos</span><span class="p">]:</span> <span class="n">p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cpos</span> <span class="o">+</span> <span class="mi">7</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-185"><code data-line-number="185"></code></a></td>
<td class="code"><code>        <span class="k">if</span> <span class="n">tk11</span><span class="p">[</span><span class="n">pos</span><span class="p">]:</span> <span class="n">p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cpos</span> <span class="o">+</span> <span class="mi">11</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-186"><code data-line-number="186"></code></a></td>
<td class="code"><code>        <span class="k">if</span> <span class="n">tk13</span><span class="p">[</span><span class="n">pos</span><span class="p">]:</span> <span class="n">p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cpos</span> <span class="o">+</span> <span class="mi">13</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-187"><code data-line-number="187"></code></a></td>
<td class="code"><code>        <span class="k">if</span> <span class="n">tk17</span><span class="p">[</span><span class="n">pos</span><span class="p">]:</span> <span class="n">p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cpos</span> <span class="o">+</span> <span class="mi">17</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-188"><code data-line-number="188"></code></a></td>
<td class="code"><code>        <span class="k">if</span> <span class="n">tk19</span><span class="p">[</span><span class="n">pos</span><span class="p">]:</span> <span class="n">p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cpos</span> <span class="o">+</span> <span class="mi">19</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-189"><code data-line-number="189"></code></a></td>
<td class="code"><code>        <span class="k">if</span> <span class="n">tk23</span><span class="p">[</span><span class="n">pos</span><span class="p">]:</span> <span class="n">p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cpos</span> <span class="o">+</span> <span class="mi">23</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-190"><code data-line-number="190"></code></a></td>
<td class="code"><code>        <span class="k">if</span> <span class="n">tk29</span><span class="p">[</span><span class="n">pos</span><span class="p">]:</span> <span class="n">p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cpos</span> <span class="o">+</span> <span class="mi">29</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-191"><code data-line-number="191"></code></a></td>
<td class="code"><code>        <span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-192"><code data-line-number="192"></code></a></td>
<td class="code"><code>    <span class="c1"># remove exceeding if present</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-193"><code data-line-number="193"></code></a></td>
<td class="code"><code>    <span class="n">pos</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-194"><code data-line-number="194"></code></a></td>
<td class="code"><code>    <span class="k">while</span> <span class="n">p</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">N</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-195"><code data-line-number="195"></code></a></td>
<td class="code"><code>        <span class="n">pos</span> <span class="o">-=</span> <span class="mi">1</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-196"><code data-line-number="196"></code></a></td>
<td class="code"><code>    <span class="k">if</span> <span class="n">pos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-197"><code data-line-number="197"></code></a></td>
<td class="code"><code>        <span class="k">del</span> <span class="n">p</span><span class="p">[</span><span class="n">pos</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-198"><code data-line-number="198"></code></a></td>
<td class="code"><code>    <span class="c1"># return p list</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-199"><code data-line-number="199"></code></a></td>
<td class="code"><code>    <span class="k">return</span> <span class="n">p</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-200"><code data-line-number="200"></code></a></td>
<td class="code"><code>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-201"><code data-line-number="201"></code></a></td>
<td class="code"><code><span class="k">def</span> <span class="nf">sieveOfEratosthenes</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-202"><code data-line-number="202"></code></a></td>
<td class="code"><code><span class="w">    </span><span class="sd">"""sieveOfEratosthenes(n): return the list of the primes &lt; n."""</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-203"><code data-line-number="203"></code></a></td>
<td class="code"><code>    <span class="c1"># Code from: &lt;dickinsm@gmail.com&gt;, Nov 30 2006</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-204"><code data-line-number="204"></code></a></td>
<td class="code"><code>    <span class="c1"># http://groups.google.com/group/comp.lang.python/msg/f1f10ced88c68c2d</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-205"><code data-line-number="205"></code></a></td>
<td class="code"><code>    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-206"><code data-line-number="206"></code></a></td>
<td class="code"><code>        <span class="k">return</span> <span class="p">[]</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-207"><code data-line-number="207"></code></a></td>
<td class="code"><code>    <span class="n">sieve</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-208"><code data-line-number="208"></code></a></td>
<td class="code"><code>    <span class="n">top</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sieve</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-209"><code data-line-number="209"></code></a></td>
<td class="code"><code>    <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="n">sieve</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-210"><code data-line-number="210"></code></a></td>
<td class="code"><code>        <span class="k">if</span> <span class="n">si</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-211"><code data-line-number="211"></code></a></td>
<td class="code"><code>            <span class="n">bottom</span> <span class="o">=</span> <span class="p">(</span><span class="n">si</span><span class="o">*</span><span class="n">si</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-212"><code data-line-number="212"></code></a></td>
<td class="code"><code>            <span class="k">if</span> <span class="n">bottom</span> <span class="o">&gt;=</span> <span class="n">top</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-213"><code data-line-number="213"></code></a></td>
<td class="code"><code>                <span class="k">break</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-214"><code data-line-number="214"></code></a></td>
<td class="code"><code>            <span class="n">sieve</span><span class="p">[</span><span class="n">bottom</span><span class="p">::</span><span class="n">si</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="o">-</span><span class="p">((</span><span class="n">bottom</span> <span class="o">-</span> <span class="n">top</span><span class="p">)</span> <span class="o">//</span> <span class="n">si</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-215"><code data-line-number="215"></code></a></td>
<td class="code"><code>    <span class="k">return</span> <span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">el</span> <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">sieve</span> <span class="k">if</span> <span class="n">el</span><span class="p">]</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-216"><code data-line-number="216"></code></a></td>
<td class="code"><code>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-217"><code data-line-number="217"></code></a></td>
<td class="code"><code><span class="k">def</span> <span class="nf">sieveOfAtkin</span><span class="p">(</span><span class="n">end</span><span class="p">):</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-218"><code data-line-number="218"></code></a></td>
<td class="code"><code><span class="w">    </span><span class="sd">"""sieveOfAtkin(end): return a list of all the prime numbers &lt;end</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-219"><code data-line-number="219"></code></a></td>
<td class="code"><code><span class="sd">    using the Sieve of Atkin."""</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-220"><code data-line-number="220"></code></a></td>
<td class="code"><code>    <span class="c1"># Code by Steve Krenzel, &lt;Sgk284@gmail.com&gt;, improved</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-221"><code data-line-number="221"></code></a></td>
<td class="code"><code>    <span class="c1"># Code: https://web.archive.org/web/20080324064651/http://krenzel.info/?p=83</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-222"><code data-line-number="222"></code></a></td>
<td class="code"><code>    <span class="c1"># Info: http://en.wikipedia.org/wiki/Sieve_of_Atkin</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-223"><code data-line-number="223"></code></a></td>
<td class="code"><code>    <span class="k">assert</span> <span class="n">end</span> <span class="o">&gt;</span> <span class="mi">0</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-224"><code data-line-number="224"></code></a></td>
<td class="code"><code>    <span class="n">lng</span> <span class="o">=</span> <span class="p">((</span><span class="n">end</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-225"><code data-line-number="225"></code></a></td>
<td class="code"><code>    <span class="n">sieve</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">lng</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-226"><code data-line-number="226"></code></a></td>
<td class="code"><code>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-227"><code data-line-number="227"></code></a></td>
<td class="code"><code>    <span class="n">x_max</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">xd</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sqrt</span><span class="p">((</span><span class="n">end</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mf">4.0</span><span class="p">)),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-228"><code data-line-number="228"></code></a></td>
<td class="code"><code>    <span class="k">for</span> <span class="n">xd</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="o">*</span><span class="n">x_max</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">):</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-229"><code data-line-number="229"></code></a></td>
<td class="code"><code>        <span class="n">x2</span> <span class="o">+=</span> <span class="n">xd</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-230"><code data-line-number="230"></code></a></td>
<td class="code"><code>        <span class="n">y_max</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">end</span><span class="o">-</span><span class="n">x2</span><span class="p">))</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-231"><code data-line-number="231"></code></a></td>
<td class="code"><code>        <span class="n">n</span><span class="p">,</span> <span class="n">n_diff</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">+</span> <span class="n">y_max</span><span class="o">*</span><span class="n">y_max</span><span class="p">,</span> <span class="p">(</span><span class="n">y_max</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-232"><code data-line-number="232"></code></a></td>
<td class="code"><code>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">n</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">):</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-233"><code data-line-number="233"></code></a></td>
<td class="code"><code>            <span class="n">n</span> <span class="o">-=</span> <span class="n">n_diff</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-234"><code data-line-number="234"></code></a></td>
<td class="code"><code>            <span class="n">n_diff</span> <span class="o">-=</span> <span class="mi">2</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-235"><code data-line-number="235"></code></a></td>
<td class="code"><code>        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">((</span><span class="n">n_diff</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">):</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-236"><code data-line-number="236"></code></a></td>
<td class="code"><code>            <span class="n">m</span> <span class="o">=</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">12</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-237"><code data-line-number="237"></code></a></td>
<td class="code"><code>            <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">m</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-238"><code data-line-number="238"></code></a></td>
<td class="code"><code>                <span class="n">m</span> <span class="o">=</span> <span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-239"><code data-line-number="239"></code></a></td>
<td class="code"><code>                <span class="n">sieve</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">sieve</span><span class="p">[</span><span class="n">m</span><span class="p">]</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-240"><code data-line-number="240"></code></a></td>
<td class="code"><code>            <span class="n">n</span> <span class="o">-=</span> <span class="n">d</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-241"><code data-line-number="241"></code></a></td>
<td class="code"><code>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-242"><code data-line-number="242"></code></a></td>
<td class="code"><code>    <span class="n">x_max</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">xd</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sqrt</span><span class="p">((</span><span class="n">end</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">)),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-243"><code data-line-number="243"></code></a></td>
<td class="code"><code>    <span class="k">for</span> <span class="n">xd</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">x_max</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-244"><code data-line-number="244"></code></a></td>
<td class="code"><code>        <span class="n">x2</span> <span class="o">+=</span> <span class="n">xd</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-245"><code data-line-number="245"></code></a></td>
<td class="code"><code>        <span class="n">y_max</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">end</span><span class="o">-</span><span class="n">x2</span><span class="p">))</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-246"><code data-line-number="246"></code></a></td>
<td class="code"><code>        <span class="n">n</span><span class="p">,</span> <span class="n">n_diff</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">+</span> <span class="n">y_max</span><span class="o">*</span><span class="n">y_max</span><span class="p">,</span> <span class="p">(</span><span class="n">y_max</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-247"><code data-line-number="247"></code></a></td>
<td class="code"><code>        <span class="k">if</span> <span class="ow">not</span><span class="p">(</span><span class="n">n</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">):</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-248"><code data-line-number="248"></code></a></td>
<td class="code"><code>            <span class="n">n</span> <span class="o">-=</span> <span class="n">n_diff</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-249"><code data-line-number="249"></code></a></td>
<td class="code"><code>            <span class="n">n_diff</span> <span class="o">-=</span> <span class="mi">2</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-250"><code data-line-number="250"></code></a></td>
<td class="code"><code>        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">((</span><span class="n">n_diff</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">):</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-251"><code data-line-number="251"></code></a></td>
<td class="code"><code>            <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">12</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-252"><code data-line-number="252"></code></a></td>
<td class="code"><code>                <span class="n">m</span> <span class="o">=</span> <span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-253"><code data-line-number="253"></code></a></td>
<td class="code"><code>                <span class="n">sieve</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">sieve</span><span class="p">[</span><span class="n">m</span><span class="p">]</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-254"><code data-line-number="254"></code></a></td>
<td class="code"><code>            <span class="n">n</span> <span class="o">-=</span> <span class="n">d</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-255"><code data-line-number="255"></code></a></td>
<td class="code"><code>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-256"><code data-line-number="256"></code></a></td>
<td class="code"><code>    <span class="n">x_max</span><span class="p">,</span> <span class="n">y_min</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">xd</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">4</span><span class="o">-</span><span class="mi">8</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">end</span><span class="p">)))</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-257"><code data-line-number="257"></code></a></td>
<td class="code"><code>    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x_max</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-258"><code data-line-number="258"></code></a></td>
<td class="code"><code>        <span class="n">x2</span> <span class="o">+=</span> <span class="n">xd</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-259"><code data-line-number="259"></code></a></td>
<td class="code"><code>        <span class="n">xd</span> <span class="o">+=</span> <span class="mi">6</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-260"><code data-line-number="260"></code></a></td>
<td class="code"><code>        <span class="k">if</span> <span class="n">x2</span> <span class="o">&gt;=</span> <span class="n">end</span><span class="p">:</span> <span class="n">y_min</span> <span class="o">=</span> <span class="p">(((</span><span class="nb">int</span><span class="p">(</span><span class="n">ceil</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">end</span><span class="p">)))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-261"><code data-line-number="261"></code></a></td>
<td class="code"><code>        <span class="n">n</span><span class="p">,</span> <span class="n">n_diff</span> <span class="o">=</span> <span class="p">((</span><span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(((</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-262"><code data-line-number="262"></code></a></td>
<td class="code"><code>        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">n_diff</span><span class="p">,</span> <span class="n">y_min</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">):</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-263"><code data-line-number="263"></code></a></td>
<td class="code"><code>            <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">12</span> <span class="o">==</span> <span class="mi">11</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-264"><code data-line-number="264"></code></a></td>
<td class="code"><code>                <span class="n">m</span> <span class="o">=</span> <span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-265"><code data-line-number="265"></code></a></td>
<td class="code"><code>                <span class="n">sieve</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">sieve</span><span class="p">[</span><span class="n">m</span><span class="p">]</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-266"><code data-line-number="266"></code></a></td>
<td class="code"><code>            <span class="n">n</span> <span class="o">+=</span> <span class="n">d</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-267"><code data-line-number="267"></code></a></td>
<td class="code"><code>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-268"><code data-line-number="268"></code></a></td>
<td class="code"><code>    <span class="n">primes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-269"><code data-line-number="269"></code></a></td>
<td class="code"><code>    <span class="k">if</span> <span class="n">end</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-270"><code data-line-number="270"></code></a></td>
<td class="code"><code>        <span class="k">return</span> <span class="n">primes</span><span class="p">[:</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">end</span><span class="o">-</span><span class="mi">2</span><span class="p">)]</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-271"><code data-line-number="271"></code></a></td>
<td class="code"><code>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-272"><code data-line-number="272"></code></a></td>
<td class="code"><code>    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">5</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">end</span><span class="p">))</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">):</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-273"><code data-line-number="273"></code></a></td>
<td class="code"><code>        <span class="k">if</span> <span class="n">sieve</span><span class="p">[</span><span class="n">n</span><span class="p">]:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-274"><code data-line-number="274"></code></a></td>
<td class="code"><code>            <span class="n">primes</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">n</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-275"><code data-line-number="275"></code></a></td>
<td class="code"><code>            <span class="n">aux</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-276"><code data-line-number="276"></code></a></td>
<td class="code"><code>            <span class="n">aux</span> <span class="o">*=</span> <span class="n">aux</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-277"><code data-line-number="277"></code></a></td>
<td class="code"><code>            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">aux</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">aux</span><span class="p">):</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-278"><code data-line-number="278"></code></a></td>
<td class="code"><code>                <span class="n">sieve</span><span class="p">[</span><span class="n">k</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-279"><code data-line-number="279"></code></a></td>
<td class="code"><code>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-280"><code data-line-number="280"></code></a></td>
<td class="code"><code>    <span class="n">s</span>  <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">end</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-281"><code data-line-number="281"></code></a></td>
<td class="code"><code>    <span class="k">if</span> <span class="n">s</span>  <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-282"><code data-line-number="282"></code></a></td>
<td class="code"><code>        <span class="n">s</span> <span class="o">+=</span> <span class="mi">1</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-283"><code data-line-number="283"></code></a></td>
<td class="code"><code>    <span class="n">primes</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">if</span> <span class="n">sieve</span><span class="p">[</span><span class="n">i</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">]])</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-284"><code data-line-number="284"></code></a></td>
<td class="code"><code>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-285"><code data-line-number="285"></code></a></td>
<td class="code"><code>    <span class="k">return</span> <span class="n">primes</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-286"><code data-line-number="286"></code></a></td>
<td class="code"><code>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-287"><code data-line-number="287"></code></a></td>
<td class="code"><code><span class="k">def</span> <span class="nf">ambi_sieve_plain</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-288"><code data-line-number="288"></code></a></td>
<td class="code"><code>    <span class="n">s</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-289"><code data-line-number="289"></code></a></td>
<td class="code"><code>    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> 
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-290"><code data-line-number="290"></code></a></td>
<td class="code"><code>        <span class="k">if</span> <span class="n">s</span><span class="p">[(</span><span class="n">m</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">]:</span> 
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-291"><code data-line-number="291"></code></a></td>
<td class="code"><code>            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">((</span><span class="n">m</span><span class="o">*</span><span class="n">m</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,(</span><span class="n">n</span><span class="o">&gt;&gt;</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">m</span><span class="p">):</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-292"><code data-line-number="292"></code></a></td>
<td class="code"><code>                <span class="n">s</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-293"><code data-line-number="293"></code></a></td>
<td class="code"><code>    <span class="k">return</span> <span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="p">[</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">s</span> <span class="k">if</span> <span class="n">t</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-294"><code data-line-number="294"></code></a></td>
<td class="code"><code>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-295"><code data-line-number="295"></code></a></td>
<td class="code"><code><span class="k">def</span> <span class="nf">sundaram3</span><span class="p">(</span><span class="n">max_n</span><span class="p">):</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-296"><code data-line-number="296"></code></a></td>
<td class="code"><code>    <span class="c1"># https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n-in-python/2073279#2073279</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-297"><code data-line-number="297"></code></a></td>
<td class="code"><code>    <span class="n">numbers</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">max_n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-298"><code data-line-number="298"></code></a></td>
<td class="code"><code>    <span class="n">half</span> <span class="o">=</span> <span class="p">(</span><span class="n">max_n</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-299"><code data-line-number="299"></code></a></td>
<td class="code"><code>    <span class="n">initial</span> <span class="o">=</span> <span class="mi">4</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-300"><code data-line-number="300"></code></a></td>
<td class="code"><code>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-301"><code data-line-number="301"></code></a></td>
<td class="code"><code>    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">max_n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-302"><code data-line-number="302"></code></a></td>
<td class="code"><code>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">initial</span><span class="p">,</span> <span class="n">half</span><span class="p">,</span> <span class="n">step</span><span class="p">):</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-303"><code data-line-number="303"></code></a></td>
<td class="code"><code>            <span class="n">numbers</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-304"><code data-line-number="304"></code></a></td>
<td class="code"><code>        <span class="n">initial</span> <span class="o">+=</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">step</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-305"><code data-line-number="305"></code></a></td>
<td class="code"><code>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-306"><code data-line-number="306"></code></a></td>
<td class="code"><code>        <span class="k">if</span> <span class="n">initial</span> <span class="o">&gt;</span> <span class="n">half</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-307"><code data-line-number="307"></code></a></td>
<td class="code"><code>            <span class="k">return</span> <span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="nb">filter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">numbers</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-308"><code data-line-number="308"></code></a></td>
<td class="code"><code>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-309"><code data-line-number="309"></code></a></td>
<td class="code"><code><span class="c1">################################################################################</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-310"><code data-line-number="310"></code></a></td>
<td class="code"><code><span class="c1"># Using Numpy:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-311"><code data-line-number="311"></code></a></td>
<td class="code"><code><span class="k">def</span> <span class="nf">ambi_sieve</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-312"><code data-line-number="312"></code></a></td>
<td class="code"><code>    <span class="c1"># http://tommih.blogspot.com/2009/04/fast-prime-number-generator.html</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-313"><code data-line-number="313"></code></a></td>
<td class="code"><code>    <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-314"><code data-line-number="314"></code></a></td>
<td class="code"><code>    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> 
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-315"><code data-line-number="315"></code></a></td>
<td class="code"><code>        <span class="k">if</span> <span class="n">s</span><span class="p">[(</span><span class="n">m</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">]:</span> 
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-316"><code data-line-number="316"></code></a></td>
<td class="code"><code>            <span class="n">s</span><span class="p">[(</span><span class="n">m</span><span class="o">*</span><span class="n">m</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">::</span><span class="n">m</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-317"><code data-line-number="317"></code></a></td>
<td class="code"><code>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="n">s</span><span class="p">[</span><span class="n">s</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]]</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-318"><code data-line-number="318"></code></a></td>
<td class="code"><code>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-319"><code data-line-number="319"></code></a></td>
<td class="code"><code><span class="k">def</span> <span class="nf">primesfrom3to</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-320"><code data-line-number="320"></code></a></td>
<td class="code"><code>    <span class="c1"># https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n-in-python/3035188#3035188</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-321"><code data-line-number="321"></code></a></td>
<td class="code"><code><span class="w">    </span><span class="sd">""" Returns a array of primes, p &lt; n """</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-322"><code data-line-number="322"></code></a></td>
<td class="code"><code>    <span class="k">assert</span> <span class="n">n</span><span class="o">&gt;=</span><span class="mi">2</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-323"><code data-line-number="323"></code></a></td>
<td class="code"><code>    <span class="n">sieve</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-324"><code data-line-number="324"></code></a></td>
<td class="code"><code>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-325"><code data-line-number="325"></code></a></td>
<td class="code"><code>        <span class="k">if</span> <span class="n">sieve</span><span class="p">[</span><span class="n">i</span><span class="o">/</span><span class="mi">2</span><span class="p">]:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-326"><code data-line-number="326"></code></a></td>
<td class="code"><code>            <span class="n">sieve</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">i</span><span class="o">/</span><span class="mi">2</span><span class="p">::</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-327"><code data-line-number="327"></code></a></td>
<td class="code"><code>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">sieve</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">::]</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-328"><code data-line-number="328"></code></a></td>
<td class="code"><code>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-329"><code data-line-number="329"></code></a></td>
<td class="code"><code><span class="k">def</span> <span class="nf">primesfrom2to</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-330"><code data-line-number="330"></code></a></td>
<td class="code"><code>    <span class="c1"># https://stackoverflow.com/questions/2068372/fastest-way-to-list-all-primes-below-n-in-python/3035188#3035188</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-331"><code data-line-number="331"></code></a></td>
<td class="code"><code><span class="w">    </span><span class="sd">""" Input n&gt;=6, Returns a array of primes, 2 &lt;= p &lt; n """</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-332"><code data-line-number="332"></code></a></td>
<td class="code"><code>    <span class="n">sieve</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="mi">3</span> <span class="o">+</span> <span class="p">(</span><span class="n">n</span><span class="o">%</span><span class="mi">6</span><span class="o">==</span><span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-333"><code data-line-number="333"></code></a></td>
<td class="code"><code>    <span class="n">sieve</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-334"><code data-line-number="334"></code></a></td>
<td class="code"><code>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-335"><code data-line-number="335"></code></a></td>
<td class="code"><code>        <span class="k">if</span> <span class="n">sieve</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-336"><code data-line-number="336"></code></a></td>
<td class="code"><code>            <span class="n">k</span><span class="o">=</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="o">|</span><span class="mi">1</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-337"><code data-line-number="337"></code></a></td>
<td class="code"><code>            <span class="n">sieve</span><span class="p">[</span>      <span class="p">((</span><span class="n">k</span><span class="o">*</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>      <span class="p">::</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-338"><code data-line-number="338"></code></a></td>
<td class="code"><code>            <span class="n">sieve</span><span class="p">[(</span><span class="n">k</span><span class="o">*</span><span class="n">k</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">k</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="mi">3</span><span class="p">::</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-339"><code data-line-number="339"></code></a></td>
<td class="code"><code>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,((</span><span class="mi">3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">sieve</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">|</span><span class="mi">1</span><span class="p">)]</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-340"><code data-line-number="340"></code></a></td>
<td class="code"><code>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-341"><code data-line-number="341"></code></a></td>
<td class="code"><code><span class="k">if</span> <span class="vm">__name__</span><span class="o">==</span><span class="s1">'__main__'</span><span class="p">:</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-342"><code data-line-number="342"></code></a></td>
<td class="code"><code>    <span class="kn">import</span> <span class="nn">itertools</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-343"><code data-line-number="343"></code></a></td>
<td class="code"><code>    <span class="kn">import</span> <span class="nn">sys</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-344"><code data-line-number="344"></code></a></td>
<td class="code"><code>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-345"><code data-line-number="345"></code></a></td>
<td class="code"><code>    <span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span><span class="n">f2</span><span class="p">,</span><span class="n">num</span><span class="p">):</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-346"><code data-line-number="346"></code></a></td>
<td class="code"><code>        <span class="nb">print</span><span class="p">(</span><span class="s1">'Testing </span><span class="si">{f1}</span><span class="s1"> and </span><span class="si">{f2}</span><span class="s1"> return same results'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-347"><code data-line-number="347"></code></a></td>
<td class="code"><code>            <span class="n">f1</span><span class="o">=</span><span class="n">f1</span><span class="o">.</span><span class="n">func_name</span><span class="p">,</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-348"><code data-line-number="348"></code></a></td>
<td class="code"><code>            <span class="n">f2</span><span class="o">=</span><span class="n">f2</span><span class="o">.</span><span class="n">func_name</span><span class="p">))</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-349"><code data-line-number="349"></code></a></td>
<td class="code"><code>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="n">a</span><span class="o">==</span><span class="n">b</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">izip_longest</span><span class="p">(</span><span class="n">f1</span><span class="p">(</span><span class="n">num</span><span class="p">),</span><span class="n">f2</span><span class="p">(</span><span class="n">num</span><span class="p">))]):</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-350"><code data-line-number="350"></code></a></td>
<td class="code"><code>            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">"Error: </span><span class="si">%s</span><span class="s2">(</span><span class="si">%s</span><span class="s2">) != </span><span class="si">%s</span><span class="s2">(</span><span class="si">%s</span><span class="s2">)"</span><span class="o">%</span><span class="p">(</span><span class="n">f1</span><span class="o">.</span><span class="n">func_name</span><span class="p">,</span><span class="n">num</span><span class="p">,</span><span class="n">f2</span><span class="o">.</span><span class="n">func_name</span><span class="p">,</span><span class="n">num</span><span class="p">))</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-351"><code data-line-number="351"></code></a></td>
<td class="code"><code>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-352"><code data-line-number="352"></code></a></td>
<td class="code"><code>    <span class="n">n</span><span class="o">=</span><span class="mi">1000000</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-353"><code data-line-number="353"></code></a></td>
<td class="code"><code>    <span class="n">test</span><span class="p">(</span><span class="n">sieveOfAtkin</span><span class="p">,</span><span class="n">sieveOfEratosthenes</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-354"><code data-line-number="354"></code></a></td>
<td class="code"><code>    <span class="n">test</span><span class="p">(</span><span class="n">sieveOfAtkin</span><span class="p">,</span><span class="n">ambi_sieve</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-355"><code data-line-number="355"></code></a></td>
<td class="code"><code>    <span class="n">test</span><span class="p">(</span><span class="n">sieveOfAtkin</span><span class="p">,</span><span class="n">ambi_sieve_plain</span><span class="p">,</span><span class="n">n</span><span class="p">)</span> 
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-356"><code data-line-number="356"></code></a></td>
<td class="code"><code>    <span class="n">test</span><span class="p">(</span><span class="n">sieveOfAtkin</span><span class="p">,</span><span class="n">sundaram3</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-357"><code data-line-number="357"></code></a></td>
<td class="code"><code>    <span class="n">test</span><span class="p">(</span><span class="n">sieveOfAtkin</span><span class="p">,</span><span class="n">sieve_wheel_30</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-358"><code data-line-number="358"></code></a></td>
<td class="code"><code>    <span class="n">test</span><span class="p">(</span><span class="n">sieveOfAtkin</span><span class="p">,</span><span class="n">primesfrom3to</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-359"><code data-line-number="359"></code></a></td>
<td class="code"><code>    <span class="n">test</span><span class="p">(</span><span class="n">sieveOfAtkin</span><span class="p">,</span><span class="n">primesfrom2to</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-360"><code data-line-number="360"></code></a></td>
<td class="code"><code>    <span class="n">test</span><span class="p">(</span><span class="n">sieveOfAtkin</span><span class="p">,</span><span class="n">rwh_primes</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-361"><code data-line-number="361"></code></a></td>
<td class="code"><code>    <span class="n">test</span><span class="p">(</span><span class="n">sieveOfAtkin</span><span class="p">,</span><span class="n">rwh_primes1</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>         
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/fastest-way-to-list-all-primes-below-n/#-362"><code data-line-number="362"></code></a></td>
<td class="code"><code>    <span class="n">test</span><span class="p">(</span><span class="n">sieveOfAtkin</span><span class="p">,</span><span class="n">rwh_primes2</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
</code></td>
</tr>
</table></div>
<p>Running the script tests that all implementations give the same result.</p>
<p><br></p>
<h3>Suggest</h3>
<p>Faster &amp; more memory-wise pure Python code:</p>
<div class="code"><pre class="code literal-block"><span class="n">def</span><span class="w"> </span><span class="n">primes</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="err">:</span>
<span class="w">    </span><span class="ss">""" Returns  a list of primes &lt; n """</span>
<span class="w">    </span><span class="n">sieve</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">True</span><span class="o">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">n</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="nc">int</span><span class="p">(</span><span class="n">n</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="err">:</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">sieve</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="err">:</span>
<span class="w">            </span><span class="n">sieve</span><span class="o">[</span><span class="n">i*i::2*i</span><span class="o">]=[</span><span class="n">False</span><span class="o">]*</span><span class="p">((</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">[</span><span class="n">2</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="o">[</span><span class="n">i for i in range(3,n,2) if sieve[i</span><span class="o">]</span><span class="err">]</span>
</pre></div>

<p>or starting with half sieve</p>
<div class="code"><pre class="code literal-block"><span class="n">def</span><span class="w"> </span><span class="n">primes1</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="err">:</span>
<span class="w">    </span><span class="ss">""" Returns  a list of primes &lt; n """</span>
<span class="w">    </span><span class="n">sieve</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">True</span><span class="o">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="nc">int</span><span class="p">(</span><span class="n">n</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="err">:</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">sieve</span><span class="o">[</span><span class="n">i//2</span><span class="o">]</span><span class="err">:</span>
<span class="w">            </span><span class="n">sieve</span><span class="o">[</span><span class="n">i*i//2::i</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">False</span><span class="o">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">((</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">[</span><span class="n">2</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="o">[</span><span class="n">2*i+1 for i in range(1,n//2) if sieve[i</span><span class="o">]</span><span class="err">]</span>
</pre></div>

<p>Faster &amp; more memory-wise numpy code:</p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="nn">numpy</span>
<span class="k">def</span> <span class="nf">primesfrom3to</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">""" Returns a array of primes, 3 &lt;= p &lt; n """</span>
    <span class="n">sieve</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="kp">ones</span><span class="p">(</span><span class="n">n</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="kp">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">sieve</span><span class="p">[</span><span class="n">i</span><span class="o">//</span><span class="mi">2</span><span class="p">]:</span>
            <span class="n">sieve</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">i</span><span class="o">//</span><span class="mi">2</span><span class="p">::</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="kp">nonzero</span><span class="p">(</span><span class="n">sieve</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">::]</span><span class="o">+</span><span class="mi">1</span>
</pre></div>

<p>a faster variation starting with a third of a sieve:</p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="nn">numpy</span>
<span class="k">def</span> <span class="nf">primesfrom2to</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">""" Input n&gt;=6, Returns a array of primes, 2 &lt;= p &lt; n """</span>
    <span class="n">sieve</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="kp">ones</span><span class="p">(</span><span class="n">n</span><span class="o">//</span><span class="mi">3</span> <span class="o">+</span> <span class="p">(</span><span class="n">n</span><span class="o">%</span><span class="mi">6</span><span class="o">==</span><span class="mi">2</span><span class="p">),</span> <span class="kp">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span><span class="o">//</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">sieve</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">k</span><span class="o">=</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="o">|</span><span class="mi">1</span>
            <span class="n">sieve</span><span class="p">[</span>       <span class="n">k</span><span class="o">*</span><span class="n">k</span><span class="o">//</span><span class="mi">3</span>     <span class="p">::</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">sieve</span><span class="p">[</span><span class="n">k</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span><span class="o">//</span><span class="mi">3</span><span class="p">::</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="kp">r_</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,((</span><span class="mi">3</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="kp">nonzero</span><span class="p">(</span><span class="n">sieve</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">|</span><span class="mi">1</span><span class="p">)]</span>
</pre></div>

<p>A (hard-to-code) pure-python version of the above code would be:</p>
<div class="code"><pre class="code literal-block"><span class="n">def</span><span class="w"> </span><span class="n">primes2</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="err">:</span>
<span class="w">    </span><span class="ss">""" Input n&gt;=6, Returns a list of primes, 2 &lt;= p &lt; n """</span>
<span class="w">    </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">correction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="o">-</span><span class="n">n</span><span class="o">%</span><span class="mi">6</span><span class="o">+</span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">-</span><span class="p">(</span><span class="n">n</span><span class="o">%</span><span class="mi">6</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="n">sieve</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">True</span><span class="o">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="o">//</span><span class="mi">3</span><span class="p">)</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nc">int</span><span class="p">(</span><span class="n">n</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span><span class="o">//</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="err">:</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="n">sieve</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="err">:</span>
<span class="w">        </span><span class="n">k</span><span class="o">=</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="o">|</span><span class="mi">1</span>
<span class="w">        </span><span class="n">sieve</span><span class="o">[</span><span class="n">      k*k//3      ::2*k</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">False</span><span class="o">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">((</span><span class="n">n</span><span class="o">//</span><span class="mi">6</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">k</span><span class="o">//</span><span class="mi">6</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="n">sieve</span><span class="o">[</span><span class="n">k*(k-2*(i&amp;1)+4)//3::2*k</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">False</span><span class="o">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">((</span><span class="n">n</span><span class="o">//</span><span class="mi">6</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span><span class="o">//</span><span class="mi">6</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">[</span><span class="n">2,3</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="o">[</span><span class="n">3*i+1|1 for i in range(1,n//3-correction) if sieve[i</span><span class="o">]</span><span class="err">]</span>
</pre></div>

<p>Unfortunately pure-python don't adopt the simpler and faster numpy way of
doing assignment, and calling <code>len()</code> inside the loop as in
<code>[False]*len(sieve[((k*k)//3)::2*k])</code> is too slow. So I had to improvise to
correct input (&amp; avoid more math) and do some extreme (&amp; painful) math-magic.</p>
<p>Personally I think it is a shame that numpy (which is so widely used) is not
part of Python standard library, and that the improvements in syntax and speed
seem to be completely overlooked by Python developers.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-can-i-percent-encode-url-parameters-in-python/" class="u-url">How can I percent-encode URL parameters in Python?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-can-i-percent-encode-url-parameters-in-python/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T04:36:26+08:00" itemprop="datePublished" title="2023-03-04 04:36">2023-03-04 04:36</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>If I do</p>
<div class="code"><pre class="code literal-block">url = "http://example.com?p=" + urllib.quote(query)
</pre></div>

<ol>
<li>It doesn't encode <code>/</code> to <code>%2F</code> (breaks OAuth normalization)</li>
<li>It doesn't handle Unicode (it throws an exception)</li>
</ol>
<p>Is there a better library?</p>
<p><br><br></p>
<h2>Answer</h2>
<h2>Python 2</h2>
<p>From the documentation:</p>
<div class="code"><pre class="code literal-block">urllib.quote(string[, safe])
</pre></div>

<blockquote>
<p>Replace special characters in string using the %xx escape. Letters, digits,
and the characters '_.-' are never quoted. By default, this function is
intended for quoting the path section of the URL.The optional safe parameter
specifies additional characters that should not be quoted — <strong>its default
value is '/'</strong></p>
</blockquote>
<p>That means passing <code>''</code> for <em>safe</em> will solve your first issue:</p>
<div class="code"><pre class="code literal-block">&gt;&gt;&gt; urllib.quote('/test')
'/test'
&gt;&gt;&gt; urllib.quote('/test', safe='')
'%2Ftest'
</pre></div>

<p>About the second issue, there is a bug report about it. Apparently it was
fixed in Python 3. You can workaround it by encoding as UTF-8 like this:</p>
<div class="code"><pre class="code literal-block">&gt;&gt;&gt; query = urllib.quote(u"Müller".encode('utf8'))
&gt;&gt;&gt; print urllib.unquote(query).decode('utf8')
Müller
</pre></div>

<p>By the way, have a look at urlencode.</p>
<h2>Python 3</h2>
<p>In Python 3, the function <code>quote</code> has been moved to <code>urllib.parse</code>:</p>
<div class="code"><pre class="code literal-block"><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">urllib.parse</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="s2">"Müller"</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">'utf8'</span><span class="p">)))</span>
<span class="n">M</span><span class="o">%</span><span class="n">C3</span><span class="o">%</span><span class="n">BCller</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">unquote</span><span class="p">(</span><span class="s2">"M%C3%BCller"</span><span class="p">))</span>
<span class="n">Müller</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>In Python 3, <code>urllib.quote</code> has been moved to <code>urllib.parse.quote</code>, and it
does handle Unicode by default.</p>
<div class="code"><pre class="code literal-block"><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">quote</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">quote</span><span class="p">(</span><span class="s1">'/test'</span><span class="p">)</span>
<span class="s1">'/test'</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">quote</span><span class="p">(</span><span class="s1">'/test'</span><span class="p">,</span> <span class="n">safe</span><span class="o">=</span><span class="s1">''</span><span class="p">)</span>
<span class="s1">'</span><span class="si">%2F</span><span class="s1">test'</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">quote</span><span class="p">(</span><span class="s1">'/El Niño/'</span><span class="p">)</span>
<span class="s1">'/El%20Ni%C3%B1o/'</span>
</pre></div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-2284.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-2282.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
