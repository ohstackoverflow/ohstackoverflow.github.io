<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 1143) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-1143.html">
<link rel="prev" href="index-1144.html" type="text/html">
<link rel="next" href="index-1142.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/hibernate-throws-multiplebagfetchexception-cannot-simultaneously-fetch-multiple-bags/" class="u-url">Hibernate throws MultipleBagFetchException - cannot simultaneously fetch multiple bags</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/hibernate-throws-multiplebagfetchexception-cannot-simultaneously-fetch-multiple-bags/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T02:16:49+08:00" itemprop="datePublished" title="2023-02-18 02:16">2023-02-18 02:16</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Hibernate throws this exception during SessionFactory creation:</p>
<blockquote>
<p>org.hibernate.loader.MultipleBagFetchException: cannot simultaneously fetch
multiple bags</p>
</blockquote>
<p>This is my test case:</p>
<p><strong>Parent.java</strong></p>
<div class="code"><pre class="code literal-block"><span class="nv">@Entity</span>
<span class="k">public</span><span class="w"> </span><span class="n">Parent</span><span class="w"> </span><span class="err">{</span>

<span class="w"> </span><span class="nv">@Id</span>
<span class="w"> </span><span class="nv">@GeneratedValue</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="n">GenerationType</span><span class="p">.</span><span class="k">IDENTITY</span><span class="p">)</span>
<span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="n">Long</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>

<span class="w"> </span><span class="nv">@OneToMany</span><span class="p">(</span><span class="n">mappedBy</span><span class="o">=</span><span class="ss">"parent"</span><span class="p">,</span><span class="w"> </span><span class="k">fetch</span><span class="o">=</span><span class="n">FetchType</span><span class="p">.</span><span class="n">EAGER</span><span class="p">)</span>
<span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nv">@IndexColumn</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="ss">"INDEX_COL"</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="n">had</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">problem</span><span class="w"> </span><span class="n">solve</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="n">retrieve</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">children</span><span class="w"> </span><span class="k">than</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="n">have</span><span class="p">,</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">child</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">null</span><span class="p">.</span>
<span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Child</span><span class="o">&gt;</span><span class="w"> </span><span class="n">children</span><span class="p">;</span>

<span class="err">}</span>
</pre></div>

<p><strong>Child.java</strong></p>
<div class="code"><pre class="code literal-block"><span class="nv">@Entity</span>
<span class="k">public</span><span class="w"> </span><span class="n">Child</span><span class="w"> </span><span class="err">{</span>

<span class="w"> </span><span class="nv">@Id</span>
<span class="w"> </span><span class="nv">@GeneratedValue</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="n">GenerationType</span><span class="p">.</span><span class="k">IDENTITY</span><span class="p">)</span>
<span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="n">Long</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>

<span class="w"> </span><span class="nv">@ManyToOne</span>
<span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="n">Parent</span><span class="w"> </span><span class="n">parent</span><span class="p">;</span>

<span class="err">}</span>
</pre></div>

<p>How about this problem? What can I do?</p>
<hr>
<p><strong>EDIT</strong></p>
<p>OK, the problem I have is that another "parent" entity is inside my parent, my
real behavior is this:</p>
<p><strong>Parent.java</strong></p>
<div class="code"><pre class="code literal-block"><span class="nv">@Entity</span>
<span class="k">public</span><span class="w"> </span><span class="n">Parent</span><span class="w"> </span><span class="err">{</span>

<span class="w"> </span><span class="nv">@Id</span>
<span class="w"> </span><span class="nv">@GeneratedValue</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="n">GenerationType</span><span class="p">.</span><span class="k">IDENTITY</span><span class="p">)</span>
<span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="n">Long</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>

<span class="w"> </span><span class="nv">@ManyToOne</span>
<span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="n">AnotherParent</span><span class="w"> </span><span class="n">anotherParent</span><span class="p">;</span>

<span class="w"> </span><span class="nv">@OneToMany</span><span class="p">(</span><span class="n">mappedBy</span><span class="o">=</span><span class="ss">"parent"</span><span class="p">,</span><span class="w"> </span><span class="k">fetch</span><span class="o">=</span><span class="n">FetchType</span><span class="p">.</span><span class="n">EAGER</span><span class="p">)</span>
<span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Child</span><span class="o">&gt;</span><span class="w"> </span><span class="n">children</span><span class="p">;</span>

<span class="err">}</span>
</pre></div>

<p><strong>AnotherParent.java</strong></p>
<div class="code"><pre class="code literal-block"><span class="nv">@Entity</span>
<span class="k">public</span><span class="w"> </span><span class="n">AnotherParent</span><span class="w"> </span><span class="err">{</span>

<span class="w"> </span><span class="nv">@Id</span>
<span class="w"> </span><span class="nv">@GeneratedValue</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="n">GenerationType</span><span class="p">.</span><span class="k">IDENTITY</span><span class="p">)</span>
<span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="n">Long</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>

<span class="w"> </span><span class="nv">@OneToMany</span><span class="p">(</span><span class="n">mappedBy</span><span class="o">=</span><span class="ss">"parent"</span><span class="p">,</span><span class="w"> </span><span class="k">fetch</span><span class="o">=</span><span class="n">FetchType</span><span class="p">.</span><span class="n">EAGER</span><span class="p">)</span>
<span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">AnotherChild</span><span class="o">&gt;</span><span class="w"> </span><span class="n">anotherChildren</span><span class="p">;</span>

<span class="err">}</span>
</pre></div>

<p>Hibernate doesn't like two collections with <code>FetchType.EAGER</code>, but this seems
to be a bug, I'm not doing unusual things...</p>
<p>Removing <code>FetchType.EAGER</code> from <code>Parent</code> or <code>AnotherParent</code> solves the
problem, but I need it, so real solution is to use
<code>@LazyCollection(LazyCollectionOption.FALSE)</code> instead of <code>FetchType</code> (thanks
to Bozho for the solution).</p>
<p><br><br></p>
<h2>Answer</h2>
<p>I think a newer version of hibernate (supporting JPA 2.0) should handle this.
But otherwise you can work it around by annotating the collection fields with:</p>
<div class="code"><pre class="code literal-block"><span class="nv">@LazyCollection</span><span class="p">(</span><span class="n">LazyCollectionOption</span><span class="p">.</span><span class="k">FALSE</span><span class="p">)</span>
</pre></div>

<p>Remember to remove the <code>fetchType</code> attribute from the <code>@*ToMany</code> annotation.</p>
<p>But note that in most cases a <code>Set&lt;Child&gt;</code> is more appropriate than
<code>List&lt;Child&gt;</code>, so unless you really need a <code>List</code> - go for <code>Set</code></p>
<p>But remind that with using sets you <strong>won't</strong> eliminate the underlaying
<strong>Cartesian Product</strong> as described by Vlad Mihalcea in his answer!</p>
<p><br></p>
<h3>Suggest</h3>
<p>Simply change from <code>List</code> type to <code>Set</code> type.</p>
<p>But remind that you <strong>won't</strong> eliminate the underlaying <strong>Cartesian Product</strong>
as described by Vlad Mihalcea in his answer!</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/what-characters-are-forbidden-in-windows-and-linux-directory-names/" class="u-url">What characters are forbidden in Windows and Linux directory names?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/what-characters-are-forbidden-in-windows-and-linux-directory-names/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T02:16:21+08:00" itemprop="datePublished" title="2023-02-18 02:16">2023-02-18 02:16</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I know that <code>/</code> is illegal in Linux, and the following are illegal in Windows
(I think) <code>*</code> <code>.</code> <code>"</code> <code>/</code> <code>\</code> <code>[</code> <code>]</code> <code>:</code> <code>;</code> <code>|</code> <code>,</code></p>
<p>What else am I missing?</p>
<p>I need a comprehensive guide, however, and one that takes into account double-
byte characters. Linking to outside resources is fine with me.</p>
<p>I need to first create a directory on the filesystem using a name that may
contain forbidden characters, so I plan to replace those characters with
underscores. I then need to write this directory and its contents to a zip
file (using Java), so any additional advice concerning the names of zip
directories would be appreciated.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>A “comprehensive guide” of forbidden filename characters is not going to work
on Windows because it reserves filenames as well as characters. Yes,
characters like <code>*</code> <code>"</code> <code>?</code> and others are forbidden, but there are a infinite
number of names composed only of valid characters that are forbidden. For
example, spaces and dots are valid filename characters, but names composed
only of those characters are forbidden.</p>
<p>Windows does not distinguish between upper-case and lower-case characters, so
you cannot create a folder named <code>A</code> if one named <code>a</code> already exists. Worse,
seemingly-allowed names like <code>PRN</code> and <code>CON</code>, and many others, are reserved
and not allowed. Windows also has several length restrictions; a filename
valid in one folder may become invalid if moved to another folder. The rules
for naming files and folders are on the Microsoft docs.</p>
<p>You cannot, in general, use user-generated text to create Windows directory
names. If you want to allow users to name anything they want, you have to
create safe names like <code>A</code>, <code>AB</code>, <code>A2</code> et al., store user-generated names and
their path equivalents in an application data file, and perform path mapping
in your application.</p>
<p>If you absolutely must allow user-generated folder names, the only way to tell
if they are invalid is to catch exceptions and assume the name is invalid.
Even that is fraught with peril, as the exceptions thrown for denied access,
offline drives, and out of drive space overlap with those that can be thrown
for invalid names. You are opening up one huge can of hurt.</p>
<p><br></p>
<h3>Suggest</h3>
<p>A “comprehensive guide” of forbidden filename characters is not going to work
on Windows because it reserves filenames as well as characters. Yes,
characters like <code>*</code> <code>"</code> <code>?</code> and others are forbidden, but there are a infinite
number of names composed only of valid characters that are forbidden. For
example, spaces and dots are valid filename characters, but names composed
only of those characters are forbidden.</p>
<p>Windows does not distinguish between upper-case and lower-case characters, so
you cannot create a folder named <code>A</code> if one named <code>a</code> already exists. Worse,
seemingly-allowed names like <code>PRN</code> and <code>CON</code>, and many others, are reserved
and not allowed. Windows also has several length restrictions; a filename
valid in one folder may become invalid if moved to another folder. The rules
for naming files and folders are on the Microsoft docs.</p>
<p>You cannot, in general, use user-generated text to create Windows directory
names. If you want to allow users to name anything they want, you have to
create safe names like <code>A</code>, <code>AB</code>, <code>A2</code> et al., store user-generated names and
their path equivalents in an application data file, and perform path mapping
in your application.</p>
<p>If you absolutely must allow user-generated folder names, the only way to tell
if they are invalid is to catch exceptions and assume the name is invalid.
Even that is fraught with peril, as the exceptions thrown for denied access,
offline drives, and out of drive space overlap with those that can be thrown
for invalid names. You are opening up one huge can of hurt.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/error-1698-28000-access-denied-for-user-root-localhost/" class="u-url">ERROR 1698 (28000): Access denied for user 'root'@'localhost'</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/error-1698-28000-access-denied-for-user-root-localhost/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T02:15:52+08:00" itemprop="datePublished" title="2023-02-18 02:15">2023-02-18 02:15</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I'm setting up a new server and keep running into this problem.</p>
<p>When I try to log into the MySQL database with the root user, I get the error:</p>
<blockquote>
<p>ERROR 1698 (28000): Access denied for user 'root'@'localhost'</p>
</blockquote>
<p>It doesn't matter if I connect through the terminal (SSH), through phpMyAdmin
or a MySQL client, e.g., Navicat. They all fail.</p>
<p>I looked in the <em>mysql.user</em> table and get the following:</p>
<div class="code"><pre class="code literal-block">+------------------+-------------------+
| user             | host              |
+------------------+-------------------+
| root             | %                 |
| root             | 127.0.0.1         |
| amavisd          | localhost         |
| debian-sys-maint | localhost         |
| iredadmin        | localhost         |
| iredapd          | localhost         |
| mysql.sys        | localhost         |
| phpmyadmin       | localhost         |
| root             | localhost         |
| roundcube        | localhost         |
| vmail            | localhost         |
| vmailadmin       | localhost         |
| amavisd          | test4.folkmann.it |
| iredadmin        | test4.folkmann.it |
| iredapd          | test4.folkmann.it |
| roundcube        | test4.folkmann.it |
| vmail            | test4.folkmann.it |
| vmailadmin       | test4.folkmann.it |
+------------------+-------------------+
</pre></div>

<p>As you can see, user <em>root</em> should have access.</p>
<p>The Server is quite simple, as I have tried to troubleshoot this for a while
now.</p>
<p>It's running Ubuntu 16.04.1 LTS (Xenial Xerus) with Apache, MySQL and PHP, so
that it can host websites, and iRedMail 0.9.5-1, so that it can host mail.</p>
<p>Log into the MySQL database works fine before I installed iRedMail. I also
tried just installing iRedMail, but then root also doesn't work.</p>
<p>How can I fix my MySQL login problem or how can I install iRedMail over an
existing MySQL install? And yes, I tried the Installation Tips and I can't
find those variables in the configuration files.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>On some systems, like Ubuntu, MySQL is using the Unix auth_socket plugin by
default.</p>
<p>Basically it means that: <em>db_users using it, will be "authenticated" by <strong>the
system user credentials.</strong></em> You can see if your <code>root</code> user is set up like
this by doing the following:</p>
<div class="code"><pre class="code literal-block"><span class="c">sudo mysql </span><span class="nb">-</span><span class="c">u root # I had to use "sudo" since it was a new installation</span>

<span class="c">mysql</span><span class="nv">&gt;</span><span class="c"> USE mysql;</span>
<span class="c">mysql</span><span class="nv">&gt;</span><span class="c"> SELECT User</span><span class="nt">,</span><span class="c"> Host</span><span class="nt">,</span><span class="c"> plugin FROM mysql</span><span class="nt">.</span><span class="c">user;</span>

<span class="nb">+------------------+-----------------------+</span>
<span class="c">| User             | plugin                |</span>
<span class="nb">+------------------+-----------------------+</span>
<span class="c">| root             | auth_socket           |</span>
<span class="c">| mysql</span><span class="nt">.</span><span class="c">sys        | mysql_native_password |</span>
<span class="c">| debian</span><span class="nb">-</span><span class="c">sys</span><span class="nb">-</span><span class="c">maint | mysql_native_password |</span>
<span class="nb">+------------------+-----------------------+</span>
</pre></div>

<p>As you can see in the query, the <code>root</code> user is using the <code>auth_socket</code>
plugin.</p>
<p>There are two ways to solve this:</p>
<ol>
<li>You can set the <em>root</em> user to use the <code>mysql_native_password</code> plugin</li>
<li>You can create a new <code>db_user</code> with you <code>system_user</code> (recommended)</li>
</ol>
<p><strong>Option 1:</strong></p>
<div class="code"><pre class="code literal-block"><span class="nv">sudo</span><span class="w"> </span><span class="nv">mysql</span><span class="w"> </span><span class="o">-</span><span class="nv">u</span><span class="w"> </span><span class="nv">root</span><span class="w"> </span>#<span class="w"> </span><span class="nv">I</span><span class="w"> </span><span class="nv">had</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">use</span><span class="w"> </span><span class="s2">"sudo"</span><span class="w"> </span><span class="nv">since</span><span class="w"> </span><span class="nv">it</span><span class="w"> </span><span class="nv">was</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">installation</span>

<span class="nv">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="nv">USE</span><span class="w"> </span><span class="nv">mysql</span><span class="c1">;</span>
<span class="nv">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="nv">UPDATE</span><span class="w"> </span><span class="nv">user</span><span class="w"> </span><span class="nv">SET</span><span class="w"> </span><span class="nv">plugin</span><span class="o">=</span><span class="s1">'mysql_native_password'</span><span class="w"> </span><span class="nv">WHERE</span><span class="w"> </span><span class="nv">User</span><span class="o">=</span><span class="s1">'root'</span><span class="c1">;</span>
<span class="nv">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="nv">FLUSH</span><span class="w"> </span><span class="nv">PRIVILEGES</span><span class="c1">;</span>
<span class="nv">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="k">exit</span><span class="c1">;</span>

<span class="nv">sudo</span><span class="w"> </span><span class="nv">service</span><span class="w"> </span><span class="nv">mysql</span><span class="w"> </span><span class="nv">restart</span>
</pre></div>

<p><strong>Option 2:</strong> (replace YOUR_SYSTEM_USER with the username you have)</p>
<div class="code"><pre class="code literal-block"><span class="nv">sudo</span><span class="w"> </span><span class="nv">mysql</span><span class="w"> </span><span class="o">-</span><span class="nv">u</span><span class="w"> </span><span class="nv">root</span><span class="w"> </span>#<span class="w"> </span><span class="nv">I</span><span class="w"> </span><span class="nv">had</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">use</span><span class="w"> </span><span class="s2">"sudo"</span><span class="w"> </span><span class="nv">since</span><span class="w"> </span><span class="nv">it</span><span class="w"> </span><span class="nv">was</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">installation</span>

<span class="nv">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="nv">USE</span><span class="w"> </span><span class="nv">mysql</span><span class="c1">;</span>
<span class="nv">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="nv">CREATE</span><span class="w"> </span><span class="nv">USER</span><span class="w"> </span><span class="s1">'YOUR_SYSTEM_USER'</span>@<span class="s1">'localhost'</span><span class="w"> </span><span class="nv">IDENTIFIED</span><span class="w"> </span><span class="nv">BY</span><span class="w"> </span><span class="s1">'YOUR_PASSWD'</span><span class="c1">;</span>
<span class="nv">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="nv">GRANT</span><span class="w"> </span><span class="nv">ALL</span><span class="w"> </span><span class="nv">PRIVILEGES</span><span class="w"> </span><span class="nv">ON</span><span class="w"> </span><span class="o">*</span>.<span class="o">*</span><span class="w"> </span><span class="nv">TO</span><span class="w"> </span><span class="s1">'YOUR_SYSTEM_USER'</span>@<span class="s1">'localhost'</span><span class="c1">;</span>
<span class="nv">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="nv">UPDATE</span><span class="w"> </span><span class="nv">user</span><span class="w"> </span><span class="nv">SET</span><span class="w"> </span><span class="nv">plugin</span><span class="o">=</span><span class="s1">'auth_socket'</span><span class="w"> </span><span class="nv">WHERE</span><span class="w"> </span><span class="nv">User</span><span class="o">=</span><span class="s1">'YOUR_SYSTEM_USER'</span><span class="c1">;</span>
<span class="nv">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="nv">FLUSH</span><span class="w"> </span><span class="nv">PRIVILEGES</span><span class="c1">;</span>
<span class="nv">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="k">exit</span><span class="c1">;</span>

<span class="nv">sudo</span><span class="w"> </span><span class="nv">service</span><span class="w"> </span><span class="nv">mysql</span><span class="w"> </span><span class="nv">restart</span>
</pre></div>

<p>Remember that if you use option #2 you'll have to connect to MySQL as your
system username (<code>mysql -u YOUR_SYSTEM_USER</code>).</p>
<p><strong>Note:</strong> On some systems (e.g., Debian 9 (Stretch)) the 'auth_socket' plugin
is called 'unix_socket', so the corresponding SQL command should be: <code>UPDATE
user SET plugin='unix_socket' WHERE User='YOUR_SYSTEM_USER';</code></p>
<p>From andy's comment it seems that MySQL 8.x.x updated/replaced the
<code>auth_socket</code> for <code>caching_sha2_password</code>. I don't have a system setup with
MySQL 8.x.x to test this. However, the steps above should help you to
understand the issue. Here's the reply:</p>
<p><em>One change as of MySQL 8.0.4 is that the new default authentication plugin is
'caching_sha2_password'. The new 'YOUR_SYSTEM_USER' will have this
authentication plugin and you can log in from the Bash shell now with "mysql
-u YOUR_SYSTEM_USER -p" and provide the password for this user on the prompt.
There isn’t any need for the "UPDATE user SET plugin" step.</em></p>
<p><em>For the 8.0.4 default authentication plugin update, see</em> <em><strong>MySQL 8.0.4: New
Default Authentication Plugin: caching_sha2_password</strong></em>.</p>
<p><br></p>
<h3>Suggest</h3>
<h4>A <em>new</em> version of MySQL does it this way</h4>
<p>In the new MySQL client, if the password is left empty while installing then,
it is based on the <code>auth_socket</code> plugin.</p>
<p>The correct way is to log in to MySQL with the <code>sudo</code> privilege.</p>
<div class="code"><pre class="code literal-block">sudo mysql -u root -p
</pre></div>

<p>And then updating the password using:</p>
<div class="code"><pre class="code literal-block">ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY 'new-password';
</pre></div>

<p>Once this is done, <em>stop and start</em> the MySQL server.</p>
<div class="code"><pre class="code literal-block">sudo service mysql stop
sudo service mysql start
</pre></div>

<p>For complete details, you can refer to this link.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-1144.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-1142.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
