<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 532) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-532.html">
<link rel="prev" href="index-533.html" type="text/html">
<link rel="next" href="index-531.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/he-shi-shi-yong-first-yi-ji-he-shi-jiang-firstordefault-yu-linq-yi-qi-shi-yong/" class="u-url">何时使用 .First 以及何时将 .FirstOrDefault 与 LINQ 一起使用？</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/he-shi-shi-yong-first-yi-ji-he-shi-jiang-firstordefault-yu-linq-yi-qi-shi-yong/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T09:23:33+08:00" itemprop="datePublished" title="2023-02-17 09:23">2023-02-17 09:23</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>我四处搜索，并没有真正找到关于何时使用<code>.First</code>以及何时使用<code>.FirstOrDefault</code>LINQ 的明确答案。</p>
<ul>
<li>
<p>你想什么时候使用<code>.First</code>？只有在没有返回结果的情况下你才想捕获异常？</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">List</span><span class="o">.</span><span class="n">Where</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"foo"</span><span class="p">)</span><span class="o">.</span><span class="n">First</span><span class="p">();</span>
</pre></div>

</li>
<li>
<p>你想什么时候使用<code>.FirstOrDefault</code>？如果没有结果，你总是想要默认类型？</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">List</span><span class="o">.</span><span class="n">Where</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"foo"</span><span class="p">)</span><span class="o">.</span><span class="n">FirstOrDefault</span><span class="p">();</span>
</pre></div>

</li>
<li>
<p>就此而言，Take 呢？</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">List</span><span class="o">.</span><span class="n">Where</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"foo"</span><span class="p">)</span><span class="o">.</span><span class="n">Take</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</pre></div>

</li>
</ul>
<p><br><br></p>
<h2>解答</h2>
<p><code>First()</code>当我知道或期望序列至少有一个元素时，我会使用。换句话说，当序列为空时出现异常。</p>
<p><code>FirstOrDefault()</code>当你知道你需要检查是否有一个元素时使用。换句话说，当序列为空是合法的。您不应依赖异常处理来进行检查。（这是不好的做法，可能会损害性能）。</p>
<p><code>First()</code>最后，和之间的区别<code>Take(1)</code>在于<code>First()</code>返回元素本身，而<code>Take(1)</code>返回恰好包含一个元素的元素序列。</p>
<p><br></p>
<h3>更多建议</h3>
<p><code>.First</code>没有结果时会抛出异常。<code>.FirstOrDefault</code>不会，它只会返回 null（引用类型）或值类型的默认值。（例如，<code>0</code>对于
int。）这里的问题不是您何时需要默认类型，而是更多：您愿意处理异常还是处理默认值？由于异常应该是异常的，<code>FirstOrDefault</code>所以当您不确定是否要从查询中获得结果时，首选。当逻辑上数据应该在那里时，可以考虑异常处理。</p>
<p><code>Skip()</code>并且<code>Take()</code>通常在设置结果分页时使用。（比如显示前 10 个结果，然后在下一页显示接下来的 10 个，等等）</p>
<p><br><br><a href="posts/when-to-use-first-and-when-to-use-firstordefault-with-linq/">查看原文</a></p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/assemblyversion-assemblyfileversion-he-assemblyinformationalversion-zhi-jian-you-shi-yao-qu-bie/" class="u-url">AssemblyVersion、AssemblyFileVersion 和 AssemblyInformationalVersion 之间有什么区别？</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/assemblyversion-assemblyfileversion-he-assemblyinformationalversion-zhi-jian-you-shi-yao-qu-bie/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T09:23:07+08:00" itemprop="datePublished" title="2023-02-17 09:23">2023-02-17 09:23</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>共有三个程序集版本属性。有什么区别？<code>AssemblyVersion</code>如果我使用并忽略其余部分可以吗？</p>
<hr>
<p>MSDN 说：</p>
<ul>
<li>装配版本：</li>
</ul>
<blockquote>
<p>指定被赋予属性的程序集的版本。</p>
</blockquote>
<ul>
<li>程序集文件版本：</li>
</ul>
<blockquote>
<p>指示编译器为 Win32 文件版本资源使用特定版本号。Win32 文件版本不需要与程序集的版本号相同。</p>
</blockquote>
<ul>
<li>装配信息版本：</li>
</ul>
<blockquote>
<p>定义程序集清单的附加版本信息。</p>
</blockquote>
<hr>
<p><em>这是 什么是使用程序集属性的最佳实践？</em></p>
<p><br><br></p>
<h2>解答</h2>
<p><strong>装配版本</strong></p>
<p>引用您的程序集的其他程序集将查找的位置。如果此数字发生变化，其他程序集必须更新它们对您的程序集的引用！仅在破坏向后兼容性时才更新此版本。是<code>AssemblyVersion</code>必需的。</p>
<p>我使用格式： <em>major.minor</em> （和 <em>major</em> 用于非常稳定的代码库）。这将导致：</p>
<div class="code"><pre class="code literal-block">[assembly: AssemblyVersion("1.3")]
</pre></div>

<p>如果你严格遵循SemVer那么这意味着你只在 <em>重大</em> 变化时更新，所以 1.0、2.0、3.0 等。</p>
<p><strong>程序集文件版本</strong></p>
<p>用于部署（如安装程序）。您可以为每个部署增加此数字。使用它来标记具有相同<code>AssemblyVersion</code>但从不同构建和/或代码生成的程序集。</p>
<p>在 Windows 中，可以在文件属性中查看。</p>
<p>AssemblyFileVersion 是可选的。如果未给出，则使用 AssemblyVersion。</p>
<p>我使用以下格式： <em>major.minor.patch.build</em> ，前三部分使用SemVer ，最后一部分使用构建服务器的内部版本号（0
表示本地构建）。这将导致：</p>
<div class="code"><pre class="code literal-block">[assembly: AssemblyFileVersion("1.3.2.42")]
</pre></div>

<p>请注意，System.Version将这些部分命名为<code>major.minor.build.revision</code>！</p>
<p><strong>装配信息版</strong></p>
<p>程序集的产品版本。这是您在与客户交谈或在您的网站上展示时会使用的版本。这个版本可以是一个字符串，比如“ <em>1.0 Release Candidate</em> ”。</p>
<p>是<code>AssemblyInformationalVersion</code>可选的。如果未给出，则使用 AssemblyFileVersion。</p>
<p>我使用格式： <em>major.minor[.patch] [revision as string]</em> 。这将导致：</p>
<div class="code"><pre class="code literal-block">[assembly: AssemblyInformationalVersion("1.3 RC1")]
</pre></div>

<p><br></p>
<h3>更多建议</h3>
<p>.NET 中程序集的版本控制可能会令人困惑，因为目前至少有三种方法可以为您的程序集指定版本。</p>
<p>以下是三个主要的与版本相关的程序集属性：</p>
<div class="code"><pre class="code literal-block"><span class="c1">// Assembly mscorlib, Version 2.0.0.0</span>
<span class="p">[</span><span class="n">assembly</span><span class="p">:</span><span class="w"> </span><span class="n">AssemblyFileVersion</span><span class="p">(</span><span class="s">"2.0.50727.3521"</span><span class="p">)]</span>
<span class="p">[</span><span class="n">assembly</span><span class="p">:</span><span class="w"> </span><span class="n">AssemblyInformationalVersion</span><span class="p">(</span><span class="s">"2.0.50727.3521"</span><span class="p">)]</span>
<span class="p">[</span><span class="n">assembly</span><span class="p">:</span><span class="w"> </span><span class="n">AssemblyVersion</span><span class="p">(</span><span class="s">"2.0.0.0"</span><span class="p">)]</span>
</pre></div>

<p>按照惯例，版本的四个部分分别称为 <strong>Major Version</strong> 、 <strong>Minor Version</strong> 、 <strong>Build</strong> 和
<strong>Revision</strong> 。</p>
<h2>旨在唯一标识 <em>单个程序集</em><code>AssemblyFileVersion</code>的构建 __</h2>
<p>通常，您将手动设置 Major 和 Minor AssemblyFileVersion 以反映程序集的版本，然后在每次构建系统编译程序集时递增 Build
和/或 Revision。AssemblyFileVersion 应该允许您唯一标识程序集的构建，以便您可以将其用作调试任何问题的起点。</p>
<p>在我当前的项目中，我们让构建服务器将源代码控制存储库中的更改列表编号编码到 AssemblyFileVersion
的构建和修订部分。对于构建服务器生成的任何程序集，这允许我们直接从程序集映射到它的源代码（无需在源代码控制中使用标签或分支，或手动保留已发布版本的任何记录）。</p>
<p>此版本号存储在 Win32 版本资源中，可以在查看程序集的 Windows 资源管理器属性页时看到。</p>
<p><strong>CLR 既不关心也不检查 AssemblyFileVersion。</strong></p>
<h2>旨在<code>AssemblyInformationalVersion</code>代表您整个产品的版本</h2>
<p>AssemblyInformationalVersion
旨在允许对整个产品进行一致的版本控制，该产品可能包含许多独立版本控制的程序集，可能具有不同的版本控制策略，并且可能由不同的团队开发。</p>
<blockquote>
<p>“例如，产品的 2.0 版可能包含多个程序集；其中一个程序集被标记为 1.0 版，因为它是一个新程序集，未在同一产品的 1.0
版中提供。通常，您设置此版本号的主要部分和次要部分以表示您产品的公共版本。然后，每次打包一个完整的产品及其所有组件时，都会增加构建和修订部分。” —
Jeffrey Richter，[通过 C# 的 CLR（第二版）] p. 57</p>
</blockquote>
<p><strong>CLR 既不关心也不检查 AssemblyInformationalVersion。</strong></p>
<h2>这<code>AssemblyVersion</code>是 CLR 唯一关心的版本（但它关心整个<code>AssemblyVersion</code>）</h2>
<p>CLR 使用 AssemblyVersion 绑定到强命名的程序集。它存储在构建程序集的 AssemblyDef 清单元数据表中，以及引用它的任何程序集的
AssemblyRef 表中。</p>
<p>这非常重要，因为这意味着当您引用强命名程序集时，您将被紧密绑定到该程序集的特定 AssemblyVersion。整个 AssemblyVersion
必须完全匹配才能使绑定成功。例如，如果您在构建时引用强命名程序集的版本 1.0.0.0，但在运行时只有该程序集的版本 1.0.0.1
可用，绑定将失败！（然后您将不得不使用Assembly Binding Redirection来解决这个问题。）</p>
<h2>对整体是否<code>AssemblyVersion</code>必须匹配感到困惑。（是的，它确实。）</h2>
<p>关于整个 AssemblyVersion 是否必须完全匹配才能加载程序集，存在一些混淆。有些人错误地认为只有 AssemblyVersion 的 Major
和 Minor 部分必须匹配才能使绑定成功。这是一个明智的假设，但它最终是不正确的（从 .NET 3.5 开始），并且很容易为您的 CLR
版本验证这一点。只需执行此示例代码。</p>
<p>在我的机器上，第二次程序集加载失败，融合日志的最后两行非常清楚原因：</p>
<div class="code"><pre class="code literal-block"><span class="o">.</span><span class="n">NET</span><span class="w"> </span><span class="n">Framework</span><span class="w"> </span><span class="n">Version</span><span class="p">:</span><span class="w"> </span><span class="mf">2.0</span><span class="o">.</span><span class="mf">50727.3521</span>
<span class="o">---</span>
<span class="n">Attempting</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nb">load</span><span class="w"> </span><span class="n">assembly</span><span class="p">:</span><span class="w"> </span><span class="n">Rhino</span><span class="o">.</span><span class="n">Mocks</span><span class="p">,</span><span class="w"> </span><span class="n">Version</span><span class="o">=</span><span class="mf">3.5</span><span class="o">.</span><span class="mf">0.1337</span><span class="p">,</span><span class="w"> </span><span class="n">Culture</span><span class="o">=</span><span class="n">neutral</span><span class="p">,</span><span class="w"> </span><span class="n">PublicKeyToken</span><span class="o">=</span><span class="mi">0</span><span class="n">b3305902db7183f</span>
<span class="n">Successfully</span><span class="w"> </span><span class="n">loaded</span><span class="w"> </span><span class="n">assembly</span><span class="p">:</span><span class="w"> </span><span class="n">Rhino</span><span class="o">.</span><span class="n">Mocks</span><span class="p">,</span><span class="w"> </span><span class="n">Version</span><span class="o">=</span><span class="mf">3.5</span><span class="o">.</span><span class="mf">0.1337</span><span class="p">,</span><span class="w"> </span><span class="n">Culture</span><span class="o">=</span><span class="n">neutral</span><span class="p">,</span><span class="w"> </span><span class="n">PublicKeyToken</span><span class="o">=</span><span class="mi">0</span><span class="n">b3305902db7183f</span>
<span class="o">---</span>
<span class="n">Attempting</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nb">load</span><span class="w"> </span><span class="n">assembly</span><span class="p">:</span><span class="w"> </span><span class="n">Rhino</span><span class="o">.</span><span class="n">Mocks</span><span class="p">,</span><span class="w"> </span><span class="n">Version</span><span class="o">=</span><span class="mf">3.5</span><span class="o">.</span><span class="mf">0.1336</span><span class="p">,</span><span class="w"> </span><span class="n">Culture</span><span class="o">=</span><span class="n">neutral</span><span class="p">,</span><span class="w"> </span><span class="n">PublicKeyToken</span><span class="o">=</span><span class="mi">0</span><span class="n">b3305902db7183f</span>
<span class="n">Assembly</span><span class="w"> </span><span class="n">binding</span><span class="w"> </span><span class="k">for</span><span class="w">  </span><span class="n">failed</span><span class="p">:</span>
<span class="n">System</span><span class="o">.</span><span class="n">IO</span><span class="o">.</span><span class="n">FileLoadException</span><span class="p">:</span><span class="w"> </span><span class="n">Could</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nb">load</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">assembly</span><span class="w"> </span><span class="s1">'Rhino.Mocks, Version=3.5.0.1336, Culture=neutral, </span>
<span class="n">PublicKeyToken</span><span class="o">=</span><span class="mi">0</span><span class="n">b3305902db7183f</span><span class="s1">' or one of its dependencies. The located assembly'</span><span class="n">s</span><span class="w"> </span><span class="n">manifest</span><span class="w"> </span><span class="n">definition</span><span class="w"> </span>
<span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">assembly</span><span class="w"> </span><span class="n">reference</span><span class="o">.</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">HRESULT</span><span class="p">:</span><span class="w"> </span><span class="mh">0x80131040</span><span class="p">)</span>
<span class="n">File</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s1">'Rhino.Mocks, Version=3.5.0.1336, Culture=neutral, PublicKeyToken=0b3305902db7183f'</span>

<span class="o">===</span><span class="w"> </span><span class="n">Pre</span><span class="o">-</span><span class="n">bind</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="o">===</span>
<span class="n">LOG</span><span class="p">:</span><span class="w"> </span><span class="n">User</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Phoenix</span>\<span class="n">Dani</span>
<span class="n">LOG</span><span class="p">:</span><span class="w"> </span><span class="n">DisplayName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Rhino</span><span class="o">.</span><span class="n">Mocks</span><span class="p">,</span><span class="w"> </span><span class="n">Version</span><span class="o">=</span><span class="mf">3.5</span><span class="o">.</span><span class="mf">0.1336</span><span class="p">,</span><span class="w"> </span><span class="n">Culture</span><span class="o">=</span><span class="n">neutral</span><span class="p">,</span><span class="w"> </span><span class="n">PublicKeyToken</span><span class="o">=</span><span class="mi">0</span><span class="n">b3305902db7183f</span>
<span class="w"> </span><span class="p">(</span><span class="n">Fully</span><span class="o">-</span><span class="n">specified</span><span class="p">)</span>
<span class="n">LOG</span><span class="p">:</span><span class="w"> </span><span class="n">Appbase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="o">...</span><span class="p">]</span>
<span class="n">LOG</span><span class="p">:</span><span class="w"> </span><span class="n">Initial</span><span class="w"> </span><span class="n">PrivatePath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NULL</span>
<span class="n">Calling</span><span class="w"> </span><span class="n">assembly</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">AssemblyBinding</span><span class="p">,</span><span class="w"> </span><span class="n">Version</span><span class="o">=</span><span class="mf">1.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="n">Culture</span><span class="o">=</span><span class="n">neutral</span><span class="p">,</span><span class="w"> </span><span class="n">PublicKeyToken</span><span class="o">=</span><span class="nb nb-Type">null</span><span class="o">.</span>
<span class="o">===</span>
<span class="n">LOG</span><span class="p">:</span><span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="n">bind</span><span class="w"> </span><span class="n">starts</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="nb">load</span><span class="w"> </span><span class="n">context</span><span class="o">.</span>
<span class="n">LOG</span><span class="p">:</span><span class="w"> </span><span class="n">No</span><span class="w"> </span><span class="n">application</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">found</span><span class="o">.</span>
<span class="n">LOG</span><span class="p">:</span><span class="w"> </span><span class="n">Using</span><span class="w"> </span><span class="n">machine</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">C</span><span class="p">:</span>\<span class="n">Windows</span>\<span class="n">Microsoft</span><span class="o">.</span><span class="n">NET</span>\<span class="n">Framework64</span>\<span class="n">v2</span><span class="o">.</span><span class="mf">0.50727</span>\<span class="n">config</span>\<span class="n">machine</span><span class="o">.</span><span class="n">config</span><span class="o">.</span>
<span class="n">LOG</span><span class="p">:</span><span class="w"> </span><span class="n">Post</span><span class="o">-</span><span class="n">policy</span><span class="w"> </span><span class="n">reference</span><span class="p">:</span><span class="w"> </span><span class="n">Rhino</span><span class="o">.</span><span class="n">Mocks</span><span class="p">,</span><span class="w"> </span><span class="n">Version</span><span class="o">=</span><span class="mf">3.5</span><span class="o">.</span><span class="mf">0.1336</span><span class="p">,</span><span class="w"> </span><span class="n">Culture</span><span class="o">=</span><span class="n">neutral</span><span class="p">,</span><span class="w"> </span><span class="n">PublicKeyToken</span><span class="o">=</span><span class="mi">0</span><span class="n">b3305902db7183f</span>
<span class="n">LOG</span><span class="p">:</span><span class="w"> </span><span class="n">Attempting</span><span class="w"> </span><span class="n">download</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">URL</span><span class="w"> </span><span class="p">[</span><span class="o">...</span><span class="p">]</span><span class="o">.</span>
<span class="n">WRN</span><span class="p">:</span><span class="w"> </span><span class="n">Comparing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">assembly</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">resulted</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">mismatch</span><span class="p">:</span><span class="w"> </span><span class="n">Revision</span><span class="w"> </span><span class="n">Number</span>
<span class="n">ERR</span><span class="p">:</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">complete</span><span class="w"> </span><span class="n">setup</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">assembly</span><span class="w"> </span><span class="p">(</span><span class="n">hr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x80131040</span><span class="p">)</span><span class="o">.</span><span class="w"> </span><span class="n">Probing</span><span class="w"> </span><span class="n">terminated</span><span class="o">.</span>
</pre></div>

<p>我认为这种混淆的根源可能是因为微软最初打算通过仅匹配主要和次要版本部分来对完整的 AssemblyVersion 的这种严格匹配更宽松一些：</p>
<blockquote>
<p>“加载程序集时，CLR 将自动找到与所请求程序集的主要/次要版本相匹配的最新安装的服务版本。” — Jeffrey Richter，[通过 C# 的
CLR（第二版）] p. 56</p>
</blockquote>
<p>这是 1.0 CLR 的 Beta 1 中的行为，但是此功能在 1.0 版本之前已被删除，并且没有设法在 .NET 2.0 中重新出现：</p>
<blockquote>
<p>“注意：我刚刚描述了您应该如何看待版本号。不幸的是，CLR 不以这种方式处理版本号。[在 .NET 2.0 中]，CLR
将版本号视为不透明值，如果程序集依赖于另一个程序集的版本 1.2.3.4，则 CLR 仅尝试加载版本 1.2.3.4（除非绑定重定向到位） ). 但是，
<strong>Microsoft 计划在未来的版本中更改 CLR 的加载程序，以便它为给定的主要/次要版本的程序集加载最新的构建/修订版</strong>. 例如，在 CLR
的未来版本中，如果加载程序试图查找程序集的 1.2.3.4 版本，而 1.2.5.0 版本存在，则加载程序会自动选择最新的服务版本。这将是对 CLR
加载程序的一个非常受欢迎的更改——我等不及了。” — Jeffrey Richter，[通过 C# 的 CLR（第二版）] p. 164（强调我的）</p>
</blockquote>
<p>由于此更改仍未实施，我认为可以安全地假设微软已经放弃了此意图，现在更改可能为时已晚。我试图在网上搜索以了解这些计划发生了什么，但找不到任何答案。我仍然想弄个水落石出。</p>
<p>所以我给 Jeff Richter 发了邮件，直接问他——我想如果有人知道发生了什么，那就是他。</p>
<p>他在 12 小时内回复，至少是在周六早上，并澄清说 .NET 1.0 Beta 1
加载器确实实现了这种“自动前滚”机制，可以获取程序集的最新可用构建和修订版，但这种行为是在 .NET 1.0 发布之前恢复。后来打算复兴它，但在 CLR
2.0 发布之前没有实现。然后是 Silverlight，它为 CLR 团队提供了优先权，因此该功能被进一步延迟。与此同时，大多数在 CLR 1.0
Beta 1 时代出现的人已经离开了，因此尽管已经付出了所有艰苦的工作，但它不太可能出现。</p>
<p>目前的行为似乎将继续存在。</p>
<p>从我与 Jeff 的讨论中还值得注意的是，AssemblyFileVersion 只是在删除“自动前滚”机制之后添加的——因为在 1.0 Beta 1
之后，对 AssemblyVersion
的任何更改对您的客户来说都是一个重大更改，然后无处可安全地存储您的内部版本号。AssemblyFileVersion 是那个避风港，因为它永远不会被 CLR
自动检查。也许这样更清楚，有两个不同的版本号，具有不同的含义，而不是试图在 AssemblyVersion
的主要/次要（破坏）和构建/修订（非破坏）部分之间进行分离。</p>
<h2>底线：仔细考虑何时改变你的<code>AssemblyVersion</code>
</h2>
<p>The moral is that if you’re shipping assemblies that other developers are
going to be referencing, you need to be extremely careful about when you do
(and don’t) change the AssemblyVersion of those assemblies. Any changes to the
AssemblyVersion will mean that application developers will either have to re-
compile against the new version (to update those AssemblyRef entries) or use
assembly binding redirects to manually override the binding.</p>
<ul>
<li>
<strong>Do not</strong> change the AssemblyVersion for a servicing release which is intended to be backwards compatible.</li>
<li>
<strong>Do</strong> change the AssemblyVersion for a release that you know has breaking changes.</li>
</ul>
<p>Just take another look at the version attributes on mscorlib:</p>
<div class="code"><pre class="code literal-block"><span class="c1">// Assembly mscorlib, Version 2.0.0.0</span>
<span class="p">[</span><span class="n">assembly</span><span class="p">:</span><span class="w"> </span><span class="n">AssemblyFileVersion</span><span class="p">(</span><span class="s">"2.0.50727.3521"</span><span class="p">)]</span>
<span class="p">[</span><span class="n">assembly</span><span class="p">:</span><span class="w"> </span><span class="n">AssemblyInformationalVersion</span><span class="p">(</span><span class="s">"2.0.50727.3521"</span><span class="p">)]</span>
<span class="p">[</span><span class="n">assembly</span><span class="p">:</span><span class="w"> </span><span class="n">AssemblyVersion</span><span class="p">(</span><span class="s">"2.0.0.0"</span><span class="p">)]</span>
</pre></div>

<p>Note that it’s the AssemblyFileVersion that contains all the interesting
servicing information (it’s the Revision part of this version that tells you
what Service Pack you’re on), meanwhile the AssemblyVersion is fixed at a
boring old 2.0.0.0. Any change to the AssemblyVersion would force every .NET
application referencing mscorlib.dll to re-compile against the new version!</p>
<p><br><br><a href="posts/what-are-differences-between-assemblyversion-assemblyfileversion-and-assemblyinformationalversion/">查看原文</a></p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/ru-he-geng-gai-node-js-de-kong-zhi-tai-zi-ti-yan-se/" class="u-url">如何更改 node.js 的控制台字体颜色？</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/ru-he-geng-gai-node-js-de-kong-zhi-tai-zi-ti-yan-se/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T09:22:37+08:00" itemprop="datePublished" title="2023-02-17 09:22">2023-02-17 09:22</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>由于眼睛问题，我不得不将控制台背景颜色更改为白色，但字体是灰色的，这使得消息不可读。我该如何改变它？</p>
<p><br><br></p>
<h2>解答</h2>
<p>您可以在下面找到运行 node.js 应用程序时命令文本的颜色参考：</p>
<div class="code"><pre class="code literal-block">console.log('\x1b[36m%s\x1b[0m', 'I am cyan');  //cyan
console.log('\x1b[33m%s\x1b[0m', stringToMakeYellow);  //yellow
</pre></div>

<p>注意<code>%s</code>字符串（第二个参数）被注入的位置。<code>\x1b[0m</code>重置终端颜色，因此在此之后它不再是所选颜色。</p>
<p><strong>颜色参考</strong></p>
<div class="code"><pre class="code literal-block">Reset = "\x1b[0m"
Bright = "\x1b[1m"
Dim = "\x1b[2m"
Underscore = "\x1b[4m"
Blink = "\x1b[5m"
Reverse = "\x1b[7m"
Hidden = "\x1b[8m"

FgBlack = "\x1b[30m"
FgRed = "\x1b[31m"
FgGreen = "\x1b[32m"
FgYellow = "\x1b[33m"
FgBlue = "\x1b[34m"
FgMagenta = "\x1b[35m"
FgCyan = "\x1b[36m"
FgWhite = "\x1b[37m"
FgGray = "\x1b[90m"

BgBlack = "\x1b[40m"
BgRed = "\x1b[41m"
BgGreen = "\x1b[42m"
BgYellow = "\x1b[43m"
BgBlue = "\x1b[44m"
BgMagenta = "\x1b[45m"
BgCyan = "\x1b[46m"
BgWhite = "\x1b[47m"
BgGray = "\x1b[100m"
</pre></div>

<p>编辑：</p>
<p>例如，<code>\x1b[31m</code>是一个 <em>转义序列</em> ，它将被您的终端拦截并指示它切换为红色。其实就是
<strong>不可打印控制字符</strong><code>\x1b</code>的代码。仅处理颜色和样式的转义序列也称为 <strong>ANSI 转义代码</strong>
并且是标准化的，因此它们（应该）可以在任何平台上工作。 <strong><em>*<code>escape</code> </em></strong>*</p>
<p>维基百科很好地比较了不同终端如何显示颜色https://en.wikipedia.org/wiki/ANSI_escape_code#Colors</p>
<p><br></p>
<h3>更多建议</h3>
<p>有多个包可用于在 Node.js 中格式化控制台文本。最受欢迎的是：</p>
<ul>
<li>
<p><strong><code>chalk</code></strong> —<img alt="GitHub 仓库 stars" src="https://img.shields.io/github/stars/chalk/chalk?style=social"></p>
</li>
<li>
<p><strong><code>cli-color</code></strong> —<img alt="GitHub 仓库 stars" src="https://img.shields.io/github/stars/medikoo/cli-color?style=social"></p>
</li>
<li>
<p><strong><del><code>colors</code></del></strong> — <img alt="GitHub 仓库 stars" src="https://img.shields.io/github/stars/Marak/colors.js?style=social">&gt; <strong>编辑</strong> ：<code>colors</code>不再推荐，因为它有 <strong>拒绝服务 <em>漏洞</em></strong> ，请参阅：https ://snyk.io/blog/open-source-npm-packages-colors-faker/了解详情</p>
</li>
</ul>
<h2>用法：</h2>
<p><strong>粉笔：</strong></p>
<div class="code"><pre class="code literal-block"><span class="k">const</span><span class="w"> </span><span class="n">chalk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">require</span><span class="p">(</span><span class="s1">'chalk'</span><span class="p">);</span>
<span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">chalk</span><span class="o">.</span><span class="n">red</span><span class="p">(</span><span class="s1">'Text in red'</span><span class="p">));</span>
</pre></div>

<hr>
<p><strong>CLI-颜色：</strong></p>
<div class="code"><pre class="code literal-block"><span class="k">const</span><span class="w"> </span><span class="n">clc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">require</span><span class="p">(</span><span class="s1">'cli-color'</span><span class="p">);</span>
<span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">clc</span><span class="o">.</span><span class="n">red</span><span class="p">(</span><span class="s1">'Text in red'</span><span class="p">));</span>
</pre></div>

<hr>
<p><br><br><a href="posts/how-to-change-node-js-s-console-font-color/">查看原文</a></p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-533.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-531.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
