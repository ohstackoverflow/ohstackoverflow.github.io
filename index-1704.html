<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 1704) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-1704.html">
<link rel="prev" href="index-1705.html" type="text/html">
<link rel="next" href="index-1703.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/removing-data-from-elasticsearch/" class="u-url">Removing Data From ElasticSearch</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/removing-data-from-elasticsearch/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T07:23:06+08:00" itemprop="datePublished" title="2023-03-03 07:23">2023-03-03 07:23</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I want to remove data from ElasticSearch. I have deleted my indexes. However,
that doesn't seem to actually remove the data itself. The other stuff I've
seen points to the Delete by Query feature. However, I'm not even sure what to
query on. I know my indexes. Essentially, I'd like to figure out how to do a</p>
<div class="code"><pre class="code literal-block"><span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="o">[</span><span class="n">Index</span><span class="o">]</span>
</pre></div>

<p>From PostMan in Chrome. However, I'm not having any luck. It seems like no
matter what I do, the data hangs around. Thus far, I've successfully deleted
the indexes by using the DELETE HTTP Verb in PostMan and using a url like:</p>
<div class="code"><pre class="code literal-block"><span class="w">   </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="nl">localhost</span><span class="p">:</span><span class="mi">9200</span><span class="o">/[</span><span class="n">indexName</span><span class="o">]</span>
</pre></div>

<p>However, that doesn't seem to actually remove the data (aka docs) themselves.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>You can delete using <code>cURL</code> or visually using one of the many tools that open
source enthusiasts have created for Elasticsearch.</p>
<p><strong>Using cURL</strong></p>
<div class="code"><pre class="code literal-block">curl -XDELETE localhost:9200/index/type/documentID
</pre></div>

<p>e.g.</p>
<div class="code"><pre class="code literal-block">curl -XDELETE localhost:9200/shop/product/1
</pre></div>

<p>You will then receive a reply as to whether this was successful or not. You
can delete an entire index or types with an index also, you can delete a type
by leaving out the document ID like so -</p>
<div class="code"><pre class="code literal-block">curl -XDELETE localhost:9200/shop/product
</pre></div>

<p>If you wish to delete an index -</p>
<div class="code"><pre class="code literal-block">curl -XDELETE localhost:9200/shop
</pre></div>

<p>If you wish to delete more than one index that follows a certain naming
convention (note the <code>*</code>, a wildcard), -</p>
<div class="code"><pre class="code literal-block">curl -XDELETE localhost:9200/.mar*
</pre></div>

<p><strong>Visually</strong></p>
<p>There are various tools as mentioned above, I wont list them here but I will
link you to one which enables you to get started straight away, located here.
This tool is called KOPF, to connect to your host please click on the logo on
top left hand corner and enter the URL of your cluster.</p>
<p>Once connected you will be able to administer your entire cluster, delete,
optimise and tune your cluster.</p>
<p><br></p>
<h3>Suggest</h3>
<p>You can delete using <code>cURL</code> or visually using one of the many tools that open
source enthusiasts have created for Elasticsearch.</p>
<p><strong>Using cURL</strong></p>
<div class="code"><pre class="code literal-block">curl -XDELETE localhost:9200/index/type/documentID
</pre></div>

<p>e.g.</p>
<div class="code"><pre class="code literal-block">curl -XDELETE localhost:9200/shop/product/1
</pre></div>

<p>You will then receive a reply as to whether this was successful or not. You
can delete an entire index or types with an index also, you can delete a type
by leaving out the document ID like so -</p>
<div class="code"><pre class="code literal-block">curl -XDELETE localhost:9200/shop/product
</pre></div>

<p>If you wish to delete an index -</p>
<div class="code"><pre class="code literal-block">curl -XDELETE localhost:9200/shop
</pre></div>

<p>If you wish to delete more than one index that follows a certain naming
convention (note the <code>*</code>, a wildcard), -</p>
<div class="code"><pre class="code literal-block">curl -XDELETE localhost:9200/.mar*
</pre></div>

<p><strong>Visually</strong></p>
<p>There are various tools as mentioned above, I wont list them here but I will
link you to one which enables you to get started straight away, located here.
This tool is called KOPF, to connect to your host please click on the logo on
top left hand corner and enter the URL of your cluster.</p>
<p>Once connected you will be able to administer your entire cluster, delete,
optimise and tune your cluster.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/filter-object-properties-by-key-in-es6/" class="u-url">Filter object properties by key in ES6</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/filter-object-properties-by-key-in-es6/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T07:22:38+08:00" itemprop="datePublished" title="2023-03-03 07:22">2023-03-03 07:22</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Let's say I have an object:</p>
<div class="code"><pre class="code literal-block">{
  item1: { key: 'sdfd', value:'sdfd' },
  item2: { key: 'sdfd', value:'sdfd' },
  item3: { key: 'sdfd', value:'sdfd' }
}
</pre></div>

<p>I want to create another object by filtering the object above so I have
something like.</p>
<div class="code"><pre class="code literal-block"> {
    item1: { key: 'sdfd', value:'sdfd' },
    item3: { key: 'sdfd', value:'sdfd' }
 }
</pre></div>

<p>I am looking for a clean way to accomplish this using Es6, so spread operators
are available to me.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>If you have a list of allowed values, you can easily retain them in an object
using:</p>
<div class="code"><pre class="code literal-block"><span class="n">const</span><span class="w"> </span><span class="n">raw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{</span>
<span class="w">  </span><span class="nl">item1</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="k">key</span><span class="err">:</span><span class="w"> </span><span class="s1">'sdfd'</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="err">:</span><span class="s1">'sdfd'</span><span class="w"> </span><span class="err">}</span><span class="p">,</span>
<span class="w">  </span><span class="nl">item2</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="k">key</span><span class="err">:</span><span class="w"> </span><span class="s1">'sdfd'</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="err">:</span><span class="s1">'sdfd'</span><span class="w"> </span><span class="err">}</span><span class="p">,</span>
<span class="w">  </span><span class="nl">item3</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="k">key</span><span class="err">:</span><span class="w"> </span><span class="s1">'sdfd'</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="err">:</span><span class="s1">'sdfd'</span><span class="w"> </span><span class="err">}</span>
<span class="err">}</span><span class="p">;</span>

<span class="n">const</span><span class="w"> </span><span class="n">allowed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">'item1', 'item3'</span><span class="o">]</span><span class="p">;</span>

<span class="n">const</span><span class="w"> </span><span class="n">filtered</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">Object</span><span class="p">.</span><span class="n">keys</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>
<span class="w">  </span><span class="p">.</span><span class="k">filter</span><span class="p">(</span><span class="k">key</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">allowed</span><span class="p">.</span><span class="n">includes</span><span class="p">(</span><span class="k">key</span><span class="p">))</span>
<span class="w">  </span><span class="p">.</span><span class="n">reduce</span><span class="p">((</span><span class="n">obj</span><span class="p">,</span><span class="w"> </span><span class="k">key</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="n">obj</span><span class="o">[</span><span class="n">key</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">raw</span><span class="o">[</span><span class="n">key</span><span class="o">]</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">obj</span><span class="p">;</span>
<span class="w">  </span><span class="err">}</span><span class="p">,</span><span class="w"> </span><span class="err">{}</span><span class="p">);</span>

<span class="n">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="n">filtered</span><span class="p">);</span>
</pre></div>

<p>This uses:</p>
<ol>
<li>
<code>Object.keys</code> to list all properties in <code>raw</code> (the original data), then</li>
<li>
<code>Array.prototype.filter</code> to select keys that are present in the allowed list, using <ol>
<li>
<code>Array.prototype.includes</code> to make sure they are present</li>
</ol>
</li>
<li>
<code>Array.prototype.reduce</code> to build a new object with only the allowed properties.</li>
</ol>
<p>This will make a shallow copy with the allowed properties (but won't copy the
properties themselves).</p>
<p>You can also use the object spread operator to create a series of objects
without mutating them (thanks to rjerue for mentioning this):</p>
<div class="code"><pre class="code literal-block"><span class="n">const</span><span class="w"> </span><span class="n">raw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{</span>
<span class="w">  </span><span class="nl">item1</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="k">key</span><span class="err">:</span><span class="w"> </span><span class="s1">'sdfd'</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="err">:</span><span class="s1">'sdfd'</span><span class="w"> </span><span class="err">}</span><span class="p">,</span>
<span class="w">  </span><span class="nl">item2</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="k">key</span><span class="err">:</span><span class="w"> </span><span class="s1">'sdfd'</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="err">:</span><span class="s1">'sdfd'</span><span class="w"> </span><span class="err">}</span><span class="p">,</span>
<span class="w">  </span><span class="nl">item3</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="k">key</span><span class="err">:</span><span class="w"> </span><span class="s1">'sdfd'</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="err">:</span><span class="s1">'sdfd'</span><span class="w"> </span><span class="err">}</span>
<span class="err">}</span><span class="p">;</span>

<span class="n">const</span><span class="w"> </span><span class="n">allowed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">'item1', 'item3'</span><span class="o">]</span><span class="p">;</span>

<span class="n">const</span><span class="w"> </span><span class="n">filtered</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">Object</span><span class="p">.</span><span class="n">keys</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>
<span class="w">  </span><span class="p">.</span><span class="k">filter</span><span class="p">(</span><span class="k">key</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">allowed</span><span class="p">.</span><span class="n">includes</span><span class="p">(</span><span class="k">key</span><span class="p">))</span>
<span class="w">  </span><span class="p">.</span><span class="n">reduce</span><span class="p">((</span><span class="n">obj</span><span class="p">,</span><span class="w"> </span><span class="k">key</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="err">{</span>
<span class="w">      </span><span class="p">...</span><span class="n">obj</span><span class="p">,</span>
<span class="w">      </span><span class="o">[</span><span class="n">key</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="n">raw</span><span class="o">[</span><span class="n">key</span><span class="o">]</span>
<span class="w">    </span><span class="err">}</span><span class="p">;</span>
<span class="w">  </span><span class="err">}</span><span class="p">,</span><span class="w"> </span><span class="err">{}</span><span class="p">);</span>

<span class="n">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="n">filtered</span><span class="p">);</span>
</pre></div>

<p>For purposes of trivia, if you wanted to remove the unwanted fields from the
original data (which I <strong>would not</strong> recommend doing, since it involves some
ugly mutations), you could invert the <code>includes</code> check like so:</p>
<div class="code"><pre class="code literal-block"><span class="n">const</span><span class="w"> </span><span class="n">raw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{</span>
<span class="w">  </span><span class="nl">item1</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="k">key</span><span class="err">:</span><span class="w"> </span><span class="s1">'sdfd'</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="err">:</span><span class="s1">'sdfd'</span><span class="w"> </span><span class="err">}</span><span class="p">,</span>
<span class="w">  </span><span class="nl">item2</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="k">key</span><span class="err">:</span><span class="w"> </span><span class="s1">'sdfd'</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="err">:</span><span class="s1">'sdfd'</span><span class="w"> </span><span class="err">}</span><span class="p">,</span>
<span class="w">  </span><span class="nl">item3</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="k">key</span><span class="err">:</span><span class="w"> </span><span class="s1">'sdfd'</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="err">:</span><span class="s1">'sdfd'</span><span class="w"> </span><span class="err">}</span>
<span class="err">}</span><span class="p">;</span>

<span class="n">const</span><span class="w"> </span><span class="n">allowed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">'item1', 'item3'</span><span class="o">]</span><span class="p">;</span>

<span class="k">Object</span><span class="p">.</span><span class="n">keys</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>
<span class="w">  </span><span class="p">.</span><span class="k">filter</span><span class="p">(</span><span class="k">key</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="err">!</span><span class="n">allowed</span><span class="p">.</span><span class="n">includes</span><span class="p">(</span><span class="k">key</span><span class="p">))</span>
<span class="w">  </span><span class="p">.</span><span class="n">forEach</span><span class="p">(</span><span class="k">key</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">delete</span><span class="w"> </span><span class="n">raw</span><span class="o">[</span><span class="n">key</span><span class="o">]</span><span class="p">);</span>

<span class="n">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="n">raw</span><span class="p">);</span>
</pre></div>

<p>I'm including this example to show a mutation-based solution, but I don't
suggest using it.</p>
<p><br></p>
<h3>Suggest</h3>
<p>If you are OK with using ES6 syntax, I find that the cleanest way to do this,
as noted here and here is:</p>
<div class="code"><pre class="code literal-block"><span class="k">const</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">item1</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">key</span><span class="p">:</span><span class="w"> </span><span class="s1">'sdfd'</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">:</span><span class="s1">'sdfd'</span><span class="w"> </span><span class="p">},</span>
<span class="w">  </span><span class="n">item2</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">key</span><span class="p">:</span><span class="w"> </span><span class="s1">'sdfd'</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">:</span><span class="s1">'sdfd'</span><span class="w"> </span><span class="p">},</span>
<span class="w">  </span><span class="n">item3</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">key</span><span class="p">:</span><span class="w"> </span><span class="s1">'sdfd'</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">:</span><span class="s1">'sdfd'</span><span class="w"> </span><span class="p">}</span>
<span class="p">};</span>

<span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">item2</span><span class="p">,</span><span class="w"> </span><span class="o">...</span><span class="n">newData</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">;</span>
</pre></div>

<p>Now, <code>newData</code> contains:</p>
<div class="code"><pre class="code literal-block"><span class="p">{</span>
<span class="w">  </span><span class="n">item1</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="n">key</span><span class="o">:</span><span class="w"> </span><span class="s1">'sdfd'</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="o">:</span><span class="s1">'sdfd'</span><span class="w"> </span><span class="p">}</span><span class="o">,</span>
<span class="w">  </span><span class="nt">item3</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">key</span><span class="p">:</span><span class="w"> </span><span class="s1">'sdfd'</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="o">:</span><span class="s1">'sdfd'</span><span class="w"> </span><span class="p">}</span>
<span class="err">}</span><span class="o">;</span>
</pre></div>

<p>Or, if you have the key stored as a string:</p>
<div class="code"><pre class="code literal-block"><span class="n">const</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'item2'</span><span class="p">;</span>
<span class="n">const</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="o">[</span><span class="n">key</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="n">newData</span><span class="w"> </span><span class="err">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">data</span><span class="p">;</span>
</pre></div>

<p>In the latter case, <code>[key]</code> is converted to <code>item2</code> but since you are using a
<code>const</code> assignment, you need to specify a name for the assignment. <code>_</code>
represents a throw away value.</p>
<p>More generally:</p>
<div class="code"><pre class="code literal-block"><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">item2</span><span class="p">,</span><span class="w"> </span><span class="o">...</span><span class="n">newData</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">Assign</span><span class="w"> </span><span class="n">item2</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">item2</span>
<span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">item2</span><span class="p">:</span><span class="w"> </span><span class="n">someVarName</span><span class="p">,</span><span class="w"> </span><span class="o">...</span><span class="n">newData</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">Assign</span><span class="w"> </span><span class="n">item2</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">someVarName</span>
<span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">item2</span><span class="p">:</span><span class="w"> </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="o">...</span><span class="n">newData</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">Assign</span><span class="w"> </span><span class="n">item2</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">_</span>
<span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">[</span><span class="s1">'item2'</span><span class="p">]:</span><span class="w"> </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="o">...</span><span class="n">newData</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">Convert</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">first</span><span class="p">,</span><span class="w"> </span><span class="o">...</span>
</pre></div>

<p>Not only does this reduce your operation to a one-liner but it also doesn't
require you to know what the other keys are (those that you want to preserve).</p>
<p>A simple utility function would look like this:</p>
<div class="code"><pre class="code literal-block"><span class="k">function</span><span class="w"> </span><span class="n">removePropFromObject</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="w"> </span><span class="n">prop</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">  </span><span class="n">const</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="o">[</span><span class="n">prop</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="n">rest</span><span class="w"> </span><span class="err">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obj</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="p">...</span><span class="n">rest</span><span class="w"> </span><span class="err">}</span>
<span class="err">}</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/is-embedding-background-image-data-into-css-as-base64-good-or-bad-practice/" class="u-url">Is embedding background image data into CSS as Base64 good or bad practice?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/is-embedding-background-image-data-into-css-as-base64-good-or-bad-practice/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T07:22:06+08:00" itemprop="datePublished" title="2023-03-03 07:22">2023-03-03 07:22</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I was looking at the source of a greasemonkey userscript and noticed the
following in their css:</p>
<div class="code"><pre class="code literal-block"><span class="na">.even</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="no">background</span><span class="p">:</span><span class="w"> </span><span class="c1">#fff url(data:image/gif;base64,R0lGODlhBgASALMAAOfn5+rq6uvr6+zs7O7u7vHx8fPz8/b29vj4+P39/f///wAAAAAAAAAAAAAAAAAAACwAAAAABgASAAAIMAAVCBxIsKDBgwgTDkzAsKGAhxARSJx4oKJFAxgzFtjIkYDHjwNCigxAsiSAkygDAgA7) repeat-x bottom}</span>
</pre></div>

<p>I can appreciate that a greasemonkey script would want to bundle anything it
can within the source as opposed to host it on a server, that's obvious
enough. But since I had not seen this technique previously, I considered its
use and it seems appealing for a number of reasons:</p>
<ol>
<li>It will reduce the amount of HTTP requests on page load, thus enhancing performance</li>
<li>If no CDN, then it will reduce the amount of traffic generated through cookies being sent alongside of images</li>
<li>CSS files can be cached</li>
<li>CSS files can be GZIPPED </li>
</ol>
<p>Considering that IE6 (for instance) has problems with cache for background
images, this seems like it's not the worst idea...</p>
<p>So, is this a good or bad practice, why WOULDN'T you use it and what tools
would you use to base64 encode the images?</p>
<p><strong>update - results of testing</strong></p>
<ul>
<li>
<p>testing with image: http://fragged.org/dev/map-shot.jpg - <strong>133.6Kb</strong></p>
</li>
<li>
<p>test URL: http://fragged.org/dev/base64.html</p>
</li>
<li>
<p>dedicated CSS file: http://fragged.org/dev/base64.css - <strong>178.1Kb</strong></p>
</li>
<li>
<p>GZIP encoding server side </p>
</li>
<li>
<p>resulting size sent to client (YSLOW components test): <strong>59.3Kb</strong></p>
</li>
<li>
<p>Saving of data sent to client browser of: <strong>74.3Kb</strong></p>
</li>
</ul>
<p>Nice, but it will be slightly less useful for smaller images, I guess.</p>
<blockquote>
<p>UPDATE: Bryan McQuade, a software engineer at Google, working on PageSpeed,
expressed at ChromeDevSummit 2013 that data:uris in CSS is considered a
render-blocking anti-pattern for delivering critical/minimal CSS during his
talk <code>#perfmatters: Instant mobile web apps</code>. See
http://developer.chrome.com/devsummit/sessions and keep that in mind -
actual slide</p>
</blockquote>
<p><br><br></p>
<h2>Answer</h2>
<p>It's not a good idea when you want your images and style information to be
cached separately. Also if you encode a large image or a significant number of
images in to your css file it will take the browser longer to download the
file leaving your site without any of the style information until the download
completes. For small images that you don't intend on changing often if ever it
is a fine solution.</p>
<p>as far as generating the base64 encoding:</p>
<ul>
<li>http://b64.io/</li>
<li>http://www.motobit.com/util/base64-decoder-encoder.asp (upload)</li>
<li>http://www.greywyvern.com/code/php/binary2base64 (from link with little tutorials underneath)</li>
</ul>
<p><br></p>
<h3>Suggest</h3>
<p><strong><em>This answer is out of date and shouldn't be used.</em></strong></p>
<p><em>1) Average latency is much faster on mobile in 2017.
https://opensignal.com/reports/2016/02/usa/state-of-the-mobile-network</em></p>
<p><em>2) HTTP2 multiplexes https://http2.github.io/faq/#why-is-http2-multiplexed</em></p>
<p>"Data URIs" should definitely be considered for mobile sites. HTTP access over
cellular networks comes with higher latency per request/response. So there are
some use cases where jamming your images as data into CSS or HTML templates
could be beneficial on mobile web apps. You should measure usage on a case-by-
case basis -- I'm not advocating that data URIs should be used everywhere in a
mobile web app.</p>
<p>Note that mobile browsers have limitations on total size of files that can be
cached. Limits for iOS 3.2 were pretty low (25K per file), but are getting
larger (100K) for newer versions of Mobile Safari. So be sure to keep an eye
on your total file size when including data URIs.</p>
<p>http://www.yuiblog.com/blog/2010/06/28/mobile-browser-cache-limits/</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-1705.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-1703.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
