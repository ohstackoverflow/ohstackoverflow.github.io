<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 2238) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-2238.html">
<link rel="prev" href="index-2239.html" type="text/html">
<link rel="next" href="index-2237.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/invalid-argument-supplied-for-foreach/" class="u-url">Invalid argument supplied for foreach()</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/invalid-argument-supplied-for-foreach/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T01:30:34+08:00" itemprop="datePublished" title="2023-03-04 01:30">2023-03-04 01:30</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>It often happens to me to handle data that can be either an array or a null
variable and to feed some <code>foreach</code> with these data.</p>
<div class="code"><pre class="code literal-block">$values = get_values();

foreach ($values as $value){
  ...
}
</pre></div>

<p>When you feed a foreach with data that are not an array, you get a warning:</p>
<blockquote>
<p>Warning: Invalid argument supplied for foreach() in [...]</p>
</blockquote>
<p>Assuming it's not possible to refactor the <code>get_values()</code> function to always
return an array (backward compatibility, not available source code, whatever
other reason), I'm wondering which is the cleanest and most efficient way to
avoid these warnings:</p>
<ul>
<li>Casting <code>$values</code> to array</li>
<li>Initializing <code>$values</code> to array</li>
<li>Wrapping the <code>foreach</code> with an <code>if</code>
</li>
<li>Other (please suggest)</li>
</ul>
<p><br><br></p>
<h2>Answer</h2>
<p>Personally I find this to be the most clean - not sure if it's the most
efficient, mind!</p>
<div class="code"><pre class="code literal-block"><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">is_array</span><span class="ss">(</span>$<span class="nv">values</span><span class="ss">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nv">is_object</span><span class="ss">(</span>$<span class="nv">values</span><span class="ss">))</span>
{
<span class="w">    </span><span class="nv">foreach</span><span class="w"> </span><span class="ss">(</span>$<span class="nv">values</span><span class="w"> </span><span class="nv">as</span><span class="w"> </span>$<span class="nv">value</span><span class="ss">)</span>
<span class="w">    </span>{
<span class="w">        </span>...
<span class="w">    </span>}
}
</pre></div>

<p>The reason for my preference is it doesn't allocate an empty array when you've
got nothing to begin with anyway.</p>
<p><br></p>
<h3>Suggest</h3>
<p>How about this one? lot cleaner and all in single line.</p>
<div class="code"><pre class="code literal-block">foreach ((array) $items as $item) {
 // ...
 }
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/list-of-all-index-index-columns-in-sql-server-db/" class="u-url">List of all index &amp; index columns in SQL Server DB</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/list-of-all-index-index-columns-in-sql-server-db/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T01:30:06+08:00" itemprop="datePublished" title="2023-03-04 01:30">2023-03-04 01:30</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>How do I get a list of all index &amp; index columns in SQL Server 2005+? The
closest I could get is:</p>
<div class="code"><pre class="code literal-block"><span class="n">select</span><span class="w"> </span><span class="n">s</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">sys</span><span class="o">.</span><span class="n">tables</span><span class="w"> </span><span class="n">t</span>
<span class="n">inner</span><span class="w"> </span><span class="n">join</span><span class="w"> </span><span class="n">sys</span><span class="o">.</span><span class="n">schemas</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">t</span><span class="o">.</span><span class="n">schema_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="o">.</span><span class="n">schema_id</span>
<span class="n">inner</span><span class="w"> </span><span class="n">join</span><span class="w"> </span><span class="n">sys</span><span class="o">.</span><span class="n">indexes</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">i</span><span class="o">.</span><span class="n">object_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="o">.</span><span class="n">object_id</span>
<span class="n">inner</span><span class="w"> </span><span class="n">join</span><span class="w"> </span><span class="n">sys</span><span class="o">.</span><span class="n">index_columns</span><span class="w"> </span><span class="n">ic</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">ic</span><span class="o">.</span><span class="n">object_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="o">.</span><span class="n">object_id</span>
<span class="n">inner</span><span class="w"> </span><span class="n">join</span><span class="w"> </span><span class="n">sys</span><span class="o">.</span><span class="n">columns</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">c</span><span class="o">.</span><span class="n">object_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="o">.</span><span class="n">object_id</span><span class="w"> </span><span class="ow">and</span>
<span class="w">        </span><span class="n">ic</span><span class="o">.</span><span class="n">column_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="o">.</span><span class="n">column_id</span>

<span class="n">where</span><span class="w"> </span><span class="n">i</span><span class="o">.</span><span class="n">index_id</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w">    </span>
<span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">i</span><span class="o">.</span><span class="n">type</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="n">clustered</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">nonclustered</span><span class="w"> </span><span class="n">only</span>
<span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">i</span><span class="o">.</span><span class="n">is_primary_key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="n">do</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">include</span><span class="w"> </span><span class="n">PK</span><span class="w"> </span><span class="n">indexes</span>
<span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">i</span><span class="o">.</span><span class="n">is_unique_constraint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="n">do</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">include</span><span class="w"> </span><span class="n">UQ</span>
<span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">i</span><span class="o">.</span><span class="n">is_disabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">i</span><span class="o">.</span><span class="n">is_hypothetical</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">ic</span><span class="o">.</span><span class="n">key_ordinal</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span>

<span class="n">order</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">ic</span><span class="o">.</span><span class="n">key_ordinal</span>
</pre></div>

<p>Which is not exactly what I want.<br>
What I want is, to list all user-defined indexes, ( <em>which means no indexes
which support unique constraints &amp; primary keys</em>) with all columns (ordered by
how do they appear in index definition) plus as much metadata as possible.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>There are two "sys" catalog views you can consult: <code>sys.indexes</code> and
<code>sys.index_columns</code>.</p>
<p>Those will give you just about any info you could possibly want about indices
and their columns.</p>
<p>EDIT: This query's getting pretty close to what you're looking for:</p>
<div class="code"><pre class="code literal-block"><span class="n">SELECT</span><span class="w"> </span>
<span class="w">     </span><span class="n">TableName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
<span class="w">     </span><span class="n">IndexName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ind</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
<span class="w">     </span><span class="n">IndexId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ind</span><span class="o">.</span><span class="n">index_id</span><span class="p">,</span>
<span class="w">     </span><span class="n">ColumnId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ic</span><span class="o">.</span><span class="n">index_column_id</span><span class="p">,</span>
<span class="w">     </span><span class="n">ColumnName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
<span class="w">     </span><span class="n">ind</span><span class="o">.*</span><span class="p">,</span>
<span class="w">     </span><span class="n">ic</span><span class="o">.*</span><span class="p">,</span>
<span class="w">     </span><span class="n">col</span><span class="o">.*</span><span class="w"> </span>
<span class="n">FROM</span><span class="w"> </span>
<span class="w">     </span><span class="n">sys</span><span class="o">.</span><span class="n">indexes</span><span class="w"> </span><span class="n">ind</span><span class="w"> </span>
<span class="n">INNER</span><span class="w"> </span><span class="n">JOIN</span><span class="w"> </span>
<span class="w">     </span><span class="n">sys</span><span class="o">.</span><span class="n">index_columns</span><span class="w"> </span><span class="n">ic</span><span class="w"> </span><span class="n">ON</span><span class="w">  </span><span class="n">ind</span><span class="o">.</span><span class="n">object_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ic</span><span class="o">.</span><span class="n">object_id</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">ind</span><span class="o">.</span><span class="n">index_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ic</span><span class="o">.</span><span class="n">index_id</span><span class="w"> </span>
<span class="n">INNER</span><span class="w"> </span><span class="n">JOIN</span><span class="w"> </span>
<span class="w">     </span><span class="n">sys</span><span class="o">.</span><span class="n">columns</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="n">ON</span><span class="w"> </span><span class="n">ic</span><span class="o">.</span><span class="n">object_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col</span><span class="o">.</span><span class="n">object_id</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">ic</span><span class="o">.</span><span class="n">column_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col</span><span class="o">.</span><span class="n">column_id</span><span class="w"> </span>
<span class="n">INNER</span><span class="w"> </span><span class="n">JOIN</span><span class="w"> </span>
<span class="w">     </span><span class="n">sys</span><span class="o">.</span><span class="n">tables</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="n">ON</span><span class="w"> </span><span class="n">ind</span><span class="o">.</span><span class="n">object_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="o">.</span><span class="n">object_id</span><span class="w"> </span>
<span class="n">WHERE</span><span class="w"> </span>
<span class="w">     </span><span class="n">ind</span><span class="o">.</span><span class="n">is_primary_key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span>
<span class="w">     </span><span class="n">AND</span><span class="w"> </span><span class="n">ind</span><span class="o">.</span><span class="n">is_unique</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span>
<span class="w">     </span><span class="n">AND</span><span class="w"> </span><span class="n">ind</span><span class="o">.</span><span class="n">is_unique_constraint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span>
<span class="w">     </span><span class="n">AND</span><span class="w"> </span><span class="n">t</span><span class="o">.</span><span class="n">is_ms_shipped</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span>
<span class="n">ORDER</span><span class="w"> </span><span class="n">BY</span><span class="w"> </span>
<span class="w">     </span><span class="n">t</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">ind</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">ind</span><span class="o">.</span><span class="n">index_id</span><span class="p">,</span><span class="w"> </span><span class="n">ic</span><span class="o">.</span><span class="n">is_included_column</span><span class="p">,</span><span class="w"> </span><span class="n">ic</span><span class="o">.</span><span class="n">key_ordinal</span><span class="p">;</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>You can use the <code>sp_helpindex</code> to view all the indexes of one table.</p>
<div class="code"><pre class="code literal-block"><span class="n">EXEC</span><span class="w"> </span><span class="n">sys</span><span class="o">.</span><span class="n">sp_helpindex</span><span class="w"> </span><span class="err">@</span><span class="n">objname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="s1">'User'</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="mi">77</span><span class="p">)</span>
</pre></div>

<p>And for all the indexes, you can traverse <code>sys.objects</code> to get all the indexes
for each table.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/php-date-format-when-inserting-into-datetime-in-mysql/" class="u-url">PHP date() format when inserting into datetime in MySQL</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/php-date-format-when-inserting-into-datetime-in-mysql/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T01:29:39+08:00" itemprop="datePublished" title="2023-03-04 01:29">2023-03-04 01:29</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>What is the correct format to pass to the <code>date()</code> function in PHP if I want
to insert the result into a MySQL <code>datetime</code> type column?</p>
<p>I've been trying <code>date('Y-M-D G:i:s')</code> but that just inserts "0000-00-00
00:00:00" everytime.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>The problem is that you're using <code>'M'</code> and <code>'D'</code>, which are a textual
representations, MySQL is expecting a numeric representation of the format
<code>2010-02-06 19:30:13</code></p>
<p>Try: <code>date('Y-m-d H:i:s')</code> which uses the numeric equivalents.</p>
<p>edit: switched <code>G</code> to <code>H</code>, though it may not have impact, you probably want to
use 24-hour format with leading 0s.</p>
<p><br></p>
<h3>Suggest</h3>
<p>From the comments of php's <code>date()</code> manual page:</p>
<div class="code"><pre class="code literal-block"><span class="cp">&lt;?php</span> <span class="nv">$mysqltime</span> <span class="o">=</span> <span class="nb">date</span> <span class="p">(</span><span class="s1">'Y-m-d H:i:s'</span><span class="p">,</span> <span class="nv">$phptime</span><span class="p">);</span> <span class="cp">?&gt;</span>
</pre></div>

<p>You had the 'Y' correct - that's a full year, but 'M' is a three character
month, while 'm' is a two digit month. Same issue with 'D' instead of 'd'. 'G'
is a 1 or 2 digit hour, where 'H' always has a leading 0 when needed.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-2239.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-2237.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
