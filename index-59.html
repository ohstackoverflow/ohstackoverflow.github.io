<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 59) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-59.html">
<link rel="prev" href="index-60.html" type="text/html">
<link rel="next" href="index-58.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-do-i-clone-a-list-so-that-it-doesn-t-change-unexpectedly-after-assignment/" class="u-url">How do I clone a list so that it doesn't change unexpectedly after assignment?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-do-i-clone-a-list-so-that-it-doesn-t-change-unexpectedly-after-assignment/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-16T19:56:39+08:00" itemprop="datePublished" title="2023-02-16 19:56">2023-02-16 19:56</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>While using <code>new_list = my_list</code>, any modifications to <code>new_list</code> changes
<code>my_list</code> every time. Why is this, and how can I clone or copy the list to
prevent it?</p>
<p><br><br></p>
<h2>Answer</h2>
<p><code>new_list = my_list</code> doesn't actually create a second list. The assignment
just copies the reference to the list, not the actual list, so both <code>new_list</code>
and <code>my_list</code> refer to the same list after the assignment.</p>
<p>To actually copy the list, you have several options:</p>
<ul>
<li>
<p>You can use the builtin <code>list.copy()</code> method (available since Python 3.3):</p>
<div class="code"><pre class="code literal-block">new_list = old_list.copy()
</pre></div>

</li>
<li>
<p>You can slice it:</p>
<div class="code"><pre class="code literal-block">new_list = old_list[:]
</pre></div>

</li>
</ul>
<p>Alex Martelli's opinion (at least back in 2007) about this is, that <em>it is a
weird syntax and it does not make sense to use it ever</em>. ;) (In his opinion,
the next one is more readable).</p>
<ul>
<li>
<p>You can use the built in <code>list()</code> constructor:</p>
<div class="code"><pre class="code literal-block">new_list = list(old_list)
</pre></div>

</li>
<li>
<p>You can use generic <code>copy.copy()</code>:</p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="nn">copy</span>
</pre></div>

<p>new_list = copy.copy(old_list)</p>
</li>
</ul>
<p>This is a little slower than <code>list()</code> because it has to find out the datatype
of <code>old_list</code> first.</p>
<ul>
<li>If you need to copy the elements of the list as well, use generic <code>copy.deepcopy()</code>:<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="nn">copy</span>
</pre></div>

<p>new_list = copy.deepcopy(old_list)</p>
</li>
</ul>
<p>Obviously the slowest and most memory-needing method, but sometimes
unavoidable. This operates recursively; it will handle any number of levels of
nested lists (or other containers).</p>
<p><strong>Example:</strong></p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="nn">copy</span>

<span class="k">class</span> <span class="nc">Foo</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">val</span> <span class="o">=</span> <span class="n">val</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">'Foo(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">val</span><span class="si">!r}</span><span class="s1">)'</span>

<span class="n">foo</span> <span class="o">=</span> <span class="n">Foo</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'foo'</span><span class="p">,</span> <span class="n">foo</span><span class="p">]</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">a</span><span class="p">[:]</span>
<span class="n">d</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

<span class="c1"># edit orignal list and instance </span>
<span class="n">a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">'baz'</span><span class="p">)</span>
<span class="n">foo</span><span class="o">.</span><span class="n">val</span> <span class="o">=</span> <span class="mi">5</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'original: </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="se">\n</span><span class="s1">list.copy(): </span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="se">\n</span><span class="s1">slice: </span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="se">\n</span><span class="s1">list(): </span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="se">\n</span><span class="s1">copy: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="se">\n</span><span class="s1">deepcopy: </span><span class="si">{</span><span class="n">f</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
</pre></div>

<p>Result:</p>
<div class="code"><pre class="code literal-block">original: ['foo', Foo(5), 'baz']
list.copy(): ['foo', Foo(5)]
slice: ['foo', Foo(5)]
list(): ['foo', Foo(5)]
copy: ['foo', Foo(5)]
deepcopy: ['foo', Foo(1)]
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>Felix already provided an excellent answer, but I thought I'd do a speed
comparison of the various methods:</p>
<ol>
<li>10.59 sec (105.9 µs/itn) - <code>copy.deepcopy(old_list)</code>
</li>
<li>10.16 sec (101.6 µs/itn) - pure Python <code>Copy()</code> method copying classes with deepcopy</li>
<li>1.488 sec (14.88 µs/itn) - pure Python <code>Copy()</code> method not copying classes (only dicts/lists/tuples)</li>
<li>0.325 sec (3.25 µs/itn) - <code>for item in old_list: new_list.append(item)</code>
</li>
<li>0.217 sec (2.17 µs/itn) - <code>[i for i in old_list]</code> (a list comprehension)</li>
<li>0.186 sec (1.86 µs/itn) - <code>copy.copy(old_list)</code>
</li>
<li>0.075 sec (0.75 µs/itn) - <code>list(old_list)</code>
</li>
<li>0.053 sec (0.53 µs/itn) - <code>new_list = []; new_list.extend(old_list)</code>
</li>
<li>0.039 sec (0.39 µs/itn) - <code>old_list[:]</code> (list slicing)</li>
</ol>
<p>So the fastest is list slicing. But be aware that <code>copy.copy()</code>, <code>list[:]</code> and
<code>list(list)</code>, unlike <code>copy.deepcopy()</code> and the python version don't copy any
lists, dictionaries and class instances in the list, so if the originals
change, they will change in the copied list too and vice versa.</p>
<p>(Here's the script if anyone's interested or wants to raise any issues:)</p>
<div class="code"><pre class="code literal-block"><span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>

<span class="k">class</span> <span class="nc">old_class</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">blah</span> <span class="o">=</span> <span class="s1">'blah'</span>

<span class="k">class</span> <span class="nc">new_class</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">blah</span> <span class="o">=</span> <span class="s1">'blah'</span>

<span class="n">dignore</span> <span class="o">=</span> <span class="p">{</span><span class="nb">str</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="n">unicode</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">int</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">):</span> <span class="kc">None</span><span class="p">}</span>

<span class="k">def</span> <span class="nf">Copy</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">use_deepcopy</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">t</span> <span class="ow">in</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">t</span> <span class="o">==</span> <span class="nb">tuple</span><span class="p">:</span>
            <span class="c1"># Convert to a list if a tuple to</span>
            <span class="c1"># allow assigning to when copying</span>
            <span class="n">is_tuple</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Otherwise just do a quick slice copy</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span><span class="p">[:]</span>
            <span class="n">is_tuple</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># Copy each item recursively</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="p">)):</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="n">x</span><span class="p">])</span> <span class="ow">in</span> <span class="n">dignore</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">obj</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">Copy</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">use_deepcopy</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">is_tuple</span><span class="p">:</span>
            <span class="c1"># Convert back into a tuple again</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">t</span> <span class="o">==</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="c1"># Use the fast shallow dict copy() method and copy any</span>
        <span class="c1"># values which aren't immutable (like lists, dicts etc)</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="ow">in</span> <span class="n">dignore</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">obj</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">Copy</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">use_deepcopy</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">dignore</span><span class="p">:</span>
        <span class="c1"># Numeric or string/unicode?</span>
        <span class="c1"># It's immutable, so ignore it!</span>
        <span class="k">pass</span>

    <span class="k">elif</span> <span class="n">use_deepcopy</span><span class="p">:</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">obj</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">copy</span>
    <span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>

    <span class="n">num_times</span> <span class="o">=</span> <span class="mi">100000</span>
    <span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s1">'blah'</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">543.4532</span><span class="p">,</span>
         <span class="p">[</span><span class="s1">'foo'</span><span class="p">],</span> <span class="p">(</span><span class="s1">'bar'</span><span class="p">,),</span> <span class="p">{</span><span class="s1">'blah'</span><span class="p">:</span> <span class="s1">'blah'</span><span class="p">},</span>
         <span class="n">old_class</span><span class="p">(),</span> <span class="n">new_class</span><span class="p">()]</span>

    <span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">num_times</span><span class="p">):</span>
        <span class="n">Copy</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
    <span class="nb">print</span> <span class="s1">'Custom Copy:'</span><span class="p">,</span> <span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t</span>

    <span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">num_times</span><span class="p">):</span>
        <span class="n">Copy</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">use_deepcopy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="nb">print</span> <span class="s1">'Custom Copy Only Copying Lists/Tuples/Dicts (no classes):'</span><span class="p">,</span> <span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t</span>

    <span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">num_times</span><span class="p">):</span>
        <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
    <span class="nb">print</span> <span class="s1">'copy.copy:'</span><span class="p">,</span> <span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t</span>

    <span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">num_times</span><span class="p">):</span>
        <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
    <span class="nb">print</span> <span class="s1">'copy.deepcopy:'</span><span class="p">,</span> <span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t</span>

    <span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">num_times</span><span class="p">):</span>
        <span class="n">L</span><span class="p">[:]</span>
    <span class="nb">print</span> <span class="s1">'list slicing [:]:'</span><span class="p">,</span> <span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t</span>

    <span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">num_times</span><span class="p">):</span>
        <span class="nb">list</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
    <span class="nb">print</span> <span class="s1">'list(L):'</span><span class="p">,</span> <span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t</span>

    <span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">num_times</span><span class="p">):</span>
        <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">L</span><span class="p">]</span>
    <span class="nb">print</span> <span class="s1">'list expression(L):'</span><span class="p">,</span> <span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t</span>

    <span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">num_times</span><span class="p">):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">a</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
    <span class="nb">print</span> <span class="s1">'list extend:'</span><span class="p">,</span> <span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t</span>

    <span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">num_times</span><span class="p">):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">L</span><span class="p">:</span>
            <span class="n">a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="nb">print</span> <span class="s1">'list append:'</span><span class="p">,</span> <span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t</span>

    <span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">num_times</span><span class="p">):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">a</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">L</span><span class="p">)</span>
    <span class="nb">print</span> <span class="s1">'generator expression extend:'</span><span class="p">,</span> <span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-iterate-over-a-dictionary/" class="u-url">How to iterate over a dictionary?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-iterate-over-a-dictionary/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-16T19:56:05+08:00" itemprop="datePublished" title="2023-02-16 19:56">2023-02-16 19:56</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I've seen a few different ways to iterate over a dictionary in C#. Is there a
standard way?</p>
<p><br><br></p>
<h2>Answer</h2>
<div class="code"><pre class="code literal-block"><span class="nv">foreach</span><span class="ss">(</span><span class="nv">KeyValuePair</span><span class="o">&lt;</span><span class="nv">string</span>,<span class="w"> </span><span class="nv">string</span><span class="o">&gt;</span><span class="w"> </span><span class="nv">entry</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">myDictionary</span><span class="ss">)</span>
{
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="nv">something</span><span class="w"> </span><span class="nv">with</span><span class="w"> </span><span class="nv">entry</span>.<span class="nv">Value</span><span class="w"> </span><span class="nv">or</span><span class="w"> </span><span class="nv">entry</span>.<span class="nv">Key</span>
}
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>If you are trying to use a generic Dictionary in C# like you would use an
associative array in another language:</p>
<div class="code"><pre class="code literal-block"><span class="n">foreach</span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">myDictionary</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">foo</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">Key</span><span class="p">);</span>
<span class="w">  </span><span class="n">bar</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">Value</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>

<p>Or, if you only need to iterate over the collection of keys, use</p>
<div class="code"><pre class="code literal-block"><span class="n">foreach</span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">myDictionary</span><span class="o">.</span><span class="n">Keys</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">foo</span><span class="p">(</span><span class="n">item</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>

<p>And lastly, if you're only interested in the values:</p>
<div class="code"><pre class="code literal-block"><span class="n">foreach</span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">myDictionary</span><span class="o">.</span><span class="n">Values</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">foo</span><span class="p">(</span><span class="n">item</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>

<p>(Take note that the <code>var</code> keyword is an optional C# 3.0 and above feature, you
could also use the exact type of your keys/values here)</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-do-i-pass-a-variable-by-reference/" class="u-url">How do I pass a variable by reference?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-do-i-pass-a-variable-by-reference/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-16T19:55:31+08:00" itemprop="datePublished" title="2023-02-16 19:55">2023-02-16 19:55</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Are parameters passed by reference or by value? How do I pass by reference so
that the code below outputs <code>'Changed'</code> instead of <code>'Original'</code>?</p>
<div class="code"><pre class="code literal-block"><span class="k">class</span><span class="w"> </span><span class="n">PassByReference</span><span class="p">:</span>
<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Original'</span>
<span class="w">        </span><span class="bp">self</span><span class="o">.</span><span class="n">change</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="p">)</span>
<span class="w">        </span><span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">change</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="k">var</span><span class="p">):</span>
<span class="w">        </span><span class="k">var</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Changed'</span>
</pre></div>

<hr>
<p>See also: Why can a function modify some arguments as perceived by the caller,
but not others?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Arguments are passed by assignment. The rationale behind this is twofold:</p>
<ol>
<li>the parameter passed in is actually a <em>reference</em> to an object (but the reference is passed by value)</li>
<li>some data types are mutable, but others aren't</li>
</ol>
<p>So:</p>
<ul>
<li>
<p>If you pass a <em>mutable</em> object into a method, the method gets a reference to that same object and you can mutate it to your heart's delight, but if you rebind the reference in the method, the outer scope will know nothing about it, and after you're done, the outer reference will still point at the original object. </p>
</li>
<li>
<p>If you pass an <em>immutable</em> object to a method, you still can't rebind the outer reference, and you can't even mutate the object.</p>
</li>
</ul>
<p>To make it even more clear, let's have some examples.</p>
<h3>List - a mutable type</h3>
<p><strong>Let's try to modify the list that was passed to a method:</strong></p>
<div class="code"><pre class="code literal-block">def try_to_change_list_contents(the_list):
    print('got', the_list)
    the_list.append('four')
    print('changed to', the_list)

outer_list = ['one', 'two', 'three']

print('before, outer_list =', outer_list)
try_to_change_list_contents(outer_list)
print('after, outer_list =', outer_list)
</pre></div>

<p>Output:</p>
<div class="code"><pre class="code literal-block">before, outer_list = ['one', 'two', 'three']
got ['one', 'two', 'three']
changed to ['one', 'two', 'three', 'four']
after, outer_list = ['one', 'two', 'three', 'four']
</pre></div>

<p>Since the parameter passed in is a reference to <code>outer_list</code>, not a copy of
it, we can use the mutating list methods to change it and have the changes
reflected in the outer scope.</p>
<p><strong>Now let's see what happens when we try to change the reference that was
passed in as a parameter:</strong></p>
<div class="code"><pre class="code literal-block">def try_to_change_list_reference(the_list):
    print('got', the_list)
    the_list = ['and', 'we', 'can', 'not', 'lie']
    print('set to', the_list)

outer_list = ['we', 'like', 'proper', 'English']

print('before, outer_list =', outer_list)
try_to_change_list_reference(outer_list)
print('after, outer_list =', outer_list)
</pre></div>

<p>Output:</p>
<div class="code"><pre class="code literal-block">before, outer_list = ['we', 'like', 'proper', 'English']
got ['we', 'like', 'proper', 'English']
set to ['and', 'we', 'can', 'not', 'lie']
after, outer_list = ['we', 'like', 'proper', 'English']
</pre></div>

<p>Since the <code>the_list</code> parameter was passed by value, assigning a new list to it
had no effect that the code outside the method could see. The <code>the_list</code> was a
copy of the <code>outer_list</code> reference, and we had <code>the_list</code> point to a new list,
but there was no way to change where <code>outer_list</code> pointed.</p>
<h3>String - an immutable type</h3>
<p><strong>It's immutable, so there's nothing we can do to change the contents of the
string</strong></p>
<p><strong>Now, let's try to change the reference</strong></p>
<div class="code"><pre class="code literal-block">def try_to_change_string_reference(the_string):
    print('got', the_string)
    the_string = 'In a kingdom by the sea'
    print('set to', the_string)

outer_string = 'It was many and many a year ago'

print('before, outer_string =', outer_string)
try_to_change_string_reference(outer_string)
print('after, outer_string =', outer_string)
</pre></div>

<p>Output:</p>
<div class="code"><pre class="code literal-block">before, outer_string = It was many and many a year ago
got It was many and many a year ago
set to In a kingdom by the sea
after, outer_string = It was many and many a year ago
</pre></div>

<p>Again, since the <code>the_string</code> parameter was passed by value, assigning a new
string to it had no effect that the code outside the method could see. The
<code>the_string</code> was a copy of the <code>outer_string</code> reference, and we had
<code>the_string</code> point to a new string, but there was no way to change where
<code>outer_string</code> pointed.</p>
<p>I hope this clears things up a little.</p>
<p><strong>EDIT:</strong> It's been noted that this doesn't answer the question that @David
originally asked, "Is there something I can do to pass the variable by actual
reference?". Let's work on that.</p>
<h3>How do we get around this?</h3>
<p>As @Andrea's answer shows, you could return the new value. This doesn't change
the way things are passed in, but does let you get the information you want
back out:</p>
<div class="code"><pre class="code literal-block"><span class="nv">def</span><span class="w"> </span><span class="nv">return_a_whole_new_string</span><span class="ss">(</span><span class="nv">the_string</span><span class="ss">)</span>:
<span class="w">    </span><span class="nv">new_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">something_to_do_with_the_old_string</span><span class="ss">(</span><span class="nv">the_string</span><span class="ss">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nv">new_string</span>

#<span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="nv">you</span><span class="w"> </span><span class="nv">could</span><span class="w"> </span><span class="k">call</span><span class="w"> </span><span class="nl">it</span><span class="w"> </span><span class="nv">like</span>
<span class="nv">my_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">return_a_whole_new_string</span><span class="ss">(</span><span class="nv">my_string</span><span class="ss">)</span>
</pre></div>

<p>If you really wanted to avoid using a return value, you could create a class
to hold your value and pass it into the function or use an existing class,
like a list:</p>
<div class="code"><pre class="code literal-block"><span class="n">def</span><span class="w"> </span><span class="n">use_a_wrapper_to_simulate_pass_by_reference</span><span class="p">(</span><span class="n">stuff_to_change</span><span class="p">)</span><span class="err">:</span>
<span class="w">    </span><span class="n">new_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">something_to_do_with_the_old_string</span><span class="p">(</span><span class="n">stuff_to_change</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="p">)</span>
<span class="w">    </span><span class="n">stuff_to_change</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new_string</span>

<span class="err">#</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">could</span><span class="w"> </span><span class="k">call</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="ow">like</span>
<span class="n">wrapper</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">my_string</span><span class="o">]</span>
<span class="n">use_a_wrapper_to_simulate_pass_by_reference</span><span class="p">(</span><span class="n">wrapper</span><span class="p">)</span>

<span class="n">do_something_with</span><span class="p">(</span><span class="n">wrapper</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="p">)</span>
</pre></div>

<p>Although this seems a little cumbersome.</p>
<p><br></p>
<h3>Suggest</h3>
<p>The problem comes from a misunderstanding of what variables are in Python. If
you're used to most traditional languages, you have a mental model of what
happens in the following sequence:</p>
<div class="code"><pre class="code literal-block">a = 1
a = 2
</pre></div>

<p>You believe that <code>a</code> is a memory location that stores the value <code>1</code>, then is
updated to store the value <code>2</code>. That's not how things work in Python. Rather,
<code>a</code> starts as a reference to an object with the value <code>1</code>, then gets
reassigned as a reference to an object with the value <code>2</code>. Those two objects
may continue to coexist even though <code>a</code> doesn't refer to the first one
anymore; in fact they may be shared by any number of other references within
the program.</p>
<p>When you call a function with a parameter, a new reference is created that
refers to the object passed in. This is separate from the reference that was
used in the function call, so there's no way to update that reference and make
it refer to a new object. In your example:</p>
<div class="code"><pre class="code literal-block"><span class="n">def</span><span class="w"> </span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Original'</span>
<span class="w">    </span><span class="bp">self</span><span class="o">.</span><span class="n">Change</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="p">)</span>

<span class="n">def</span><span class="w"> </span><span class="n">Change</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="k">var</span><span class="p">):</span>
<span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Changed'</span>
</pre></div>

<p><code>self.variable</code> is a reference to the string object <code>'Original'</code>. When you
call <code>Change</code> you create a second reference <code>var</code> to the object. Inside the
function you reassign the reference <code>var</code> to a different string object
<code>'Changed'</code>, but the reference <code>self.variable</code> is separate and does not
change.</p>
<p>The only way around this is to pass a mutable object. Because both references
refer to the same object, any changes to the object are reflected in both
places.</p>
<div class="code"><pre class="code literal-block"><span class="n">def</span><span class="w"> </span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span><span class="w">         </span>
<span class="w">    </span><span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">'Original'</span><span class="p">]</span>
<span class="w">    </span><span class="bp">self</span><span class="o">.</span><span class="n">Change</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="p">)</span>

<span class="n">def</span><span class="w"> </span><span class="n">Change</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="k">var</span><span class="p">):</span>
<span class="w">    </span><span class="k">var</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Changed'</span>
</pre></div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-60.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-58.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
