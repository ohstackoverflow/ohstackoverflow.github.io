<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 1926) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-1926.html">
<link rel="prev" href="index-1927.html" type="text/html">
<link rel="next" href="index-1925.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/secondary-axis-with-twinx-how-to-add-to-legend/" class="u-url">Secondary axis with twinx(): how to add to legend?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/secondary-axis-with-twinx-how-to-add-to-legend/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T12:42:40+08:00" itemprop="datePublished" title="2023-03-03 12:42">2023-03-03 12:42</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I have a plot with two y-axes, using <code>twinx()</code>. I also give labels to the
lines, and want to show them with <code>legend()</code>, but I only succeed to get the
labels of one axis in the legend:</p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">rc</span>
<span class="n">rc</span><span class="p">(</span><span class="s1">'mathtext'</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">'regular'</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Swdown</span><span class="p">,</span> <span class="s1">'-'</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">'Swdown'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Rn</span><span class="p">,</span> <span class="s1">'-'</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">'Rn'</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">temp</span><span class="p">,</span> <span class="s1">'-r'</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">'temp'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">"Time (h)"</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"Radiation ($MJ\,m^{-2}\,d^{-1}$)"</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"Temperature ($^\circ$C)"</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">35</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

<p>So I only get the labels of the first axis in the legend, and not the label
'temp' of the second axis. How could I add this third label to the legend?</p>
<p><img alt="enter image description here" src="images/MdCYW.png"></p>
<p><br><br></p>
<h2>Answer</h2>
<p>You can easily add a second legend by adding the line:</p>
<div class="code"><pre class="code literal-block">ax2.legend(loc=0)
</pre></div>

<p>You'll get this:</p>
<p><img alt="enter image description here" src="images/DLZkF.png"></p>
<p>But if you want all labels on one legend then you should do something like
this:</p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">rc</span>
<span class="n">rc</span><span class="p">(</span><span class="s1">'mathtext'</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">'regular'</span><span class="p">)</span>

<span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">*</span><span class="mi">30</span>
<span class="n">Swdown</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="o">-</span><span class="mi">10</span>
<span class="n">Rn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="o">-</span><span class="mi">10</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="n">lns1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Swdown</span><span class="p">,</span> <span class="s1">'-'</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">'Swdown'</span><span class="p">)</span>
<span class="n">lns2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Rn</span><span class="p">,</span> <span class="s1">'-'</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">'Rn'</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">lns3</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">temp</span><span class="p">,</span> <span class="s1">'-r'</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">'temp'</span><span class="p">)</span>

<span class="c1"># added these three lines</span>
<span class="n">lns</span> <span class="o">=</span> <span class="n">lns1</span><span class="o">+</span><span class="n">lns2</span><span class="o">+</span><span class="n">lns3</span>
<span class="n">labs</span> <span class="o">=</span> <span class="p">[</span><span class="n">l</span><span class="o">.</span><span class="n">get_label</span><span class="p">()</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lns</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">lns</span><span class="p">,</span> <span class="n">labs</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">"Time (h)"</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"Radiation ($MJ\,m^{-2}\,d^{-1}$)"</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"Temperature ($^\circ$C)"</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">35</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

<p>Which will give you this:</p>
<p><img alt="enter image description here" src="images/Z8pg4.png"></p>
<p><br></p>
<h3>Suggest</h3>
<p>I'm not sure if this functionality is new, but you can also use the
get_legend_handles_labels() method rather than keeping track of lines and
labels yourself:</p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">rc</span>
<span class="n">rc</span><span class="p">(</span><span class="s1">'mathtext'</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">'regular'</span><span class="p">)</span>

<span class="n">pi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>

<span class="c1"># fake data</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">linspace</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">temp</span> <span class="o">=</span> <span class="mi">50</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="kp">sqrt</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="mi">3</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> \
        <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="kp">exp</span> <span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">time</span> <span class="o">-</span> <span class="mi">13</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">3</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">15</span>
<span class="n">Swdown</span> <span class="o">=</span> <span class="mi">400</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="kp">sqrt</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="mi">3</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="kp">exp</span> <span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">time</span> <span class="o">-</span> <span class="mi">13</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">3</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Rn</span> <span class="o">=</span> <span class="n">Swdown</span> <span class="o">-</span> <span class="mi">10</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Swdown</span><span class="p">,</span> <span class="s1">'-'</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">'Swdown'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Rn</span><span class="p">,</span> <span class="s1">'-'</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">'Rn'</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">temp</span><span class="p">,</span> <span class="s1">'-r'</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">'temp'</span><span class="p">)</span>

<span class="c1"># ask matplotlib for the plotted objects and their labels</span>
<span class="n">lines</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
<span class="n">lines2</span><span class="p">,</span> <span class="n">labels2</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">lines</span> <span class="o">+</span> <span class="n">lines2</span><span class="p">,</span> <span class="n">labels</span> <span class="o">+</span> <span class="n">labels2</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">"Time (h)"</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"Radiation ($MJ\,m^{-2}\,d^{-1}$)"</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"Temperature ($^\circ$C)"</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">35</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-clear-cache-in-yarn/" class="u-url">How to clear cache in Yarn?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-clear-cache-in-yarn/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T12:42:19+08:00" itemprop="datePublished" title="2023-03-03 12:42">2023-03-03 12:42</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I am doing some benchmark tests for Facebook's Yarn. For this, I need to clear
my global Yarn cache.</p>
<p>Is there a command available for this? I have force-removed my <code>~/.yarn-cache</code>
folder, but this seems to be quite manual.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Ok I found out the answer myself. Much like <code>npm cache clean</code>, Yarn also has
its own</p>
<div class="code"><pre class="code literal-block">yarn cache clean
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>Run <code>yarn cache clean</code>.</p>
<hr>
<p>Run <code>yarn help cache</code> in your bash, and you will see:</p>
<blockquote>
<p>Usage: yarn cache [ls|clean] [flags]</p>
<p>Options: -h, --help output usage information -V, --version output the
version number --offline<br>
 --prefer-offline<br>
 --strict-semver<br>
 --json<br>
 --global-folder [path]<br>
 --modules-folder [path] rather than installing modules into the
node_modules folder relative to the cwd, output them here<br>
 --packages-root [path] rather than storing modules into a global packages
root, store them here<br>
 --mutex [type][:specifier] use a mutex to ensure only one yarn instance is
executing</p>
<p>Visit http://yarnpkg.com/en/docs/cli/cache for documentation about this
command.</p>
</blockquote>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/gradle-implementation-vs-api-configuration/" class="u-url">Gradle Implementation vs API configuration</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/gradle-implementation-vs-api-configuration/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T12:41:54+08:00" itemprop="datePublished" title="2023-03-03 12:41">2023-03-03 12:41</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I'm trying to figure out what is the difference between <code>api</code> and
<code>implementation</code> configuration while building my <em>dependencies</em>.</p>
<p>In the documentation, it says that <code>implementation</code> has better build time,
but, seeing this comment in a similar question I got to wonder if is it true.</p>
<p>Since I'm no expert in Gradle, I hope someone can help. I've read the
documentation already but I was wondering about an easy-to-understand
explanation.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Gradle <code>compile</code> keyword was deprecated in favor of the <code>api</code> and
<code>implementation</code> keywords to configure dependencies.</p>
<p>Using <code>api</code> is the equivalent of using the deprecated <code>compile</code>, so if you
replace all <code>compile</code> with <code>api</code> everything will works as always.</p>
<p>To understand the <code>implementation</code> keyword consider the following example.</p>
<p><strong>EXAMPLE</strong></p>
<p>Suppose you have a library called <code>MyLibrary</code> that internally uses another
library called <code>InternalLibrary</code>. Something like this:</p>
<div class="code"><pre class="code literal-block"><span class="c1">// 'InternalLibrary' module</span>
<span class="n">public</span><span class="w"> </span><span class="n">class</span><span class="w"> </span><span class="n">InternalLibrary</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">giveMeAString</span><span class="p">(){</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">"hello"</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>



<span class="c1">// 'MyLibrary' module</span>
<span class="n">public</span><span class="w"> </span><span class="n">class</span><span class="w"> </span><span class="n">MyLibrary</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">myString</span><span class="p">(){</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">InternalLibrary</span><span class="p">.</span><span class="n">giveMeAString</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p>Suppose the <code>MyLibrary</code> <code>build.gradle</code> uses <code>api</code> configuration in
<code>dependencies{}</code> like this:</p>
<div class="code"><pre class="code literal-block">dependencies {
    api(project(":InternalLibrary"))
}
</pre></div>

<p>You want to use <code>MyLibrary</code> in your code so in your app's <code>build.gradle</code> you
add this dependency:</p>
<div class="code"><pre class="code literal-block">dependencies {
    implementation(project(":MyLibrary"))
}
</pre></div>

<p>Using the <code>api</code> configuration (or deprecated <code>compile</code>) you can access
<code>InternalLibrary</code> in your application code:</p>
<div class="code"><pre class="code literal-block"><span class="c1">// Access 'MyLibrary' (granted)</span>
<span class="n">MyLibrary</span><span class="w"> </span><span class="n">myLib</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">MyLibrary</span><span class="p">();</span>
<span class="n">System</span><span class="p">.</span><span class="n">out</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">myLib</span><span class="p">.</span><span class="n">myString</span><span class="p">());</span>

<span class="c1">// Can ALSO access the internal library too (but you shouldn't)</span>
<span class="n">System</span><span class="p">.</span><span class="n">out</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">InternalLibrary</span><span class="p">.</span><span class="n">giveMeAString</span><span class="p">());</span>
</pre></div>

<p>In this way the module <code>MyLibrary</code> is potentially "leaking" the internal
implementation of something. You shouldn't (be able to) use that because it's
not directly imported by you.</p>
<p>The <code>implementation</code> configuration was introduced to prevent this. So now if
you use <code>implementation</code> instead of <code>api</code> in <code>MyLibrary</code>:</p>
<div class="code"><pre class="code literal-block">dependencies {
    implementation(project(":InternalLibrary"))
}
</pre></div>

<p>you won't be able to call <code>InternalLibrary.giveMeAString()</code> in your app code
anymore.</p>
<p>This sort of boxing strategy allows Android Gradle plugin to know that if you
edit something in <code>InternalLibrary</code>, it must only trigger the recompilation of
<code>MyLibrary</code> and <em>not</em> the recompilation of your entire app, because you don't
have access to <code>InternalLibrary</code>.</p>
<p>When you have a lot of nested dependencies this mechanism can speed up the
build a lot. <em>(Watch the video linked at the end for a full understanding of
this)</em></p>
<p><strong>CONCLUSIONS</strong></p>
<ul>
<li>
<p>When you switch to the new Android Gradle plugin 3.X.X, you should replace all your <code>compile</code> with the <code>implementation</code> keyword * <em>(1</em> ) <strong>. Then try to compile and test your app. If everything it's ok leave the code as is, if you have problems you probably have something wrong with your dependencies or you used something that now is private and not more accessible. *Suggestion by Android Gradle plugin engineer Jerome Dochez _ <em>(1</em> )_</strong>)</p>
</li>
<li>
<p>If you are a library mantainer you should use <code>api</code> for every dependency which is needed for the public API of your library, while use <code>implementation</code> for test dependencies or dependencies which must not be used by the final users.</p>
</li>
</ul>
<p>Useful article Showcasing the difference between <strong>implementation</strong> and
<strong>api</strong></p>
<p><strong>REFERENCES</strong> (This is the same video splitted up for time saving)</p>
<p>Google I/O 2017 - How speed up Gradle builds (FULL VIDEO)</p>
<p>Google I/O 2017 - How speed up Gradle builds (NEW GRADLE PLUGIN 3.0.0 PART
ONLY)</p>
<p>Google I/O 2017 - How speed up Gradle builds (reference to <strong>1</strong> *)</p>
<p>Android documentation</p>
<p><br></p>
<h3>Suggest</h3>
<p>I like to think about an <code>api</code> dependency as <strong>public</strong> (seen by other
modules) while <code>implementation</code> dependency as <strong>private</strong> (only seen by this
module).</p>
<p>Note, that unlike <code>public</code>/<code>private</code> variables and methods,
<code>api</code>/<code>implementation</code> dependencies are not enforced by the runtime. This is
merely a build-time optimization, that allows <code>Gradle</code> to know which modules
it needs to recompile when one of the dependencies changes its API.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-1927.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-1925.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
