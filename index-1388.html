<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 1388) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-1388.html">
<link rel="prev" href="index-1389.html" type="text/html">
<link rel="next" href="index-1387.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/does-gridsearchcv-store-all-the-scores-for-all-parameter-combinations/" class="u-url">Does GridSearchCV store all the scores for all parameter combinations?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/does-gridsearchcv-store-all-the-scores-for-all-parameter-combinations/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-28T02:56:43+08:00" itemprop="datePublished" title="2023-02-28 02:56">2023-02-28 02:56</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>The GridSearchCV use 'scoring' to select best estimator. After train the
GridSearchCV, I would like to see the score for each combination. Does
GridSearchCV store all scores for each parameter combinations? If it does how
to get the scores? Thanks.</p>
<p>Here is an example code that I used in another post.</p>
<div class="code"><pre class="code literal-block"><span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">CountVectorizer</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">TfidfTransformer</span>
<span class="kn">from</span> <span class="nn">sklearn.grid_search</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">MultinomialNB</span>

<span class="n">X_train</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'qwe rtyuiop'</span><span class="p">,</span> <span class="s1">'asd fghj kl'</span><span class="p">,</span> <span class="s1">'zx cv bnm'</span><span class="p">,</span> <span class="s1">'qw erty ui op'</span><span class="p">,</span> <span class="s1">'as df ghj kl'</span><span class="p">,</span> <span class="s1">'zxc vb nm'</span><span class="p">,</span> <span class="s1">'qwe rt yu iop'</span><span class="p">,</span> <span class="s1">'asdfg hj kl'</span><span class="p">,</span> <span class="s1">'zx cvb nm'</span><span class="p">,</span>
          <span class="s1">'qwe rt yui op'</span><span class="p">,</span> <span class="s1">'asd fghj kl'</span><span class="p">,</span> <span class="s1">'zx cvb nm'</span><span class="p">,</span> <span class="s1">'qwer tyui op'</span><span class="p">,</span> <span class="s1">'asd fg hjk l'</span><span class="p">,</span> <span class="s1">'zx cv b nm'</span><span class="p">,</span> <span class="s1">'qw ert yu iop'</span><span class="p">,</span> <span class="s1">'as df gh jkl'</span><span class="p">,</span> <span class="s1">'zx cvb nm'</span><span class="p">,</span>
           <span class="s1">'qwe rty uiop'</span><span class="p">,</span> <span class="s1">'asd fghj kl'</span><span class="p">,</span> <span class="s1">'zx cvbnm'</span><span class="p">,</span> <span class="s1">'qw erty ui op'</span><span class="p">,</span> <span class="s1">'as df ghj kl'</span><span class="p">,</span> <span class="s1">'zxc vb nm'</span><span class="p">,</span> <span class="s1">'qwe rtyu iop'</span><span class="p">,</span> <span class="s1">'as dfg hj kl'</span><span class="p">,</span> <span class="s1">'zx cvb nm'</span><span class="p">,</span>
          <span class="s1">'qwe rt yui op'</span><span class="p">,</span> <span class="s1">'asd fg hj kl'</span><span class="p">,</span> <span class="s1">'zx cvb nm'</span><span class="p">,</span> <span class="s1">'qwer tyuiop'</span><span class="p">,</span> <span class="s1">'asd fghjk l'</span><span class="p">,</span> <span class="s1">'zx cv b nm'</span><span class="p">,</span> <span class="s1">'qw ert yu iop'</span><span class="p">,</span> <span class="s1">'as df gh jkl'</span><span class="p">,</span> <span class="s1">'zx cvb nm'</span><span class="p">]</span>

<span class="n">y_train</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'1'</span><span class="p">,</span> <span class="s1">'2'</span><span class="p">,</span> <span class="s1">'3'</span><span class="p">,</span> <span class="s1">'1'</span><span class="p">,</span> <span class="s1">'1'</span><span class="p">,</span> <span class="s1">'3'</span><span class="p">,</span> <span class="s1">'1'</span><span class="p">,</span> <span class="s1">'2'</span><span class="p">,</span> <span class="s1">'3'</span><span class="p">,</span>
          <span class="s1">'1'</span><span class="p">,</span> <span class="s1">'2'</span><span class="p">,</span> <span class="s1">'3'</span><span class="p">,</span> <span class="s1">'1'</span><span class="p">,</span> <span class="s1">'4'</span><span class="p">,</span> <span class="s1">'1'</span><span class="p">,</span> <span class="s1">'2'</span><span class="p">,</span> <span class="s1">'2'</span><span class="p">,</span> <span class="s1">'4'</span><span class="p">,</span> 
          <span class="s1">'1'</span><span class="p">,</span> <span class="s1">'2'</span><span class="p">,</span> <span class="s1">'3'</span><span class="p">,</span> <span class="s1">'1'</span><span class="p">,</span> <span class="s1">'1'</span><span class="p">,</span> <span class="s1">'3'</span><span class="p">,</span> <span class="s1">'1'</span><span class="p">,</span> <span class="s1">'2'</span><span class="p">,</span> <span class="s1">'3'</span><span class="p">,</span>
          <span class="s1">'1'</span><span class="p">,</span> <span class="s1">'2'</span><span class="p">,</span> <span class="s1">'3'</span><span class="p">,</span> <span class="s1">'1'</span><span class="p">,</span> <span class="s1">'4'</span><span class="p">,</span> <span class="s1">'1'</span><span class="p">,</span> <span class="s1">'2'</span><span class="p">,</span> <span class="s1">'2'</span><span class="p">,</span> <span class="s1">'4'</span><span class="p">]</span>


<span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>  
                <span class="s1">'clf__alpha'</span><span class="p">:</span> <span class="p">(</span><span class="mf">1e-1</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">),</span>
                 <span class="s1">'vect__ngram_range'</span><span class="p">:</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)],</span>
                 <span class="s1">'vect__max_df'</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.98</span><span class="p">)</span>
            <span class="p">}</span>

<span class="n">text_clf_Pipline_MultinomialNB</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">'vect'</span><span class="p">,</span> <span class="n">CountVectorizer</span><span class="p">()),</span>
                                           <span class="p">(</span><span class="s1">'tfidf'</span><span class="p">,</span> <span class="n">TfidfTransformer</span><span class="p">()),</span>
                                           <span class="p">(</span><span class="s1">'clf'</span><span class="p">,</span> <span class="n">MultinomialNB</span><span class="p">()),</span>                     
                                          <span class="p">])</span>
<span class="n">gs_clf</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">text_clf_Pipline_MultinomialNB</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">gs_classifier</span> <span class="o">=</span> <span class="n">gs_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<p>Yes it does, exactly as it is stated in the docs:</p>
<blockquote>
<p><code>grid_scores_</code> : list of named tuples</p>
<p>Contains scores for all parameter combinations in param_grid. Each entry
corresponds to one parameter setting. Each named tuple has the attributes:</p>
<ul>
<li>
<code>parameters</code>, a dict of parameter settings</li>
<li>
<code>mean_validation_score</code>, the mean score over the cross-validation folds</li>
<li>
<code>cv_validation_scores</code>, the list of scores for each fold
</li>
</ul>
</blockquote>
<p><br></p>
<h3>Suggest</h3>
<div class="code"><pre class="code literal-block">allscores=model.cv_results_['mean_test_score']
print(allscores)
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/what-s-the-difference-between-best-first-search-and-a-search/" class="u-url">What's the difference between best-first search and A* search?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/what-s-the-difference-between-best-first-search-and-a-search/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-28T02:56:23+08:00" itemprop="datePublished" title="2023-02-28 02:56">2023-02-28 02:56</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>In my text book I noticed that both these algorithms work almost exactly the
same, I am trying to understand what's the major <em>difference between them</em>.</p>
<p><img alt="Example from the textbook" src="images/9xMUF.png"></p>
<p>The textbook traversed this example using <em>A*</em> the same way it did with <em>best-
first search</em>.</p>
<p>Any help would be appreciated.</p>
<p><br><br></p>
<h2>Answer</h2>
<p><strong>Best-first search</strong> algorithm visits next state based on heuristics function
<em>f(n) = h</em> with lowest heuristic value (often called greedy). It doesn't
consider cost of the path to that particular state. All it cares about is that
which next state from the current state has lowest heuristics.</p>
<p><strong>A* search</strong> algorithm visits next state based on heristics <em>f(n) = h + g</em>
where <em>h</em> component is same heuristics applied as in Best-first search but <em>g</em>
component is path from the initial state to the particular state. Therefore it
doesn't chooses next state only with lowest heuristics value but one that
gives lowest value when considering it's heuristics and cost of getting to
that state.</p>
<blockquote>
<p>In your example above when you start from Arad you can go either straight to
Sibiu (253km) or to the Zerind(374km) or Timisoara(329km). In this case both
algorithms choose Sibiu as it has lower value f(n) = 253.</p>
<p>Now you can expand to either state back to Arad(366km) or Oradea(380km) or
Faragas(178km) or Rimnicu Vilcea(193km). For <strong>best first</strong> search Faragas
will have lowest f(n) = 178 but <strong>A</strong>* will have Rimnicu Vilcea f(n) = 220 +
193 = 413 where 220 is cost of getting to Rimnicu from Arad (140+80) and 193
is from Rimnicu to Bucharest but for Faragas it will be more as f(n) = 239 +
178 = 417.</p>
</blockquote>
<p>So now clearly you can see <strong>best-first</strong> is greedy algorithm because it would
choose state with lower heuristics but higher overall cost as it doesn't
consider cost of getting to that state from initial state</p>
<p><br></p>
<h3>Suggest</h3>
<p>A<em> achieves better performance by using heuristics to guide its search. A</em>
combines the advantages of Best-first Search and Uniform Cost Search: ensure
to find the optimized path while increasing the algorithm efficiency using
heuristics. A<em> function would be f(n) = g(n) + h(n) with h(n) being the
estimated distance between any random vertex n and target vertex, g(n) being
the actual distance between the start point and any vertex n. If g(n)=0, the
A</em> turns to be Best-First Search. If h(n)=0, then A* turns to be Uniform-Cost
Search.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/why-is-the-complexity-of-a-exponential-in-memory/" class="u-url">Why is the complexity of A* exponential in memory?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/why-is-the-complexity-of-a-exponential-in-memory/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-28T02:55:50+08:00" itemprop="datePublished" title="2023-02-28 02:55">2023-02-28 02:55</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Wikipedia says on A* complexity the following (link here):</p>
<blockquote>
<p>More problematic than its time complexity is A*’s memory usage. In the worst
case, it must also remember an exponential number of nodes.</p>
</blockquote>
<p>I fail to see this is correct because:</p>
<p>Say we explore node A, with successors B, C, and D. Then we add B, C, and D to
the list of open nodes, each accompanied by a reference to A, and we move A
from the open nodes to the closed nodes.</p>
<p>If at some time we find another path to B (say, via Q), that is better than
the path through A, then all that is needed is to change B's reference to A to
point to Q and update its actual cost, g (and logically f).</p>
<p>Therefore, if we store in a node its name, its referring node name, and its g,
h, and f scores, then the maximum amount of nodes stored is the actual amount
of nodes in the graph, isn't it? I really cannot see why at any time the
algorithm would need to store an amount of nodes in memory that is exponential
to the length of the optimal (shortest) path.</p>
<p>Could someone please explain?</p>
<hr>
<p><strong>edit</strong> As I understand now reading your answers, I was reasoning from the
wrong viewpoint of the problem. I took for granted a <em>given</em> graph, whereas
the exponential complexity refers to a an <em>conceptual</em> graph that is defined
solely by a "branching factor".</p>
<p><br><br></p>
<h2>Answer</h2>
<p>A* is just a guided version of breadth-first search, which is exponential in
memory complexity with respect to the length of the solution.</p>
<p>When using a constant heuristic, A* will become a normal breadth-first search;
uniform cost search to be exact.</p>
<p>When using the optimal heuristic, A* will be <code>O(n)</code> in both space and time
complexity if we disregard the complexity of the heuristic calculation itself.
Again <code>n</code> is the length of the solution path.</p>
<p><br></p>
<h3>Suggest</h3>
<p>I think the exponential-ness comes into play when you backtrack to node B to
expand it, but then backtrack to node C to expand it, and then backtrack to
node D. Now we have to keep track of all the children of nodes A, B, C, and D.</p>
<p>The backtracking is based on the cost of the edges to move to the next node,
so this is a real possibility, but is the worse case.</p>
<p>If each node has exactly 2 children off of it, and each node has the same
cost, then the equation is 2^n, where n is the depth of the search so far.</p>
<p>For example, you start off with node 0. 0 has 2 children 00 and 01. 00 has 2
children 000 and 001. At the worse case with a depth of 4 the equation is 2^4,
where 2 is the number of children each node has and 4 is the depth of the
search.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-1389.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-1387.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
