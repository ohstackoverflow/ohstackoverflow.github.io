<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 977) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-977.html">
<link rel="prev" href="index-978.html" type="text/html">
<link rel="next" href="index-976.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/is-there-a-command-to-refresh-environment-variables-from-the-command-prompt-in-windows/" class="u-url">Is there a command to refresh environment variables from the command prompt in Windows?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/is-there-a-command-to-refresh-environment-variables-from-the-command-prompt-in-windows/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T21:19:04+08:00" itemprop="datePublished" title="2023-02-17 21:19">2023-02-17 21:19</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>If I modify or add an environment variable I have to restart the command
prompt. Is there a command I could execute that would do this without
restarting CMD?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>You can capture the system environment variables with a vbs script, but you
need a bat script to actually change the current environment variables, so
this is a combined solution.</p>
<p>Create a file named <code>resetvars.vbs</code> containing this code, and save it on the
path:</p>
<div class="code"><pre class="code literal-block"><span class="n">Set</span><span class="w"> </span><span class="n">oShell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">WScript</span><span class="o">.</span><span class="n">CreateObject</span><span class="p">(</span><span class="s2">"WScript.Shell"</span><span class="p">)</span>
<span class="n">filename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">oShell</span><span class="o">.</span><span class="n">ExpandEnvironmentStrings</span><span class="p">(</span><span class="s2">"%TEMP%</span><span class="se">\r</span><span class="s2">esetvars.bat"</span><span class="p">)</span>
<span class="n">Set</span><span class="w"> </span><span class="n">objFileSystem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CreateObject</span><span class="p">(</span><span class="s2">"Scripting.fileSystemObject"</span><span class="p">)</span>
<span class="n">Set</span><span class="w"> </span><span class="n">oFile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">objFileSystem</span><span class="o">.</span><span class="n">CreateTextFile</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="w"> </span><span class="n">TRUE</span><span class="p">)</span>

<span class="n">set</span><span class="w"> </span><span class="n">oEnv</span><span class="o">=</span><span class="n">oShell</span><span class="o">.</span><span class="n">Environment</span><span class="p">(</span><span class="s2">"System"</span><span class="p">)</span>
<span class="k">for</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">sitem</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">oEnv</span><span class="w"> </span>
<span class="w">    </span><span class="n">oFile</span><span class="o">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s2">"SET "</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">sitem</span><span class="p">)</span>
<span class="n">next</span>
<span class="n">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">oEnv</span><span class="p">(</span><span class="s2">"PATH"</span><span class="p">)</span>

<span class="n">set</span><span class="w"> </span><span class="n">oEnv</span><span class="o">=</span><span class="n">oShell</span><span class="o">.</span><span class="n">Environment</span><span class="p">(</span><span class="s2">"User"</span><span class="p">)</span>
<span class="k">for</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">sitem</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">oEnv</span><span class="w"> </span>
<span class="w">    </span><span class="n">oFile</span><span class="o">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s2">"SET "</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">sitem</span><span class="p">)</span>
<span class="n">next</span>

<span class="n">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="s2">";"</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">oEnv</span><span class="p">(</span><span class="s2">"PATH"</span><span class="p">)</span>
<span class="n">oFile</span><span class="o">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s2">"SET PATH="</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">path</span><span class="p">)</span>
<span class="n">oFile</span><span class="o">.</span><span class="n">Close</span>
</pre></div>

<p>create another file name resetvars.bat containing this code, same location:</p>
<div class="code"><pre class="code literal-block"><span class="err">@</span><span class="n">echo</span><span class="w"> </span><span class="n">off</span>
<span class="o">%~</span><span class="n">dp0resetvars</span><span class="o">.</span><span class="n">vbs</span>
<span class="n">call</span><span class="w"> </span><span class="s2">"%TEMP%</span><span class="se">\r</span><span class="s2">esetvars.bat"</span>
</pre></div>

<p>When you want to refresh the environment variables, just run <code>resetvars.bat</code></p>
<hr>
<p><em>Apologetics</em> :</p>
<p>The two main problems I had coming up with this solution were</p>
<p><strong>a.</strong> I couldn't find a straightforward way to export environment variables
from a vbs script back to the command prompt, and</p>
<p><strong>b.</strong> the PATH environment variable is a concatenation of the user and the
system PATH variables.</p>
<p>I'm not sure what the general rule is for conflicting variables between user
and system, so I elected to make user override system, except in the PATH
variable which is handled specifically.</p>
<p>I use the weird vbs+bat+temporary bat mechanism to work around the problem of
exporting variables from vbs.</p>
<p><strong>Note</strong> : this script does not delete variables.</p>
<p>This can probably be improved.</p>
<p><strong>ADDED</strong></p>
<p>If you need to export the environment from one cmd window to another, use this
script (let's call it <code>exportvars.vbs</code>):</p>
<div class="code"><pre class="code literal-block"><span class="n">Set</span><span class="w"> </span><span class="n">oShell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">WScript</span><span class="o">.</span><span class="n">CreateObject</span><span class="p">(</span><span class="s2">"WScript.Shell"</span><span class="p">)</span>
<span class="n">filename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">oShell</span><span class="o">.</span><span class="n">ExpandEnvironmentStrings</span><span class="p">(</span><span class="s2">"%TEMP%</span><span class="se">\r</span><span class="s2">esetvars.bat"</span><span class="p">)</span>
<span class="n">Set</span><span class="w"> </span><span class="n">objFileSystem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CreateObject</span><span class="p">(</span><span class="s2">"Scripting.fileSystemObject"</span><span class="p">)</span>
<span class="n">Set</span><span class="w"> </span><span class="n">oFile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">objFileSystem</span><span class="o">.</span><span class="n">CreateTextFile</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="w"> </span><span class="n">TRUE</span><span class="p">)</span>

<span class="n">set</span><span class="w"> </span><span class="n">oEnv</span><span class="o">=</span><span class="n">oShell</span><span class="o">.</span><span class="n">Environment</span><span class="p">(</span><span class="s2">"Process"</span><span class="p">)</span>
<span class="k">for</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">sitem</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">oEnv</span><span class="w"> </span>
<span class="w">    </span><span class="n">oFile</span><span class="o">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s2">"SET "</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">sitem</span><span class="p">)</span>
<span class="n">next</span>
<span class="n">oFile</span><span class="o">.</span><span class="n">Close</span>
</pre></div>

<p>Run <code>exportvars.vbs</code> in the window you want to export <strong>from</strong> , then switch
to the window you want to export <strong>to</strong> , and type:</p>
<div class="code"><pre class="code literal-block"><span class="s2">"%TEMP%</span><span class="se">\r</span><span class="s2">esetvars.bat"</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>Here is what Chocolatey uses.</p>
<p>https://github.com/chocolatey/choco/blob/master/src/chocolatey.resources/redirects/RefreshEnv.cmd</p>
<div class="code"><pre class="code literal-block"><span class="err">@</span><span class="n">echo</span><span class="w"> </span><span class="n">off</span>
<span class="p">::</span>
<span class="p">::</span><span class="w"> </span><span class="n">RefreshEnv</span><span class="o">.</span><span class="n">cmd</span>
<span class="p">::</span>
<span class="p">::</span><span class="w"> </span><span class="n">Batch</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="n">variables</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">registry</span><span class="w"> </span><span class="ow">and</span>
<span class="p">::</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">session</span><span class="w"> </span><span class="n">variables</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">these</span><span class="w"> </span><span class="n">values</span><span class="o">.</span>
<span class="p">::</span>
<span class="p">::</span><span class="w"> </span><span class="n">With</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">batch</span><span class="w"> </span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">need</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">reload</span><span class="w"> </span><span class="n">command</span>
<span class="p">::</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="n">every</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="n">changes</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">propagate</span>

<span class="p">::</span><span class="n">echo</span><span class="w"> </span><span class="s2">"RefreshEnv.cmd only works from cmd.exe, please install the Chocolatey Profile to take advantage of refreshenv from PowerShell"</span>
<span class="n">echo</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="o">/</span><span class="n">p</span><span class="w"> </span><span class="n">dummy</span><span class="o">=</span><span class="s2">"Refreshing environment variables from registry for cmd.exe. Please wait..."</span>

<span class="n">goto</span><span class="w"> </span><span class="n">main</span>

<span class="p">::</span><span class="w"> </span><span class="n">Set</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">registry</span><span class="w"> </span><span class="n">key</span>
<span class="p">:</span><span class="n">SetFromReg</span>
<span class="w">    </span><span class="s2">"%WinDir%\System32\Reg"</span><span class="w"> </span><span class="n">QUERY</span><span class="w"> </span><span class="s2">"%~1"</span><span class="w"> </span><span class="o">/</span><span class="n">v</span><span class="w"> </span><span class="s2">"%~2"</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="s2">"%TEMP%\_envset.tmp"</span><span class="w"> </span><span class="mi">2</span><span class="o">&gt;</span><span class="n">NUL</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="o">/</span><span class="n">f</span><span class="w"> </span><span class="s2">"usebackq skip=2 tokens=2,*"</span><span class="w"> </span><span class="o">%%</span><span class="n">A</span><span class="w"> </span><span class="n">IN</span><span class="w"> </span><span class="p">(</span><span class="s2">"%TEMP%\_envset.tmp"</span><span class="p">)</span><span class="w"> </span><span class="n">do</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="n">echo</span><span class="o">/</span><span class="n">set</span><span class="w"> </span><span class="s2">"%~3=</span><span class="si">%%</span><span class="s2">B"</span>
<span class="w">    </span><span class="p">)</span>
<span class="w">    </span><span class="n">goto</span><span class="w"> </span><span class="p">:</span><span class="n">EOF</span>

<span class="p">::</span><span class="w"> </span><span class="n">Get</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="n">variables</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">registry</span>
<span class="p">:</span><span class="n">GetRegEnv</span>
<span class="w">    </span><span class="s2">"%WinDir%\System32\Reg"</span><span class="w"> </span><span class="n">QUERY</span><span class="w"> </span><span class="s2">"%~1"</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="s2">"%TEMP%\_envget.tmp"</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="o">/</span><span class="n">f</span><span class="w"> </span><span class="s2">"usebackq skip=2"</span><span class="w"> </span><span class="o">%%</span><span class="n">A</span><span class="w"> </span><span class="n">IN</span><span class="w"> </span><span class="p">(</span><span class="s2">"%TEMP%\_envget.tmp"</span><span class="p">)</span><span class="w"> </span><span class="n">do</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="o">/</span><span class="n">I</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="s2">"</span><span class="si">%%</span><span class="s2">~A"</span><span class="o">==</span><span class="s2">"Path"</span><span class="w"> </span><span class="p">(</span>
<span class="w">            </span><span class="n">call</span><span class="w"> </span><span class="p">:</span><span class="n">SetFromReg</span><span class="w"> </span><span class="s2">"%~1"</span><span class="w"> </span><span class="s2">"</span><span class="si">%%</span><span class="s2">~A"</span><span class="w"> </span><span class="s2">"</span><span class="si">%%</span><span class="s2">~A"</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span>
<span class="w">    </span><span class="n">goto</span><span class="w"> </span><span class="p">:</span><span class="n">EOF</span>

<span class="p">:</span><span class="n">main</span>
<span class="w">    </span><span class="n">echo</span><span class="o">/</span><span class="err">@</span><span class="n">echo</span><span class="w"> </span><span class="n">off</span><span class="w"> </span><span class="o">&gt;</span><span class="s2">"%TEMP%\_env.cmd"</span>

<span class="w">    </span><span class="p">::</span><span class="w"> </span><span class="n">Slowly</span><span class="w"> </span><span class="n">generating</span><span class="w"> </span><span class="n">final</span><span class="w"> </span><span class="n">file</span>
<span class="w">    </span><span class="n">call</span><span class="w"> </span><span class="p">:</span><span class="n">GetRegEnv</span><span class="w"> </span><span class="s2">"HKLM\System\CurrentControlSet\Control\Session Manager\Environment"</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="s2">"%TEMP%\_env.cmd"</span>
<span class="w">    </span><span class="n">call</span><span class="w"> </span><span class="p">:</span><span class="n">GetRegEnv</span><span class="w"> </span><span class="s2">"HKCU\Environment"</span><span class="o">&gt;&gt;</span><span class="s2">"%TEMP%\_env.cmd"</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="s2">"%TEMP%\_env.cmd"</span>

<span class="w">    </span><span class="p">::</span><span class="w"> </span><span class="n">Special</span><span class="w"> </span><span class="n">handling</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">PATH</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mix</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">User</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">System</span>
<span class="w">    </span><span class="n">call</span><span class="w"> </span><span class="p">:</span><span class="n">SetFromReg</span><span class="w"> </span><span class="s2">"HKLM\System\CurrentControlSet\Control\Session Manager\Environment"</span><span class="w"> </span><span class="n">Path</span><span class="w"> </span><span class="n">Path_HKLM</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="s2">"%TEMP%\_env.cmd"</span>
<span class="w">    </span><span class="n">call</span><span class="w"> </span><span class="p">:</span><span class="n">SetFromReg</span><span class="w"> </span><span class="s2">"HKCU\Environment"</span><span class="w"> </span><span class="n">Path</span><span class="w"> </span><span class="n">Path_HKCU</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="s2">"%TEMP%\_env.cmd"</span>

<span class="w">    </span><span class="p">::</span><span class="w"> </span><span class="n">Caution</span><span class="p">:</span><span class="w"> </span><span class="n">do</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">insert</span><span class="w"> </span><span class="n">space</span><span class="o">-</span><span class="n">chars</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">redirection</span><span class="w"> </span><span class="nb">sign</span>
<span class="w">    </span><span class="n">echo</span><span class="o">/</span><span class="n">set</span><span class="w"> </span><span class="s2">"Path=</span><span class="si">%%</span><span class="s2">Path_HKLM</span><span class="si">%%</span><span class="s2">;</span><span class="si">%%</span><span class="s2">Path_HKCU</span><span class="si">%%</span><span class="s2">"</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="s2">"%TEMP%\_env.cmd"</span>

<span class="w">    </span><span class="p">::</span><span class="w"> </span><span class="n">Cleanup</span>
<span class="w">    </span><span class="n">del</span><span class="w"> </span><span class="o">/</span><span class="n">f</span><span class="w"> </span><span class="o">/</span><span class="n">q</span><span class="w"> </span><span class="s2">"%TEMP%\_envset.tmp"</span><span class="w"> </span><span class="mi">2</span><span class="o">&gt;</span><span class="n">nul</span>
<span class="w">    </span><span class="n">del</span><span class="w"> </span><span class="o">/</span><span class="n">f</span><span class="w"> </span><span class="o">/</span><span class="n">q</span><span class="w"> </span><span class="s2">"%TEMP%\_envget.tmp"</span><span class="w"> </span><span class="mi">2</span><span class="o">&gt;</span><span class="n">nul</span>

<span class="w">    </span><span class="p">::</span><span class="w"> </span><span class="n">capture</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">architecture</span>
<span class="w">    </span><span class="n">SET</span><span class="w"> </span><span class="s2">"OriginalUserName=%USERNAME%"</span>
<span class="w">    </span><span class="n">SET</span><span class="w"> </span><span class="s2">"OriginalArchitecture=%PROCESSOR_ARCHITECTURE%"</span>

<span class="w">    </span><span class="p">::</span><span class="w"> </span><span class="n">Set</span><span class="w"> </span><span class="n">these</span><span class="w"> </span><span class="n">variables</span>
<span class="w">    </span><span class="n">call</span><span class="w"> </span><span class="s2">"%TEMP%\_env.cmd"</span>

<span class="w">    </span><span class="p">::</span><span class="w"> </span><span class="n">Cleanup</span>
<span class="w">    </span><span class="n">del</span><span class="w"> </span><span class="o">/</span><span class="n">f</span><span class="w"> </span><span class="o">/</span><span class="n">q</span><span class="w"> </span><span class="s2">"%TEMP%\_env.cmd"</span><span class="w"> </span><span class="mi">2</span><span class="o">&gt;</span><span class="n">nul</span>

<span class="w">    </span><span class="p">::</span><span class="w"> </span><span class="n">reset</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">architecture</span>
<span class="w">    </span><span class="n">SET</span><span class="w"> </span><span class="s2">"USERNAME=%OriginalUserName%"</span>
<span class="w">    </span><span class="n">SET</span><span class="w"> </span><span class="s2">"PROCESSOR_ARCHITECTURE=%OriginalArchitecture%"</span>

<span class="w">    </span><span class="n">echo</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="o">/</span><span class="n">p</span><span class="w"> </span><span class="n">dummy</span><span class="o">=</span><span class="s2">"Finished."</span>
<span class="w">    </span><span class="n">echo</span><span class="w"> </span><span class="o">.</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-add-elements-to-an-empty-array-in-php/" class="u-url">How to add elements to an empty array in PHP?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-add-elements-to-an-empty-array-in-php/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T21:18:28+08:00" itemprop="datePublished" title="2023-02-17 21:18">2023-02-17 21:18</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>If I define an array in PHP such as (I don't define its size):</p>
<div class="code"><pre class="code literal-block">$cart = array();
</pre></div>

<p>Do I simply add elements to it using the following?</p>
<div class="code"><pre class="code literal-block">$cart[] = 13;
$cart[] = "foo";
$cart[] = obj;
</pre></div>

<p>Don't arrays in PHP have an add method, for example, <code>cart.add(13)</code>?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Both <code>array_push</code> and the method you described will work.</p>
<div class="code"><pre class="code literal-block">$cart<span class="w"> </span>=<span class="w"> </span>array();
$cart[]<span class="w"> </span>=<span class="w"> </span>13;
$cart[]<span class="w"> </span>=<span class="w"> </span>14;
//<span class="w"> </span>etc

//Above<span class="w"> </span>is<span class="w"> </span>correct.<span class="w"> </span>but<span class="w"> </span>below<span class="w"> </span>one<span class="w"> </span>is<span class="w"> </span>for<span class="w"> </span>further<span class="w"> </span>understanding
$cart<span class="w"> </span>=<span class="w"> </span>array();
for($i=0;$i<span class="err">&lt;</span>=5;$i++){
<span class="w">    </span>$cart[]<span class="w"> </span>=<span class="w"> </span>$i;<span class="w">  </span>
}
echo<span class="w"> </span>"<span class="nt">&lt;pre&gt;</span>";
print_r($cart);
echo<span class="w"> </span>"<span class="nt">&lt;/pre&gt;</span>";
</pre></div>

<p>Is the same as:</p>
<div class="code"><pre class="code literal-block"><span class="cp">&lt;?php</span>
<span class="nv">$cart</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="nb">array_push</span><span class="p">(</span><span class="nv">$cart</span><span class="p">,</span> <span class="mi">13</span><span class="p">);</span>
<span class="nb">array_push</span><span class="p">(</span><span class="nv">$cart</span><span class="p">,</span> <span class="mi">14</span><span class="p">);</span>

<span class="c1">// Or </span>
<span class="nv">$cart</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="nb">array_push</span><span class="p">(</span><span class="nv">$cart</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>It's better to not use <code>array_push</code> and just use what you suggested. The
functions just add overhead.</p>
<div class="code"><pre class="code literal-block"><span class="c1">//We don't need to define the array, but in many cases it's the best solution.</span>
<span class="no">$</span><span class="n">cart</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">array</span><span class="p">();</span>

<span class="c1">//Automatic new integer key higher than the highest </span>
<span class="c1">//existing integer key in the array, starts at 0.</span>
<span class="no">$</span><span class="n">cart</span><span class="p">[]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">13</span><span class="p">;</span>
<span class="no">$</span><span class="n">cart</span><span class="p">[]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">'text'</span><span class="p">;</span>

<span class="c1">//Numeric key</span>
<span class="no">$</span><span class="n">cart</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="no">$</span><span class="n">object</span><span class="p">;</span>

<span class="c1">//Text key (assoc)</span>
<span class="no">$</span><span class="n">cart</span><span class="p">[</span><span class="s">'key'</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">'test'</span><span class="p">;</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/algorithm-to-return-all-combinations-of-k-elements-from-n/" class="u-url">Algorithm to return all combinations of k elements from n</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/algorithm-to-return-all-combinations-of-k-elements-from-n/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T21:17:53+08:00" itemprop="datePublished" title="2023-02-17 21:17">2023-02-17 21:17</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I want to write a function that takes an array of letters as an argument and a
number of those letters to select.</p>
<p>Say you provide an array of 8 letters and want to select 3 letters from that.
Then you should get:</p>
<div class="code"><pre class="code literal-block"><span class="mf">8</span><span class="err">!</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">((</span><span class="mf">8</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">3</span><span class="p">)</span><span class="err">!</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">3</span><span class="err">!</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">56</span>
</pre></div>

<p>Arrays (or words) in return consisting of 3 letters each.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Art of Computer Programming Volume 4: Fascicle 3 has a ton of these that might
fit your particular situation better than how I describe.</p>
<h3>Gray Codes</h3>
<p>An issue that you will come across is of course memory and pretty quickly,
you'll have problems by 20 elements in your set -- 20C3 = 1140. And if you
want to iterate over the set it's best to use a modified gray code algorithm
so you aren't holding all of them in memory. These generate the next
combination from the previous and avoid repetitions. There are many of these
for different uses. Do we want to maximize the differences between successive
combinations? minimize? et cetera.</p>
<p>Some of the original papers describing gray codes:</p>
<ol>
<li>Some Hamilton Paths and a Minimal Change Algorithm</li>
<li>Adjacent Interchange Combination Generation Algorithm</li>
</ol>
<p>Here are some other papers covering the topic:</p>
<ol>
<li>An Efficient Implementation of the Eades, Hickey, Read Adjacent Interchange Combination Generation Algorithm (PDF, with code in Pascal)</li>
<li>Combination Generators</li>
<li>Survey of Combinatorial Gray Codes (PostScript)</li>
<li>An Algorithm for Gray Codes</li>
</ol>
<h3>Chase's Twiddle (algorithm)</h3>
<p>Phillip J Chase, `Algorithm 382: Combinations of M out of N Objects' (1970)</p>
<p>The algorithm in C...</p>
<h3>Index of Combinations in Lexicographical Order (Buckles Algorithm 515)</h3>
<p>You can also reference a combination by its index (in lexicographical order).
Realizing that the index should be some amount of change from right to left
based on the index we can construct something that should recover a
combination.</p>
<p>So, we have a set {1,2,3,4,5,6}... and we want three elements. Let's say
{1,2,3} we can say that the difference between the elements is one and in
order and minimal. {1,2,4} has one change and is lexicographically number 2.
So the number of 'changes' in the last place accounts for one change in the
lexicographical ordering. The second place, with one change {1,3,4} has one
change but accounts for more change since it's in the second place
(proportional to the number of elements in the original set).</p>
<p>The method I've described is a deconstruction, as it seems, from set to the
index, we need to do the reverse – which is much trickier. This is how Buckles
solves the problem. I wrote some C to compute them, with minor changes – I
used the index of the sets rather than a number range to represent the set, so
we are always working from 0...n. Note:</p>
<ol>
<li>Since combinations are unordered, {1,3,2} = {1,2,3} --we order them to be lexicographical.</li>
<li>This method has an implicit 0 to start the set for the first difference.</li>
</ol>
<h3>Index of Combinations in Lexicographical Order (McCaffrey)</h3>
<p>There is another way:, its concept is easier to grasp and program but it's
without the optimizations of Buckles. Fortunately, it also does not produce
duplicate combinations:</p>
<p>The set <img alt="x_k...x_1 in N" src="images/Txetz.gif"> that maximizes <img alt="i = C(x_1,k) +
C(x_2,k-1) + ... + C(x_k,1)" src="images/HOj5o.gif">, where <img alt="C(n,r) = {n
choose r}" src="images/vIeiI.gif">.</p>
<p>For an example: <code>27 = C(6,4) + C(5,3) + C(2,2) + C(1,1)</code>. So, the 27th
lexicographical combination of four things is: {1,2,5,6}, those are the
indexes of whatever set you want to look at. Example below (OCaml), requires
<code>choose</code> function, left to reader:</p>
<div class="code"><pre class="code literal-block"><span class="p">(</span><span class="o">*</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">find</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">[</span><span class="n">x</span><span class="o">]</span><span class="w"> </span><span class="n">combination</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">[</span><span class="n">set</span><span class="o">]</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="n">taking</span><span class="w"> </span><span class="o">[</span><span class="n">k</span><span class="o">]</span><span class="w"> </span><span class="n">elements</span><span class="w"> </span><span class="o">*</span><span class="p">)</span>
<span class="n">let</span><span class="w"> </span><span class="n">combination_maccaffery</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="p">(</span><span class="o">*</span><span class="w"> </span><span class="n">maximize</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="n">maximize</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">aCb</span><span class="w">              </span><span class="o">*</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="o">*</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">largest</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nf">choose</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">z</span><span class="w">        </span><span class="o">*</span><span class="p">)</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">rec</span><span class="w"> </span><span class="n">maximize</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nf">choose</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">maximize</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="n">x</span>
<span class="w">    </span><span class="ow">in</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">rec</span><span class="w"> </span><span class="k">iterate</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">with</span>
<span class="w">        </span><span class="o">|</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="err">[]</span>
<span class="w">        </span><span class="o">|</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">            </span><span class="n">let</span><span class="w"> </span><span class="nf">max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">maximize</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">in</span>
<span class="w">            </span><span class="nf">max</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="k">iterate</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="nf">choose</span><span class="w"> </span><span class="nf">max</span><span class="w"> </span><span class="n">i</span><span class="p">))</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="ow">in</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">failwith</span><span class="w"> </span><span class="ss">"errors"</span><span class="w"> </span><span class="k">else</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">idxs</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="k">iterate</span><span class="w"> </span><span class="p">(</span><span class="n">List</span><span class="p">.</span><span class="n">length</span><span class="w"> </span><span class="k">set</span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="ow">in</span>
<span class="w">    </span><span class="n">List</span><span class="p">.</span><span class="k">map</span><span class="w"> </span><span class="p">(</span><span class="n">List</span><span class="p">.</span><span class="n">nth</span><span class="w"> </span><span class="k">set</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">List</span><span class="p">.</span><span class="n">sort</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="p">)</span><span class="w"> </span><span class="n">idxs</span><span class="p">)</span>
</pre></div>

<h3>A small and simple combinations iterator</h3>
<p>The following two algorithms are provided for didactic purposes. They
implement an iterator and (a more general) folder overall combinations. They
are as fast as possible, having the complexity O(nCk). The memory consumption
is bound by <code>k</code>.</p>
<p>We will start with the iterator, which will call a user provided function for
each combination</p>
<div class="code"><pre class="code literal-block"><span class="nv">let</span><span class="w"> </span><span class="nv">iter_combs</span><span class="w"> </span><span class="nv">n</span><span class="w"> </span><span class="nv">k</span><span class="w"> </span><span class="nv">f</span><span class="w"> </span><span class="o">=</span>
<span class="w">  </span><span class="nv">let</span><span class="w"> </span><span class="nv">rec</span><span class="w"> </span><span class="nv">iter</span><span class="w"> </span><span class="nv">v</span><span class="w"> </span><span class="nv">s</span><span class="w"> </span><span class="nv">j</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nv">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">k</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="nv">f</span><span class="w"> </span><span class="nv">v</span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">s</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="nv">iter</span><span class="w"> </span><span class="ss">(</span><span class="nv">i</span>::<span class="nv">v</span><span class="ss">)</span><span class="w"> </span><span class="ss">(</span><span class="nv">i</span><span class="o">+</span><span class="mi">1</span><span class="ss">)</span><span class="w"> </span><span class="ss">(</span><span class="nv">j</span><span class="o">+</span><span class="mi">1</span><span class="ss">)</span><span class="w"> </span><span class="nv">done</span><span class="w"> </span><span class="nv">in</span>
<span class="w">  </span><span class="nv">iter</span><span class="w"> </span>[]<span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">0</span>
</pre></div>

<p>A more general version will call the user provided function along with the
state variable, starting from the initial state. Since we need to pass the
state between different states we won't use the for-loop, but instead, use
recursion,</p>
<div class="code"><pre class="code literal-block"><span class="nv">let</span><span class="w"> </span><span class="nv">fold_combs</span><span class="w"> </span><span class="nv">n</span><span class="w"> </span><span class="nv">k</span><span class="w"> </span><span class="nv">f</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span>
<span class="w">  </span><span class="nv">let</span><span class="w"> </span><span class="nv">rec</span><span class="w"> </span><span class="k">loop</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="nv">s</span><span class="w"> </span><span class="nv">c</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nv">n</span><span class="w"> </span><span class="k">then</span>
<span class="w">      </span><span class="k">loop</span><span class="w"> </span><span class="ss">(</span><span class="nv">i</span><span class="o">+</span><span class="mi">1</span><span class="ss">)</span><span class="w"> </span><span class="nv">s</span><span class="w"> </span><span class="nv">c</span><span class="w"> </span>@@
<span class="w">      </span><span class="nv">let</span><span class="w"> </span><span class="nv">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">i</span>::<span class="nv">c</span><span class="w"> </span><span class="nv">and</span><span class="w"> </span><span class="nv">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">s</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="nv">and</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="nv">in</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="nv">s</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nv">k</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">loop</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="nv">s</span><span class="w"> </span><span class="nv">c</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="nv">f</span><span class="w"> </span><span class="nv">c</span><span class="w"> </span><span class="nv">x</span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">in</span>
<span class="w">  </span><span class="k">loop</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span>[]<span class="w"> </span><span class="nv">x</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>In C#:</p>
<div class="code"><pre class="code literal-block"><span class="nv">public</span><span class="w"> </span><span class="nv">static</span><span class="w"> </span><span class="nv">IEnumerable</span><span class="o">&lt;</span><span class="nv">IEnumerable</span><span class="o">&lt;</span><span class="nv">T</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="nv">Combinations</span><span class="o">&lt;</span><span class="nv">T</span><span class="o">&gt;</span><span class="ss">(</span><span class="nv">this</span><span class="w"> </span><span class="nv">IEnumerable</span><span class="o">&lt;</span><span class="nv">T</span><span class="o">&gt;</span><span class="w"> </span><span class="nv">elements</span>,<span class="w"> </span><span class="nv">int</span><span class="w"> </span><span class="nv">k</span><span class="ss">)</span>
{
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nv">k</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span>?<span class="w"> </span><span class="nv">new</span>[]<span class="w"> </span>{<span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">T</span>[<span class="mi">0</span>]<span class="w"> </span>}<span class="w"> </span>:
<span class="w">    </span><span class="nv">elements</span>.<span class="nv">SelectMany</span><span class="ss">((</span><span class="nv">e</span>,<span class="w"> </span><span class="nv">i</span><span class="ss">)</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="w">      </span><span class="nv">elements</span>.<span class="nv">Skip</span><span class="ss">(</span><span class="nv">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="ss">)</span>.<span class="nv">Combinations</span><span class="ss">(</span><span class="nv">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="ss">)</span>.<span class="nv">Select</span><span class="ss">(</span><span class="nv">c</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="ss">(</span><span class="nv">new</span>[]<span class="w"> </span>{<span class="nv">e</span>}<span class="ss">)</span>.<span class="nv">Concat</span><span class="ss">(</span><span class="nv">c</span><span class="ss">)))</span><span class="c1">;</span>
}
</pre></div>

<p>Usage:</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Combinations</span><span class="p">(</span><span class="n">new</span><span class="p">[]</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
</pre></div>

<p>Result:</p>
<div class="code"><pre class="code literal-block"><span class="mf">123</span>
<span class="mf">124</span>
<span class="mf">125</span>
<span class="mf">134</span>
<span class="mf">135</span>
<span class="mf">145</span>
<span class="mf">234</span>
<span class="mf">235</span>
<span class="mf">245</span>
<span class="mf">345</span>
</pre></div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-978.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-976.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
