<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 1104) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-1104.html">
<link rel="prev" href="index-1105.html" type="text/html">
<link rel="next" href="index-1103.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/pyplot-san-dian-tu-biao-ji-da-xiao/" class="u-url">pyplot 散点图标记大小</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/pyplot-san-dian-tu-biao-ji-da-xiao/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T01:33:37+08:00" itemprop="datePublished" title="2023-02-18 01:33">2023-02-18 01:33</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>在散点图的 pyplot 文档中：</p>
<div class="code"><pre class="code literal-block">matplotlib.pyplot.scatter(x, y, s=20, c='b', marker='o', cmap=None, norm=None,
                          vmin=None, vmax=None, alpha=None, linewidths=None,
                          faceted=True, verts=None, hold=None, **kwargs)
</pre></div>

<p>标记尺寸</p>
<blockquote>
<p>s：以磅为单位的大小^2。它是一个标量或与 x 和 y 长度相同的数组。</p>
</blockquote>
<p>是什么样的单位<code>points^2</code>？这是什么意思？是什么<code>s=100</code>意思<code>10 pixel x 10 pixel</code>？</p>
<p>基本上我正在尝试制作具有不同标记大小的散点图，并且我想弄清楚数字的含义<code>s</code>。</p>
<p><br><br></p>
<h2>解答</h2>
<p>这种定义大小的方式可能有点令人困惑，但您基本上是在指定标记的 <em>区域。</em> 这意味着，要将标记的宽度（或高度）加倍，您需要增加<code>s</code>4 倍。[因为 A = W
<em>H = &gt; (2W)</em> (2H)=4A]</p>
<p>然而，以这种方式定义标记的大小是有原因的。由于面积按宽度的平方缩放，因此将宽度加倍实际上会使尺寸增加超过 2 倍（实际上它增加了 4
倍）。要了解这一点，请考虑以下两个示例及其产生的输出。</p>
<div class="code"><pre class="code literal-block">#<span class="w"> </span><span class="nv">doubling</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">width</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">markers</span>
<span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>[<span class="mi">0</span>,<span class="mi">2</span>,<span class="mi">4</span>,<span class="mi">6</span>,<span class="mi">8</span>,<span class="mi">10</span>]
<span class="nv">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>[<span class="mi">0</span>]<span class="o">*</span><span class="nv">len</span><span class="ss">(</span><span class="nv">x</span><span class="ss">)</span>
<span class="nv">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>[<span class="mi">20</span><span class="o">*</span><span class="mi">4</span><span class="o">**</span><span class="nv">n</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">n</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">range</span><span class="ss">(</span><span class="nv">len</span><span class="ss">(</span><span class="nv">x</span><span class="ss">))</span>]
<span class="nv">plt</span>.<span class="nv">scatter</span><span class="ss">(</span><span class="nv">x</span>,<span class="nv">y</span>,<span class="nv">s</span><span class="o">=</span><span class="nv">s</span><span class="ss">)</span>
<span class="nv">plt</span>.<span class="k">show</span><span class="ss">()</span>
</pre></div>

<p>给</p>
<p><img alt="在此处输入图像描述" src="images/m8xcU.png"></p>
<p>请注意大小如何快速增加。相反，如果我们有</p>
<div class="code"><pre class="code literal-block">#<span class="w"> </span><span class="nv">doubling</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">area</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">markers</span>
<span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>[<span class="mi">0</span>,<span class="mi">2</span>,<span class="mi">4</span>,<span class="mi">6</span>,<span class="mi">8</span>,<span class="mi">10</span>]
<span class="nv">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>[<span class="mi">0</span>]<span class="o">*</span><span class="nv">len</span><span class="ss">(</span><span class="nv">x</span><span class="ss">)</span>
<span class="nv">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>[<span class="mi">20</span><span class="o">*</span><span class="mi">2</span><span class="o">**</span><span class="nv">n</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">n</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">range</span><span class="ss">(</span><span class="nv">len</span><span class="ss">(</span><span class="nv">x</span><span class="ss">))</span>]
<span class="nv">plt</span>.<span class="nv">scatter</span><span class="ss">(</span><span class="nv">x</span>,<span class="nv">y</span>,<span class="nv">s</span><span class="o">=</span><span class="nv">s</span><span class="ss">)</span>
<span class="nv">plt</span>.<span class="k">show</span><span class="ss">()</span>
</pre></div>

<p>给</p>
<p><img alt="在此处输入图像描述" src="images/Znaw8.png"></p>
<p>现在标记的表观大小以直观的方式大致线性增加。</p>
<p>至于“点”的确切含义，对于绘图目的来说是相当随意的，您可以按常数缩放所有尺寸，直到它们看起来合理为止。</p>
<p><strong>编辑：（</strong> 回应@Emma 的评论）</p>
<p>对我而言，这可能是令人困惑的措辞。问题是关于将圆的宽度加倍，所以在每个圆的第一张图片中（当我们从左向右移动时）它的宽度是前一个的两倍所以对于该区域来说这是一个以
4 为底的指数。类似地第二个例子每个圆圈的 <em>面积</em> 是最后一个圆圈的两倍，最后一个圆圈给出以 2 为底的指数。</p>
<p>然而，在第二个示例（我们正在缩放区域）中，加倍区域似乎使圆圈在眼睛看来大了一倍。因此，如果我们想让一个圆看起来更大，<code>n</code>我们会增加面积而<code>n</code>不是半径，所以表观尺寸与面积成线性比例。</p>
<p><strong>编辑</strong> 以可视化@TomaszGandor 的评论：</p>
<p>这是标记大小的不同功能的样子：</p>
<p><img alt="指数、平方或线性大小" src="images/3H1BQ.png"></p>
<div class="code"><pre class="code literal-block"><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>[<span class="mi">0</span>,<span class="mi">2</span>,<span class="mi">4</span>,<span class="mi">6</span>,<span class="mi">8</span>,<span class="mi">10</span>,<span class="mi">12</span>,<span class="mi">14</span>,<span class="mi">16</span>,<span class="mi">18</span>]
<span class="nv">s_exp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>[<span class="mi">20</span><span class="o">*</span><span class="mi">2</span><span class="o">**</span><span class="nv">n</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">n</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">range</span><span class="ss">(</span><span class="nv">len</span><span class="ss">(</span><span class="nv">x</span><span class="ss">))</span>]
<span class="nv">s_square</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>[<span class="mi">20</span><span class="o">*</span><span class="nv">n</span><span class="o">**</span><span class="mi">2</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">n</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">range</span><span class="ss">(</span><span class="nv">len</span><span class="ss">(</span><span class="nv">x</span><span class="ss">))</span>]
<span class="nv">s_linear</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>[<span class="mi">20</span><span class="o">*</span><span class="nv">n</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">n</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">range</span><span class="ss">(</span><span class="nv">len</span><span class="ss">(</span><span class="nv">x</span><span class="ss">))</span>]
<span class="nv">plt</span>.<span class="nv">scatter</span><span class="ss">(</span><span class="nv">x</span>,[<span class="mi">1</span>]<span class="o">*</span><span class="nv">len</span><span class="ss">(</span><span class="nv">x</span><span class="ss">)</span>,<span class="nv">s</span><span class="o">=</span><span class="nv">s_exp</span>,<span class="w"> </span><span class="nv">label</span><span class="o">=</span><span class="s1">'$s=2^n$'</span>,<span class="w"> </span><span class="nv">lw</span><span class="o">=</span><span class="mi">1</span><span class="ss">)</span>
<span class="nv">plt</span>.<span class="nv">scatter</span><span class="ss">(</span><span class="nv">x</span>,[<span class="mi">0</span>]<span class="o">*</span><span class="nv">len</span><span class="ss">(</span><span class="nv">x</span><span class="ss">)</span>,<span class="nv">s</span><span class="o">=</span><span class="nv">s_square</span>,<span class="w"> </span><span class="nv">label</span><span class="o">=</span><span class="s1">'$s=n^2$'</span><span class="ss">)</span>
<span class="nv">plt</span>.<span class="nv">scatter</span><span class="ss">(</span><span class="nv">x</span>,[<span class="o">-</span><span class="mi">1</span>]<span class="o">*</span><span class="nv">len</span><span class="ss">(</span><span class="nv">x</span><span class="ss">)</span>,<span class="nv">s</span><span class="o">=</span><span class="nv">s_linear</span>,<span class="w"> </span><span class="nv">label</span><span class="o">=</span><span class="s1">'$s=n$'</span><span class="ss">)</span>
<span class="nv">plt</span>.<span class="nv">ylim</span><span class="ss">(</span><span class="o">-</span><span class="mi">1</span>.<span class="mi">5</span>,<span class="mi">1</span>.<span class="mi">5</span><span class="ss">)</span>
<span class="nv">plt</span>.<span class="nv">legend</span><span class="ss">(</span><span class="nv">loc</span><span class="o">=</span><span class="s1">'center left'</span>,<span class="w"> </span><span class="nv">bbox_to_anchor</span><span class="o">=</span><span class="ss">(</span><span class="mi">1</span>.<span class="mi">1</span>,<span class="w"> </span><span class="mi">0</span>.<span class="mi">5</span><span class="ss">)</span>,<span class="w"> </span><span class="nv">labelspacing</span><span class="o">=</span><span class="mi">3</span><span class="ss">)</span>
<span class="nv">plt</span>.<span class="k">show</span><span class="ss">()</span>
</pre></div>

<p><br></p>
<h3>更多建议</h3>
<p><em>因为这里的其他答案声称<code>s</code>表示标记的区域，所以我添加这个答案以澄清情况不一定如此。</em></p>
<h4>以磅为单位的大小^2</h4>
<p><code>s</code>中的参数<code>plt.scatter</code>表示<code>markersize**2</code>. 正如文档所说</p>
<blockquote>
<p><code>s</code>：标量或类数组，形状 (n, )，可选<br>
大小（以点 ^2 为单位）。默认为 rcParams['lines.markersize'] ** 2。</p>
</blockquote>
<p>这可以从字面上理解。为了获得 x 点大的标记，您需要将该数字平方并将其提供给参数<code>s</code>。</p>
<p>因此，线图的标记大小与散点大小参数之间的关系是平方。为了生成与大小为 10 点的绘图标记相同大小的散点标记，您将因此调用<code>scatter( ..,
s=100)</code>.</p>
<p><img alt="在此处输入图像描述" src="images/vxlWd.png"></p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s2">"o"</span><span class="p">,</span>  <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.07</span><span class="p">,</span><span class="mf">0.93</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>    <span class="n">linewidth</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">],</span>           <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s2">"o"</span><span class="p">,</span>  <span class="n">markersize</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.14</span><span class="p">,</span><span class="mf">0.86</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>    <span class="n">linewidth</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">],</span>           <span class="n">s</span><span class="o">=</span><span class="mi">22</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

<h4>连接到“区域”</h4>
<p>那么为什么其他答案甚至文档在谈到参数时都谈到“区域”呢<code>s</code>？</p>
<p>当然点**2的单位是面积单位。</p>
<ul>
<li>对于方形标记的特殊情况，<code>marker="s"</code>标记的面积确实直接就是<code>s</code>参数的值。</li>
<li>对于圆，圆的面积是<code>area = pi/4*s</code>。</li>
<li>对于其他标记，甚至可能与标记区域没有任何明显关系。</li>
</ul>
<p><img alt="在此处输入图像描述" src="images/RcDoA.png"></p>
<p><strong>然而在所有情况下，标记的面积都与<code>s</code>参数</strong>成正比。这就是将其称为“区域”的动机，尽管在大多数情况下并非如此。</p>
<p>根据与标记面积成比例的某个数量来指定散布标记的大小，在目前为止是有意义的，因为在比较不同的斑块时，感知的是标记的面积，而不是其边长或直径。即，将基础数量加倍应该使标记的面积加倍。</p>
<p><img alt="在此处输入图像描述" src="images/HanbD.png"></p>
<h4>什么是积分？</h4>
<p>到目前为止，散点标记的大小意味着什么的答案是以点为单位给出的。点常用于排版中，其中字体以点为单位指定。线宽通常以点为单位指定。matplotlib
中点的标准大小是每英寸 72 点 (ppi) - 因此 1 点是 1/72 英寸。</p>
<p>能够以像素而不是点为单位指定大小可能很有用。如果图形dpi也是72，那么一个点就是一个像素。如果图形 dpi 不同（matplotlib
默认为<code>fig.dpi=100</code>），</p>
<div class="code"><pre class="code literal-block"><span class="mf">1</span><span class="w"> </span><span class="n">point</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">fig</span><span class="mf">.</span><span class="n">dpi</span><span class="o">/</span><span class="mf">72.</span><span class="w"> </span><span class="n">pixels</span>
</pre></div>

<p>虽然散点标记的点大小因此对于不同的图形 dpi 看起来不同，但可以生成 10 x 10 像素 ^ 2 标记，它始终覆盖相同数量的像素：</p>
<p><img alt="在此处输入图像描述" src="images/SHlDG.png"><img alt="在此处输入图像描述" src="images/EfEmQ.png"><img alt="在此处输入图像描述" src="images/tO2zx.png"></p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="k">for</span> <span class="n">dpi</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">72</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">144</span><span class="p">]:</span>

    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"fig.dpi=</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dpi</span><span class="p">))</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> 
               <span class="n">marker</span><span class="o">=</span><span class="s2">"s"</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"100 points^2"</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="mf">72.</span><span class="o">/</span><span class="n">fig</span><span class="o">.</span><span class="n">dpi</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> 
               <span class="n">marker</span><span class="o">=</span><span class="s2">"s"</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"100 pixels^2"</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">framealpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">"fig</span><span class="si">{}</span><span class="s2">.png"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dpi</span><span class="p">),</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">"tight"</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

<hr>
<p>如果您对数据单位的分散感兴趣，请查看此答案。</p>
<p><br><br><a href="posts/pyplot-scatter-plot-marker-size/">查看原文</a></p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/he-bing-ya-suo-lai-zi-ling-yi-ge-fen-zhi-de-suo-you-geng-gai-zuo-wei-dan-ge-ti-jiao/" class="u-url">合并（压缩）来自另一个分支的所有更改作为单个提交</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/he-bing-ya-suo-lai-zi-ling-yi-ge-fen-zhi-de-suo-you-geng-gai-zuo-wei-dan-ge-ti-jiao/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T01:33:08+08:00" itemprop="datePublished" title="2023-02-18 01:33">2023-02-18 01:33</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>在 Git 中，有没有一种方法可以将一个分支的所有更改合并到另一个分支，但同时压缩为单个提交？</p>
<p>我经常在一个单独的分支中开发新功能，并且会定期提交/推送——主要用于备份或将我正在开发的内容转移到另一台机器上。大多数情况下，这些提交会说“Feature
xxx WIP”或一些多余的东西。</p>
<p>一旦该工作完成并且我想将 WIP 分支合并回 master，我想放弃所有这些中间提交，并且只有一个干净的提交。</p>
<p>是否有捷径可寻？</p>
<p>或者，一个压缩分支上自分支点以来的所有提交的命令怎么样？</p>
<p><br><br></p>
<h2>解答</h2>
<p>另一种选择是<code>git merge --squash &lt;feature branch&gt;</code>最后做一个<code>git commit</code>.</p>
<p>从Git 合并</p>
<blockquote>
<p><code>--squash</code></p>
<p><code>--no-squash</code></p>
<p>生成工作树和索引状态，就好像发生了真正的合并（合并信息除外），但实际上不进行提交或移动
,<code>HEAD</code>也不记录<code>$GIT_DIR/MERGE_HEAD</code>以导致下一个<code>git
commit</code>命令创建合并提交。这允许您在当前分支之上创建单个提交，其效果与合并另一个分支相同（或者在章鱼的情况下更多）。</p>
</blockquote>
<p><br></p>
<h3>更多建议</h3>
<p>找到了！合并命令有一个<code>--squash</code>选项</p>
<div class="code"><pre class="code literal-block">git checkout master
git merge --squash WIP
</pre></div>

<p>此时一切都已合并，可能存在冲突，但未提交。所以我现在可以：</p>
<div class="code"><pre class="code literal-block">git add .
# git add -u  # might be preferable, see below
git commit -m "Merged WIP"
</pre></div>

<p><br><br><a href="posts/merge-with-squash-all-changes-from-another-branch-as-a-single-commit/">查看原文</a></p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/shi-yao-shi-mei-ju-ta-men-wei-shi-yao-you-yong/" class="u-url">什么是枚举，它们为什么有用？</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/shi-yao-shi-mei-ju-ta-men-wei-shi-yao-you-yong/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T01:32:39+08:00" itemprop="datePublished" title="2023-02-18 01:32">2023-02-18 01:32</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>今天，我浏览了该站点上的一些问题，发现有人提到<code>enum</code> 在单例模式中使用了这种解决方案的线程安全优势。</p>
<p>我从未使用过<code>enum</code>s，现在我已经使用 Java 编程多年了。显然，他们改变了很多。现在他们甚至在自己内部全面支持 OOP。</p>
<h4>现在为什么以及我应该在日常编程中使用枚举？</h4>
<p><br><br></p>
<h2>解答</h2>
<p>当变量（尤其是方法参数）只能从一小组可能值中取一个时，您应该始终使用枚举。例如类型常量（合同状态：“永久”、“临时”、“学徒”）或标志（“立即执行”、“延迟执行”）。</p>
<p>如果您使用枚举而不是整数（或字符串代码），您会增加编译时检查并避免因传递无效常量而导致的错误，并且您会记录哪些值可以合法使用。</p>
<p>顺便说一句，过度使用枚举可能意味着你的方法做的太多（最好有几个单独的方法，而不是一个方法采用多个标志来修改它的作用），但是如果你必须使用标志或类型代码，枚举是要走的路。</p>
<p>举个例子，哪个更好？</p>
<div class="code"><pre class="code literal-block"><span class="o">/**</span><span class="w"> </span><span class="n">Counts</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">foobangs</span><span class="p">.</span>
<span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">@</span><span class="n">param</span><span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="n">Type</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">foobangs</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">count</span><span class="p">.</span><span class="w"> </span><span class="n">Can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="mi">1</span><span class="p">=</span><span class="n">green</span><span class="w"> </span><span class="n">foobangs</span><span class="p">,</span>
<span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">=</span><span class="n">wrinkled</span><span class="w"> </span><span class="n">foobangs</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">=</span><span class="n">sweet</span><span class="w"> </span><span class="n">foobangs</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">=</span><span class="n">all</span><span class="w"> </span><span class="n">types</span><span class="p">.</span>
<span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">@</span><span class="k">return</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">foobangs</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nb">type</span>
<span class="w"> </span><span class="o">*/</span>
<span class="n">public</span><span class="w"> </span><span class="nb">int</span><span class="w"> </span><span class="n">countFoobangs</span><span class="p">(</span><span class="nb">int</span><span class="w"> </span><span class="nb">type</span><span class="p">)</span>
</pre></div>

<p>相对</p>
<div class="code"><pre class="code literal-block"><span class="o">/**</span><span class="w"> </span><span class="n">Types</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">foobangs</span><span class="o">.</span><span class="w"> </span><span class="o">*/</span>
<span class="n">public</span><span class="w"> </span><span class="k">enum</span><span class="w"> </span><span class="n">FB_TYPE</span><span class="w"> </span><span class="p">{</span>
<span class="w"> </span><span class="n">GREEN</span><span class="p">,</span><span class="w"> </span><span class="n">WRINKLED</span><span class="p">,</span><span class="w"> </span><span class="n">SWEET</span><span class="p">,</span><span class="w"> </span>
<span class="w"> </span><span class="o">/**</span><span class="w"> </span><span class="n">special</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">types</span><span class="w"> </span><span class="n">combined</span><span class="w"> </span><span class="o">*/</span>
<span class="w"> </span><span class="n">ALL</span><span class="p">;</span>
<span class="p">}</span>

<span class="o">/**</span><span class="w"> </span><span class="n">Counts</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">foobangs</span><span class="o">.</span>
<span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="err">@</span><span class="n">param</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">Type</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">foobangs</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">count</span>
<span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="err">@</span><span class="k">return</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">foobangs</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">type</span>
<span class="w"> </span><span class="o">*/</span>
<span class="n">public</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">countFoobangs</span><span class="p">(</span><span class="n">FB_TYPE</span><span class="w"> </span><span class="n">type</span><span class="p">)</span>
</pre></div>

<p>方法调用如下：</p>
<div class="code"><pre class="code literal-block">int sweetFoobangCount = countFoobangs(3);
</pre></div>

<p>然后变成：</p>
<div class="code"><pre class="code literal-block">int sweetFoobangCount = countFoobangs(FB_TYPE.SWEET);
</pre></div>

<hr>
<p>在第二个示例中，可以立即清楚哪些类型是允许的，文档和实现不能不同步，并且编译器可以强制执行此操作。另外，无效的调用如</p>
<div class="code"><pre class="code literal-block">int sweetFoobangCount = countFoobangs(99);
</pre></div>

<p>不再可能。</p>
<p><br></p>
<h3>更多建议</h3>
<p>为什么要使用任何编程语言功能？我们拥有语言的原因是</p>
<ol>
<li>程序员以计算机可以使用的形式有效和 <em>正确地表达算法。</em>
</li>
<li>维护者理解其他人编写的算法并 <em>正确地</em> 进行更改。</li>
</ol>
<p>枚举提高了正确性和可读性的可能性，而无需编写大量样板。如果您愿意编写样板文件，那么您可以“模拟”枚举：</p>
<div class="code"><pre class="code literal-block">public class Color {
    private Color() {} // Prevent others from making colors.
    public static final Color RED = new Color();
    public static final Color AMBER = new Color();
    public static final Color GREEN = new Color();
}
</pre></div>

<p>现在你可以写：</p>
<div class="code"><pre class="code literal-block">Color trafficLightColor = Color.RED;
</pre></div>

<p>上面的样板与</p>
<div class="code"><pre class="code literal-block"><span class="n">public</span><span class="w"> </span><span class="k">enum</span><span class="w"> </span><span class="nb nb-Type">Color</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">RED</span><span class="p">,</span><span class="w"> </span><span class="n">AMBER</span><span class="p">,</span><span class="w"> </span><span class="n">GREEN</span><span class="w"> </span><span class="p">};</span>
</pre></div>

<p>两者都提供来自编译器的相同级别的检查帮助。样板只是更多的打字。但是节省大量的输入可以让程序员更有 <em>效率</em> （见 1），所以这是一个有价值的特性。</p>
<p>至少还有一个原因是值得的：</p>
<p><strong>开关语句</strong></p>
<p><code>static final</code>上面的枚举模拟 <em>没有</em> 给你的一件事是很好的<code>switch</code>案例。对于枚举类型，Java
开关使用其变量的类型来推断枚举案例的范围，因此对于上面<code>enum Color</code>你只需要说：</p>
<div class="code"><pre class="code literal-block"><span class="nt">Color</span><span class="w"> </span><span class="nt">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">...</span><span class="w"> </span><span class="o">;</span>
<span class="nt">switch</span><span class="w"> </span><span class="o">(</span><span class="nt">color</span><span class="o">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="err">case</span><span class="w"> </span><span class="n">RED</span><span class="p">:</span>
<span class="w">        </span><span class="o">...</span>
<span class="w">        </span><span class="n">break</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<p>请注意，它不在<code>Color.RED</code>案例中。如果您不使用枚举，则使用命名数量的唯一方法<code>switch</code>是：</p>
<div class="code"><pre class="code literal-block">public Class Color {
    public static final int RED = 0;
    public static final int AMBER = 1;
    public static final int GREEN = 2;
}
</pre></div>

<p>但是现在保存颜色的变量必须有类型<code>int</code>。枚举和<code>static final</code>模拟的良好编译器检查消失了。不开心。</p>
<p>折衷方案是在模拟中使用标量值成员：</p>
<div class="code"><pre class="code literal-block">public class Color {
    public static final int RED_TAG = 1;
    public static final int AMBER_TAG = 2;
    public static final int GREEN_TAG = 3;

    public final int tag;

    private Color(int tag) { this.tag = tag; } 
    public static final Color RED = new Color(RED_TAG);
    public static final Color AMBER = new Color(AMBER_TAG);
    public static final Color GREEN = new Color(GREEN_TAG);
}
</pre></div>

<p>现在：</p>
<div class="code"><pre class="code literal-block"><span class="nt">Color</span><span class="w"> </span><span class="nt">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">...</span><span class="w"> </span><span class="o">;</span>
<span class="nt">switch</span><span class="w"> </span><span class="o">(</span><span class="nt">color</span><span class="p">.</span><span class="nc">tag</span><span class="o">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="err">case</span><span class="w"> </span><span class="err">Color.</span><span class="n">RED_TAG</span><span class="p">:</span>
<span class="w">        </span><span class="o">...</span>
<span class="w">        </span><span class="n">break</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<p>但请注意，还有更多样板文件！</p>
<p><strong>使用枚举作为单例</strong></p>
<p>从上面的样板文件中，您可以看出为什么枚举提供了一种实现单例的方法。而不是写：</p>
<div class="code"><pre class="code literal-block"><span class="nv">public</span><span class="w"> </span><span class="nv">class</span><span class="w"> </span><span class="nv">SingletonClass</span><span class="w"> </span>{
<span class="w">    </span><span class="nv">public</span><span class="w"> </span><span class="nv">static</span><span class="w"> </span><span class="nv">final</span><span class="w"> </span><span class="nv">void</span><span class="w"> </span><span class="nv">INSTANCE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">SingletonClass</span><span class="ss">()</span><span class="c1">;</span>
<span class="w">    </span><span class="nv">private</span><span class="w"> </span><span class="nv">SingletonClass</span><span class="ss">()</span><span class="w"> </span>{}

<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="nv">all</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">methods</span><span class="w"> </span><span class="nv">and</span><span class="w"> </span><span class="nv">instance</span><span class="w"> </span><span class="nv">data</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">class</span><span class="w"> </span><span class="nv">here</span>
}
</pre></div>

<p>然后访问它</p>
<div class="code"><pre class="code literal-block">SingletonClass.INSTANCE
</pre></div>

<p>我们只能说</p>
<div class="code"><pre class="code literal-block"><span class="n">public</span><span class="w"> </span><span class="k">enum</span><span class="w"> </span><span class="n">SingletonClass</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">INSTANCE</span><span class="p">;</span>

<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">methods</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">instance</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">here</span>
<span class="p">}</span>
</pre></div>

<p>这给了我们同样的东西。我们可以避开这个问题，因为 Java 枚举 <em>是</em>
作为完整的类实现的，只是在顶部撒了一点语法糖。这又是一个较少的样板文件，但除非您熟悉这个成语，否则它并不明显。我也不喜欢这样一个事实，即你得到了各种枚举函数，即使它们对单例没有多大意义：<code>ord</code>和<code>values</code>等。<code>Color
extends Integer</code>清楚地表明为什么<code>enum</code>是一个更好的主意。）</p>
<p><strong>线程安全</strong></p>
<p>只有在没有锁定的情况下懒惰地创建单例时，线程安全才是一个潜在的问题。</p>
<div class="code"><pre class="code literal-block"><span class="nv">public</span><span class="w"> </span><span class="nv">class</span><span class="w"> </span><span class="nv">SingletonClass</span><span class="w"> </span>{
<span class="w">    </span><span class="nv">private</span><span class="w"> </span><span class="nv">static</span><span class="w"> </span><span class="nv">SingletonClass</span><span class="w"> </span><span class="nv">INSTANCE</span><span class="c1">;</span>
<span class="w">    </span><span class="nv">private</span><span class="w"> </span><span class="nv">SingletonClass</span><span class="ss">()</span><span class="w"> </span>{}
<span class="w">    </span><span class="nv">public</span><span class="w"> </span><span class="nv">SingletonClass</span><span class="w"> </span><span class="nv">getInstance</span><span class="ss">()</span><span class="w"> </span>{
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">INSTANCE</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nv">null</span><span class="ss">)</span><span class="w"> </span><span class="nv">INSTANCE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">SingletonClass</span><span class="ss">()</span><span class="c1">;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nv">INSTANCE</span><span class="c1">;</span>
<span class="w">    </span>}

<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="nv">all</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">methods</span><span class="w"> </span><span class="nv">and</span><span class="w"> </span><span class="nv">instance</span><span class="w"> </span><span class="nv">data</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">class</span><span class="w"> </span><span class="nv">here</span>
}
</pre></div>

<p>如果许多线程<code>getInstance</code>同时调用，而<code>INSTANCE</code>仍然是
null，则可以创建任意数量的实例。这不好。唯一的解决方案是添加<code>synchronized</code>访问权限以保护变量<code>INSTANCE</code>。</p>
<p>但是，<code>static final</code>上面的代码没有这个问题。它在类加载时急切地创建实例。类加载是同步的。</p>
<p>单<code>enum</code>例实际上是惰性的，因为它直到第一次使用才被初始化。Java 初始化也是同步的，所以多个线程不能初始化多个<code>INSTANCE</code>.
您将获得一个代码很少的惰性初始化单例。唯一的缺点是相当晦涩的语法。您需要知道这个惯用语或彻底了解类加载和初始化的工作原理才能知道发生了什么。</p>
<p><br><br><a href="posts/what-are-enums-and-why-are-they-useful/">查看原文</a></p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-1105.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-1103.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
