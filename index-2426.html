<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 2426) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-2426.html">
<link rel="prev" href="index-2427.html" type="text/html">
<link rel="next" href="index-2425.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/pass-variables-by-reference-in-javascript/" class="u-url">Pass variables by reference in JavaScript</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/pass-variables-by-reference-in-javascript/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T15:15:30+08:00" itemprop="datePublished" title="2023-03-04 15:15">2023-03-04 15:15</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>How do I pass variables by reference in JavaScript?</p>
<p>I have three variables that I want to perform several operations to, so I want
to put them in a for loop and perform the operations to each one.</p>
<p>Pseudocode:</p>
<div class="code"><pre class="code literal-block"><span class="n">myArray</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="k">Array</span><span class="p">(</span><span class="n">var1</span><span class="p">,</span><span class="w"> </span><span class="n">var2</span><span class="p">,</span><span class="w"> </span><span class="n">var3</span><span class="p">);</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nf">var</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">myArray</span><span class="p">.</span><span class="n">length</span><span class="p">;</span><span class="w"> </span><span class="n">x</span><span class="o">++</span><span class="p">)</span><span class="err">{</span>
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="n">Do</span><span class="w"> </span><span class="nf">stuff</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">array</span>
<span class="w">    </span><span class="n">makePretty</span><span class="p">(</span><span class="n">myArray</span><span class="o">[</span><span class="n">x</span><span class="o">]</span><span class="p">);</span>
<span class="err">}</span>
<span class="o">//</span><span class="w"> </span><span class="n">Now</span><span class="w"> </span><span class="n">do</span><span class="w"> </span><span class="nf">stuff</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">updated</span><span class="w"> </span><span class="n">variables</span>
</pre></div>

<p>What is the best way to do this?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>There is no "pass by reference" available in JavaScript. You can pass an
object (which is to say, you can pass-by-value a reference to an object) and
then have a function modify the object contents:</p>
<div class="code"><pre class="code literal-block"><span class="n">function</span><span class="w"> </span><span class="n">alterObject</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">obj</span><span class="o">.</span><span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"goodbye"</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">var</span><span class="w"> </span><span class="n">myObj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">foo</span><span class="p">:</span><span class="w"> </span><span class="s2">"hello world"</span><span class="w"> </span><span class="p">};</span>

<span class="n">alterObject</span><span class="p">(</span><span class="n">myObj</span><span class="p">);</span>

<span class="n">alert</span><span class="p">(</span><span class="n">myObj</span><span class="o">.</span><span class="n">foo</span><span class="p">);</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">"goodbye"</span><span class="w"> </span><span class="n">instead</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="s2">"hello world"</span>
</pre></div>

<p>You can iterate over the properties of an array with a numeric index and
modify each cell of the array, if you want.</p>
<div class="code"><pre class="code literal-block"><span class="nf">var</span><span class="w"> </span><span class="n">arr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">1, 2, 3</span><span class="o">]</span><span class="p">;</span>

<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nf">var</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">arr</span><span class="p">.</span><span class="n">length</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="err">{</span><span class="w"> </span>
<span class="w">    </span><span class="n">arr</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">arr</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span>
<span class="err">}</span>
</pre></div>

<p>It's important to note that "pass-by-reference" is a very specific term. It
does not mean simply that it's possible to pass a reference to a modifiable
object. Instead, it means that it's possible to pass a simple variable in such
a way as to allow a function to modify that value in the <strong>calling</strong> context.
So:</p>
<div class="code"><pre class="code literal-block"><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">swap</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="k">var</span><span class="w"> </span><span class="n">tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">;</span>
<span class="w">   </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="w">   </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tmp</span><span class="p">;</span><span class="w"> </span><span class="o">//</span><span class="n">assign</span><span class="w"> </span><span class="n">tmp</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">b</span>
<span class="w"> </span><span class="p">}</span>

<span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w"> </span><span class="n">swap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">);</span>

<span class="w"> </span><span class="n">alert</span><span class="p">(</span><span class="s2">"x is "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">", y is "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="p">);</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s2">"x is 1, y is 2"</span>
</pre></div>

<p>In a language like C++, it's possible to do that because that language
<strong>does</strong> (sort-of) have pass-by-reference.</p>
<p><em>edit</em> — this recently (March 2015) blew up on Reddit again over a blog post
similar to mine mentioned below, though in this case about Java. It occurred
to me while reading the back-and-forth in the Reddit comments that a big part
of the confusion stems from the unfortunate collision involving the word
"reference". The terminology "pass by reference" and "pass by value" predates
the concept of having "objects" to work with in programming languages. It's
really not about objects at all; it's about function parameters, and
specifically how function parameters are "connected" (or not) to the calling
environment. In particular, note that in a true pass-by-reference language —
one that <em>does</em> involve objects — one would still have the ability to modify
object <em>contents</em> , and it would look pretty much exactly like it does in
JavaScript. However, one would <em>also</em> be able to modify the object reference
in the calling environment, and that's the key thing that you <em>can't</em> do in
JavaScript. A pass-by-reference language would pass not the reference itself,
but a <em>reference to the reference</em>.</p>
<p><em>edit</em> — here is a blog post on the topic. (Note the comment to that post that
explains that C++ doesn't really have pass-by-reference. That is true. What
C++ does have, however, is the ability to create references to plain
variables, either explicitly at the point of function invocation to create a
pointer, or <em>implicitly</em> when calling functions whose argument type signature
calls for that to be done. Those are the key things JavaScript doesn't
support.)</p>
<p><br></p>
<h3>Suggest</h3>
<ol>
<li>Primitive type variables like strings and numbers are always passed by value.</li>
<li>
<p>Arrays and Objects are passed by reference or by value based on these conditions:</p>
</li>
<li>
<p>if you are setting the value of an object or array it is Pass by Value.</p>
<div class="code"><pre class="code literal-block"><span class="w"> </span><span class="nt">object1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">prop</span><span class="p">:</span><span class="w"> </span><span class="s2">"car"</span><span class="w"> </span><span class="p">}</span><span class="o">;</span>
</pre></div>

<p>array1 = [1,2,3];</p>
</li>
<li>
<p>if you are changing a property value of an object or array then it is Pass by Reference.</p>
<div class="code"><pre class="code literal-block"> object1.prop = "car";
</pre></div>

<p>array1[0] = 9;</p>
</li>
</ol>
<p><strong>Code</strong></p>
<div class="code"><pre class="code literal-block"><span class="n">function</span><span class="w"> </span><span class="n">passVar</span><span class="p">(</span><span class="n">obj1</span><span class="p">,</span><span class="w"> </span><span class="n">obj2</span><span class="p">,</span><span class="w"> </span><span class="n">num</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">obj1</span><span class="o">.</span><span class="n">prop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"laptop"</span><span class="p">;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">CHANGE</span><span class="w"> </span><span class="n">original</span>
<span class="w">    </span><span class="n">obj2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">prop</span><span class="p">:</span><span class="w"> </span><span class="s2">"computer"</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="o">//</span><span class="n">will</span><span class="w"> </span><span class="n">NOT</span><span class="w"> </span><span class="n">affect</span><span class="w"> </span><span class="n">original</span>
<span class="w">    </span><span class="n">num</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">num</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">NOT</span><span class="w"> </span><span class="n">affect</span><span class="w"> </span><span class="n">original</span>
<span class="p">}</span>

<span class="k">var</span><span class="w"> </span><span class="n">object1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">prop</span><span class="p">:</span><span class="w"> </span><span class="s2">"car"</span>
<span class="p">};</span>
<span class="k">var</span><span class="w"> </span><span class="n">object2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">prop</span><span class="p">:</span><span class="w"> </span><span class="s2">"bike"</span>
<span class="p">};</span>
<span class="k">var</span><span class="w"> </span><span class="n">number1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>

<span class="n">passVar</span><span class="p">(</span><span class="n">object1</span><span class="p">,</span><span class="w"> </span><span class="n">object2</span><span class="p">,</span><span class="w"> </span><span class="n">number1</span><span class="p">);</span>
<span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">object1</span><span class="p">);</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">output</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">Object</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">prop</span><span class="p">:</span><span class="w"> </span><span class="s2">"laptop"</span><span class="w"> </span><span class="p">}</span>
<span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">object2</span><span class="p">);</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">output</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">Object</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">prop</span><span class="p">:</span><span class="w"> </span><span class="s2">"bike"</span><span class="w"> </span><span class="p">}</span>
<span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">number1</span><span class="p">);</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">ouput</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/sql-server-insert-if-not-exists/" class="u-url">SQL Server Insert if not exists</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/sql-server-insert-if-not-exists/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T15:14:03+08:00" itemprop="datePublished" title="2023-03-04 15:14">2023-03-04 15:14</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I want to insert data into my table, but insert only data that doesn't already
exist in my database.</p>
<p>Here is my code:</p>
<div class="code"><pre class="code literal-block"><span class="k">ALTER</span><span class="w"> </span><span class="k">PROCEDURE</span><span class="w"> </span><span class="o">[</span><span class="n">dbo</span><span class="o">]</span><span class="p">.</span><span class="o">[</span><span class="n">EmailsRecebidosInsert</span><span class="o">]</span>
<span class="w">  </span><span class="p">(</span><span class="nv">@_DE</span><span class="w"> </span><span class="nc">nvarchar</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
<span class="w">   </span><span class="nv">@_ASSUNTO</span><span class="w"> </span><span class="nc">nvarchar</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
<span class="w">   </span><span class="nv">@_DATA</span><span class="w"> </span><span class="nc">nvarchar</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="k">AS</span>
<span class="k">BEGIN</span>
<span class="w">   </span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">EmailsRecebidos</span><span class="w"> </span><span class="p">(</span><span class="n">De</span><span class="p">,</span><span class="w"> </span><span class="n">Assunto</span><span class="p">,</span><span class="w"> </span><span class="k">Data</span><span class="p">)</span>
<span class="w">   </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="nv">@_DE</span><span class="p">,</span><span class="w"> </span><span class="nv">@_ASSUNTO</span><span class="p">,</span><span class="w"> </span><span class="nv">@_DATA</span><span class="p">)</span>
<span class="w">   </span><span class="k">WHERE</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="ow">EXISTS</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">EmailsRecebidos</span><span class="w"> </span>
<span class="w">                   </span><span class="k">WHERE</span><span class="w"> </span><span class="n">De</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">@_DE</span>
<span class="w">                   </span><span class="ow">AND</span><span class="w"> </span><span class="n">Assunto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">@_ASSUNTO</span>
<span class="w">                   </span><span class="ow">AND</span><span class="w"> </span><span class="k">Data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">@_DATA</span><span class="p">);</span>
<span class="k">END</span>
</pre></div>

<p>And the error is:</p>
<blockquote>
<p>Msg 156, Level 15, State 1, Procedure EmailsRecebidosInsert, Line 11<br>
 Incorrect syntax near the keyword 'WHERE'.</p>
</blockquote>
<p><br><br></p>
<h2>Answer</h2>
<p>instead of below Code</p>
<div class="code"><pre class="code literal-block"><span class="k">BEGIN</span>
<span class="w">   </span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">EmailsRecebidos</span><span class="w"> </span><span class="p">(</span><span class="n">De</span><span class="p">,</span><span class="w"> </span><span class="n">Assunto</span><span class="p">,</span><span class="w"> </span><span class="k">Data</span><span class="p">)</span>
<span class="w">   </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="nv">@_DE</span><span class="p">,</span><span class="w"> </span><span class="nv">@_ASSUNTO</span><span class="p">,</span><span class="w"> </span><span class="nv">@_DATA</span><span class="p">)</span>
<span class="w">   </span><span class="k">WHERE</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="ow">EXISTS</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">EmailsRecebidos</span><span class="w"> </span>
<span class="w">                   </span><span class="k">WHERE</span><span class="w"> </span><span class="n">De</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">@_DE</span>
<span class="w">                   </span><span class="ow">AND</span><span class="w"> </span><span class="n">Assunto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">@_ASSUNTO</span>
<span class="w">                   </span><span class="ow">AND</span><span class="w"> </span><span class="k">Data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">@_DATA</span><span class="p">);</span>
<span class="k">END</span>
</pre></div>

<p>replace with</p>
<div class="code"><pre class="code literal-block"><span class="k">BEGIN</span>
<span class="w">   </span><span class="k">IF</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="ow">EXISTS</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">EmailsRecebidos</span><span class="w"> </span>
<span class="w">                   </span><span class="k">WHERE</span><span class="w"> </span><span class="n">De</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">@_DE</span>
<span class="w">                   </span><span class="ow">AND</span><span class="w"> </span><span class="n">Assunto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">@_ASSUNTO</span>
<span class="w">                   </span><span class="ow">AND</span><span class="w"> </span><span class="k">Data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">@_DATA</span><span class="p">)</span>
<span class="w">   </span><span class="k">BEGIN</span>
<span class="w">       </span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">EmailsRecebidos</span><span class="w"> </span><span class="p">(</span><span class="n">De</span><span class="p">,</span><span class="w"> </span><span class="n">Assunto</span><span class="p">,</span><span class="w"> </span><span class="k">Data</span><span class="p">)</span>
<span class="w">       </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="nv">@_DE</span><span class="p">,</span><span class="w"> </span><span class="nv">@_ASSUNTO</span><span class="p">,</span><span class="w"> </span><span class="nv">@_DATA</span><span class="p">)</span>
<span class="w">   </span><span class="k">END</span>
<span class="k">END</span>
</pre></div>

<p><strong>Updated :</strong> (thanks to @Marc Durdin for pointing)</p>
<p>Note that under high load, this will still sometimes fail, because a second
connection can pass the IF NOT EXISTS test before the first connection
executes the INSERT, i.e. a race condition. See
stackoverflow.com/a/3791506/1836776 for a good answer on why even wrapping in
a transaction doesn't solve this.</p>
<p><br></p>
<h3>Suggest</h3>
<p>For those looking for the <em>fastest way</em> , I recently came across these
benchmarks where apparently using "INSERT SELECT... EXCEPT SELECT..." turned
out to be the fastest for 50 million records or more.</p>
<p>Here's some sample code from the article (the 3rd block of code was the
fastest):</p>
<div class="code"><pre class="code literal-block"><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">#table1</span><span class="w"> </span><span class="p">(</span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">guidd</span><span class="p">,</span><span class="w"> </span><span class="n">TimeAdded</span><span class="p">,</span><span class="w"> </span><span class="n">ExtraData</span><span class="p">)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">guidd</span><span class="p">,</span><span class="w"> </span><span class="n">TimeAdded</span><span class="p">,</span><span class="w"> </span><span class="n">ExtraData</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">#table2</span>
<span class="k">WHERE</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="ow">EXISTS</span><span class="w"> </span><span class="p">(</span><span class="k">Select</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">guidd</span><span class="w"> </span><span class="k">From</span><span class="w"> </span><span class="n">#table1</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">#table1</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">#table2</span><span class="p">.</span><span class="n">id</span><span class="p">)</span>
<span class="o">-----------------------------------</span>
<span class="k">MERGE</span><span class="w"> </span><span class="n">#table1</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="o">[</span><span class="n">Target</span><span class="o">]</span>
<span class="k">USING</span><span class="w">  </span><span class="p">(</span><span class="k">select</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">guidd</span><span class="p">,</span><span class="w"> </span><span class="n">TimeAdded</span><span class="p">,</span><span class="w"> </span><span class="n">ExtraData</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">#table2</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="o">[</span><span class="n">Source</span><span class="o">]</span>
<span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">guidd</span><span class="p">,</span><span class="w"> </span><span class="n">TimeAdded</span><span class="p">,</span><span class="w"> </span><span class="n">ExtraData</span><span class="p">)</span>
<span class="w">    </span><span class="k">on</span><span class="w"> </span><span class="o">[</span><span class="n">Target</span><span class="o">]</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=[</span><span class="n">Source</span><span class="o">]</span><span class="p">.</span><span class="n">id</span>
<span class="k">WHEN</span><span class="w"> </span><span class="ow">NOT</span><span class="w"> </span><span class="n">MATCHED</span><span class="w"> </span><span class="k">THEN</span>
<span class="w">    </span><span class="k">INSERT</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">guidd</span><span class="p">,</span><span class="w"> </span><span class="n">TimeAdded</span><span class="p">,</span><span class="w"> </span><span class="n">ExtraData</span><span class="p">)</span>
<span class="w">    </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="o">[</span><span class="n">Source</span><span class="o">]</span><span class="p">.</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="o">[</span><span class="n">Source</span><span class="o">]</span><span class="p">.</span><span class="n">guidd</span><span class="p">,</span><span class="w"> </span><span class="o">[</span><span class="n">Source</span><span class="o">]</span><span class="p">.</span><span class="n">TimeAdded</span><span class="p">,</span><span class="w"> </span><span class="o">[</span><span class="n">Source</span><span class="o">]</span><span class="p">.</span><span class="n">ExtraData</span><span class="p">);</span>
<span class="o">------------------------------</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">#table1</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">guidd</span><span class="p">,</span><span class="w"> </span><span class="n">TimeAdded</span><span class="p">,</span><span class="w"> </span><span class="n">ExtraData</span><span class="p">)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">guidd</span><span class="p">,</span><span class="w"> </span><span class="n">TimeAdded</span><span class="p">,</span><span class="w"> </span><span class="n">ExtraData</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">#table2</span>
<span class="ow">EXCEPT</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">guidd</span><span class="p">,</span><span class="w"> </span><span class="n">TimeAdded</span><span class="p">,</span><span class="w"> </span><span class="n">ExtraData</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">#table1</span>
<span class="o">------------------------------</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">#table1</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">guidd</span><span class="p">,</span><span class="w"> </span><span class="n">TimeAdded</span><span class="p">,</span><span class="w"> </span><span class="n">ExtraData</span><span class="p">)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">#table2</span><span class="p">.</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">#table2</span><span class="p">.</span><span class="n">guidd</span><span class="p">,</span><span class="w"> </span><span class="n">#table2</span><span class="p">.</span><span class="n">TimeAdded</span><span class="p">,</span><span class="w"> </span><span class="n">#table2</span><span class="p">.</span><span class="n">ExtraData</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">#table2</span>
<span class="nf">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">#table1</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">#table1</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">#table2</span><span class="p">.</span><span class="n">id</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">#table1</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">null</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/find-object-in-list-that-has-attribute-equal-to-some-value-that-meets-any-condition/" class="u-url">Find object in list that has attribute equal to some value (that meets any condition)</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/find-object-in-list-that-has-attribute-equal-to-some-value-that-meets-any-condition/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T15:12:38+08:00" itemprop="datePublished" title="2023-03-04 15:12">2023-03-04 15:12</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I've got a list of objects. I want to find one (first or whatever) object in
this list that has an attribute (or method result - whatever) equal to
<code>value</code>.</p>
<p>What's the best way to find it?</p>
<p>Here's a test case:</p>
<div class="code"><pre class="code literal-block"><span class="k">class</span> <span class="nc">Test</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>

<span class="kn">import</span> <span class="nn">random</span>

<span class="n">value</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">test_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">Test</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">)]</span>

<span class="c1"># that I would do in Pascal, I don't believe it's anywhere near 'Pythonic'</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">test_list</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="n">value</span><span class="p">:</span>
        <span class="nb">print</span> <span class="s2">"i found it!"</span>
        <span class="k">break</span>
</pre></div>

<p>I think using generators and <code>reduce()</code> won't make any difference because it
still would be iterating through the list.</p>
<p>ps.: Equation to <code>value</code> is just an example. Of course, we want to get an
element that meets any condition.</p>
<p><br><br></p>
<h2>Answer</h2>
<div class="code"><pre class="code literal-block"><span class="k">next</span><span class="ss">((</span><span class="nv">x</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">test_list</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nv">x</span>.<span class="nv">value</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nv">value</span><span class="ss">)</span>,<span class="w"> </span><span class="nv">None</span><span class="ss">)</span>
</pre></div>

<p>This gets the first item from the list that matches the condition, and returns
<code>None</code> if no item matches. It's my preferred single-expression form.</p>
<p>However,</p>
<div class="code"><pre class="code literal-block"><span class="k">for</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">test_list</span>:
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nv">x</span>.<span class="nv">value</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nv">value</span>:
<span class="w">        </span><span class="nv">print</span><span class="ss">(</span><span class="s2">"i found it!"</span><span class="ss">)</span>
<span class="w">        </span><span class="k">break</span>
</pre></div>

<p>The naive loop-break version, is perfectly Pythonic -- it's concise, clear,
and efficient. To make it match the behavior of the one-liner:</p>
<div class="code"><pre class="code literal-block"><span class="k">for</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">test_list</span>:
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nv">x</span>.<span class="nv">value</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nv">value</span>:
<span class="w">        </span><span class="nv">print</span><span class="ss">(</span><span class="s2">"i found it!"</span><span class="ss">)</span>
<span class="w">        </span><span class="k">break</span>
<span class="k">else</span>:
<span class="w">    </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">None</span>
</pre></div>

<p>This will assign <code>None</code> to <code>x</code> if you don't <code>break</code> out of the loop.</p>
<p><br></p>
<h3>Suggest</h3>
<p>Since it has not been mentioned just for completion. The good ol' filter to
filter your to be filtered elements.</p>
<p>Functional programming ftw.</p>
<div class="code"><pre class="code literal-block"><span class="c1">####### Set Up #######</span>
<span class="k">class</span> <span class="o">X</span>:

    <span class="n">def</span> <span class="n">__init__</span>(<span class="nb">self</span>, <span class="nb">val</span>):
        <span class="nb">self</span>.<span class="nb">val</span> = <span class="nb">val</span>

<span class="n">elem</span> = <span class="mi">5</span>

<span class="n">my_unfiltered_list</span> = [<span class="o">X</span>(<span class="mi">1</span>), <span class="o">X</span>(<span class="mi">2</span>), <span class="o">X</span>(<span class="mi">3</span>), <span class="o">X</span>(<span class="mi">4</span>), <span class="o">X</span>(<span class="mi">5</span>), <span class="o">X</span>(<span class="mi">5</span>), <span class="o">X</span>(<span class="mi">6</span>)]

<span class="c1">####### Set Up #######</span>

<span class="c1">### Filter one liner ### filter(lambda x: condition(x), some_list)</span>
<span class="n">my_filter_iter</span> = <span class="n">filter</span>(<span class="n">lambda</span> <span class="o">x</span>: <span class="nb">x</span>.<span class="nb">val</span> == <span class="n">elem</span>, <span class="n">my_unfiltered_list</span>)
<span class="c1">### Returns a flippin' iterator at least in Python 3.5 and that's what I'm on</span>

<span class="nb">print</span>(<span class="nb">next</span>(<span class="n">my_filter_iter</span>).<span class="nb">val</span>)
<span class="nb">print</span>(<span class="nb">next</span>(<span class="n">my_filter_iter</span>).<span class="nb">val</span>)
<span class="nb">print</span>(<span class="nb">next</span>(<span class="n">my_filter_iter</span>).<span class="nb">val</span>)

<span class="c1">### [1, 2, 3, 4, 5, 5, 6] Will Return: ###</span>
<span class="c1"># 5</span>
<span class="c1"># 5</span>
<span class="c1"># Traceback (most recent call last):</span>
<span class="c1">#   File "C:\Users\mousavin\workspace\Scripts\test.py", line 22, in &lt;module&gt;</span>
<span class="c1">#     print(next(my_filter_iter).value)</span>
<span class="c1"># StopIteration</span>


<span class="c1"># You can do that None stuff or whatever at this point, if you don't like exceptions.</span>
</pre></div>

<p>I know that generally in python list comprehensions are preferred or at least
that is what I read, but I don't see the issue to be honest. Of course Python
is not an FP language, but Map / Reduce / Filter are perfectly readable and
are the most standard of standard use cases in functional programming.</p>
<p>So there you go. Know thy functional programming.</p>
<p>filter condition list</p>
<p>It won't get any easier than this:</p>
<div class="code"><pre class="code literal-block"><span class="k">next</span><span class="ss">(</span><span class="nv">filter</span><span class="ss">(</span><span class="nv">lambda</span><span class="w"> </span><span class="nv">x</span>:<span class="w"> </span><span class="nv">x</span>.<span class="nv">val</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nv">value</span>,<span class="w">  </span><span class="nv">my_unfiltered_list</span><span class="ss">))</span><span class="w"> </span>#<span class="w"> </span><span class="nv">Optionally</span>:<span class="w"> </span><span class="k">next</span><span class="ss">(</span>...,<span class="w"> </span><span class="nv">None</span><span class="ss">)</span><span class="w"> </span><span class="nv">or</span><span class="w"> </span><span class="nv">some</span><span class="w"> </span><span class="nv">other</span><span class="w"> </span><span class="nv">default</span><span class="w"> </span><span class="nv">value</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">prevent</span><span class="w"> </span><span class="nv">Exceptions</span>
</pre></div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-2427.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-2425.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
