<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 1038) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-1038.html">
<link rel="prev" href="index-1039.html" type="text/html">
<link rel="next" href="index-1037.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/ru-he-shi-yong-gradle-zhi-yun-xing-yi-ge-dan-yuan-ce-shi-lei/" class="u-url">如何使用 Gradle 只运行一个单元测试类</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/ru-he-shi-yong-gradle-zhi-yun-xing-yi-ge-dan-yuan-ce-shi-lei/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T23:42:28+08:00" itemprop="datePublished" title="2023-02-17 23:42">2023-02-17 23:42</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>我是 Gradle 的新手。我使用 Gradle 1.10 和 Ubuntu 13。</p>
<p>我想知道是否有任何命令只执行一个单元测试类，类似于<code>testOnly</code>SBT。</p>
<p><br><br></p>
<h2>解答</h2>
<p>运行单个测试类 Airborn 的答案很好。</p>
<p>通过使用此处找到的一些命令行选项，您可以简单地执行类似这样的操作。</p>
<div class="code"><pre class="code literal-block">gradle test --tests org.gradle.SomeTest.someSpecificFeature
gradle test --tests '*SomeTest.someSpecificFeature'
gradle test --tests '*SomeSpecificTest'
gradle test --tests 'all.in.specific.package*'
gradle test --tests '*IntegTest'
gradle test --tests '*IntegTest*ui*'
gradle test --tests '*IntegTest.singleMethod'
gradle someTestTask --tests '*UiTest' someOtherTestTask --tests '*WebTest*ui'
</pre></div>

<p>从 gradle 的 1.10 版本开始，它支持使用测试过滤器选择测试。例如，</p>
<div class="code"><pre class="code literal-block"><span class="n">apply</span><span class="w"> </span><span class="n">plugin</span><span class="p">:</span><span class="w"> </span><span class="s1">'java'</span>

<span class="n">test</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">filter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="o">//</span><span class="n">specific</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="n">method</span>
<span class="w">      </span><span class="n">includeTestsMatching</span><span class="w"> </span><span class="s2">"org.gradle.SomeTest.someSpecificFeature"</span>

<span class="w">     </span><span class="o">//</span><span class="n">specific</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="n">method</span><span class="p">,</span><span class="w"> </span><span class="n">use</span><span class="w"> </span><span class="n">wildcard</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">packages</span>
<span class="w">     </span><span class="n">includeTestsMatching</span><span class="w"> </span><span class="s2">"*SomeTest.someSpecificFeature"</span>

<span class="w">     </span><span class="o">//</span><span class="n">specific</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="k">class</span>
<span class="w">     </span><span class="n">includeTestsMatching</span><span class="w"> </span><span class="s2">"org.gradle.SomeTest"</span>

<span class="w">     </span><span class="o">//</span><span class="n">specific</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="k">class</span><span class="p">,</span><span class="w"> </span><span class="n">wildcard</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">packages</span>
<span class="w">     </span><span class="n">includeTestsMatching</span><span class="w"> </span><span class="s2">"*.SomeTest"</span>

<span class="w">     </span><span class="o">//</span><span class="n">all</span><span class="w"> </span><span class="n">classes</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">package</span><span class="p">,</span><span class="w"> </span><span class="n">recursively</span>
<span class="w">     </span><span class="n">includeTestsMatching</span><span class="w"> </span><span class="s2">"com.gradle.tooling.*"</span>

<span class="w">     </span><span class="o">//</span><span class="n">all</span><span class="w"> </span><span class="n">integration</span><span class="w"> </span><span class="n">tests</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">naming</span><span class="w"> </span><span class="n">convention</span>
<span class="w">      </span><span class="n">includeTestsMatching</span><span class="w"> </span><span class="s2">"*IntegTest"</span>

<span class="w">     </span><span class="o">//</span><span class="n">only</span><span class="w"> </span><span class="n">ui</span><span class="w"> </span><span class="n">tests</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">integration</span><span class="w"> </span><span class="n">tests</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">naming</span><span class="w"> </span><span class="n">convention</span>
<span class="w">     </span><span class="n">includeTestsMatching</span><span class="w"> </span><span class="s2">"*IntegTest*ui"</span>
<span class="w">   </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p>对于多口味环境（Android 的常见用例），请检查此答案，因为该<code>--tests</code>参数将不受支持并且您会收到错误消息。</p>
<p><br></p>
<h3>更多建议</h3>
<p>在 5 之前的 Gradle 版本中，<code>test.single</code>系统属性可用于指定单个测试。</p>
<p><code>gradle -Dtest.single=ClassUnderTestTest
test</code>如果你想测试单个类或使用正则表达式，你可以这样做，你可以在这个链接下<code>gradle -Dtest.single=ClassName*Test
test</code>找到更多过滤类测试的例子。</p>
<p>Gradle 5 删除了这个选项，因为它被使用命令行选项的测试过滤所取代<code>--tests</code>。</p>
<p><br><br><a href="posts/how-to-run-only-one-unit-test-class-using-gradle/">查看原文</a></p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/biao-ge-dan-yuan-ge-zhong-de-css-wen-ben-yi-chu/" class="u-url">表格单元格中的 CSS 文本溢出？</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/biao-ge-dan-yuan-ge-zhong-de-css-wen-ben-yi-chu/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T23:41:50+08:00" itemprop="datePublished" title="2023-02-17 23:41">2023-02-17 23:41</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>我想<code>text-overflow</code>在表格单元格中使用 CSS，这样如果文本太长无法放在一行中，它将用省略号剪裁而不是换行。这可能吗？</p>
<p>我试过这个：</p>
<div class="code"><pre class="code literal-block"><span class="nt">td</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">overflow</span><span class="p">:</span><span class="w"> </span><span class="kc">hidden</span><span class="p">;</span>
<span class="w">  </span><span class="k">text-overflow</span><span class="p">:</span><span class="w"> </span><span class="kc">ellipsis</span><span class="p">;</span>
<span class="w">  </span><span class="k">white-space</span><span class="p">:</span><span class="w"> </span><span class="kc">nowrap</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<p>但是<code>white-space:
nowrap</code>似乎使文本（及其单元格）不断向右扩展，将表格的总宽度推到其容器的宽度之外。但是，如果没有它，文本在到达单元格边缘时会继续换行。</p>
<p><br><br></p>
<h2>解答</h2>
<p>要在溢出表格单元格时使用省略号剪辑文本，您需要<code>max-width</code>在每个<code>td</code>类上设置 CSS 属性以使溢出起作用。不需要额外的布局<code>div</code>元素：</p>
<div class="code"><pre class="code literal-block"><span class="nt">td</span>
<span class="p">{</span>
<span class="w"> </span><span class="k">max-width</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">px</span><span class="p">;</span>
<span class="w"> </span><span class="k">overflow</span><span class="p">:</span><span class="w"> </span><span class="kc">hidden</span><span class="p">;</span>
<span class="w"> </span><span class="k">text-overflow</span><span class="p">:</span><span class="w"> </span><span class="kc">ellipsis</span><span class="p">;</span>
<span class="w"> </span><span class="k">white-space</span><span class="p">:</span><span class="w"> </span><span class="kc">nowrap</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<p>对于响应式布局；使用<code>max-width</code>CSS 属性来指定列的有效最小宽度，或者只是<code>max-width:
0;</code>为了无限的灵活性而使用。此外，包含表将需要一个特定的宽度，通常是<code>width: 100%;</code>，并且列的宽度通常设置为总宽度的百分比</p>
<div class="code"><pre class="code literal-block"><span class="nt">table</span><span class="w"> </span><span class="p">{</span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;}</span>
<span class="nt">td</span>
<span class="p">{</span>
<span class="w"> </span><span class="k">max-width</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w"> </span><span class="k">overflow</span><span class="p">:</span><span class="w"> </span><span class="kc">hidden</span><span class="p">;</span>
<span class="w"> </span><span class="k">text-overflow</span><span class="p">:</span><span class="w"> </span><span class="kc">ellipsis</span><span class="p">;</span>
<span class="w"> </span><span class="k">white-space</span><span class="p">:</span><span class="w"> </span><span class="kc">nowrap</span><span class="p">;</span>
<span class="p">}</span>
<span class="nt">td</span><span class="p">.</span><span class="nc">column_a</span><span class="w"> </span><span class="p">{</span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="kt">%</span><span class="p">;}</span>
<span class="nt">td</span><span class="p">.</span><span class="nc">column_b</span><span class="w"> </span><span class="p">{</span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">70</span><span class="kt">%</span><span class="p">;}</span>
</pre></div>

<p>历史：对于 IE 9（或更低版本），您需要在 HTML 中包含此内容，以修复特定于 IE 的呈现问题</p>
<div class="code"><pre class="code literal-block"><span class="o">&lt;!--</span><span class="p">[</span><span class="k">if</span><span class="w"> </span><span class="n">IE</span><span class="p">]</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">style</span><span class="o">&gt;</span>
<span class="n">table</span><span class="w"> </span><span class="p">{</span><span class="n">table</span><span class="o">-</span><span class="n">layout</span><span class="o">:</span><span class="w"> </span><span class="n">fixed</span><span class="p">;</span><span class="w"> </span><span class="n">width</span><span class="o">:</span><span class="w"> </span><span class="mi">100</span><span class="n">px</span><span class="p">;}</span>
<span class="o">&lt;/</span><span class="n">style</span><span class="o">&gt;</span>
<span class="o">&lt;!</span><span class="p">[</span><span class="n">endif</span><span class="p">]</span><span class="o">--&gt;</span>
</pre></div>

<p><br></p>
<h3>更多建议</h3>
<p>指定宽度<code>max-width</code>或固定宽度并不适用于所有情况，表格应该是流动的并自动调整其单元格的间距。这就是桌子的用途。适用于 IE9 和其他浏览器。</p>
<p>使用这个： http: //jsfiddle.net/maruxa1j/</p>
<div class="code"><pre class="code literal-block">table<span class="w"> </span>{
<span class="w">    </span>width:<span class="w"> </span>100%;
}
.first<span class="w"> </span>{
<span class="w">    </span>width:<span class="w"> </span>50%;
}
.ellipsis<span class="w"> </span>{
<span class="w">    </span>position:<span class="w"> </span>relative;
}
.ellipsis:before<span class="w"> </span>{
<span class="w">    </span>content:<span class="w"> </span>'<span class="ni">&amp;nbsp;</span>';
<span class="w">    </span>visibility:<span class="w"> </span>hidden;
}
.ellipsis<span class="w"> </span>span<span class="w"> </span>{
<span class="w">    </span>position:<span class="w"> </span>absolute;
<span class="w">    </span>left:<span class="w"> </span>0;
<span class="w">    </span>right:<span class="w"> </span>0;
<span class="w">    </span>white-space:<span class="w"> </span>nowrap;
<span class="w">    </span>overflow:<span class="w"> </span>hidden;
<span class="w">    </span>text-overflow:<span class="w"> </span>ellipsis;
}


<span class="nt">&lt;table</span><span class="w"> </span><span class="na">border=</span><span class="s">"1"</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;thead&gt;</span>
<span class="w">        </span><span class="nt">&lt;tr&gt;</span>
<span class="w">            </span><span class="nt">&lt;th&gt;</span>Header<span class="w"> </span>1<span class="nt">&lt;/th&gt;</span>
<span class="w">            </span><span class="nt">&lt;th&gt;</span>Header<span class="w"> </span>2<span class="nt">&lt;/th&gt;</span>
<span class="w">            </span><span class="nt">&lt;th&gt;</span>Header<span class="w"> </span>3<span class="nt">&lt;/th&gt;</span>
<span class="w">            </span><span class="nt">&lt;th&gt;</span>Header<span class="w"> </span>4<span class="nt">&lt;/th&gt;</span>
<span class="w">        </span><span class="nt">&lt;/tr&gt;</span>
<span class="w">    </span><span class="nt">&lt;/thead&gt;</span>
<span class="w">    </span><span class="nt">&lt;tbody&gt;</span>
<span class="w">        </span><span class="nt">&lt;tr&gt;</span>
<span class="w">            </span><span class="nt">&lt;td</span><span class="w"> </span><span class="na">class=</span><span class="s">"ellipsis first"</span><span class="nt">&gt;&lt;span&gt;</span>This<span class="w"> </span>Text<span class="w"> </span>Overflows<span class="w"> </span>and<span class="w"> </span>is<span class="w"> </span>too<span class="w"> </span>large<span class="w"> </span>for<span class="w"> </span>its<span class="w"> </span>cell.<span class="nt">&lt;/span&gt;&lt;/td&gt;</span>
<span class="w">            </span><span class="nt">&lt;td</span><span class="w"> </span><span class="na">class=</span><span class="s">"ellipsis"</span><span class="nt">&gt;&lt;span&gt;</span>This<span class="w"> </span>Text<span class="w"> </span>Overflows<span class="w"> </span>and<span class="w"> </span>is<span class="w"> </span>too<span class="w"> </span>large<span class="w"> </span>for<span class="w"> </span>its<span class="w"> </span>cell.<span class="nt">&lt;/span&gt;&lt;/td&gt;</span>
<span class="w">            </span><span class="nt">&lt;td</span><span class="w"> </span><span class="na">class=</span><span class="s">"ellipsis"</span><span class="nt">&gt;&lt;span&gt;</span>This<span class="w"> </span>Text<span class="w"> </span>Overflows<span class="w"> </span>and<span class="w"> </span>is<span class="w"> </span>too<span class="w"> </span>large<span class="w"> </span>for<span class="w"> </span>its<span class="w"> </span>cell.<span class="nt">&lt;/span&gt;&lt;/td&gt;</span>
<span class="w">            </span><span class="nt">&lt;td</span><span class="w"> </span><span class="na">class=</span><span class="s">"ellipsis"</span><span class="nt">&gt;&lt;span&gt;</span>This<span class="w"> </span>Text<span class="w"> </span>Overflows<span class="w"> </span>and<span class="w"> </span>is<span class="w"> </span>too<span class="w"> </span>large<span class="w"> </span>for<span class="w"> </span>its<span class="w"> </span>cell.<span class="nt">&lt;/span&gt;&lt;/td&gt;</span>
<span class="w">        </span><span class="nt">&lt;/tr&gt;</span>
<span class="w">    </span><span class="nt">&lt;/tbody&gt;</span>
<span class="nt">&lt;/table&gt;</span>
</pre></div>

<p><br><br><a href="posts/css-text-overflow-in-a-table-cell/">查看原文</a></p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/php-curl-he-http-post-shi-li/" class="u-url">PHP、cURL 和 HTTP POST 示例？</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/php-curl-he-http-post-shi-li/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T23:41:00+08:00" itemprop="datePublished" title="2023-02-17 23:41">2023-02-17 23:41</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>谁能告诉我如何使用 HTTP POST 执行 PHP cURL？</p>
<p>我想发送这样的数据：</p>
<div class="code"><pre class="code literal-block">username=user1, password=passuser1, gender=1
</pre></div>

<p>到<code>www.example.com</code></p>
<p>我希望 cURL 返回类似<code>result=OK</code>. 有没有例子？</p>
<p><br><br></p>
<h2>解答</h2>
<div class="code"><pre class="code literal-block"><span class="cp">&lt;?php</span>
<span class="c1">//</span>
<span class="c1">// A very simple PHP example that sends a HTTP POST to a remote site</span>
<span class="c1">//</span>

<span class="nv">$ch</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">();</span>

<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_URL</span><span class="p">,</span><span class="s2">"http://www.example.com/tester.phtml"</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_POST</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_POSTFIELDS</span><span class="p">,</span>
            <span class="s2">"postvar1=value1&amp;postvar2=value2&amp;postvar3=value3"</span><span class="p">);</span>

<span class="c1">// In real life you should use something like:</span>
<span class="c1">// curl_setopt($ch, CURLOPT_POSTFIELDS, </span>
<span class="c1">//          http_build_query(array('postvar1' =&gt; 'value1')));</span>

<span class="c1">// Receive server response ...</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>

<span class="nv">$server_output</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>

<span class="nb">curl_close</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>

<span class="c1">// Further processing ...</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$server_output</span> <span class="o">==</span> <span class="s2">"OK"</span><span class="p">)</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
<span class="cp">?&gt;</span>
</pre></div>

<p><br></p>
<h3>更多建议</h3>
<h3>程序</h3>
<div class="code"><pre class="code literal-block"><span class="o">//</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">post</span><span class="w"> </span><span class="n">fields</span>
<span class="o">$</span><span class="n">post</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s1">'username'</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">'user1'</span><span class="p">,</span>
<span class="w">    </span><span class="s1">'password'</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">'passuser1'</span><span class="p">,</span>
<span class="w">    </span><span class="s1">'gender'</span><span class="w">   </span><span class="o">=&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="p">];</span>

<span class="o">$</span><span class="n">ch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">curl_init</span><span class="p">(</span><span class="s1">'http://www.example.com'</span><span class="p">);</span>
<span class="n">curl_setopt</span><span class="p">(</span><span class="o">$</span><span class="n">ch</span><span class="p">,</span><span class="w"> </span><span class="n">CURLOPT_RETURNTRANSFER</span><span class="p">,</span><span class="w"> </span><span class="bp">true</span><span class="p">);</span>
<span class="n">curl_setopt</span><span class="p">(</span><span class="o">$</span><span class="n">ch</span><span class="p">,</span><span class="w"> </span><span class="n">CURLOPT_POSTFIELDS</span><span class="p">,</span><span class="w"> </span><span class="o">$</span><span class="n">post</span><span class="p">);</span>

<span class="o">//</span><span class="w"> </span><span class="n">execute</span><span class="o">!</span>
<span class="o">$</span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">curl_exec</span><span class="p">(</span><span class="o">$</span><span class="n">ch</span><span class="p">);</span>

<span class="o">//</span><span class="w"> </span><span class="n">close</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">connection</span><span class="p">,</span><span class="w"> </span><span class="n">release</span><span class="w"> </span><span class="n">resources</span><span class="w"> </span><span class="n">used</span>
<span class="n">curl_close</span><span class="p">(</span><span class="o">$</span><span class="n">ch</span><span class="p">);</span>

<span class="o">//</span><span class="w"> </span><span class="n">do</span><span class="w"> </span><span class="n">anything</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">response</span>
<span class="n">var_dump</span><span class="p">(</span><span class="o">$</span><span class="n">response</span><span class="p">);</span>
</pre></div>

<h3>面向对象</h3>
<div class="code"><pre class="code literal-block"><span class="cp">&lt;?php</span>

<span class="c1">// mutatis mutandis</span>
<span class="k">namespace</span> <span class="nx">MyApp\Http</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">CurlPost</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="nv">$url</span><span class="p">;</span>
    <span class="k">private</span> <span class="nv">$options</span><span class="p">;</span>

    <span class="sd">/**</span>
<span class="sd">     * @param string $url     Request URL</span>
<span class="sd">     * @param array  $options cURL options</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nv">$url</span><span class="p">,</span> <span class="k">array</span> <span class="nv">$options</span> <span class="o">=</span> <span class="p">[])</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">url</span> <span class="o">=</span> <span class="nv">$url</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">options</span> <span class="o">=</span> <span class="nv">$options</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * Get the response</span>
<span class="sd">     * @return string</span>
<span class="sd">     * @throws \RuntimeException On cURL error</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="fm">__invoke</span><span class="p">(</span><span class="k">array</span> <span class="nv">$post</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$ch</span> <span class="o">=</span> <span class="nx">\curl_init</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">url</span><span class="p">);</span>

        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">options</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&gt;</span> <span class="nv">$val</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">\curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nv">$key</span><span class="p">,</span> <span class="nv">$val</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="nx">\curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">\CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
        <span class="nx">\curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">\CURLOPT_POSTFIELDS</span><span class="p">,</span> <span class="nv">$post</span><span class="p">);</span>

        <span class="nv">$response</span> <span class="o">=</span> <span class="nx">\curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
        <span class="nv">$error</span>    <span class="o">=</span> <span class="nx">\curl_error</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
        <span class="nv">$errno</span>    <span class="o">=</span> <span class="nx">\curl_errno</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">\is_resource</span><span class="p">(</span><span class="nv">$ch</span><span class="p">))</span> <span class="p">{</span>
            <span class="nx">\curl_close</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="mi">0</span> <span class="o">!==</span> <span class="nv">$errno</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">\RuntimeException</span><span class="p">(</span><span class="nv">$error</span><span class="p">,</span> <span class="nv">$errno</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nv">$response</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<h4>用法</h4>
<div class="code"><pre class="code literal-block"><span class="c1">// create curl object</span>
<span class="no">$</span><span class="n">curl</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="o">\</span><span class="n">MyApp</span><span class="o">\</span><span class="n">Http</span><span class="o">\</span><span class="n">CurlPost</span><span class="p">(</span><span class="s">'http://www.example.com'</span><span class="p">);</span>

<span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// execute the request</span>
<span class="w">    </span><span class="n">echo</span><span class="w"> </span><span class="no">$</span><span class="n">curl</span><span class="p">([</span>
<span class="w">        </span><span class="s">'username'</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="s">'user1'</span><span class="p">,</span>
<span class="w">        </span><span class="s">'password'</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="s">'passuser1'</span><span class="p">,</span>
<span class="w">        </span><span class="s">'gender'</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="p">]);</span>
<span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="o">\</span><span class="n">RuntimeException</span><span class="w"> </span><span class="no">$</span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// catch errors</span>
<span class="w">    </span><span class="n">die</span><span class="p">(</span><span class="nb">sprintf</span><span class="p">(</span><span class="s">'Http error %s with code %d'</span><span class="p">,</span><span class="w"> </span><span class="no">$</span><span class="n">ex</span><span class="o">-&gt;</span><span class="n">getMessage</span><span class="p">(),</span><span class="w"> </span><span class="no">$</span><span class="n">ex</span><span class="o">-&gt;</span><span class="n">getCode</span><span class="p">()));</span>
<span class="p">}</span>
</pre></div>

<p>这里的旁注：最好创建某种接口，<code>AdapterInterface</code>例如使用<code>getResponse()</code>方法调用，并让上面的类实现它。然后您可以随时将此实现与您喜欢的另一个适配器交换，而不会对您的应用程序产生任何副作用。</p>
<h3>使用 HTTPS / 加密流量</h3>
<p>通常Windows操作系统下PHP中的cURL会出现问题。在尝试连接到受 https 保护的端点时，您会收到一条错误消息，告诉您<code>certificate
verify failed</code>.</p>
<p>大多数人在这里所做的是告诉 cURL 库简单地忽略证书错误并继续 ( <code>curl_setopt($ch, CURLOPT_SSL_VERIFYPEER,
false);</code>)。由于这将使您的代码正常工作，因此您引入了巨大的安全漏洞并使恶意用户能够对您的应用程序执行各种攻击，例如中间人攻击等。</p>
<p>永远，永远不要那样做。相反，你只需要修改你的文件<code>php.ini</code>并告诉 PHP 你的<code>CA Certificate</code>文件在哪里让它正确验证证书：</p>
<div class="code"><pre class="code literal-block">; modify the absolute path to the cacert.pem file
curl.cainfo=c:\php\cacert.pem
</pre></div>

<p>最新的<code>cacert.pem</code>可以从 Internet 下载或从您喜欢的浏览器中提取。更改任何<code>php.ini</code>相关设置时，请记住重新启动您的网络服务器。</p>
<p><br><br><a href="posts/php-curl-and-http-post-example/">查看原文</a></p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-1039.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-1037.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
