<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 1283) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-1283.html">
<link rel="prev" href="index-1284.html" type="text/html">
<link rel="next" href="index-1282.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/push-git-commits-tags-simultaneously/" class="u-url">Push git commits &amp; tags simultaneously</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/push-git-commits-tags-simultaneously/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T05:39:25+08:00" itemprop="datePublished" title="2023-02-18 05:39">2023-02-18 05:39</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I'm aware of the reason that <code>git push --tags</code> is a separate operation to
plain old <code>git push</code>. Pushing tags should be a conscious choice since you
don't want accidentally push one. That's fine. But is there a way to push both
together? (Aside from <code>git push &amp;&amp; git push --tags</code>.)</p>
<p><br><br></p>
<h2>Answer</h2>
<h2>Update August 2020</h2>
<p>As mentioned originally in this answer by SoBeRich, and in my own answer, as
of git 2.4.x</p>
<div class="code"><pre class="code literal-block">git push --atomic origin &lt;branch name&gt; &lt;tag&gt;
</pre></div>

<p>(Note: this actually work with HTTPS only with Git 2.24)</p>
<h2>Update May 2015</h2>
<p>As of git 2.4.1, you can do</p>
<div class="code"><pre class="code literal-block">git config --global push.followTags true
</pre></div>

<blockquote>
<p>If set to true enable --follow-tags option by default.<br>
 You may override this configuration at time of push by specifying --no-
follow-tags.</p>
</blockquote>
<p>As noted in this thread by Matt Rogers answering Wes Hurd:</p>
<p><code>--follow-tags</code> <strong>only pushes annotated tags</strong>.</p>
<div class="code"><pre class="code literal-block">git tag -a -m "I'm an annotation" &lt;tagname&gt;
</pre></div>

<p>That would be pushed (as opposed to <code>git tag &lt;tagname&gt;</code>, a lightweight tag,
which would not be pushed, as I mentioned here)</p>
<h2>Update April 2013</h2>
<p>Since git 1.8.3 (April 22d, 2013), <strong>you no longer have to do 2 commands to
push branches, and then to push tags</strong> :</p>
<blockquote>
<p>The new "<code>--follow-tags</code>" option tells "<code>git push</code>" to <strong>push relevant
annotated tags when pushing branches out</strong>.</p>
</blockquote>
<p>You can now try, when pushing new commits:</p>
<div class="code"><pre class="code literal-block">git push --follow-tags
</pre></div>

<p>That won't push <em>all</em> the local tags though, only the one referenced by
commits which are pushed with the <code>git push</code>.</p>
<p>Git 2.4.1+ (Q2 2015) will introduce the option <code>push.followTags</code>: see "How to
make “<code>git push</code>” include tags within a branch?".</p>
<h2>Original answer, September 2010</h2>
<p>The nuclear option would be <code>git push --mirror</code>, which will push all refs
under <code>refs/</code>.</p>
<p>You can also push just one tag with your current branch commit:</p>
<div class="code"><pre class="code literal-block">git push origin : v1.0.0
</pre></div>

<p>You can combine the <code>--tags</code> option with a refspec like:</p>
<div class="code"><pre class="code literal-block">git push origin --tags :
</pre></div>

<p>(since <code>--tags</code> means: All refs under <code>refs/tags</code> are pushed, <em><strong>in addition
to refspecs explicitly listed on the command line</strong></em> )</p>
<hr>
<p>You also have this entry "Pushing branches and tags with a single "git push"
invocation"</p>
<blockquote>
<p>A handy tip was just posted to the Git mailing list by Zoltán Füzesi:</p>
<p>I use <code>.git/config</code> to solve this:</p>
</blockquote>
<div class="code"><pre class="code literal-block"><span class="k">[remote "origin"]</span>
<span class="w">    </span><span class="na">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">...</span>
<span class="w">    </span><span class="na">fetch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">+refs/heads/*:refs/remotes/origin/*</span>
<span class="w">    </span><span class="na">push</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">+refs/heads/*</span>
<span class="w">    </span><span class="na">push</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">+refs/tags/*</span>
</pre></div>

<blockquote>
<p>With these lines added <code>git push origin</code> will upload all your branches and
tags. If you want to upload only some of them, you can enumerate them.</p>
<p>Haven't tried it myself yet, but it looks like it might be useful until some
other way of pushing branches and tags at the same time is added to git
push.<br>
 On the other hand, I don't mind typing:</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span>git<span class="w"> </span>push<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>git<span class="w"> </span>push<span class="w"> </span>--tags
</pre></div>

</blockquote>
<p><strong>Beware</strong> , as commented by Aseem Kishore</p>
<p><code>push = +refs/heads/*</code> will <strong>force-pushes all your branches</strong>.</p>
<blockquote>
<p>This bit me just now, so FYI.</p>
</blockquote>
<hr>
<p>René Scheibe adds this interesting comment:</p>
<blockquote>
<p>The <code>--follow-tags</code> parameter is misleading as only tags under
<code>.git/refs/tags</code> are considered.<br>
 If <code>git gc</code> is run, tags are moved from <code>.git/refs/tags</code> to <code>.git/packed-
refs</code>. Afterwards <code>git push --follow-tags ...</code> does not work as expected
anymore.</p>
</blockquote>
<p><br></p>
<h3>Suggest</h3>
<p>@since Git 2.4</p>
<p><code>git push --atomic origin &lt;branch name&gt; &lt;tag&gt;</code></p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/es6-class-variable-alternatives/" class="u-url">ES6 class variable alternatives</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/es6-class-variable-alternatives/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T05:38:56+08:00" itemprop="datePublished" title="2023-02-18 05:38">2023-02-18 05:38</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Currently in ES5 many of us are using the following pattern in frameworks to
create classes and class variables, which is comfy:</p>
<div class="code"><pre class="code literal-block"><span class="o">//</span><span class="w"> </span><span class="n">ES</span><span class="w"> </span><span class="mi">5</span>
<span class="n">FrameWork</span><span class="o">.</span><span class="n">Class</span><span class="p">({</span>

<span class="w">    </span><span class="n">variable</span><span class="p">:</span><span class="w"> </span><span class="s1">'string'</span><span class="p">,</span>
<span class="w">    </span><span class="n">variable2</span><span class="p">:</span><span class="w"> </span><span class="bp">true</span><span class="p">,</span>

<span class="w">    </span><span class="n">init</span><span class="p">:</span><span class="w"> </span><span class="n">function</span><span class="p">(){</span>

<span class="w">    </span><span class="p">},</span>

<span class="w">    </span><span class="n">addItem</span><span class="p">:</span><span class="w"> </span><span class="n">function</span><span class="p">(){</span>

<span class="w">    </span><span class="p">}</span>

<span class="p">});</span>
</pre></div>

<p>In ES6 you can create classes natively, but there is no option to have class
variables:</p>
<div class="code"><pre class="code literal-block"><span class="o">//</span><span class="w"> </span><span class="n">ES6</span>
<span class="k">class</span><span class="w"> </span><span class="n">MyClass</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">MY_CONST</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'string'</span><span class="p">;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="o">&lt;--</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">possible</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">ES6</span>
<span class="w">    </span><span class="n">constructor</span><span class="p">(){</span>
<span class="w">        </span><span class="n">this</span><span class="o">.</span><span class="n">MY_CONST</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p>Sadly, the above won't work, as classes only can contain methods.</p>
<p>I understand that I can <code>this.myVar = true</code> in <code>constructor</code>…but I don't want
to 'junk' my constructor, especially when I have 20-30+ params for a bigger
class.</p>
<p>I was thinking of many ways to handle this issue, but haven't yet found any
good ones. (For example: create a <code>ClassConfig</code> handler, and pass a
<code>parameter</code> object, which is declared separately from the class. Then the
handler would attach to the class. I was thinking about <code>WeakMaps</code> also to
integrate, somehow.)</p>
<p>What kind of ideas would you have to handle this situation?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>2018 update:</p>
<p>There is now a stage 3 proposal - I am looking forward to make this answer
obsolete in a few months.</p>
<p>In the meantime anyone using TypeScript or babel can use the syntax:</p>
<div class="code"><pre class="code literal-block"><span class="n">varName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span>
</pre></div>

<p>Inside a class declaration/expression body and it will define a variable.
Hopefully in a few months/weeks I'll be able to post an update.</p>
<p>Update: Chrome 74 now ships with this syntax working.</p>
<hr>
<p>The notes in the ES wiki for the proposal in ES6 (maximally minimal classes)
note:</p>
<blockquote>
<p>There is (intentionally) no direct declarative way to define either
prototype data properties (other than methods) class properties, or instance
property</p>
<p>Class properties and prototype data properties need be created outside the
declaration.</p>
<p>Properties specified in a class definition are assigned the same attributes
as if they appeared in an object literal.</p>
</blockquote>
<p>This means that <strong>what you're asking for was considered, and explicitly
decided against.</strong></p>
<h4>but... why?</h4>
<p>Good question. The good people of TC39 want class declarations to declare and
define the capabilities of a class. Not its members. An ES6 class declaration
defines its contract for its user.</p>
<p>Remember, a class definition defines <em>prototype</em> methods - defining variables
on the prototype is generally not something you do. You can, of course use:</p>
<div class="code"><pre class="code literal-block"><span class="n">constructor</span><span class="p">(){</span>
<span class="w">    </span><span class="n">this</span><span class="o">.</span><span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bar</span>
<span class="p">}</span>
</pre></div>

<p>In the constructor like you suggested. Also see the summary of the consensus.</p>
<h4>ES7 and beyond</h4>
<p>A new proposal for ES7 is being worked on that allows more concise instance
variables through class declarations and expressions -
https://esdiscuss.org/topic/es7-property-initializers</p>
<p><br></p>
<h3>Suggest</h3>
<p>Just to add to Benjamin's answer — class variables are possible, but you
wouldn't use <code>prototype</code> to set them.</p>
<p>For a true class variable you'd want to do something like the following:</p>
<div class="code"><pre class="code literal-block"><span class="k">class</span> <span class="n">MyClass</span> {}
<span class="n">MyClass</span>.<span class="n">foo</span> = <span class="s">'bar'</span>;
</pre></div>

<p>From within a class method that variable can be accessed as
<code>this.constructor.foo</code> (or <code>MyClass.foo</code>).</p>
<p>These class properties would not usually be accessible from to the class
instance. i.e. <code>MyClass.foo</code> gives <code>'bar'</code> but <code>new MyClass().foo</code> is
<code>undefined</code></p>
<p>If you want to also have access to your class variable from an instance,
you'll have to additionally define a getter:</p>
<div class="code"><pre class="code literal-block"><span class="k">class</span><span class="w"> </span><span class="n">MyClass</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">get</span><span class="w"> </span><span class="n">foo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">this</span><span class="o">.</span><span class="n">constructor</span><span class="o">.</span><span class="n">foo</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="n">MyClass</span><span class="o">.</span><span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'bar'</span><span class="p">;</span>
</pre></div>

<p>I've only tested this with Traceur, but I believe it will work the same in a
standard implementation.</p>
<p>JavaScript doesn't really have classes. Even with ES6 we're looking at an
object- or prototype-based language rather than a class-based language. In any
<code>function X () {}</code>, <code>X.prototype.constructor</code> points back to <code>X</code>. When the
<code>new</code> operator is used on <code>X</code>, a new object is created inheriting
<code>X.prototype</code>. Any <em>undefined</em> properties in that new object (including
<code>constructor</code>) are looked up from there. We can think of this as generating
object and class properties.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/why-use-ruby-s-attr-accessor-attr-reader-and-attr-writer/" class="u-url">Why use Ruby's attr_accessor, attr_reader and attr_writer?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/why-use-ruby-s-attr-accessor-attr-reader-and-attr-writer/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T05:38:33+08:00" itemprop="datePublished" title="2023-02-18 05:38">2023-02-18 05:38</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Ruby has this handy and convenient way to share instance variables by using
keys like</p>
<div class="code"><pre class="code literal-block"><span class="n">attr_accessor</span><span class="w"> </span><span class="o">:</span><span class="kd">var</span>
<span class="n">attr_reader</span><span class="w"> </span><span class="p">:</span><span class="kt">var</span>
<span class="n">attr_writer</span><span class="w"> </span><span class="o">:</span><span class="n">var</span>
</pre></div>

<p>Why would I choose <code>attr_reader</code> or <code>attr_writer</code> if I could simply use
<code>attr_accessor</code>? Is there something like performance (which I doubt)? I guess
there is a reason, otherwise they wouldn't have made such keys.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>You may use the different accessors to communicate your intent to someone
reading your code, and make it easier to write classes which will work
correctly no matter how their public API is called.</p>
<div class="code"><pre class="code literal-block"><span class="k">class</span> <span class="n">Person</span>
  <span class="n">attr_accessor</span> :<span class="n">age</span>
  ...
<span class="nb">end</span>
</pre></div>

<p>Here, I can see that I may both read and write the age.</p>
<div class="code"><pre class="code literal-block"><span class="k">class</span> <span class="n">Person</span>
  <span class="n">attr_reader</span> :<span class="n">age</span>
  ...
<span class="nb">end</span>
</pre></div>

<p>Here, I can see that I may only read the age. Imagine that it is set by the
constructor of this class and after that remains constant. If there were a
mutator (writer) for age and the class were written assuming that age, once
set, does not change, then a bug could result from code calling that mutator.</p>
<p>But what is happening behind the scenes?</p>
<p>If you write:</p>
<div class="code"><pre class="code literal-block"><span class="n">attr_writer</span><span class="w"> </span><span class="o">:</span><span class="n">age</span>
</pre></div>

<p>That gets translated into:</p>
<div class="code"><pre class="code literal-block"><span class="n">def</span><span class="w"> </span><span class="n">age</span><span class="o">=</span><span class="p">(</span><span class="k">value</span><span class="p">)</span>
<span class="w">  </span><span class="nv">@age</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">value</span>
<span class="k">end</span>
</pre></div>

<p>If you write:</p>
<div class="code"><pre class="code literal-block"><span class="n">attr_reader</span><span class="w"> </span><span class="o">:</span><span class="n">age</span>
</pre></div>

<p>That gets translated into:</p>
<div class="code"><pre class="code literal-block"><span class="n">def</span><span class="w"> </span><span class="n">age</span>
<span class="w">  </span><span class="nv">@age</span>
<span class="k">end</span>
</pre></div>

<p>If you write:</p>
<div class="code"><pre class="code literal-block"><span class="n">attr_accessor</span><span class="w"> </span><span class="o">:</span><span class="n">age</span>
</pre></div>

<p>That gets translated into:</p>
<div class="code"><pre class="code literal-block"><span class="n">def</span><span class="w"> </span><span class="n">age</span><span class="o">=</span><span class="p">(</span><span class="k">value</span><span class="p">)</span>
<span class="w">  </span><span class="nv">@age</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">value</span>
<span class="k">end</span>

<span class="n">def</span><span class="w"> </span><span class="n">age</span>
<span class="w">  </span><span class="nv">@age</span>
<span class="k">end</span>
</pre></div>

<p>Knowing that, here's another way to think about it: If you did not have the
attr_... helpers, and had to write the accessors yourself, would you write any
more accessors than your class needed? For example, if age only needed to be
read, would you also write a method allowing it to be written?</p>
<p><br></p>
<h3>Suggest</h3>
<p>All of the answers above are correct; <code>attr_reader</code> and <code>attr_writer</code> are more
convenient to write than manually typing the methods they are shorthands for.
Apart from that they offer much better performance than writing the method
definition yourself. For more info see slide 152 onwards from this talk (PDF)
by Aaron Patterson.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-1284.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-1282.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
