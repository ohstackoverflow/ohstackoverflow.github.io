<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 1698) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-1698.html">
<link rel="prev" href="index-1699.html" type="text/html">
<link rel="next" href="index-1697.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/python-unittest-opposite-of-assertraises/" class="u-url">Python unittest - opposite of assertRaises?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/python-unittest-opposite-of-assertraises/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T07:14:55+08:00" itemprop="datePublished" title="2023-03-03 07:14">2023-03-03 07:14</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I want to write a test to establish that an Exception is not raised in a given
circumstance.</p>
<p>It's straightforward to test if an Exception <strong>is</strong> raised ...</p>
<div class="code"><pre class="code literal-block">sInvalidPath=AlwaysSuppliesAnInvalidPath()
self.assertRaises(PathIsNotAValidOne, MyObject, sInvalidPath)
</pre></div>

<p>... but how can you do the <strong>opposite</strong>.</p>
<p>Something like this i what I'm after ...</p>
<div class="code"><pre class="code literal-block">sValidPath=AlwaysSuppliesAValidPath()
self.assertNotRaises(PathIsNotAValidOne, MyObject, sValidPath)
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<div class="code"><pre class="code literal-block">def run_test(self):
    try:
        myFunc()
    except ExceptionType:
        self.fail("myFunc() raised ExceptionType unexpectedly!")
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<blockquote>
<p>Hi - I want to write a test to establish that an Exception is not raised in
a given circumstance.</p>
</blockquote>
<p>That's the default assumption -- exceptions are not raised.</p>
<p>If you say nothing else, that's assumed in every single test.</p>
<p>You don't have to actually write an any assertion for that.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/what-s-the-difference-between-select-related-and-prefetch-related-in-django-orm/" class="u-url">What's the difference between select_related and prefetch_related in Django ORM?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/what-s-the-difference-between-select-related-and-prefetch-related-in-django-orm/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T07:14:28+08:00" itemprop="datePublished" title="2023-03-03 07:14">2023-03-03 07:14</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>In Django doc:</p>
<blockquote>
<p><code>select_related()</code> "follows" foreign-key relationships, selecting additional
related-object data when it executes its query.</p>
<p><code>prefetch_related()</code> does a separate lookup for each relationship, and does
the "joining" in Python.</p>
</blockquote>
<p>What does it mean by "doing the joining in python"? Can someone illustrate
with an example?</p>
<p>My understanding is that for foreign key relationship, use <code>select_related</code>;
and for M2M relationship, use <code>prefetch_related</code>. Is this correct?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Your understanding is mostly correct. You use <code>select_related</code> when the object
that you're going to be selecting is a single object, so <code>OneToOneField</code> or a
<code>ForeignKey</code>. You use <code>prefetch_related</code> when you're going to get a "set" of
things, so <code>ManyToManyField</code>s as you stated or reverse <code>ForeignKey</code>s. Just to
clarify what I mean by "reverse <code>ForeignKey</code>s" here's an example:</p>
<div class="code"><pre class="code literal-block"><span class="k">class</span> <span class="n">ModelA</span>(<span class="n">models</span>.<span class="n">Model</span>):
    <span class="nb">pass</span>

<span class="k">class</span> <span class="n">ModelB</span>(<span class="n">models</span>.<span class="n">Model</span>):
    <span class="n">a</span> = <span class="n">ForeignKey</span>(<span class="n">ModelA</span>)

<span class="n">ModelB</span>.<span class="n">objects</span>.<span class="n">select_related</span>(<span class="s">'a'</span>).<span class="nb">all</span>() <span class="c1"># Forward ForeignKey relationship</span>
<span class="n">ModelA</span>.<span class="n">objects</span>.<span class="n">prefetch_related</span>(<span class="s">'modelb_set'</span>).<span class="nb">all</span>() <span class="c1"># Reverse ForeignKey relationship</span>
</pre></div>

<p>The difference is that <code>select_related</code> does an SQL join and therefore gets
the results back as part of the table from the SQL server. <code>prefetch_related</code>
on the other hand executes another query and therefore reduces the redundant
columns in the original object (<code>ModelA</code> in the above example). You may use
<code>prefetch_related</code> for anything that you can use <code>select_related</code> for.</p>
<p>The tradeoffs are that <code>prefetch_related</code> has to create and send a list of IDs
to select back to the server, this can take a while. I'm not sure if there's a
nice way of doing this in a transaction, but my understanding is that Django
always just sends a list and says SELECT ... WHERE pk IN (...,...,...)
basically. In this case if the prefetched data is sparse (let's say U.S. State
objects linked to people's addresses) this can be very good, however if it's
closer to one-to-one, this can waste a lot of communications. If in doubt, try
both and see which performs better.</p>
<p>Everything discussed above is basically about the communications with the
database. On the Python side however <code>prefetch_related</code> has the extra benefit
that a single object is used to represent each object in the database. With
<code>select_related</code> duplicate objects will be created in Python for each "parent"
object. Since objects in Python have a decent bit of memory overhead this can
also be a consideration.</p>
<p><br></p>
<h3>Suggest</h3>
<p>Gone through the already posted answers. Just thought it would be better if I
add an answer with actual example.</p>
<p>Let' say you have 3 Django models which are related.</p>
<div class="code"><pre class="code literal-block"><span class="k">class</span> <span class="n">M1</span>(<span class="n">models</span>.<span class="n">Model</span>):
    <span class="nb">name</span> = <span class="n">models</span>.<span class="n">CharField</span>(<span class="n">max_length</span>=<span class="mi">10</span>)

<span class="k">class</span> <span class="n">M2</span>(<span class="n">models</span>.<span class="n">Model</span>):
    <span class="nb">name</span> = <span class="n">models</span>.<span class="n">CharField</span>(<span class="n">max_length</span>=<span class="mi">10</span>)
    <span class="n">select_relation</span> = <span class="n">models</span>.<span class="n">ForeignKey</span>(<span class="n">M1</span>, <span class="n">on_delete</span>=<span class="n">models</span>.<span class="n">CASCADE</span>)
    <span class="n">prefetch_relation</span> = <span class="n">models</span>.<span class="n">ManyToManyField</span>(<span class="nb">to</span>=<span class="s">'M3'</span>)

<span class="k">class</span> <span class="n">M3</span>(<span class="n">models</span>.<span class="n">Model</span>):
    <span class="nb">name</span> = <span class="n">models</span>.<span class="n">CharField</span>(<span class="n">max_length</span>=<span class="mi">10</span>)
</pre></div>

<p>Here you can query <code>M2</code> model and its relative <code>M1</code> objects using
<code>select_relation</code> field and <code>M3</code> objects using <code>prefetch_relation</code> field.</p>
<p>However as we've mentioned <code>M1</code>'s relation from <code>M2</code> is a <code>ForeignKey</code>, it
just returns only <strong>1</strong> record for any <code>M2</code> object. Same thing applies for
<code>OneToOneField</code> as well.</p>
<p>But <code>M3</code>'s relation from <code>M2</code> is a <code>ManyToManyField</code> which might return any
number of <code>M1</code> objects.</p>
<p>Consider a case where you have 2 <code>M2</code> objects <code>m21</code>, <code>m22</code> who have same <strong>5</strong>
associated <code>M3</code> objects with IDs <code>1,2,3,4,5</code>. When you fetch associated <code>M3</code>
objects for each of those <code>M2</code> objects, if you use select related, this is how
it's going to work.</p>
<p><strong>Steps:</strong></p>
<ol>
<li>Find <code>m21</code> object.</li>
<li>Query all the <code>M3</code> objects related to <code>m21</code> object whose IDs are <code>1,2,3,4,5</code>.</li>
<li>Repeat same thing for <code>m22</code> object and all other <code>M2</code> objects.</li>
</ol>
<p>As we have same <code>1,2,3,4,5</code> IDs for both <code>m21</code>, <code>m22</code> objects, if we use
select_related option, it's going to query the DB twice for the same IDs which
were already fetched.</p>
<p>Instead if you use prefetch_related, when you try to get <code>M2</code> objects, it will
make a note of all the IDs that your objects returned (Note: only the IDs)
while querying <code>M2</code> table and as last step, Django is going to make a query to
<code>M3</code> table with the set of all IDs that your <code>M2</code> objects have returned. and
join them to <code>M2</code> objects using Python instead of database.</p>
<p>This way you're querying all the <code>M3</code> objects only once which improves
performance as python joins are cheaper than database joins.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/arraylist-vs-list-in-c/" class="u-url">ArrayList vs List&lt;&gt; in C#</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/arraylist-vs-list-in-c/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T07:12:06+08:00" itemprop="datePublished" title="2023-03-03 07:12">2023-03-03 07:12</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>What is the difference between <code>ArrayList</code> and <code>List&lt;&gt;</code> in C#?</p>
<p>Is it only that <code>List&lt;&gt;</code> has a type while <code>ArrayList</code> doesn't?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Yes, pretty much. <code>List&lt;T&gt;</code> is a generic class. It supports storing values of
a specific type without casting to or from <code>object</code> (which would have incurred
boxing/unboxing overhead when <code>T</code> is a value type in the <code>ArrayList</code> case).
<code>ArrayList</code> simply stores <code>object</code> references. As a generic collection,
<code>List&lt;T&gt;</code> implements the generic <code>IEnumerable&lt;T&gt;</code> interface and can be used
easily in LINQ (without requiring any <code>Cast</code> or <code>OfType</code> call).</p>
<p><code>ArrayList</code> belongs to the days that C# didn't have generics. It's deprecated
in favor of <code>List&lt;T&gt;</code>. You shouldn't use <code>ArrayList</code> in new code that targets
.NET &gt;= 2.0 unless you have to interface with an old API that uses it.</p>
<p><br></p>
<h3>Suggest</h3>
<p>Using <code>List&lt;T&gt;</code> you can prevent casting errors. It is very useful to avoid a
<em>runtime</em> casting error.</p>
<p>Example:</p>
<p>Here (using <code>ArrayList</code>) you can compile this code but you will see an
execution error later.</p>
<div class="code"><pre class="code literal-block"><span class="n">ArrayList</span><span class="w"> </span><span class="n">array1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="p">();</span>
<span class="n">array1</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="n">array1</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="s">"Pony"</span><span class="p">);</span><span class="w"> </span><span class="c1">//No error at compile process</span>
<span class="n">int</span><span class="w"> </span><span class="n">total</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="n">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">int</span><span class="w"> </span><span class="n">num</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="n">array1</span><span class="p">)</span>
<span class="p">{</span>
<span class="w"> </span><span class="n">total</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">num</span><span class="p">;</span><span class="w"> </span><span class="c1">//--&gt;Runtime Error</span>
<span class="p">}</span>
</pre></div>

<p>If you use <code>List</code>, you avoid these errors:</p>
<div class="code"><pre class="code literal-block">List&lt;int&gt; list1 = new List&lt;int&gt;();
list1.Add(1);
//list1.Add("Pony"); //&lt;-- Error at compile process
int total = 0;
foreach (int num in list1 )
{
 total += num;
}
</pre></div>

<p>Reference: MSDN</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-1699.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-1697.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
