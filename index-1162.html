<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 1162) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-1162.html">
<link rel="prev" href="index-1163.html" type="text/html">
<link rel="next" href="index-1161.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/should-i-commit-the-vscode-folder-to-source-control/" class="u-url">Should I commit the .vscode folder to source control?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/should-i-commit-the-vscode-folder-to-source-control/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T02:44:33+08:00" itemprop="datePublished" title="2023-02-18 02:44">2023-02-18 02:44</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Is the <code>.vscode</code> folder meant to be committed to source control?</p>
<p>In a fresh project, the folder is empty, except the <code>settings.json</code> file. What
kind of things would go into this folder? Is it machine-specific, developer-
specific like the <code>.vs</code> folder and thus not be committed? Or should all
developers share this folder and thus it should be committed?</p>
<p>The comment at the top of the file <code>.vscode/settings.json</code> states:</p>
<div class="code"><pre class="code literal-block"><span class="c1">// Place your settings in this file to overwrite default and user settings.</span>
<span class="p">{</span>
<span class="p">}</span>
</pre></div>

<p>This seems to imply that the folder should contain project-specific settings
and thus be included in source. Also, this post on UserVoice seems to imply
some typings would go in there, also suggesting that it should be committed.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Check in the <code>.vscode</code> folder if you want to share settings, task
configuration and debug configuration with the team. I think generally it
makes sense to share settings (e.g. whitespace vs tabs) with the team if you
want to enforce settings in a team. We in the VS Code team share debug and
task specific settings as well because we want our team to have the same set
of debug targets and task targets for VS Code.</p>
<p>Btw you do not need to have a <code>.vscode</code> folder in your project for settings.
You can also configure settings on a user level.</p>
<p><br></p>
<h3>Suggest</h3>
<h2>Commit some files in <code>.vscode</code> folder</h2>
<p>Recommendation is to generally exclude <code>.vscode</code> folder, but leave select JSON
files that allow other developers to recreate shared settings.</p>
<p>Examples of settings to include:</p>
<ul>
<li>Language specific test configurations to run the test suite(s) (<code>settings.json</code>)</li>
<li>Extension settings for linters and code formatting tools to enforce the language rules used in this repo (<code>settings.json</code>)</li>
<li>Run and debug configurations (<code>launch.json</code>)</li>
<li>Shared tasks - if managed with VS Code (<code>tasks.json</code>)</li>
</ul>
<p>Note that some settings can be stored in the user settings or workspace file,
or transferred to it from the <code>.vscode</code> folder. See below.</p>
<hr>
<h2>Sample <code>.gitignore</code> code</h2>
<p>Here are the settings, as suggested at https://gitignore.io. You can search
for "VisualStudioCode" there to get the latest recommended <code>.gitignore</code> file.
I use this website as a starting point for <code>.gitignore</code> for most of my new
repos:</p>
<div class="code"><pre class="code literal-block"><span class="c1"># Created by https://www.gitignore.io/api/visualstudiocode</span>
<span class="c1"># Edit at https://www.gitignore.io/?templates=visualstudiocode</span>

<span class="c1">### VisualStudioCode ###</span>
<span class="na">.vscode</span><span class="cm">/*      # Maybe .vscode/**/</span><span class="p">*</span><span class="w"> </span><span class="no">instead</span><span class="w"> </span><span class="p">-</span><span class="w"> </span><span class="no">see</span><span class="w"> </span><span class="no">comments</span>
<span class="err">!</span><span class="na">.vscode</span><span class="err">/</span><span class="no">settings.json</span>
<span class="err">!</span><span class="na">.vscode</span><span class="err">/</span><span class="no">tasks.json</span>
<span class="err">!</span><span class="na">.vscode</span><span class="err">/</span><span class="no">launch.json</span>
<span class="err">!</span><span class="na">.vscode</span><span class="err">/</span><span class="no">extensions.json</span>

<span class="c1">### VisualStudioCode Patch ###</span>
<span class="c1"># Ignore all local history of files</span>
<span class="err">**/</span><span class="na">.history</span>

<span class="c1"># End of https://www.gitignore.io/api/visualstudiocode</span>
</pre></div>

<hr>
<p>In the above <code>.gitignore</code> file, the <code>.vscode/*</code> line (note: some debate on
whether the <code>*</code> should be included - see comments; <code>.vscode/**/*</code> may be
better to ignore nested folders as well) says to exclude everything in the
<code>.vscode</code> folder, but then the <code>!.vscode/a_specific_file</code> lines tell git to
"not" ignore some specific files in that folder (<code>settings.json</code>,
<code>launch.json</code>, etc.). The end result is that everything is excluded in the
<code>.vscode</code> folder except for the files specifically named in one of those other
lines.</p>
<hr>
<h2>Other Factors</h2>
<p>Including the <code>.vscode</code> folder in your repo doesn't actually <em>hurt</em> anyone
that uses a different IDE (or text/code editor).</p>
<p>However, it may cause issues for other people using VS Code, or some of the
settings may not load properly, if these files include generic settings that
require something specific to your environment - like the absolute path the
repo is installed in. The key is to avoid saving settings that are custom to
your local environment, only sharing those that can (or, in the case of this
repo, should) be used by everyone.</p>
<p>For example, if IDE setting files have absolute paths to the repo or any
files/libraries, etc., then that is bad, don't share. But if all the
references are relative, then they should work for anyone using the repo
(although, be careful about path specification differences between
Windows/Unix..).</p>
<hr>
<h2>About User, Workspace, and Folder settings</h2>
<p><strong>Note:</strong> the settings files in the <code>.vscode</code> folder are generally updated
when you make changes to the <em>folder</em> version of the settings - but this
appears to depend on how individual extensions are coded, because I've run
across multiple exceptions to this rule.</p>
<ul>
<li>If you make changes to the <em>user</em> settings, they are usually stored elsewhere (location depends on OS settings, usually in a home directory).</li>
<li>If you make changes to the <em>workspace</em> settings, they are usually stored in the <code>*.code-workspace</code> file that you are currently using. If you don't have a workspace (you directly opened a folder instead), then they will likely go to the <code>.vscode</code> folder, but, overall, this may depend on the extension that owns the setting anyway.</li>
</ul>
<p>So, you should generally put custom settings for your personal PC into the
<em>user</em> settings, and put generic settings into the <em>workspace</em> or <em>folder</em>
settings.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/javascript-closures-vs-anonymous-functions/" class="u-url">JavaScript closures vs. anonymous functions</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/javascript-closures-vs-anonymous-functions/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T02:44:06+08:00" itemprop="datePublished" title="2023-02-18 02:44">2023-02-18 02:44</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>A friend of mine and I are currently discussing what is a closure in JS and
what isn't. We just want to make sure we really understand it correctly.</p>
<p>Let's take this example. We have a counting loop and want to print the counter
variable on the console delayed. Therefore we use <code>setTimeout</code> and
<strong>closures</strong> to capture the value of the counter variable to make sure that it
will not print N times the value N.</p>
<p>The wrong solution without <strong>closures</strong> or anything near to <strong>closures</strong> would
be:</p>
<div class="code"><pre class="code literal-block"><span class="k">for</span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">setTimeout</span><span class="p">(</span><span class="n">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
<span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="mi">1000</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>

<p>which will of course print 10 times the value of <code>i</code> after the loop, namely
10.</p>
<p><strong>So his attempt was:</strong></p>
<div class="code"><pre class="code literal-block"><span class="k">for</span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="p">(</span><span class="n">function</span><span class="p">(){</span>
<span class="w">        </span><span class="k">var</span><span class="w"> </span><span class="n">i2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<span class="w">        </span><span class="n">setTimeout</span><span class="p">(</span><span class="n">function</span><span class="p">(){</span>
<span class="w">            </span><span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">i2</span><span class="p">);</span>
<span class="w">        </span><span class="p">},</span><span class="w"> </span><span class="mi">1000</span><span class="p">)</span>
<span class="w">    </span><span class="p">})();</span>
<span class="p">}</span>
</pre></div>

<p>printing 0 to 9 as expected.</p>
<p>I told him that he isn't using a <strong>closure</strong> to capture <code>i</code>, but he insists
that he is. I proved that he doesn't use <strong>closures</strong> by putting the for loop
body within another <code>setTimeout</code> (passing his anonymous function to
<code>setTimeout</code>), printing 10 times 10 again. The same applies if I store his
function in a <code>var</code> and execute it <em>after</em> the loop, also printing 10 times
10. So my argument is that <strong>he doesn't really <em>capture</em> the value of <code>i</code></strong>,
making his version <em>not</em> a closure.</p>
<p><strong>My attempt was:</strong></p>
<div class="code"><pre class="code literal-block"><span class="k">for</span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">setTimeout</span><span class="p">((</span><span class="n">function</span><span class="p">(</span><span class="n">i2</span><span class="p">){</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">i2</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">})(</span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="mi">1000</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>

<p>So I capture <code>i</code> (named <code>i2</code> within the closure), but now I <em>return</em> another
function and pass this around. <strong>In my case, the function passed to setTimeout
really captures<code>i</code>.</strong></p>
<p><strong>Now who is using closures and who isn't?</strong></p>
<p>Note that both solutions print 0 to 9 on the console delayed, so they solve
the original problem, but we want to understand which of those two solutions
<strong>uses closures</strong> to accomplish this.</p>
<p><br><br></p>
<h2>Answer</h2>
<p><strong>Editor's Note:</strong> All functions in JavaScript are closures as explained in
this post. However we are only interested in identifying a subset of these
functions which are interesting from a theoretical point of view. Henceforth
any reference to the word <em>closure</em> will refer to this subset of functions
unless otherwise stated.</p>
<p>A simple explanation for closures:</p>
<ol>
<li>Take a function. Let's call it F.</li>
<li>List all the variables of F.</li>
<li>The variables may be of two types: <ol>
<li>Local variables (bound variables)</li>
<li>Non-local variables (free variables)</li>
</ol>
</li>
<li>If F has no free variables then it cannot be a closure.</li>
<li>If F has any free variables (which are defined in <strong>a</strong> parent scope of F) then: <ol>
<li>There must be only one parent scope of F to which <strong>a</strong> free variable is bound.</li>
<li>If F is <strong>referenced</strong> from outside <strong>that</strong> parent scope, then it becomes a closure for <strong>that</strong> free variable.</li>
<li>
<strong>That</strong> free variable is called an upvalue of the closure F.</li>
</ol>
</li>
</ol>
<p>Now let's use this to figure out who uses closures and who doesn't (for the
sake of explanation I have named the functions):</p>
<p><strong>Case 1: Your Friend's Program</strong></p>
<div class="code"><pre class="code literal-block"><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="p">(</span><span class="n">function</span><span class="w"> </span><span class="n">f</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">var</span><span class="w"> </span><span class="n">i2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<span class="w">        </span><span class="n">setTimeout</span><span class="p">(</span><span class="n">function</span><span class="w"> </span><span class="n">g</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">i2</span><span class="p">);</span>
<span class="w">        </span><span class="p">},</span><span class="w"> </span><span class="mi">1000</span><span class="p">);</span>
<span class="w">    </span><span class="p">})();</span>
<span class="p">}</span>
</pre></div>

<p>In the above program there are two functions: <code>f</code> and <code>g</code>. Let's see if they
are closures:</p>
<p>For <code>f</code>:</p>
<ol>
<li>List the variables: <ol>
<li>
<code>i2</code> is a <strong>local</strong> variable.</li>
<li>
<code>i</code> is a <strong>free</strong> variable.</li>
<li>
<code>setTimeout</code> is a <strong>free</strong> variable.</li>
<li>
<code>g</code> is a <strong>local</strong> variable.</li>
<li>
<code>console</code> is a <strong>free</strong> variable.</li>
</ol>
</li>
<li>Find the parent scope to which each free variable is bound: <ol>
<li>
<code>i</code> is <strong>bound</strong> to the global scope.</li>
<li>
<code>setTimeout</code> is <strong>bound</strong> to the global scope.</li>
<li>
<code>console</code> is <strong>bound</strong> to the global scope.</li>
</ol>
</li>
<li>In which scope is the function <strong>referenced</strong>? The <strong>global scope</strong>. <ol>
<li>Hence <code>i</code> is not <strong>closed over</strong> by <code>f</code>.</li>
<li>Hence <code>setTimeout</code> is not <strong>closed over</strong> by <code>f</code>.</li>
<li>Hence <code>console</code> is not <strong>closed over</strong> by <code>f</code>.</li>
</ol>
</li>
</ol>
<p>Thus the function <code>f</code> is not a closure.</p>
<p>For <code>g</code>:</p>
<ol>
<li>List the variables: <ol>
<li>
<code>console</code> is a <strong>free</strong> variable.</li>
<li>
<code>i2</code> is a <strong>free</strong> variable.</li>
</ol>
</li>
<li>Find the parent scope to which each free variable is bound: <ol>
<li>
<code>console</code> is <strong>bound</strong> to the global scope.</li>
<li>
<code>i2</code> is <strong>bound</strong> to the scope of <code>f</code>.</li>
</ol>
</li>
<li>In which scope is the function <strong>referenced</strong>? The <strong>scope of<code>setTimeout</code></strong>. <ol>
<li>Hence <code>console</code> is not <strong>closed over</strong> by <code>g</code>.</li>
<li>Hence <code>i2</code> is <strong>closed over</strong> by <code>g</code>.</li>
</ol>
</li>
</ol>
<p>Thus the function <code>g</code> is a closure for the free variable <code>i2</code> (which is an
upvalue for <code>g</code>) <strong>when</strong> it's <strong>referenced</strong> from within <code>setTimeout</code>.</p>
<p><em>Bad for you:</em> Your friend is using a closure. The inner function is a
closure.</p>
<p><strong>Case 2: Your Program</strong></p>
<div class="code"><pre class="code literal-block"><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">setTimeout</span><span class="p">((</span><span class="n">function</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="n">i2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">g</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">i2</span><span class="p">);</span>
<span class="w">        </span><span class="p">};</span>
<span class="w">    </span><span class="p">})(</span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="mi">1000</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>

<p>In the above program there are two functions: <code>f</code> and <code>g</code>. Let's see if they
are closures:</p>
<p>For <code>f</code>:</p>
<ol>
<li>List the variables: <ol>
<li>
<code>i2</code> is a <strong>local</strong> variable.</li>
<li>
<code>g</code> is a <strong>local</strong> variable.</li>
<li>
<code>console</code> is a <strong>free</strong> variable.</li>
</ol>
</li>
<li>Find the parent scope to which each free variable is bound: <ol>
<li>
<code>console</code> is <strong>bound</strong> to the global scope.</li>
</ol>
</li>
<li>In which scope is the function <strong>referenced</strong>? The <strong>global scope</strong>. <ol>
<li>Hence <code>console</code> is not <strong>closed over</strong> by <code>f</code>.</li>
</ol>
</li>
</ol>
<p>Thus the function <code>f</code> is not a closure.</p>
<p>For <code>g</code>:</p>
<ol>
<li>List the variables: <ol>
<li>
<code>console</code> is a <strong>free</strong> variable.</li>
<li>
<code>i2</code> is a <strong>free</strong> variable.</li>
</ol>
</li>
<li>Find the parent scope to which each free variable is bound: <ol>
<li>
<code>console</code> is <strong>bound</strong> to the global scope.</li>
<li>
<code>i2</code> is <strong>bound</strong> to the scope of <code>f</code>.</li>
</ol>
</li>
<li>In which scope is the function <strong>referenced</strong>? The <strong>scope of<code>setTimeout</code></strong>. <ol>
<li>Hence <code>console</code> is not <strong>closed over</strong> by <code>g</code>.</li>
<li>Hence <code>i2</code> is <strong>closed over</strong> by <code>g</code>.</li>
</ol>
</li>
</ol>
<p>Thus the function <code>g</code> is a closure for the free variable <code>i2</code> (which is an
upvalue for <code>g</code>) <strong>when</strong> it's <strong>referenced</strong> from within <code>setTimeout</code>.</p>
<p><em>Good for you:</em> You are using a closure. The inner function is a closure.</p>
<p>So both you and your friend are using closures. Stop arguing. I hope I cleared
the concept of closures and how to identify them for the both of you.</p>
<p><strong>Edit:</strong> A simple explanation as to why are all functions closures (credits
@Peter):</p>
<p>First let's consider the following program (it's the control):</p>
<div class="code"><pre class="code literal-block"><span class="n">lexicalScope</span><span class="p">();</span>

<span class="n">function</span><span class="w"> </span><span class="n">lexicalScope</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"This is the control. You should be able to see this message being alerted."</span><span class="p">;</span>

<span class="w">    </span><span class="n">regularFunction</span><span class="p">();</span>

<span class="w">    </span><span class="n">function</span><span class="w"> </span><span class="n">regularFunction</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">alert</span><span class="p">(</span><span class="n">eval</span><span class="p">(</span><span class="s2">"message"</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>

<ol>
<li>We know that both <code>lexicalScope</code> and <code>regularFunction</code> aren't closures <strong>from the above definition</strong>.</li>
<li>When we execute the program <strong>we expect</strong> <code>message</code> to be alerted <strong>because</strong> <code>regularFunction</code> is not a closure (i.e. it has access to <strong>all</strong> the variables in its parent scope - including <code>message</code>).</li>
<li>When we execute the program <strong>we observe</strong> that <code>message</code> is indeed alerted.</li>
</ol>
<p>Next let's consider the following program (it's the alternative):</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">closureFunction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lexicalScope</span><span class="p">();</span>

<span class="n">closureFunction</span><span class="p">();</span>

<span class="n">function</span><span class="w"> </span><span class="n">lexicalScope</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"This is the alternative. If you see this message being alerted then in means that every function in JavaScript is a closure."</span><span class="p">;</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">closureFunction</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">alert</span><span class="p">(</span><span class="n">eval</span><span class="p">(</span><span class="s2">"message"</span><span class="p">));</span>
<span class="w">    </span><span class="p">};</span>
<span class="p">}</span>
</pre></div>

<ol>
<li>We know that only <code>closureFunction</code> is a closure <strong>from the above definition</strong>.</li>
<li>When we execute the program <strong>we expect</strong> <code>message</code> not to be alerted <strong>because</strong> <code>closureFunction</code> is a closure (i.e. it only has access to all its <strong>non-local variables</strong> at <strong>the time the function is created</strong> (see this answer) - this does not include <code>message</code>).</li>
<li>When we execute the program <strong>we observe</strong> that <code>message</code> is actually being alerted.</li>
</ol>
<p>What do we infer from this?</p>
<ol>
<li>JavaScript interpreters do not treat closures differently from the way they treat other functions.</li>
<li>Every function carries its scope chain along with it. Closures don't have a <strong>separate</strong> referencing environment.</li>
<li>A closure is just like every other function. We just call them closures when they are <strong>referenced</strong> in a scope <strong>outside</strong> the scope to which they belong <strong>because</strong> this is an interesting case.</li>
</ol>
<p><br></p>
<h3>Suggest</h3>
<p>According to the <code>closure</code> definition:</p>
<blockquote>
<p>A "closure" is an expression (typically a function) that can have <strong>free
variables</strong> together with an <strong>environment</strong> that binds those variables
(that "closes" the expression).</p>
</blockquote>
<p>You are using <code>closure</code> if you define a function which use a variable which is
defined outside of the function. (we call the variable a <strong>free variable</strong> ).<br>
They all use <code>closure</code>(even in the 1st example).</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-can-i-detect-changes-in-location-hash/" class="u-url">How can I detect changes in location hash?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-can-i-detect-changes-in-location-hash/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T02:43:41+08:00" itemprop="datePublished" title="2023-02-18 02:43">2023-02-18 02:43</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I am using Ajax and hash for navigation.</p>
<p>Is there a way to check if the <code>window.location.hash</code> changed like this?</p>
<p>http://example.com/blah <strong>#123</strong> to http://example.com/blah <strong>#456</strong></p>
<p>It works if I check it when the document loads.</p>
<p>But if I have #hash based navigation it doesn't work when I press the back
button on the browser (so I jump from blah#456 to blah#123).</p>
<p>It shows inside the address box, but I can't catch it with JavaScript.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>The only way to really do this (and is how the 'reallysimplehistory' does
this), is by setting an interval that keeps checking the current hash, and
comparing it against what it was before, we do this and let subscribers
subscribe to a changed event that we fire if the hash changes.. its not
perfect but browsers really don't support this event natively.</p>
<hr>
<p>Update to keep this answer fresh:</p>
<p>If you are using jQuery (which today should be somewhat foundational for most)
then a nice solution is to use the abstraction that jQuery gives you by using
its events system to listen to hashchange events on the window object.</p>
<div class="code"><pre class="code literal-block">$(window).on('hashchange', function() {
  //.. work ..
});
</pre></div>

<p>The nice thing here is you can write code that doesn't need to even worry
about hashchange support, however you DO need to do some magic, in form of a
somewhat lesser known jQuery feature jQuery special events.</p>
<p>With this feature you essentially get to run some setup code for any event,
the first time somebody attempts to use the event in any way (such as binding
to the event).</p>
<p>In this setup code you can check for native browser support and if the browser
doesn't natively implement this, you can setup a single timer to poll for
changes, and trigger the jQuery event.</p>
<p>This completely unbinds your code from needing to understand this support
problem, the implementation of a special event of this kind is trivial (to get
a simple 98% working version), but why do that when somebody else has already.</p>
<p><br></p>
<h3>Suggest</h3>
<p>HTML5 specifies a <code>hashchange</code> event. This event is now supported by all
modern browsers. Support was added in the following browser versions:</p>
<ul>
<li>Internet Explorer 8</li>
<li>Firefox 3.6</li>
<li>Chrome 5</li>
<li>Safari 5</li>
<li>Opera 10.6</li>
</ul>
</div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-1163.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-1161.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
