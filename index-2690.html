<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 2690) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-2690.html">
<link rel="prev" href="index-2691.html" type="text/html">
<link rel="next" href="index-2689.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-sum-all-the-values-in-a-dictionary/" class="u-url">How to sum all the values in a dictionary?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-sum-all-the-values-in-a-dictionary/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-05T10:40:13+08:00" itemprop="datePublished" title="2023-03-05 10:40">2023-03-05 10:40</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Let's say I have a dictionary in which the keys map to integers like:</p>
<div class="code"><pre class="code literal-block">d = {'key1': 1,'key2': 14,'key3': 47}
</pre></div>

<p>Is there a syntactically minimalistic way to return the sum of the values in
<code>d</code>—i.e. <code>62</code> in this case?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>As you'd expect:</p>
<div class="code"><pre class="code literal-block">sum(d.values())
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>In Python 2 you can avoid making a temporary copy of all the values by using
the <code>itervalues()</code> dictionary method, which returns an iterator of the
dictionary's keys:</p>
<div class="code"><pre class="code literal-block">sum(d.itervalues())
</pre></div>

<p>In Python 3 you can just use <code>d.values()</code> because that method was changed to
do that (and <code>itervalues()</code> was removed since it was no longer needed).</p>
<p>To make it easier to write version independent code which always iterates over
the values of the dictionary's keys, a utility function can be helpful:</p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="nn">sys</span>

<span class="k">def</span> <span class="nf">itervalues</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="p">(</span><span class="s1">'itervalues'</span><span class="p">,</span> <span class="s1">'values'</span><span class="p">)[</span><span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">])())</span>

<span class="nb">sum</span><span class="p">(</span><span class="n">itervalues</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
</pre></div>

<p>This is essentially what Benjamin Peterson's <code>six</code> module does.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/what-is-the-fastest-way-to-get-the-value-of-p/" class="u-url">What is the fastest way to get the value of π?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/what-is-the-fastest-way-to-get-the-value-of-p/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-05T10:38:20+08:00" itemprop="datePublished" title="2023-03-05 10:38">2023-03-05 10:38</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I'm looking for the fastest way to obtain the value of π, as a personal
challenge. More specifically, I'm using ways that don't involve using
<code>#define</code> constants like <code>M_PI</code>, or hard-coding the number in.</p>
<p>The program below tests the various ways I know of. The inline assembly
version is, in theory, the fastest option, though clearly not portable. I've
included it as a baseline to compare against the other versions. In my tests,
with built-ins, the <code>4 * atan(1)</code> version is fastest on GCC 4.2, because it
auto-folds the <code>atan(1)</code> into a constant. With <code>-fno-builtin</code> specified, the
<code>atan2(0, -1)</code> version is fastest.</p>
<p>Here's the main testing program (<code>pitimes.c</code>):</p>
<div class="code"><pre class="code literal-block"><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;math.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;time.h&gt;</span>

<span class="cp">#define ITERS 10000000</span>
<span class="cp">#define TESTWITH(x) {                                                       \</span>
<span class="cp">    diff = 0.0;                                                             \</span>
<span class="cp">    time1 = clock();                                                        \</span>
<span class="cp">    for (i = 0; i &lt; ITERS; ++i)                                             \</span>
<span class="cp">        diff += (x) - M_PI;                                                 \</span>
<span class="cp">    time2 = clock();                                                        \</span>
<span class="cp">    printf("%s\t=&gt; %e, time =&gt; %f\n", #x, diff, diffclock(time2, time1));   \</span>
<span class="cp">}</span>

<span class="k">static</span><span class="w"> </span><span class="kr">inline</span><span class="w"> </span><span class="kt">double</span>
<span class="nf">diffclock</span><span class="p">(</span><span class="kt">clock_t</span><span class="w"> </span><span class="n">time1</span><span class="p">,</span><span class="w"> </span><span class="kt">clock_t</span><span class="w"> </span><span class="n">time0</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="kt">double</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">time1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">time0</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">CLOCKS_PER_SEC</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span>
<span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<span class="w">    </span><span class="kt">clock_t</span><span class="w"> </span><span class="n">time1</span><span class="p">,</span><span class="w"> </span><span class="n">time2</span><span class="p">;</span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">diff</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/* Warmup. The atan2 case catches GCC's atan folding (which would</span>
<span class="cm">     * optimise the ``4 * atan(1) - M_PI'' to a no-op), if -fno-builtin</span>
<span class="cm">     * is not used. */</span>
<span class="w">    </span><span class="n">TESTWITH</span><span class="p">(</span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">atan</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="w">    </span><span class="n">TESTWITH</span><span class="p">(</span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">atan2</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>

<span class="cp">#if defined(__GNUC__) &amp;&amp; (defined(__i386__) || defined(__amd64__))</span>
<span class="w">    </span><span class="k">extern</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">fldpi</span><span class="p">();</span>
<span class="w">    </span><span class="n">TESTWITH</span><span class="p">(</span><span class="n">fldpi</span><span class="p">())</span>
<span class="cp">#endif</span>

<span class="w">    </span><span class="cm">/* Actual tests start here. */</span>
<span class="w">    </span><span class="n">TESTWITH</span><span class="p">(</span><span class="n">atan2</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">))</span>
<span class="w">    </span><span class="n">TESTWITH</span><span class="p">(</span><span class="n">acos</span><span class="p">(</span><span class="mi">-1</span><span class="p">))</span>
<span class="w">    </span><span class="n">TESTWITH</span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">asin</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="w">    </span><span class="n">TESTWITH</span><span class="p">(</span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">atan2</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>
<span class="w">    </span><span class="n">TESTWITH</span><span class="p">(</span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">atan</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<p>And the inline assembly stuff (<code>fldpi.c</code>) that will only work for x86 and x64
systems:</p>
<div class="code"><pre class="code literal-block"><span class="nv">double</span>
<span class="nv">fldpi</span><span class="ss">()</span>
{
<span class="w">    </span><span class="nv">double</span><span class="w"> </span><span class="nv">pi</span><span class="c1">;</span>
<span class="w">    </span><span class="nv">asm</span><span class="ss">(</span><span class="s2">"fldpi"</span><span class="w"> </span>:<span class="w"> </span><span class="s2">"=t"</span><span class="w"> </span><span class="ss">(</span><span class="nv">pi</span><span class="ss">))</span><span class="c1">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nv">pi</span><span class="c1">;</span>
}
</pre></div>

<p>And a build script that builds all the configurations I'm testing
(<code>build.sh</code>):</p>
<div class="code"><table class="codetable">
<tr>
<td class="linenos linenodiv"><a href="posts/what-is-the-fastest-way-to-get-the-value-of-p/#-1"><code data-line-number=" 1"></code></a></td>
<td class="code"><code><span class="ch">#!/bin/sh</span>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/what-is-the-fastest-way-to-get-the-value-of-p/#-2"><code data-line-number=" 2"></code></a></td>
<td class="code"><code>gcc<span class="w"> </span>-O3<span class="w"> </span>-Wall<span class="w"> </span>-c<span class="w">           </span>-m32<span class="w"> </span>-o<span class="w"> </span>fldpi-32.o<span class="w"> </span>fldpi.c
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/what-is-the-fastest-way-to-get-the-value-of-p/#-3"><code data-line-number=" 3"></code></a></td>
<td class="code"><code>gcc<span class="w"> </span>-O3<span class="w"> </span>-Wall<span class="w"> </span>-c<span class="w">           </span>-m64<span class="w"> </span>-o<span class="w"> </span>fldpi-64.o<span class="w"> </span>fldpi.c
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/what-is-the-fastest-way-to-get-the-value-of-p/#-4"><code data-line-number=" 4"></code></a></td>
<td class="code"><code>
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/what-is-the-fastest-way-to-get-the-value-of-p/#-5"><code data-line-number=" 5"></code></a></td>
<td class="code"><code>gcc<span class="w"> </span>-O3<span class="w"> </span>-Wall<span class="w"> </span>-ffast-math<span class="w">  </span>-m32<span class="w"> </span>-o<span class="w"> </span>pitimes1-32<span class="w"> </span>pitimes.c<span class="w"> </span>fldpi-32.o
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/what-is-the-fastest-way-to-get-the-value-of-p/#-6"><code data-line-number=" 6"></code></a></td>
<td class="code"><code>gcc<span class="w"> </span>-O3<span class="w"> </span>-Wall<span class="w">              </span>-m32<span class="w"> </span>-o<span class="w"> </span>pitimes2-32<span class="w"> </span>pitimes.c<span class="w"> </span>fldpi-32.o<span class="w"> </span>-lm
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/what-is-the-fastest-way-to-get-the-value-of-p/#-7"><code data-line-number=" 7"></code></a></td>
<td class="code"><code>gcc<span class="w"> </span>-O3<span class="w"> </span>-Wall<span class="w"> </span>-fno-builtin<span class="w"> </span>-m32<span class="w"> </span>-o<span class="w"> </span>pitimes3-32<span class="w"> </span>pitimes.c<span class="w"> </span>fldpi-32.o<span class="w"> </span>-lm
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/what-is-the-fastest-way-to-get-the-value-of-p/#-8"><code data-line-number=" 8"></code></a></td>
<td class="code"><code>gcc<span class="w"> </span>-O3<span class="w"> </span>-Wall<span class="w"> </span>-ffast-math<span class="w">  </span>-m64<span class="w"> </span>-o<span class="w"> </span>pitimes1-64<span class="w"> </span>pitimes.c<span class="w"> </span>fldpi-64.o<span class="w"> </span>-lm
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/what-is-the-fastest-way-to-get-the-value-of-p/#-9"><code data-line-number=" 9"></code></a></td>
<td class="code"><code>gcc<span class="w"> </span>-O3<span class="w"> </span>-Wall<span class="w">              </span>-m64<span class="w"> </span>-o<span class="w"> </span>pitimes2-64<span class="w"> </span>pitimes.c<span class="w"> </span>fldpi-64.o<span class="w"> </span>-lm
</code></td>
</tr>
<tr>
<td class="linenos linenodiv"><a href="posts/what-is-the-fastest-way-to-get-the-value-of-p/#-10"><code data-line-number="10"></code></a></td>
<td class="code"><code>gcc<span class="w"> </span>-O3<span class="w"> </span>-Wall<span class="w"> </span>-fno-builtin<span class="w"> </span>-m64<span class="w"> </span>-o<span class="w"> </span>pitimes3-64<span class="w"> </span>pitimes.c<span class="w"> </span>fldpi-64.o<span class="w"> </span>-lm
</code></td>
</tr>
</table></div>
<p>Apart from testing between various compiler flags (I've compared 32-bit
against 64-bit too because the optimizations are different), I've also tried
switching the order of the tests around. But still, the <code>atan2(0, -1)</code> version
still comes out on top every time.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>The Monte Carlo method, as mentioned, applies some great concepts but it is,
clearly, not the fastest, not by a long shot, not by any reasonable measure.
Also, it all depends on what kind of accuracy you are looking for. The fastest
π I know of is the one with the digits hard coded. Looking at Pi and Pi[PDF],
there are a lot of formulae.</p>
<p>Here is a method that converges quickly — about 14 digits per iteration.
PiFast, the current fastest application, uses this formula with the FFT. I'll
just write the formula, since the code is straightforward. This formula was
almost found by Ramanujan and discovered by Chudnovsky. It is actually how he
calculated several billion digits of the number — so it isn't a method to
disregard. The formula will overflow quickly and, since we are dividing
factorials, it would be advantageous then to delay such calculations to remove
terms.</p>
<p><img alt="enter image description here" src="images/aQMkk.gif"></p>
<p><img alt="enter image description here" src="images/2y2l9.gif"></p>
<p>where,</p>
<p><img alt="enter image description here" src="images/QqVnB.gif"></p>
<p>Below is the Brent–Salamin algorithm. Wikipedia mentions that when <strong>a</strong> and
<strong>b</strong> are "close enough" then <strong>(a + b)² / 4t</strong> will be an approximation of π.
I'm not sure what "close enough" means, but from my tests, one iteration got 2
digits, two got 7, and three had 15, of course this is with doubles, so it
might have an error based on its representation and the <em>true</em> calculation
could be more accurate.</p>
<div class="code"><pre class="code literal-block"><span class="nv">let</span><span class="w"> </span><span class="nv">pi_2</span><span class="w"> </span><span class="nv">iters</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="nv">let</span><span class="w"> </span><span class="nv">rec</span><span class="w"> </span><span class="nv">loop_</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">b</span><span class="w"> </span><span class="nv">t</span><span class="w"> </span><span class="nv">p</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="o">=</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="nv">a</span>,<span class="nv">b</span>,<span class="nv">t</span>,<span class="nv">p</span>
<span class="w">        </span><span class="k">else</span>
<span class="w">            </span><span class="nv">let</span><span class="w"> </span><span class="nv">a_n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">(</span><span class="nv">a</span><span class="w"> </span><span class="o">+</span>.<span class="w"> </span><span class="nv">b</span><span class="ss">)</span><span class="w"> </span><span class="o">/</span>.<span class="w"> </span><span class="mi">2</span>.<span class="mi">0</span><span class="w"> </span>
<span class="w">            </span><span class="nv">and</span><span class="w"> </span><span class="nv">b_n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">sqrt</span><span class="w"> </span><span class="ss">(</span><span class="nv">a</span><span class="o">*</span>.<span class="nv">b</span><span class="ss">)</span>
<span class="w">            </span><span class="nv">and</span><span class="w"> </span><span class="nv">p_n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>.<span class="mi">0</span><span class="w"> </span><span class="o">*</span>.<span class="w"> </span><span class="nv">p</span><span class="w"> </span><span class="nv">in</span>
<span class="w">            </span><span class="nv">let</span><span class="w"> </span><span class="nv">t_n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">t</span><span class="w"> </span><span class="o">-</span>.<span class="w"> </span><span class="ss">(</span><span class="nv">p</span><span class="w"> </span><span class="o">*</span>.<span class="w"> </span><span class="ss">(</span><span class="nv">a</span><span class="w"> </span><span class="o">-</span>.<span class="w"> </span><span class="nv">a_n</span><span class="ss">)</span><span class="w"> </span><span class="o">*</span>.<span class="w"> </span><span class="ss">(</span><span class="nv">a</span><span class="w"> </span><span class="o">-</span>.<span class="w"> </span><span class="nv">a_n</span><span class="ss">))</span><span class="w"> </span><span class="nv">in</span>
<span class="w">            </span><span class="nv">loop_</span><span class="w"> </span><span class="nv">a_n</span><span class="w"> </span><span class="nv">b_n</span><span class="w"> </span><span class="nv">t_n</span><span class="w"> </span><span class="nv">p_n</span><span class="w"> </span><span class="ss">(</span><span class="nv">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="ss">)</span>
<span class="w">    </span><span class="nv">in</span><span class="w"> </span>
<span class="w">    </span><span class="nv">let</span><span class="w"> </span><span class="nv">a</span>,<span class="nv">b</span>,<span class="nv">t</span>,<span class="nv">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">loop_</span><span class="w"> </span><span class="ss">(</span><span class="mi">1</span>.<span class="mi">0</span><span class="ss">)</span><span class="w"> </span><span class="ss">(</span><span class="mi">1</span>.<span class="mi">0</span><span class="w"> </span><span class="o">/</span>.<span class="w"> </span><span class="ss">(</span><span class="nv">sqrt</span><span class="w"> </span><span class="mi">2</span>.<span class="mi">0</span><span class="ss">))</span><span class="w"> </span><span class="ss">(</span><span class="mi">1</span>.<span class="mi">0</span><span class="o">/</span>.<span class="mi">4</span>.<span class="mi">0</span><span class="ss">)</span><span class="w"> </span><span class="ss">(</span><span class="mi">1</span>.<span class="mi">0</span><span class="ss">)</span><span class="w"> </span><span class="nv">iters</span><span class="w"> </span><span class="nv">in</span>
<span class="w">    </span><span class="ss">(</span><span class="nv">a</span><span class="w"> </span><span class="o">+</span>.<span class="w"> </span><span class="nv">b</span><span class="ss">)</span><span class="w"> </span><span class="o">*</span>.<span class="w"> </span><span class="ss">(</span><span class="nv">a</span><span class="w"> </span><span class="o">+</span>.<span class="w"> </span><span class="nv">b</span><span class="ss">)</span><span class="w"> </span><span class="o">/</span>.<span class="w"> </span><span class="ss">(</span><span class="mi">4</span>.<span class="mi">0</span><span class="w"> </span><span class="o">*</span>.<span class="w"> </span><span class="nv">t</span><span class="ss">)</span>
</pre></div>

<p>Lastly, how about some pi golf (800 digits)? 160 characters!</p>
<div class="code"><pre class="code literal-block"><span class="nc">int</span><span class="w"> </span><span class="n">a</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="mi">2800</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">f</span><span class="o">[</span><span class="n">2801</span><span class="o">]</span><span class="p">,</span><span class="n">g</span><span class="p">;</span><span class="n">main</span><span class="p">()</span><span class="err">{</span><span class="k">for</span><span class="p">(;</span><span class="n">b</span><span class="o">-</span><span class="n">c</span><span class="p">;)</span><span class="n">f</span><span class="o">[</span><span class="n">b++</span><span class="o">]=</span><span class="n">a</span><span class="o">/</span><span class="mi">5</span><span class="p">;</span><span class="k">for</span><span class="p">(;</span><span class="n">d</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">g</span><span class="o">=</span><span class="n">c</span><span class="o">*</span><span class="mi">2</span><span class="p">;</span><span class="n">c</span><span class="o">-=</span><span class="mi">14</span><span class="p">,</span><span class="n">printf</span><span class="p">(</span><span class="ss">"%.4d"</span><span class="p">,</span><span class="n">e</span><span class="o">+</span><span class="n">d</span><span class="o">/</span><span class="n">a</span><span class="p">),</span><span class="n">e</span><span class="o">=</span><span class="n">d</span><span class="o">%</span><span class="n">a</span><span class="p">)</span><span class="k">for</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="n">c</span><span class="p">;</span><span class="n">d</span><span class="o">+=</span><span class="n">f</span><span class="o">[</span><span class="n">b</span><span class="o">]*</span><span class="n">a</span><span class="p">,</span><span class="n">f</span><span class="o">[</span><span class="n">b</span><span class="o">]=</span><span class="n">d</span><span class="o">%</span><span class="c1">--g,d/=g--,--b;d*=b);}</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>I really like this program, because it approximates π by looking at its own
area.</p>
<p>IOCCC 1988 : westley.c</p>
<blockquote>
<div class="code"><pre class="code literal-block"><span class="c">#define _ </span><span class="nb">-</span><span class="c">F</span><span class="nv">&lt;</span><span class="c">00||</span><span class="nb">--</span><span class="c">F</span><span class="nb">-</span><span class="c">OO</span><span class="nb">--</span><span class="c">;</span>
<span class="c">int F=00</span><span class="nt">,</span><span class="c">OO=00;main(){F_OO();printf("%1</span><span class="nt">.</span><span class="c">3f\n"</span><span class="nt">,</span><span class="c">4</span><span class="nt">.</span><span class="c">*</span><span class="nb">-</span><span class="c">F/OO/OO);}F_OO()</span>
<span class="c">{</span>
<span class="c">            _</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span>
<span class="c">       _</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span>
<span class="c">    _</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span>
<span class="c">  _</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span>
<span class="c"> _</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span>
<span class="c"> _</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span>
<span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span>
<span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span>
<span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span>
<span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span>
<span class="c"> _</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span>
<span class="c"> _</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span>
<span class="c">  _</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span>
<span class="c">    _</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span>
<span class="c">        _</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span>
<span class="c">            _</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span><span class="nb">-</span><span class="c">_</span>
<span class="c">}</span>
</pre></div>

</blockquote>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/get-a-random-boolean-in-python/" class="u-url">Get a random boolean in python?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/get-a-random-boolean-in-python/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-05T10:36:47+08:00" itemprop="datePublished" title="2023-03-05 10:36">2023-03-05 10:36</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I am looking for the best way (fast and elegant) to get a random boolean in
python (flip a coin).</p>
<p>For the moment I am using <code>random.randint(0, 1)</code> or <code>random.getrandbits(1)</code>.</p>
<p>Are there better choices that I am not aware of?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Adam's answer is quite fast, but I found that <code>random.getrandbits(1)</code> to be
quite a lot faster. If you really want a boolean instead of a long then</p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="nn">random</span>
<span class="nb">bool</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">getrandbits</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
</pre></div>

<p>is still about twice as fast as <code>random.choice([True, False])</code></p>
<p>Both solutions need to <code>import random</code></p>
<p>If utmost speed isn't to priority then <code>random.choice</code> definitely reads
better.</p>
<p>Note that <code>random.choice()</code> is slower than just <code>choice()</code> (after <code>from random
import choice</code>) due to the attribute lookup.</p>
<div class="code"><pre class="code literal-block"><span class="err">$</span> <span class="n">python3</span> <span class="o">--</span><span class="n">version</span>
<span class="n">Python</span> <span class="mf">3.9.7</span>
<span class="err">$</span> <span class="n">python3</span> <span class="o">-</span><span class="n">m</span> <span class="n">timeit</span> <span class="o">-</span><span class="n">s</span> <span class="s2">"from random import choice"</span> <span class="s2">"choice([True, False])"</span>
<span class="mi">1000000</span> <span class="n">loops</span><span class="p">,</span> <span class="n">best</span> <span class="n">of</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">376</span> <span class="n">nsec</span> <span class="n">per</span> <span class="n">loop</span>
<span class="err">$</span> <span class="n">python3</span> <span class="o">-</span><span class="n">m</span> <span class="n">timeit</span> <span class="o">-</span><span class="n">s</span> <span class="s2">"from random import choice"</span> <span class="s2">"choice((True, False))"</span>
<span class="mi">1000000</span> <span class="n">loops</span><span class="p">,</span> <span class="n">best</span> <span class="n">of</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">352</span> <span class="n">nsec</span> <span class="n">per</span> <span class="n">loop</span>
<span class="err">$</span> <span class="n">python3</span> <span class="o">-</span><span class="n">m</span> <span class="n">timeit</span> <span class="o">-</span><span class="n">s</span> <span class="s2">"from random import getrandbits"</span> <span class="s2">"getrandbits(1)"</span>
<span class="mi">10000000</span> <span class="n">loops</span><span class="p">,</span> <span class="n">best</span> <span class="n">of</span> <span class="mi">5</span><span class="p">:</span> <span class="mf">33.7</span> <span class="n">nsec</span> <span class="n">per</span> <span class="n">loop</span>
<span class="err">$</span> <span class="n">python3</span> <span class="o">-</span><span class="n">m</span> <span class="n">timeit</span> <span class="o">-</span><span class="n">s</span> <span class="s2">"from random import getrandbits"</span> <span class="s2">"bool(getrandbits(1))"</span>
<span class="mi">5000000</span> <span class="n">loops</span><span class="p">,</span> <span class="n">best</span> <span class="n">of</span> <span class="mi">5</span><span class="p">:</span> <span class="mf">89.5</span> <span class="n">nsec</span> <span class="n">per</span> <span class="n">loop</span>
<span class="err">$</span> <span class="n">python3</span> <span class="o">-</span><span class="n">m</span> <span class="n">timeit</span> <span class="o">-</span><span class="n">s</span> <span class="s2">"from random import getrandbits"</span> <span class="s2">"not getrandbits(1)"</span>
<span class="mi">5000000</span> <span class="n">loops</span><span class="p">,</span> <span class="n">best</span> <span class="n">of</span> <span class="mi">5</span><span class="p">:</span> <span class="mf">46.3</span> <span class="n">nsec</span> <span class="n">per</span> <span class="n">loop</span>
<span class="err">$</span> <span class="n">python3</span> <span class="o">-</span><span class="n">m</span> <span class="n">timeit</span> <span class="o">-</span><span class="n">s</span> <span class="s2">"from random import random"</span> <span class="s2">"random() &lt; 0.5"</span>
<span class="mi">5000000</span> <span class="n">loops</span><span class="p">,</span> <span class="n">best</span> <span class="n">of</span> <span class="mi">5</span><span class="p">:</span> <span class="mf">46.4</span> <span class="n">nsec</span> <span class="n">per</span> <span class="n">loop</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="nn">random</span>
<span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">])</span>
</pre></div>

<p>would also work.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-2691.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-2689.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
