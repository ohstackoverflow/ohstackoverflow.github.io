<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 907) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-907.html">
<link rel="prev" href="index-908.html" type="text/html">
<link rel="next" href="index-906.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/send-email-intent/" class="u-url">Send Email Intent</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/send-email-intent/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T19:12:31+08:00" itemprop="datePublished" title="2023-02-17 19:12">2023-02-17 19:12</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div class="code"><pre class="code literal-block"><span class="n">Intent</span><span class="w"> </span><span class="n">intent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Intent</span><span class="p">(</span><span class="n">Intent</span><span class="p">.</span><span class="n">ACTION_SEND</span><span class="p">);</span>
<span class="n">intent</span><span class="p">.</span><span class="n">setType</span><span class="p">(</span><span class="ss">"text/html"</span><span class="p">);</span>
<span class="n">intent</span><span class="p">.</span><span class="n">putExtra</span><span class="p">(</span><span class="n">Intent</span><span class="p">.</span><span class="n">EXTRA_EMAIL</span><span class="p">,</span><span class="w"> </span><span class="ss">"emailaddress@emailaddress.com"</span><span class="p">);</span>
<span class="n">intent</span><span class="p">.</span><span class="n">putExtra</span><span class="p">(</span><span class="n">Intent</span><span class="p">.</span><span class="n">EXTRA_SUBJECT</span><span class="p">,</span><span class="w"> </span><span class="ss">"Subject"</span><span class="p">);</span>
<span class="n">intent</span><span class="p">.</span><span class="n">putExtra</span><span class="p">(</span><span class="n">Intent</span><span class="p">.</span><span class="n">EXTRA_TEXT</span><span class="p">,</span><span class="w"> </span><span class="ss">"I'm email body."</span><span class="p">);</span>
<span class="n">startActivity</span><span class="p">(</span><span class="n">Intent</span><span class="p">.</span><span class="n">createChooser</span><span class="p">(</span><span class="n">intent</span><span class="p">,</span><span class="w"> </span><span class="ss">"Send Email"</span><span class="p">));</span>
</pre></div>

<p>The above code opens a dialog showing the following apps:- Bluetooth, Google
Docs, Yahoo Mail, Gmail, Orkut, Skype, etc.</p>
<p>Actually, I want to filter these list options. I want to show only email-
related apps e.g. Gmail, and Yahoo Mail. How to do it?</p>
<p>I've seen such an example on the 'Android Market application.</p>
<ol>
<li>Open the Android Market app</li>
<li>Open any application where the developer has specified his/her email address. (If you can't find such an app just open my app:- market://details?id=com.becomputer06.vehicle.diary.free, OR search by 'Vehicle Diary')</li>
<li>Scroll down to 'DEVELOPER'</li>
<li>Click on 'Send Email'</li>
</ol>
<p>The dialog shows only email Apps e.g. Gmail, Yahoo Mail, etc. It does not show
Bluetooth, Orkut, etc. What code produces such dialog?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>when you will change your intent.setType like below you will get</p>
<div class="code"><pre class="code literal-block">intent.setType("text/plain");
</pre></div>

<p>Use <code>android.content.Intent.ACTION_SENDTO</code> to get only the list of e-mail
clients, with no facebook or other apps. Just the email clients. Ex:</p>
<div class="code"><pre class="code literal-block"><span class="n">new</span> <span class="n">Intent</span><span class="p">(</span><span class="n">Intent</span><span class="p">.</span><span class="n">ACTION_SENDTO</span><span class="p">);</span>
</pre></div>

<p>I wouldn't suggest you get directly to the email app. Let the user choose his
favorite email app. Don't constrain him.</p>
<p>If you use ACTION_SENDTO, putExtra does not work to add subject and text to
the intent. Use Uri to add the subject and body text.</p>
<p><strong>EDIT:</strong> We can use <code>message/rfc822</code> instead of <code>"text/plain"</code> as the MIME
type. However, that is not indicating "only offer email clients" -- it
indicates "offer anything that supports message/rfc822 data". That could
readily include some application that are not email clients.</p>
<p><code>message/rfc822</code> supports MIME Types of <code>.mhtml, .mht, .mime</code></p>
<p><br></p>
<h3>Suggest</h3>
<p>There are three main approaches:</p>
<div class="code"><pre class="code literal-block">String email = /* Your email address here */
String subject = /* Your subject here */
String body = /* Your body here */
String chooserTitle = /* Your chooser title here */
</pre></div>

<p><strong>1. Custom<code>Uri</code>:</strong></p>
<div class="code"><pre class="code literal-block"><span class="nt">Uri</span><span class="w"> </span><span class="nt">uri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">Uri</span><span class="p">.</span><span class="nc">parse</span><span class="o">(</span><span class="s2">"mailto:"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nt">email</span><span class="o">)</span>
<span class="w">    </span><span class="p">.</span><span class="nc">buildUpon</span><span class="o">()</span>
<span class="w">    </span><span class="p">.</span><span class="nc">appendQueryParameter</span><span class="o">(</span><span class="s2">"subject"</span><span class="o">,</span><span class="w"> </span><span class="nt">subject</span><span class="o">)</span>
<span class="w">    </span><span class="p">.</span><span class="nc">appendQueryParameter</span><span class="o">(</span><span class="s2">"body"</span><span class="o">,</span><span class="w"> </span><span class="nt">body</span><span class="o">)</span>
<span class="w">    </span><span class="p">.</span><span class="nc">build</span><span class="o">();</span>

<span class="nt">Intent</span><span class="w"> </span><span class="nt">emailIntent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">new</span><span class="w"> </span><span class="nt">Intent</span><span class="o">(</span><span class="nt">Intent</span><span class="p">.</span><span class="nc">ACTION_SENDTO</span><span class="o">,</span><span class="w"> </span><span class="nt">uri</span><span class="o">);</span>
<span class="nt">startActivity</span><span class="o">(</span><span class="nt">Intent</span><span class="p">.</span><span class="nc">createChooser</span><span class="o">(</span><span class="nt">emailIntent</span><span class="o">,</span><span class="w"> </span><span class="nt">chooserTitle</span><span class="o">));</span>
</pre></div>

<p><strong>2. Using<code>Intent</code> extras:</strong></p>
<div class="code"><pre class="code literal-block"><span class="nt">Intent</span><span class="w"> </span><span class="nt">emailIntent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">new</span><span class="w"> </span><span class="nt">Intent</span><span class="o">(</span><span class="nt">Intent</span><span class="p">.</span><span class="nc">ACTION_SENDTO</span><span class="o">,</span><span class="w"> </span><span class="nt">Uri</span><span class="p">.</span><span class="nc">parse</span><span class="o">(</span><span class="s2">"mailto:"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nt">email</span><span class="o">));</span>
<span class="nt">emailIntent</span><span class="p">.</span><span class="nc">putExtra</span><span class="o">(</span><span class="nt">Intent</span><span class="p">.</span><span class="nc">EXTRA_SUBJECT</span><span class="o">,</span><span class="w"> </span><span class="nt">subject</span><span class="o">);</span>
<span class="nt">emailIntent</span><span class="p">.</span><span class="nc">putExtra</span><span class="o">(</span><span class="nt">Intent</span><span class="p">.</span><span class="nc">EXTRA_TEXT</span><span class="o">,</span><span class="w"> </span><span class="nt">body</span><span class="o">);</span>
<span class="o">//</span><span class="nt">emailIntent</span><span class="p">.</span><span class="nc">putExtra</span><span class="o">(</span><span class="nt">Intent</span><span class="p">.</span><span class="nc">EXTRA_HTML_TEXT</span><span class="o">,</span><span class="w"> </span><span class="nt">body</span><span class="o">);</span><span class="w"> </span><span class="o">//</span><span class="nt">If</span><span class="w"> </span><span class="nt">you</span><span class="w"> </span><span class="nt">are</span><span class="w"> </span><span class="nt">using</span><span class="w"> </span><span class="nt">HTML</span><span class="w"> </span><span class="nt">in</span><span class="w"> </span><span class="nt">your</span><span class="w"> </span><span class="nt">body</span><span class="w"> </span><span class="nt">text</span>

<span class="nt">startActivity</span><span class="o">(</span><span class="nt">Intent</span><span class="p">.</span><span class="nc">createChooser</span><span class="o">(</span><span class="nt">emailIntent</span><span class="o">,</span><span class="w"> </span><span class="s2">"Chooser Title"</span><span class="o">));</span>
</pre></div>

<p><strong>3. Support Library<code>ShareCompat</code>:</strong></p>
<div class="code"><pre class="code literal-block"><span class="nv">Activity</span><span class="w"> </span><span class="nv">activity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="cm">/* Your activity here */</span>

<span class="nv">ShareCompat</span>.<span class="nv">IntentBuilder</span>.<span class="nv">from</span><span class="ss">(</span><span class="nv">activity</span><span class="ss">)</span>
<span class="w">    </span>.<span class="nv">setType</span><span class="ss">(</span><span class="s2">"message/rfc822"</span><span class="ss">)</span>
<span class="w">    </span>.<span class="nv">addEmailTo</span><span class="ss">(</span><span class="nv">email</span><span class="ss">)</span>
<span class="w">    </span>.<span class="nv">setSubject</span><span class="ss">(</span><span class="nv">subject</span><span class="ss">)</span>
<span class="w">    </span>.<span class="nv">setText</span><span class="ss">(</span><span class="nv">body</span><span class="ss">)</span>
<span class="w">    </span><span class="o">//</span>.<span class="nv">setHtmlText</span><span class="ss">(</span><span class="nv">body</span><span class="ss">)</span><span class="w"> </span><span class="o">//</span><span class="k">If</span><span class="w"> </span><span class="nv">you</span><span class="w"> </span><span class="nv">are</span><span class="w"> </span><span class="nv">using</span><span class="w"> </span><span class="nv">HTML</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">your</span><span class="w"> </span><span class="nv">body</span><span class="w"> </span><span class="nv">text</span>
<span class="w">    </span>.<span class="nv">setChooserTitle</span><span class="ss">(</span><span class="nv">chooserTitle</span><span class="ss">)</span>
<span class="w">    </span>.<span class="nv">startChooser</span><span class="ss">()</span><span class="c1">;</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/why-is-iostream-eof-inside-a-loop-condition-i-e-while-stream-eof-considered-wrong/" class="u-url">Why is iostream::eof inside a loop condition (i.e. `while (!stream.eof())`) considered wrong?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/why-is-iostream-eof-inside-a-loop-condition-i-e-while-stream-eof-considered-wrong/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T19:12:04+08:00" itemprop="datePublished" title="2023-02-17 19:12">2023-02-17 19:12</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I just found a comment in this answer saying that using <code>iostream::eof</code> in a
loop condition is "almost certainly wrong". I generally use something like
<code>while(cin&gt;&gt;n)</code> - which I guess implicitly checks for EOF.</p>
<p>Why is checking for eof explicitly using <code>while (!cin.eof())</code> wrong?</p>
<p>How is it different from using <code>scanf("...",...)!=EOF</code> in C (which I often use
with no problems)?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Because <code>iostream::eof</code> will only return <code>true</code> <em>after</em> reading the end of the
stream. It does <em>not</em> indicate, that the next read will be the end of the
stream.</p>
<p>Consider this (and assume then next read will be at the end of the stream):</p>
<div class="code"><pre class="code literal-block"><span class="k">while</span><span class="ss">(</span><span class="o">!</span><span class="nv">inStream</span>.<span class="nv">eof</span><span class="ss">())</span>{
<span class="w">  </span><span class="nv">int</span><span class="w"> </span><span class="nv">data</span><span class="c1">;</span>
<span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="nv">yay</span>,<span class="w"> </span><span class="nv">not</span><span class="w"> </span><span class="k">end</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">stream</span><span class="w"> </span><span class="nv">yet</span>,<span class="w"> </span><span class="nv">now</span><span class="w"> </span><span class="nv">read</span><span class="w"> </span>...
<span class="w">  </span><span class="nv">inStream</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="nv">data</span><span class="c1">;</span>
<span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="nv">oh</span><span class="w"> </span><span class="nv">crap</span>,<span class="w"> </span><span class="nv">now</span><span class="w"> </span><span class="nv">we</span><span class="w"> </span><span class="nv">read</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="k">end</span><span class="w"> </span><span class="nv">and</span><span class="w"> </span><span class="o">*</span><span class="nv">only</span><span class="o">*</span><span class="w"> </span><span class="nv">now</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">eof</span><span class="w"> </span><span class="nv">bit</span><span class="w"> </span><span class="nv">will</span><span class="w"> </span><span class="nv">be</span><span class="w"> </span><span class="nv">set</span><span class="w"> </span><span class="ss">(</span><span class="nv">as</span><span class="w"> </span><span class="nv">well</span><span class="w"> </span><span class="nv">as</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">fail</span><span class="w"> </span><span class="nv">bit</span><span class="ss">)</span>
<span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="nv">stuff</span><span class="w"> </span><span class="nv">with</span><span class="w"> </span><span class="ss">(</span><span class="nv">now</span><span class="w"> </span><span class="nv">uninitialized</span><span class="ss">)</span><span class="w"> </span><span class="nv">data</span>
}
</pre></div>

<p>Against this:</p>
<div class="code"><pre class="code literal-block"><span class="nv">int</span><span class="w"> </span><span class="nv">data</span><span class="c1">;</span>
<span class="k">while</span><span class="ss">(</span><span class="nv">inStream</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="nv">data</span><span class="ss">)</span>{
<span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="nv">when</span><span class="w"> </span><span class="nv">we</span><span class="w"> </span><span class="nv">land</span><span class="w"> </span><span class="nv">here</span>,<span class="w"> </span><span class="nv">we</span><span class="w"> </span><span class="nv">can</span><span class="w"> </span><span class="nv">be</span><span class="w"> </span><span class="nv">sure</span><span class="w"> </span><span class="nv">that</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">read</span><span class="w"> </span><span class="nv">was</span><span class="w"> </span><span class="nv">successful</span>.
<span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nv">it</span><span class="w"> </span><span class="nv">wasn</span><span class="err">'t, the returned stream from operator&gt;&gt; would be converted to false</span>
<span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="nv">and</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="k">loop</span><span class="w"> </span><span class="nv">wouldn</span><span class="err">'t even be entered</span>
<span class="err">  // do stuff with correctly initialized data (hopefully)</span>
<span class="err">}</span>
</pre></div>

<p>And on your second question: Because</p>
<div class="code"><pre class="code literal-block"><span class="k">if</span><span class="ss">(</span><span class="nv">scanf</span><span class="ss">(</span><span class="s2">"..."</span>,...<span class="ss">)</span><span class="o">!=</span><span class="nv">EOF</span><span class="ss">)</span>
</pre></div>

<p>is the same as</p>
<div class="code"><pre class="code literal-block"><span class="k">if</span><span class="ss">(</span><span class="o">!</span><span class="ss">(</span><span class="nv">inStream</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="nv">data</span><span class="ss">)</span>.<span class="nv">eof</span><span class="ss">())</span>
</pre></div>

<p>and <strong>not</strong> the same as</p>
<div class="code"><pre class="code literal-block"><span class="k">if</span><span class="ss">(</span><span class="o">!</span><span class="nv">inStream</span>.<span class="nv">eof</span><span class="ss">())</span>
<span class="w">    </span><span class="nv">inFile</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="nv">data</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p><strong>Bottom-line top:</strong> With proper handling of white space, the following is how
<code>eof</code> can be used (and even, be more reliable than <code>fail()</code> for error
checking):</p>
<div class="code"><pre class="code literal-block"><span class="nt">while</span><span class="o">(</span><span class="w"> </span><span class="o">!(</span><span class="nt">in</span><span class="o">&gt;&gt;</span><span class="nt">std</span><span class="p">::</span><span class="nd">ws</span><span class="o">)</span><span class="p">.</span><span class="nc">eof</span><span class="o">()</span><span class="w"> </span><span class="o">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="err">int</span><span class="w"> </span><span class="err">data</span><span class="p">;</span>
<span class="w">   </span><span class="err">in</span><span class="w"> </span><span class="err">&gt;&gt;</span><span class="w"> </span><span class="err">data</span><span class="p">;</span>
<span class="w">   </span><span class="err">if</span><span class="w"> </span><span class="err">(</span><span class="w"> </span><span class="err">in.fail()</span><span class="w"> </span><span class="err">)</span><span class="w"> </span><span class="c">/* Handle with 'break' or 'throw' */</span><span class="p">;</span>
<span class="w">   </span><span class="err">//</span><span class="w"> </span><span class="err">Now</span><span class="w"> </span><span class="err">use</span><span class="w"> </span><span class="err">data</span>
<span class="p">}</span>
</pre></div>

<p>( <em>Thanks Tony D for the suggestion to highlight the answer. See his comment
below for an example to why this is more robust.</em> )</p>
<hr>
<p>The main argument against using <code>eof()</code> seems to be missing an important
subtlety about the role of white space. My proposition is that, checking
<code>eof()</code> explicitly is not only not " <em>always wrong</em> "—which seems to be an
overriding opinion in this and similar Stack Overflow questions—, but with
proper handling of white-space, it provides for a cleaner and more reliable
error handling, and is the <em>always correct</em> solution (although, not
necessarily the tersest).</p>
<p>To summarize what is being suggested as the "proper" termination and read
order is the following:</p>
<div class="code"><pre class="code literal-block"><span class="nv">int</span><span class="w"> </span><span class="nv">data</span><span class="c1">;</span>
<span class="k">while</span><span class="ss">(</span><span class="nv">in</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="nv">data</span><span class="ss">)</span><span class="w"> </span>{<span class="w">  </span><span class="cm">/* ... */</span><span class="w"> </span>}

<span class="o">//</span><span class="w"> </span><span class="nv">Which</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">equivalent</span><span class="w"> </span><span class="nv">to</span>
<span class="k">while</span><span class="ss">(</span><span class="w"> </span><span class="o">!</span><span class="ss">(</span><span class="nv">in</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="nv">data</span><span class="ss">)</span>.<span class="nv">fail</span><span class="ss">()</span><span class="w"> </span><span class="ss">)</span><span class="w">  </span>{<span class="w">  </span><span class="cm">/* ... */</span><span class="w"> </span>}
</pre></div>

<p>The failure due to read attempt beyond eof is taken as the termination
condition. This means is that there is no easy way to distinguish between a
successful stream and one that really fails for reasons other than eof. Take
the following streams:</p>
<ul>
<li><code>1 2 3 4 5&lt;eof&gt;</code></li>
<li><code>1 2 a 3 4 5&lt;eof&gt;</code></li>
<li><code>a&lt;eof&gt;</code></li>
</ul>
<p><code>while(in&gt;&gt;data)</code> terminates with a set <code>failbit</code> for <em>all</em> three input. In
the first and third, <code>eofbit</code> is also set. So past the loop one needs very
ugly extra logic to distinguish a proper input (first) from improper ones
(second and third).</p>
<p>Whereas, take the following:</p>
<div class="code"><pre class="code literal-block"><span class="k">while</span><span class="ss">(</span><span class="w"> </span><span class="o">!</span><span class="nv">in</span>.<span class="nv">eof</span><span class="ss">()</span><span class="w"> </span><span class="ss">)</span>
{
<span class="w">   </span><span class="nv">int</span><span class="w"> </span><span class="nv">data</span><span class="c1">;</span>
<span class="w">   </span><span class="nv">in</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="nv">data</span><span class="c1">;</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="w"> </span><span class="nv">in</span>.<span class="nv">fail</span><span class="ss">()</span><span class="w"> </span><span class="ss">)</span><span class="w"> </span><span class="cm">/* Handle with break or throw */</span><span class="c1">;</span>
<span class="w">   </span><span class="o">//</span><span class="w"> </span><span class="nv">Now</span><span class="w"> </span><span class="nv">use</span><span class="w"> </span><span class="nv">data</span>
}
</pre></div>

<p>Here, <code>in.fail()</code> verifies that as long as there is something to read, it is
the correct one. It's purpose is not a mere <em>while</em> loop terminator.</p>
<p>So far so good, but what happens if there is trailing space in the stream—what
sounds like the major concern against <code>eof()</code> as terminator?</p>
<p>We don't need to surrender our error handling; just eat up the white-space:</p>
<div class="code"><pre class="code literal-block"><span class="nt">while</span><span class="o">(</span><span class="w"> </span><span class="o">!</span><span class="nt">in</span><span class="p">.</span><span class="nc">eof</span><span class="o">()</span><span class="w"> </span><span class="o">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="err">int</span><span class="w"> </span><span class="err">data</span><span class="p">;</span>
<span class="w">   </span><span class="err">in</span><span class="w"> </span><span class="err">&gt;&gt;</span><span class="w"> </span><span class="err">data</span><span class="w"> </span><span class="err">&gt;&gt;</span><span class="w"> </span><span class="err">ws</span><span class="p">;</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Eat</span><span class="w"> </span><span class="err">white</span><span class="w"> </span><span class="err">space</span><span class="w"> </span><span class="err">with</span><span class="w"> </span><span class="err">'</span><span class="n">std</span><span class="p">:</span><span class="o">:</span><span class="n">ws</span><span class="s1">'</span>
<span class="s1">   if ( in.fail() ) /* Handle with '</span><span class="n">break</span><span class="s1">' or '</span><span class="n">throw</span><span class="err">'</span><span class="w"> </span><span class="o">*/</span><span class="p">;</span>
<span class="w">   </span><span class="err">//</span><span class="w"> </span><span class="err">Now</span><span class="w"> </span><span class="err">use</span><span class="w"> </span><span class="err">data</span>
<span class="p">}</span>
</pre></div>

<p><code>std::ws</code> skips any potential (zero or more) trailing space in the stream
while setting the <code>eofbit</code>, and <strong>not the<code>failbit</code></strong>. So, <code>in.fail()</code> works as
expected, as long as there is at least one data to read. If all-blank streams
are also acceptable, then the correct form is:</p>
<div class="code"><pre class="code literal-block"><span class="k">while</span><span class="ss">(</span><span class="w"> </span><span class="o">!</span><span class="ss">(</span><span class="nv">in</span><span class="o">&gt;&gt;</span><span class="nv">ws</span><span class="ss">)</span>.<span class="nv">eof</span><span class="ss">()</span><span class="w"> </span><span class="ss">)</span>
{
<span class="w">   </span><span class="nv">int</span><span class="w"> </span><span class="nv">data</span><span class="c1">;</span>
<span class="w">   </span><span class="nv">in</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="nv">data</span><span class="c1">;</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="w"> </span><span class="nv">in</span>.<span class="nv">fail</span><span class="ss">()</span><span class="w"> </span><span class="ss">)</span><span class="w"> </span><span class="cm">/* Handle with 'break' or 'throw' */</span><span class="c1">;</span>
<span class="w">   </span><span class="cm">/* This will never fire if the eof is reached cleanly */</span>
<span class="w">   </span><span class="o">//</span><span class="w"> </span><span class="nv">Now</span><span class="w"> </span><span class="nv">use</span><span class="w"> </span><span class="nv">data</span>
}
</pre></div>

<p><strong>Summary:</strong> A properly constructed <code>while(!eof)</code> is not only possible and not
wrong, but it allows data to be localized within scope and provides a cleaner
separation of error checking from business as usual. That being said,
<code>while(!fail)</code> is inarguably a more common and terse idiom, and may be
preferred in simple (single data per read type of) scenarios.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/why-does-angularjs-include-an-empty-option-in-select/" class="u-url">Why does AngularJS include an empty option in select?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/why-does-angularjs-include-an-empty-option-in-select/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T19:11:38+08:00" itemprop="datePublished" title="2023-02-17 19:11">2023-02-17 19:11</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I've been working with AngularJS for the last few weeks, and the one thing
which is really bothering me is that even after trying all permutations or the
configuration defined in the specification at
http://docs.angularjs.org/api/ng.directive:select, I still get an empty option
as the first child of select element.</p>
<p>Here's the Jade:</p>
<div class="code"><pre class="code literal-block"><span class="nv">select</span>.<span class="nv">span9</span><span class="ss">(</span><span class="nv">ng</span><span class="o">-</span><span class="nv">model</span><span class="o">=</span><span class="s1">'form.type'</span>,<span class="w"> </span><span class="nv">required</span>,<span class="w"> </span><span class="nv">ng</span><span class="o">-</span><span class="nv">options</span><span class="o">=</span><span class="s1">'option.value as option.name for option in typeOptions'</span><span class="ss">)</span><span class="c1">;</span>
</pre></div>

<p>Here the controller:</p>
<div class="code"><pre class="code literal-block"><span class="o">$</span><span class="nt">scope</span><span class="p">.</span><span class="nc">typeOptions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="cp">[</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="p">:</span><span class="w"> </span><span class="s1">'Feature'</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="p">:</span><span class="w"> </span><span class="s1">'feature'</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="p">:</span><span class="w"> </span><span class="s1">'Bug'</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="p">:</span><span class="w"> </span><span class="s1">'bug'</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="p">:</span><span class="w"> </span><span class="s1">'Enhancement'</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="p">:</span><span class="w"> </span><span class="s1">'enhancement'</span><span class="w"> </span><span class="p">}</span>
<span class="cp">]</span><span class="o">;</span>
</pre></div>

<p>Finally, here's the HTML which gets generated:</p>
<div class="code"><pre class="code literal-block"><span class="nt">&lt;select</span><span class="w"> </span><span class="na">ng-model=</span><span class="s">"form.type"</span><span class="w"> </span><span class="na">required=</span><span class="s">"required"</span><span class="w"> </span><span class="na">ng-options=</span><span class="s">"option.value as option.name for option in typeOptions"</span><span class="w"> </span><span class="na">class=</span><span class="s">"span9 ng-pristine ng-invalid ng-invalid-required"</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;option</span><span class="w"> </span><span class="na">value=</span><span class="s">"?"</span><span class="w"> </span><span class="na">selected=</span><span class="s">"selected"</span><span class="nt">&gt;&lt;/option&gt;</span>
<span class="w">    </span><span class="nt">&lt;option</span><span class="w"> </span><span class="na">value=</span><span class="s">"0"</span><span class="nt">&gt;</span>Feature<span class="nt">&lt;/option&gt;</span>
<span class="w">    </span><span class="nt">&lt;option</span><span class="w"> </span><span class="na">value=</span><span class="s">"1"</span><span class="nt">&gt;</span>Bug<span class="nt">&lt;/option&gt;</span>
<span class="w">    </span><span class="nt">&lt;option</span><span class="w"> </span><span class="na">value=</span><span class="s">"2"</span><span class="nt">&gt;</span>Enhancement<span class="nt">&lt;/option&gt;</span>
<span class="nt">&lt;/select&gt;</span>
</pre></div>

<p>What do I need to do to get rid of it?</p>
<p>P.S.: Things work without this as well, but it just looks odd if you use
select2 without multiple selection.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>The empty <code>option</code> is generated when a value referenced by <code>ng-model</code> doesn't
exist in a set of options passed to <code>ng-options</code>. This happens to prevent
accidental model selection: AngularJS can see that the initial model is either
undefined or not in the set of options and don't want to decide model value on
its own.</p>
<p>If you want to get rid of the empty option just select an initial value in
your controller, something like:</p>
<div class="code"><pre class="code literal-block">$scope.form.type = $scope.typeOptions[0].value;
</pre></div>

<p>Here is the jsFiddle: http://jsfiddle.net/MTfRD/3/</p>
<p>In short: the empty option means that no valid model is selected (by valid I
mean: from the set of options). You need to select a valid model value to get
rid of this empty option.</p>
<p><br></p>
<h3>Suggest</h3>
<p>If you want an initial value, see @pkozlowski.opensource's answer, which FYI
can also be implemented in the view (rather than in the controller) using ng-
init:</p>
<div class="code"><pre class="code literal-block"><span class="nt">&lt;select</span><span class="w"> </span><span class="na">ng-model=</span><span class="s">"form.type"</span><span class="w"> </span><span class="na">required=</span><span class="s">"required"</span><span class="w"> </span><span class="na">ng-init=</span><span class="s">"form.type='bug'"</span>
<span class="w">  </span><span class="na">ng-options=</span><span class="s">"option.value as option.name for option in typeOptions"</span><span class="w"> </span><span class="nt">&gt;</span>
<span class="nt">&lt;/select&gt;</span>
</pre></div>

<p>If you don't want an initial value, "a single hard-coded element, with the
value set to an empty string, can be nested into the element. This element
will then represent null or "not selected" option":</p>
<div class="code"><pre class="code literal-block"><span class="nt">&lt;select</span><span class="w"> </span><span class="na">ng-model=</span><span class="s">"form.type"</span><span class="w"> </span><span class="na">required=</span><span class="s">"required"</span>
<span class="w">  </span><span class="na">ng-options=</span><span class="s">"option.value as option.name for option in typeOptions"</span><span class="w"> </span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;option</span><span class="w"> </span><span class="na">style=</span><span class="s">"display:none"</span><span class="w"> </span><span class="na">value=</span><span class="s">""</span><span class="nt">&gt;</span>select<span class="w"> </span>a<span class="w"> </span>type<span class="nt">&lt;/option&gt;</span>
<span class="nt">&lt;/select&gt;</span>
</pre></div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-908.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-906.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
