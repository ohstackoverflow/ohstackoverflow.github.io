<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 2291) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-2291.html">
<link rel="prev" href="index-2292.html" type="text/html">
<link rel="next" href="index-2290.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/getting-the-name-of-a-variable-as-a-string/" class="u-url">Getting the name of a variable as a string</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/getting-the-name-of-a-variable-as-a-string/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T05:15:30+08:00" itemprop="datePublished" title="2023-03-04 05:15">2023-03-04 05:15</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I already read How to get a function name as a string?.</p>
<p>How can I do the same for a variable? As opposed to functions, Python
variables do not have the <code>__name__</code> attribute.</p>
<p>In other words, if I have a variable such as:</p>
<div class="code"><pre class="code literal-block">foo = dict()
foo['bar'] = 2
</pre></div>

<p>I am looking for a function/attribute, e.g. <code>retrieve_name()</code> in order to
create a DataFrame in Pandas from this list, where <strong>the column names</strong> are
given by the names of the actual dictionaries:</p>
<div class="code"><pre class="code literal-block">#<span class="w"> </span><span class="nv">List</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">dictionaries</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">my</span><span class="w"> </span><span class="nv">DataFrame</span>
<span class="nv">list_of_dicts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>[<span class="nv">n_jobs</span>,<span class="w"> </span><span class="nv">users</span>,<span class="w"> </span><span class="nv">queues</span>,<span class="w"> </span><span class="nv">priorities</span>]
<span class="nv">columns</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>[<span class="nv">retrieve_name</span><span class="ss">(</span><span class="nv">d</span><span class="ss">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">d</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">list_of_dicts</span>]
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<h3>TL;DR</h3>
<p>Use the <code>Wrapper</code> helper from <code>python-varname</code>:</p>
<div class="code"><pre class="code literal-block"><span class="kn">from</span> <span class="nn">varname.helpers</span> <span class="kn">import</span> <span class="n">Wrapper</span>

<span class="n">foo</span> <span class="o">=</span> <span class="n">Wrapper</span><span class="p">(</span><span class="nb">dict</span><span class="p">())</span>

<span class="c1"># foo.name == 'foo'</span>
<span class="c1"># foo.value == {}</span>
<span class="n">foo</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">'bar'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
</pre></div>

<p>For list comprehension part, you can do:</p>
<div class="code"><pre class="code literal-block"><span class="nv">n_jobs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">Wrapper</span><span class="ss">(</span><span class="o">&lt;</span><span class="nv">original_value</span><span class="o">&gt;</span><span class="ss">)</span><span class="w"> </span>
<span class="nv">users</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">Wrapper</span><span class="ss">(</span><span class="o">&lt;</span><span class="nv">original_value</span><span class="o">&gt;</span><span class="ss">)</span><span class="w"> </span>
<span class="nv">queues</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">Wrapper</span><span class="ss">(</span><span class="o">&lt;</span><span class="nv">original_value</span><span class="o">&gt;</span><span class="ss">)</span><span class="w"> </span>
<span class="nv">priorities</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">Wrapper</span><span class="ss">(</span><span class="o">&lt;</span><span class="nv">original_value</span><span class="o">&gt;</span><span class="ss">)</span>

<span class="nv">list_of_dicts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>[<span class="nv">n_jobs</span>,<span class="w"> </span><span class="nv">users</span>,<span class="w"> </span><span class="nv">queues</span>,<span class="w"> </span><span class="nv">priorities</span>]
<span class="nv">columns</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>[<span class="nv">d</span>.<span class="nv">name</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">d</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">list_of_dicts</span>]
#<span class="w"> </span>[<span class="s1">'n_jobs'</span>,<span class="w"> </span><span class="s1">'users'</span>,<span class="w"> </span><span class="s1">'queues'</span>,<span class="w"> </span><span class="s1">'priorities'</span>]
#<span class="w"> </span><span class="nv">REMEMBER</span><span class="w"> </span><span class="nv">that</span><span class="w"> </span><span class="nv">you</span><span class="w"> </span><span class="nv">have</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">access</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="o">&lt;</span><span class="nv">original_value</span><span class="o">&gt;</span><span class="w"> </span><span class="nv">by</span><span class="w"> </span><span class="nv">d</span>.<span class="nv">value</span>
</pre></div>

<p>I am the author of the <code>python-varname</code> package. Please let me know if you
have any questions or you can submit issues on Github.</p>
<h3>The long answer</h3>
<h4>Is it even possible?</h4>
<p>Yes and No.</p>
<p>We are retrieving the variable names at runtime, so we need a function to be
called to enable us to access the previous frames to retrieve the variable
names. That's why we need a <code>Wrapper</code> there. In that function, at runtime, we
are parsing the source code/AST nodes in the previous frames to get the exact
variable name.</p>
<p>However, the source code/AST nodes in the previous frames are not always
available, or they could be modified by other environments (e.g: <code>pytest</code>'s
<code>assert</code> statement). One simple example is that the codes run via <code>exec()</code>.
Even though we are still able to retrieve some information from the bytecode,
it needs too much effort and it is also error-prone.</p>
<h4>How to do it?</h4>
<p>First of all, we need to identify which frame the variable is given. It's not
always simply the direct previous frame. For example, we may have another
wrapper for the function:</p>
<div class="code"><pre class="code literal-block"><span class="kn">from</span> <span class="nn">varname</span> <span class="kn">import</span> <span class="n">varname</span>

<span class="k">def</span> <span class="nf">func</span><span class="p">():</span>
  <span class="k">return</span> <span class="n">varname</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">wrapped</span><span class="p">():</span>
  <span class="k">return</span> <span class="n">func</span><span class="p">()</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">wrapped</span><span class="p">()</span>
</pre></div>

<p>In the above example, we have to skip the frame inside <code>wrapped</code> to get to the
right frame <code>x = wrapped()</code> so that we are able to locate <code>x</code>. The arguments
<code>frame</code> and <code>ignore</code> of <code>varname</code> allow us to skip some of these intermediate
frames. See more details in the README file and the API docs of the package.</p>
<p>Then we need to parse the AST node to locate where the variable is assigned
value (function call) to. It's not always just a simple assignment. Sometimes
there could be complex AST nodes, for example, <code>x = [wrapped()]</code>. We need to
identify the correct assignment by traversing the AST tree.</p>
<h4>How reliable is it?</h4>
<p>Once we identify the assignment node, it is reliable.</p>
<p><code>varname</code> is all depending on <code>executing</code> package to look for the node. The
node executing detects is ensured to be the correct one (see also this).</p>
<p>It partially works with environments where other AST magics apply, including
pytest, ipython, macropy, birdseye, reticulate with R, etc. Neither executing
nor varname is 100% working with those environments.</p>
<h4>Do we need a package to do it?</h4>
<p>Well, yes and no, again.</p>
<p>If your scenario is simple, the code provided by @juan Isaza or @scohe001
probably is enough for you to work with the case where a variable is defined
at the direct previous frame and the AST node is a simple assignment. You just
need to go one frame back and retrieve the information there.</p>
<p>However, if the scenario becomes complicated, or we need to adopt different
application scenarios, you probably need a package like <code>python-varname</code>, to
handle them. These scenarios may include to:</p>
<ol>
<li>present more friendly messages when the source code is not available or AST nodes are not accessible</li>
<li>skip intermediate frames (allows the function to be wrapped or called in other intermediate frames)</li>
<li>automatically ignores calls from built-in functions or libraries. For example: <code>x = str(func())</code>
</li>
<li>retrieve multiple variable names on the left-hand side of the assignment</li>
<li>etc.</li>
</ol>
<p>How about the <code>f-string</code>?</p>
<p>Like the answer provided by @Aivar Paalberg. It's definitely fast and
reliable. However, it's not at runtime, meaning that you have to know it's
<code>foo</code> before you print the name out. But with <code>varname</code>, you don't have to
know that variable is coming:</p>
<div class="code"><pre class="code literal-block"><span class="kn">from</span> <span class="nn">varname</span> <span class="kn">import</span> <span class="n">varname</span>

<span class="k">def</span> <span class="nf">func</span><span class="p">():</span>
  <span class="k">return</span> <span class="n">varname</span><span class="p">()</span>

<span class="c1"># In external uses</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">func</span><span class="p">()</span> <span class="c1"># 'x'</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">func</span><span class="p">()</span> <span class="c1"># 'y'</span>
</pre></div>

<h4>Finally</h4>
<p><code>python-varname</code> is not only able to detect the variable name from an
assignment, but also:</p>
<ul>
<li>Retrieve variable names directly, using <code>nameof</code>
</li>
<li>Detect next immediate attribute name, using <code>will</code>
</li>
<li>Fetch argument names/sources passed to a function using <code>argname</code>
</li>
</ul>
<p>Read more from its documentation.</p>
<p>However, the final word I want to say is that, <strong>try to avoid using it
whenever you can.</strong></p>
<p>Because you can't make sure that the client code will run in an environment
where the source node is available or AST node is accessible. And of course,
it costs resources to parse the source code, identify the environment,
retrieve the AST nodes and evaluate them when needed.</p>
<p><br></p>
<h3>Suggest</h3>
<p>Even if variable values don't point back to the name, you have access to the
list of every assigned variable and its value, so I'm astounded that only one
person suggested looping through there to look for your var name.</p>
<p>Someone mentioned on that answer that you might have to walk the stack and
check everyone's locals and globals to find <code>foo</code>, but if <code>foo</code> is assigned in
the scope where you're calling this <code>retrieve_name</code> function, you can use
<code>inspect</code>'s <code>current frame</code> to get you all of those local variables.</p>
<p>My explanation might be a little bit too wordy (maybe I should've used a "foo"
less words), but here's how it would look in code ( <strong>Note that if there is
more than one variable assigned to the same value, you will get both of those
variable names</strong> ):</p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="nn">inspect</span>

<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span>

<span class="k">def</span> <span class="nf">retrieve_name</span><span class="p">(</span><span class="n">var</span><span class="p">):</span>
    <span class="n">callers_local_vars</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">()</span><span class="o">.</span><span class="n">f_back</span><span class="o">.</span><span class="n">f_locals</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">var_name</span> <span class="k">for</span> <span class="n">var_name</span><span class="p">,</span> <span class="n">var_val</span> <span class="ow">in</span> <span class="n">callers_local_vars</span> <span class="k">if</span> <span class="n">var_val</span> <span class="ow">is</span> <span class="n">var</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">retrieve_name</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
</pre></div>

<hr>
<p>If you're calling this function from another function, something like:</p>
<div class="code"><pre class="code literal-block"><span class="nv">def</span><span class="w"> </span><span class="nv">foo</span><span class="ss">(</span><span class="nv">bar</span><span class="ss">)</span>:
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nv">retrieve_name</span><span class="ss">(</span><span class="nv">bar</span><span class="ss">)</span>

<span class="nv">foo</span><span class="ss">(</span><span class="nv">baz</span><span class="ss">)</span>
</pre></div>

<p>And you want the <code>baz</code> instead of <code>bar</code>, you'll just need to go back a scope
further. This can be done by adding an extra <code>.f_back</code> in the
<code>caller_local_vars</code> initialization.</p>
<p>See an example here: ideone</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/explain-which-gitignore-rule-is-ignoring-my-file/" class="u-url">Explain which gitignore rule is ignoring my file</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/explain-which-gitignore-rule-is-ignoring-my-file/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T05:14:08+08:00" itemprop="datePublished" title="2023-03-04 05:14">2023-03-04 05:14</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Is there any way to see why some file is getting ignored by git (i.e. which
rule in a <code>.gitignore</code> file is causing the file to be ignored)?</p>
<p>Imagine I have this (or a much more complex scenario, with hundreds of folders
and tens of <code>.gitignore</code> files:</p>
<div class="code"><pre class="code literal-block">/
-.gitignore
-folder/
    -.gitignore
    -subfolder/
              -.gitignore
              -file.txt
</pre></div>

<p>If I run <code>git add folder/subfolder/file.txt</code> git may complain of it being
ignored:</p>
<div class="code"><pre class="code literal-block"><span class="nv">The</span><span class="w"> </span><span class="nv">following</span><span class="w"> </span><span class="nv">paths</span><span class="w"> </span><span class="nv">are</span><span class="w"> </span><span class="nv">ignored</span><span class="w"> </span><span class="nv">by</span><span class="w"> </span><span class="nv">one</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">your</span><span class="w"> </span>.<span class="nv">gitignore</span><span class="w"> </span><span class="nv">files</span>:
<span class="nv">folder</span><span class="o">/</span><span class="nv">subfolder</span><span class="o">/</span><span class="nv">file</span>.<span class="nv">txt</span>
<span class="nv">Use</span><span class="w"> </span><span class="o">-</span><span class="nv">f</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nv">you</span><span class="w"> </span><span class="nv">really</span><span class="w"> </span><span class="nv">want</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">add</span><span class="w"> </span><span class="nv">them</span>.
</pre></div>

<p>Is there any way to know which of all the possible <code>.gitignore</code> have a rule to
ignore this file, and also show the rule? Like:</p>
<div class="code"><pre class="code literal-block"><span class="nv">The</span><span class="w"> </span><span class="nv">following</span><span class="w"> </span><span class="nv">paths</span><span class="w"> </span><span class="nv">are</span><span class="w"> </span><span class="nv">ignored</span><span class="w"> </span><span class="nv">by</span><span class="w"> </span><span class="nv">your</span><span class="w"> </span><span class="nv">folder</span><span class="o">/</span>.<span class="nv">gitignore</span><span class="w"> </span><span class="nv">file</span><span class="w"> </span><span class="ss">(</span><span class="nv">line</span><span class="w"> </span><span class="mi">12</span>:<span class="w"> </span><span class="o">*</span>.<span class="nv">txt</span><span class="ss">)</span>
<span class="nv">folder</span><span class="o">/</span><span class="nv">subfolder</span><span class="o">/</span><span class="nv">file</span>.<span class="nv">txt</span>
<span class="nv">Use</span><span class="w"> </span><span class="o">-</span><span class="nv">f</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nv">you</span><span class="w"> </span><span class="nv">really</span><span class="w"> </span><span class="nv">want</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">add</span><span class="w"> </span><span class="nv">them</span>.
</pre></div>

<p>Or just:</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span>git<span class="w"> </span>why-is-ignored<span class="w"> </span>folder/subfolder/file.txt
folder/.gitignore:12:*.txt
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<div class="code"><pre class="code literal-block">git check-ignore -v filename
</pre></div>

<p>See the man page for more details.</p>
<p><strong>Original answer follows:</strong></p>
<p>git does not currently provide anything like this. But after seeing your
question I did some googling and found that back in 2009 this feature was
requested and partially implemented. After reading the thread, I realised it
would not be too much work to do it properly, so I have started work on a
patch and hope to have it finished in the next day or two. I will update this
answer when it is ready.</p>
<p><strong>UPDATE:</strong> Wow, that was a lot harder than I expected. The innards of <code>git</code>'s
exclude handling are quite cryptic. Anyway, here's an <em>almost</em> finished series
of commits which apply to today's upstream <code>master</code> branch. The test suite is
99% complete, but I haven't finished handling of the <code>--stdin</code> option yet.
Hopefully I'll manage that this weekend, and then submit my patches to the git
mailing list.</p>
<p>In the meantime, I'd definitely welcome testing from anyone who's able to do
so - just clone from my <code>git</code> fork, check out the <code>check-ignore</code> branch, and
compile it as normal.</p>
<p><strong>UPDATE 2:</strong> It's done! Latest version is on github as per above, and I have
submitted the patch series to the git mailing list for peer review. Let's see
what they think ...</p>
<p><strong>UPDATE 3:</strong> After several more months of hacking / patch reviews /
discussions / waiting, I'm delighted to be able to say that this feature has
now reached git's <code>master</code> branch, and will be available in the next release
(1.8.2, expected 8th March 2013). Here's the <code>check-ignore</code> manual page. Phew,
that was way more work than I expected!</p>
<p><strong>UPDATE 4:</strong> If you're interested in the full story about how this answer
evolved and the feature came to be implemented, check out episode #32 of the
GitMinutes podcast.</p>
<p><br></p>
<h3>Suggest</h3>
<p>Update git 2.8 (March 2016):</p>
<div class="code"><pre class="code literal-block">GIT_TRACE_EXCLUDE=1 git status
</pre></div>

<p>See "A way to validate <code>.gitignore</code> file"</p>
<p>That is complementary to the <code>git check-ignore -v</code> described below.</p>
<hr>
<p>Original answer: Sept 2013 (git 1.8.2, then 1.8.5+):</p>
<p><strong><code>git check-ignore</code></strong> improves again in git 1.8.5/1.9 (Q4 2013):</p>
<blockquote>
<p>"<code>git check-ignore</code>" follows the same rule as "<code>git add</code>" and "<code>git status</code>"
in that the ignore/exclude mechanism does not take effect on paths that are
already tracked.<br><strong>With "<code>--no-index</code>" option, it can be used to diagnose which paths that
should have been ignored have been mistakenly added to the index</strong>.</p>
</blockquote>
<p>See commit 8231fa6 from https://github.com/flashydave:</p>
<blockquote>
<p><code>check-ignore</code> currently shows how <code>.gitignore</code> rules would treat untracked
paths. Tracked paths do not generate useful output.<br>
 This prevents debugging of why a path became tracked unexpectedly unless
that path is first removed from the index with <code>git rm --cached &lt;path&gt;</code>.</p>
<p><strong>The option<code>--no-index</code> tells the command to bypass the check for the path
being in the index and hence allows tracked paths to be checked too.</strong></p>
<p>Whilst this behaviour deviates from the characteristics of <code>git add</code> and
<code>git status</code> its use case is unlikely to cause any user confusion.</p>
<p>Test scripts are augmented to check this option against the standard ignores
to ensure correct behaviour.</p>
</blockquote>
<hr>
<div class="code"><pre class="code literal-block">--no-index::
</pre></div>

<blockquote>
<p>Don't look in the index when undertaking the checks.<br>
 This can be used:</p>
<ul>
<li>to debug why a path became tracked by e.g. <code>git add .</code> and was not
ignored by the rules as expected by the user or</li>
<li>when developing patterns including negation to match a path previously
added with <code>git add -f</code>.
</li>
</ul>
</blockquote>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-can-i-archive-git-branches/" class="u-url">How can I archive git branches?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-can-i-archive-git-branches/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T05:12:48+08:00" itemprop="datePublished" title="2023-03-04 05:12">2023-03-04 05:12</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I have some old branches in my git repository that are no longer under active
development. I would like to archive the branches so that they don't show up
by default when running <code>git branch -l -r</code>. I don't want to delete them,
because I want to keep the history. How can I do this?</p>
<p>I know that it's possible to create a ref outside of refs/heads. For example,
<code>refs/archive/old_branch</code>. Are there any consequences of doing that?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>I believe the proper way to do this is to tag the branch. If you delete the
branch after you have tagged it then you've effectively kept the branch around
but it won't clutter your branch list.</p>
<p>If you need to go back to the branch just check out the tag. It will
effectively restore the branch from the tag.</p>
<p>To archive and delete the branch:</p>
<div class="code"><pre class="code literal-block">git tag archive/&lt;branchname&gt; &lt;branchname&gt;
git branch -d &lt;branchname&gt;
</pre></div>

<p>To restore the branch some time later:</p>
<div class="code"><pre class="code literal-block">git checkout -b &lt;branchname&gt; archive/&lt;branchname&gt;
</pre></div>

<p>The history of the branch will be preserved exactly as it was when you tagged
it.</p>
<p><br></p>
<h3>Suggest</h3>
<p>Jeremy's answer is correct in principle, but IMHO the commands he specifies
are not quite right.</p>
<p>Here's how to archive a branch to a tag without having to checkout the branch
(and, therefore, without having to checkout to another branch before you can
delete that branch):</p>
<div class="code"><pre class="code literal-block">&gt; git tag archive/&lt;branchname&gt; &lt;branchname&gt;
&gt; git branch -D &lt;branchname&gt;
</pre></div>

<p>And here's how to restore a branch:</p>
<div class="code"><pre class="code literal-block">&gt; git checkout -b &lt;branchname&gt; archive/&lt;branchname&gt;
</pre></div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-2292.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-2290.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
