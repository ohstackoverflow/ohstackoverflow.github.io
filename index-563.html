<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 563) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-563.html">
<link rel="prev" href="index-564.html" type="text/html">
<link rel="next" href="index-562.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/what-does-mean-in-python-function-definitions/" class="u-url">What does -&gt; mean in Python function definitions?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/what-does-mean-in-python-function-definitions/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T10:01:56+08:00" itemprop="datePublished" title="2023-02-17 10:01">2023-02-17 10:01</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I've recently noticed something interesting when looking at Python 3.3 grammar
specification:</p>
<div class="code"><pre class="code literal-block"><span class="n">funcdef</span><span class="o">:</span><span class="w"> </span><span class="s">'def'</span><span class="w"> </span><span class="n">NAME</span><span class="w"> </span><span class="n">parameters</span><span class="w"> </span><span class="p">[</span><span class="s">'-&gt;'</span><span class="w"> </span><span class="n">test</span><span class="p">]</span><span class="w"> </span><span class="s">':'</span><span class="w"> </span><span class="n">suite</span>
</pre></div>

<p>The optional 'arrow' block was absent in Python 2 and I couldn't find any
information regarding its meaning in Python 3. It turns out this is correct
Python and it's accepted by the interpreter:</p>
<div class="code"><pre class="code literal-block"><span class="n">def</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mi">123</span><span class="o">:</span>
<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="n">x</span>
</pre></div>

<p>I thought that this might be some kind of a precondition syntax, but:</p>
<ul>
<li>I cannot test <code>x</code> here, as it is still undefined,</li>
<li>No matter what I put after the arrow (e.g. <code>2 &lt; 1</code>), it doesn't affect the function behavior.</li>
</ul>
<p>Could anyone familiar with this syntax style explain it?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>It's a function annotation.</p>
<p>In more detail, Python 2.x has docstrings, which allow you to attach a
metadata string to various types of object. This is amazingly handy, so Python
3 extends the feature by allowing you to attach metadata to functions
describing their parameters and return values.</p>
<p>There's no preconceived use case, but the PEP suggests several. One very handy
one is to allow you to annotate parameters with their expected types; it would
then be easy to write a decorator that verifies the annotations or coerces the
arguments to the right type. Another is to allow parameter-specific
documentation instead of encoding it into the docstring.</p>
<p><br></p>
<h3>Suggest</h3>
<p>These are function annotations covered in PEP 3107. Specifically, the <code>-&gt;</code>
marks the return function annotation.</p>
<p>Examples:</p>
<div class="code"><pre class="code literal-block"><span class="n">def</span><span class="w"> </span><span class="n">kinetic_energy</span><span class="p">(</span><span class="n">m</span><span class="o">:</span><span class="s">'in KG'</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="o">:</span><span class="s">'in M/S'</span><span class="p">)</span><span class="o">-&gt;</span><span class="s">'Joules'</span><span class="o">:</span><span class="w"> </span>
<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">v</span><span class="o">**</span><span class="mi">2</span>

<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">kinetic_energy</span><span class="p">.</span><span class="n">__annotations__</span>
<span class="p">{</span><span class="s">'return'</span><span class="o">:</span><span class="w"> </span><span class="s">'Joules'</span><span class="p">,</span><span class="w"> </span><span class="s">'v'</span><span class="o">:</span><span class="w"> </span><span class="s">'in M/S'</span><span class="p">,</span><span class="w"> </span><span class="s">'m'</span><span class="o">:</span><span class="w"> </span><span class="s">'in KG'</span><span class="p">}</span>
</pre></div>

<p>Annotations are dictionaries, so you can do this:</p>
<div class="code"><pre class="code literal-block"><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="s1">'{:,} {}'</span>.<span class="nv">format</span><span class="ss">(</span><span class="nv">kinetic_energy</span><span class="ss">(</span><span class="mi">12</span>,<span class="mi">30</span><span class="ss">)</span>,
<span class="w">      </span><span class="nv">kinetic_energy</span>.<span class="nv">__annotations__</span>[<span class="s1">'return'</span>]<span class="ss">)</span>
<span class="s1">'5,400.0 Joules'</span>
</pre></div>

<p>You can also have a python data structure rather than just a string:</p>
<div class="code"><pre class="code literal-block"><span class="n">rd</span><span class="o">=</span><span class="p">{</span><span class="s">'type'</span><span class="o">:</span><span class="n">float</span><span class="p">,</span><span class="s">'units'</span><span class="o">:</span><span class="s">'Joules'</span><span class="p">,</span>
<span class="w">    </span><span class="s">'docstring'</span><span class="o">:</span><span class="s">'Given mass and velocity returns kinetic energy in Joules'</span><span class="p">}</span>
<span class="n">def</span><span class="w"> </span><span class="n">f</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">rd</span><span class="o">:</span>
<span class="w">    </span><span class="n">pass</span>

<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">__annotations__</span><span class="p">[</span><span class="s">'return'</span><span class="p">][</span><span class="s">'type'</span><span class="p">]</span>
<span class="o">&lt;</span><span class="n">class</span><span class="w"> </span><span class="s">'float'</span><span class="o">&gt;</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">__annotations__</span><span class="p">[</span><span class="s">'return'</span><span class="p">][</span><span class="s">'units'</span><span class="p">]</span>
<span class="s">'Joules'</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">__annotations__</span><span class="p">[</span><span class="s">'return'</span><span class="p">][</span><span class="s">'docstring'</span><span class="p">]</span>
<span class="s">'Given mass and velocity returns kinetic energy in Joules'</span>
</pre></div>

<p>Or, you can use function attributes to validate called values:</p>
<div class="code"><pre class="code literal-block"><span class="n">def</span><span class="w"> </span><span class="n">validate</span><span class="p">(</span><span class="n">func</span><span class="p">,</span><span class="w"> </span><span class="n">locals</span><span class="p">)</span><span class="err">:</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nf">var</span><span class="p">,</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">func</span><span class="p">.</span><span class="n">__annotations__</span><span class="p">.</span><span class="n">items</span><span class="p">()</span><span class="err">:</span>
<span class="w">        </span><span class="k">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">locals</span><span class="o">[</span><span class="n">var</span><span class="o">]</span>
<span class="w">        </span><span class="k">try</span><span class="err">:</span><span class="w"> </span>
<span class="w">            </span><span class="n">pr</span><span class="o">=</span><span class="n">test</span><span class="p">.</span><span class="n">__name__</span><span class="o">+</span><span class="s1">': '</span><span class="o">+</span><span class="n">test</span><span class="p">.</span><span class="n">__docstring__</span>
<span class="w">        </span><span class="ow">except</span><span class="w"> </span><span class="nl">AttributeError</span><span class="p">:</span>
<span class="w">            </span><span class="n">pr</span><span class="o">=</span><span class="n">test</span><span class="p">.</span><span class="n">__name__</span><span class="w">   </span>
<span class="w">        </span><span class="n">msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'{}=={}; Test: {}'</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="nf">var</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="p">,</span><span class="w"> </span><span class="n">pr</span><span class="p">)</span>
<span class="w">        </span><span class="n">assert</span><span class="w"> </span><span class="n">test</span><span class="p">(</span><span class="k">value</span><span class="p">),</span><span class="w"> </span><span class="n">msg</span>

<span class="n">def</span><span class="w"> </span><span class="ow">between</span><span class="p">(</span><span class="n">lo</span><span class="p">,</span><span class="w"> </span><span class="n">hi</span><span class="p">)</span><span class="err">:</span>
<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_between</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="err">:</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">lo</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">hi</span>
<span class="w">    </span><span class="n">_between</span><span class="p">.</span><span class="n">__docstring__</span><span class="o">=</span><span class="s1">'must be between {} and {}'</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">lo</span><span class="p">,</span><span class="n">hi</span><span class="p">)</span><span class="w">       </span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">_between</span>

<span class="n">def</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="nl">x</span><span class="p">:</span><span class="w"> </span><span class="ow">between</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="w"> </span><span class="nl">y</span><span class="p">:</span><span class="n">lambda</span><span class="w"> </span><span class="nl">_y</span><span class="p">:</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">_y</span><span class="p">,</span><span class="nc">int</span><span class="p">))</span><span class="err">:</span>
<span class="w">    </span><span class="n">validate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">locals</span><span class="p">())</span>
<span class="w">    </span><span class="k">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>

<p>Prints</p>
<div class="code"><pre class="code literal-block"><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="nt">f</span><span class="o">(</span><span class="nt">2</span><span class="o">,</span><span class="nt">2</span><span class="o">)</span><span class="w"> </span>
<span class="nt">AssertionError</span><span class="o">:</span><span class="w"> </span><span class="nt">x</span><span class="o">==</span><span class="nt">2</span><span class="o">;</span><span class="w"> </span><span class="nt">Test</span><span class="o">:</span><span class="w"> </span><span class="nt">_between</span><span class="o">:</span><span class="w"> </span><span class="nt">must</span><span class="w"> </span><span class="nt">be</span><span class="w"> </span><span class="nt">between</span><span class="w"> </span><span class="nt">3</span><span class="w"> </span><span class="nt">and</span><span class="w"> </span><span class="nt">10</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="nt">f</span><span class="o">(</span><span class="nt">3</span><span class="o">,</span><span class="nt">2</span><span class="p">.</span><span class="nc">1</span><span class="o">)</span>
<span class="nt">AssertionError</span><span class="o">:</span><span class="w"> </span><span class="nt">y</span><span class="o">==</span><span class="nt">2</span><span class="p">.</span><span class="nc">1</span><span class="o">;</span><span class="w"> </span><span class="nt">Test</span><span class="o">:</span><span class="w"> </span><span class="o">&lt;</span><span class="nt">lambda</span><span class="o">&gt;</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/why-use-apparently-meaningless-do-while-and-if-else-statements-in-macros/" class="u-url">Why use apparently meaningless do-while and if-else statements in macros?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/why-use-apparently-meaningless-do-while-and-if-else-statements-in-macros/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T10:01:29+08:00" itemprop="datePublished" title="2023-02-17 10:01">2023-02-17 10:01</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>In many C/C++ macros I'm seeing the code of the macro wrapped in what seems
like a meaningless <code>do while</code> loop. Here are examples.</p>
<div class="code"><pre class="code literal-block">#<span class="nv">define</span><span class="w"> </span><span class="nv">FOO</span><span class="ss">(</span><span class="nv">X</span><span class="ss">)</span><span class="w"> </span><span class="k">do</span><span class="w"> </span>{<span class="w"> </span><span class="nv">f</span><span class="ss">(</span><span class="nv">X</span><span class="ss">)</span><span class="c1">; g(X); } while (0)</span>
#<span class="nv">define</span><span class="w"> </span><span class="nv">FOO</span><span class="ss">(</span><span class="nv">X</span><span class="ss">)</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="mi">1</span><span class="ss">)</span><span class="w"> </span>{<span class="w"> </span><span class="nv">f</span><span class="ss">(</span><span class="nv">X</span><span class="ss">)</span><span class="c1">; g(X); } else</span>
</pre></div>

<p>I can't see what the <code>do while</code> is doing. Why not just write this without it?</p>
<div class="code"><pre class="code literal-block">#define FOO(X) f(X); g(X)
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<p>The <code>do ... while</code> and <code>if ... else</code> are there to make it so that a semicolon
after your macro always means the same thing. Let's say you had something like
your second macro.</p>
<div class="code"><pre class="code literal-block">#define BAR(X) f(x); g(x)
</pre></div>

<p>Now if you were to use <code>BAR(X);</code> in an <code>if ... else</code> statement, where the
bodies of the if statement were not wrapped in curly brackets, you'd get a bad
surprise.</p>
<div class="code"><pre class="code literal-block"><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">corge</span><span class="ss">)</span>
<span class="w">  </span><span class="nv">BAR</span><span class="ss">(</span><span class="nv">corge</span><span class="ss">)</span><span class="c1">;</span>
<span class="k">else</span>
<span class="w">  </span><span class="nv">gralt</span><span class="ss">()</span><span class="c1">;</span>
</pre></div>

<p>The above code would expand into</p>
<div class="code"><pre class="code literal-block"><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">corge</span><span class="ss">)</span>
<span class="w">  </span><span class="nv">f</span><span class="ss">(</span><span class="nv">corge</span><span class="ss">)</span><span class="c1">; g(corge);</span>
<span class="k">else</span>
<span class="w">  </span><span class="nv">gralt</span><span class="ss">()</span><span class="c1">;</span>
</pre></div>

<p>which is syntactically incorrect, as the else is no longer associated with the
if. It doesn't help to wrap things in curly braces within the macro, because a
semicolon after the braces is syntactically incorrect.</p>
<div class="code"><pre class="code literal-block"><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">corge</span><span class="ss">)</span>
<span class="w">  </span>{<span class="nv">f</span><span class="ss">(</span><span class="nv">corge</span><span class="ss">)</span><span class="c1">; g(corge);};</span>
<span class="k">else</span>
<span class="w">  </span><span class="nv">gralt</span><span class="ss">()</span><span class="c1">;</span>
</pre></div>

<p>There are two ways of fixing the problem. The first is to use a comma to
sequence statements within the macro without robbing it of its ability to act
like an expression.</p>
<div class="code"><pre class="code literal-block">#define BAR(X) f(X), g(X)
</pre></div>

<p>The above version of bar <code>BAR</code> expands the above code into what follows, which
is syntactically correct.</p>
<div class="code"><pre class="code literal-block"><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">corge</span><span class="ss">)</span>
<span class="w">  </span><span class="nv">f</span><span class="ss">(</span><span class="nv">corge</span><span class="ss">)</span>,<span class="w"> </span><span class="nv">g</span><span class="ss">(</span><span class="nv">corge</span><span class="ss">)</span><span class="c1">;</span>
<span class="k">else</span>
<span class="w">  </span><span class="nv">gralt</span><span class="ss">()</span><span class="c1">;</span>
</pre></div>

<p>This doesn't work if instead of <code>f(X)</code> you have a more complicated body of
code that needs to go in its own block, say for example to declare local
variables. In the most general case the solution is to use something like <code>do
... while</code> to cause the macro to be a single statement that takes a semicolon
without confusion.</p>
<div class="code"><pre class="code literal-block">#<span class="nv">define</span><span class="w"> </span><span class="nv">BAR</span><span class="ss">(</span><span class="nv">X</span><span class="ss">)</span><span class="w"> </span><span class="k">do</span><span class="w"> </span>{<span class="w"> </span>\
<span class="w">  </span><span class="nv">int</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">f</span><span class="ss">(</span><span class="nv">X</span><span class="ss">)</span><span class="c1">; \</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">i</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">4</span><span class="ss">)</span><span class="w"> </span><span class="nv">g</span><span class="ss">(</span><span class="nv">i</span><span class="ss">)</span><span class="c1">; \</span>
}<span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="ss">(</span><span class="mi">0</span><span class="ss">)</span>
</pre></div>

<p>You don't have to use <code>do ... while</code>, you could cook up something with <code>if ...
else</code> as well, although when <code>if ... else</code> expands inside of an <code>if ... else</code>
it leads to a "dangling else", which could make an existing dangling else
problem even harder to find, as in the following code.</p>
<div class="code"><pre class="code literal-block"><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">corge</span><span class="ss">)</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="mi">1</span><span class="ss">)</span><span class="w"> </span>{<span class="w"> </span><span class="nv">f</span><span class="ss">(</span><span class="nv">corge</span><span class="ss">)</span><span class="c1">; g(corge); } else;</span>
<span class="k">else</span>
<span class="w">  </span><span class="nv">gralt</span><span class="ss">()</span><span class="c1">;</span>
</pre></div>

<p>The point is to use up the semicolon in contexts where a dangling semicolon is
erroneous. Of course, it could (and probably should) be argued at this point
that it would be better to declare <code>BAR</code> as an actual function, not a macro.</p>
<p>In summary, the <code>do ... while</code> is there to work around the shortcomings of the
C preprocessor. When those C style guides tell you to lay off the C
preprocessor, this is the kind of thing they're worried about.</p>
<p><br></p>
<h3>Suggest</h3>
<p>Macros are copy/pasted pieces of text the pre-processor will put in the
genuine code; the macro's author hopes the replacement will produce valid
code.</p>
<p>There are three good "tips" to succeed in that:</p>
<h3>Help the macro behave like genuine code</h3>
<p>Normal code is usually ended by a semi-colon. Should the user view code not
needing one...</p>
<div class="code"><pre class="code literal-block">doSomething(1) ;
DO_SOMETHING_ELSE(2)  // &lt;== Hey? What's this?
doSomethingElseAgain(3) ;
</pre></div>

<p>This means the user expects the compiler to produce an error if the semi-colon
is absent.</p>
<p>But the real real good reason is that at some time, the macro's author will
perhaps need to replace the macro with a genuine function (perhaps inlined).
So the macro should <strong>really</strong> behave like one.</p>
<p>So we should have a macro needing semi-colon.</p>
<h3>Produce a valid code</h3>
<p>As shown in jfm3's answer, sometimes the macro contains more than one
instruction. And if the macro is used inside a if statement, this will be
problematic:</p>
<div class="code"><pre class="code literal-block"><span class="k">if</span><span class="ss">(</span><span class="nv">bIsOk</span><span class="ss">)</span>
<span class="w">   </span><span class="nv">MY_MACRO</span><span class="ss">(</span><span class="mi">42</span><span class="ss">)</span><span class="w"> </span><span class="c1">;</span>
</pre></div>

<p>This macro could be expanded as:</p>
<div class="code"><pre class="code literal-block">#<span class="nv">define</span><span class="w"> </span><span class="nv">MY_MACRO</span><span class="ss">(</span><span class="nv">x</span><span class="ss">)</span><span class="w"> </span><span class="nv">f</span><span class="ss">(</span><span class="nv">x</span><span class="ss">)</span><span class="w"> </span><span class="c1">; g(x)</span>

<span class="k">if</span><span class="ss">(</span><span class="nv">bIsOk</span><span class="ss">)</span>
<span class="w">   </span><span class="nv">f</span><span class="ss">(</span><span class="mi">42</span><span class="ss">)</span><span class="w"> </span><span class="c1">; g(42) ; // was MY_MACRO(42) ;</span>
</pre></div>

<p>The <code>g</code> function will be executed regardless of the value of <code>bIsOk</code>.</p>
<p>This means that we must have to add a scope to the macro:</p>
<div class="code"><pre class="code literal-block">#<span class="nv">define</span><span class="w"> </span><span class="nv">MY_MACRO</span><span class="ss">(</span><span class="nv">x</span><span class="ss">)</span><span class="w"> </span>{<span class="w"> </span><span class="nv">f</span><span class="ss">(</span><span class="nv">x</span><span class="ss">)</span><span class="w"> </span><span class="c1">; g(x) ; }</span>

<span class="k">if</span><span class="ss">(</span><span class="nv">bIsOk</span><span class="ss">)</span>
<span class="w">   </span>{<span class="w"> </span><span class="nv">f</span><span class="ss">(</span><span class="mi">42</span><span class="ss">)</span><span class="w"> </span><span class="c1">; g(42) ; } ; // was MY_MACRO(42) ;</span>
</pre></div>

<h3>Produce a valid code 2</h3>
<p>If the macro is something like:</p>
<div class="code"><pre class="code literal-block">#define MY_MACRO(x) int i = x + 1 ; f(i) ;
</pre></div>

<p>We could have another problem in the following code:</p>
<div class="code"><pre class="code literal-block">void doSomething()
{
    int i = 25 ;
    MY_MACRO(32) ;
}
</pre></div>

<p>Because it would expand as:</p>
<div class="code"><pre class="code literal-block">void doSomething()
{
    int i = 25 ;
    int i = 32 + 1 ; f(i) ; ; // was MY_MACRO(32) ;
}
</pre></div>

<p>This code won't compile, of course. So, again, the solution is using a scope:</p>
<div class="code"><pre class="code literal-block">#define MY_MACRO(x) { int i = x + 1 ; f(i) ; }

void doSomething()
{
    int i = 25 ;
    { int i = 32 + 1 ; f(i) ; } ; // was MY_MACRO(32) ;
}
</pre></div>

<p>The code behaves correctly again.</p>
<h3>Combining semi-colon + scope effects?</h3>
<p>There is one C/C++ idiom that produces this effect: The do/while loop:</p>
<div class="code"><pre class="code literal-block"><span class="k">do</span>
{
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="nv">code</span>
}
<span class="k">while</span><span class="ss">(</span><span class="nv">false</span><span class="ss">)</span><span class="w"> </span><span class="c1">;</span>
</pre></div>

<p>The do/while can create a scope, thus encapsulating the macro's code, and
needs a semi-colon in the end, thus expanding into code needing one.</p>
<p>The bonus?</p>
<p>The C++ compiler will optimize away the do/while loop, as the fact its post-
condition is false is known at compile time. This means that a macro like:</p>
<div class="code"><pre class="code literal-block"><span class="c1">#define MY_MACRO(x)                                  \</span>
<span class="n">do</span><span class="w">                                                   </span>\
<span class="p">{</span><span class="w">                                                    </span>\
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">;</span><span class="w">                            </span>\
<span class="w">    </span><span class="n">f</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">g</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w">                                    </span>\
<span class="p">}</span><span class="w">                                                    </span>\
<span class="k">while</span><span class="p">(</span><span class="bp">false</span><span class="p">)</span>

<span class="nb nb-Type">void</span><span class="w"> </span><span class="n">doSomething</span><span class="p">(</span><span class="nb nb-Type">bool</span><span class="w"> </span><span class="n">bIsOk</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">25</span><span class="w"> </span><span class="p">;</span>

<span class="w">   </span><span class="k">if</span><span class="p">(</span><span class="n">bIsOk</span><span class="p">)</span>
<span class="w">      </span><span class="n">MY_MACRO</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>

<span class="w">   </span><span class="o">//</span><span class="w"> </span><span class="n">Etc</span><span class="o">.</span>
<span class="p">}</span>
</pre></div>

<p>will expand correctly as</p>
<div class="code"><pre class="code literal-block"><span class="nb nb-Type">void</span><span class="w"> </span><span class="n">doSomething</span><span class="p">(</span><span class="nb nb-Type">bool</span><span class="w"> </span><span class="n">bIsOk</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">25</span><span class="w"> </span><span class="p">;</span>

<span class="w">   </span><span class="k">if</span><span class="p">(</span><span class="n">bIsOk</span><span class="p">)</span>
<span class="w">      </span><span class="n">do</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">         </span><span class="k">const</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">42</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">MY_MACRO</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
<span class="w">         </span><span class="n">f</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">g</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">while</span><span class="p">(</span><span class="bp">false</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>

<span class="w">   </span><span class="o">//</span><span class="w"> </span><span class="n">Etc</span><span class="o">.</span>
<span class="p">}</span>
</pre></div>

<p>and is then compiled and optimized away as</p>
<div class="code"><pre class="code literal-block"><span class="nv">void</span><span class="w"> </span><span class="nv">doSomething</span><span class="ss">(</span><span class="nv">bool</span><span class="w"> </span><span class="nv">bIsOk</span><span class="ss">)</span>
{
<span class="w">   </span><span class="nv">int</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">25</span><span class="w"> </span><span class="c1">;</span>

<span class="w">   </span><span class="k">if</span><span class="ss">(</span><span class="nv">bIsOk</span><span class="ss">)</span>
<span class="w">   </span>{
<span class="w">      </span><span class="nv">f</span><span class="ss">(</span><span class="mi">43</span><span class="ss">)</span><span class="w"> </span><span class="c1">; g(43) ;</span>
<span class="w">   </span>}

<span class="w">   </span><span class="o">//</span><span class="w"> </span><span class="nv">Etc</span>.
}
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/why-is-2-i-i-faster-than-2-i-i-in-java/" class="u-url">Why is 2 * (i * i) faster than 2 * i * i in Java?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/why-is-2-i-i-faster-than-2-i-i-in-java/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T10:01:02+08:00" itemprop="datePublished" title="2023-02-17 10:01">2023-02-17 10:01</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>The following Java program takes on average between 0.50 secs and 0.55 secs to
run:</p>
<div class="code"><pre class="code literal-block"><span class="nv">public</span><span class="w"> </span><span class="nv">static</span><span class="w"> </span><span class="nv">void</span><span class="w"> </span><span class="nv">main</span><span class="ss">(</span><span class="nv">String</span>[]<span class="w"> </span><span class="nv">args</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">    </span><span class="nv">long</span><span class="w"> </span><span class="nv">startTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">System</span>.<span class="nv">nanoTime</span><span class="ss">()</span><span class="c1">;</span>
<span class="w">    </span><span class="nv">int</span><span class="w"> </span><span class="nv">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="c1">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="ss">(</span><span class="nv">int</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="c1">; i &lt; 1000000000; i++) {</span>
<span class="w">        </span><span class="nv">n</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="ss">(</span><span class="nv">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nv">i</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">    </span>}
<span class="w">    </span><span class="nv">System</span>.<span class="nv">out</span>.<span class="nv">println</span><span class="ss">(</span>
<span class="w">        </span><span class="ss">(</span><span class="nv">double</span><span class="ss">)</span><span class="w"> </span><span class="ss">(</span><span class="nv">System</span>.<span class="nv">nanoTime</span><span class="ss">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nv">startTime</span><span class="ss">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1000000000</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">" s"</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">    </span><span class="nv">System</span>.<span class="nv">out</span>.<span class="nv">println</span><span class="ss">(</span><span class="s2">"n = "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nv">n</span><span class="ss">)</span><span class="c1">;</span>
}
</pre></div>

<p>If I replace <code>2 * (i * i)</code> with <code>2 * i * i</code>, it takes between 0.60 and 0.65
secs to run. How come?</p>
<p>I ran each version of the program 15 times, alternating between the two. Here
are the results:</p>
<div class="code"><pre class="code literal-block"> 2*(i*i)  │  2*i*i
──────────┼──────────
0.5183738 │ 0.6246434
0.5298337 │ 0.6049722
0.5308647 │ 0.6603363
0.5133458 │ 0.6243328
0.5003011 │ 0.6541802
0.5366181 │ 0.6312638
0.515149  │ 0.6241105
0.5237389 │ 0.627815
0.5249942 │ 0.6114252
0.5641624 │ 0.6781033
0.538412  │ 0.6393969
0.5466744 │ 0.6608845
0.531159  │ 0.6201077
0.5048032 │ 0.6511559
0.5232789 │ 0.6544526
</pre></div>

<p>The fastest run of <code>2 * i * i</code> took longer than the slowest run of <code>2 * (i *
i)</code>. If they had the same efficiency, the probability of this happening would
be less than <code>1/2^15 * 100% = 0.00305%</code>.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>There is a slight difference in the ordering of the bytecode.</p>
<p><code>2 * (i * i)</code>:</p>
<div class="code"><pre class="code literal-block"><span class="w">     </span><span class="n">iconst_2</span>
<span class="w">     </span><span class="n">iload0</span>
<span class="w">     </span><span class="n">iload0</span>
<span class="w">     </span><span class="n">imul</span>
<span class="w">     </span><span class="n">imul</span>
<span class="w">     </span><span class="n">iadd</span>
</pre></div>

<p>vs <code>2 * i * i</code>:</p>
<div class="code"><pre class="code literal-block"><span class="w">     </span><span class="n">iconst_2</span>
<span class="w">     </span><span class="n">iload0</span>
<span class="w">     </span><span class="n">imul</span>
<span class="w">     </span><span class="n">iload0</span>
<span class="w">     </span><span class="n">imul</span>
<span class="w">     </span><span class="n">iadd</span>
</pre></div>

<p>At first sight this should not make a difference; if anything the second
version is more optimal since it uses one slot less.</p>
<p>So we need to dig deeper into the lower level (JIT)1.</p>
<p>Remember that JIT tends to unroll small loops very aggressively. Indeed we
observe a 16x unrolling for the <code>2 * (i * i)</code> case:</p>
<div class="code"><pre class="code literal-block"><span class="mf">030</span><span class="w">   </span><span class="n">B2</span><span class="p">:</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">B2</span><span class="w"> </span><span class="n">B3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">B1</span><span class="w"> </span><span class="n">B2</span><span class="w">  </span><span class="n">Loop</span><span class="p">:</span><span class="w"> </span><span class="n">B2</span><span class="o">-</span><span class="n">B2</span><span class="w"> </span><span class="n">inner</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">N18</span><span class="w"> </span><span class="nb">Fre</span><span class="n">q</span><span class="p">:</span><span class="w"> </span><span class="mf">1</span><span class="n">e</span><span class="o">+</span><span class="mf">006</span>
<span class="mf">030</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R11</span><span class="p">,</span><span class="w"> </span><span class="n">RBP</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">033</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">RBP</span><span class="p">,</span><span class="w"> </span><span class="n">R13</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">036</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">RBP</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">14</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">039</span><span class="w">     </span><span class="n">imull</span><span class="w">   </span><span class="n">RBP</span><span class="p">,</span><span class="w"> </span><span class="n">RBP</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">03</span><span class="n">c</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">R9</span><span class="p">,</span><span class="w"> </span><span class="n">R13</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">03</span><span class="n">f</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R9</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">13</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">043</span><span class="w">     </span><span class="n">imull</span><span class="w">   </span><span class="n">R9</span><span class="p">,</span><span class="w"> </span><span class="n">R9</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">047</span><span class="w">     </span><span class="n">sall</span><span class="w">    </span><span class="n">RBP</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">1</span>
<span class="mf">049</span><span class="w">     </span><span class="n">sall</span><span class="w">    </span><span class="n">R9</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">1</span>
<span class="mf">04</span><span class="n">c</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">R8</span><span class="p">,</span><span class="w"> </span><span class="n">R13</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">04</span><span class="n">f</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R8</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">15</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">053</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="n">R8</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">056</span><span class="w">     </span><span class="n">movdl</span><span class="w">   </span><span class="n">XMM1</span><span class="p">,</span><span class="w"> </span><span class="n">R8</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">05</span><span class="n">b</span><span class="w">     </span><span class="n">imull</span><span class="w">   </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="n">R8</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">05</span><span class="n">f</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">R8</span><span class="p">,</span><span class="w"> </span><span class="n">R13</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">062</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R8</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">12</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">066</span><span class="w">     </span><span class="n">imull</span><span class="w">   </span><span class="n">R8</span><span class="p">,</span><span class="w"> </span><span class="n">R8</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">06</span><span class="n">a</span><span class="w">     </span><span class="n">sall</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">1</span>
<span class="mf">06</span><span class="n">d</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="err">[</span><span class="n">rsp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="err">#</span><span class="mf">32</span><span class="err">]</span><span class="p">,</span><span class="w"> </span><span class="n">R10</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">072</span><span class="w">     </span><span class="n">sall</span><span class="w">    </span><span class="n">R8</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">1</span>
<span class="mf">075</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">RBX</span><span class="p">,</span><span class="w"> </span><span class="n">R13</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">078</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">RBX</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">11</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">07</span><span class="n">b</span><span class="w">     </span><span class="n">imull</span><span class="w">   </span><span class="n">RBX</span><span class="p">,</span><span class="w"> </span><span class="n">RBX</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">07</span><span class="n">e</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">RCX</span><span class="p">,</span><span class="w"> </span><span class="n">R13</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">081</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">RCX</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">10</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">084</span><span class="w">     </span><span class="n">imull</span><span class="w">   </span><span class="n">RCX</span><span class="p">,</span><span class="w"> </span><span class="n">RCX</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">087</span><span class="w">     </span><span class="n">sall</span><span class="w">    </span><span class="n">RBX</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">1</span>
<span class="mf">089</span><span class="w">     </span><span class="n">sall</span><span class="w">    </span><span class="n">RCX</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">1</span>
<span class="mf">08</span><span class="n">b</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">RDX</span><span class="p">,</span><span class="w"> </span><span class="n">R13</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">08</span><span class="n">e</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">RDX</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">8</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">091</span><span class="w">     </span><span class="n">imull</span><span class="w">   </span><span class="n">RDX</span><span class="p">,</span><span class="w"> </span><span class="n">RDX</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">094</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">RDI</span><span class="p">,</span><span class="w"> </span><span class="n">R13</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">097</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">RDI</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">7</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">09</span><span class="n">a</span><span class="w">     </span><span class="n">imull</span><span class="w">   </span><span class="n">RDI</span><span class="p">,</span><span class="w"> </span><span class="n">RDI</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">09</span><span class="n">d</span><span class="w">     </span><span class="n">sall</span><span class="w">    </span><span class="n">RDX</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">1</span>
<span class="mf">09</span><span class="n">f</span><span class="w">     </span><span class="n">sall</span><span class="w">    </span><span class="n">RDI</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">1</span>
<span class="mf">0</span><span class="n">a1</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">RAX</span><span class="p">,</span><span class="w"> </span><span class="n">R13</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">0</span><span class="n">a4</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">RAX</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">6</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">0</span><span class="n">a7</span><span class="w">     </span><span class="n">imull</span><span class="w">   </span><span class="n">RAX</span><span class="p">,</span><span class="w"> </span><span class="n">RAX</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">0</span><span class="n">aa</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">RSI</span><span class="p">,</span><span class="w"> </span><span class="n">R13</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">0</span><span class="n">ad</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">RSI</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">4</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">0</span><span class="n">b0</span><span class="w">     </span><span class="n">imull</span><span class="w">   </span><span class="n">RSI</span><span class="p">,</span><span class="w"> </span><span class="n">RSI</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">0</span><span class="n">b3</span><span class="w">     </span><span class="n">sall</span><span class="w">    </span><span class="n">RAX</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">1</span>
<span class="mf">0</span><span class="n">b5</span><span class="w">     </span><span class="n">sall</span><span class="w">    </span><span class="n">RSI</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">1</span>
<span class="mf">0</span><span class="n">b7</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="n">R13</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">0</span><span class="n">ba</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">2</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">0</span><span class="n">be</span><span class="w">     </span><span class="n">imull</span><span class="w">   </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="n">R10</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">0</span><span class="n">c2</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">R14</span><span class="p">,</span><span class="w"> </span><span class="n">R13</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">0</span><span class="n">c5</span><span class="w">     </span><span class="n">incl</span><span class="w">    </span><span class="n">R14</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">0</span><span class="n">c8</span><span class="w">     </span><span class="n">imull</span><span class="w">   </span><span class="n">R14</span><span class="p">,</span><span class="w"> </span><span class="n">R14</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">0</span><span class="n">cc</span><span class="w">     </span><span class="n">sall</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">1</span>
<span class="mf">0</span><span class="n">cf</span><span class="w">     </span><span class="n">sall</span><span class="w">    </span><span class="n">R14</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">1</span>
<span class="mf">0</span><span class="n">d2</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R14</span><span class="p">,</span><span class="w"> </span><span class="n">R11</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">0</span><span class="n">d5</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R14</span><span class="p">,</span><span class="w"> </span><span class="n">R10</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">0</span><span class="n">d8</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="n">R13</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">0</span><span class="n">db</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">3</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">0</span><span class="n">df</span><span class="w">     </span><span class="n">imull</span><span class="w">   </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="n">R10</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">0</span><span class="n">e3</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">R11</span><span class="p">,</span><span class="w"> </span><span class="n">R13</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">0</span><span class="n">e6</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R11</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">5</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">0</span><span class="n">ea</span><span class="w">     </span><span class="n">imull</span><span class="w">   </span><span class="n">R11</span><span class="p">,</span><span class="w"> </span><span class="n">R11</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">0</span><span class="n">ee</span><span class="w">     </span><span class="n">sall</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">1</span>
<span class="mf">0</span><span class="n">f1</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="n">R14</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">0</span><span class="n">f4</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="n">RSI</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">0</span><span class="n">f7</span><span class="w">     </span><span class="n">sall</span><span class="w">    </span><span class="n">R11</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">1</span>
<span class="mf">0</span><span class="n">fa</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R11</span><span class="p">,</span><span class="w"> </span><span class="n">R10</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">0</span><span class="n">fd</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R11</span><span class="p">,</span><span class="w"> </span><span class="n">RAX</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">100</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R11</span><span class="p">,</span><span class="w"> </span><span class="n">RDI</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">103</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R11</span><span class="p">,</span><span class="w"> </span><span class="n">RDX</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">106</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="n">R13</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">109</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">9</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">10</span><span class="n">d</span><span class="w">     </span><span class="n">imull</span><span class="w">   </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="n">R10</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">111</span><span class="w">     </span><span class="n">sall</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">1</span>
<span class="mf">114</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="n">R11</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">117</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="n">RCX</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">11</span><span class="n">a</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="n">RBX</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">11</span><span class="n">d</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="n">R8</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">120</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R9</span><span class="p">,</span><span class="w"> </span><span class="n">R10</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">123</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">RBP</span><span class="p">,</span><span class="w"> </span><span class="n">R9</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">126</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">RBP</span><span class="p">,</span><span class="w"> </span><span class="err">[</span><span class="n">RSP</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="err">#</span><span class="mf">32</span><span class="w"> </span><span class="p">(</span><span class="mf">32</span><span class="o">-</span><span class="n">bit</span><span class="p">)</span><span class="err">]</span><span class="w">   </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">12</span><span class="n">a</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R13</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">16</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">12</span><span class="n">e</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">R11</span><span class="p">,</span><span class="w"> </span><span class="n">R13</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">131</span><span class="w">     </span><span class="n">imull</span><span class="w">   </span><span class="n">R11</span><span class="p">,</span><span class="w"> </span><span class="n">R13</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">135</span><span class="w">     </span><span class="n">sall</span><span class="w">    </span><span class="n">R11</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">1</span>
<span class="mf">138</span><span class="w">     </span><span class="n">cmpl</span><span class="w">    </span><span class="n">R13</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">999999985</span>
<span class="mf">13</span><span class="n">f</span><span class="w">     </span><span class="n">jl</span><span class="w">     </span><span class="n">B2</span><span class="w">   </span><span class="err">#</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="kr">end</span><span class="w">  </span><span class="n">P</span><span class="o">=</span><span class="mf">1.000000</span><span class="w"> </span><span class="n">C</span><span class="o">=</span><span class="mf">6554623.000000</span>
</pre></div>

<p>We see that there is 1 register that is "spilled" onto the stack.</p>
<p>And for the <code>2 * i * i</code> version:</p>
<div class="code"><pre class="code literal-block"><span class="mf">05</span><span class="n">a</span><span class="w">   </span><span class="n">B3</span><span class="p">:</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">B2</span><span class="w"> </span><span class="n">B4</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">B1</span><span class="w"> </span><span class="n">B2</span><span class="w">  </span><span class="n">Loop</span><span class="p">:</span><span class="w"> </span><span class="n">B3</span><span class="o">-</span><span class="n">B2</span><span class="w"> </span><span class="n">inner</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">N18</span><span class="w"> </span><span class="nb">Fre</span><span class="n">q</span><span class="p">:</span><span class="w"> </span><span class="mf">1</span><span class="n">e</span><span class="o">+</span><span class="mf">006</span>
<span class="mf">05</span><span class="n">a</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">RBX</span><span class="p">,</span><span class="w"> </span><span class="n">R11</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">05</span><span class="n">d</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="err">[</span><span class="n">rsp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="err">#</span><span class="mf">32</span><span class="err">]</span><span class="p">,</span><span class="w"> </span><span class="n">RBX</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">061</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">R11</span><span class="p">,</span><span class="w"> </span><span class="n">R8</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">064</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R11</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">15</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">068</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="err">[</span><span class="n">rsp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="err">#</span><span class="mf">36</span><span class="err">]</span><span class="p">,</span><span class="w"> </span><span class="n">R11</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">06</span><span class="n">d</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">R11</span><span class="p">,</span><span class="w"> </span><span class="n">R8</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">070</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R11</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">14</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">074</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="n">R9</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">077</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">16</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">07</span><span class="n">b</span><span class="w">     </span><span class="n">movdl</span><span class="w">   </span><span class="n">XMM2</span><span class="p">,</span><span class="w"> </span><span class="n">R10</span><span class="w">   </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">080</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">RCX</span><span class="p">,</span><span class="w"> </span><span class="n">R9</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">083</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">RCX</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">14</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">086</span><span class="w">     </span><span class="n">movdl</span><span class="w">   </span><span class="n">XMM1</span><span class="p">,</span><span class="w"> </span><span class="n">RCX</span><span class="w">   </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">08</span><span class="n">a</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="n">R9</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">08</span><span class="n">d</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">12</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">091</span><span class="w">     </span><span class="n">movdl</span><span class="w">   </span><span class="n">XMM4</span><span class="p">,</span><span class="w"> </span><span class="n">R10</span><span class="w">   </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">096</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">RCX</span><span class="p">,</span><span class="w"> </span><span class="n">R9</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">099</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">RCX</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">10</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">09</span><span class="n">c</span><span class="w">     </span><span class="n">movdl</span><span class="w">   </span><span class="n">XMM6</span><span class="p">,</span><span class="w"> </span><span class="n">RCX</span><span class="w">   </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">0</span><span class="n">a0</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">RBX</span><span class="p">,</span><span class="w"> </span><span class="n">R9</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">0</span><span class="n">a3</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">RBX</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">8</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">0</span><span class="n">a6</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">RCX</span><span class="p">,</span><span class="w"> </span><span class="n">R9</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">0</span><span class="n">a9</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">RCX</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">6</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">0</span><span class="n">ac</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">RDX</span><span class="p">,</span><span class="w"> </span><span class="n">R9</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">0</span><span class="n">af</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">RDX</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">4</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">0</span><span class="n">b2</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R9</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">2</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">0</span><span class="n">b6</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="n">R14</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">0</span><span class="n">b9</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">22</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">0</span><span class="n">bd</span><span class="w">     </span><span class="n">movdl</span><span class="w">   </span><span class="n">XMM3</span><span class="p">,</span><span class="w"> </span><span class="n">R10</span><span class="w">   </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">0</span><span class="n">c2</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">RDI</span><span class="p">,</span><span class="w"> </span><span class="n">R14</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">0</span><span class="n">c5</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">RDI</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">20</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">0</span><span class="n">c8</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">RAX</span><span class="p">,</span><span class="w"> </span><span class="n">R14</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">0</span><span class="n">cb</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">RAX</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">32</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">0</span><span class="n">ce</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">RSI</span><span class="p">,</span><span class="w"> </span><span class="n">R14</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">0</span><span class="n">d1</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">RSI</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">18</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">0</span><span class="n">d4</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">R13</span><span class="p">,</span><span class="w"> </span><span class="n">R14</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">0</span><span class="n">d7</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R13</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">24</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">0</span><span class="n">db</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="n">R14</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">0</span><span class="n">de</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">26</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">0</span><span class="n">e2</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="err">[</span><span class="n">rsp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="err">#</span><span class="mf">40</span><span class="err">]</span><span class="p">,</span><span class="w"> </span><span class="n">R10</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">0</span><span class="n">e7</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">RBP</span><span class="p">,</span><span class="w"> </span><span class="n">R14</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">0</span><span class="n">ea</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">RBP</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">28</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">0</span><span class="n">ed</span><span class="w">     </span><span class="n">imull</span><span class="w">   </span><span class="n">RBP</span><span class="p">,</span><span class="w"> </span><span class="n">R11</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">0</span><span class="n">f1</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R14</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">30</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">0</span><span class="n">f5</span><span class="w">     </span><span class="n">imull</span><span class="w">   </span><span class="n">R14</span><span class="p">,</span><span class="w"> </span><span class="err">[</span><span class="n">RSP</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="err">#</span><span class="mf">36</span><span class="w"> </span><span class="p">(</span><span class="mf">32</span><span class="o">-</span><span class="n">bit</span><span class="p">)</span><span class="err">]</span><span class="w">   </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">0</span><span class="n">fb</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="n">R8</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">0</span><span class="n">fe</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">11</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">102</span><span class="w">     </span><span class="n">movdl</span><span class="w">   </span><span class="n">R11</span><span class="p">,</span><span class="w"> </span><span class="n">XMM3</span><span class="w">   </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">107</span><span class="w">     </span><span class="n">imull</span><span class="w">   </span><span class="n">R11</span><span class="p">,</span><span class="w"> </span><span class="n">R10</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">10</span><span class="n">b</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="err">[</span><span class="n">rsp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="err">#</span><span class="mf">44</span><span class="err">]</span><span class="p">,</span><span class="w"> </span><span class="n">R11</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">110</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="n">R8</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">113</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">10</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">117</span><span class="w">     </span><span class="n">imull</span><span class="w">   </span><span class="n">RDI</span><span class="p">,</span><span class="w"> </span><span class="n">R10</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">11</span><span class="n">b</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">R11</span><span class="p">,</span><span class="w"> </span><span class="n">R8</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">11</span><span class="n">e</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R11</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">8</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">122</span><span class="w">     </span><span class="n">movdl</span><span class="w">   </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="n">XMM2</span><span class="w">   </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">127</span><span class="w">     </span><span class="n">imull</span><span class="w">   </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="n">R11</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">12</span><span class="n">b</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="err">[</span><span class="n">rsp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="err">#</span><span class="mf">48</span><span class="err">]</span><span class="p">,</span><span class="w"> </span><span class="n">R10</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">130</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="n">R8</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">133</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">7</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">137</span><span class="w">     </span><span class="n">movdl</span><span class="w">   </span><span class="n">R11</span><span class="p">,</span><span class="w"> </span><span class="n">XMM1</span><span class="w">   </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">13</span><span class="n">c</span><span class="w">     </span><span class="n">imull</span><span class="w">   </span><span class="n">R11</span><span class="p">,</span><span class="w"> </span><span class="n">R10</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">140</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="err">[</span><span class="n">rsp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="err">#</span><span class="mf">52</span><span class="err">]</span><span class="p">,</span><span class="w"> </span><span class="n">R11</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">145</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">R11</span><span class="p">,</span><span class="w"> </span><span class="n">R8</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">148</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R11</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">6</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">14</span><span class="n">c</span><span class="w">     </span><span class="n">movdl</span><span class="w">   </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="n">XMM4</span><span class="w">   </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">151</span><span class="w">     </span><span class="n">imull</span><span class="w">   </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="n">R11</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">155</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="err">[</span><span class="n">rsp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="err">#</span><span class="mf">56</span><span class="err">]</span><span class="p">,</span><span class="w"> </span><span class="n">R10</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">15</span><span class="n">a</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="n">R8</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">15</span><span class="n">d</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">5</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">161</span><span class="w">     </span><span class="n">movdl</span><span class="w">   </span><span class="n">R11</span><span class="p">,</span><span class="w"> </span><span class="n">XMM6</span><span class="w">   </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">166</span><span class="w">     </span><span class="n">imull</span><span class="w">   </span><span class="n">R11</span><span class="p">,</span><span class="w"> </span><span class="n">R10</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">16</span><span class="n">a</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="err">[</span><span class="n">rsp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="err">#</span><span class="mf">60</span><span class="err">]</span><span class="p">,</span><span class="w"> </span><span class="n">R11</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">16</span><span class="n">f</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">R11</span><span class="p">,</span><span class="w"> </span><span class="n">R8</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">172</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R11</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">4</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">176</span><span class="w">     </span><span class="n">imull</span><span class="w">   </span><span class="n">RBX</span><span class="p">,</span><span class="w"> </span><span class="n">R11</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">17</span><span class="n">a</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">R11</span><span class="p">,</span><span class="w"> </span><span class="n">R8</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">17</span><span class="n">d</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R11</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">3</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">181</span><span class="w">     </span><span class="n">imull</span><span class="w">   </span><span class="n">RCX</span><span class="p">,</span><span class="w"> </span><span class="n">R11</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">185</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="n">R8</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">188</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">2</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">18</span><span class="n">c</span><span class="w">     </span><span class="n">imull</span><span class="w">   </span><span class="n">RDX</span><span class="p">,</span><span class="w"> </span><span class="n">R10</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">190</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">R11</span><span class="p">,</span><span class="w"> </span><span class="n">R8</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">193</span><span class="w">     </span><span class="n">incl</span><span class="w">    </span><span class="n">R11</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">196</span><span class="w">     </span><span class="n">imull</span><span class="w">   </span><span class="n">R9</span><span class="p">,</span><span class="w"> </span><span class="n">R11</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">19</span><span class="n">a</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R9</span><span class="p">,</span><span class="w"> </span><span class="err">[</span><span class="n">RSP</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="err">#</span><span class="mf">32</span><span class="w"> </span><span class="p">(</span><span class="mf">32</span><span class="o">-</span><span class="n">bit</span><span class="p">)</span><span class="err">]</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">19</span><span class="n">f</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R9</span><span class="p">,</span><span class="w"> </span><span class="n">RDX</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">1</span><span class="n">a2</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R9</span><span class="p">,</span><span class="w"> </span><span class="n">RCX</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">1</span><span class="n">a5</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R9</span><span class="p">,</span><span class="w"> </span><span class="n">RBX</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">1</span><span class="n">a8</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R9</span><span class="p">,</span><span class="w"> </span><span class="err">[</span><span class="n">RSP</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="err">#</span><span class="mf">60</span><span class="w"> </span><span class="p">(</span><span class="mf">32</span><span class="o">-</span><span class="n">bit</span><span class="p">)</span><span class="err">]</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">1</span><span class="n">ad</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R9</span><span class="p">,</span><span class="w"> </span><span class="err">[</span><span class="n">RSP</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="err">#</span><span class="mf">56</span><span class="w"> </span><span class="p">(</span><span class="mf">32</span><span class="o">-</span><span class="n">bit</span><span class="p">)</span><span class="err">]</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">1</span><span class="n">b2</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R9</span><span class="p">,</span><span class="w"> </span><span class="err">[</span><span class="n">RSP</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="err">#</span><span class="mf">52</span><span class="w"> </span><span class="p">(</span><span class="mf">32</span><span class="o">-</span><span class="n">bit</span><span class="p">)</span><span class="err">]</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">1</span><span class="n">b7</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R9</span><span class="p">,</span><span class="w"> </span><span class="err">[</span><span class="n">RSP</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="err">#</span><span class="mf">48</span><span class="w"> </span><span class="p">(</span><span class="mf">32</span><span class="o">-</span><span class="n">bit</span><span class="p">)</span><span class="err">]</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">1</span><span class="n">bc</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="n">R8</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">1</span><span class="n">bf</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">9</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">1</span><span class="n">c3</span><span class="w">     </span><span class="n">imull</span><span class="w">   </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="n">RSI</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">1</span><span class="n">c7</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="n">R9</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">1</span><span class="n">ca</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="n">RDI</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">1</span><span class="n">cd</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="err">[</span><span class="n">RSP</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="err">#</span><span class="mf">44</span><span class="w"> </span><span class="p">(</span><span class="mf">32</span><span class="o">-</span><span class="n">bit</span><span class="p">)</span><span class="err">]</span><span class="w">   </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">1</span><span class="n">d2</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">R11</span><span class="p">,</span><span class="w"> </span><span class="n">R8</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">1</span><span class="n">d5</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R11</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">12</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">1</span><span class="n">d9</span><span class="w">     </span><span class="n">imull</span><span class="w">   </span><span class="n">R13</span><span class="p">,</span><span class="w"> </span><span class="n">R11</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">1</span><span class="n">dd</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R13</span><span class="p">,</span><span class="w"> </span><span class="n">R10</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">1</span><span class="n">e0</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="n">R8</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">1</span><span class="n">e3</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">13</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">1</span><span class="n">e7</span><span class="w">     </span><span class="n">imull</span><span class="w">   </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="err">[</span><span class="n">RSP</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="err">#</span><span class="mf">40</span><span class="w"> </span><span class="p">(</span><span class="mf">32</span><span class="o">-</span><span class="n">bit</span><span class="p">)</span><span class="err">]</span><span class="w">   </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">1</span><span class="n">ed</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="n">R13</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">1</span><span class="n">f0</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">RBP</span><span class="p">,</span><span class="w"> </span><span class="n">R10</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">1</span><span class="n">f3</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R14</span><span class="p">,</span><span class="w"> </span><span class="n">RBP</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">1</span><span class="n">f6</span><span class="w">     </span><span class="n">movl</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="n">R8</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">spill</span>
<span class="mf">1</span><span class="n">f9</span><span class="w">     </span><span class="n">addl</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">16</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nb">int</span>
<span class="mf">1</span><span class="n">fd</span><span class="w">     </span><span class="n">cmpl</span><span class="w">    </span><span class="n">R10</span><span class="p">,</span><span class="w"> </span><span class="err">#</span><span class="mf">999999985</span>
<span class="mf">204</span><span class="w">     </span><span class="n">jl</span><span class="w">     </span><span class="n">B2</span><span class="w">   </span><span class="err">#</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="kr">end</span><span class="w">  </span><span class="n">P</span><span class="o">=</span><span class="mf">1.000000</span><span class="w"> </span><span class="n">C</span><span class="o">=</span><span class="mf">7419903.000000</span>
</pre></div>

<p>Here we observe much more "spilling" and more accesses to the stack <code>[RSP +
...]</code>, due to more intermediate results that need to be preserved.</p>
<p>Thus the answer to the question is simple: <code>2 * (i * i)</code> is faster than <code>2 * i
* i</code> because the JIT generates more optimal assembly code for the first case.</p>
<hr>
<p>But of course it is obvious that neither the first nor the second version is
any good; the loop could really benefit from vectorization, since any x86-64
CPU has at least SSE2 support.</p>
<p>So it's an issue of the optimizer; as is often the case, it unrolls too
aggressively and shoots itself in the foot, all the while missing out on
various other opportunities.</p>
<p>In fact, modern x86-64 CPUs break down the instructions further into micro-ops
(µops) and with features like register renaming, µop caches and loop buffers,
loop optimization takes a lot more finesse than a simple unrolling for optimal
performance. According to Agner Fog's optimization guide:</p>
<blockquote>
<p>The gain in performance due to the µop cache can be quite considerable if
the average instruction length is more than 4 bytes. The following methods
of optimizing the use of the µop cache may be considered:</p>
<ul>
<li>Make sure that critical loops are small enough to fit into the µop
cache.</li>
<li>Align the most critical loop entries and function entries by 32.</li>
<li>Avoid unnecessary loop unrolling.</li>
<li>Avoid instructions that have extra load time<br>
 . . .
</li>
</ul>
</blockquote>
<p>Regarding those load times - even the fastest L1D hit costs 4 cycles, an extra
register and µop, so yes, even a few accesses to memory will hurt performance
in tight loops.</p>
<p>But back to the vectorization opportunity - to see how fast it can be, we can
compile a similar C application with GCC, which outright vectorizes it (AVX2
is shown, SSE2 is similar)2:</p>
<div class="code"><pre class="code literal-block"><span class="w">  </span><span class="n">vmovdqa</span><span class="w"> </span><span class="n">ymm0</span><span class="p">,</span><span class="w"> </span><span class="n">YMMWORD</span><span class="w"> </span><span class="n">PTR</span><span class="w"> </span><span class="p">.</span><span class="n">LC0</span><span class="o">[</span><span class="n">rip</span><span class="o">]</span>
<span class="w">  </span><span class="n">vmovdqa</span><span class="w"> </span><span class="n">ymm3</span><span class="p">,</span><span class="w"> </span><span class="n">YMMWORD</span><span class="w"> </span><span class="n">PTR</span><span class="w"> </span><span class="p">.</span><span class="n">LC1</span><span class="o">[</span><span class="n">rip</span><span class="o">]</span>
<span class="w">  </span><span class="n">xor</span><span class="w"> </span><span class="n">eax</span><span class="p">,</span><span class="w"> </span><span class="n">eax</span>
<span class="w">  </span><span class="n">vpxor</span><span class="w"> </span><span class="n">xmm2</span><span class="p">,</span><span class="w"> </span><span class="n">xmm2</span><span class="p">,</span><span class="w"> </span><span class="n">xmm2</span>
<span class="p">.</span><span class="nl">L2</span><span class="p">:</span>
<span class="w">  </span><span class="n">vpmulld</span><span class="w"> </span><span class="n">ymm1</span><span class="p">,</span><span class="w"> </span><span class="n">ymm0</span><span class="p">,</span><span class="w"> </span><span class="n">ymm0</span>
<span class="w">  </span><span class="n">inc</span><span class="w"> </span><span class="n">eax</span>
<span class="w">  </span><span class="n">vpaddd</span><span class="w"> </span><span class="n">ymm0</span><span class="p">,</span><span class="w"> </span><span class="n">ymm0</span><span class="p">,</span><span class="w"> </span><span class="n">ymm3</span>
<span class="w">  </span><span class="n">vpslld</span><span class="w"> </span><span class="n">ymm1</span><span class="p">,</span><span class="w"> </span><span class="n">ymm1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span>
<span class="w">  </span><span class="n">vpaddd</span><span class="w"> </span><span class="n">ymm2</span><span class="p">,</span><span class="w"> </span><span class="n">ymm2</span><span class="p">,</span><span class="w"> </span><span class="n">ymm1</span>
<span class="w">  </span><span class="n">cmp</span><span class="w"> </span><span class="n">eax</span><span class="p">,</span><span class="w"> </span><span class="mi">125000000</span><span class="w">      </span><span class="p">;</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="n">calculations</span><span class="w"> </span><span class="n">per</span><span class="w"> </span><span class="n">iteration</span>
<span class="w">  </span><span class="n">jne</span><span class="w"> </span><span class="p">.</span><span class="n">L2</span>
<span class="w">  </span><span class="n">vmovdqa</span><span class="w"> </span><span class="n">xmm0</span><span class="p">,</span><span class="w"> </span><span class="n">xmm2</span>
<span class="w">  </span><span class="n">vextracti128</span><span class="w"> </span><span class="n">xmm2</span><span class="p">,</span><span class="w"> </span><span class="n">ymm2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span>
<span class="w">  </span><span class="n">vpaddd</span><span class="w"> </span><span class="n">xmm2</span><span class="p">,</span><span class="w"> </span><span class="n">xmm0</span><span class="p">,</span><span class="w"> </span><span class="n">xmm2</span>
<span class="w">  </span><span class="n">vpsrldq</span><span class="w"> </span><span class="n">xmm0</span><span class="p">,</span><span class="w"> </span><span class="n">xmm2</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span>
<span class="w">  </span><span class="n">vpaddd</span><span class="w"> </span><span class="n">xmm0</span><span class="p">,</span><span class="w"> </span><span class="n">xmm2</span><span class="p">,</span><span class="w"> </span><span class="n">xmm0</span>
<span class="w">  </span><span class="n">vpsrldq</span><span class="w"> </span><span class="n">xmm1</span><span class="p">,</span><span class="w"> </span><span class="n">xmm0</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span>
<span class="w">  </span><span class="n">vpaddd</span><span class="w"> </span><span class="n">xmm0</span><span class="p">,</span><span class="w"> </span><span class="n">xmm0</span><span class="p">,</span><span class="w"> </span><span class="n">xmm1</span>
<span class="w">  </span><span class="n">vmovd</span><span class="w"> </span><span class="n">eax</span><span class="p">,</span><span class="w"> </span><span class="n">xmm0</span>
<span class="w">  </span><span class="n">vzeroupper</span>
</pre></div>

<p>With run times:</p>
<ul>
<li>SSE: 0.24 s, or 2 times as fast.</li>
<li>AVX: 0.15 s, or 3 times as fast.</li>
<li>AVX2: 0.08 s, or 5 times as fast.</li>
</ul>
<hr>
<p>1 To get JIT generated assembly output, get a debug JVM and run with
<code>-XX:+PrintOptoAssembly</code></p>
<p>2 The C version is compiled with the <code>-fwrapv</code> flag, which enables GCC to
treat signed integer overflow as a two's-complement wrap-around.</p>
<p><br></p>
<h3>Suggest</h3>
<p>(Editor's note: this answer is contradicted by evidence from looking at the
asm, as shown by another answer. This was a guess backed up by some
experiments, but it turned out not to be correct.)</p>
<hr>
<p>When the multiplication is <code>2 * (i * i)</code>, the JVM is able to factor out the
multiplication by <code>2</code> from the loop, resulting in this equivalent but more
efficient code:</p>
<div class="code"><pre class="code literal-block"><span class="nv">int</span><span class="w"> </span><span class="nv">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="c1">;</span>
<span class="k">for</span><span class="w"> </span><span class="ss">(</span><span class="nv">int</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="c1">; i &lt; 1000000000; i++) {</span>
<span class="w">    </span><span class="nv">n</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nv">i</span><span class="c1">;</span>
}
<span class="nv">n</span><span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="mi">2</span><span class="c1">;</span>
</pre></div>

<p>but when the multiplication is <code>(2 * i) * i</code>, the JVM doesn't optimize it
since the multiplication by a constant is no longer right before the <code>n +=</code>
addition.</p>
<p>Here are a few reasons why I think this is the case:</p>
<ul>
<li>Adding an <code>if (n == 0) n = 1</code> statement at the start of the loop results in both versions being as efficient, since factoring out the multiplication no longer guarantees that the result will be the same</li>
<li>The optimized version (by factoring out the multiplication by 2) is exactly as fast as the <code>2 * (i * i)</code> version</li>
</ul>
<p>Here is the test code that I used to draw these conclusions:</p>
<div class="code"><pre class="code literal-block"><span class="nt">public</span><span class="w"> </span><span class="nt">static</span><span class="w"> </span><span class="nt">void</span><span class="w"> </span><span class="nt">main</span><span class="o">(</span><span class="nt">String</span><span class="cp">[]</span><span class="w"> </span><span class="nt">args</span><span class="o">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="err">long</span><span class="w"> </span><span class="err">fastVersion</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">0</span><span class="p">;</span>
<span class="w">    </span><span class="err">long</span><span class="w"> </span><span class="err">slowVersion</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">0</span><span class="p">;</span>
<span class="w">    </span><span class="err">long</span><span class="w"> </span><span class="err">optimizedVersion</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">0</span><span class="p">;</span>
<span class="w">    </span><span class="err">long</span><span class="w"> </span><span class="err">modifiedFastVersion</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">0</span><span class="p">;</span>
<span class="w">    </span><span class="err">long</span><span class="w"> </span><span class="err">modifiedSlowVersion</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">0</span><span class="p">;</span>

<span class="w">    </span><span class="err">for</span><span class="w"> </span><span class="err">(int</span><span class="w"> </span><span class="err">i</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">0</span><span class="p">;</span><span class="w"> </span><span class="err">i</span><span class="w"> </span><span class="err">&lt;</span><span class="w"> </span><span class="err">10</span><span class="p">;</span><span class="w"> </span><span class="err">i++)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="err">fastVersion</span><span class="w"> </span><span class="err">+=</span><span class="w"> </span><span class="err">fastVersion()</span><span class="p">;</span>
<span class="w">        </span><span class="err">slowVersion</span><span class="w"> </span><span class="err">+=</span><span class="w"> </span><span class="err">slowVersion()</span><span class="p">;</span>
<span class="w">        </span><span class="err">optimizedVersion</span><span class="w"> </span><span class="err">+=</span><span class="w"> </span><span class="err">optimizedVersion()</span><span class="p">;</span>
<span class="w">        </span><span class="err">modifiedFastVersion</span><span class="w"> </span><span class="err">+=</span><span class="w"> </span><span class="err">modifiedFastVersion()</span><span class="p">;</span>
<span class="w">        </span><span class="err">modifiedSlowVersion</span><span class="w"> </span><span class="err">+=</span><span class="w"> </span><span class="err">modifiedSlowVersion()</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nt">System</span><span class="p">.</span><span class="nc">out</span><span class="p">.</span><span class="nc">println</span><span class="o">(</span><span class="s2">"Fast version: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="o">(</span><span class="nt">double</span><span class="o">)</span><span class="w"> </span><span class="nt">fastVersion</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nt">1000000000</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">" s"</span><span class="o">);</span>
<span class="w">    </span><span class="nt">System</span><span class="p">.</span><span class="nc">out</span><span class="p">.</span><span class="nc">println</span><span class="o">(</span><span class="s2">"Slow version: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="o">(</span><span class="nt">double</span><span class="o">)</span><span class="w"> </span><span class="nt">slowVersion</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nt">1000000000</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">" s"</span><span class="o">);</span>
<span class="w">    </span><span class="nt">System</span><span class="p">.</span><span class="nc">out</span><span class="p">.</span><span class="nc">println</span><span class="o">(</span><span class="s2">"Optimized version: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="o">(</span><span class="nt">double</span><span class="o">)</span><span class="w"> </span><span class="nt">optimizedVersion</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nt">1000000000</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">" s"</span><span class="o">);</span>
<span class="w">    </span><span class="nt">System</span><span class="p">.</span><span class="nc">out</span><span class="p">.</span><span class="nc">println</span><span class="o">(</span><span class="s2">"Modified fast version: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="o">(</span><span class="nt">double</span><span class="o">)</span><span class="w"> </span><span class="nt">modifiedFastVersion</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nt">1000000000</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">" s"</span><span class="o">);</span>
<span class="w">    </span><span class="nt">System</span><span class="p">.</span><span class="nc">out</span><span class="p">.</span><span class="nc">println</span><span class="o">(</span><span class="s2">"Modified slow version: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="o">(</span><span class="nt">double</span><span class="o">)</span><span class="w"> </span><span class="nt">modifiedSlowVersion</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nt">1000000000</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">" s"</span><span class="o">);</span>
<span class="err">}</span>

<span class="nt">private</span><span class="w"> </span><span class="nt">static</span><span class="w"> </span><span class="nt">long</span><span class="w"> </span><span class="nt">fastVersion</span><span class="o">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="err">long</span><span class="w"> </span><span class="err">startTime</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">System.nanoTime()</span><span class="p">;</span>
<span class="w">    </span><span class="err">int</span><span class="w"> </span><span class="err">n</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">0</span><span class="p">;</span>
<span class="w">    </span><span class="err">for</span><span class="w"> </span><span class="err">(int</span><span class="w"> </span><span class="err">i</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">0</span><span class="p">;</span><span class="w"> </span><span class="err">i</span><span class="w"> </span><span class="err">&lt;</span><span class="w"> </span><span class="err">1000000000</span><span class="p">;</span><span class="w"> </span><span class="err">i++)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="err">n</span><span class="w"> </span><span class="err">+=</span><span class="w"> </span><span class="err">2</span><span class="w"> </span><span class="err">*</span><span class="w"> </span><span class="err">(i</span><span class="w"> </span><span class="err">*</span><span class="w"> </span><span class="err">i)</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nt">return</span><span class="w"> </span><span class="nt">System</span><span class="p">.</span><span class="nc">nanoTime</span><span class="o">()</span><span class="w"> </span><span class="nt">-</span><span class="w"> </span><span class="nt">startTime</span><span class="o">;</span>
<span class="err">}</span>

<span class="nt">private</span><span class="w"> </span><span class="nt">static</span><span class="w"> </span><span class="nt">long</span><span class="w"> </span><span class="nt">slowVersion</span><span class="o">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="err">long</span><span class="w"> </span><span class="err">startTime</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">System.nanoTime()</span><span class="p">;</span>
<span class="w">    </span><span class="err">int</span><span class="w"> </span><span class="err">n</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">0</span><span class="p">;</span>
<span class="w">    </span><span class="err">for</span><span class="w"> </span><span class="err">(int</span><span class="w"> </span><span class="err">i</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">0</span><span class="p">;</span><span class="w"> </span><span class="err">i</span><span class="w"> </span><span class="err">&lt;</span><span class="w"> </span><span class="err">1000000000</span><span class="p">;</span><span class="w"> </span><span class="err">i++)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="err">n</span><span class="w"> </span><span class="err">+=</span><span class="w"> </span><span class="err">2</span><span class="w"> </span><span class="err">*</span><span class="w"> </span><span class="err">i</span><span class="w"> </span><span class="err">*</span><span class="w"> </span><span class="err">i</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nt">return</span><span class="w"> </span><span class="nt">System</span><span class="p">.</span><span class="nc">nanoTime</span><span class="o">()</span><span class="w"> </span><span class="nt">-</span><span class="w"> </span><span class="nt">startTime</span><span class="o">;</span>
<span class="err">}</span>

<span class="nt">private</span><span class="w"> </span><span class="nt">static</span><span class="w"> </span><span class="nt">long</span><span class="w"> </span><span class="nt">optimizedVersion</span><span class="o">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="err">long</span><span class="w"> </span><span class="err">startTime</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">System.nanoTime()</span><span class="p">;</span>
<span class="w">    </span><span class="err">int</span><span class="w"> </span><span class="err">n</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">0</span><span class="p">;</span>
<span class="w">    </span><span class="err">for</span><span class="w"> </span><span class="err">(int</span><span class="w"> </span><span class="err">i</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">0</span><span class="p">;</span><span class="w"> </span><span class="err">i</span><span class="w"> </span><span class="err">&lt;</span><span class="w"> </span><span class="err">1000000000</span><span class="p">;</span><span class="w"> </span><span class="err">i++)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="err">n</span><span class="w"> </span><span class="err">+=</span><span class="w"> </span><span class="err">i</span><span class="w"> </span><span class="err">*</span><span class="w"> </span><span class="err">i</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nt">n</span><span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="nt">2</span><span class="o">;</span>
<span class="w">    </span><span class="nt">return</span><span class="w"> </span><span class="nt">System</span><span class="p">.</span><span class="nc">nanoTime</span><span class="o">()</span><span class="w"> </span><span class="nt">-</span><span class="w"> </span><span class="nt">startTime</span><span class="o">;</span>
<span class="err">}</span>

<span class="nt">private</span><span class="w"> </span><span class="nt">static</span><span class="w"> </span><span class="nt">long</span><span class="w"> </span><span class="nt">modifiedFastVersion</span><span class="o">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="err">long</span><span class="w"> </span><span class="err">startTime</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">System.nanoTime()</span><span class="p">;</span>
<span class="w">    </span><span class="err">int</span><span class="w"> </span><span class="err">n</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">0</span><span class="p">;</span>
<span class="w">    </span><span class="err">for</span><span class="w"> </span><span class="err">(int</span><span class="w"> </span><span class="err">i</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">0</span><span class="p">;</span><span class="w"> </span><span class="err">i</span><span class="w"> </span><span class="err">&lt;</span><span class="w"> </span><span class="err">1000000000</span><span class="p">;</span><span class="w"> </span><span class="err">i++)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="err">if</span><span class="w"> </span><span class="err">(n</span><span class="w"> </span><span class="err">==</span><span class="w"> </span><span class="err">0)</span><span class="w"> </span><span class="err">n</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">1</span><span class="p">;</span>
<span class="w">        </span><span class="err">n</span><span class="w"> </span><span class="err">+=</span><span class="w"> </span><span class="err">2</span><span class="w"> </span><span class="err">*</span><span class="w"> </span><span class="err">(i</span><span class="w"> </span><span class="err">*</span><span class="w"> </span><span class="err">i)</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nt">return</span><span class="w"> </span><span class="nt">System</span><span class="p">.</span><span class="nc">nanoTime</span><span class="o">()</span><span class="w"> </span><span class="nt">-</span><span class="w"> </span><span class="nt">startTime</span><span class="o">;</span>
<span class="err">}</span>

<span class="nt">private</span><span class="w"> </span><span class="nt">static</span><span class="w"> </span><span class="nt">long</span><span class="w"> </span><span class="nt">modifiedSlowVersion</span><span class="o">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="err">long</span><span class="w"> </span><span class="err">startTime</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">System.nanoTime()</span><span class="p">;</span>
<span class="w">    </span><span class="err">int</span><span class="w"> </span><span class="err">n</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">0</span><span class="p">;</span>
<span class="w">    </span><span class="err">for</span><span class="w"> </span><span class="err">(int</span><span class="w"> </span><span class="err">i</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">0</span><span class="p">;</span><span class="w"> </span><span class="err">i</span><span class="w"> </span><span class="err">&lt;</span><span class="w"> </span><span class="err">1000000000</span><span class="p">;</span><span class="w"> </span><span class="err">i++)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="err">if</span><span class="w"> </span><span class="err">(n</span><span class="w"> </span><span class="err">==</span><span class="w"> </span><span class="err">0)</span><span class="w"> </span><span class="err">n</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">1</span><span class="p">;</span>
<span class="w">        </span><span class="err">n</span><span class="w"> </span><span class="err">+=</span><span class="w"> </span><span class="err">2</span><span class="w"> </span><span class="err">*</span><span class="w"> </span><span class="err">i</span><span class="w"> </span><span class="err">*</span><span class="w"> </span><span class="err">i</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nt">return</span><span class="w"> </span><span class="nt">System</span><span class="p">.</span><span class="nc">nanoTime</span><span class="o">()</span><span class="w"> </span><span class="nt">-</span><span class="w"> </span><span class="nt">startTime</span><span class="o">;</span>
<span class="err">}</span>
</pre></div>

<p>And here are the results:</p>
<div class="code"><pre class="code literal-block">Fast version: 5.7274411 s
Slow version: 7.6190804 s
Optimized version: 5.1348007 s
Modified fast version: 7.1492705 s
Modified slow version: 7.2952668 s
</pre></div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-564.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-562.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
