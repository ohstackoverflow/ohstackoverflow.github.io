<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 2450) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-2450.html">
<link rel="prev" href="index-2451.html" type="text/html">
<link rel="next" href="index-2449.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-specify-nullable-return-type-with-type-hints/" class="u-url">How to specify "nullable" return type with type hints</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-specify-nullable-return-type-with-type-hints/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T17:03:29+08:00" itemprop="datePublished" title="2023-03-04 17:03">2023-03-04 17:03</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Suppose I have a function:</p>
<div class="code"><pre class="code literal-block"><span class="n">def</span><span class="w"> </span><span class="n">get_some_date</span><span class="p">(</span><span class="n">some_argument</span><span class="o">:</span><span class="w"> </span><span class="n">int</span><span class="o">=</span><span class="n">None</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">%</span><span class="n">datetime_or_None</span><span class="o">%:</span>
<span class="w">    </span><span class="nf">if</span><span class="w"> </span><span class="n">some_argument</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="kr">not</span><span class="w"> </span><span class="n">None</span><span class="w"> </span><span class="kr">and</span><span class="w"> </span><span class="n">some_argument</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span>
<span class="w">        </span><span class="kr">return</span><span class="w"> </span><span class="n">datetime</span><span class="p">.</span><span class="n">utcnow</span><span class="p">()</span>
<span class="w">    </span><span class="n">else</span><span class="o">:</span>
<span class="w">        </span><span class="kr">return</span><span class="w"> </span><span class="n">None</span>
</pre></div>

<p>How do I specify the return type for something that can be <code>None</code>?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>You're looking for <code>Optional</code>.</p>
<p>Since your return type can either be <code>datetime</code> (as returned from
<code>datetime.utcnow()</code>) or <code>None</code> you should use <code>Optional[datetime]</code>:</p>
<div class="code"><pre class="code literal-block"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>

<span class="k">def</span> <span class="nf">get_some_date</span><span class="p">(</span><span class="n">some_argument</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]:</span>
    <span class="c1"># as defined</span>
</pre></div>

<p>From the documentation on typing, <code>Optional</code> is shorthand for:</p>
<blockquote>
<p><code>Optional[X]</code> is equivalent to <code>Union[X, None]</code>.</p>
</blockquote>
<p>where <code>Union[X, Y]</code> means a value of type <code>X</code> or <code>Y</code>.</p>
<hr>
<p>If you want to be explicit due to concerns that others might stumble on
<code>Optional</code> and not realize it's meaning, you could always use <code>Union</code>:</p>
<div class="code"><pre class="code literal-block"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Union</span>

<span class="k">def</span> <span class="nf">get_some_date</span><span class="p">(</span><span class="n">some_argument</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
</pre></div>

<p>But I doubt this is a good idea, <code>Optional</code> is an indicative name and it does
save a couple of keystrokes.</p>
<p>As pointed out in the comments by @Michael0x2a <code>Union[T, None]</code> is tranformed
to <code>Union[T, type(None)]</code> so no need to use <code>type</code> here.</p>
<p>Visually these might differ but programatically, in both cases, the result is
<em>exactly the same</em> ; <code>Union[datetime.datetime, NoneType]</code> will be the type
stored in <code>get_some_date.__annotations__</code>*:</p>
<div class="code"><pre class="code literal-block"><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">get_type_hints</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">get_type_hints</span><span class="p">(</span><span class="n">get_some_date</span><span class="p">))</span>
<span class="p">{</span><span class="s1">'return'</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">],</span>
 <span class="s1">'some_argument'</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]}</span>
</pre></div>

<p>*Use <code>typing.get_type_hints</code> to grab the objects' <code>__annotations__</code> attribute instead of accessing it directly.</p>
<p><br></p>
<h3>Suggest</h3>
<p>You could just use the vertical line <code>datetime | None</code> (similar to OR
operator):</p>
<div class="code"><pre class="code literal-block"><span class="n">def</span><span class="w"> </span><span class="n">get_some_date</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">datetime</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">None</span><span class="o">:</span>
<span class="w">   </span><span class="err">#</span><span class="w"> </span><span class="n">rest</span><span class="w"> </span><span class="kr">of</span><span class="w"> </span><span class="n">code</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/spa-best-practices-for-authentication-and-session-management/" class="u-url">SPA best practices for authentication and session management</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/spa-best-practices-for-authentication-and-session-management/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T17:02:07+08:00" itemprop="datePublished" title="2023-03-04 17:02">2023-03-04 17:02</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>When building SPA style applications using frameworks like Angular, Ember,
React, etc. what do people believe to be some best practices for
authentication and session management? I can think of a couple of ways of
considering approaching the problem.</p>
<ol>
<li>Treat it no differently than authentication with a regular web application assuming the API and and UI have the same origin domain.</li>
</ol>
<p>This would likely involve having a session cookie, server side session storage
and probably some session API endpoint that the authenticated web UI can hit
to get current user information to help with personalization or possibly even
determining roles/abilities on the client side. The server would still enforce
rules protecting access to data of course, the UI would just use this
information to customize the experience.</p>
<ol>
<li>Treat it like any third-party client using a public API and authenticate with some sort of token system similar to OAuth. This token mechanism would used by the client UI to authenticate each and every request made to the server API.</li>
</ol>
<p>I'm not really much of an expert here but #1 seems to be completely sufficient
for the vast majority of cases, but I'd really like to hear some more
experienced opinions.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>This question has been addressed, in a slightly different form, at length,
here:</p>
<p>RESTful Authentication</p>
<p>But this addresses it from the server-side. Let's look at this from the
client-side. Before we do that, though, there's an important prelude:</p>
<h3>Javascript Crypto is Hopeless</h3>
<p>Matasano's article on this is famous, but the lessons contained therein are
pretty important:</p>
<p>https://www.nccgroup.trust/us/about-us/newsroom-and-
events/blog/2011/august/javascript-cryptography-considered-harmful/</p>
<p>To summarize:</p>
<ul>
<li>A man-in-the-middle attack can trivially replace your crypto code with <code>&lt;script&gt; function hash_algorithm(password){ lol_nope_send_it_to_me_instead(password); }&lt;/script&gt;</code>
</li>
<li>A man-in-the-middle attack is trivial against a page that serves any resource over a non-SSL connection.</li>
<li>Once you have SSL, you're using real crypto anyways.</li>
</ul>
<p>And to add a corollary of my own:</p>
<ul>
<li>A successful XSS attack can result in an attacker executing code on your client's browser, even if you're using SSL - so even if you've got every hatch battened down, your browser crypto can still fail if your attacker finds a way to execute any javascript code on someone else's browser.</li>
</ul>
<p>This renders a lot of RESTful authentication schemes impossible or silly if
you're intending to use a JavaScript client. Let's look!</p>
<h3>HTTP Basic Auth</h3>
<p>First and foremost, HTTP Basic Auth. The simplest of schemes: simply pass a
name and password with every request.</p>
<p>This, of course, absolutely requires SSL, because you're passing a Base64
(reversibly) encoded name and password with every request. Anybody listening
on the line could extract username and password trivially. Most of the "Basic
Auth is insecure" arguments come from a place of "Basic Auth over HTTP" which
is an awful idea.</p>
<p>The browser provides baked-in HTTP Basic Auth support, but it is ugly as sin
and you probably shouldn't use it for your app. The alternative, though, is to
stash username and password in JavaScript.</p>
<p>This is the most RESTful solution. The server requires no knowledge of state
whatsoever and authenticates every individual interaction with the user. Some
REST enthusiasts (mostly strawmen) insist that maintaining any sort of state
is heresy and will froth at the mouth if you think of any other authentication
method. There are theoretical benefits to this sort of standards-compliance -
it's supported by Apache out of the box - you could store your objects as
files in folders protected by .htaccess files if your heart desired!</p>
<p>The <strong>problem</strong>? You are caching on the client-side a username and password.
This gives evil.ru a better crack at it - even the most basic of XSS
vulnerabilities could result in the client beaming his username and password
to an evil server. You could try to alleviate this risk by hashing and salting
the password, but remember: <strong>JavaScript Crypto is Hopeless</strong>. You could
alleviate this risk by leaving it up to the Browser's Basic Auth support,
but.. ugly as sin, as mentioned earlier.</p>
<h3>HTTP Digest Auth</h3>
<p>Is Digest authentication possible with jQuery?</p>
<p>A more "secure" auth, this is a request/response hash challenge. Except
<strong>JavaScript Crypto is Hopeless</strong> , so it only works over SSL and you still
have to cache the username and password on the client side, making it more
complicated than HTTP Basic Auth but <em>no more secure</em>.</p>
<h3>Query Authentication with Additional Signature Parameters.</h3>
<p>Another more "secure" auth, where you encrypt your parameters with nonce and
timing data (to protect against repeat and timing attacks) and send the. One
of the best examples of this is the OAuth 1.0 protocol, which is, as far as I
know, a pretty stonking way to implement authentication on a REST server.</p>
<p>https://www.rfc-editor.org/rfc/rfc5849</p>
<p>Oh, but there aren't any OAuth 1.0 clients for JavaScript. Why?</p>
<p><strong>JavaScript Crypto is Hopeless</strong> , remember. JavaScript can't participate in
OAuth 1.0 without SSL, and you still have to store the client's username and
password locally - which puts this in the same category as Digest Auth - it's
more complicated than HTTP Basic Auth but it's <em>no more secure</em>.</p>
<h3>Token</h3>
<p>The user sends a username and password, and in exchange gets a token that can
be used to authenticate requests.</p>
<p>This is marginally more secure than HTTP Basic Auth, because as soon as the
username/password transaction is complete you can discard the sensitive data.
It's also less RESTful, as tokens constitute "state" and make the server
implementation more complicated.</p>
<h4>SSL Still</h4>
<p>The rub though, is that you still have to send that initial username and
password to get a token. Sensitive information still touches your
compromisable JavaScript.</p>
<p>To protect your user's credentials, you still need to keep attackers out of
your JavaScript, and you still need to send a username and password over the
wire. SSL Required.</p>
<h4>Token Expiry</h4>
<p>It's common to enforce token policies like "hey, when this token has been
around too long, discard it and make the user authenticate again." or "I'm
pretty sure that the only IP address allowed to use this token is
<code>XXX.XXX.XXX.XXX</code>". Many of these policies are pretty good ideas.</p>
<h4>Firesheeping</h4>
<p>However, using a token Without SSL is still vulnerable to an attack called
'sidejacking': http://codebutler.github.io/firesheep/</p>
<p>The attacker doesn't get your user's credentials, but they can still pretend
to be your user, which can be pretty bad.</p>
<p>tl;dr: Sending unencrypted tokens over the wire means that attackers can
easily nab those tokens and pretend to be your user. FireSheep is a program
that makes this very easy.</p>
<h4>A Separate, More Secure Zone</h4>
<p>The larger the application that you're running, the harder it is to absolutely
ensure that they won't be able to inject some code that changes how you
process sensitive data. Do you absolutely trust your CDN? Your advertisers?
Your own code base?</p>
<p>Common for credit card details and less common for username and password -
some implementers keep 'sensitive data entry' on a separate page from the rest
of their application, a page that can be tightly controlled and locked down as
best as possible, preferably one that is difficult to phish users with.</p>
<h3>Cookie (just means Token)</h3>
<p>It is possible (and common) to put the authentication token in a cookie. This
doesn't change any of the properties of auth with the token, it's more of a
convenience thing. All of the previous arguments still apply.</p>
<h3>Session (still just means Token)</h3>
<p>Session Auth is just Token authentication, but with a few differences that
make it seem like a slightly different thing:</p>
<ul>
<li>Users start with an unauthenticated token.</li>
<li>The backend maintains a 'state' object that is tied to a user's token.</li>
<li>The token is provided in a cookie.</li>
<li>The application environment abstracts the details away from you.</li>
</ul>
<p>Aside from that, though, it's no different from Token Auth, really.</p>
<p>This wanders even further from a RESTful implementation - with state objects
you're going further and further down the path of plain ol' RPC on a stateful
server.</p>
<h3>OAuth 2.0</h3>
<p>OAuth 2.0 looks at the problem of "How does Software A give Software B access
to User X's data without Software B having access to User X's login
credentials."</p>
<p>The implementation is very much just a standard way for a user to get a token,
and then for a third party service to go "yep, this user and this token match,
and you can get some of their data from us now."</p>
<p>Fundamentally, though, OAuth 2.0 is just a token protocol. It exhibits the
same properties as other token protocols - you still need SSL to protect those
tokens - it just changes up how those tokens are generated.</p>
<p>There are two ways that OAuth 2.0 can help you:</p>
<ul>
<li>Providing Authentication/Information to Others</li>
<li>Getting Authentication/Information from Others</li>
</ul>
<p>But when it comes down to it, you're just... using tokens.</p>
<h3>Back to your question</h3>
<p>So, the question that you're asking is "should I store my token in a cookie
and have my environment's automatic session management take care of the
details, or should I store my token in Javascript and handle those details
myself?"</p>
<p>And the answer is: <em>do whatever makes you happy</em>.</p>
<p>The thing about automatic session management, though, is that there's a lot of
magic happening behind the scenes for you. Often it's nicer to be in control
of those details yourself.</p>
<h3>I am 21 so SSL is yes</h3>
<p>The other answer is: Use https for everything or brigands will steal your
users' passwords and tokens.</p>
<p><br></p>
<h3>Suggest</h3>
<p>You can increase security in authentication process by using JWT <em>(JSON Web
Tokens)</em> and SSL/HTTPS.</p>
<p>The Basic Auth / Session ID can be stolen via:</p>
<ul>
<li>MITM attack (Man-In-The-Middle) - <em>without SSL/HTTPS</em>
</li>
<li>An intruder gaining access to a user's computer</li>
<li>XSS</li>
</ul>
<p>By using JWT you're encrypting the user's authentication details and storing
in the client, and sending it along with every request to the API, where the
server/API validates the token. <del>It can't be decrypted/read without the
private key (which the server/API stores secretly)</del> <strong>Read update</strong>.</p>
<p><strong>The new (more secure) flow would be:</strong></p>
<h4>Login</h4>
<ul>
<li>User logs in and sends login credentials to API <em>(over SSL/HTTPS)</em>
</li>
<li>API receives login credentials</li>
<li>If valid:</li>
<li>Register a new session in the database <strong>Read update</strong>
</li>
<li>Encrypt User ID, Session ID, IP address, timestamp, etc. in a JWT with a private key.</li>
<li>API sends the JWT token back to the client <em>(over SSL/HTTPS)</em>
</li>
<li>Client receives the JWT token and stores in localStorage/cookie</li>
</ul>
<h4>Every request to API</h4>
<ul>
<li>User sends a HTTP request to API <em>(over SSL/HTTPS)</em> with the stored JWT token in the HTTP header</li>
<li>API reads HTTP header and decrypts JWT token with its private key</li>
<li>API validates the JWT token, matches the IP address from the HTTP request with the one in the JWT token and checks if session has expired</li>
<li>If valid:</li>
<li>Return response with requested content</li>
<li>If invalid:</li>
<li>Throw exception (403 / 401)</li>
<li>Flag intrusion in the system</li>
<li>Send a warning email to the user.</li>
</ul>
<p><strong>Updated 30.07.15:</strong></p>
<p>JWT payload/claims can actually be read without the private key (secret) and
it's not secure to store it in localStorage. I'm sorry about these false
statements. However they seem to be working on a JWE standard <em>(JSON Web
Encryption)</em>.</p>
<p>I implemented this by storing claims (userID, exp) in a JWT, signed it with a
private key (secret) the API/backend only knows about and stored it as a
secure HttpOnly cookie on the client. That way it cannot be read via XSS and
cannot be manipulated, otherwise the JWT fails signature verification. Also by
using a <em>secure HttpOnly</em> cookie, you're making sure that the cookie is sent
only via HTTP requests (not accessible to script) and only sent via secure
connection (HTTPS).</p>
<p><strong>Updated 17.07.16:</strong></p>
<p>JWTs are by nature stateless. That means they invalidate/expire themselves. By
adding the SessionID in the token's claims you're making it stateful, because
its validity doesn't now only depend on signature verification and expiry
date, it also depends on the session state on the server. However the upside
is you can invalidate tokens/sessions easily, which you couldn't before with
stateless JWTs.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/what-is-the-difference-between-var-and-val-in-kotlin/" class="u-url">What is the difference between var and val in Kotlin?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/what-is-the-difference-between-var-and-val-in-kotlin/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T17:00:41+08:00" itemprop="datePublished" title="2023-03-04 17:00">2023-03-04 17:00</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>What is the difference between <code>var</code> and <code>val</code> in Kotlin?</p>
<p>I have gone through this link:</p>
<p>KotlinLang: Properties and Fields</p>
<p>As stated on this link:</p>
<blockquote>
<p>The full syntax of a read-only property declaration differs from a mutable
one in two ways: it starts with val instead of var and does not allow a
setter.</p>
</blockquote>
<p>But just before there is an example which uses a setter.</p>
<div class="code"><pre class="code literal-block"><span class="nv">fun</span><span class="w"> </span><span class="nv">copyAddress</span><span class="ss">(</span><span class="nv">address</span>:<span class="w"> </span><span class="nv">Address</span><span class="ss">)</span>:<span class="w"> </span><span class="nv">Address</span><span class="w"> </span>{
<span class="w">    </span><span class="nv">val</span><span class="w"> </span><span class="nb">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">Address</span><span class="ss">()</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nv">there</span><span class="s1">'s no '</span><span class="nv">new</span><span class="err">' keyword in Kotlin</span>
<span class="err">    result.name = address.name // accessors are called</span>
<span class="err">    result.street = address.street</span>
<span class="err">    // ...</span>
<span class="err">    return result</span>
<span class="err">}</span>
</pre></div>

<p>What is the exact difference between <code>var</code> and <code>val</code>?</p>
<p>Why do we need both?</p>
<p>This is <strong>not a duplicate</strong> of Variables in Kotlin, differences with Java:
'var' vs. 'val'? as I am asking about the doubt related to the particular
example in the documentation and not just in general.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>In your code <code>result</code> is not changing, its <code>var</code> properties are changing.
Refer comments below:</p>
<div class="code"><pre class="code literal-block"><span class="nv">fun</span><span class="w"> </span><span class="nv">copyAddress</span><span class="ss">(</span><span class="nv">address</span>:<span class="w"> </span><span class="nv">Address</span><span class="ss">)</span>:<span class="w"> </span><span class="nv">Address</span><span class="w"> </span>{
<span class="w">    </span><span class="nv">val</span><span class="w"> </span><span class="nb">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">Address</span><span class="ss">()</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">result</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">read</span><span class="w"> </span><span class="nv">only</span>
<span class="w">    </span><span class="nb">result</span>.<span class="nv">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">address</span>.<span class="nv">name</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nv">but</span><span class="w"> </span><span class="nv">not</span><span class="w"> </span><span class="nv">their</span><span class="w"> </span><span class="nv">properties</span>.
<span class="w">    </span><span class="nb">result</span>.<span class="nv">street</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">address</span>.<span class="nv">street</span>
<span class="w">    </span><span class="o">//</span><span class="w"> </span>...
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nb">result</span>
}
</pre></div>

<p><code>val</code> is same as the <code>final</code> modifier in java. As you should probably know
that we can not assign to a <code>final</code> variable again but can change its
properties.</p>
<p><br></p>
<h3>Suggest</h3>
<p><code>val</code> and <code>var</code> both are used to declare a variable.</p>
<blockquote>
<p><strong>var</strong> is like <strong>general</strong> variable and it's known as a mutable variable in
<strong>kotlin</strong> and can be assigned multiple times.</p>
<p><strong>val</strong> is like <strong>Final</strong> variable and it's known as immutable in <strong>kotlin</strong>
and can be initialized only single time.</p>
</blockquote>
<p>For more information what is <code>val</code> and <code>var</code> please see below link</p>
<blockquote>
<p>http://blog.danlew.net/2017/05/30/mutable-vals-in-kotlin/</p>
</blockquote>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-2451.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-2449.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
