<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 699) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-699.html">
<link rel="prev" href="index-700.html" type="text/html">
<link rel="next" href="index-698.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-can-i-temporarily-disable-a-foreign-key-constraint-in-mysql/" class="u-url">How can I temporarily disable a foreign key constraint in MySQL?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-can-i-temporarily-disable-a-foreign-key-constraint-in-mysql/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T13:37:37+08:00" itemprop="datePublished" title="2023-02-17 13:37">2023-02-17 13:37</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Is it possible to temporarily disable constraints in MySQL?</p>
<p>I have two Django models, each with a foreign key to the other one. Deleting
instances of a model returns an error because of the foreign key constraint:</p>
<div class="code"><pre class="code literal-block"><span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">"DELETE FROM myapp_item WHERE n = </span><span class="si">%s</span><span class="s2">"</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">)</span>
<span class="n">transaction</span><span class="o">.</span><span class="n">commit_unless_managed</span><span class="p">()</span><span class="w">  </span><span class="c1">#a foreign key constraint fails here</span>

<span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">"DELETE FROM myapp_style WHERE n = </span><span class="si">%s</span><span class="s2">"</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">)</span>
<span class="n">transaction</span><span class="o">.</span><span class="n">commit_unless_managed</span><span class="p">()</span>
</pre></div>

<p>Is it possible to temporarily disable constraints and delete anyway?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Try <code>DISABLE KEYS</code> or</p>
<div class="code"><pre class="code literal-block">SET FOREIGN_KEY_CHECKS=0;
</pre></div>

<p>Make sure to</p>
<div class="code"><pre class="code literal-block">SET FOREIGN_KEY_CHECKS=1;
</pre></div>

<p>after.</p>
<p><br></p>
<h3>Suggest</h3>
<p>To turn off foreign key constraint globally, do the following:</p>
<div class="code"><pre class="code literal-block">SET GLOBAL FOREIGN_KEY_CHECKS=0;
</pre></div>

<p>and remember to set it back when you are done</p>
<div class="code"><pre class="code literal-block">SET GLOBAL FOREIGN_KEY_CHECKS=1;
</pre></div>

<p>WARNING: You should only do this when you are doing single user mode
maintenance. As it might resulted in data inconsistency. For example, it will
be very helpful when you are uploading large amount of data using a mysqldump
output.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/why-is-faster-than-list/" class="u-url">Why is [] faster than list()?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/why-is-faster-than-list/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T13:36:55+08:00" itemprop="datePublished" title="2023-02-17 13:36">2023-02-17 13:36</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I recently compared the processing speeds of <code>[]</code> and <code>list()</code> and was
surprised to discover that <code>[]</code> runs <em>more than three times faster</em> than
<code>list()</code>. I ran the same test with <code>{}</code> and <code>dict()</code> and the results were
practically identical: <code>[]</code> and <code>{}</code> both took around 0.128sec / million
cycles, while <code>list()</code> and <code>dict()</code> took roughly 0.428sec / million cycles
each.</p>
<p>Why is this? Do <code>[]</code> and <code>{}</code> (and probably <code>()</code> and <code>''</code>, too) immediately
pass back a copies of some empty stock literal while their explicitly-named
counterparts (<code>list()</code>, <code>dict()</code>, <code>tuple()</code>, <code>str()</code>) fully go about creating
an object, whether or not they actually have elements?</p>
<p>I have no idea how these two methods differ but I'd love to find out. I
couldn't find an answer in the docs or on SO, and searching for empty brackets
turned out to be more problematic than I'd expected.</p>
<p>I got my timing results by calling <code>timeit.timeit("[]")</code> and
<code>timeit.timeit("list()")</code>, and <code>timeit.timeit("{}")</code> and
<code>timeit.timeit("dict()")</code>, to compare lists and dictionaries, respectively.
I'm running Python 2.7.9.</p>
<p>I recently discovered "Why is if True slower than if 1?" that compares the
performance of <code>if True</code> to <code>if 1</code> and seems to touch on a similar literal-
versus-global scenario; perhaps it's worth considering as well.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Because <code>[]</code> and <code>{}</code> are <em>literal syntax</em>. Python can create bytecode just to
create the list or dictionary objects:</p>
<div class="code"><pre class="code literal-block"><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">dis</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dis</span><span class="o">.</span><span class="n">dis</span><span class="p">(</span><span class="nb">compile</span><span class="p">(</span><span class="s1">'[]'</span><span class="p">,</span> <span class="s1">''</span><span class="p">,</span> <span class="s1">'eval'</span><span class="p">))</span>
  <span class="mi">1</span>           <span class="mi">0</span> <span class="n">BUILD_LIST</span>               <span class="mi">0</span>
              <span class="mi">3</span> <span class="n">RETURN_VALUE</span>        
<span class="o">&gt;&gt;&gt;</span> <span class="n">dis</span><span class="o">.</span><span class="n">dis</span><span class="p">(</span><span class="nb">compile</span><span class="p">(</span><span class="s1">'</span><span class="si">{}</span><span class="s1">'</span><span class="p">,</span> <span class="s1">''</span><span class="p">,</span> <span class="s1">'eval'</span><span class="p">))</span>
  <span class="mi">1</span>           <span class="mi">0</span> <span class="n">BUILD_MAP</span>                <span class="mi">0</span>
              <span class="mi">3</span> <span class="n">RETURN_VALUE</span>
</pre></div>

<p><code>list()</code> and <code>dict()</code> are separate objects. Their names need to be resolved,
the stack has to be involved to push the arguments, the frame has to be stored
to retrieve later, and a call has to be made. That all takes more time.</p>
<p>For the empty case, that means you have at the very least a <code>LOAD_NAME</code> (which
has to search through the global namespace as well as the <code>builtins</code> module)
followed by a <code>CALL_FUNCTION</code>, which has to preserve the current frame:</p>
<div class="code"><pre class="code literal-block">&gt;&gt;&gt; dis.dis(compile('list()', '', 'eval'))
  1           0 LOAD_NAME                0 (list)
              3 CALL_FUNCTION            0
              6 RETURN_VALUE        
&gt;&gt;&gt; dis.dis(compile('dict()', '', 'eval'))
  1           0 LOAD_NAME                0 (dict)
              3 CALL_FUNCTION            0
              6 RETURN_VALUE
</pre></div>

<p>You can time the name lookup separately with <code>timeit</code>:</p>
<div class="code"><pre class="code literal-block"><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">timeit</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">timeit</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="s1">'list'</span><span class="p">,</span> <span class="n">number</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">7</span><span class="p">)</span>
<span class="mf">0.30749011039733887</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">timeit</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="s1">'dict'</span><span class="p">,</span> <span class="n">number</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">7</span><span class="p">)</span>
<span class="mf">0.4215109348297119</span>
</pre></div>

<p>The time discrepancy there is probably a dictionary hash collision. Subtract
those times from the times for calling those objects, and compare the result
against the times for using literals:</p>
<div class="code"><pre class="code literal-block">&gt;&gt;&gt; timeit.timeit('[]', number=10**7)
0.30478692054748535
&gt;&gt;&gt; timeit.timeit('{}', number=10**7)
0.31482696533203125
&gt;&gt;&gt; timeit.timeit('list()', number=10**7)
0.9991960525512695
&gt;&gt;&gt; timeit.timeit('dict()', number=10**7)
1.0200958251953125
</pre></div>

<p>So having to call the object takes an additional <code>1.00 - 0.31 - 0.30 == 0.39</code>
seconds per 10 million calls.</p>
<p>You can avoid the global lookup cost by aliasing the global names as locals
(using a <code>timeit</code> setup, everything you bind to a name is a local):</p>
<div class="code"><pre class="code literal-block">&gt;&gt;&gt; timeit.timeit('_list', '_list = list', number=10**7)
0.1866450309753418
&gt;&gt;&gt; timeit.timeit('_dict', '_dict = dict', number=10**7)
0.19016098976135254
&gt;&gt;&gt; timeit.timeit('_list()', '_list = list', number=10**7)
0.841480016708374
&gt;&gt;&gt; timeit.timeit('_dict()', '_dict = dict', number=10**7)
0.7233691215515137
</pre></div>

<p>but you never can overcome that <code>CALL_FUNCTION</code> cost.</p>
<p><br></p>
<h3>Suggest</h3>
<p><code>list()</code> requires a global lookup and a function call but <code>[]</code> compiles to a
single instruction. See:</p>
<div class="code"><pre class="code literal-block"><span class="n">Python</span> <span class="mf">2.7.3</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">dis</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dis</span><span class="o">.</span><span class="n">dis</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="nb">list</span><span class="p">())</span>
  <span class="mi">1</span>           <span class="mi">0</span> <span class="n">LOAD_GLOBAL</span>              <span class="mi">0</span> <span class="p">(</span><span class="nb">list</span><span class="p">)</span>
              <span class="mi">3</span> <span class="n">CALL_FUNCTION</span>            <span class="mi">0</span>
              <span class="mi">6</span> <span class="n">RETURN_VALUE</span>        
<span class="o">&gt;&gt;&gt;</span> <span class="n">dis</span><span class="o">.</span><span class="n">dis</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="p">[])</span>
  <span class="mi">1</span>           <span class="mi">0</span> <span class="n">BUILD_LIST</span>               <span class="mi">0</span>
              <span class="mi">3</span> <span class="n">RETURN_VALUE</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/in-c-what-is-the-difference-between-public-private-protected-and-having-no-access-modifier/" class="u-url">In C#, what is the difference between public, private, protected, and having no access modifier?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/in-c-what-is-the-difference-between-public-private-protected-and-having-no-access-modifier/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T13:36:27+08:00" itemprop="datePublished" title="2023-02-17 13:36">2023-02-17 13:36</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>All my college years I have been using <code>public</code>, and would like to know the
difference between <code>public</code>, <code>private</code>, and <code>protected</code>?</p>
<p>Also what does <code>static</code> do as opposed to having nothing?</p>
<p><br><br></p>
<h2>Answer</h2>
<h3>Access modifiers</h3>
<p>From learn.microsoft.com:</p>
<blockquote>
<p><strong><code>public</code></strong></p>
<p>The type or member can be accessed by any other code in the same assembly or
another assembly that references it.</p>
<p><strong><code>private</code></strong></p>
<p>The type or member can only be accessed by code in the same class or struct.</p>
<p><strong><code>protected</code></strong></p>
<p>The type or member can only be accessed by code in the same class or struct,
or in a derived class.</p>
<p><strong><code>private protected</code></strong> (added in C# 7.2)</p>
<p>The type or member can only be accessed by code in the same class or struct,
or in a derived class from the same assembly, but not from another assembly.</p>
<p><strong><code>internal</code></strong></p>
<p>The type or member can be accessed by any code in the same assembly, but not
from another assembly.</p>
<p><strong><code>protected internal</code></strong></p>
<p>The type or member can be accessed by any code in the same assembly, or by
any derived class in another assembly.</p>
</blockquote>
<p>When <strong>no access modifier</strong> is set, a default access modifier is used. So
there is always some form of access modifier even if it's not set.</p>
<h3>
<code>static</code> modifier</h3>
<p>The static modifier on a class means that the class cannot be instantiated,
and that all of its members are static. A static member has one version
regardless of how many instances of its enclosing type are created.</p>
<p>A static class is basically the same as a non-static class, but there is one
difference: a static class cannot be externally instantiated. In other words,
you cannot use the new keyword to create a variable of the class type. Because
there is no instance variable, you access the members of a static class by
using the class name itself.</p>
<p>However, there is a such thing as a static constructor. Any class can have one
of these, including static classes. They cannot be called directly &amp; cannot
have parameters (other than any type parameters on the class itself). A static
constructor is called automatically to initialize the class before the first
instance is created or any static members are referenced. Looks like this:</p>
<div class="code"><pre class="code literal-block">static class Foo()
{
    static Foo()
    {
        Bar = "fubar";
    }

    public static string Bar { get; set; }
}
</pre></div>

<p>Static classes are often used as services, you can use them like so:</p>
<div class="code"><pre class="code literal-block">MyStaticClass.ServiceMethod(...);
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>A graphical overview (summary in a nutshell)</p>
<p><img alt="Visibility" src="images/ExkwO.png"></p>
<p>Actually, it's a little bit more complicated than that.<br>
Now (as of C# 7.2), there's also private protected, and it matters whether a
derived class is in the same assembly or not.</p>
<p>So the overview needs to be expanded:</p>
<p><img alt="Visibility expanded" src="images/TNtq3.png"></p>
<p>See also the C#-dotnet-docs on the subject.</p>
<p>Since static classes are sealed, they cannot be inherited (except from
Object), so the keyword protected is invalid on static classes.</p>
<p>For the defaults if you put no access modifier in front, see here:<br>
Default visibility for C# classes and members (fields, methods, etc.)?</p>
<p>Non-nested</p>
<div class="code"><pre class="code literal-block"><span class="k">enum</span><span class="w">                              </span><span class="n">public</span>
<span class="n">non</span><span class="o">-</span><span class="n">nested</span><span class="w"> </span><span class="n">classes</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">structs</span><span class="w">      </span><span class="n">internal</span>
<span class="n">interfaces</span><span class="w">                        </span><span class="n">internal</span>
<span class="n">delegates</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">namespace</span><span class="w">            </span><span class="n">internal</span>
<span class="k">class</span><span class="o">/</span><span class="n">struct</span><span class="w"> </span><span class="n">member</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="w">            </span><span class="n">private</span>
<span class="n">delegates</span><span class="w"> </span><span class="n">nested</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">class</span><span class="o">/</span><span class="n">struct</span><span class="w">  </span><span class="n">private</span>
</pre></div>

<p>Nested:</p>
<div class="code"><pre class="code literal-block"><span class="n">nested</span><span class="w"> </span><span class="k">enum</span><span class="w">      </span><span class="n">public</span>
<span class="n">nested</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="n">public</span>
<span class="n">nested</span><span class="w"> </span><span class="k">class</span><span class="w">     </span><span class="n">private</span>
<span class="n">nested</span><span class="w"> </span><span class="n">struct</span><span class="w">    </span><span class="n">private</span>
</pre></div>

<p>Also, there is the sealed-keyword, which makes a class not-inheritable.<br>
Also, in VB.NET, the keywords are sometimes different, so here a cheat-sheet:</p>
<p><img alt="VB vs. CS equivalents" src="images/o6BZf.png"></p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-700.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-698.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
