<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 2531) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-2531.html">
<link rel="prev" href="index-2532.html" type="text/html">
<link rel="next" href="index-2530.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/simulating-group-concat-mysql-function-in-microsoft-sql-server-2005/" class="u-url">Simulating group_concat MySQL function in Microsoft SQL Server 2005?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/simulating-group-concat-mysql-function-in-microsoft-sql-server-2005/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T23:00:43+08:00" itemprop="datePublished" title="2023-03-04 23:00">2023-03-04 23:00</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I'm trying to migrate a MySQL-based app over to Microsoft SQL Server 2005 (not
by choice, but that's life).</p>
<p>In the original app, we used <em>almost</em> entirely ANSI-SQL compliant statements,
with one significant exception -- we used MySQL's <code>group_concat</code> function
fairly frequently.</p>
<p><code>group_concat</code>, by the way, does this: given a table of, say, employee names
and projects...</p>
<div class="code"><pre class="code literal-block">SELECT empName, projID FROM project_members;
</pre></div>

<p>returns:</p>
<div class="code"><pre class="code literal-block">ANDY   |  A100
ANDY   |  B391
ANDY   |  X010
TOM    |  A100
TOM    |  A510
</pre></div>

<p>... and here's what you get with group_concat:</p>
<div class="code"><pre class="code literal-block">SELECT 
    empName, group_concat(projID SEPARATOR ' / ') 
FROM 
    project_members 
GROUP BY 
    empName;
</pre></div>

<p>returns:</p>
<div class="code"><pre class="code literal-block">ANDY   |  A100 / B391 / X010
TOM    |  A100 / A510
</pre></div>

<p>So what I'd like to know is: Is it possible to write, say, a user-defined
function in SQL Server which emulates the functionality of <code>group_concat</code>?</p>
<p>I have almost no experience using UDFs, stored procedures, or anything like
that, just straight-up SQL, so please err on the side of too much explanation
:)</p>
<p><br><br></p>
<h2>Answer</h2>
<p>No REAL easy way to do this. Lots of ideas out there, though.</p>
<p>Best one I've found:</p>
<div class="code"><pre class="code literal-block"><span class="nv">SELECT</span><span class="w"> </span><span class="nv">table_name</span>,<span class="w"> </span><span class="nv">LEFT</span><span class="ss">(</span><span class="nv">column_names</span><span class="w"> </span>,<span class="w"> </span><span class="nv">LEN</span><span class="ss">(</span><span class="nv">column_names</span><span class="w"> </span><span class="ss">)</span><span class="o">-</span><span class="mi">1</span><span class="ss">)</span><span class="w"> </span><span class="nv">AS</span><span class="w"> </span><span class="nv">column_names</span>
<span class="nv">FROM</span><span class="w"> </span><span class="nv">information_schema</span>.<span class="nv">columns</span><span class="w"> </span><span class="nv">AS</span><span class="w"> </span><span class="nv">extern</span>
<span class="nv">CROSS</span><span class="w"> </span><span class="nv">APPLY</span>
<span class="ss">(</span>
<span class="w">    </span><span class="nv">SELECT</span><span class="w"> </span><span class="nv">column_name</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">','</span>
<span class="w">    </span><span class="nv">FROM</span><span class="w"> </span><span class="nv">information_schema</span>.<span class="nv">columns</span><span class="w"> </span><span class="nv">AS</span><span class="w"> </span><span class="nv">intern</span>
<span class="w">    </span><span class="nv">WHERE</span><span class="w"> </span><span class="nv">extern</span>.<span class="nv">table_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">intern</span>.<span class="nv">table_name</span>
<span class="w">    </span><span class="k">FOR</span><span class="w"> </span><span class="nv">XML</span><span class="w"> </span><span class="nv">PATH</span><span class="ss">(</span><span class="s1">''</span><span class="ss">)</span>
<span class="ss">)</span><span class="w"> </span><span class="nv">pre_trimmed</span><span class="w"> </span><span class="ss">(</span><span class="nv">column_names</span><span class="ss">)</span>
<span class="nv">GROUP</span><span class="w"> </span><span class="nv">BY</span><span class="w"> </span><span class="nv">table_name</span>,<span class="w"> </span><span class="nv">column_names</span><span class="c1">;</span>
</pre></div>

<p>Or a version that works correctly if the data might contain characters such as
<code>&lt;</code></p>
<div class="code"><pre class="code literal-block"><span class="nv">WITH</span><span class="w"> </span><span class="nv">extern</span>
<span class="w">     </span><span class="nv">AS</span><span class="w"> </span><span class="ss">(</span><span class="nv">SELECT</span><span class="w"> </span><span class="nv">DISTINCT</span><span class="w"> </span><span class="nv">table_name</span>
<span class="w">         </span><span class="nv">FROM</span><span class="w">   </span><span class="nv">INFORMATION_SCHEMA</span>.<span class="nv">COLUMNS</span><span class="ss">)</span>
<span class="nv">SELECT</span><span class="w"> </span><span class="nv">table_name</span>,
<span class="w">       </span><span class="nv">LEFT</span><span class="ss">(</span><span class="nv">y</span>.<span class="nv">column_names</span>,<span class="w"> </span><span class="nv">LEN</span><span class="ss">(</span><span class="nv">y</span>.<span class="nv">column_names</span><span class="ss">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="ss">)</span><span class="w"> </span><span class="nv">AS</span><span class="w"> </span><span class="nv">column_names</span>
<span class="nv">FROM</span><span class="w">   </span><span class="nv">extern</span>
<span class="w">       </span><span class="nv">CROSS</span><span class="w"> </span><span class="nv">APPLY</span><span class="w"> </span><span class="ss">(</span><span class="nv">SELECT</span><span class="w"> </span><span class="nv">column_name</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">','</span>
<span class="w">                    </span><span class="nv">FROM</span><span class="w">   </span><span class="nv">INFORMATION_SCHEMA</span>.<span class="nv">COLUMNS</span><span class="w"> </span><span class="nv">AS</span><span class="w"> </span><span class="nv">intern</span>
<span class="w">                    </span><span class="nv">WHERE</span><span class="w">  </span><span class="nv">extern</span>.<span class="nv">table_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">intern</span>.<span class="nv">table_name</span>
<span class="w">                    </span><span class="k">FOR</span><span class="w"> </span><span class="nv">XML</span><span class="w"> </span><span class="nv">PATH</span><span class="ss">(</span><span class="s1">''</span><span class="ss">)</span>,<span class="w"> </span><span class="nv">TYPE</span><span class="ss">)</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="ss">(</span><span class="nv">column_names</span><span class="ss">)</span>
<span class="w">       </span><span class="nv">CROSS</span><span class="w"> </span><span class="nv">APPLY</span><span class="w"> </span><span class="ss">(</span><span class="nv">SELECT</span><span class="w"> </span><span class="nv">x</span>.<span class="nv">column_names</span>.<span class="nv">value</span><span class="ss">(</span><span class="s1">'.'</span>,<span class="w"> </span><span class="s1">'NVARCHAR(MAX)'</span><span class="ss">))</span><span class="w"> </span><span class="nv">y</span><span class="ss">(</span><span class="nv">column_names</span><span class="ss">)</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>I may be a bit late to the party but this method works for me and is easier
than the COALESCE method.</p>
<div class="code"><pre class="code literal-block"><span class="nv">SELECT</span><span class="w"> </span><span class="nv">STUFF</span><span class="ss">(</span>
<span class="w">             </span><span class="ss">(</span><span class="nv">SELECT</span><span class="w"> </span><span class="s1">','</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nv">Column_Name</span><span class="w"> </span>
<span class="w">              </span><span class="nv">FROM</span><span class="w"> </span><span class="nv">Table_Name</span>
<span class="w">              </span><span class="k">FOR</span><span class="w"> </span><span class="nv">XML</span><span class="w"> </span><span class="nv">PATH</span><span class="w"> </span><span class="ss">(</span><span class="s1">''</span><span class="ss">))</span>
<span class="w">             </span>,<span class="w"> </span><span class="mi">1</span>,<span class="w"> </span><span class="mi">1</span>,<span class="w"> </span><span class="s1">''</span><span class="ss">)</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/calendar-recurring-repeating-events-best-storage-method/" class="u-url">Calendar Recurring/Repeating Events - Best Storage Method</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/calendar-recurring-repeating-events-best-storage-method/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T22:58:54+08:00" itemprop="datePublished" title="2023-03-04 22:58">2023-03-04 22:58</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I am building a custom events system, and if you have a repeating event that
looks like this:</p>
<p>Event A repeats every 4 days starting on March 3, 2011</p>
<p>or</p>
<p>Event B repeats every 2 weeks on Tuesday starting on March 1, 2011</p>
<p>How can I store that in a Database in a way that would make it simple to
lookup. I don't want performance issues if there are a large number of events,
and I have to go through each and every one when rendering the calendar.</p>
<p><br><br></p>
<h2>Answer</h2>
<h3>Storing "Simple" Repeating Patterns</h3>
<p>For my PHP/MySQL based calendar, I wanted to store repeating/recurring event
information as efficiently as possibly. I didn't want to have a large number
of rows, and I wanted to easily lookup all events that would take place on a
specific date.</p>
<p>The method below is great at storing repeating information that occurs at
regular intervals, such as every day, every <em>n</em> days, every week, every month
every year, etc etc. This includes every Tuesday and Thursday type patterns as
well, because they are stored separately as every week starting on a Tuesday
and every week starting on a Thursday.</p>
<p>Assuming I have two tables, one called <code>events</code> like this:</p>
<div class="code"><pre class="code literal-block">ID    NAME
1     Sample Event
2     Another Event
</pre></div>

<p>And a table called <code>events_meta</code> like this:</p>
<div class="code"><pre class="code literal-block">ID    event_id      meta_key           meta_value
1     1             repeat_start       1299132000
2     1             repeat_interval_1  432000
</pre></div>

<p>With repeat_start being a date with no time as a unix timestamp, and
repeat_interval an amount in seconds between intervals (432000 is 5 days).</p>
<p>repeat_interval_1 goes with repeat_start of the ID 1. So if I have an event
that repeats every Tuesday and every Thursday, the repeat_interval would be
604800 (7 days), and there would be 2 repeat_starts and 2 repeat_intervals.
The table would look like this:</p>
<div class="code"><pre class="code literal-block"><span class="nv">ID</span><span class="w">    </span><span class="nv">event_id</span><span class="w">      </span><span class="nv">meta_key</span><span class="w">           </span><span class="nv">meta_value</span>
<span class="mi">1</span><span class="w">     </span><span class="mi">1</span><span class="w">             </span><span class="nv">repeat_start</span><span class="w">       </span><span class="mi">1298959200</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="nv">This</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">Tuesday</span><span class="w"> </span><span class="nv">repeat</span>
<span class="mi">2</span><span class="w">     </span><span class="mi">1</span><span class="w">             </span><span class="nv">repeat_interval_1</span><span class="w">  </span><span class="mi">604800</span>
<span class="mi">3</span><span class="w">     </span><span class="mi">1</span><span class="w">             </span><span class="nv">repeat_start</span><span class="w">       </span><span class="mi">1299132000</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="nv">This</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">Thursday</span><span class="w"> </span><span class="nv">repeat</span>
<span class="mi">4</span><span class="w">     </span><span class="mi">1</span><span class="w">             </span><span class="nv">repeat_interval_3</span><span class="w">  </span><span class="mi">604800</span>
<span class="mi">5</span><span class="w">     </span><span class="mi">2</span><span class="w">             </span><span class="nv">repeat_start</span><span class="w">       </span><span class="mi">1299132000</span>
<span class="mi">6</span><span class="w">     </span><span class="mi">2</span><span class="w">             </span><span class="nv">repeat_interval_5</span><span class="w">  </span><span class="mi">1</span><span class="w">          </span><span class="o">--</span><span class="w"> </span><span class="nv">Using</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="nv">as</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">value</span><span class="w"> </span><span class="nv">gives</span><span class="w"> </span><span class="nv">us</span><span class="w"> </span><span class="nv">an</span><span class="w"> </span><span class="nv">event</span><span class="w"> </span><span class="nv">that</span><span class="w"> </span><span class="nv">only</span><span class="w"> </span><span class="nv">happens</span><span class="w"> </span><span class="nv">once</span>
</pre></div>

<p>Then, if you have a calendar that loops through every day, grabbing the events
for the day it's at, the query would look like this:</p>
<div class="code"><pre class="code literal-block"><span class="k">SELECT</span><span class="w"> </span><span class="n">EV</span><span class="p">.</span><span class="o">*</span>
<span class="k">FROM</span><span class="w"> </span><span class="n n-Quoted">`events`</span><span class="w"> </span><span class="n">EV</span>
<span class="k">RIGHT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n n-Quoted">`events_meta`</span><span class="w"> </span><span class="n">EM1</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">EM1</span><span class="p">.</span><span class="n n-Quoted">`event_id`</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EV</span><span class="p">.</span><span class="n n-Quoted">`id`</span>
<span class="k">RIGHT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n n-Quoted">`events_meta`</span><span class="w"> </span><span class="n">EM2</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">EM2</span><span class="p">.</span><span class="n n-Quoted">`meta_key`</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">CONCAT</span><span class="p">(</span><span class="w"> </span><span class="s1">'repeat_interval_'</span><span class="p">,</span><span class="w"> </span><span class="n">EM1</span><span class="p">.</span><span class="n n-Quoted">`id`</span><span class="w"> </span><span class="p">)</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">EM1</span><span class="p">.</span><span class="n">meta_key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'repeat_start'</span>
<span class="w">    </span><span class="k">AND</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">(</span><span class="w"> </span><span class="k">CASE</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">1299132000</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">EM1</span><span class="p">.</span><span class="n n-Quoted">`meta_value`</span><span class="w"> </span><span class="p">)</span>
<span class="w">            </span><span class="k">WHEN</span><span class="w"> </span><span class="mi">0</span>
<span class="w">              </span><span class="k">THEN</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="k">ELSE</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">1299132000</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">EM1</span><span class="p">.</span><span class="n n-Quoted">`meta_value`</span><span class="w"> </span><span class="p">)</span>
<span class="w">          </span><span class="k">END</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">EM2</span><span class="p">.</span><span class="n n-Quoted">`meta_value`</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="k">LIMIT</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">30</span>
</pre></div>

<p>Replacing <code>{current_timestamp}</code> with the unix timestamp for the current date
(Minus the time, so the hour, minute and second values would be set to 0).</p>
<p>Hopefully this will help somebody else too!</p>
<hr>
<h3>Storing "Complex" Repeating Patterns</h3>
<p>This method is better suited for storing complex patterns such as</p>
<p><code>Event A repeats every month on the 3rd of the month starting on March 3,
2011</code></p>
<p>or</p>
<p><code>Event A repeats Friday of the 2nd week of the month starting on March 11,
2011</code></p>
<p>I'd recommend combining this with the above system for the most flexibility.
The tables for this should like like:</p>
<div class="code"><pre class="code literal-block">ID    NAME
1     Sample Event
2     Another Event
</pre></div>

<p>And a table called <code>events_meta</code> like this:</p>
<div class="code"><pre class="code literal-block">ID    event_id      meta_key           meta_value
1     1             repeat_start       1299132000 -- March 3rd, 2011
2     1             repeat_year_1      *
3     1             repeat_month_1     *
4     1             repeat_week_im_1   2
5     1             repeat_weekday_1   6
</pre></div>

<p><code>repeat_week_im</code> represents the week of the current month, which could be
between 1 and 5 potentially. <code>repeat_weekday</code> in the day of the week, 1-7.</p>
<p>Now assuming you are looping through the days/weeks to create a month view in
your calendar, you could compose a query like this:</p>
<div class="code"><pre class="code literal-block"><span class="k">SELECT</span><span class="w"> </span><span class="n">EV</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="o">*</span>
<span class="k">FROM</span><span class="w"> </span><span class="n n-Quoted">`events`</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">EV</span>
<span class="k">JOIN</span><span class="w"> </span><span class="n n-Quoted">`events_meta`</span><span class="w"> </span><span class="n">EM1</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">EM1</span><span class="p">.</span><span class="n">event_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EV</span><span class="p">.</span><span class="n">id</span>
<span class="k">AND</span><span class="w"> </span><span class="n">EM1</span><span class="p">.</span><span class="n">meta_key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'repeat_start'</span>
<span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n n-Quoted">`events_meta`</span><span class="w"> </span><span class="n">EM2</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">EM2</span><span class="p">.</span><span class="n">meta_key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">CONCAT</span><span class="p">(</span><span class="w"> </span><span class="s1">'repeat_year_'</span><span class="p">,</span><span class="w"> </span><span class="n">EM1</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="p">)</span>
<span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n n-Quoted">`events_meta`</span><span class="w"> </span><span class="n">EM3</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">EM3</span><span class="p">.</span><span class="n">meta_key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">CONCAT</span><span class="p">(</span><span class="w"> </span><span class="s1">'repeat_month_'</span><span class="p">,</span><span class="w"> </span><span class="n">EM1</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="p">)</span>
<span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n n-Quoted">`events_meta`</span><span class="w"> </span><span class="n">EM4</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">EM4</span><span class="p">.</span><span class="n">meta_key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">CONCAT</span><span class="p">(</span><span class="w"> </span><span class="s1">'repeat_week_im_'</span><span class="p">,</span><span class="w"> </span><span class="n">EM1</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="p">)</span>
<span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n n-Quoted">`events_meta`</span><span class="w"> </span><span class="n">EM5</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">EM5</span><span class="p">.</span><span class="n">meta_key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">CONCAT</span><span class="p">(</span><span class="w"> </span><span class="s1">'repeat_weekday_'</span><span class="p">,</span><span class="w"> </span><span class="n">EM1</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="p">)</span>
<span class="k">WHERE</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="n">EM2</span><span class="p">.</span><span class="n">meta_value</span><span class="w"> </span><span class="o">=</span><span class="mi">2011</span>
<span class="w">  </span><span class="k">OR</span><span class="w"> </span><span class="n">EM2</span><span class="p">.</span><span class="n">meta_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'*'</span>
<span class="p">)</span>
<span class="k">AND</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="n">EM3</span><span class="p">.</span><span class="n">meta_value</span><span class="w"> </span><span class="o">=</span><span class="mi">4</span>
<span class="w">  </span><span class="k">OR</span><span class="w"> </span><span class="n">EM3</span><span class="p">.</span><span class="n">meta_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'*'</span>
<span class="p">)</span>
<span class="k">AND</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="n">EM4</span><span class="p">.</span><span class="n">meta_value</span><span class="w"> </span><span class="o">=</span><span class="mi">2</span>
<span class="w">  </span><span class="k">OR</span><span class="w"> </span><span class="n">EM4</span><span class="p">.</span><span class="n">meta_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'*'</span>
<span class="p">)</span>
<span class="k">AND</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="n">EM5</span><span class="p">.</span><span class="n">meta_value</span><span class="w"> </span><span class="o">=</span><span class="mi">6</span>
<span class="w">  </span><span class="k">OR</span><span class="w"> </span><span class="n">EM5</span><span class="p">.</span><span class="n">meta_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'*'</span>
<span class="p">)</span>
<span class="k">AND</span><span class="w"> </span><span class="n">EM1</span><span class="p">.</span><span class="n">meta_value</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="err">{</span><span class="k">current_timestamp</span><span class="err">}</span>
<span class="k">LIMIT</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">30</span>
</pre></div>

<p>This combined with the above method could be combined to cover most
repeating/recurring event patterns. If I've missed anything please leave a
comment.</p>
<p><br></p>
<h3>Suggest</h3>
<p>While the currently accepted answer was a huge help to me, I wanted to share
some useful modifications that simplify the queries and also increase
performance.</p>
<hr>
<h2>"Simple" Repeat Events</h2>
<p>To handle events which recur at regular intervals, such as:</p>
<div class="code"><pre class="code literal-block">Repeat every other day
</pre></div>

<p>or</p>
<div class="code"><pre class="code literal-block">Repeat every week on Tuesday
</pre></div>

<p>You should create two tables, one called <code>events</code> like this:</p>
<div class="code"><pre class="code literal-block">ID    NAME
1     Sample Event
2     Another Event
</pre></div>

<p>And a table called <code>events_meta</code> like this:</p>
<div class="code"><pre class="code literal-block">ID    event_id      repeat_start       repeat_interval
1     1             1369008000         604800            -- Repeats every Monday after May 20th 2013
1     1             1369008000         604800            -- Also repeats every Friday after May 20th 2013
</pre></div>

<p>With <code>repeat_start</code> being a unix timestamp date with no time (1369008000
corresponds to May 20th 2013) , and <code>repeat_interval</code> an amount in seconds
between intervals (604800 is 7 days).</p>
<p>By looping over each day in the calendar you can get repeat events using this
simple query:</p>
<div class="code"><pre class="code literal-block"><span class="k">SELECT</span><span class="w"> </span><span class="n">EV</span><span class="p">.</span><span class="o">*</span>
<span class="k">FROM</span><span class="w"> </span><span class="n n-Quoted">`events`</span><span class="w"> </span><span class="n">EV</span>
<span class="k">RIGHT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n n-Quoted">`events_meta`</span><span class="w"> </span><span class="n">EM1</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">EM1</span><span class="p">.</span><span class="n n-Quoted">`event_id`</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EV</span><span class="p">.</span><span class="n n-Quoted">`id`</span>
<span class="k">WHERE</span><span class="w">  </span><span class="p">((</span><span class="w"> </span><span class="mi">1299736800</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">repeat_start</span><span class="p">)</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">repeat_interval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span>
</pre></div>

<p>Just substitute in the unix-timestamp (1299736800) for each date in your
calendar.</p>
<p>Note the use of the modulo (% sign). This symbol is like regular division, but
returns the ''remainder'' instead of the quotient, and as such is 0 whenever
the current date is an exact multiple of the repeat_interval from the
repeat_start.</p>
<h3>Performance Comparison</h3>
<p>This is significantly faster than the previously suggested "meta_keys"-based
answer, which was as follows:</p>
<div class="code"><pre class="code literal-block"><span class="k">SELECT</span><span class="w"> </span><span class="n">EV</span><span class="p">.</span><span class="o">*</span>
<span class="k">FROM</span><span class="w"> </span><span class="n n-Quoted">`events`</span><span class="w"> </span><span class="n">EV</span>
<span class="k">RIGHT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n n-Quoted">`events_meta`</span><span class="w"> </span><span class="n">EM1</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">EM1</span><span class="p">.</span><span class="n n-Quoted">`event_id`</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EV</span><span class="p">.</span><span class="n n-Quoted">`id`</span>
<span class="k">RIGHT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n n-Quoted">`events_meta`</span><span class="w"> </span><span class="n">EM2</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">EM2</span><span class="p">.</span><span class="n n-Quoted">`meta_key`</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">CONCAT</span><span class="p">(</span><span class="w"> </span><span class="s1">'repeat_interval_'</span><span class="p">,</span><span class="w"> </span><span class="n">EM1</span><span class="p">.</span><span class="n n-Quoted">`id`</span><span class="w"> </span><span class="p">)</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">EM1</span><span class="p">.</span><span class="n">meta_key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'repeat_start'</span>
<span class="w">    </span><span class="k">AND</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">(</span><span class="w"> </span><span class="k">CASE</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">1299132000</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">EM1</span><span class="p">.</span><span class="n n-Quoted">`meta_value`</span><span class="w"> </span><span class="p">)</span>
<span class="w">            </span><span class="k">WHEN</span><span class="w"> </span><span class="mi">0</span>
<span class="w">              </span><span class="k">THEN</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="k">ELSE</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">1299132000</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">EM1</span><span class="p">.</span><span class="n n-Quoted">`meta_value`</span><span class="w"> </span><span class="p">)</span>
<span class="w">          </span><span class="k">END</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">EM2</span><span class="p">.</span><span class="n n-Quoted">`meta_value`</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
</pre></div>

<p>If you run EXPLAIN this query, you'll note that it required the use of a join
buffer:</p>
<div class="code"><pre class="code literal-block"><span class="nb">+----+-------------+-------+--------+---------------+---------+---------+------------------+------+--------------------------------+</span>
<span class="c">| id | select_type | table | type   | possible_keys | key     | key_len | ref              | rows | Extra                          |</span>
<span class="nb">+----+-------------+-------+--------+---------------+---------+---------+------------------+------+--------------------------------+</span>
<span class="c">|  1 | SIMPLE      | EM1   | ALL    | NULL          | NULL    | NULL    | NULL             |    2 | Using where                    |</span>
<span class="c">|  1 | SIMPLE      | EV    | eq_ref | PRIMARY       | PRIMARY | 4       | bcs</span><span class="nt">.</span><span class="c">EM1</span><span class="nt">.</span><span class="c">event_id |    1 |                                |</span>
<span class="c">|  1 | SIMPLE      | EM2   | ALL    | NULL          | NULL    | NULL    | NULL             |    2 | Using where; Using join buffer |</span>
<span class="nb">+----+-------------+-------+--------+---------------+---------+---------+------------------+------+--------------------------------+</span>
</pre></div>

<p>The solution with 1 join above requires no such buffer.</p>
<hr>
<h2>"Complex" Patterns</h2>
<p>You can add support for more complex types to support these types of repeat
rules:</p>
<div class="code"><pre class="code literal-block">Event A repeats every month on the 3rd of the month starting on March 3, 2011
</pre></div>

<p>or</p>
<div class="code"><pre class="code literal-block">Event A repeats second Friday of the month starting on March 11, 2011
</pre></div>

<p>Your events table can look exactly the same:</p>
<div class="code"><pre class="code literal-block">ID    NAME
1     Sample Event
2     Another Event
</pre></div>

<p>Then to add support for these complex rules add columns to <code>events_meta</code> like
so:</p>
<div class="code"><pre class="code literal-block">ID    event_id      repeat_start       repeat_interval    repeat_year    repeat_month    repeat_day    repeat_week    repeat_weekday
1     1             1369008000         604800             NULL           NULL            NULL          NULL           NULL             -- Repeats every Monday after May 20, 2013
1     1             1368144000         604800             NULL           NULL            NULL          NULL           NULL             -- Repeats every Friday after May 10, 2013
2     2             1369008000         NULL               2013           *               *             2              5                -- Repeats on Friday of the 2nd week in every month
</pre></div>

<p>Note that you simply need to either specify a <code>repeat_interval</code> <strong>or</strong> a set
of <code>repeat_year</code>, <code>repeat_month</code>, <code>repeat_day</code>, <code>repeat_week</code>, and
<code>repeat_weekday</code> data.</p>
<p>This makes selection of both types simultaneously very simple. Just loop
through each day and fill in the correct values, (1370563200 for June 7th
2013, and then the year, month, day, week number and weekday as follows):</p>
<div class="code"><pre class="code literal-block"><span class="k">SELECT</span><span class="w"> </span><span class="n">EV</span><span class="p">.</span><span class="o">*</span>
<span class="k">FROM</span><span class="w"> </span><span class="n n-Quoted">`events`</span><span class="w"> </span><span class="n">EV</span>
<span class="k">RIGHT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n n-Quoted">`events_meta`</span><span class="w"> </span><span class="n">EM1</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">EM1</span><span class="p">.</span><span class="n n-Quoted">`event_id`</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EV</span><span class="p">.</span><span class="n n-Quoted">`id`</span>
<span class="k">WHERE</span><span class="w">  </span><span class="p">((</span><span class="w"> </span><span class="mi">1370563200</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">repeat_start</span><span class="p">)</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">repeat_interval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="k">OR</span><span class="w"> </span><span class="p">(</span><span class="w"> </span>
<span class="w">    </span><span class="p">(</span><span class="n">repeat_year</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2013</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">repeat_year</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'*'</span><span class="w"> </span><span class="p">)</span>
<span class="w">    </span><span class="k">AND</span>
<span class="w">    </span><span class="p">(</span><span class="n">repeat_month</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">repeat_month</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'*'</span><span class="w"> </span><span class="p">)</span>
<span class="w">    </span><span class="k">AND</span>
<span class="w">    </span><span class="p">(</span><span class="n">repeat_day</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">repeat_day</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'*'</span><span class="w"> </span><span class="p">)</span>
<span class="w">    </span><span class="k">AND</span>
<span class="w">    </span><span class="p">(</span><span class="n">repeat_week</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">repeat_week</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'*'</span><span class="w"> </span><span class="p">)</span>
<span class="w">    </span><span class="k">AND</span>
<span class="w">    </span><span class="p">(</span><span class="n">repeat_weekday</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">repeat_weekday</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'*'</span><span class="w"> </span><span class="p">)</span>
<span class="w">    </span><span class="k">AND</span><span class="w"> </span><span class="n">repeat_start</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">1370563200</span>
<span class="w">  </span><span class="p">)</span>
</pre></div>

<p>This returns all events that repeat on the Friday of the 2nd week, <strong>as well
as</strong> any events that repeat every Friday, so it returns both event ID 1 and 2:</p>
<div class="code"><pre class="code literal-block">ID    NAME
1     Sample Event
2     Another Event
</pre></div>

<p>*Sidenote in the above SQL I used PHP Date's default weekday indexes, so "5" for Friday</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/cs0120-an-object-reference-is-required-for-the-nonstatic-field-method-or-property-foo/" class="u-url">CS0120: An object reference is required for the nonstatic field, method, or property 'foo'</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/cs0120-an-object-reference-is-required-for-the-nonstatic-field-method-or-property-foo/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T22:57:37+08:00" itemprop="datePublished" title="2023-03-04 22:57">2023-03-04 22:57</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Consider:</p>
<div class="code"><pre class="code literal-block"><span class="nv">namespace</span><span class="w"> </span><span class="nv">WindowsApplication1</span>
{
<span class="w">    </span><span class="nv">public</span><span class="w"> </span><span class="nv">partial</span><span class="w"> </span><span class="nv">class</span><span class="w"> </span><span class="nv">Form1</span><span class="w"> </span>:<span class="w"> </span><span class="nv">Form</span>
<span class="w">    </span>{
<span class="w">        </span><span class="nv">public</span><span class="w"> </span><span class="nv">Form1</span><span class="ss">()</span>
<span class="w">        </span>{
<span class="w">            </span><span class="nv">InitializeComponent</span><span class="ss">()</span><span class="c1">;</span>
<span class="w">        </span>}

<span class="w">        </span><span class="nv">private</span><span class="w"> </span><span class="nv">void</span><span class="w"> </span><span class="nv">button1_Click</span><span class="ss">(</span><span class="nv">object</span><span class="w"> </span><span class="nv">sender</span>,<span class="w"> </span><span class="nv">EventArgs</span><span class="w"> </span><span class="nv">e</span><span class="ss">)</span>
<span class="w">        </span>{
<span class="w">            </span><span class="o">//</span><span class="nv">int</span>[]<span class="w"> </span><span class="nv">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>{<span class="w"> </span><span class="mi">0</span>,<span class="w"> </span><span class="mi">0</span>}<span class="c1">;</span>
<span class="w">            </span><span class="nv">int</span><span class="w"> </span><span class="nv">val</span><span class="c1">;</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">textBox1</span>.<span class="nv">Text</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">""</span><span class="ss">)</span>
<span class="w">            </span>{
<span class="w">                </span><span class="k">MessageBox</span>.<span class="k">Show</span><span class="ss">(</span><span class="s2">"Input any no"</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">            </span>}
<span class="w">            </span><span class="k">else</span>
<span class="w">            </span>{
<span class="w">                </span><span class="nv">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">Convert</span>.<span class="nv">ToInt32</span><span class="ss">(</span><span class="nv">textBox1</span>.<span class="nv">Text</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">                </span><span class="nv">Thread</span><span class="w"> </span><span class="nv">ot1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">Thread</span><span class="ss">(</span><span class="nv">new</span><span class="w"> </span><span class="nv">ParameterizedThreadStart</span><span class="ss">(</span><span class="nv">SumData</span><span class="ss">))</span><span class="c1">;</span>
<span class="w">                </span><span class="nv">ot1</span>.<span class="nv">Start</span><span class="ss">(</span><span class="nv">val</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">            </span>}
<span class="w">        </span>}

<span class="w">        </span><span class="nv">private</span><span class="w"> </span><span class="nv">static</span><span class="w"> </span><span class="nv">void</span><span class="w"> </span><span class="nv">ReadData</span><span class="ss">(</span><span class="nv">object</span><span class="w"> </span><span class="nv">state</span><span class="ss">)</span>
<span class="w">        </span>{
<span class="w">            </span><span class="nv">System</span>.<span class="nv">Windows</span>.<span class="nv">Forms</span>.<span class="nv">Application</span>.<span class="nv">Run</span><span class="ss">()</span><span class="c1">;</span>
<span class="w">        </span>}

<span class="w">        </span><span class="nv">void</span><span class="w"> </span><span class="nv">setTextboxText</span><span class="ss">(</span><span class="nv">int</span><span class="w"> </span><span class="nb">result</span><span class="ss">)</span>
<span class="w">        </span>{
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">this</span>.<span class="nv">InvokeRequired</span><span class="ss">)</span>
<span class="w">            </span>{
<span class="w">                </span><span class="nv">this</span>.<span class="nv">Invoke</span><span class="ss">(</span><span class="nv">new</span><span class="w"> </span><span class="nv">IntDelegate</span><span class="ss">(</span><span class="nv">SetTextboxTextSafe</span><span class="ss">)</span>,<span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">object</span>[]<span class="w"> </span>{<span class="w"> </span><span class="nb">result</span><span class="w"> </span>}<span class="ss">)</span><span class="c1">;</span>
<span class="w">            </span>}
<span class="w">            </span><span class="k">else</span>
<span class="w">            </span>{
<span class="w">                </span><span class="nv">SetTextboxTextSafe</span><span class="ss">(</span><span class="nb">result</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">            </span>}
<span class="w">        </span>}

<span class="w">        </span><span class="nv">void</span><span class="w"> </span><span class="nv">SetTextboxTextSafe</span><span class="ss">(</span><span class="nv">int</span><span class="w"> </span><span class="nb">result</span><span class="ss">)</span>
<span class="w">        </span>{
<span class="w">            </span><span class="nv">label1</span>.<span class="nv">Text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">result</span>.<span class="nv">ToString</span><span class="ss">()</span><span class="c1">;</span>
<span class="w">        </span>}

<span class="w">        </span><span class="nv">private</span><span class="w"> </span><span class="nv">static</span><span class="w"> </span><span class="nv">void</span><span class="w"> </span><span class="nv">SumData</span><span class="ss">(</span><span class="nv">object</span><span class="w"> </span><span class="nv">state</span><span class="ss">)</span>
<span class="w">        </span>{
<span class="w">            </span><span class="nv">int</span><span class="w"> </span><span class="nb">result</span><span class="c1">;</span>
<span class="w">            </span><span class="o">//</span><span class="nv">int</span>[]<span class="w"> </span><span class="nv">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">(</span><span class="nv">int</span>[]<span class="ss">)</span><span class="nv">state</span><span class="c1">;</span>
<span class="w">            </span><span class="nv">int</span><span class="w"> </span><span class="nv">icount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">(</span><span class="nv">int</span><span class="ss">)</span><span class="nv">state</span><span class="c1">;</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="ss">(</span><span class="nv">int</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">icount</span><span class="c1">; i &gt; 0; i--)</span>
<span class="w">            </span>{
<span class="w">                </span><span class="nb">result</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nv">i</span><span class="c1">;</span>
<span class="w">                </span><span class="nv">System</span>.<span class="nv">Threading</span>.<span class="nv">Thread</span>.<span class="nv">Sleep</span><span class="ss">(</span><span class="mi">1000</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">            </span>}
<span class="w">            </span><span class="nv">setTextboxText</span><span class="ss">(</span><span class="nb">result</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">        </span>}

<span class="w">        </span><span class="nv">delegate</span><span class="w"> </span><span class="nv">void</span><span class="w"> </span><span class="nv">IntDelegate</span><span class="ss">(</span><span class="nv">int</span><span class="w"> </span><span class="nb">result</span><span class="ss">)</span><span class="c1">;</span>

<span class="w">        </span><span class="nv">private</span><span class="w"> </span><span class="nv">void</span><span class="w"> </span><span class="nv">button2_Click</span><span class="ss">(</span><span class="nv">object</span><span class="w"> </span><span class="nv">sender</span>,<span class="w"> </span><span class="nv">EventArgs</span><span class="w"> </span><span class="nv">e</span><span class="ss">)</span>
<span class="w">        </span>{
<span class="w">            </span><span class="nv">Application</span>.<span class="k">Exit</span><span class="ss">()</span><span class="c1">;</span>
<span class="w">        </span>}
<span class="w">    </span>}
}
</pre></div>

<p>Why is this error occurring?</p>
<blockquote>
<p>An object reference is required for the nonstatic field, method, or property
'WindowsApplication1.Form1.setTextboxText(int)</p>
</blockquote>
<p><br><br></p>
<h2>Answer</h2>
<p>It looks like you are calling a non static member (a property or method,
specifically <code>setTextboxText</code>) from a static method (specifically <code>SumData</code>).
You will need to either:</p>
<ol>
<li>
<p>Make the called member static also:</p>
<div class="code"><pre class="code literal-block">static void setTextboxText(int result)
</pre></div>

<p>{
    // Write static logic for setTextboxText.<br>
    // This may require a static singleton instance of Form1.
}</p>
</li>
<li>
<p>Create an instance of <code>Form1</code> within the calling method:</p>
<div class="code"><pre class="code literal-block">private static void SumData(object state)
</pre></div>

<p>{
    int result = 0;
    //int[] icount = (int[])state;
    int icount = (int)state;</p>
<div class="code"><pre class="code literal-block"><span class="k">for</span><span class="w"> </span><span class="ss">(</span><span class="nv">int</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">icount</span><span class="c1">; i &gt; 0; i--)</span>
{
<span class="w">    </span><span class="nb">result</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nv">i</span><span class="c1">;</span>
<span class="w">    </span><span class="nv">System</span>.<span class="nv">Threading</span>.<span class="nv">Thread</span>.<span class="nv">Sleep</span><span class="ss">(</span><span class="mi">1000</span><span class="ss">)</span><span class="c1">;</span>
}
<span class="nv">Form1</span><span class="w"> </span><span class="nv">frm1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">Form1</span><span class="ss">()</span><span class="c1">;</span>
<span class="nv">frm1</span>.<span class="nv">setTextboxText</span><span class="ss">(</span><span class="nb">result</span><span class="ss">)</span><span class="c1">;</span>
</pre></div>

<p>}</p>
</li>
</ol>
<p>Passing in an instance of <code>Form1</code> would be an option also.</p>
<ol>
<li>Make the calling method a non-static instance method (of <code>Form1</code>):<div class="code"><pre class="code literal-block">private void SumData(object state)
</pre></div>

<p>{
    int result = 0;
    //int[] icount = (int[])state;
    int icount = (int)state;</p>
<div class="code"><pre class="code literal-block"><span class="k">for</span><span class="w"> </span><span class="ss">(</span><span class="nv">int</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">icount</span><span class="c1">; i &gt; 0; i--)</span>
{
<span class="w">    </span><span class="nb">result</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nv">i</span><span class="c1">;</span>
<span class="w">    </span><span class="nv">System</span>.<span class="nv">Threading</span>.<span class="nv">Thread</span>.<span class="nv">Sleep</span><span class="ss">(</span><span class="mi">1000</span><span class="ss">)</span><span class="c1">;</span>
}
<span class="nv">setTextboxText</span><span class="ss">(</span><span class="nb">result</span><span class="ss">)</span><span class="c1">;</span>
</pre></div>

<p>}</p>
</li>
</ol>
<p>More info about this error can be found on MSDN.</p>
<p><br></p>
<h3>Suggest</h3>
<p>For this case, where you want to get a Control of a Form and are receiving
this error, then I have a little bypass for you.</p>
<p>Go to your Program.cs and change</p>
<div class="code"><pre class="code literal-block">Application.Run(new Form1());
</pre></div>

<p>to</p>
<div class="code"><pre class="code literal-block"><span class="n">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">Form1</span><span class="w"> </span><span class="n">form1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">Form1</span><span class="p">();</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">Place</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">constructor</span>
<span class="n">Application</span><span class="o">.</span><span class="n">Run</span><span class="p">(</span><span class="n">form1</span><span class="p">);</span>
</pre></div>

<p>Now you can access a control with</p>
<div class="code"><pre class="code literal-block">Program.form1.&lt;Your control&gt;
</pre></div>

<p>Also: Don't forget to set your Control-Access-Level to Public.</p>
<p>And yes I know, this answer does not fit to the question caller, but it fits
to googlers who have this specific issue with controls.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-2532.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-2530.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
