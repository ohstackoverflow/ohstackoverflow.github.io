<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 2185) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-2185.html">
<link rel="prev" href="index-2186.html" type="text/html">
<link rel="next" href="index-2184.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/can-t-perform-a-react-state-update-on-an-unmounted-component/" class="u-url">Can't perform a React state update on an unmounted component</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/can-t-perform-a-react-state-update-on-an-unmounted-component/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T21:18:01+08:00" itemprop="datePublished" title="2023-03-03 21:18">2023-03-03 21:18</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <h3>Problem</h3>
<p>I am writing an application in React and was unable to avoid a super common
pitfall, which is calling <code>setState(...)</code> after <code>componentWillUnmount(...)</code>.</p>
<p>I looked very carefully at my code and tried to put some guarding clauses in
place, but the problem persisted and I am still observing the warning.</p>
<p>Therefore, I've got two questions:</p>
<ol>
<li>
<strong>How do I figure out from the stack trace</strong> , which particular component and event handler or lifecycle hook is responsible for the rule violation?</li>
<li>Well, how to fix the problem itself, because my code was written with this pitfall in mind and is already trying to prevent it, but some underlying component's still generating the warning.</li>
</ol>
<h3>Browser console</h3>
<div class="code"><pre class="code literal-block"><span class="nl">Warning</span><span class="p">:</span><span class="w"> </span><span class="n">Can</span><span class="err">'</span><span class="n">t</span><span class="w"> </span><span class="n">perform</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">React</span><span class="w"> </span><span class="k">state</span><span class="w"> </span><span class="k">update</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">unmounted</span><span class="w"> </span><span class="n">component</span><span class="p">.</span>
<span class="n">This</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">no</span><span class="o">-</span><span class="n">op</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">indicates</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">memory</span><span class="w"> </span><span class="n">leak</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">application</span><span class="p">.</span>
<span class="k">To</span><span class="w"> </span><span class="n">fix</span><span class="p">,</span><span class="w"> </span><span class="n">cancel</span><span class="w"> </span><span class="ow">all</span><span class="w"> </span><span class="n">subscriptions</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">asynchronous</span><span class="w"> </span><span class="n">tasks</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">componentWillUnmount</span>
<span class="k">method</span><span class="p">.</span>
<span class="w">    </span><span class="ow">in</span><span class="w"> </span><span class="n">TextLayerInternal</span><span class="w"> </span><span class="p">(</span><span class="n">created</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">Context</span><span class="p">.</span><span class="n">Consumer</span><span class="p">)</span>
<span class="w">    </span><span class="ow">in</span><span class="w"> </span><span class="n">TextLayer</span><span class="w"> </span><span class="p">(</span><span class="n">created</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">PageInternal</span><span class="p">)</span><span class="w"> </span><span class="k">index</span><span class="p">.</span><span class="nl">js</span><span class="p">:</span><span class="mi">1446</span>
<span class="n">d</span><span class="o">/</span><span class="n">console</span><span class="o">[</span><span class="n">e</span><span class="o">]</span>
<span class="k">index</span><span class="p">.</span><span class="nl">js</span><span class="p">:</span><span class="mi">1446</span>
<span class="n">warningWithoutStack</span>
<span class="n">react</span><span class="o">-</span><span class="n">dom</span><span class="p">.</span><span class="n">development</span><span class="p">.</span><span class="nl">js</span><span class="p">:</span><span class="mi">520</span>
<span class="n">warnAboutUpdateOnUnmounted</span>
<span class="n">react</span><span class="o">-</span><span class="n">dom</span><span class="p">.</span><span class="n">development</span><span class="p">.</span><span class="nl">js</span><span class="p">:</span><span class="mi">18238</span>
<span class="n">scheduleWork</span>
<span class="n">react</span><span class="o">-</span><span class="n">dom</span><span class="p">.</span><span class="n">development</span><span class="p">.</span><span class="nl">js</span><span class="p">:</span><span class="mi">19684</span>
<span class="n">enqueueSetState</span>
<span class="n">react</span><span class="o">-</span><span class="n">dom</span><span class="p">.</span><span class="n">development</span><span class="p">.</span><span class="nl">js</span><span class="p">:</span><span class="mi">12936</span>
<span class="p">.</span><span class="o">/</span><span class="n">node_modules</span><span class="o">/</span><span class="n">react</span><span class="o">/</span><span class="n">cjs</span><span class="o">/</span><span class="n">react</span><span class="p">.</span><span class="n">development</span><span class="p">.</span><span class="n">js</span><span class="o">/</span><span class="n">Component</span><span class="p">.</span><span class="n">prototype</span><span class="p">.</span><span class="n">setState</span>
<span class="n">react</span><span class="p">.</span><span class="n">development</span><span class="p">.</span><span class="nl">js</span><span class="p">:</span><span class="mi">356</span>
<span class="n">_callee</span><span class="err">$</span>
<span class="n">TextLayer</span><span class="p">.</span><span class="nl">js</span><span class="p">:</span><span class="mi">97</span>
<span class="n">tryCatch</span>
<span class="n">runtime</span><span class="p">.</span><span class="nl">js</span><span class="p">:</span><span class="mi">63</span>
<span class="n">invoke</span>
<span class="n">runtime</span><span class="p">.</span><span class="nl">js</span><span class="p">:</span><span class="mi">282</span>
<span class="n">defineIteratorMethods</span><span class="o">/&lt;/</span><span class="n">prototype</span><span class="o">[</span><span class="n">method</span><span class="o">]</span>
<span class="n">runtime</span><span class="p">.</span><span class="nl">js</span><span class="p">:</span><span class="mi">116</span>
<span class="n">asyncGeneratorStep</span>
<span class="n">asyncToGenerator</span><span class="p">.</span><span class="nl">js</span><span class="p">:</span><span class="mi">3</span>
<span class="n">_throw</span>
<span class="n">asyncToGenerator</span><span class="p">.</span><span class="nl">js</span><span class="p">:</span><span class="mi">29</span>
</pre></div>

<p><img alt="enter image description here" src="images/ATfMj.png"></p>
<h3>Code</h3>
<p><strong>Book.tsx</strong></p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="p">{</span> <span class="n">throttle</span> <span class="p">}</span> <span class="kn">from</span> <span class="s1">'lodash'</span><span class="p">;</span>
<span class="kn">import</span> <span class="o">*</span> <span class="k">as</span> <span class="n">React</span> <span class="kn">from</span> <span class="s1">'react'</span><span class="p">;</span>
<span class="kn">import</span> <span class="p">{</span> <span class="n">AutoWidthPdf</span> <span class="p">}</span> <span class="kn">from</span> <span class="s1">'../shared/AutoWidthPdf'</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">BookCommandPanel</span> <span class="kn">from</span> <span class="s1">'../shared/BookCommandPanel'</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">BookTextPath</span> <span class="kn">from</span> <span class="s1">'../static/pdf/sde.pdf'</span><span class="p">;</span>
<span class="kn">import</span> <span class="s1">'./Book.css'</span><span class="p">;</span>

<span class="n">const</span> <span class="n">DEFAULT_WIDTH</span> <span class="o">=</span> <span class="mi">140</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Book</span> <span class="n">extends</span> <span class="n">React</span><span class="o">.</span><span class="n">Component</span> <span class="p">{</span>
  <span class="n">setDivSizeThrottleable</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="n">void</span><span class="p">;</span>
  <span class="n">pdfWrapper</span><span class="p">:</span> <span class="n">HTMLDivElement</span> <span class="o">|</span> <span class="n">null</span> <span class="o">=</span> <span class="n">null</span><span class="p">;</span>
  <span class="n">isComponentMounted</span><span class="p">:</span> <span class="n">boolean</span> <span class="o">=</span> <span class="n">false</span><span class="p">;</span>
  <span class="n">state</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">hidden</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
    <span class="n">pdfWidth</span><span class="p">:</span> <span class="n">DEFAULT_WIDTH</span><span class="p">,</span>
  <span class="p">};</span>

  <span class="n">constructor</span><span class="p">(</span><span class="n">props</span><span class="p">:</span> <span class="nb">any</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">props</span><span class="p">);</span>
    <span class="n">this</span><span class="o">.</span><span class="n">setDivSizeThrottleable</span> <span class="o">=</span> <span class="n">throttle</span><span class="p">(</span>
      <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">isComponentMounted</span><span class="p">)</span> <span class="p">{</span>
          <span class="n">this</span><span class="o">.</span><span class="n">setState</span><span class="p">({</span>
            <span class="n">pdfWidth</span><span class="p">:</span> <span class="n">this</span><span class="o">.</span><span class="n">pdfWrapper</span><span class="err">!</span><span class="o">.</span><span class="n">getBoundingClientRect</span><span class="p">()</span><span class="o">.</span><span class="n">width</span> <span class="o">-</span> <span class="mi">5</span><span class="p">,</span>
          <span class="p">});</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="mi">500</span><span class="p">,</span>
    <span class="p">);</span>
  <span class="p">}</span>

  <span class="n">componentDidMount</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="n">this</span><span class="o">.</span><span class="n">isComponentMounted</span> <span class="o">=</span> <span class="n">true</span><span class="p">;</span>
    <span class="n">this</span><span class="o">.</span><span class="n">setDivSizeThrottleable</span><span class="p">();</span>
    <span class="n">window</span><span class="o">.</span><span class="n">addEventListener</span><span class="p">(</span><span class="s2">"resize"</span><span class="p">,</span> <span class="n">this</span><span class="o">.</span><span class="n">setDivSizeThrottleable</span><span class="p">);</span>
  <span class="p">};</span>

  <span class="n">componentWillUnmount</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="n">this</span><span class="o">.</span><span class="n">isComponentMounted</span> <span class="o">=</span> <span class="n">false</span><span class="p">;</span>
    <span class="n">window</span><span class="o">.</span><span class="n">removeEventListener</span><span class="p">(</span><span class="s2">"resize"</span><span class="p">,</span> <span class="n">this</span><span class="o">.</span><span class="n">setDivSizeThrottleable</span><span class="p">);</span>
  <span class="p">};</span>

  <span class="n">render</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="n">div</span> <span class="n">className</span><span class="o">=</span><span class="s2">"Book"</span><span class="o">&gt;</span>
      <span class="p">{</span> <span class="n">this</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">hidden</span> <span class="o">&amp;&amp;</span> <span class="o">&lt;</span><span class="n">div</span> <span class="n">className</span><span class="o">=</span><span class="s2">"Book__LoadNotification centered"</span><span class="o">&gt;</span><span class="n">Book</span> <span class="ow">is</span> <span class="n">being</span> <span class="n">loaded</span><span class="o">...&lt;/</span><span class="n">div</span><span class="o">&gt;</span> <span class="p">}</span>

      <span class="o">&lt;</span><span class="n">div</span> <span class="n">className</span><span class="o">=</span><span class="p">{</span><span class="n">this</span><span class="o">.</span><span class="n">getPdfContentContainerClassName</span><span class="p">()}</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">BookCommandPanel</span>
          <span class="n">bookTextPath</span><span class="o">=</span><span class="p">{</span><span class="n">BookTextPath</span><span class="p">}</span>
          <span class="o">/&gt;</span>

        <span class="o">&lt;</span><span class="n">div</span> <span class="n">className</span><span class="o">=</span><span class="s2">"Book__PdfContent"</span> <span class="n">ref</span><span class="o">=</span><span class="p">{</span><span class="n">ref</span> <span class="o">=&gt;</span> <span class="n">this</span><span class="o">.</span><span class="n">pdfWrapper</span> <span class="o">=</span> <span class="n">ref</span><span class="p">}</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="n">AutoWidthPdf</span>
            <span class="n">file</span><span class="o">=</span><span class="p">{</span><span class="n">BookTextPath</span><span class="p">}</span>
            <span class="n">width</span><span class="o">=</span><span class="p">{</span><span class="n">this</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">pdfWidth</span><span class="p">}</span>
            <span class="n">onLoadSuccess</span><span class="o">=</span><span class="p">{(</span><span class="n">_</span><span class="p">:</span> <span class="nb">any</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">this</span><span class="o">.</span><span class="n">onDocumentComplete</span><span class="p">()}</span>
            <span class="o">/&gt;</span>
        <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>

        <span class="o">&lt;</span><span class="n">BookCommandPanel</span>
          <span class="n">bookTextPath</span><span class="o">=</span><span class="p">{</span><span class="n">BookTextPath</span><span class="p">}</span>
          <span class="o">/&gt;</span>
      <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
    <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
  <span class="p">);</span>

  <span class="n">getPdfContentContainerClassName</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="n">this</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">hidden</span> <span class="err">?</span> <span class="s1">'hidden'</span> <span class="p">:</span> <span class="s1">''</span><span class="p">;</span>

  <span class="n">onDocumentComplete</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
      <span class="n">this</span><span class="o">.</span><span class="n">setState</span><span class="p">({</span> <span class="n">hidden</span><span class="p">:</span> <span class="n">false</span> <span class="p">});</span>
      <span class="n">this</span><span class="o">.</span><span class="n">setDivSizeThrottleable</span><span class="p">();</span>
    <span class="p">}</span> <span class="n">catch</span> <span class="p">(</span><span class="n">caughtError</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">console</span><span class="o">.</span><span class="n">warn</span><span class="p">({</span> <span class="n">caughtError</span> <span class="p">});</span>
    <span class="p">}</span>
  <span class="p">};</span>
<span class="p">}</span>

<span class="n">export</span> <span class="n">default</span> <span class="n">Book</span><span class="p">;</span>
</pre></div>

<p><strong>AutoWidthPdf.tsx</strong></p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="o">*</span> <span class="k">as</span> <span class="n">React</span> <span class="kn">from</span> <span class="s1">'react'</span><span class="p">;</span>
<span class="kn">import</span> <span class="p">{</span> <span class="n">Document</span><span class="p">,</span> <span class="n">Page</span><span class="p">,</span> <span class="n">pdfjs</span> <span class="p">}</span> <span class="kn">from</span> <span class="s1">'react-pdf'</span><span class="p">;</span>

<span class="n">pdfjs</span><span class="o">.</span><span class="n">GlobalWorkerOptions</span><span class="o">.</span><span class="n">workerSrc</span> <span class="o">=</span> <span class="err">`</span><span class="o">//</span><span class="n">cdnjs</span><span class="o">.</span><span class="n">cloudflare</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">ajax</span><span class="o">/</span><span class="n">libs</span><span class="o">/</span><span class="n">pdf</span><span class="o">.</span><span class="n">js</span><span class="o">/</span><span class="err">$</span><span class="p">{</span><span class="n">pdfjs</span><span class="o">.</span><span class="n">version</span><span class="p">}</span><span class="o">/</span><span class="n">pdf</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">js</span><span class="err">`</span><span class="p">;</span>

<span class="n">interface</span> <span class="n">IProps</span> <span class="p">{</span>
  <span class="n">file</span><span class="p">:</span> <span class="n">string</span><span class="p">;</span>
  <span class="n">width</span><span class="p">:</span> <span class="n">number</span><span class="p">;</span>
  <span class="n">onLoadSuccess</span><span class="p">:</span> <span class="p">(</span><span class="n">pdf</span><span class="p">:</span> <span class="nb">any</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">void</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">export</span> <span class="k">class</span> <span class="nc">AutoWidthPdf</span> <span class="n">extends</span> <span class="n">React</span><span class="o">.</span><span class="n">Component</span><span class="o">&lt;</span><span class="n">IProps</span><span class="o">&gt;</span> <span class="p">{</span>
  <span class="n">render</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="n">Document</span>
      <span class="n">file</span><span class="o">=</span><span class="p">{</span><span class="n">this</span><span class="o">.</span><span class="n">props</span><span class="o">.</span><span class="n">file</span><span class="p">}</span>
      <span class="n">onLoadSuccess</span><span class="o">=</span><span class="p">{(</span><span class="n">_</span><span class="p">:</span> <span class="nb">any</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">this</span><span class="o">.</span><span class="n">props</span><span class="o">.</span><span class="n">onLoadSuccess</span><span class="p">(</span><span class="n">_</span><span class="p">)}</span>
      <span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">Page</span>
        <span class="n">pageNumber</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span>
        <span class="n">width</span><span class="o">=</span><span class="p">{</span><span class="n">this</span><span class="o">.</span><span class="n">props</span><span class="o">.</span><span class="n">width</span><span class="p">}</span>
        <span class="o">/&gt;</span>
    <span class="o">&lt;/</span><span class="n">Document</span><span class="o">&gt;</span>
  <span class="p">);</span>
<span class="p">}</span>
</pre></div>

<hr>
<h2>Update 1: Cancel throttleable function (still no luck)</h2>
<div class="code"><pre class="code literal-block"><span class="k">const</span><span class="w"> </span><span class="n">DEFAULT_WIDTH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">140</span><span class="p">;</span>

<span class="k">class</span><span class="w"> </span><span class="n">Book</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="n">React</span><span class="o">.</span><span class="n">Component</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">setDivSizeThrottleable</span><span class="p">:</span><span class="w"> </span><span class="p">((()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">Cancelable</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">undefined</span><span class="p">;</span>
<span class="w">  </span><span class="n">pdfWrapper</span><span class="p">:</span><span class="w"> </span><span class="n">HTMLDivElement</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nb nb-Type">null</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb nb-Type">null</span><span class="p">;</span>
<span class="w">  </span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">hidden</span><span class="p">:</span><span class="w"> </span><span class="bp">true</span><span class="p">,</span>
<span class="w">    </span><span class="n">pdfWidth</span><span class="p">:</span><span class="w"> </span><span class="n">DEFAULT_WIDTH</span><span class="p">,</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="n">componentDidMount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">this</span><span class="o">.</span><span class="n">setDivSizeThrottleable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">throttle</span><span class="p">(</span>
<span class="w">      </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">this</span><span class="o">.</span><span class="n">setState</span><span class="p">({</span>
<span class="w">          </span><span class="n">pdfWidth</span><span class="p">:</span><span class="w"> </span><span class="n">this</span><span class="o">.</span><span class="n">pdfWrapper</span><span class="o">!.</span><span class="n">getBoundingClientRect</span><span class="p">()</span><span class="o">.</span><span class="n">width</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span>
<span class="w">        </span><span class="p">});</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="mi">500</span><span class="p">,</span>
<span class="w">    </span><span class="p">);</span>

<span class="w">    </span><span class="n">this</span><span class="o">.</span><span class="n">setDivSizeThrottleable</span><span class="p">();</span>
<span class="w">    </span><span class="n">window</span><span class="o">.</span><span class="n">addEventListener</span><span class="p">(</span><span class="s2">"resize"</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="o">.</span><span class="n">setDivSizeThrottleable</span><span class="p">);</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="n">componentWillUnmount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">window</span><span class="o">.</span><span class="n">removeEventListener</span><span class="p">(</span><span class="s2">"resize"</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="o">.</span><span class="n">setDivSizeThrottleable</span><span class="o">!</span><span class="p">);</span>
<span class="w">    </span><span class="n">this</span><span class="o">.</span><span class="n">setDivSizeThrottleable</span><span class="o">!.</span><span class="n">cancel</span><span class="p">();</span>
<span class="w">    </span><span class="n">this</span><span class="o">.</span><span class="n">setDivSizeThrottleable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">undefined</span><span class="p">;</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="n">render</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="o">&lt;</span><span class="n">div</span><span class="w"> </span><span class="n">className</span><span class="o">=</span><span class="s2">"Book"</span><span class="o">&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="w"> </span><span class="n">this</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">hidden</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">&lt;</span><span class="n">div</span><span class="w"> </span><span class="n">className</span><span class="o">=</span><span class="s2">"Book__LoadNotification centered"</span><span class="o">&gt;</span><span class="n">Book</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">loaded</span><span class="o">...&lt;/</span><span class="n">div</span><span class="o">&gt;</span><span class="w"> </span><span class="p">}</span>

<span class="w">      </span><span class="o">&lt;</span><span class="n">div</span><span class="w"> </span><span class="n">className</span><span class="o">=</span><span class="p">{</span><span class="n">this</span><span class="o">.</span><span class="n">getPdfContentContainerClassName</span><span class="p">()}</span><span class="o">&gt;</span>
<span class="w">        </span><span class="o">&lt;</span><span class="n">BookCommandPanel</span>
<span class="w">          </span><span class="n">BookTextPath</span><span class="o">=</span><span class="p">{</span><span class="n">BookTextPath</span><span class="p">}</span>
<span class="w">          </span><span class="o">/&gt;</span>

<span class="w">        </span><span class="o">&lt;</span><span class="n">div</span><span class="w"> </span><span class="n">className</span><span class="o">=</span><span class="s2">"Book__PdfContent"</span><span class="w"> </span><span class="n">ref</span><span class="o">=</span><span class="p">{</span><span class="n">ref</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">this</span><span class="o">.</span><span class="n">pdfWrapper</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ref</span><span class="p">}</span><span class="o">&gt;</span>
<span class="w">          </span><span class="o">&lt;</span><span class="n">AutoWidthPdf</span>
<span class="w">            </span><span class="n">file</span><span class="o">=</span><span class="p">{</span><span class="n">BookTextPath</span><span class="p">}</span>
<span class="w">            </span><span class="n">width</span><span class="o">=</span><span class="p">{</span><span class="n">this</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">pdfWidth</span><span class="p">}</span>
<span class="w">            </span><span class="n">onLoadSuccess</span><span class="o">=</span><span class="p">{(</span><span class="n">_</span><span class="p">:</span><span class="w"> </span><span class="n">any</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">this</span><span class="o">.</span><span class="n">onDocumentComplete</span><span class="p">()}</span>
<span class="w">            </span><span class="o">/&gt;</span>
<span class="w">        </span><span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>

<span class="w">        </span><span class="o">&lt;</span><span class="n">BookCommandPanel</span>
<span class="w">          </span><span class="n">BookTextPath</span><span class="o">=</span><span class="p">{</span><span class="n">BookTextPath</span><span class="p">}</span>
<span class="w">          </span><span class="o">/&gt;</span>
<span class="w">      </span><span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
<span class="w">    </span><span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
<span class="w">  </span><span class="p">);</span>

<span class="w">  </span><span class="n">getPdfContentContainerClassName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">this</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">hidden</span><span class="w"> </span><span class="err">?</span><span class="w"> </span><span class="s1">'hidden'</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s1">''</span><span class="p">;</span>

<span class="w">  </span><span class="n">onDocumentComplete</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">this</span><span class="o">.</span><span class="n">setState</span><span class="p">({</span><span class="w"> </span><span class="n">hidden</span><span class="p">:</span><span class="w"> </span><span class="bp">false</span><span class="w"> </span><span class="p">});</span>
<span class="w">      </span><span class="n">this</span><span class="o">.</span><span class="n">setDivSizeThrottleable</span><span class="o">!</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="n">catch</span><span class="w"> </span><span class="p">(</span><span class="n">caughtError</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">console</span><span class="o">.</span><span class="n">warn</span><span class="p">({</span><span class="w"> </span><span class="n">caughtError</span><span class="w"> </span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">Book</span><span class="p">;</span>
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<p>Here is a <strong>React Hooks</strong> specific solution for</p>
<h4>Error</h4>
<blockquote>
<p>Warning: Can't perform a React state update on an unmounted component.</p>
</blockquote>
<h4>Solution</h4>
<p>You can declare <code>let isMounted = true</code> inside <code>useEffect</code>, which will be
changed in the cleanup callback, as soon as the component is unmounted. Before
state updates, you now check this variable conditionally:</p>
<div class="code"><pre class="code literal-block"><span class="nv">useEffect</span><span class="ss">(()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span>{
<span class="w">  </span><span class="nv">let</span><span class="w"> </span><span class="nv">isMounted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">true</span><span class="c1">;               // note mutable flag</span>
<span class="w">  </span><span class="nv">someAsyncOperation</span><span class="ss">()</span>.<span class="k">then</span><span class="ss">(</span><span class="nv">data</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span>{
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">isMounted</span><span class="ss">)</span><span class="w"> </span><span class="nv">setState</span><span class="ss">(</span><span class="nv">data</span><span class="ss">)</span><span class="c1">;    // add conditional check</span>
<span class="w">  </span>}<span class="ss">)</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="ss">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span>{<span class="w"> </span><span class="nv">isMounted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">false</span><span class="w"> </span>}<span class="c1">; // cleanup toggles value, if unmounted</span>
},<span class="w"> </span>[]<span class="ss">)</span><span class="c1">;                               // adjust dependencies to your needs</span>
</pre></div>

<p>Show code snippet</p>
<div class="code"><pre class="code literal-block"><span class="k">const</span><span class="w"> </span><span class="n">Parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="p">[</span><span class="n">mounted</span><span class="p">,</span><span class="w"> </span><span class="n">setMounted</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">useState</span><span class="p">(</span><span class="bp">true</span><span class="p">);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span>
<span class="w">      </span><span class="n">Parent</span><span class="p">:</span>
<span class="w">      </span><span class="o">&lt;</span><span class="n">button</span><span class="w"> </span><span class="n">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">setMounted</span><span class="p">(</span><span class="o">!</span><span class="n">mounted</span><span class="p">)}</span><span class="o">&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="n">mounted</span><span class="w"> </span><span class="err">?</span><span class="w"> </span><span class="s2">"Unmount"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Mount"</span><span class="p">}</span><span class="w"> </span><span class="n">Child</span>
<span class="w">      </span><span class="o">&lt;/</span><span class="n">button</span><span class="o">&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="n">mounted</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">&lt;</span><span class="n">Child</span><span class="w"> </span><span class="o">/&gt;</span><span class="p">}</span>
<span class="w">      </span><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>
<span class="w">        </span><span class="n">Unmount</span><span class="w"> </span><span class="n">Child</span><span class="p">,</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">still</span><span class="w"> </span><span class="n">loading</span><span class="o">.</span><span class="w"> </span><span class="n">It</span><span class="w"> </span><span class="n">won</span><span class="s1">'t set state later on,</span>
<span class="w">        </span><span class="n">so</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">triggered</span><span class="o">.</span>
<span class="w">      </span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<span class="w">    </span><span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">};</span>

<span class="k">const</span><span class="w"> </span><span class="n">Child</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="p">[</span><span class="n">state</span><span class="p">,</span><span class="w"> </span><span class="n">setState</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">useState</span><span class="p">(</span><span class="s2">"loading (4 sec)..."</span><span class="p">);</span>
<span class="w">  </span><span class="n">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">isMounted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">true</span><span class="p">;</span>
<span class="w">    </span><span class="n">fetchData</span><span class="p">();</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">isMounted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">false</span><span class="p">;</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="n">simulate</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">Web</span><span class="w"> </span><span class="n">API</span><span class="w"> </span><span class="n">fetching</span>
<span class="w">    </span><span class="n">function</span><span class="w"> </span><span class="n">fetchData</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">setTimeout</span><span class="p">(()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="o">//</span><span class="w"> </span><span class="n">drop</span><span class="w"> </span><span class="s2">"if (isMounted)"</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">trigger</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">again</span><span class="w"> </span>
<span class="w">        </span><span class="o">//</span><span class="w"> </span><span class="p">(</span><span class="n">take</span><span class="w"> </span><span class="n">IDE</span><span class="p">,</span><span class="w"> </span><span class="n">doesn</span><span class="s1">'t work with stack snippet)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isMounted</span><span class="p">)</span><span class="w"> </span><span class="n">setState</span><span class="p">(</span><span class="s2">"data fetched"</span><span class="p">)</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">"aborted setState on unmounted component"</span><span class="p">)</span>
<span class="w">      </span><span class="p">},</span><span class="w"> </span><span class="mi">4000</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[]);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span><span class="n">Child</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="n">state</span><span class="p">}</span><span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span><span class="p">;</span>
<span class="p">};</span>

<span class="n">ReactDOM</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="o">&lt;</span><span class="n">Parent</span><span class="w"> </span><span class="o">/&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">document</span><span class="o">.</span><span class="n">getElementById</span><span class="p">(</span><span class="s2">"root"</span><span class="p">));</span>


<span class="o">&lt;</span><span class="n">script</span><span class="w"> </span><span class="n">src</span><span class="o">=</span><span class="s2">"https://cdnjs.cloudflare.com/ajax/libs/react/16.13.0/umd/react.production.min.js"</span><span class="w"> </span><span class="n">integrity</span><span class="o">=</span><span class="s2">"sha256-32Gmw5rBDXyMjg/73FgpukoTZdMrxuYW7tj8adbN8z4="</span><span class="w"> </span><span class="n">crossorigin</span><span class="o">=</span><span class="s2">"anonymous"</span><span class="o">&gt;&lt;/</span><span class="n">script</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">script</span><span class="w"> </span><span class="n">src</span><span class="o">=</span><span class="s2">"https://cdnjs.cloudflare.com/ajax/libs/react-dom/16.13.0/umd/react-dom.production.min.js"</span><span class="w"> </span><span class="n">integrity</span><span class="o">=</span><span class="s2">"sha256-bjQ42ac3EN0GqK40pC9gGi/YixvKyZ24qMP/9HiGW7w="</span><span class="w"> </span><span class="n">crossorigin</span><span class="o">=</span><span class="s2">"anonymous"</span><span class="o">&gt;&lt;/</span><span class="n">script</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">div</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="s2">"root"</span><span class="o">&gt;&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">script</span><span class="o">&gt;</span><span class="k">var</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">useReducer</span><span class="p">,</span><span class="w"> </span><span class="n">useEffect</span><span class="p">,</span><span class="w"> </span><span class="n">useState</span><span class="p">,</span><span class="w"> </span><span class="n">useRef</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">React</span><span class="o">&lt;/</span><span class="n">script</span><span class="o">&gt;</span>
</pre></div>

<h4>Extension: Custom <code>useAsync</code> Hook</h4>
<p>We can encapsulate all the boilerplate into a custom Hook, that automatically
aborts async functions in case the component unmounts or dependency values
have changed before:</p>
<div class="code"><pre class="code literal-block"><span class="nv">function</span><span class="w"> </span><span class="nv">useAsync</span><span class="ss">(</span><span class="nv">asyncFn</span>,<span class="w"> </span><span class="nv">onSuccess</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">  </span><span class="nv">useEffect</span><span class="ss">(()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span>{
<span class="w">    </span><span class="nv">let</span><span class="w"> </span><span class="nv">isActive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">true</span><span class="c1">;</span>
<span class="w">    </span><span class="nv">asyncFn</span><span class="ss">()</span>.<span class="k">then</span><span class="ss">(</span><span class="nv">data</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span>{
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">isActive</span><span class="ss">)</span><span class="w"> </span><span class="nv">onSuccess</span><span class="ss">(</span><span class="nv">data</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">    </span>}<span class="ss">)</span><span class="c1">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="ss">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span>{<span class="w"> </span><span class="nv">isActive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">false</span><span class="w"> </span>}<span class="c1">;</span>
<span class="w">  </span>},<span class="w"> </span>[<span class="nv">asyncFn</span>,<span class="w"> </span><span class="nv">onSuccess</span>]<span class="ss">)</span><span class="c1">;</span>
}
</pre></div>

<p>Show code snippet</p>
<div class="code"><pre class="code literal-block"><span class="o">//</span><span class="w"> </span><span class="n">custom</span><span class="w"> </span><span class="n">Hook</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">automatic</span><span class="w"> </span><span class="n">abortion</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">unmount</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">dependency</span><span class="w"> </span><span class="n">change</span>
<span class="o">//</span><span class="w"> </span><span class="n">You</span><span class="w"> </span><span class="n">might</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="n">onFailure</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">promise</span><span class="w"> </span><span class="n">errors</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">well</span><span class="o">.</span>
<span class="n">function</span><span class="w"> </span><span class="n">useAsync</span><span class="p">(</span><span class="n">asyncFn</span><span class="p">,</span><span class="w"> </span><span class="n">onSuccess</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">isActive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">true</span><span class="p">;</span>
<span class="w">    </span><span class="n">asyncFn</span><span class="p">()</span><span class="o">.</span><span class="n">then</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isActive</span><span class="p">)</span><span class="w"> </span><span class="n">onSuccess</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="w">      </span><span class="k">else</span><span class="w"> </span><span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">"aborted setState on unmounted component"</span><span class="p">)</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">isActive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">false</span><span class="p">;</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="n">asyncFn</span><span class="p">,</span><span class="w"> </span><span class="n">onSuccess</span><span class="p">]);</span>
<span class="p">}</span>

<span class="k">const</span><span class="w"> </span><span class="n">Child</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="p">[</span><span class="n">state</span><span class="p">,</span><span class="w"> </span><span class="n">setState</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">useState</span><span class="p">(</span><span class="s2">"loading (4 sec)..."</span><span class="p">);</span>
<span class="w">  </span><span class="n">useAsync</span><span class="p">(</span><span class="n">simulateFetchData</span><span class="p">,</span><span class="w"> </span><span class="n">setState</span><span class="p">);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span><span class="n">Child</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="n">state</span><span class="p">}</span><span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">const</span><span class="w"> </span><span class="n">Parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="p">[</span><span class="n">mounted</span><span class="p">,</span><span class="w"> </span><span class="n">setMounted</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">useState</span><span class="p">(</span><span class="bp">true</span><span class="p">);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span>
<span class="w">      </span><span class="n">Parent</span><span class="p">:</span>
<span class="w">      </span><span class="o">&lt;</span><span class="n">button</span><span class="w"> </span><span class="n">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">setMounted</span><span class="p">(</span><span class="o">!</span><span class="n">mounted</span><span class="p">)}</span><span class="o">&gt;</span>
<span class="w">        </span><span class="p">{</span><span class="n">mounted</span><span class="w"> </span><span class="err">?</span><span class="w"> </span><span class="s2">"Unmount"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Mount"</span><span class="p">}</span><span class="w"> </span><span class="n">Child</span>
<span class="w">      </span><span class="o">&lt;/</span><span class="n">button</span><span class="o">&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="n">mounted</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">&lt;</span><span class="n">Child</span><span class="w"> </span><span class="o">/&gt;</span><span class="p">}</span>
<span class="w">      </span><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>
<span class="w">        </span><span class="n">Unmount</span><span class="w"> </span><span class="n">Child</span><span class="p">,</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">still</span><span class="w"> </span><span class="n">loading</span><span class="o">.</span><span class="w"> </span><span class="n">It</span><span class="w"> </span><span class="n">won</span><span class="s1">'t set state later on,</span>
<span class="w">        </span><span class="n">so</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">triggered</span><span class="o">.</span>
<span class="w">      </span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<span class="w">    </span><span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">};</span>

<span class="k">const</span><span class="w"> </span><span class="n">simulateFetchData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">Promise</span><span class="p">(</span>
<span class="w">  </span><span class="n">resolve</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">setTimeout</span><span class="p">(()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">resolve</span><span class="p">(</span><span class="s2">"data fetched"</span><span class="p">),</span><span class="w"> </span><span class="mi">4000</span><span class="p">));</span>

<span class="n">ReactDOM</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="o">&lt;</span><span class="n">Parent</span><span class="w"> </span><span class="o">/&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">document</span><span class="o">.</span><span class="n">getElementById</span><span class="p">(</span><span class="s2">"root"</span><span class="p">));</span>


<span class="o">&lt;</span><span class="n">script</span><span class="w"> </span><span class="n">src</span><span class="o">=</span><span class="s2">"https://cdnjs.cloudflare.com/ajax/libs/react/16.13.0/umd/react.production.min.js"</span><span class="w"> </span><span class="n">integrity</span><span class="o">=</span><span class="s2">"sha256-32Gmw5rBDXyMjg/73FgpukoTZdMrxuYW7tj8adbN8z4="</span><span class="w"> </span><span class="n">crossorigin</span><span class="o">=</span><span class="s2">"anonymous"</span><span class="o">&gt;&lt;/</span><span class="n">script</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">script</span><span class="w"> </span><span class="n">src</span><span class="o">=</span><span class="s2">"https://cdnjs.cloudflare.com/ajax/libs/react-dom/16.13.0/umd/react-dom.production.min.js"</span><span class="w"> </span><span class="n">integrity</span><span class="o">=</span><span class="s2">"sha256-bjQ42ac3EN0GqK40pC9gGi/YixvKyZ24qMP/9HiGW7w="</span><span class="w"> </span><span class="n">crossorigin</span><span class="o">=</span><span class="s2">"anonymous"</span><span class="o">&gt;&lt;/</span><span class="n">script</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">div</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="s2">"root"</span><span class="o">&gt;&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">script</span><span class="o">&gt;</span><span class="k">var</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">useReducer</span><span class="p">,</span><span class="w"> </span><span class="n">useEffect</span><span class="p">,</span><span class="w"> </span><span class="n">useState</span><span class="p">,</span><span class="w"> </span><span class="n">useRef</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">React</span><span class="o">&lt;/</span><span class="n">script</span><span class="o">&gt;</span>
</pre></div>

<p>More on effect cleanups: Overreacted: A Complete Guide to useEffect</p>
<p><br></p>
<h3>Suggest</h3>
<blockquote>
<p>To remove - Can't perform a React state update on an unmounted component
warning, use componentDidMount method under a condition and make false that
condition on componentWillUnmount method. For example : -</p>
</blockquote>
<div class="code"><pre class="code literal-block"><span class="k">class</span><span class="w"> </span><span class="n">Home</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="n">Component</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">_isMounted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">false</span><span class="p">;</span>

<span class="w">  </span><span class="n">constructor</span><span class="p">(</span><span class="n">props</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">super</span><span class="p">(</span><span class="n">props</span><span class="p">);</span>

<span class="w">    </span><span class="n">this</span><span class="o">.</span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">news</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">componentDidMount</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">this</span><span class="o">.</span><span class="n">_isMounted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">true</span><span class="p">;</span>

<span class="w">    </span><span class="n">ajaxVar</span>
<span class="w">      </span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'https://domain'</span><span class="p">)</span>
<span class="w">      </span><span class="o">.</span><span class="n">then</span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">_isMounted</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="n">this</span><span class="o">.</span><span class="n">setState</span><span class="p">({</span>
<span class="w">            </span><span class="n">news</span><span class="p">:</span><span class="w"> </span><span class="n">result</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">hits</span><span class="p">,</span>
<span class="w">          </span><span class="p">});</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">componentWillUnmount</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">this</span><span class="o">.</span><span class="n">_isMounted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">false</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">render</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="o">...</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/is-not-an-enclosing-class-java/" class="u-url">Is not an enclosing class Java</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/is-not-an-enclosing-class-java/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T21:16:32+08:00" itemprop="datePublished" title="2023-03-03 21:16">2023-03-03 21:16</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I'm trying to make a Tetris game and I'm getting the compiler error</p>
<blockquote>
<p><code>Shape is not an enclosing class</code></p>
</blockquote>
<p>when I try to create an object</p>
<div class="code"><pre class="code literal-block">public class Test {
    public static void main(String[] args) {
        Shape s = new Shapes.ZShape();
    }
}
</pre></div>

<p>I'm using inner classes for each shape. Here's part of my code</p>
<div class="code"><pre class="code literal-block">public class Shapes {
    class AShape {
    }
    class ZShape {
    }
}
</pre></div>

<p>What am I doing wrong ?</p>
<p><br><br></p>
<h2>Answer</h2>
<p><code>ZShape</code> is not static so it requires an instance of the outer class.</p>
<p>The simplest solution is to make ZShape and any nested class <code>static</code> if you
can.</p>
<p>I would also make any fields <code>final</code> or <code>static final</code> that you can as well.</p>
<p><br></p>
<h3>Suggest</h3>
<p>Suppose RetailerProfileModel is your Main class and RetailerPaymentModel is an
inner class within it. You can create an object of the Inner class outside the
class as follows:</p>
<div class="code"><pre class="code literal-block">RetailerProfileModel.RetailerPaymentModel paymentModel
        = new RetailerProfileModel().new RetailerPaymentModel();
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-use-jquery-with-angular/" class="u-url">How to use jQuery with Angular?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-use-jquery-with-angular/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T21:14:55+08:00" itemprop="datePublished" title="2023-03-03 21:14">2023-03-03 21:14</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Can anyone tell me, how to use <strong>jQuery</strong> with <strong>Angular</strong>?</p>
<div class="code"><pre class="code literal-block"><span class="k">class</span><span class="w"> </span><span class="n">MyComponent</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">constructor</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="o">//</span><span class="w"> </span><span class="n">how</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">DOM</span><span class="w"> </span><span class="n">element</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">here</span><span class="err">?</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p>I'm aware there are workarounds like manipulating the <em>class</em> or <em>id</em> of the
DOM element upfront, but I'm hoping for a cleaner way of doing it.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Using jQuery from Angular2 is a breeze compared to ng1. If you are using
TypeScript you could first reference jQuery typescript definition.</p>
<div class="code"><pre class="code literal-block">tsd install jquery --save
or
typings install dt~jquery --global --save
</pre></div>

<p>TypescriptDefinitions are not required since you could just use <code>any</code> as the
type for <code>$</code> or <code>jQuery</code></p>
<p>In your angular component you should reference a DOM element from the template
using <code>@ViewChild()</code> After the view has been initialized you can use the
<code>nativeElement</code> property of this object and pass to jQuery.</p>
<p>Declaring <code>$</code> (or <code>jQuery</code>) as JQueryStatic will give you a typed reference to
jQuery.</p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="p">{</span><span class="n">bootstrap</span><span class="p">}</span>    <span class="kn">from</span> <span class="s1">'@angular/platform-browser-dynamic'</span><span class="p">;</span>
<span class="kn">import</span> <span class="p">{</span><span class="n">Component</span><span class="p">,</span> <span class="n">ViewChild</span><span class="p">,</span> <span class="n">ElementRef</span><span class="p">,</span> <span class="n">AfterViewInit</span><span class="p">}</span> <span class="kn">from</span> <span class="s1">'@angular/core'</span><span class="p">;</span>
<span class="n">declare</span> <span class="n">var</span> <span class="err">$</span><span class="p">:</span><span class="n">JQueryStatic</span><span class="p">;</span>

<span class="nd">@Component</span><span class="p">({</span>
    <span class="n">selector</span><span class="p">:</span> <span class="s1">'ng-chosen'</span><span class="p">,</span>
    <span class="n">template</span><span class="p">:</span> <span class="err">`</span><span class="o">&lt;</span><span class="n">select</span> <span class="c1">#selectElem&gt;</span>
        <span class="o">&lt;</span><span class="n">option</span> <span class="o">*</span><span class="n">ngFor</span><span class="o">=</span><span class="s2">"#item of items"</span> <span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="o">=</span><span class="s2">"item"</span> <span class="p">[</span><span class="n">selected</span><span class="p">]</span><span class="o">=</span><span class="s2">"item === selectedValue"</span><span class="o">&gt;</span><span class="p">{{</span><span class="n">item</span><span class="p">}}</span> <span class="n">option</span><span class="o">&lt;/</span><span class="n">option</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="n">select</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">h4</span><span class="o">&gt;</span> <span class="p">{{</span><span class="n">selectedValue</span><span class="p">}}</span><span class="o">&lt;/</span><span class="n">h4</span><span class="o">&gt;</span><span class="err">`</span>
<span class="p">})</span>
<span class="n">export</span> <span class="k">class</span> <span class="nc">NgChosenComponent</span> <span class="n">implements</span> <span class="n">AfterViewInit</span> <span class="p">{</span>
    <span class="nd">@ViewChild</span><span class="p">(</span><span class="s1">'selectElem'</span><span class="p">)</span> <span class="n">el</span><span class="p">:</span><span class="n">ElementRef</span><span class="p">;</span>
    <span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'First'</span><span class="p">,</span> <span class="s1">'Second'</span><span class="p">,</span> <span class="s1">'Third'</span><span class="p">];</span>
    <span class="n">selectedValue</span> <span class="o">=</span> <span class="s1">'Second'</span><span class="p">;</span>

    <span class="n">ngAfterViewInit</span><span class="p">()</span> <span class="p">{</span>
        <span class="err">$</span><span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">el</span><span class="o">.</span><span class="n">nativeElement</span><span class="p">)</span>
            <span class="o">.</span><span class="n">chosen</span><span class="p">()</span>
            <span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="s1">'change'</span><span class="p">,</span> <span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="n">this</span><span class="o">.</span><span class="n">selectedValue</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">selected</span><span class="p">;</span>
            <span class="p">});</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">bootstrap</span><span class="p">(</span><span class="n">NgChosenComponent</span><span class="p">);</span>
</pre></div>

<p>This example is available on plunker: http://plnkr.co/edit/Nq9LnK?p=preview</p>
<p>tslint will complain about <code>chosen</code> not being a property on $, to fix this you
can add a definition to the JQuery interface in your custom *.d.ts file</p>
<div class="code"><pre class="code literal-block">interface JQuery {
    chosen(options?:any):JQuery;
}
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>This is what worked for me.</p>
<h3>STEP 1 - First things first</h3>
<div class="code"><pre class="code literal-block"><span class="c1">// In the console</span>
<span class="c1">// First install jQuery</span>
<span class="n">npm</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="o">--</span><span class="nb">save</span><span class="w"> </span><span class="n">jquery</span>
<span class="c1">// and jQuery Definition</span>
<span class="n">npm</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="o">-</span><span class="n">D</span><span class="w"> </span><span class="p">@</span><span class="n">types</span><span class="o">/</span><span class="n">jquery</span>
</pre></div>

<h3>STEP 2 - IMPORT</h3>
<div class="code"><pre class="code literal-block"><span class="o">//</span> <span class="n">Now</span><span class="p">,</span> <span class="n">within</span> <span class="nb">any</span> <span class="n">of</span> <span class="n">the</span> <span class="n">app</span> <span class="n">files</span> <span class="p">(</span><span class="n">ES2015</span> <span class="n">style</span><span class="p">)</span>
<span class="kn">import</span> <span class="o">*</span> <span class="k">as</span> <span class="err">$</span> <span class="kn">from</span> <span class="s1">'jquery'</span><span class="p">;</span>
<span class="o">//</span>
<span class="err">$</span><span class="p">(</span><span class="s1">'#elemId'</span><span class="p">)</span><span class="o">.</span><span class="n">width</span><span class="p">();</span>

<span class="o">//</span> <span class="n">OR</span>

<span class="o">//</span> <span class="n">CommonJS</span> <span class="n">style</span> <span class="o">-</span> <span class="n">working</span> <span class="k">with</span> <span class="s2">"require"</span>
<span class="kn">import</span> <span class="err">$</span> <span class="o">=</span> <span class="n">require</span><span class="p">(</span><span class="s1">'jquery'</span><span class="p">)</span>
<span class="o">//</span>
<span class="err">$</span><span class="p">(</span><span class="s1">'#elemId'</span><span class="p">)</span><span class="o">.</span><span class="n">width</span><span class="p">();</span>
</pre></div>

<h3>#UPDATE - <code>Feb - 2017</code>
</h3>
<p>Lately, I'm writing code with <code>ES6</code> instead of <code>typescript</code> and am able to
<code>import</code> without <code>* as $</code> in the <code>import statement</code>. This is what it looks
like now:</p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="err">$</span> <span class="kn">from</span> <span class="s1">'jquery'</span><span class="p">;</span>
<span class="o">//</span>
<span class="err">$</span><span class="p">(</span><span class="s1">'#elemId'</span><span class="p">)</span><span class="o">.</span><span class="n">width</span><span class="p">();</span>
</pre></div>

<p>Good Luck.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-2186.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-2184.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
