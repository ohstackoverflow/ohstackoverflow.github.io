<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 328) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-328.html">
<link rel="prev" href="index-329.html" type="text/html">
<link rel="next" href="index-327.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/are-https-urls-encrypted/" class="u-url">Are HTTPS URLs encrypted?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/are-https-urls-encrypted/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T04:04:34+08:00" itemprop="datePublished" title="2023-02-17 04:04">2023-02-17 04:04</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Are all URLs encrypted when using TLS/SSL (HTTPS) encryption? I would like to
know because I want all URL data to be hidden when using TLS/SSL (HTTPS).</p>
<p>If TLS/SSL gives you total URL encryption then I don't have to worry about
hiding confidential information from URLs.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Yes, the SSL connection is between the TCP layer and the HTTP layer. The
client and server first establish a secure encrypted TCP connection (via the
SSL/TLS protocol) and then the client will send the HTTP request (GET, POST,
DELETE...) over that encrypted TCP connection.</p>
<p>Note however (as also noted in the comments) that the <strong>domain name</strong> part of
the URL is sent in clear text during the first part of the TLS negotiation.
So, the domain name of the server can be sniffed. But not the rest of the URL.</p>
<p><br></p>
<h3>Suggest</h3>
<p>Since nobody provided a wire capture, here's one.<br><strong>Server Name</strong> (the domain part of the URL) is presented in the <code>ClientHello</code>
packet, in <strong>plain text</strong>.</p>
<p>The following shows a browser request to:<br><code>https://i.stack.imgur.com/path/?some=parameters&amp;go=here</code></p>
<p><img alt="ClientHello SNI" src="images/rdHZZ.png"> See this answer for more on TLS version
fields (there are 3 of them - not versions, fields that each contain a version
number!)</p>
<p>From https://www.ietf.org/rfc/rfc3546.txt:</p>
<blockquote>
<p>3.1. Server Name Indication</p>
<p><strong>[TLS] does not provide a mechanism for a client to tell a server the name
of the server it is contacting.</strong> It may be desirable for clients to provide
this information to facilitate secure connections to servers that host
multiple 'virtual' servers at a single underlying network address.</p>
<p><strong>In order to provide the server name, clients MAY include an extension of
type "server_name" in the (extended) client hello.</strong></p>
</blockquote>
<h4>In short:</h4>
<ul>
<li>
<p>FQDN (the domain part of the URL) <strong>MAY</strong> be transmitted <strong>in clear</strong> inside the <code>ClientHello</code> packet if SNI extension is used</p>
</li>
<li>
<p>The rest of the URL (<code>/path/?some=parameters&amp;go=here</code>) has no business being inside <code>ClientHello</code> since the request URL is a HTTP thing (OSI Layer 7), therefore it will never show up in a TLS handshake (Layer 4 or 5). That will come later on in a <code>GET /path/?some=parameters&amp;go=here HTTP/1.1</code> HTTP request, <strong>AFTER</strong> the <strong>secure</strong> TLS channel is established.</p>
</li>
</ul>
<h3>EXECUTIVE SUMMARY</h3>
<p>Domain name MAY be transmitted in clear (if SNI extension is used in the TLS
handshake) but URL (path and parameters) is always encrypted.</p>
<h3>MARCH 2019 UPDATE</h3>
<p>Thank you carlin.scott for bringing this one up.</p>
<p>The payload in the SNI extension can now be encrypted via this draft RFC
proposal. This capability only exists in TLS 1.3 (as an option and it's up to
both ends to implement it) and there is no backwards compatibility with TLS
1.2 and below.</p>
<p>CloudFlare is doing it and you can read more about the internals here — If the
chicken must come before the egg, where do you put the chicken?</p>
<p>In practice this means that instead of transmitting the FQDN in plain text
(like the Wireshark capture shows), it is now encrypted.</p>
<p><strong>NOTE:</strong> This addresses the privacy aspect more than the security one since a
reverse DNS lookup MAY reveal the intended destination host anyway.</p>
<h3>SEPTEMBER 2020 UPDATE</h3>
<p>There's now a draft RFC for encrypting the entire Client Hello message, not
just the SNI part: https://datatracker.ietf.org/doc/draft-ietf-tls-
esni/?include_text=1</p>
<p>At the time of writing this browser support is VERY limited.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-do-i-collapse-sections-of-code-in-visual-studio-code-for-windows/" class="u-url">How do I collapse sections of code in Visual Studio Code for Windows?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-do-i-collapse-sections-of-code-in-visual-studio-code-for-windows/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T04:04:04+08:00" itemprop="datePublished" title="2023-02-17 04:04">2023-02-17 04:04</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>How do I fold or collapse sections of code in Visual Studio Code?</p>
<p>Is this feature supported?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Folding has been rolled out and is now implemented since Visual Studio Code
version 0.10.11. There are these keyboard shortcuts available:</p>
<ul>
<li>
<p><strong>Fold</strong> folds the innermost uncollapsed region at the cursor:</p>
<ul>
<li>
<code>Ctrl</code> + <code>Shift</code> + <code>[</code> on Windows and Linux</li>
<li>
<code>⌥</code> + <code>⌘</code> + <code>[</code> on macOS</li>
<li>
<p><strong>Unfold</strong> unfolds the collapsed region at the cursor:</p>
</li>
<li>
<p><code>Ctrl</code> + <code>Shift</code> + <code>]</code> on Windows and Linux</p>
</li>
<li>
<code>⌥</code> + <code>⌘</code> + <code>]</code> on macOS</li>
<li>
<p><strong>Fold All</strong> folds all regions in the editor:</p>
</li>
<li>
<p><code>Ctrl</code> + <code>K</code>, <code>Ctrl</code> + <code>0</code> (zero) on Windows and Linux</p>
</li>
<li>
<code>⌘</code> + <code>K</code>, <code>⌘</code> +<code>0</code> (zero) on macOS</li>
<li>
<p><strong>Unfold All</strong> unfolds all regions in the editor:</p>
</li>
<li>
<p><code>Ctrl</code> + <code>K</code>, <code>Ctrl</code> + <code>J</code> on Windows and Linux</p>
</li>
<li>
<code>⌘</code> + <code>K</code>, <code>⌘</code> + <code>J</code> on macOS</li>
</ul>
</li>
</ul>
<hr>
<p><strong>References:</strong> https://code.visualstudio.com/docs/getstarted/keybindings</p>
<p><br></p>
<h3>Suggest</h3>
<p>As of Visual Studio Code version 1.12.0, April 2017, see Basic Editing &gt;
Folding section in the docs.</p>
<p>The default keys are:</p>
<blockquote>
<p>Fold All: <code>CTRL</code>+<code>K</code>, <code>CTRL</code>+<code>0</code> (zero)</p>
<p>Fold Level [n]: <code>CTRL</code>+<code>K</code>, <code>CTRL</code>+<code>[n]</code>*</p>
<p>Unfold All: <code>CTRL</code>+<code>K</code>, <code>CTRL</code>+<code>J</code></p>
<p>Fold Region: <code>CTRL</code>+<code>K</code>, <code>CTRL</code>+<code>[</code></p>
<p>Unfold Region: <code>CTRL</code>+<code>K</code>, <code>CTRL</code>+<code>]</code></p>
</blockquote>
<p>*Fold Level: to fold all but the most outer classes, try <code>CTRL</code>+<code>K</code>, <code>CTRL</code>+<code>1</code></p>
<p><em>Macs: use<code>⌘</code> instead of <code>CTRL</code> (thanks Prajeet)</em></p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-overcome-datetime-datetime-not-json-serializable/" class="u-url">How to overcome "datetime.datetime not JSON serializable"?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-overcome-datetime-datetime-not-json-serializable/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T04:03:10+08:00" itemprop="datePublished" title="2023-02-17 04:03">2023-02-17 04:03</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I have a basic dict as follows:</p>
<div class="code"><pre class="code literal-block">sample = {}
sample['title'] = "String"
sample['somedate'] = somedatetimehere
</pre></div>

<p>When I try to do <code>jsonify(sample)</code> I get:</p>
<div class="code"><pre class="code literal-block"><span class="n">TypeError</span><span class="o">:</span><span class="w"> </span><span class="n">datetime</span><span class="o">.</span><span class="na">datetime</span><span class="o">(</span><span class="mi">2012</span><span class="o">,</span><span class="w"> </span><span class="mi">8</span><span class="o">,</span><span class="w"> </span><span class="mi">8</span><span class="o">,</span><span class="w"> </span><span class="mi">21</span><span class="o">,</span><span class="w"> </span><span class="mi">46</span><span class="o">,</span><span class="w"> </span><span class="mi">24</span><span class="o">,</span><span class="w"> </span><span class="mi">862000</span><span class="o">)</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">JSON</span><span class="w"> </span><span class="n">serializable</span>
</pre></div>

<p>What can I do such that my dictionary sample can overcome the error above?</p>
<p><strong>Note:</strong> Though it may not be relevant, the dictionaries are generated from
the retrieval of records out of <code>mongodb</code> where when I print out
<code>str(sample['somedate'])</code>, the output is <code>2012-08-08 21:46:24.862000</code>.</p>
<p><br><br></p>
<h2>Answer</h2>
<h2>Updated for 2018</h2>
<p>The original answer accommodated the way MongoDB "date" fields were
represented as:</p>
<p><code>{"$date": 1506816000000}</code></p>
<p>If you want a generic Python solution for serializing <code>datetime</code> to json,
check out @jjmontes' answer for a quick solution which requires no
dependencies.</p>
<hr>
<p>As you are using mongoengine (per comments) and pymongo is a dependency,
pymongo has built-in utilities to help with json serialization:<br>
http://api.mongodb.org/python/1.10.1/api/bson/json_util.html</p>
<p>Example usage (serialization):</p>
<div class="code"><pre class="code literal-block"><span class="kn">from</span> <span class="nn">bson</span> <span class="kn">import</span> <span class="n">json_util</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">anObject</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">json_util</span><span class="o">.</span><span class="n">default</span><span class="p">)</span>
</pre></div>

<p>Example usage (deserialization):</p>
<div class="code"><pre class="code literal-block"><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">aJsonString</span><span class="p">,</span><span class="w"> </span><span class="n">object_hook</span><span class="o">=</span><span class="n">json_util</span><span class="o">.</span><span class="n">object_hook</span><span class="p">)</span>
</pre></div>

<hr>
<h3>Django</h3>
<p>Django provides a native <code>DjangoJSONEncoder</code> serializer that deals with this
kind of properly.</p>
<p>See
https://docs.djangoproject.com/en/dev/topics/serialization/#djangojsonencoder</p>
<div class="code"><pre class="code literal-block"><span class="kn">from</span> <span class="nn">django.core.serializers.json</span> <span class="kn">import</span> <span class="n">DjangoJSONEncoder</span>

<span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span>
  <span class="n">item</span><span class="p">,</span>
  <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
  <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
  <span class="bp">cls</span><span class="o">=</span><span class="n">DjangoJSONEncoder</span>
<span class="p">)</span>
</pre></div>

<p>One difference I've noticed between <code>DjangoJSONEncoder</code> and using a custom
<code>default</code> like this:</p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="k">def</span> <span class="nf">default</span><span class="p">(</span><span class="n">o</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">)):</span>
        <span class="k">return</span> <span class="n">o</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>

<span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span>
  <span class="n">item</span><span class="p">,</span>
  <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
  <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
  <span class="n">default</span><span class="o">=</span><span class="n">default</span>
<span class="p">)</span>
</pre></div>

<p>Is that Django strips a bit of the data:</p>
<div class="code"><pre class="code literal-block"> "last_login": "2018-08-03T10:51:42.990", # DjangoJSONEncoder 
 "last_login": "2018-08-03T10:51:42.990239", # default
</pre></div>

<p>So, you may need to be careful about that in some cases.</p>
<p><br></p>
<h3>Suggest</h3>
<p>Building on other answers, a simple solution based on a specific serializer
that just converts <code>datetime.datetime</code> and <code>datetime.date</code> objects to strings.</p>
<div class="code"><pre class="code literal-block"><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span><span class="p">,</span> <span class="n">datetime</span>

<span class="k">def</span> <span class="nf">json_serial</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""JSON serializer for objects not serializable by default json code"""</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="p">(</span><span class="n">datetime</span><span class="p">,</span> <span class="n">date</span><span class="p">)):</span>
        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
    <span class="k">raise</span> <span class="ne">TypeError</span> <span class="p">(</span><span class="s2">"Type </span><span class="si">%s</span><span class="s2"> not serializable"</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
</pre></div>

<p>As seen, the code just checks to find out if object is of class
<code>datetime.datetime</code> or <code>datetime.date</code>, and then uses <code>.isoformat()</code> to
produce a serialized version of it, according to ISO 8601 format, YYYY-MM-
DDTHH:MM:SS (which is easily decoded by JavaScript). If more complex
serialized representations are sought, other code could be used instead of
str() (see other answers to this question for examples). The code ends by
raising an exception, to deal with the case it is called with a non-
serializable type.</p>
<p>This json_serial function can be used as follows:</p>
<div class="code"><pre class="code literal-block"><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">json</span> <span class="kn">import</span> <span class="n">dumps</span>

<span class="nb">print</span> <span class="n">dumps</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span> <span class="n">default</span><span class="o">=</span><span class="n">json_serial</span><span class="p">)</span>
</pre></div>

<p>The details about how the default parameter to json.dumps works can be found
in Section Basic Usage of the json module documentation.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-329.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-327.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
