<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 2520) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-2520.html">
<link rel="prev" href="index-2521.html" type="text/html">
<link rel="next" href="index-2519.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/x-does-not-implement-y-method-has-a-pointer-receiver/" class="u-url">X does not implement Y (... method has a pointer receiver)</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/x-does-not-implement-y-method-has-a-pointer-receiver/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T22:13:10+08:00" itemprop="datePublished" title="2023-03-04 22:13">2023-03-04 22:13</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>There are already several Q&amp;As on this " <em>X does not implement Y (... method
has a pointer receiver)</em> " thing, but to me, they seems to be talking about
different things, and not applying to my specific case.</p>
<p>So, instead of making the question very specific, I'm making it broad and
abstract -- Seems like there are several different cases that can make this
error happen, can someone summary it up please?</p>
<p>I.e., how to avoid the problem, and if it occurs, what are the possibilities?
Thx.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>This compile-time error arises when you try to assign or pass (or convert) a
<em>concrete</em> type to an interface type; and the type itself does not implement
the interface, only a <em>pointer to the type</em>.</p>
<p><strong>Short summary:</strong> An assignment to a variable of interface type is valid if
the value being assigned implements the interface it is assigned to. It
implements it if its method set is a superset of the interface. The method set
of pointer types includes methods with <em>both</em> pointer and non-pointer
receiver. The method set of non-pointer types <em>only</em> includes methods with
non-pointer receiver.</p>
<p>Let's see an example:</p>
<div class="code"><pre class="code literal-block"><span class="n">type</span><span class="w"> </span><span class="n">Stringer</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nb nb-Type">String</span><span class="p">()</span><span class="w"> </span><span class="n">string</span>
<span class="p">}</span>

<span class="n">type</span><span class="w"> </span><span class="n">MyType</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">value</span><span class="w"> </span><span class="n">string</span>
<span class="p">}</span>

<span class="k">func</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">*</span><span class="n">MyType</span><span class="p">)</span><span class="w"> </span><span class="nb nb-Type">String</span><span class="p">()</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">m</span><span class="o">.</span><span class="n">value</span><span class="w"> </span><span class="p">}</span>
</pre></div>

<p>The <code>Stringer</code> interface type has one method only: <code>String()</code>. Any value that
is stored in an interface value <code>Stringer</code> must have this method. We also
created a <code>MyType</code>, and we created a method <code>MyType.String()</code> with <strong>pointer</strong>
receiver. This means the <code>String()</code> method is in the method set of the
<code>*MyType</code> type, but not in that of <code>MyType</code>.</p>
<p>When we attempt to assign a value of <code>MyType</code> to a variable of type
<code>Stringer</code>, we get the error in question:</p>
<div class="code"><pre class="code literal-block"><span class="n">m</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="n">MyType</span><span class="p">{</span><span class="n">value</span><span class="p">:</span><span class="w"> </span><span class="s2">"something"</span><span class="p">}</span>

<span class="k">var</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="n">Stringer</span>
<span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">cannot</span><span class="w"> </span><span class="n">use</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="p">(</span><span class="n">type</span><span class="w"> </span><span class="n">MyType</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">Stringer</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">assignment</span><span class="p">:</span>
<span class="w">      </span><span class="o">//</span><span class="w">   </span><span class="n">MyType</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">implement</span><span class="w"> </span><span class="n">Stringer</span><span class="w"> </span><span class="p">(</span><span class="nb nb-Type">String</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">pointer</span><span class="w"> </span><span class="n">receiver</span><span class="p">)</span>
</pre></div>

<p>But everything is ok if we try to assign a value of type <code>*MyType</code> to
<code>Stringer</code>:</p>
<div class="code"><pre class="code literal-block">s = &amp;m
fmt.Println(s)
</pre></div>

<p>And we get the expected outcome (try it on the Go Playground):</p>
<div class="code"><pre class="code literal-block">something
</pre></div>

<p><strong>So the requirements to get this compile-time error:</strong></p>
<ul>
<li>A value of <em>non-pointer</em> concrete type being assigned (or passed or converted)</li>
<li>An interface type being assigned to (or passed to, or converted to)</li>
<li>The concrete type has the required method of the interface, but with a <em>pointer receiver</em>
</li>
</ul>
<p><strong>Possibilities to resolve the issue:</strong></p>
<ul>
<li>A pointer to the value must be used, whose method set will include the method with the pointer receiver</li>
<li>Or the receiver type must be changed to <em>non-pointer</em> , so the method set of the non-pointer concrete type will also contain the method (and thus satisfy the interface). This may or may not be viable, as if the method has to modify the value, a non-pointer receiver is not an option.</li>
</ul>
<h3>Structs and embedding</h3>
<p>When using structs and embedding, often it's not "you" that implement an
interface (provide a method implementation), but a type you embed in your
<code>struct</code>. Like in this example:</p>
<div class="code"><pre class="code literal-block"><span class="n">type</span><span class="w"> </span><span class="n">MyType2</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">MyType</span>
<span class="p">}</span>

<span class="n">m</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="n">MyType</span><span class="p">{</span><span class="n">value</span><span class="p">:</span><span class="w"> </span><span class="s2">"something"</span><span class="p">}</span>
<span class="n">m2</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="n">MyType2</span><span class="p">{</span><span class="n">MyType</span><span class="p">:</span><span class="w"> </span><span class="n">m</span><span class="p">}</span>

<span class="k">var</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="n">Stringer</span>
<span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m2</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">Compile</span><span class="o">-</span><span class="n">time</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">again</span>
</pre></div>

<p>Again, compile-time error, because the method set of <code>MyType2</code> does not
contain the <code>String()</code> method of the embedded <code>MyType</code>, only the method set of
<code>*MyType2</code>, so the following works (try it on the Go Playground):</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="n">Stringer</span>
<span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">m2</span>
</pre></div>

<p>We can also make it work, if we embed <code>*MyType</code> and using only a <em>non-pointer</em>
<code>MyType2</code> (try it on the Go Playground):</p>
<div class="code"><pre class="code literal-block"><span class="n">type</span><span class="w"> </span><span class="n">MyType2</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="o">*</span><span class="n">MyType</span>
<span class="p">}</span>

<span class="n">m</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="n">MyType</span><span class="p">{</span><span class="n">value</span><span class="p">:</span><span class="w"> </span><span class="s2">"something"</span><span class="p">}</span>
<span class="n">m2</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="n">MyType2</span><span class="p">{</span><span class="n">MyType</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="n">m</span><span class="p">}</span>

<span class="k">var</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="n">Stringer</span>
<span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m2</span>
</pre></div>

<p>Also, whatever we embed (either <code>MyType</code> or <code>*MyType</code>), if we use a pointer
<code>*MyType2</code>, it will always work (try it on the Go Playground):</p>
<div class="code"><pre class="code literal-block"><span class="n">type</span><span class="w"> </span><span class="n">MyType2</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="o">*</span><span class="n">MyType</span>
<span class="p">}</span>

<span class="n">m</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="n">MyType</span><span class="p">{</span><span class="n">value</span><span class="p">:</span><span class="w"> </span><span class="s2">"something"</span><span class="p">}</span>
<span class="n">m2</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="n">MyType2</span><span class="p">{</span><span class="n">MyType</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="n">m</span><span class="p">}</span>

<span class="k">var</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="n">Stringer</span>
<span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">m2</span>
</pre></div>

<p>Relevant section from the spec (from section Struct types):</p>
<blockquote>
<p>Given a struct type <code>S</code> and a type named <code>T</code>, promoted methods are included
in the method set of the struct as follows:</p>
<ul>
<li>If <code>S</code> contains an anonymous field <code>T</code>, the method sets of <code>S</code> and <code>*S</code>
both include promoted methods with receiver <code>T</code>. The method set of <code>*S</code> also
includes promoted methods with receiver <code>*T</code>.</li>
<li>If <code>S</code> contains an anonymous field <code>*T</code>, the method sets of <code>S</code> and <code>*S</code>
both include promoted methods with receiver <code>T</code> or <code>*T</code>.
</li>
</ul>
</blockquote>
<p>So in other words: if we embed a non-pointer type, the method set of the non-
pointer embedder only gets the methods with non-pointer receivers (from the
embedded type).</p>
<p>If we embed a pointer type, the method set of the non-pointer embedder gets
methods with both pointer and non-pointer receivers (from the embedded type).</p>
<p>If we use a pointer value to the embedder, regardless of whether the embedded
type is pointer or not, the method set of the pointer to the embedder always
gets methods with both the pointer and non-pointer receivers (from the
embedded type).</p>
<p><strong>Note:</strong></p>
<p>There is a very similar case, namely when you have an interface value which
wraps a value of <code>MyType</code>, and you try to type assert another interface value
from it, <code>Stringer</code>. In this case the assertion will not hold for the reasons
described above, but we get a slightly different runtime-error:</p>
<div class="code"><pre class="code literal-block"><span class="n">m</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="n">MyType</span><span class="p">{</span><span class="n">value</span><span class="p">:</span><span class="w"> </span><span class="s2">"something"</span><span class="p">}</span>

<span class="k">var</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="n">interface</span><span class="p">{}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span>
<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="p">(</span><span class="n">Stringer</span><span class="p">))</span>
</pre></div>

<p>Runtime panic (try it on the Go Playground):</p>
<div class="code"><pre class="code literal-block"><span class="n">panic</span><span class="o">:</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="n">conversion</span><span class="o">:</span><span class="w"> </span><span class="n">main</span><span class="o">.</span><span class="na">MyType</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">main</span><span class="o">.</span><span class="na">Stringer</span><span class="o">:</span>
<span class="w">    </span><span class="n">missing</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="n">String</span>
</pre></div>

<p>Attempting to convert instead of type assert, we get the compile-time error
we're talking about:</p>
<div class="code"><pre class="code literal-block"><span class="nv">m</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nv">MyType</span><span class="p">{</span><span class="nv">value</span><span class="o">:</span><span class="w"> </span><span class="s">"something"</span><span class="p">}</span>

<span class="nv">fmt</span><span class="o">.</span><span class="nf">Println</span><span class="p">(</span><span class="nf">Stringer</span><span class="p">(</span><span class="nv">m</span><span class="p">))</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>To keep it short and simple, let say you have a Loader interface and a
WebLoader that implements this interface.</p>
<div class="code"><pre class="code literal-block"><span class="n">package</span> <span class="n">main</span>

<span class="kn">import</span> <span class="s2">"fmt"</span>

<span class="o">//</span> <span class="n">Loader</span> <span class="n">defines</span> <span class="n">a</span> <span class="n">content</span> <span class="n">loader</span>
<span class="nb">type</span> <span class="n">Loader</span> <span class="n">interface</span> <span class="p">{</span>
    <span class="n">load</span><span class="p">(</span><span class="n">src</span> <span class="n">string</span><span class="p">)</span> <span class="n">string</span>
<span class="p">}</span>

<span class="o">//</span> <span class="n">WebLoader</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">web</span> <span class="n">content</span> <span class="n">loader</span>
<span class="nb">type</span> <span class="n">WebLoader</span> <span class="n">struct</span><span class="p">{}</span>

<span class="o">//</span> <span class="n">load</span> <span class="n">loads</span> <span class="n">the</span> <span class="n">content</span> <span class="n">of</span> <span class="n">a</span> <span class="n">page</span>
<span class="n">func</span> <span class="p">(</span><span class="n">w</span> <span class="o">*</span><span class="n">WebLoader</span><span class="p">)</span> <span class="n">load</span><span class="p">(</span><span class="n">src</span> <span class="n">string</span><span class="p">)</span> <span class="n">string</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Sprintf</span><span class="p">(</span><span class="s2">"I loaded this page </span><span class="si">%s</span><span class="s2">"</span><span class="p">,</span> <span class="n">src</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">webLoader</span> <span class="o">:=</span> <span class="n">WebLoader</span><span class="p">{}</span>
    <span class="n">loadContent</span><span class="p">(</span><span class="n">webLoader</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">func</span> <span class="n">loadContent</span><span class="p">(</span><span class="n">loader</span> <span class="n">Loader</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">loader</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">"google.com"</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>

<p>The above code will give you this compile time error</p>
<blockquote>
<p>./main.go:20:13: cannot use webLoader (type WebLoader) as type Loader in
argument to loadContent: WebLoader does not implement Loader (Load method
has pointer receiver)</p>
</blockquote>
<p>To fix it you only need to change <code>webLoader := WebLoader{}</code> to following:</p>
<div class="code"><pre class="code literal-block"><span class="nv">webLoader</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span>&amp;<span class="nv">WebLoader</span><span class="p">{}</span>
</pre></div>

<p>Why this will fix the issue? Because you defined this function <code>func (w
*WebLoader) Load</code> to accept a pointer receiver. For more explanation please
read @icza and @karora answers</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/are-there-any-standard-exit-status-codes-in-linux/" class="u-url">Are there any standard exit status codes in Linux?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/are-there-any-standard-exit-status-codes-in-linux/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T22:11:47+08:00" itemprop="datePublished" title="2023-03-04 22:11">2023-03-04 22:11</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>A process is considered to have completed correctly in Linux if its exit
status was 0.</p>
<p>I've seen that segmentation faults often result in an exit status of 11,
though I don't know if this is simply the convention where I work (the
applications that failed like that have all been internal) or a standard.</p>
<p>Are there standard exit codes for processes in Linux?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>8 bits of the return code and 8 bits of the number of the killing signal are
mixed into a single value on the return from <code>wait(2)</code> &amp; co..</p>
<div class="code"><pre class="code literal-block"><span class="c1">#include &lt;stdio.h&gt;</span>
<span class="c1">#include &lt;stdlib.h&gt;</span>
<span class="c1">#include &lt;sys/types.h&gt;</span>
<span class="c1">#include &lt;sys/wait.h&gt;</span>
<span class="c1">#include &lt;unistd.h&gt;</span>
<span class="c1">#include &lt;signal.h&gt;</span>

<span class="nb nb-Type">int</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">status</span><span class="p">;</span>

<span class="w">    </span><span class="n">pid_t</span><span class="w"> </span><span class="n">child</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fork</span><span class="p">();</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">child</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">        </span><span class="n">exit</span><span class="p">(</span><span class="mi">42</span><span class="p">);</span>
<span class="w">    </span><span class="n">waitpid</span><span class="p">(</span><span class="n">child</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">WIFEXITED</span><span class="p">(</span><span class="n">status</span><span class="p">))</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s2">"first child exited with </span><span class="si">%u</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span><span class="w"> </span><span class="n">WEXITSTATUS</span><span class="p">(</span><span class="n">status</span><span class="p">));</span>
<span class="w">    </span><span class="o">/*</span><span class="w"> </span><span class="nb">prints</span><span class="p">:</span><span class="w"> </span><span class="s2">"first child exited with 42"</span><span class="w"> </span><span class="o">*/</span>

<span class="w">    </span><span class="n">child</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fork</span><span class="p">();</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">child</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">        </span><span class="n">kill</span><span class="p">(</span><span class="n">getpid</span><span class="p">(),</span><span class="w"> </span><span class="n">SIGSEGV</span><span class="p">);</span>
<span class="w">    </span><span class="n">waitpid</span><span class="p">(</span><span class="n">child</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">WIFSIGNALED</span><span class="p">(</span><span class="n">status</span><span class="p">))</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s2">"second child died with </span><span class="si">%u</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span><span class="w"> </span><span class="n">WTERMSIG</span><span class="p">(</span><span class="n">status</span><span class="p">));</span>
<span class="w">    </span><span class="o">/*</span><span class="w"> </span><span class="nb">prints</span><span class="p">:</span><span class="w"> </span><span class="s2">"second child died with 11"</span><span class="w"> </span><span class="o">*/</span>
<span class="p">}</span>
</pre></div>

<p>How are you determining the exit status? Traditionally, the shell only stores
an 8-bit return code, but sets the high bit if the process was abnormally
terminated.</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span>sh<span class="w"> </span>-c<span class="w"> </span><span class="s1">'exit 42'</span><span class="p">;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$?</span>
<span class="m">42</span>
$<span class="w"> </span>sh<span class="w"> </span>-c<span class="w"> </span><span class="s1">'kill -SEGV $$'</span><span class="p">;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$?</span>
Segmentation<span class="w"> </span>fault
<span class="m">139</span>
$<span class="w"> </span>expr<span class="w"> </span><span class="m">139</span><span class="w"> </span>-<span class="w"> </span><span class="m">128</span>
<span class="m">11</span>
</pre></div>

<p>If you're seeing anything other than this, then the program probably has a
<code>SIGSEGV</code> signal handler which then calls <code>exit</code> normally, so it isn't
actually getting killed by the signal. (Programs can chose to handle any
signals aside from <code>SIGKILL</code> and <code>SIGSTOP</code>.)</p>
<p><br></p>
<h3>Suggest</h3>
<p>8 bits of the return code and 8 bits of the number of the killing signal are
mixed into a single value on the return from <code>wait(2)</code> &amp; co..</p>
<div class="code"><pre class="code literal-block"><span class="c1">#include &lt;stdio.h&gt;</span>
<span class="c1">#include &lt;stdlib.h&gt;</span>
<span class="c1">#include &lt;sys/types.h&gt;</span>
<span class="c1">#include &lt;sys/wait.h&gt;</span>
<span class="c1">#include &lt;unistd.h&gt;</span>
<span class="c1">#include &lt;signal.h&gt;</span>

<span class="nb nb-Type">int</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">status</span><span class="p">;</span>

<span class="w">    </span><span class="n">pid_t</span><span class="w"> </span><span class="n">child</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fork</span><span class="p">();</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">child</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">        </span><span class="n">exit</span><span class="p">(</span><span class="mi">42</span><span class="p">);</span>
<span class="w">    </span><span class="n">waitpid</span><span class="p">(</span><span class="n">child</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">WIFEXITED</span><span class="p">(</span><span class="n">status</span><span class="p">))</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s2">"first child exited with </span><span class="si">%u</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span><span class="w"> </span><span class="n">WEXITSTATUS</span><span class="p">(</span><span class="n">status</span><span class="p">));</span>
<span class="w">    </span><span class="o">/*</span><span class="w"> </span><span class="nb">prints</span><span class="p">:</span><span class="w"> </span><span class="s2">"first child exited with 42"</span><span class="w"> </span><span class="o">*/</span>

<span class="w">    </span><span class="n">child</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fork</span><span class="p">();</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">child</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">        </span><span class="n">kill</span><span class="p">(</span><span class="n">getpid</span><span class="p">(),</span><span class="w"> </span><span class="n">SIGSEGV</span><span class="p">);</span>
<span class="w">    </span><span class="n">waitpid</span><span class="p">(</span><span class="n">child</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">WIFSIGNALED</span><span class="p">(</span><span class="n">status</span><span class="p">))</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s2">"second child died with </span><span class="si">%u</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span><span class="w"> </span><span class="n">WTERMSIG</span><span class="p">(</span><span class="n">status</span><span class="p">));</span>
<span class="w">    </span><span class="o">/*</span><span class="w"> </span><span class="nb">prints</span><span class="p">:</span><span class="w"> </span><span class="s2">"second child died with 11"</span><span class="w"> </span><span class="o">*/</span>
<span class="p">}</span>
</pre></div>

<p>How are you determining the exit status? Traditionally, the shell only stores
an 8-bit return code, but sets the high bit if the process was abnormally
terminated.</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span>sh<span class="w"> </span>-c<span class="w"> </span><span class="s1">'exit 42'</span><span class="p">;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$?</span>
<span class="m">42</span>
$<span class="w"> </span>sh<span class="w"> </span>-c<span class="w"> </span><span class="s1">'kill -SEGV $$'</span><span class="p">;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$?</span>
Segmentation<span class="w"> </span>fault
<span class="m">139</span>
$<span class="w"> </span>expr<span class="w"> </span><span class="m">139</span><span class="w"> </span>-<span class="w"> </span><span class="m">128</span>
<span class="m">11</span>
</pre></div>

<p>If you're seeing anything other than this, then the program probably has a
<code>SIGSEGV</code> signal handler which then calls <code>exit</code> normally, so it isn't
actually getting killed by the signal. (Programs can chose to handle any
signals aside from <code>SIGKILL</code> and <code>SIGSTOP</code>.)</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/what-is-the-difference-between-the-and-or-operators/" class="u-url">What is the difference between the | and || or operators?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/what-is-the-difference-between-the-and-or-operators/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T22:10:15+08:00" itemprop="datePublished" title="2023-03-04 22:10">2023-03-04 22:10</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I have always used <code>||</code> (two pipes) in OR expressions, both in C# and PHP.
Occasionally I see a single pipe used: <code>|</code>. What is the difference between
those two usages? Are there any caveats when using one over the other or are
they interchangeable?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Just like the <code>&amp;</code> and <code>&amp;&amp;</code> operator, the double Operator is a "short-circuit"
operator.</p>
<p>For example:</p>
<div class="code"><pre class="code literal-block"><span class="k">if</span><span class="ss">(</span><span class="nv">condition1</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nv">condition2</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nv">condition3</span><span class="ss">)</span>
</pre></div>

<p>If condition1 is true, condition 2 and 3 will NOT be checked.</p>
<div class="code"><pre class="code literal-block"><span class="k">if</span><span class="ss">(</span><span class="nv">condition1</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nv">condition2</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nv">condition3</span><span class="ss">)</span>
</pre></div>

<p>This will check conditions 2 and 3, even if 1 is already true. As your
conditions can be quite expensive functions, you can get a good performance
boost by using them.</p>
<p>There is one big caveat, NullReferences or similar problems. For example:</p>
<div class="code"><pre class="code literal-block"><span class="k">if</span><span class="ss">(</span><span class="nv">class</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nv">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nv">class</span>.<span class="nv">someVar</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">20</span><span class="ss">)</span>
</pre></div>

<p>If class is null, the if-statement will stop after <code>class != null</code> is false.
If you only use &amp;, it will try to check <code>class.someVar</code> and you get a nice
<code>NullReferenceException</code>. With the Or-Operator that may not be that much of a
trap as it's unlikely that you trigger something bad, but it's something to
keep in mind.</p>
<p>No one ever uses the single <code>&amp;</code> or <code>|</code> operators though, unless you have a
design where each condition is a function that HAS to be executed. Sounds like
a design smell, but sometimes (rarely) it's a clean way to do stuff. The <code>&amp;</code>
operator does "run these 3 functions, and if one of them returns false,
execute the else block", while the <code>|</code> does "only run the else block if none
return false" - can be useful, but as said, often it's a design smell.</p>
<p>There is a Second use of the <code>|</code> and <code>&amp;</code> operator though: Bitwise Operations.</p>
<p><br></p>
<h3>Suggest</h3>
<p>|| is the logical OR operator. It sounds like you basically know what that is.
It's used in conditional statements such as if, while, etc.</p>
<div class="code"><pre class="code literal-block">condition1 || condition2
</pre></div>

<p>Evaluates to true if either condition1 OR condition2 is true.</p>
<p>| is the bitwise OR operator. It's used to operate on two numbers. You look at
each bit of each number individually and, if one of the bits is 1 in at least
one of the numbers, then the resulting bit will be 1 also. Here are a few
examples:</p>
<div class="code"><pre class="code literal-block">A = 01010101
B = 10101010
A | B = 11111111

A = 00000001
B = 00010000
A | B = 00010001

A = 10001011
B = 00101100

A | B = 10101111
</pre></div>

<p>Hopefully that makes sense.</p>
<p>So to answer the last two questions, I wouldn't say there are any caveats
besides "know the difference between the two operators." They're not
interchangeable because they do two completely different things.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-2521.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-2519.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
