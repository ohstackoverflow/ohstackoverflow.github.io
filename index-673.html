<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 673) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-673.html">
<link rel="prev" href="index-674.html" type="text/html">
<link rel="next" href="index-672.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-can-i-match-anything-up-until-this-sequence-of-characters-in-a-regular-expression/" class="u-url">How can I match "anything up until this sequence of characters" in a regular expression?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-can-i-match-anything-up-until-this-sequence-of-characters-in-a-regular-expression/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T12:57:32+08:00" itemprop="datePublished" title="2023-02-17 12:57">2023-02-17 12:57</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Take this regular expression: <code>/^[^abc]/</code>. This will match any single
character at the beginning of a string, except <em>a</em> , <em>b</em> , or <em>c</em>.</p>
<p>If you add a <code>*</code> after it – <code>/^[^abc]*/</code> – the regular expression will
continue to add each subsequent character to the result, until it meets either
an <code>a</code>, <strong>or</strong> <code>b</code>, <strong>or</strong> <code>c</code>.</p>
<p>For example, with the source string <code>"qwerty qwerty whatever abc hello"</code>, the
expression will match up to <code>"qwerty qwerty wh"</code>.</p>
<p>But what if I wanted the matching string to be <code>"qwerty qwerty whatever "</code>?</p>
<p>In other words, how can I match everything up to (but not including) the
<em>exact sequence</em> <code>"abc"</code>?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>You didn't specify which flavor of regex you're using, but this will work in
any of the most popular ones that can be considered "complete".</p>
<div class="code"><pre class="code literal-block">/.+?(?=abc)/
</pre></div>

<h4>How it works</h4>
<p>The <code>.+?</code> part is the un-greedy version of <code>.+</code> (one or more of anything).
When we use <code>.+</code>, the engine will basically match everything. Then, if there
is something else in the regex it will go back in steps trying to match the
following part. This is the <strong>greedy</strong> behavior, meaning <strong>as much as possible
to satisfy</strong>.</p>
<p>When using <code>.+?</code>, instead of matching all at once and going back for other
conditions (if any), the engine will match the next characters by step until
the subsequent part of the regex is matched (again if any). This is the <strong>un-
greedy</strong> , meaning match <strong>the fewest possible to satisfy</strong>.</p>
<div class="code"><pre class="code literal-block">/.+X/  ~ "abcXabcXabcX"        /.+/  ~ "abcXabcXabcX"
          ^^^^^^^^^^^^                  ^^^^^^^^^^^^

/.+?X/ ~ "abcXabcXabcX"        /.+?/ ~ "abcXabcXabcX"
          ^^^^                          ^
</pre></div>

<p>Following that we have <code>(?=</code> <strong><code>{contents}</code></strong><code>)</code>, a <em>zero width assertion</em> , a
<em>look around</em>. This grouped construction matches its contents, but does not
count as characters matched ( <strong>zero width</strong> ). It only returns if it is a
match or not ( <strong>assertion</strong> ).</p>
<p>Thus, in other terms the regex <code>/.+?(?=abc)/</code> means:</p>
<blockquote>
<p>Match any characters as few as possible until a "abc" is found, without
counting the "abc".</p>
</blockquote>
<p><br></p>
<h3>Suggest</h3>
<p>If you're looking to capture everything up to "abc":</p>
<div class="code"><pre class="code literal-block">/^(.*?)abc/
</pre></div>

<p>Explanation:</p>
<p><code>( )</code> capture the expression inside the parentheses for access using <code>$1</code>,
<code>$2</code>, etc.</p>
<p><code>^</code> match start of line</p>
<p><code>.*</code> match anything, <code>?</code> non-greedily (match the minimum number of characters
required) - [1]</p>
<p>[1] The reason why this is needed is that otherwise, in the following string:</p>
<div class="code"><pre class="code literal-block">whatever whatever something abc something abc
</pre></div>

<p>by default, regexes are <em>greedy</em> , meaning it will match as much as possible.
Therefore <code>/^.*abc/</code> would match "whatever whatever something abc something ".
Adding the non-greedy quantifier <code>?</code> makes the regex only match "whatever
whatever something ".</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-calculate-the-difference-between-two-dates-using-php/" class="u-url">How to calculate the difference between two dates using PHP?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-calculate-the-difference-between-two-dates-using-php/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T12:57:02+08:00" itemprop="datePublished" title="2023-02-17 12:57">2023-02-17 12:57</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I have two dates of the form:</p>
<div class="code"><pre class="code literal-block"><span class="nv">Start</span><span class="w"> </span><span class="nv">Date</span>:<span class="w"> </span><span class="mi">2007</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">24</span><span class="w"> </span>
<span class="k">End</span><span class="w"> </span><span class="nv">Date</span>:<span class="w"> </span><span class="mi">2009</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">26</span>
</pre></div>

<p>Now I need to find the difference between these two in the following form:</p>
<div class="code"><pre class="code literal-block"><span class="mf">2</span><span class="w"> </span><span class="n">years</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="w"> </span><span class="n">months</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="mf">2</span><span class="w"> </span><span class="n">days</span>
</pre></div>

<p>How can I do this in PHP?</p>
<p><br><br></p>
<h2>Answer</h2>
<blockquote>
<p>Use this for legacy code (PHP &lt; 5.3). For up to date solution see jurka's
answer below</p>
</blockquote>
<p>You can use strtotime() to convert two dates to unix time and then calculate
the number of seconds between them. From this it's rather easy to calculate
different time periods.</p>
<div class="code"><pre class="code literal-block">$date1 = "2007-03-24";
$date2 = "2009-06-26";

$diff = abs(strtotime($date2) - strtotime($date1));

$years = floor($diff / (365*60*60*24));
$months = floor(($diff - $years * 365*60*60*24) / (30*60*60*24));
$days = floor(($diff - $years * 365*60*60*24 - $months*30*60*60*24)/ (60*60*24));

printf("%d years, %d months, %d days\n", $years, $months, $days);
</pre></div>

<p><strong>Edit:</strong> Obviously the preferred way of doing this is like described by jurka
below. My code is generally only recommended if you don't have PHP 5.3 or
better.</p>
<p>Several people in the comments have pointed out that the code above is only an
approximation. I still believe that for most purposes that's fine, since the
usage of a range is more to provide a sense of how much time has passed or
remains rather than to provide precision - if you want to do that, just output
the date.</p>
<p>Despite all that, I've decided to address the complaints. If you truly need an
exact range but haven't got access to PHP 5.3, use the code below (it should
work in PHP 4 as well). This is a direct port of the code that PHP uses
internally to calculate ranges, with the exception that it doesn't take
daylight savings time into account. That means that it's off by an hour at
most, but except for that it should be correct.</p>
<div class="code"><pre class="code literal-block"><span class="cp">&lt;?php</span>

<span class="sd">/**</span>
<span class="sd"> * Calculate differences between two dates with precise semantics. Based on PHPs DateTime::diff()</span>
<span class="sd"> * implementation by Derick Rethans. Ported to PHP by Emil H, 2011-05-02. No rights reserved.</span>
<span class="sd"> * </span>
<span class="sd"> * See here for original code:</span>
<span class="sd"> * http://svn.php.net/viewvc/php/php-src/trunk/ext/date/lib/tm2unixtime.c?revision=302890&amp;view=markup</span>
<span class="sd"> * http://svn.php.net/viewvc/php/php-src/trunk/ext/date/lib/interval.c?revision=298973&amp;view=markup</span>
<span class="sd"> */</span>

<span class="k">function</span> <span class="nf">_date_range_limit</span><span class="p">(</span><span class="nv">$start</span><span class="p">,</span> <span class="nv">$end</span><span class="p">,</span> <span class="nv">$adj</span><span class="p">,</span> <span class="nv">$a</span><span class="p">,</span> <span class="nv">$b</span><span class="p">,</span> <span class="nv">$result</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$result</span><span class="p">[</span><span class="nv">$a</span><span class="p">]</span> <span class="o">&lt;</span> <span class="nv">$start</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$result</span><span class="p">[</span><span class="nv">$b</span><span class="p">]</span> <span class="o">-=</span> <span class="nb">intval</span><span class="p">((</span><span class="nv">$start</span> <span class="o">-</span> <span class="nv">$result</span><span class="p">[</span><span class="nv">$a</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="nv">$adj</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
        <span class="nv">$result</span><span class="p">[</span><span class="nv">$a</span><span class="p">]</span> <span class="o">+=</span> <span class="nv">$adj</span> <span class="o">*</span> <span class="nb">intval</span><span class="p">((</span><span class="nv">$start</span> <span class="o">-</span> <span class="nv">$result</span><span class="p">[</span><span class="nv">$a</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="nv">$adj</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="nv">$result</span><span class="p">[</span><span class="nv">$a</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="nv">$end</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$result</span><span class="p">[</span><span class="nv">$b</span><span class="p">]</span> <span class="o">+=</span> <span class="nb">intval</span><span class="p">(</span><span class="nv">$result</span><span class="p">[</span><span class="nv">$a</span><span class="p">]</span> <span class="o">/</span> <span class="nv">$adj</span><span class="p">);</span>
        <span class="nv">$result</span><span class="p">[</span><span class="nv">$a</span><span class="p">]</span> <span class="o">-=</span> <span class="nv">$adj</span> <span class="o">*</span> <span class="nb">intval</span><span class="p">(</span><span class="nv">$result</span><span class="p">[</span><span class="nv">$a</span><span class="p">]</span> <span class="o">/</span> <span class="nv">$adj</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nv">$result</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">function</span> <span class="nf">_date_range_limit_days</span><span class="p">(</span><span class="nv">$base</span><span class="p">,</span> <span class="nv">$result</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nv">$days_in_month_leap</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">);</span>
    <span class="nv">$days_in_month</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">);</span>

    <span class="nx">_date_range_limit</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="s2">"m"</span><span class="p">,</span> <span class="s2">"y"</span><span class="p">,</span> <span class="o">&amp;</span><span class="nv">$base</span><span class="p">);</span>

    <span class="nv">$year</span> <span class="o">=</span> <span class="nv">$base</span><span class="p">[</span><span class="s2">"y"</span><span class="p">];</span>
    <span class="nv">$month</span> <span class="o">=</span> <span class="nv">$base</span><span class="p">[</span><span class="s2">"m"</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$result</span><span class="p">[</span><span class="s2">"invert"</span><span class="p">])</span> <span class="p">{</span>
        <span class="k">while</span> <span class="p">(</span><span class="nv">$result</span><span class="p">[</span><span class="s2">"d"</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$month</span><span class="o">--</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$month</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$month</span> <span class="o">+=</span> <span class="mi">12</span><span class="p">;</span>
                <span class="nv">$year</span><span class="o">--</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="nv">$leapyear</span> <span class="o">=</span> <span class="nv">$year</span> <span class="o">%</span> <span class="mi">400</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">||</span> <span class="p">(</span><span class="nv">$year</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">!=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nv">$year</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">0</span><span class="p">);</span>
            <span class="nv">$days</span> <span class="o">=</span> <span class="nv">$leapyear</span> <span class="o">?</span> <span class="nv">$days_in_month_leap</span><span class="p">[</span><span class="nv">$month</span><span class="p">]</span> <span class="o">:</span> <span class="nv">$days_in_month</span><span class="p">[</span><span class="nv">$month</span><span class="p">];</span>

            <span class="nv">$result</span><span class="p">[</span><span class="s2">"d"</span><span class="p">]</span> <span class="o">+=</span> <span class="nv">$days</span><span class="p">;</span>
            <span class="nv">$result</span><span class="p">[</span><span class="s2">"m"</span><span class="p">]</span><span class="o">--</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">while</span> <span class="p">(</span><span class="nv">$result</span><span class="p">[</span><span class="s2">"d"</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$leapyear</span> <span class="o">=</span> <span class="nv">$year</span> <span class="o">%</span> <span class="mi">400</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">||</span> <span class="p">(</span><span class="nv">$year</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">!=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nv">$year</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">0</span><span class="p">);</span>
            <span class="nv">$days</span> <span class="o">=</span> <span class="nv">$leapyear</span> <span class="o">?</span> <span class="nv">$days_in_month_leap</span><span class="p">[</span><span class="nv">$month</span><span class="p">]</span> <span class="o">:</span> <span class="nv">$days_in_month</span><span class="p">[</span><span class="nv">$month</span><span class="p">];</span>

            <span class="nv">$result</span><span class="p">[</span><span class="s2">"d"</span><span class="p">]</span> <span class="o">+=</span> <span class="nv">$days</span><span class="p">;</span>
            <span class="nv">$result</span><span class="p">[</span><span class="s2">"m"</span><span class="p">]</span><span class="o">--</span><span class="p">;</span>

            <span class="nv">$month</span><span class="o">++</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$month</span> <span class="o">&gt;</span> <span class="mi">12</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$month</span> <span class="o">-=</span> <span class="mi">12</span><span class="p">;</span>
                <span class="nv">$year</span><span class="o">++</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nv">$result</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">function</span> <span class="nf">_date_normalize</span><span class="p">(</span><span class="nv">$base</span><span class="p">,</span> <span class="nv">$result</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nv">$result</span> <span class="o">=</span> <span class="nx">_date_range_limit</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="s2">"s"</span><span class="p">,</span> <span class="s2">"i"</span><span class="p">,</span> <span class="nv">$result</span><span class="p">);</span>
    <span class="nv">$result</span> <span class="o">=</span> <span class="nx">_date_range_limit</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="s2">"i"</span><span class="p">,</span> <span class="s2">"h"</span><span class="p">,</span> <span class="nv">$result</span><span class="p">);</span>
    <span class="nv">$result</span> <span class="o">=</span> <span class="nx">_date_range_limit</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="s2">"h"</span><span class="p">,</span> <span class="s2">"d"</span><span class="p">,</span> <span class="nv">$result</span><span class="p">);</span>
    <span class="nv">$result</span> <span class="o">=</span> <span class="nx">_date_range_limit</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="s2">"m"</span><span class="p">,</span> <span class="s2">"y"</span><span class="p">,</span> <span class="nv">$result</span><span class="p">);</span>

    <span class="nv">$result</span> <span class="o">=</span> <span class="nx">_date_range_limit_days</span><span class="p">(</span><span class="o">&amp;</span><span class="nv">$base</span><span class="p">,</span> <span class="o">&amp;</span><span class="nv">$result</span><span class="p">);</span>

    <span class="nv">$result</span> <span class="o">=</span> <span class="nx">_date_range_limit</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="s2">"m"</span><span class="p">,</span> <span class="s2">"y"</span><span class="p">,</span> <span class="nv">$result</span><span class="p">);</span>

    <span class="k">return</span> <span class="nv">$result</span><span class="p">;</span>
<span class="p">}</span>

<span class="sd">/**</span>
<span class="sd"> * Accepts two unix timestamps.</span>
<span class="sd"> */</span>
<span class="k">function</span> <span class="nf">_date_diff</span><span class="p">(</span><span class="nv">$one</span><span class="p">,</span> <span class="nv">$two</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nv">$invert</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$one</span> <span class="o">&gt;</span> <span class="nv">$two</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">list</span><span class="p">(</span><span class="nv">$one</span><span class="p">,</span> <span class="nv">$two</span><span class="p">)</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="nv">$two</span><span class="p">,</span> <span class="nv">$one</span><span class="p">);</span>
        <span class="nv">$invert</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nv">$key</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">"y"</span><span class="p">,</span> <span class="s2">"m"</span><span class="p">,</span> <span class="s2">"d"</span><span class="p">,</span> <span class="s2">"h"</span><span class="p">,</span> <span class="s2">"i"</span><span class="p">,</span> <span class="s2">"s"</span><span class="p">);</span>
    <span class="nv">$a</span> <span class="o">=</span> <span class="nb">array_combine</span><span class="p">(</span><span class="nv">$key</span><span class="p">,</span> <span class="nb">array_map</span><span class="p">(</span><span class="s2">"intval"</span><span class="p">,</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">" "</span><span class="p">,</span> <span class="nb">date</span><span class="p">(</span><span class="s2">"Y m d H i s"</span><span class="p">,</span> <span class="nv">$one</span><span class="p">))));</span>
    <span class="nv">$b</span> <span class="o">=</span> <span class="nb">array_combine</span><span class="p">(</span><span class="nv">$key</span><span class="p">,</span> <span class="nb">array_map</span><span class="p">(</span><span class="s2">"intval"</span><span class="p">,</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">" "</span><span class="p">,</span> <span class="nb">date</span><span class="p">(</span><span class="s2">"Y m d H i s"</span><span class="p">,</span> <span class="nv">$two</span><span class="p">))));</span>

    <span class="nv">$result</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
    <span class="nv">$result</span><span class="p">[</span><span class="s2">"y"</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$b</span><span class="p">[</span><span class="s2">"y"</span><span class="p">]</span> <span class="o">-</span> <span class="nv">$a</span><span class="p">[</span><span class="s2">"y"</span><span class="p">];</span>
    <span class="nv">$result</span><span class="p">[</span><span class="s2">"m"</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$b</span><span class="p">[</span><span class="s2">"m"</span><span class="p">]</span> <span class="o">-</span> <span class="nv">$a</span><span class="p">[</span><span class="s2">"m"</span><span class="p">];</span>
    <span class="nv">$result</span><span class="p">[</span><span class="s2">"d"</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$b</span><span class="p">[</span><span class="s2">"d"</span><span class="p">]</span> <span class="o">-</span> <span class="nv">$a</span><span class="p">[</span><span class="s2">"d"</span><span class="p">];</span>
    <span class="nv">$result</span><span class="p">[</span><span class="s2">"h"</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$b</span><span class="p">[</span><span class="s2">"h"</span><span class="p">]</span> <span class="o">-</span> <span class="nv">$a</span><span class="p">[</span><span class="s2">"h"</span><span class="p">];</span>
    <span class="nv">$result</span><span class="p">[</span><span class="s2">"i"</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$b</span><span class="p">[</span><span class="s2">"i"</span><span class="p">]</span> <span class="o">-</span> <span class="nv">$a</span><span class="p">[</span><span class="s2">"i"</span><span class="p">];</span>
    <span class="nv">$result</span><span class="p">[</span><span class="s2">"s"</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$b</span><span class="p">[</span><span class="s2">"s"</span><span class="p">]</span> <span class="o">-</span> <span class="nv">$a</span><span class="p">[</span><span class="s2">"s"</span><span class="p">];</span>
    <span class="nv">$result</span><span class="p">[</span><span class="s2">"invert"</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$invert</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nv">$result</span><span class="p">[</span><span class="s2">"days"</span><span class="p">]</span> <span class="o">=</span> <span class="nb">intval</span><span class="p">(</span><span class="nb">abs</span><span class="p">((</span><span class="nv">$one</span> <span class="o">-</span> <span class="nv">$two</span><span class="p">)</span><span class="o">/</span><span class="mi">86400</span><span class="p">));</span>

    <span class="k">if</span> <span class="p">(</span><span class="nv">$invert</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">_date_normalize</span><span class="p">(</span><span class="o">&amp;</span><span class="nv">$a</span><span class="p">,</span> <span class="o">&amp;</span><span class="nv">$result</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">_date_normalize</span><span class="p">(</span><span class="o">&amp;</span><span class="nv">$b</span><span class="p">,</span> <span class="o">&amp;</span><span class="nv">$result</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nv">$result</span><span class="p">;</span>
<span class="p">}</span>

<span class="nv">$date</span> <span class="o">=</span> <span class="s2">"1986-11-10 19:37:22"</span><span class="p">;</span>

<span class="nb">print_r</span><span class="p">(</span><span class="nx">_date_diff</span><span class="p">(</span><span class="nb">strtotime</span><span class="p">(</span><span class="nv">$date</span><span class="p">),</span> <span class="nb">time</span><span class="p">()));</span>
<span class="nb">print_r</span><span class="p">(</span><span class="nx">_date_diff</span><span class="p">(</span><span class="nb">time</span><span class="p">(),</span> <span class="nb">strtotime</span><span class="p">(</span><span class="nv">$date</span><span class="p">)));</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<blockquote>
<p>Use this for legacy code (PHP &lt; 5.3). For up to date solution see jurka's
answer below</p>
</blockquote>
<p>You can use strtotime() to convert two dates to unix time and then calculate
the number of seconds between them. From this it's rather easy to calculate
different time periods.</p>
<div class="code"><pre class="code literal-block">$date1 = "2007-03-24";
$date2 = "2009-06-26";

$diff = abs(strtotime($date2) - strtotime($date1));

$years = floor($diff / (365*60*60*24));
$months = floor(($diff - $years * 365*60*60*24) / (30*60*60*24));
$days = floor(($diff - $years * 365*60*60*24 - $months*30*60*60*24)/ (60*60*24));

printf("%d years, %d months, %d days\n", $years, $months, $days);
</pre></div>

<p><strong>Edit:</strong> Obviously the preferred way of doing this is like described by jurka
below. My code is generally only recommended if you don't have PHP 5.3 or
better.</p>
<p>Several people in the comments have pointed out that the code above is only an
approximation. I still believe that for most purposes that's fine, since the
usage of a range is more to provide a sense of how much time has passed or
remains rather than to provide precision - if you want to do that, just output
the date.</p>
<p>Despite all that, I've decided to address the complaints. If you truly need an
exact range but haven't got access to PHP 5.3, use the code below (it should
work in PHP 4 as well). This is a direct port of the code that PHP uses
internally to calculate ranges, with the exception that it doesn't take
daylight savings time into account. That means that it's off by an hour at
most, but except for that it should be correct.</p>
<div class="code"><pre class="code literal-block"><span class="cp">&lt;?php</span>

<span class="sd">/**</span>
<span class="sd"> * Calculate differences between two dates with precise semantics. Based on PHPs DateTime::diff()</span>
<span class="sd"> * implementation by Derick Rethans. Ported to PHP by Emil H, 2011-05-02. No rights reserved.</span>
<span class="sd"> * </span>
<span class="sd"> * See here for original code:</span>
<span class="sd"> * http://svn.php.net/viewvc/php/php-src/trunk/ext/date/lib/tm2unixtime.c?revision=302890&amp;view=markup</span>
<span class="sd"> * http://svn.php.net/viewvc/php/php-src/trunk/ext/date/lib/interval.c?revision=298973&amp;view=markup</span>
<span class="sd"> */</span>

<span class="k">function</span> <span class="nf">_date_range_limit</span><span class="p">(</span><span class="nv">$start</span><span class="p">,</span> <span class="nv">$end</span><span class="p">,</span> <span class="nv">$adj</span><span class="p">,</span> <span class="nv">$a</span><span class="p">,</span> <span class="nv">$b</span><span class="p">,</span> <span class="nv">$result</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$result</span><span class="p">[</span><span class="nv">$a</span><span class="p">]</span> <span class="o">&lt;</span> <span class="nv">$start</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$result</span><span class="p">[</span><span class="nv">$b</span><span class="p">]</span> <span class="o">-=</span> <span class="nb">intval</span><span class="p">((</span><span class="nv">$start</span> <span class="o">-</span> <span class="nv">$result</span><span class="p">[</span><span class="nv">$a</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="nv">$adj</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
        <span class="nv">$result</span><span class="p">[</span><span class="nv">$a</span><span class="p">]</span> <span class="o">+=</span> <span class="nv">$adj</span> <span class="o">*</span> <span class="nb">intval</span><span class="p">((</span><span class="nv">$start</span> <span class="o">-</span> <span class="nv">$result</span><span class="p">[</span><span class="nv">$a</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="nv">$adj</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="nv">$result</span><span class="p">[</span><span class="nv">$a</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="nv">$end</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$result</span><span class="p">[</span><span class="nv">$b</span><span class="p">]</span> <span class="o">+=</span> <span class="nb">intval</span><span class="p">(</span><span class="nv">$result</span><span class="p">[</span><span class="nv">$a</span><span class="p">]</span> <span class="o">/</span> <span class="nv">$adj</span><span class="p">);</span>
        <span class="nv">$result</span><span class="p">[</span><span class="nv">$a</span><span class="p">]</span> <span class="o">-=</span> <span class="nv">$adj</span> <span class="o">*</span> <span class="nb">intval</span><span class="p">(</span><span class="nv">$result</span><span class="p">[</span><span class="nv">$a</span><span class="p">]</span> <span class="o">/</span> <span class="nv">$adj</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nv">$result</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">function</span> <span class="nf">_date_range_limit_days</span><span class="p">(</span><span class="nv">$base</span><span class="p">,</span> <span class="nv">$result</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nv">$days_in_month_leap</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">);</span>
    <span class="nv">$days_in_month</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">);</span>

    <span class="nx">_date_range_limit</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="s2">"m"</span><span class="p">,</span> <span class="s2">"y"</span><span class="p">,</span> <span class="o">&amp;</span><span class="nv">$base</span><span class="p">);</span>

    <span class="nv">$year</span> <span class="o">=</span> <span class="nv">$base</span><span class="p">[</span><span class="s2">"y"</span><span class="p">];</span>
    <span class="nv">$month</span> <span class="o">=</span> <span class="nv">$base</span><span class="p">[</span><span class="s2">"m"</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$result</span><span class="p">[</span><span class="s2">"invert"</span><span class="p">])</span> <span class="p">{</span>
        <span class="k">while</span> <span class="p">(</span><span class="nv">$result</span><span class="p">[</span><span class="s2">"d"</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$month</span><span class="o">--</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$month</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$month</span> <span class="o">+=</span> <span class="mi">12</span><span class="p">;</span>
                <span class="nv">$year</span><span class="o">--</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="nv">$leapyear</span> <span class="o">=</span> <span class="nv">$year</span> <span class="o">%</span> <span class="mi">400</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">||</span> <span class="p">(</span><span class="nv">$year</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">!=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nv">$year</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">0</span><span class="p">);</span>
            <span class="nv">$days</span> <span class="o">=</span> <span class="nv">$leapyear</span> <span class="o">?</span> <span class="nv">$days_in_month_leap</span><span class="p">[</span><span class="nv">$month</span><span class="p">]</span> <span class="o">:</span> <span class="nv">$days_in_month</span><span class="p">[</span><span class="nv">$month</span><span class="p">];</span>

            <span class="nv">$result</span><span class="p">[</span><span class="s2">"d"</span><span class="p">]</span> <span class="o">+=</span> <span class="nv">$days</span><span class="p">;</span>
            <span class="nv">$result</span><span class="p">[</span><span class="s2">"m"</span><span class="p">]</span><span class="o">--</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">while</span> <span class="p">(</span><span class="nv">$result</span><span class="p">[</span><span class="s2">"d"</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$leapyear</span> <span class="o">=</span> <span class="nv">$year</span> <span class="o">%</span> <span class="mi">400</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">||</span> <span class="p">(</span><span class="nv">$year</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">!=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nv">$year</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">0</span><span class="p">);</span>
            <span class="nv">$days</span> <span class="o">=</span> <span class="nv">$leapyear</span> <span class="o">?</span> <span class="nv">$days_in_month_leap</span><span class="p">[</span><span class="nv">$month</span><span class="p">]</span> <span class="o">:</span> <span class="nv">$days_in_month</span><span class="p">[</span><span class="nv">$month</span><span class="p">];</span>

            <span class="nv">$result</span><span class="p">[</span><span class="s2">"d"</span><span class="p">]</span> <span class="o">+=</span> <span class="nv">$days</span><span class="p">;</span>
            <span class="nv">$result</span><span class="p">[</span><span class="s2">"m"</span><span class="p">]</span><span class="o">--</span><span class="p">;</span>

            <span class="nv">$month</span><span class="o">++</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$month</span> <span class="o">&gt;</span> <span class="mi">12</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$month</span> <span class="o">-=</span> <span class="mi">12</span><span class="p">;</span>
                <span class="nv">$year</span><span class="o">++</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nv">$result</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">function</span> <span class="nf">_date_normalize</span><span class="p">(</span><span class="nv">$base</span><span class="p">,</span> <span class="nv">$result</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nv">$result</span> <span class="o">=</span> <span class="nx">_date_range_limit</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="s2">"s"</span><span class="p">,</span> <span class="s2">"i"</span><span class="p">,</span> <span class="nv">$result</span><span class="p">);</span>
    <span class="nv">$result</span> <span class="o">=</span> <span class="nx">_date_range_limit</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="s2">"i"</span><span class="p">,</span> <span class="s2">"h"</span><span class="p">,</span> <span class="nv">$result</span><span class="p">);</span>
    <span class="nv">$result</span> <span class="o">=</span> <span class="nx">_date_range_limit</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="s2">"h"</span><span class="p">,</span> <span class="s2">"d"</span><span class="p">,</span> <span class="nv">$result</span><span class="p">);</span>
    <span class="nv">$result</span> <span class="o">=</span> <span class="nx">_date_range_limit</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="s2">"m"</span><span class="p">,</span> <span class="s2">"y"</span><span class="p">,</span> <span class="nv">$result</span><span class="p">);</span>

    <span class="nv">$result</span> <span class="o">=</span> <span class="nx">_date_range_limit_days</span><span class="p">(</span><span class="o">&amp;</span><span class="nv">$base</span><span class="p">,</span> <span class="o">&amp;</span><span class="nv">$result</span><span class="p">);</span>

    <span class="nv">$result</span> <span class="o">=</span> <span class="nx">_date_range_limit</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="s2">"m"</span><span class="p">,</span> <span class="s2">"y"</span><span class="p">,</span> <span class="nv">$result</span><span class="p">);</span>

    <span class="k">return</span> <span class="nv">$result</span><span class="p">;</span>
<span class="p">}</span>

<span class="sd">/**</span>
<span class="sd"> * Accepts two unix timestamps.</span>
<span class="sd"> */</span>
<span class="k">function</span> <span class="nf">_date_diff</span><span class="p">(</span><span class="nv">$one</span><span class="p">,</span> <span class="nv">$two</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nv">$invert</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$one</span> <span class="o">&gt;</span> <span class="nv">$two</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">list</span><span class="p">(</span><span class="nv">$one</span><span class="p">,</span> <span class="nv">$two</span><span class="p">)</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="nv">$two</span><span class="p">,</span> <span class="nv">$one</span><span class="p">);</span>
        <span class="nv">$invert</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nv">$key</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">"y"</span><span class="p">,</span> <span class="s2">"m"</span><span class="p">,</span> <span class="s2">"d"</span><span class="p">,</span> <span class="s2">"h"</span><span class="p">,</span> <span class="s2">"i"</span><span class="p">,</span> <span class="s2">"s"</span><span class="p">);</span>
    <span class="nv">$a</span> <span class="o">=</span> <span class="nb">array_combine</span><span class="p">(</span><span class="nv">$key</span><span class="p">,</span> <span class="nb">array_map</span><span class="p">(</span><span class="s2">"intval"</span><span class="p">,</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">" "</span><span class="p">,</span> <span class="nb">date</span><span class="p">(</span><span class="s2">"Y m d H i s"</span><span class="p">,</span> <span class="nv">$one</span><span class="p">))));</span>
    <span class="nv">$b</span> <span class="o">=</span> <span class="nb">array_combine</span><span class="p">(</span><span class="nv">$key</span><span class="p">,</span> <span class="nb">array_map</span><span class="p">(</span><span class="s2">"intval"</span><span class="p">,</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">" "</span><span class="p">,</span> <span class="nb">date</span><span class="p">(</span><span class="s2">"Y m d H i s"</span><span class="p">,</span> <span class="nv">$two</span><span class="p">))));</span>

    <span class="nv">$result</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
    <span class="nv">$result</span><span class="p">[</span><span class="s2">"y"</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$b</span><span class="p">[</span><span class="s2">"y"</span><span class="p">]</span> <span class="o">-</span> <span class="nv">$a</span><span class="p">[</span><span class="s2">"y"</span><span class="p">];</span>
    <span class="nv">$result</span><span class="p">[</span><span class="s2">"m"</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$b</span><span class="p">[</span><span class="s2">"m"</span><span class="p">]</span> <span class="o">-</span> <span class="nv">$a</span><span class="p">[</span><span class="s2">"m"</span><span class="p">];</span>
    <span class="nv">$result</span><span class="p">[</span><span class="s2">"d"</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$b</span><span class="p">[</span><span class="s2">"d"</span><span class="p">]</span> <span class="o">-</span> <span class="nv">$a</span><span class="p">[</span><span class="s2">"d"</span><span class="p">];</span>
    <span class="nv">$result</span><span class="p">[</span><span class="s2">"h"</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$b</span><span class="p">[</span><span class="s2">"h"</span><span class="p">]</span> <span class="o">-</span> <span class="nv">$a</span><span class="p">[</span><span class="s2">"h"</span><span class="p">];</span>
    <span class="nv">$result</span><span class="p">[</span><span class="s2">"i"</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$b</span><span class="p">[</span><span class="s2">"i"</span><span class="p">]</span> <span class="o">-</span> <span class="nv">$a</span><span class="p">[</span><span class="s2">"i"</span><span class="p">];</span>
    <span class="nv">$result</span><span class="p">[</span><span class="s2">"s"</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$b</span><span class="p">[</span><span class="s2">"s"</span><span class="p">]</span> <span class="o">-</span> <span class="nv">$a</span><span class="p">[</span><span class="s2">"s"</span><span class="p">];</span>
    <span class="nv">$result</span><span class="p">[</span><span class="s2">"invert"</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$invert</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nv">$result</span><span class="p">[</span><span class="s2">"days"</span><span class="p">]</span> <span class="o">=</span> <span class="nb">intval</span><span class="p">(</span><span class="nb">abs</span><span class="p">((</span><span class="nv">$one</span> <span class="o">-</span> <span class="nv">$two</span><span class="p">)</span><span class="o">/</span><span class="mi">86400</span><span class="p">));</span>

    <span class="k">if</span> <span class="p">(</span><span class="nv">$invert</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">_date_normalize</span><span class="p">(</span><span class="o">&amp;</span><span class="nv">$a</span><span class="p">,</span> <span class="o">&amp;</span><span class="nv">$result</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">_date_normalize</span><span class="p">(</span><span class="o">&amp;</span><span class="nv">$b</span><span class="p">,</span> <span class="o">&amp;</span><span class="nv">$result</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nv">$result</span><span class="p">;</span>
<span class="p">}</span>

<span class="nv">$date</span> <span class="o">=</span> <span class="s2">"1986-11-10 19:37:22"</span><span class="p">;</span>

<span class="nb">print_r</span><span class="p">(</span><span class="nx">_date_diff</span><span class="p">(</span><span class="nb">strtotime</span><span class="p">(</span><span class="nv">$date</span><span class="p">),</span> <span class="nb">time</span><span class="p">()));</span>
<span class="nb">print_r</span><span class="p">(</span><span class="nx">_date_diff</span><span class="p">(</span><span class="nb">time</span><span class="p">(),</span> <span class="nb">strtotime</span><span class="p">(</span><span class="nv">$date</span><span class="p">)));</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/convert-dos-windows-line-endings-to-linux-line-endings-in-vim/" class="u-url">Convert DOS/Windows line endings to Linux line endings in Vim</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/convert-dos-windows-line-endings-to-linux-line-endings-in-vim/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T12:56:33+08:00" itemprop="datePublished" title="2023-02-17 12:56">2023-02-17 12:56</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>If I open files I created in Windows, the lines all end with <code>^M</code>.<br>
How do I delete these characters all at once?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>dos2unix is a commandline utility that will do this, or <code>:%s/^M//g</code> will if
you use <code>Ctrl</code>-<code>v</code> <code>Ctrl</code>-<code>m</code> to input the ^M, or you can <code>:set ff=unix</code> and
Vim will do it for you.</p>
<p>There is documentation on the fileformat setting, and the Vim wiki has a
comprehensive page on line ending conversions.</p>
<p>Alternately, if you move files back and forth a lot, you might not want to
convert them, but rather to do <code>:set ff=dos</code>, so Vim will know it's a DOS file
and use DOS conventions for line endings.</p>
<p><br></p>
<h3>Suggest</h3>
<p>Change the line endings in the view:</p>
<div class="code"><pre class="code literal-block">:e ++ff=dos
:e ++ff=mac
:e ++ff=unix
</pre></div>

<p>This can also be used as saving operation (:w alone will not save using the
line endings you see on screen):</p>
<div class="code"><pre class="code literal-block">:w ++ff=dos
:w ++ff=mac
:w ++ff=unix
</pre></div>

<p>And you can use it from the command-line:</p>
<div class="code"><pre class="code literal-block"><span class="k">for</span><span class="w"> </span><span class="nv">file</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="o">*</span>.<span class="nv">cpp</span>
<span class="k">do</span><span class="w"> </span>
<span class="w">    </span><span class="nv">vi</span><span class="w"> </span><span class="o">+</span><span class="s1">':w ++ff=unix'</span><span class="w"> </span><span class="o">+</span><span class="s1">':q'</span><span class="w"> </span><span class="s2">"$file"</span>
<span class="nv">done</span>
</pre></div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-674.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-672.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
