<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 1110) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-1110.html">
<link rel="prev" href="index-1111.html" type="text/html">
<link rel="next" href="index-1109.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/origin-null-is-not-allowed-by-access-control-allow-origin-error-for-request-made-by-application-running-from-a-file-url/" class="u-url">“Origin null is not allowed by Access-Control-Allow-Origin” error for request made by application running from a file:// URL</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/origin-null-is-not-allowed-by-access-control-allow-origin-error-for-request-made-by-application-running-from-a-file-url/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T01:28:49+08:00" itemprop="datePublished" title="2023-02-18 01:28">2023-02-18 01:28</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I'm developing a page that pulls images from Flickr and Panoramio via jQuery's
AJAX support.</p>
<p>The Flickr side is working fine, but when I try to <code>$.get(url, callback)</code> from
Panoramio, I see an error in Chrome's console:</p>
<blockquote>
<p>XMLHttpRequest cannot load
http://www.panoramio.com/wapi/data/get_photos?v=1&amp;key=dummykey&amp;tag=test&amp;offset=0&amp;length=20&amp;callback=processImages&amp;minx=-30&amp;miny=0&amp;maxx=0&amp;maxy=150.
Origin null is not allowed by Access-Control-Allow-Origin.</p>
</blockquote>
<p>If I query that URL from a browser directly it works fine. What is going on,
and can I get around this? Am I composing my query incorrectly, or is this
something that Panoramio does to hinder what I'm trying to do?</p>
<p>Google didn't turn up any useful matches on the error message.</p>
<p><strong>EDIT</strong></p>
<p>Here's some sample code that shows the problem:</p>
<div class="code"><pre class="code literal-block"><span class="o">$</span><span class="p">()</span><span class="o">.</span><span class="n">ready</span><span class="p">(</span><span class="n">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">var</span><span class="w"> </span><span class="n">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'http://www.panoramio.com/wapi/data/get_photos?v=1&amp;key=dummykey&amp;tag=test&amp;offset=0&amp;length=20&amp;callback=processImages&amp;minx=-30&amp;miny=0&amp;maxx=0&amp;maxy=150'</span><span class="p">;</span>

<span class="w">  </span><span class="o">$.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="p">(</span><span class="n">jsonp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">processImages</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">alert</span><span class="p">(</span><span class="s1">'ok'</span><span class="p">);</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="n">eval</span><span class="p">(</span><span class="n">jsonp</span><span class="p">);</span>
<span class="w">  </span><span class="p">});</span>
<span class="p">});</span>
</pre></div>

<p>You can run the example online.</p>
<p><strong>EDIT 2</strong></p>
<p>Thanks to Darin for his help with this. <strong>THE ABOVE CODE IS WRONG.</strong> Use this
instead:</p>
<div class="code"><pre class="code literal-block"><span class="o">$</span><span class="p">()</span><span class="o">.</span><span class="n">ready</span><span class="p">(</span><span class="n">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">var</span><span class="w"> </span><span class="n">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'http://www.panoramio.com/wapi/data/get_photos?v=1&amp;key=dummykey&amp;tag=test&amp;offset=0&amp;length=20&amp;minx=-30&amp;miny=0&amp;maxx=0&amp;maxy=150&amp;callback=?'</span><span class="p">;</span>

<span class="w">  </span><span class="o">$.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">use</span><span class="w"> </span><span class="s1">'data'</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">here</span><span class="o">...</span>
<span class="w">  </span><span class="p">});</span>
<span class="p">});</span>
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<p>For the record, as far as I can tell, you had two problems:</p>
<ol>
<li>
<p>You weren't passing a "jsonp" type specifier to your <code>$.get</code>, so it was using an ordinary XMLHttpRequest. However, your browser supported CORS (Cross-Origin Resource Sharing) to allow cross-domain XMLHttpRequest if the server OKed it. That's where the <code>Access-Control-Allow-Origin</code> header came in.</p>
</li>
<li>
<p>I believe you mentioned you were running it from a file:// URL. There are two ways for CORS headers to signal that a cross-domain XHR is OK. One is to send <code>Access-Control-Allow-Origin: *</code> (which, if you were reaching Flickr via <code>$.get</code>, they must have been doing) while the other was to echo back the contents of the <code>Origin</code> header. However, <code>file://</code> URLs produce a null <code>Origin</code> which can't be authorized via echo-back.</p>
</li>
</ol>
<p>The first was solved in a roundabout way by Darin's suggestion to use
<code>$.getJSON</code>. It does a little magic to change the request type from its
default of "json" to "jsonp" if it sees the substring <code>callback=?</code> in the URL.</p>
<p>That solved the second by no longer trying to perform a CORS request from a
<code>file://</code> URL.</p>
<p>To clarify for other people, here are the simple troubleshooting instructions:</p>
<ol>
<li>If you're trying to use JSONP, make sure one of the following is the case: <ul>
<li>You're using <code>$.get</code> and set <code>dataType</code> to <code>jsonp</code>.</li>
<li>You're using <code>$.getJSON</code> and included <code>callback=?</code> in the URL.</li>
</ul>
</li>
<li>If you're trying to do a cross-domain XMLHttpRequest via CORS... <ol>
<li>Make sure you're testing via <code>http://</code>. Scripts running via <code>file://</code> have limited support for CORS.</li>
<li>Make sure the browser actually supports CORS. (Opera and Internet Explorer are late to the party)</li>
</ol>
</li>
</ol>
<p><br></p>
<h3>Suggest</h3>
<p>You need to maybe add a HEADER in your called script, here is what I had to do
in PHP:</p>
<div class="code"><pre class="code literal-block"><span class="nt">header</span><span class="o">(</span><span class="s1">'Access-Control-Allow-Origin: *'</span><span class="o">);</span>
</pre></div>

<p>More details in <em>Cross domain AJAX ou services WEB</em> (in French).</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/jquery-find-events-handlers-registered-with-an-object/" class="u-url">jQuery find events handlers registered with an object</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/jquery-find-events-handlers-registered-with-an-object/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T01:28:23+08:00" itemprop="datePublished" title="2023-02-18 01:28">2023-02-18 01:28</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I need to find which event handlers are registered over an object.</p>
<p>For example:</p>
<div class="code"><pre class="code literal-block">$("#el").click(function() {...});
$("#el").mouseover(function() {...});
</pre></div>

<p><code>$("#el")</code> has <em>click</em> and <em>mouseover</em> registered.</p>
<p>Is there a function to find out that, and possibly iterate over the event
handlers?</p>
<p>If it is not possible on a jQuery object through proper methods, is it
possible on a plain DOM object?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>As of jQuery 1.8, the event data is no longer available from the "public API"
for data. Read this jQuery blog post. You should now use this instead:</p>
<div class="code"><pre class="code literal-block">jQuery._data( elem, "events" );
</pre></div>

<p><code>elem</code> should be an HTML Element, not a jQuery object, or selector.</p>
<p>Please note, that this is an internal, 'private' structure, and shouldn't be
modified. Use this for debugging purposes only.</p>
<p>In older versions of jQuery, you might have to use the old method which is:</p>
<div class="code"><pre class="code literal-block">jQuery( elem ).data( "events" );
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>You can do it by crawling the events (as of jQuery 1.8+), like this:</p>
<div class="code"><pre class="code literal-block">$.each($._data($("#id")[0], "events"), function(i, event) {
  // i is the event type, like "click"
  $.each(event, function(j, h) {
    // h.handler is the function being called
  });
});
</pre></div>

<p>Here's an example you can play with:</p>
<div class="code"><pre class="code literal-block">$(function()<span class="w"> </span>{
<span class="w">  </span>$("#el").click(function(){<span class="w"> </span>alert("click");<span class="w"> </span>});
<span class="w">  </span>$("#el").mouseover(function(){<span class="w"> </span>alert("mouseover");<span class="w"> </span>});

<span class="w">  </span>$.each($._data($("#el")[0],<span class="w"> </span>"events"),<span class="w"> </span>function(i,<span class="w"> </span>event)<span class="w"> </span>{
<span class="w">    </span>output(i);
<span class="w">    </span>$.each(event,<span class="w"> </span>function(j,<span class="w"> </span>h)<span class="w"> </span>{
<span class="w">        </span>output("-<span class="w"> </span>"<span class="w"> </span>+<span class="w"> </span>h.handler);
<span class="w">    </span>});
<span class="w">  </span>});
});

function<span class="w"> </span>output(text)<span class="w"> </span>{
<span class="w">    </span>$("#output").html(function(i,<span class="w"> </span>h)<span class="w"> </span>{
<span class="w">        </span>return<span class="w"> </span>h<span class="w"> </span>+<span class="w"> </span>text<span class="w"> </span>+<span class="w"> </span>"<span class="nt">&lt;br</span><span class="w"> </span><span class="nt">/&gt;</span>";
<span class="w">    </span>});
}


<span class="nt">&lt;script</span><span class="w"> </span><span class="na">src=</span><span class="s">"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;div</span><span class="w"> </span><span class="na">id=</span><span class="s">"el"</span><span class="nt">&gt;</span>Test<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;code&gt;</span>
<span class="w">    </span><span class="nt">&lt;span</span><span class="w"> </span><span class="na">id=</span><span class="s">"output"</span><span class="nt">&gt;&lt;/span&gt;</span>
<span class="nt">&lt;/code&gt;</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/is-it-possible-to-force-excel-recognize-utf-8-csv-files-automatically/" class="u-url">Is it possible to force Excel recognize UTF-8 CSV files automatically?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/is-it-possible-to-force-excel-recognize-utf-8-csv-files-automatically/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T01:27:55+08:00" itemprop="datePublished" title="2023-02-18 01:27">2023-02-18 01:27</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I'm developing a part of an application that's responsible for exporting some
data into CSV files. The application always uses UTF-8 because of its
multilingual nature at all levels. But opening such CSV files (containing e.g.
diacritics, cyrillic letters, Greek letters) in Excel does not achieve the
expected results showing something like <code>Г„/Г¤, Г–/Г¶</code>. And I don't know how
to force Excel understand that the open CSV file is encoded in UTF-8. I also
tried specifying UTF-8 BOM <code>EF BB BF</code>, but Excel ignores that.</p>
<p>Is there any workaround?</p>
<p>P.S. Which tools may potentially behave like Excel does?</p>
<hr>
<p>UPDATE</p>
<p>I have to say that I've confused the community with the formulation of the
question. When I was asking this question, I asked for a way of opening a
UTF-8 CSV file in Excel without any problems for a user, in a fluent and
transparent way. However, I used a wrong formulation asking for doing it
<em>automatically</em>. That is very confusing and it clashes with VBA macro
automation. There are two answers for this questions that I appreciate the
most: the very first answer by Alex
https://stackoverflow.com/a/6002338/166589, and I've accepted this answer; and
the second one by Mark https://stackoverflow.com/a/6488070/166589 that have
appeared a little later. From the usability point of view, Excel seemed to
have lack of a good user-friendly UTF-8 CSV support, so I consider <em>both</em>
answers are correct, and I have accepted Alex's answer first because it really
stated that Excel was not able to do that transparently. That is what I
confused with <em>automatically</em> here. Mark's answer promotes a more complicated
way for more advanced users to achieve the expected result. Both answers are
great, but Alex's one fits my not clearly specified question a little better.</p>
<hr>
<p>UPDATE 2</p>
<p>Five months later after the last edit, I've noticed that Alex's answer has
disappeared for some reason. I really hope it wasn't a technical issue and I
hope there is no more discussion on which answer is greater now. So I'm
accepting Mark's answer as the best one.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Alex is correct, but as you have to export to csv, you can give the users this
advice when opening the csv files:</p>
<ol>
<li>Save the exported file as a csv</li>
<li>Open Excel</li>
<li>Import the data using Data--&gt;Import External Data --&gt; Import Data</li>
<li>Select the file type of "csv" and browse to your file </li>
<li>In the import wizard change the File_Origin to "65001 UTF" (or choose correct language character identifier) </li>
<li>Change the Delimiter to comma</li>
<li>Select where to import to and Finish</li>
</ol>
<p>This way the special characters should show correctly.</p>
<p><br></p>
<h3>Suggest</h3>
<p>The UTF-8 Byte-order mark will clue Excel 2007+ in to the fact that you're
using UTF-8. (See this SO post).</p>
<p>In case anybody is having the same issues I was, .NET's UTF8 encoding class
does not output a byte-order marker in a <code>GetBytes()</code> call. You need to use
streams (or use a workaround) to get the BOM to output.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-1111.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-1109.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
