<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 2777) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-2777.html">
<link rel="prev" href="index-2778.html" type="text/html">
<link rel="next" href="index-2776.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/why-do-i-have-to-git-push-set-upstream-origin-branch/" class="u-url">Why do I have to "git push --set-upstream origin &lt;branch&gt;"?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/why-do-i-have-to-git-push-set-upstream-origin-branch/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-05T17:12:34+08:00" itemprop="datePublished" title="2023-03-05 17:12">2023-03-05 17:12</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I created a local branch for testing Solaris and Sun Studio. I then pushed the
branch upstream. After committing a change and attempting to push the changes:</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span>git<span class="w"> </span>commit<span class="w"> </span>blake2.cpp<span class="w"> </span>-m<span class="w"> </span><span class="s2">"Add workaround for missing _mm_set_epi64x"</span>
<span class="o">[</span>solaris<span class="w"> </span>7ad22ff<span class="o">]</span><span class="w"> </span>Add<span class="w"> </span>workaround<span class="w"> </span><span class="k">for</span><span class="w"> </span>missing<span class="w"> </span>_mm_set_epi64x
<span class="w"> </span><span class="m">1</span><span class="w"> </span>file<span class="w"> </span>changed,<span class="w"> </span><span class="m">5</span><span class="w"> </span>insertions<span class="o">(</span>+<span class="o">)</span>
$<span class="w"> </span>git<span class="w"> </span>push
fatal:<span class="w"> </span>The<span class="w"> </span>current<span class="w"> </span>branch<span class="w"> </span>solaris<span class="w"> </span>has<span class="w"> </span>no<span class="w"> </span>upstream<span class="w"> </span>branch.
To<span class="w"> </span>push<span class="w"> </span>the<span class="w"> </span>current<span class="w"> </span>branch<span class="w"> </span>and<span class="w"> </span><span class="nb">set</span><span class="w"> </span>the<span class="w"> </span>remote<span class="w"> </span>as<span class="w"> </span>upstream,<span class="w"> </span>use

<span class="w">    </span>git<span class="w"> </span>push<span class="w"> </span>--set-upstream<span class="w"> </span>origin<span class="w"> </span>solaris
</pre></div>

<p>Why do I have to do something special for this?</p>
<p>Is there any reasonable use case where someone would create <code>&lt;branch&gt;</code>, push
the <code>&lt;branch&gt;</code> to remote, and then claim a commit on <code>&lt;branch&gt;</code> is not
supposed to be for <code>&lt;branch&gt;</code>?</p>
<hr>
<p>I followed this question and answer on Stack Overflow: Push a new local branch
to a remote Git repository and track it too. I'm guessing its another instance
of a incomplete or wrong accepted answer. Or, its another instance of Git
taking a simple task and making it difficult.</p>
<hr>
<p>Here's the view on a different machine. The branch clearly exists, so it was
created and pushed:</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span>git<span class="w"> </span>branch<span class="w"> </span>-a
<span class="w">  </span>alignas
*<span class="w"> </span>master
<span class="w">  </span>remotes/origin/HEAD<span class="w"> </span>-&gt;<span class="w"> </span>origin/master
<span class="w">  </span>remotes/origin/alignas
<span class="w">  </span>remotes/origin/arm-neon
<span class="w">  </span>remotes/origin/det-sig
<span class="w">  </span>remotes/origin/master
<span class="w">  </span>remotes/origin/solaris
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<h4>TL;DR: <code>git branch --set-upstream-to origin/solaris</code>
</h4>
<hr>
<p>The answer to the question you asked—which I'll rephrase a bit as "do I have
to set an upstream"—is: no, you don't <em>have</em> to set an upstream at all.</p>
<p>If you do not have upstream for the current branch, however, Git changes its
behavior on <code>git push</code>, and on other commands as well.</p>
<p>The complete push story here is long and boring and goes back in history to
before Git version 1.5. To shorten it a whole lot, <code>git push</code> was implemented
poorly.1 As of Git version 2.0, Git now has a configuration knob spelled
<code>push.default</code> which now defaults to <code>simple</code>. For several versions of Git
before and after 2.0, every time you ran <code>git push</code>, Git would spew lots of
noise trying to convince you to set <code>push.default</code> just to get <code>git push</code> to
shut up.</p>
<p>You do not mention which version of Git you are running, nor whether you have
configured <code>push.default</code>, so we must guess. My guess is that you are using
Git version 2-point-something, and that you have set <code>push.default</code> to
<code>simple</code> to get it to shut up. Precisely which version of Git you have, and
what if anything you have <code>push.default</code> set to, <em>does</em> matter, due to that
long and boring history, but in the end, the fact that you're getting yet
another complaint from Git indicates that your Git <em>is</em> configured to avoid
one of the mistakes from the past.</p>
<h4>What is an upstream?</h4>
<p>An <em>upstream</em> is simply another branch name, usually a remote-tracking branch,
associated with a (regular, local) branch.</p>
<p>Every branch has the option of having one (1) upstream set. That is, every
branch either has an upstream, or does not have an upstream. No branch can
have more than one upstream.</p>
<p>The upstream <em>should</em> , but does not have to be, a valid branch (whether
remote-tracking like <code>origin/ _B_</code> or local like <code>master</code>). That is, if the
current branch <em>B</em> has upstream <em>U</em> , <code>git rev-parse _U_</code> <em>should</em> work. If it
does not work—if it complains that <em>U</em> does not exist—then most of Git acts as
though the upstream is not set at all. A few commands, like <code>git branch -vv</code>,
will show the upstream setting but mark it as "gone".</p>
<h4>What good is an upstream?</h4>
<p>If your <code>push.default</code> is set to <code>simple</code> or <code>upstream</code>, the upstream setting
will make <code>git push</code>, used with no additional arguments, just work.</p>
<p>That's it—that's all it does for <code>git push</code>. But that's fairly significant,
since <code>git push</code> is one of the places where a simple typo causes major
headaches.</p>
<p>If your <code>push.default</code> is set to <code>nothing</code>, <code>matching</code>, or <code>current</code>, setting
an upstream does nothing at all for <code>git push</code>.</p>
<p>(All of this assumes your Git version is at least 2.0.)</p>
<h4>The upstream affects <code>git fetch</code>
</h4>
<p>If you run <code>git fetch</code> with no additional arguments, Git figures out <em>which</em>
remote to fetch from by consulting the current branch's upstream. If the
upstream is a remote-tracking branch, Git fetches from that remote. (If the
upstream is not set or is a local branch, Git tries fetching <code>origin</code>.)</p>
<h4>The upstream affects <code>git merge</code> and <code>git rebase</code> too</h4>
<p>If you run <code>git merge</code> or <code>git rebase</code> with no additional arguments, Git uses
the current branch's upstream. So it shortens the use of these two commands.</p>
<h4>The upstream affects <code>git pull</code>
</h4>
<p>You should never2 use <code>git pull</code> anyway, but if you do, <code>git pull</code> uses the
upstream setting to figure out which remote to fetch from, and then which
branch to merge or rebase with. That is, <code>git pull</code> does the same thing as
<code>git fetch</code>—because it actually <em>runs</em> <code>git fetch</code>—and then does the same
thing as <code>git merge</code> or <code>git rebase</code>, because it actually <em>runs</em> <code>git merge</code>
or <code>git rebase</code>.</p>
<p>(You should usually just do these two steps manually, at least until you know
Git well enough that when either step fails, which they will eventually, you
recognize what went wrong and know what to do about it.)</p>
<h4>The upstream affects <code>git status</code>
</h4>
<p>This may actually be the most important. Once you have an upstream set, <code>git
status</code> can report the difference between your current branch and its
upstream, in terms of commits.</p>
<p>If, as is the normal case, you are on branch <em><code>B</code></em> with its upstream set to
<code>origin/ _B_</code>, and you run <code>git status</code>, you will immediately see whether you
have commits you can push, and/or commits you can merge or rebase onto.</p>
<p>This is because <code>git status</code> runs:</p>
<ul>
<li>
<code>git rev-list --count @{u}..HEAD</code>: how many commits do you have on <em><code>B</code></em> that are not on <code>origin/ _B_</code>?</li>
<li>
<code>git rev-list --count HEAD..@{u}</code>: how many commits do you have on <code>origin/ _B_</code> that are not on <em><code>B</code></em>?</li>
</ul>
<p>Setting an upstream gives you all of these things.</p>
<h4>How come <code>master</code> already has an upstream set?</h4>
<p>When you first clone from some remote, using:</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>git://some.host/path/to/repo.git
</pre></div>

<p>or similar, the last step Git does is, essentially, <code>git checkout master</code>.
This checks out your local branch <code>master</code>—only you don't <em>have</em> a local
branch <code>master</code>.</p>
<p>On the other hand, you <em>do</em> have a remote-tracking branch named
<code>origin/master</code>, because you just cloned it.</p>
<p>Git guesses that you must have meant: "make me a new local <code>master</code> that
points to the same commit as remote-tracking <code>origin/master</code>, and, while
you're at it, set the upstream for <code>master</code> to <code>origin/master</code>."</p>
<p>This happens for <em>every</em> branch you <code>git checkout</code> that you do not already
have. Git creates the branch <em>and</em> makes it "track" (have as an upstream) the
corresponding remote-tracking branch.</p>
<h4>But this doesn't work for <em>new</em> branches, i.e., branches with no remote-</h4>
<p>tracking branch <em>yet</em>.</p>
<p>If you create a <em>new</em> branch:</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span>git<span class="w"> </span>checkout<span class="w"> </span>-b<span class="w"> </span>solaris
</pre></div>

<p>there is, as yet, no <code>origin/solaris</code>. Your local <code>solaris</code> <em>cannot</em> track
remote-tracking branch <code>origin/solaris</code> because it does not exist.</p>
<p>When you first push the new branch:</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span>git<span class="w"> </span>push<span class="w"> </span>origin<span class="w"> </span>solaris
</pre></div>

<p>that <em>creates</em> <code>solaris</code> on <code>origin</code>, and hence also creates <code>origin/solaris</code>
in your own Git repository. But it's too late: you already have a local
<code>solaris</code> that <em>has no upstream</em>.3</p>
<h4>Shouldn't Git just set that, now, as the upstream automatically?</h4>
<p>Probably. See "implemented poorly" and footnote 1. It's hard to change <em>now</em> :
There are millions4 of scripts that use Git and some may well depend on its
current behavior. Changing the behavior requires a new major release, nag-ware
to force you to set some configuration field, and so on. In short, Git is a
victim of its own success: whatever mistakes it has in it, today, can only be
fixed if the change is either mostly invisible, clearly-much-better, or done
slowly over time.</p>
<p>The fact is, it doesn't today, <em>unless</em> you use <code>--set-upstream</code> or <code>-u</code>
during the <code>git push</code>. That's what the message is telling you.</p>
<p>You don't have to do it like that. Well, as we noted above, you don't have to
do it at all, but let's say you <em>want</em> an upstream. You have already created
branch <code>solaris</code> on <code>origin</code>, through an earlier push, and as your <code>git
branch</code> output shows, you already <em>have</em> <code>origin/solaris</code> in your local
repository.</p>
<p>You just don't have it set as the upstream for <code>solaris</code>.</p>
<p>To set it now, rather than during the first push, use <code>git branch --set-
upstream-to</code>. The <code>--set-upstream-to</code> sub-command takes the name of any
existing branch, such as <code>origin/solaris</code>, and sets the current branch's
upstream to that other branch.</p>
<p>That's it—that's all it does—but it has all those implications noted above. It
means you can just run <code>git fetch</code>, then look around, then run <code>git merge</code> or
<code>git rebase</code> as appropriate, then make new commits and run <code>git push</code>, without
a bunch of additional fussing-around.</p>
<hr>
<p>1To be fair, it was not clear back then that the initial implementation was
error-prone. That only became clear when every new user made the same mistakes
every time. It's now "less poor", which is not to say "great".</p>
<p>2"Never" is a bit strong, but I find that Git newbies understand things a lot
better when I separate out the steps, especially when I can show them what
<code>git fetch</code> actually did, and they can then see what <code>git merge</code> or <code>git
rebase</code> will do next.</p>
<p>3If you run your <em>first</em> <code>git push</code> as <code>git push -u origin solaris</code>—i.e., if
you add the <code>-u</code> flag—Git will set <code>origin/solaris</code> as the upstream for your
current branch if (and only if) the push succeeds. So you should supply <code>-u</code>
on the <em>first</em> push. In fact, you can supply it on any later push, and it will
set <em>or change</em> the upstream at that point. But I think <code>git branch --set-
upstream-to</code> is easier, if you forgot.</p>
<p>4Measured by the Austin Powers / Dr Evil method of simply saying "one MILLLL-
YUN", anyway.</p>
<p><br></p>
<h3>Suggest</h3>
<p>The difference between</p>
<div class="code"><pre class="code literal-block">git push origin &lt;branch&gt;
</pre></div>

<p>and</p>
<div class="code"><pre class="code literal-block">git push --set-upstream origin &lt;branch&gt;
</pre></div>

<p>is that they both push just fine to the remote repository, but it's when you
pull that you notice the difference.</p>
<p>If you do:</p>
<div class="code"><pre class="code literal-block">git push origin &lt;branch&gt;
</pre></div>

<p>when pulling, you have to do:</p>
<div class="code"><pre class="code literal-block">git pull origin &lt;branch&gt;
</pre></div>

<p>But if you do:</p>
<div class="code"><pre class="code literal-block">git push --set-upstream origin &lt;branch&gt;
</pre></div>

<p>then, when pulling, you only have to do:</p>
<div class="code"><pre class="code literal-block">git pull
</pre></div>

<p>So adding in the <code>--set-upstream</code> allows for not having to specify which
branch that you want to pull from every single time that you do <code>git pull</code>.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/what-is-a-practical-use-for-a-closure-in-javascript/" class="u-url">What is a practical use for a closure in JavaScript?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/what-is-a-practical-use-for-a-closure-in-javascript/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-05T17:10:56+08:00" itemprop="datePublished" title="2023-03-05 17:10">2023-03-05 17:10</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I'm trying my hardest to wrap my head around JavaScript closures.</p>
<p>I get that by returning an inner function, it will have access to any variable
defined in its immediate parent.</p>
<p>Where would this be useful to me? Perhaps I haven't quite got my head around
it yet. Most of the examples I have seen online don't provide any real world
code, just vague examples.</p>
<p>Can someone show me a real world use of a closure?</p>
<p>Is this one, for example?</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">warnUser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="p">(</span><span class="n">msg</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">calledCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">       </span><span class="n">calledCount</span><span class="o">++</span><span class="p">;</span>
<span class="w">       </span><span class="n">alert</span><span class="p">(</span><span class="n">msg</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">'</span><span class="se">\n</span><span class="s1">You have been warned '</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">calledCount</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">' times.'</span><span class="p">);</span>
<span class="w">    </span><span class="p">};</span>
<span class="p">};</span>

<span class="k">var</span><span class="w"> </span><span class="n">warnForTamper</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">warnUser</span><span class="p">(</span><span class="s1">'You can not tamper with our HTML.'</span><span class="p">);</span>
<span class="n">warnForTamper</span><span class="p">();</span>
<span class="n">warnForTamper</span><span class="p">();</span>
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<p>I've used closures to do things like:</p>
<div class="code"><pre class="code literal-block"><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">privatefunction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">alert</span><span class="p">(</span><span class="s1">'hello'</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">publicfunction</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">privatefunction</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">})();</span>
</pre></div>

<p>As you can see there, <code>a</code> is now an object, with a method <code>publicfunction</code> (
<code>a.publicfunction()</code> ) which calls <code>privatefunction</code>, which only exists inside
the closure. You can <strong>not</strong> call <code>privatefunction</code> directly (i.e.
<code>a.privatefunction()</code> ), just <code>publicfunction()</code>.</p>
<p>It's a minimal example, but maybe you can see uses to it? We used this to
enforce public/private methods.</p>
<p><br></p>
<h3>Suggest</h3>
<p>I've used closures to do things like:</p>
<div class="code"><pre class="code literal-block"><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">privatefunction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">alert</span><span class="p">(</span><span class="s1">'hello'</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">publicfunction</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">privatefunction</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">})();</span>
</pre></div>

<p>As you can see there, <code>a</code> is now an object, with a method <code>publicfunction</code> (
<code>a.publicfunction()</code> ) which calls <code>privatefunction</code>, which only exists inside
the closure. You can <strong>not</strong> call <code>privatefunction</code> directly (i.e.
<code>a.privatefunction()</code> ), just <code>publicfunction()</code>.</p>
<p>It's a minimal example, but maybe you can see uses to it? We used this to
enforce public/private methods.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/convert-columns-to-string-in-pandas/" class="u-url">Convert columns to string in Pandas</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/convert-columns-to-string-in-pandas/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-05T17:09:37+08:00" itemprop="datePublished" title="2023-03-05 17:09">2023-03-05 17:09</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I have the following DataFrame from a SQL query:</p>
<div class="code"><pre class="code literal-block">(Pdb) pp total_rows
     ColumnID  RespondentCount
0          -1                2
1  3030096843                1
2  3030096845                1
</pre></div>

<p>and I pivot it like this:</p>
<div class="code"><pre class="code literal-block">total_data = total_rows.pivot_table(cols=['ColumnID'])
</pre></div>

<p>which produces</p>
<div class="code"><pre class="code literal-block">(Pdb) pp total_data
ColumnID         -1            3030096843   3030096845
RespondentCount            2            1            1

[1 rows x 3 columns]
</pre></div>

<p>When I convert this dataframe into a dictionary (using
<code>total_data.to_dict('records')[0]</code>), I get</p>
<div class="code"><pre class="code literal-block">{3030096843: 1, 3030096845: 1, -1: 2}
</pre></div>

<p>but I want to make sure the 303 columns are cast as strings instead of
integers so that I get this:</p>
<div class="code"><pre class="code literal-block">{'3030096843': 1, '3030096845': 1, -1: 2}
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<p>One way to convert to string is to use astype:</p>
<div class="code"><pre class="code literal-block">total_rows['ColumnID'] = total_rows['ColumnID'].astype(str)
</pre></div>

<p>However, perhaps you are looking for the <code>to_json</code> function, which will
convert keys to valid json (and therefore your keys to strings):</p>
<div class="code"><pre class="code literal-block">In [11]: df = pd.DataFrame([['A', 2], ['A', 4], ['B', 6]])

In [12]: df.to_json()
Out[12]: '{"0":{"0":"A","1":"A","2":"B"},"1":{"0":2,"1":4,"2":6}}'

In [13]: df[0].to_json()
Out[13]: '{"0":"A","1":"A","2":"B"}'
</pre></div>

<p><em>Note: you can pass in a buffer/file to save this to, along with some other
options...</em></p>
<p><br></p>
<h3>Suggest</h3>
<p>If you need to convert ALL columns to strings, you can simply use:</p>
<div class="code"><pre class="code literal-block">df = df.astype(str)
</pre></div>

<p>This is useful if you need everything except a few columns to be
strings/objects, then go back and convert the other ones to whatever you need
(integer in this case):</p>
<div class="code"><pre class="code literal-block"> df[["D", "E"]] = df[["D", "E"]].astype(int)
</pre></div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-2778.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-2776.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
