<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 2318) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-2318.html">
<link rel="prev" href="index-2319.html" type="text/html">
<link rel="next" href="index-2317.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/why-do-you-need-to-invoke-an-anonymous-function-on-the-same-line/" class="u-url">Why do you need to invoke an anonymous function on the same line?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/why-do-you-need-to-invoke-an-anonymous-function-on-the-same-line/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T07:15:21+08:00" itemprop="datePublished" title="2023-03-04 07:15">2023-03-04 07:15</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I was reading some posts about closures and saw this everywhere, but there is
no clear explanation how it works - everytime I was just told to use it...:</p>
<div class="code"><pre class="code literal-block"><span class="o">//</span><span class="w"> </span><span class="n">Create</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">anonymous</span><span class="w"> </span><span class="n">function</span><span class="p">,</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">use</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">wrapper</span>
<span class="p">(</span><span class="n">function</span><span class="p">(){</span>
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">would</span><span class="p">,</span><span class="w"> </span><span class="n">normally</span><span class="p">,</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">global</span>
<span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Thanks for visiting!"</span><span class="p">;</span>

<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="n">Binding</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">global</span><span class="w"> </span><span class="n">object</span>
<span class="w">    </span><span class="n">window</span><span class="o">.</span><span class="n">onunload</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">function</span><span class="p">(){</span>
<span class="w">        </span><span class="o">//</span><span class="w"> </span><span class="n">Which</span><span class="w"> </span><span class="n">uses</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="s1">'hidden'</span><span class="w"> </span><span class="n">variable</span>
<span class="w">        </span><span class="n">alert</span><span class="p">(</span><span class="w"> </span><span class="n">msg</span><span class="w"> </span><span class="p">);</span>
<span class="w">    </span><span class="p">};</span>
<span class="o">//</span><span class="w"> </span><span class="n">Close</span><span class="w"> </span><span class="n">off</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">anonymous</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">it</span>
<span class="p">})();</span>
</pre></div>

<p>Ok I see that we will create new anonymous function and then execute it. So
after that this simple code should work (and it does):</p>
<div class="code"><pre class="code literal-block">(function (msg){alert(msg)})('SO');
</pre></div>

<p>My question is what kind of magic happens here? I thought that when I wrote:</p>
<div class="code"><pre class="code literal-block">(function (msg){alert(msg)})
</pre></div>

<p>then a new unnamed function would be created like function ""(msg) ...</p>
<p>but then why doesn't this work?</p>
<div class="code"><pre class="code literal-block">(function (msg){alert(msg)});
('SO');
</pre></div>

<p>Why does it need to be in the same line?</p>
<p>Could you please point me some posts or give me an explanation?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Drop the semicolon after the function definition.</p>
<div class="code"><pre class="code literal-block">(function (msg){alert(msg)})
('SO');
</pre></div>

<p>Above should work.</p>
<p>DEMO Page: https://jsfiddle.net/e7ooeq6m/</p>
<p>I have discussed this kind of pattern in this post:</p>
<p>jQuery and $ questions</p>
<p><strong>EDIT:</strong></p>
<p>If you look at ECMA script specification, there are 3 ways you can define a
function. (Page 98, Section 13 Function Definition)</p>
<h3>1. Using Function constructor</h3>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">sum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">Function</span><span class="p">(</span><span class="s1">'a'</span><span class="p">,</span><span class="s1">'b'</span><span class="p">,</span><span class="w"> </span><span class="s1">'return a + b;'</span><span class="p">);</span>
<span class="n">alert</span><span class="p">(</span><span class="n">sum</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">));</span><span class="w"> </span><span class="o">//</span><span class="n">alerts</span><span class="w"> </span><span class="mi">30</span>
</pre></div>

<h3>2. Using Function declaration.</h3>
<div class="code"><pre class="code literal-block"><span class="k">function</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span>a, b<span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">alert</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">));</span><span class="w"> </span><span class="o">//</span><span class="n">Alerts</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span>
</pre></div>

<h3>3. Function Expression</h3>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">sum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">function</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>

<span class="n">alert</span><span class="p">(</span><span class="n">sum</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">));</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">alerts</span><span class="w"> </span><span class="mi">10</span>
</pre></div>

<p>So you may ask, what's the difference between declaration and expression?</p>
<p>From ECMA Script specification:</p>
<blockquote>
<p>FunctionDeclaration : function Identifier ( FormalParameterListopt ){
FunctionBody }</p>
<p>FunctionExpression : function Identifieropt ( FormalParameterListopt ){
FunctionBody }</p>
</blockquote>
<p>If you notice, 'identifier' is <strong>optional</strong> for function expression. And when
you don't give an identifier, you create an anonymous function. It doesn't
mean that you can't specify an identifier.</p>
<p>This means following is valid.</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">sum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">mySum</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
</pre></div>

<p>Important point to note is that you can use 'mySum' only inside the mySum
function body, not outside. See following example:</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">test1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">test2</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">alert</span><span class="p">(</span><span class="nb">typeof</span><span class="w"> </span><span class="n">test2</span><span class="p">);</span><span class="w"> </span><span class="p">}</span>

<span class="n">alert</span><span class="p">(</span><span class="nb">typeof</span><span class="p">(</span><span class="n">test2</span><span class="p">));</span><span class="w"> </span><span class="o">//</span><span class="n">alerts</span><span class="w"> </span><span class="s1">'undefined'</span><span class="p">,</span><span class="w"> </span><span class="n">surprise</span><span class="o">!</span>

<span class="n">test1</span><span class="p">();</span><span class="w"> </span><span class="o">//</span><span class="n">alerts</span><span class="w"> </span><span class="s1">'function'</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">test2</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">function</span><span class="o">.</span>
</pre></div>

<p>Live Demo</p>
<p>Compare this to</p>
<div class="code"><pre class="code literal-block"> function test1() { alert(typeof test1) };

 alert(typeof test1); //alerts 'function'

 test1(); //alerts 'function'
</pre></div>

<hr>
<p>Armed with this knowledge, let's try to analyze your code.</p>
<p>When you have code like,</p>
<div class="code"><pre class="code literal-block">    function(msg) { alert(msg); }
</pre></div>

<p>You created a function expression. And you can execute this function
expression by wrapping it inside parenthesis.</p>
<div class="code"><pre class="code literal-block">    (function(msg) { alert(msg); })('SO'); //alerts SO.
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>It's called a self-invoked function.</p>
<p>What you are doing when you call <code>(function(){})</code> is returning a function
object. When you append <code>()</code> to it, it is invoked and anything in the body is
executed. The <code>;</code> denotes the end of the statement, that's why the 2nd
invocation fails.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/what-does-bundle-exec-rake-mean/" class="u-url">What does bundle exec rake mean?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/what-does-bundle-exec-rake-mean/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T07:13:57+08:00" itemprop="datePublished" title="2023-03-04 07:13">2023-03-04 07:13</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>What does <code>bundle exec rake db:migrate</code> mean? Or just <code>bundle exec rake
&lt;command&gt;</code> in general?</p>
<p>I understand that <code>bundle</code> takes care of maintaining things in the Gemfile. I
know what the word "exec" means. I understand that <code>rake</code> maintains all the
different scripty things you can do, and I know that <code>db:migrate</code> is one of
those. I just don't know what all these words are doing together. Why should
<code>bundle</code> be used to execute <code>rake</code> to execute a database migrate?</p>
<p><br><br></p>
<h2>Answer</h2>
<p><code>bundle exec</code> is a Bundler command to execute a script in the context of the
current bundle (the one from your directory's Gemfile). <code>rake db:migrate</code> is
the script where <em>db</em> is the namespace and <em>migrate</em> is the task name defined.</p>
<p>So <code>bundle exec rake db:migrate</code> executes the rake script with the command
<code>db:migrate</code> in the context of the current bundle.</p>
<p>As to the "why?" I'll quote from the bundler page:</p>
<blockquote>
<p>In some cases, running executables without <code>bundle exec</code> may work, if the
executable happens to be installed in your system and does not pull in any
gems that conflict with your bundle.</p>
<p>However, this is unreliable and is the source of considerable pain. Even if
it looks like it works, it may not work in the future or on another machine.</p>
</blockquote>
<p><br></p>
<h3>Suggest</h3>
<p>You're running <code>bundle exec</code> on a program. The program's creators wrote it
when certain versions of gems were available. The program Gemfile specifies
the versions of the gems the creators decided to use. That is, the script was
made to run correctly against these gem versions.</p>
<p>Your system-wide Gemfile may differ from this Gemfile. You may have newer or
older gems with which this script doesn't play nice. This difference in
versions can give you weird errors.</p>
<p><code>bundle exec</code> helps you avoid these errors. It executes the script using the
gems specified in the script's Gemfile rather than the systemwide Gemfile. It
executes the certain gem versions with the magic of shell aliases.</p>
<p>See more on the man page.</p>
<p>Here's an example Gemfile:</p>
<div class="code"><pre class="code literal-block">source 'http://rubygems.org'

gem 'rails', '2.8.3'
</pre></div>

<p>Here, <code>bundle exec</code> would execute the script using rails version 2.8.3 and not
some other version you may have installed system-wide.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/why-avoid-increment-and-decrement-operators-in-javascript/" class="u-url">Why avoid increment ("++") and decrement ("--") operators in JavaScript?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/why-avoid-increment-and-decrement-operators-in-javascript/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T07:12:24+08:00" itemprop="datePublished" title="2023-03-04 07:12">2023-03-04 07:12</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>One of the tips for <code>jslint</code> tool is:</p>
<blockquote>
<p><strong><code>++</code> and <code>--</code></strong><br>
 The <code>++</code> (increment) and <code>--</code> (decrement) operators have been known to
contribute to bad code by encouraging excessive trickiness. They are second
only to faulty architecture in enabling to viruses and other security
menaces. There is a plusplus option that prohibits the use of these
operators.</p>
</blockquote>
<p>I know that PHP constructs like <code>$foo[$bar++]</code> may easily result in off-by-one
errors, but I couldn't figure out a better way to control the loop than a:</p>
<div class="code"><pre class="code literal-block"><span class="k">while</span><span class="ss">(</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="ss">)</span><span class="w"> </span><span class="k">do</span><span class="w"> </span>{<span class="w"> </span><span class="cm">/* foo */</span><span class="w"> </span><span class="nv">a</span><span class="o">++</span><span class="c1">; }</span>
</pre></div>

<p>or</p>
<div class="code"><pre class="code literal-block"><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="mi">10</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="o">/*</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">*/</span><span class="w"> </span><span class="p">}</span>
</pre></div>

<p>Is the <code>jslint</code> highlighting them because there are some similar languages
that lack the "<code>++</code>" and "<code>--</code>" syntax or handle it differently, or are there
other rationales for avoiding "<code>++</code>" and "<code>--</code>" that I might be missing?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>My view is to always use ++ and -- by themselves on a single line, as in:</p>
<div class="code"><pre class="code literal-block"><span class="n">i</span><span class="o">++</span><span class="p">;</span>
<span class="k">array</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">foo</span><span class="p">;</span>
</pre></div>

<p>instead of</p>
<div class="code"><pre class="code literal-block">array[++i] = foo;
</pre></div>

<p>Anything beyond that can be confusing to some programmers and is just not
worth it in my view. For loops are an exception, as the use of the increment
operator is idiomatic and thus always clear.</p>
<p><br></p>
<h3>Suggest</h3>
<p>There is a history in C of doing things like:</p>
<div class="code"><pre class="code literal-block"><span class="k">while</span><span class="w"> </span><span class="ss">(</span><span class="o">*</span><span class="nv">a</span><span class="o">++</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="nv">b</span><span class="o">++</span><span class="ss">)</span><span class="c1">;</span>
</pre></div>

<p>to copy a string, perhaps this is the source of the excessive trickery he is
referring to.</p>
<p>And there's always the question of what</p>
<div class="code"><pre class="code literal-block">++i = i++;
</pre></div>

<p>or</p>
<div class="code"><pre class="code literal-block">i = i++ + ++i;
</pre></div>

<p>actually do. It's defined in some languages, and in other's there's no
guarantee what will happen.</p>
<p>Those examples aside, I don't think there's anything more idiomatic than a for
loop that uses <code>++</code> to increment. In some cases you could get away with a
foreach loop, or a while loop that checked a different condtion. But
contorting your code to try and avoid using incrementing is ridiculous.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-2319.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-2317.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
