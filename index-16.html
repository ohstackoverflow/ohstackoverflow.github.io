<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 16) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-16.html">
<link rel="prev" href="index-17.html" type="text/html">
<link rel="next" href="index-15.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/ru-he-zai-javascript-zhong-yan-zheng-dian-zi-you-jian-di-zhi/" class="u-url">如何在 JavaScript 中验证电子邮件地址？</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/ru-he-zai-javascript-zhong-yan-zheng-dian-zi-you-jian-di-zhi/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-16T18:40:00+08:00" itemprop="datePublished" title="2023-02-16 18:40">2023-02-16 18:40</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p><strong>这个问题的答案是 社区的努力</strong>。编辑现有答案以改进这篇文章。它目前不接受新的答案或互动。</p>
<p>我想在将用户输入发送到服务器或尝试向其发送电子邮件之前检查用户输入是否是 JavaScript
中的电子邮件地址，以防止最基本的错误输入。我怎么能做到这一点？</p>
<p><br><br></p>
<h2>解答</h2>
<p>使用正则表达式可能是最好的方法。你可以在这里看到一堆测试（取自chromium）</p>
<div class="code"><pre class="code literal-block"><span class="k">const</span><span class="w"> </span><span class="n">validateEmail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">email</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">String</span><span class="p">(</span><span class="n">email</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">toLowerCase</span><span class="p">()</span>
<span class="w">    </span><span class="p">.</span><span class="n">match</span><span class="p">(</span>
<span class="w">      </span><span class="o">/^</span><span class="p">(([</span><span class="o">^&lt;&gt;</span><span class="p">()[</span><span class="err">\</span><span class="p">]</span><span class="err">\\</span><span class="p">.,;</span><span class="o">:</span><span class="err">\</span><span class="n">s</span><span class="s">@"]+(\.[^&lt;&gt;()[\]</span><span class="se">\\</span><span class="s">.,;:\s@"</span><span class="p">]</span><span class="o">+</span><span class="p">)</span><span class="o">*</span><span class="p">)</span><span class="o">|</span><span class="p">(</span><span class="s">".+"</span><span class="p">))</span><span class="l">@(</span><span class="p">(</span><span class="err">\</span><span class="p">[[</span><span class="mi">0-9</span><span class="p">]{</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">}</span><span class="err">\</span><span class="p">.[</span><span class="mi">0-9</span><span class="p">]{</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">}</span><span class="err">\</span><span class="p">.[</span><span class="mi">0-9</span><span class="p">]{</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">}</span><span class="err">\</span><span class="p">.[</span><span class="mi">0-9</span><span class="p">]{</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">}</span><span class="err">\</span><span class="p">])</span><span class="o">|</span><span class="p">(([</span><span class="n">a</span><span class="o">-</span><span class="n">zA</span><span class="o">-</span><span class="n">Z</span><span class="err">\</span><span class="mi">-0-9</span><span class="p">]</span><span class="o">+</span><span class="err">\</span><span class="p">.)</span><span class="o">+</span><span class="p">[</span><span class="n">a</span><span class="o">-</span><span class="n">zA</span><span class="o">-</span><span class="n">Z</span><span class="p">]{</span><span class="mi">2</span><span class="p">,}))</span><span class="n">$</span><span class="o">/</span>
<span class="w">    </span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

<p>下面是接受 unicode 的正则表达式示例：</p>
<div class="code"><pre class="code literal-block"><span class="k">const</span><span class="w"> </span><span class="n">re</span><span class="w"> </span><span class="o">=</span>
<span class="w">  </span><span class="o">/^</span><span class="p">(([</span><span class="o">^&lt;&gt;</span><span class="p">()[</span>\<span class="p">]</span>\<span class="o">.</span><span class="p">,;:</span>\<span class="n">s</span><span class="err">@</span>\<span class="s2">"]+(\.[^&lt;&gt;()[\]\.,;:\s@</span><span class="se">\"</span><span class="s2">]+)*)|(</span><span class="se">\"</span><span class="s2">.+</span><span class="se">\"</span><span class="s2">))@(([^&lt;&gt;()[\]\.,;:\s@</span><span class="se">\"</span><span class="s2">]+\.)+[^&lt;&gt;()[\]\.,;:\s@</span><span class="se">\"</span><span class="s2">]{2,})$/i;</span>
</pre></div>

<p>但请记住，不应仅依赖 JavaScript 验证。JavaScript 很容易被禁用。这也应该在服务器端进行验证。</p>
<p>这是上面的一个例子：</p>
<div class="code"><pre class="code literal-block">const<span class="w"> </span>validateEmail<span class="w"> </span>=<span class="w"> </span>(email)<span class="w"> </span>=&gt;<span class="w"> </span>{
<span class="w">  </span>return<span class="w"> </span>email.match(
<span class="w">    </span>/^(([^<span class="err">&lt;</span>&gt;()[\]\\.,;:\s@\"]+(\.[^<span class="err">&lt;</span>&gt;()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/
<span class="w">  </span>);
};

const<span class="w"> </span>validate<span class="w"> </span>=<span class="w"> </span>()<span class="w"> </span>=&gt;<span class="w"> </span>{
<span class="w">  </span>const<span class="w"> </span>$result<span class="w"> </span>=<span class="w"> </span>$('#result');
<span class="w">  </span>const<span class="w"> </span>email<span class="w"> </span>=<span class="w"> </span>$('#email').val();
<span class="w">  </span>$result.text('');

<span class="w">  </span>if<span class="w"> </span>(validateEmail(email))<span class="w"> </span>{
<span class="w">    </span>$result.text(email<span class="w"> </span>+<span class="w"> </span>'<span class="w"> </span>is<span class="w"> </span>valid<span class="w"> </span>:)');
<span class="w">    </span>$result.css('color',<span class="w"> </span>'green');
<span class="w">  </span>}<span class="w"> </span>else<span class="w"> </span>{
<span class="w">    </span>$result.text(email<span class="w"> </span>+<span class="w"> </span>'<span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>valid<span class="w"> </span>:(');
<span class="w">    </span>$result.css('color',<span class="w"> </span>'red');
<span class="w">  </span>}
<span class="w">  </span>return<span class="w"> </span>false;
}

$('#email').on('input',<span class="w"> </span>validate);


<span class="nt">&lt;script</span><span class="w"> </span><span class="na">src=</span><span class="s">"https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>

<span class="nt">&lt;label</span><span class="w"> </span><span class="na">for=</span><span class="s">"email"</span><span class="nt">&gt;</span>Enter<span class="w"> </span>an<span class="w"> </span>email<span class="w"> </span>address:<span class="w"> </span><span class="nt">&lt;/label&gt;</span>
<span class="nt">&lt;input</span><span class="w"> </span><span class="na">id=</span><span class="s">"email"</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="nt">&lt;h2</span><span class="w"> </span><span class="na">id=</span><span class="s">"result"</span><span class="nt">&gt;&lt;/h2&gt;</span>
</pre></div>

<p><br></p>
<h3>更多建议</h3>
<p>对于那些想要以以下形式进行真正简单验证的人，我稍微修改了Jaymon 的回答：</p>
<div class="code"><pre class="code literal-block"><span class="n">anystring</span><span class="nv">@anystring</span><span class="p">.</span><span class="n">anystring</span>
</pre></div>

<p>正则表达式：</p>
<div class="code"><pre class="code literal-block">/^\S+@\S+\.\S+$/
</pre></div>

<p>为防止匹配多个 @ 符号：</p>
<div class="code"><pre class="code literal-block">/^[^\s@]+@[^\s@]+\.[^\s@]+$/
</pre></div>

<p>上面的正则表达式匹配整个字符串，如果要匹配字符串中的任何位置，请删除前导和<code>^</code>尾随。<code>$</code>下面的示例匹配字符串中的 <em>任何位置。</em></p>
<p>如果您确实想要匹配整个字符串，您可能需要<code>trim()</code>先匹配字符串。</p>
<p>示例 JavaScript 函数：</p>
<div class="code"><pre class="code literal-block"><span class="n">function</span><span class="w"> </span><span class="n">validateEmail</span><span class="p">(</span><span class="n">email</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">var</span><span class="w"> </span><span class="n">re</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">/</span>\<span class="n">S</span><span class="o">+</span><span class="err">@</span>\<span class="n">S</span><span class="o">+</span>\<span class="o">.</span>\<span class="n">S</span><span class="o">+/</span><span class="p">;</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">re</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="n">email</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">validateEmail</span><span class="p">(</span><span class="s1">'my email is anystring@anystring.any'</span><span class="p">));</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="bp">true</span>

<span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">validateEmail</span><span class="p">(</span><span class="s1">'my email is anystring@anystring .any'</span><span class="p">));</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="bp">false</span>
</pre></div>

<p><br><br><a href="posts/how-can-i-validate-an-email-address-in-javascript/">查看原文</a></p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/ru-he-jiang-wen-jian-zhong-zhi-huo-huan-yuan-wei-te-ding-xiu-ding-ban/" class="u-url">如何将文件重置或还原为特定修订版？</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/ru-he-jiang-wen-jian-zhong-zhi-huo-huan-yuan-wei-te-ding-xiu-ding-ban/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-16T18:38:35+08:00" itemprop="datePublished" title="2023-02-16 18:38">2023-02-16 18:38</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>如何在特定提交哈希（我通过<code>git log</code>和确定<code>git diff</code>）将修改后的文件恢复到其先前的修订版？</p>
<p><br><br></p>
<h2>解答</h2>
<p>假设您想要的提交的哈希是<code>c5f567</code>：</p>
<div class="code"><pre class="code literal-block">git checkout c5f567 -- file1/to/restore file2/to/restore
</pre></div>

<p>git checkout手册页提供了更多信息。</p>
<p>如果你想恢复到之前的提交<code>c5f567</code>，追加<code>~1</code>（其中 1 是你想返回的提交数，它可以是任何东西）：</p>
<div class="code"><pre class="code literal-block">git checkout c5f567~1 -- file1/to/restore file2/to/restore
</pre></div>

<p>作为旁注，我一直对这个命令感到不舒服，因为它既用于普通事情（在分支之间更改），也用于不寻常的破坏性事情（丢弃工作目录中的更改）。</p>
<hr>
<p>还有一个新<code>git restore</code>命令专门用于恢复已修改的工作副本文件。如果你的 git 足够新，你可以使用这个命令，但是文档带有一个警告：</p>
<blockquote>
<p>此命令是实验性的。行为可能会改变。</p>
</blockquote>
<p><br></p>
<h3>更多建议</h3>
<p>您可以使用 diff 命令快速查看对文件所做的更改：</p>
<div class="code"><pre class="code literal-block">git diff &lt;commit hash&gt; &lt;filename&gt;
</pre></div>

<p>然后将特定文件恢复到该提交使用重置命令：</p>
<div class="code"><pre class="code literal-block">git reset &lt;commit hash&gt; &lt;filename&gt;
</pre></div>

<p><code>--hard</code>如果您有本地修改，您可能需要使用该选项。</p>
<p>管理航路点的一个好的工作流程是使用标签来清楚地标记时间轴中的点。我不太明白你的最后一句话，但你可能想要的是从以前的时间点分叉一个分支。为此，请使用方便的结帐命令：</p>
<div class="code"><pre class="code literal-block">git checkout &lt;commit hash&gt;
git checkout -b &lt;new branch name&gt;
</pre></div>

<p>然后，当您准备好合并这些更改时，您可以根据您的主线将其变基：</p>
<div class="code"><pre class="code literal-block">git checkout &lt;my branch&gt;
git rebase master
git checkout master
git merge &lt;my branch&gt;
</pre></div>

<p><br><br><a href="posts/how-do-i-reset-or-revert-a-file-to-a-specific-revision/">查看原文</a></p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/zai-javascript-zhong-xun-huan-for-each-yi-ge-shu-zu/" class="u-url">在 JavaScript 中循环（for each）一个数组</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/zai-javascript-zhong-xun-huan-for-each-yi-ge-shu-zu/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-16T18:38:05+08:00" itemprop="datePublished" title="2023-02-16 18:38">2023-02-16 18:38</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>如何使用 JavaScript 遍历数组中的所有条目？</p>
<p><br><br></p>
<h2>解答</h2>
<p><strong>长话短说</strong></p>
<ul>
<li>
<p><strong>你最好的选择</strong> 通常是</p>
<ul>
<li>
<p>循环<code>for-of</code>（仅限 ES2015+；规范| MDN）- 简单且<code>async</code>友好</p>
<div class="code"><pre class="code literal-block"><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">const</span><span class="w"> </span><span class="n">element</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">theArray</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="o">//</span><span class="w"> </span><span class="p">...</span><span class="k">use</span><span class="w"> </span><span class="n n-Quoted">`element`</span><span class="p">...</span>
</pre></div>

<p>}</p>
</li>
<li>
<p><code>forEach</code>（仅限 ES5+；规范| MDN）（或其亲属<code>some</code>等）- <strong>不友好</strong> <code>async</code>（但请参阅详细信息）</p>
<div class="code"><pre class="code literal-block"><span class="w">    </span><span class="n">theArray</span><span class="p">.</span><span class="n">forEach</span><span class="p">(</span><span class="n">element</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="err">{</span>
<span class="o">//</span><span class="w"> </span><span class="p">...</span><span class="k">use</span><span class="w"> </span><span class="n n-Quoted">`element`</span><span class="p">...</span>
</pre></div>

<p>});</p>
</li>
<li>
<p>一个简单的老式<code>for</code>循环——<code>async</code>友好</p>
<div class="code"><pre class="code literal-block"><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">let</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">theArray</span><span class="o">.</span><span class="n">length</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="k">const</span><span class="w"> </span><span class="n">element</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">theArray</span><span class="p">[</span><span class="n">index</span><span class="p">];</span>
<span class="o">//</span><span class="w"> </span><span class="o">...</span><span class="n">use</span><span class="w"> </span><span class="err">`</span><span class="n">element</span><span class="err">`</span><span class="o">...</span>
</pre></div>

<p>}</p>
</li>
<li>
<p><em>（很少）</em> <code>for-in</code> <em>有保障</em> -<code>async</code>友好</p>
<div class="code"><pre class="code literal-block"><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">propertyName</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">theArray</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">/*...</span><span class="k">is</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">array</span><span class="w"> </span><span class="n">element</span><span class="w"> </span><span class="n">property</span><span class="w"> </span><span class="p">(</span><span class="n">see</span><span class="w"> </span><span class="n">below</span><span class="p">)</span><span class="o">...*/</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">element</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">theArray</span><span class="p">[</span><span class="n">propertyName</span><span class="p">];</span>
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="o">...</span><span class="n">use</span><span class="w"> </span><span class="err">`</span><span class="n">element</span><span class="err">`</span><span class="o">...</span>
<span class="p">}</span>
</pre></div>

<p>}</p>
</li>
</ul>
</li>
<li>
<p>一些快速的“不要”：</p>
<ul>
<li>
<strong>不要使用<code>for-in</code></strong>，除非你使用它时有保护措施，或者至少知道它为什么会咬你。</li>
<li>
<p><strong><code>map</code> 如果您不使用它的返回值，请不要使用</strong>。<br><em>（遗憾的是有人在那里教授<code>map</code>[ spec / MDN ] 就好像它是<code>forEach</code> -
但正如我在我的博客上写的那样，这不是它的目的。如果你不使用它创建的数组，请不要使用<code>map</code>。）</em></p>
</li>
<li>
<p><strong><code>forEach</code></strong> 如果回调执行异步工作并且您希望<code>forEach</code>等到该工作完成（因为它不会）， <strong>请不要使用。</strong></p>
</li>
</ul>
</li>
</ul>
<p>但还有 <strong>更多</strong> 内容需要探索，请继续阅读……</p>
<hr>
<p>JavaScript 具有强大的语义来遍历数组和类数组对象。 <em>我将答案分为两部分：真正数组的选项，以及类似于</em>
数组的选项，例如<code>arguments</code>对象、其他可迭代对象 (ES2015+)、DOM 集合等。</p>
<p>好的，让我们看看我们的选择：</p>
<h3>对于实际数组</h3>
<p>您有五个选项（两个基本上永远受支持，另一个由 ECMAScript 5 [“ES5”] 添加，另外两个在 ECMAScript
2015（“ES2015”，又名“ES6”）中添加：</p>
<ol>
<li>使用<code>for-of</code>（隐式使用迭代器）(ES2015+)</li>
<li>使用<code>forEach</code>及相关（ES5+）</li>
<li>使用一个简单的<code>for</code>循环</li>
<li>
<em>正确</em> 使用<code>for-in</code> __</li>
<li>显式使用迭代器 (ES2015+)</li>
</ol>
<p>（您可以在此处查看那些旧规范：ES5、ES2015，但两者都已被取代；当前编辑的草稿始终在这里。）</p>
<p>细节：</p>
<h4>1. 使用<code>for-of</code>（隐式使用迭代器）(ES2015+)</h4>
<p>ES2015 向 JavaScript 添加了 <em>迭代器和可迭代对象</em> 。<code>Map</code>数组是可迭代的（字符串、 s 和<code>Set</code>s 以及 DOM
集合和列表也是如此，稍后您将看到）。可迭代对象为其值提供迭代器。new<code>for-of</code>语句循环遍历迭代器返回的值：</p>
<div class="code"><pre class="code literal-block"><span class="n">const</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">[</span><span class="s2">"a"</span><span class="p">,</span><span class="w"> </span><span class="s2">"b"</span><span class="p">,</span><span class="w"> </span><span class="s2">"c"</span><span class="err">]</span><span class="p">;</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">const</span><span class="w"> </span><span class="n">element</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">You</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="k">use</span><span class="w"> </span><span class="n n-Quoted">`let`</span><span class="w"> </span><span class="n">instead</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n n-Quoted">`const`</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="k">like</span>
<span class="w">    </span><span class="n">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="n">element</span><span class="p">);</span>
<span class="err">}</span>
<span class="o">//</span><span class="w"> </span><span class="n">a</span>
<span class="o">//</span><span class="w"> </span><span class="n">b</span>
<span class="o">//</span><span class="w"> </span><span class="n">c</span>
</pre></div>

<p>没有比这更简单的了！在幕后，它从数组中获取迭代器并循环遍历迭代器返回的值。数组提供的迭代器按从头到尾的顺序提供数组元素的值。</p>
<p>注意<code>element</code>每个循环迭代的作用域如何；<code>element</code>尝试在循环结束后使用会失败，因为它不存在于循环体之外。</p>
<p>理论上，一个<code>for-of</code>循环涉及多个函数调用（一个用于获取迭代器，然后一个用于从中获取每个值）。即使那是真的，也没什么好担心的，函数调用在现代
JavaScript 引擎中 _ <strong>非常</strong>_ 便宜（它困扰着我<code>forEach</code>[下面]，直到我调查它；细节）。但除此之外，JavaScript
引擎在处理诸如数组之类的本机迭代器时会优化这些调用（在性能关键代码中）。</p>
<p><code>for-
of</code>是完全<code>async</code>友好的。如果您需要循环体中的工作按顺序（而不是并行）完成，则<code>await</code>循环体中的工作将在继续之前等待承诺解决。这是一个愚蠢的例子：</p>
<p>显示代码片段</p>
<div class="code"><pre class="code literal-block"><span class="n">function</span><span class="w"> </span><span class="n">delay</span><span class="p">(</span><span class="n">ms</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">Promise</span><span class="p">(</span><span class="n">resolve</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">setTimeout</span><span class="p">(</span><span class="n">resolve</span><span class="p">,</span><span class="w"> </span><span class="n">ms</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>
<span class="p">}</span>

<span class="n">async</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">showSlowly</span><span class="p">(</span><span class="n">messages</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">messages</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">await</span><span class="w"> </span><span class="n">delay</span><span class="p">(</span><span class="mi">400</span><span class="p">);</span>
<span class="w">        </span><span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="n">showSlowly</span><span class="p">([</span>
<span class="w">    </span><span class="s2">"So"</span><span class="p">,</span><span class="w"> </span><span class="s2">"long"</span><span class="p">,</span><span class="w"> </span><span class="s2">"and"</span><span class="p">,</span><span class="w"> </span><span class="s2">"thanks"</span><span class="p">,</span><span class="w"> </span><span class="s2">"for"</span><span class="p">,</span><span class="w"> </span><span class="s2">"all"</span><span class="p">,</span><span class="w"> </span><span class="s2">"the"</span><span class="p">,</span><span class="w"> </span><span class="s2">"fish!"</span>
<span class="p">]);</span>
<span class="o">//</span><span class="w"> </span><span class="err">`</span><span class="o">.</span><span class="n">catch</span><span class="err">`</span><span class="w"> </span><span class="n">omitted</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">know</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">never</span><span class="w"> </span><span class="n">rejects</span>
</pre></div>

<p>请注意这些词是如何在每个词之前出现延迟的。</p>
<p>这是编码风格的问题，但这<code>for-of</code>是我在遍历任何可迭代对象时首先要做的事情。</p>
<h4>2.用途<code>forEach</code>及相关</h4>
<p>在您可以访问<code>Array</code>ES5 添加的功能的任何甚至模糊现代的环境（因此，不是
IE8）中，如果您只处理同步代码（或者您不需要等待），您可以使用<code>forEach</code>（spec | MDN ）让异步进程在循环期间完成）：</p>
<div class="code"><pre class="code literal-block"><span class="k">const</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">"a"</span><span class="p">,</span><span class="w"> </span><span class="s2">"b"</span><span class="p">,</span><span class="w"> </span><span class="s2">"c"</span><span class="p">];</span>
<span class="n">a</span><span class="o">.</span><span class="n">forEach</span><span class="p">((</span><span class="n">element</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">element</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>

<p><code>forEach</code>接受一个回调函数和一个可选的值，在调用该回调时使用<code>this</code>（上面未使用）。为数组中的每个元素依次调用回调，跳过稀疏数组中不存在的元素。虽然我在上面只使用了一个参数，但调用回调时使用了三个参数：该迭代的元素、该元素的索引以及对您正在迭代的数组的引用（以防您的函数还没有它）便利）。</p>
<p>像<code>for-of</code>,<code>forEach</code>的优点是您不必在包含范围内声明索引和值变量；在这种情况下，它们作为迭代函数的参数提供，并且很好地限定了该迭代的范围。</p>
<p>不像<code>for-of</code>,有它不理解函数和 的<code>forEach</code>缺点。如果您使用一个函数作为回调， <strong>则</strong>
不要等待该函数的承诺在继续之前解决。下面是using
instead的示例——请注意初始延迟是如何出现的，但随后所有文本都会立即出现而不是等待：<code>async``await``async``forEach</code>
****<code>async``for-of``forEach</code></p>
<p>显示代码片段</p>
<div class="code"><pre class="code literal-block"><span class="nv">function</span><span class="w"> </span><span class="nv">delay</span><span class="ss">(</span><span class="nv">ms</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">Promise</span><span class="ss">(</span><span class="nv">resolve</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span>{
<span class="w">        </span><span class="nv">setTimeout</span><span class="ss">(</span><span class="nv">resolve</span>,<span class="w"> </span><span class="nv">ms</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">    </span>}<span class="ss">)</span><span class="c1">;</span>
}

<span class="nv">async</span><span class="w"> </span><span class="nv">function</span><span class="w"> </span><span class="nv">showSlowly</span><span class="ss">(</span><span class="nv">messages</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="nv">INCORRECT</span>,<span class="w"> </span><span class="nv">doesn</span><span class="err">'t wait before continuing,</span>
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="nv">doesn</span><span class="err">'t handle promise rejections</span>
<span class="err">    messages.forEach(async message =&gt; {</span>
<span class="err">        await delay(400);</span>
<span class="err">        console.log(message);</span>
<span class="err">    });</span>
<span class="err">}</span>

<span class="err">showSlowly([</span>
<span class="err">    "So", "long", "and", "thanks", "for", "all", "the", "fish!"</span>
<span class="err">]);</span>
<span class="err">// `.catch` omitted because we know it never rejects</span>
</pre></div>

<p><code>forEach</code>是“遍历所有”函数，但 ES5 定义了其他几个有用的“遍历数组并做事”函数，包括：</p>
<ul>
<li>
<code>every</code>( spec | MDN ) - 在回调第一次返回虚假值时停止循环</li>
<li>
<code>some</code>( spec | MDN ) - 在回调第一次返回真值时停止循环</li>
<li>
<code>filter</code>( spec | MDN ) - 创建一个新数组，包括回调返回真值的元素，省略不返回真值的元素</li>
<li>
<code>map</code>( spec | MDN ) - 根据回调返回的值创建一个新数组</li>
<li>
<code>reduce</code>( spec | MDN ) - 通过重复调用回调，传递以前的值来建立一个值；有关详细信息，请参阅规范</li>
<li>
<code>reduceRight</code>( spec | MDN ) - 类似<code>reduce</code>，但以降序而不是升序工作</li>
</ul>
<p>与 一样<code>forEach</code>，如果您使用一个<code>async</code>函数作为回调，则没有一个会等待函数的承诺来解决。这意味着：</p>
<ul>
<li>使用<code>async</code>函数回调永远不适合<code>every</code>, <code>some</code>, 并且<code>filter</code>因为它们会将返回的承诺视为真实值；他们 <strong>不会</strong> 等待 promise 结算然后使用 fulfillment 值。</li>
<li>
<strong>如果</strong> 目标是将某些内容的数组转换为 <em>承诺</em> 数组，也许是为了传递给其中一个承诺组合器函数（、、或），<code>async</code>则使用函数回调通常适用于<code>map</code>。 **** __<code>Promise.all``Promise.race``promise.allSettled``Promise.any</code>
</li>
<li>使用<code>async</code>函数回调很少适用于<code>reduce</code>or <code>reduceRight</code>，因为（再次）回调将始终返回一个承诺。<code>reduce</code>但是有一个习惯用法是从使用( )的数组构建承诺链<code>const promise = array.reduce((p, element) =&gt; p.then(/*...something using</code>element<code>...*/));</code>，但通常在这些情况下，函数中的<code>for-of</code>or<code>for</code>循环<code>async</code>会更清晰，更容易调试。</li>
</ul>
<h4>3.使用简单的<code>for</code>循环</h4>
<p>有时旧方法是最好的：</p>
<div class="code"><pre class="code literal-block"><span class="n">const</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">"a", "b", "c"</span><span class="o">]</span><span class="p">;</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">let</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">length</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="k">index</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="n">const</span><span class="w"> </span><span class="k">element</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="o">[</span><span class="n">index</span><span class="o">]</span><span class="p">;</span>
<span class="w">    </span><span class="n">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="k">element</span><span class="p">);</span>
<span class="err">}</span>
</pre></div>

<p>如果数组的长度在循环期间不会改变，并且它是在对性能高度敏感的代码中，那么稍微复杂一点的版本预先获取长度可能会快 _ <strong>一点</strong>_ ：</p>
<div class="code"><pre class="code literal-block"><span class="n">const</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">"a", "b", "c"</span><span class="o">]</span><span class="p">;</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">let</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nf">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">length</span><span class="p">;</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nf">len</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="k">index</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="n">const</span><span class="w"> </span><span class="k">element</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="o">[</span><span class="n">index</span><span class="o">]</span><span class="p">;</span>
<span class="w">    </span><span class="n">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="k">element</span><span class="p">);</span>
<span class="err">}</span>
</pre></div>

<p>和/或倒数：</p>
<div class="code"><pre class="code literal-block"><span class="n">const</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">"a", "b", "c"</span><span class="o">]</span><span class="p">;</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">let</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">length</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="o">--</span><span class="k">index</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="n">const</span><span class="w"> </span><span class="k">element</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="o">[</span><span class="n">index</span><span class="o">]</span><span class="p">;</span>
<span class="w">    </span><span class="n">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="k">element</span><span class="p">);</span>
<span class="err">}</span>
</pre></div>

<p>但是使用现代 JavaScript 引擎，您很少需要勉强挤出最后一点汁液。</p>
<p>Before ES2015, the loop variable had to exist in the containing scope, because
<code>var</code> only has function-level scope, not block-level scope. But as you saw in
the examples above, you can use <code>let</code> within the <code>for</code> to scope the variables
to just the loop. And when you do that, the <code>index</code> variable is recreated for
each loop iteration, meaning closures created in the loop body keep a
reference to the <code>index</code> for that specific iteration, which solves the old
"closures in loops" problem:</p>
<p>Show code snippet</p>
<div class="code"><pre class="code literal-block"><span class="o">//</span><span class="w"> </span><span class="p">(</span><span class="n">The</span><span class="w"> </span><span class="n n-Quoted">`NodeList`</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n n-Quoted">`querySelectorAll`</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">array</span><span class="o">-</span><span class="k">like</span><span class="p">)</span>
<span class="n">const</span><span class="w"> </span><span class="n">divs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">document</span><span class="p">.</span><span class="n">querySelectorAll</span><span class="p">(</span><span class="s2">"div"</span><span class="p">);</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">let</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">divs</span><span class="p">.</span><span class="n">length</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="k">index</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="n">divs</span><span class="err">[</span><span class="k">index</span><span class="err">]</span><span class="p">.</span><span class="n">addEventListener</span><span class="p">(</span><span class="s1">'click'</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="n">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="s2">"Index is: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">index</span><span class="p">);</span>
<span class="w">    </span><span class="err">}</span><span class="p">);</span>
<span class="err">}</span>


<span class="o">&lt;</span><span class="k">div</span><span class="o">&gt;</span><span class="n">zero</span><span class="o">&lt;/</span><span class="k">div</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="k">div</span><span class="o">&gt;</span><span class="k">one</span><span class="o">&lt;/</span><span class="k">div</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="k">div</span><span class="o">&gt;</span><span class="n">two</span><span class="o">&lt;/</span><span class="k">div</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="k">div</span><span class="o">&gt;</span><span class="n">three</span><span class="o">&lt;/</span><span class="k">div</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="k">div</span><span class="o">&gt;</span><span class="n">four</span><span class="o">&lt;/</span><span class="k">div</span><span class="o">&gt;</span>
</pre></div>

<p>In the above, you get "Index is: 0" if you click the first and "Index is: 4"
if you click the last. This does <strong>not</strong> work if you use <code>var</code> instead of
<code>let</code> (you'd always see "Index is: 5").</p>
<p>Like <code>for-of</code>, <code>for</code> loops work well in <code>async</code> functions. Here's the earlier
example using a <code>for</code> loop:</p>
<p>Show code snippet</p>
<div class="code"><pre class="code literal-block"><span class="k">function</span><span class="w"> </span><span class="n">delay</span><span class="p">(</span><span class="n">ms</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Promise</span><span class="p">(</span><span class="n">resolve</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="n">setTimeout</span><span class="p">(</span><span class="n">resolve</span><span class="p">,</span><span class="w"> </span><span class="n">ms</span><span class="p">);</span>
<span class="w">    </span><span class="err">}</span><span class="p">);</span>
<span class="err">}</span>

<span class="n">async</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">showSlowly</span><span class="p">(</span><span class="n">messages</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">let</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">messages</span><span class="p">.</span><span class="n">length</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="n">const</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">messages</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">;</span>
<span class="w">        </span><span class="n">await</span><span class="w"> </span><span class="n">delay</span><span class="p">(</span><span class="mi">400</span><span class="p">);</span>
<span class="w">        </span><span class="n">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
<span class="w">    </span><span class="err">}</span>
<span class="err">}</span>

<span class="n">showSlowly</span><span class="p">(</span><span class="o">[</span>
<span class="n">    "So", "long", "and", "thanks", "for", "all", "the", "fish!"</span>
<span class="o">]</span><span class="p">);</span>
<span class="o">//</span><span class="w"> </span><span class="err">`</span><span class="p">.</span><span class="k">catch</span><span class="err">`</span><span class="w"> </span><span class="n">omitted</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">know</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">never</span><span class="w"> </span><span class="n">rejects</span>
</pre></div>

<h4>4. Use <code>for-in</code> <em>correctly</em>
</h4>
<p><code>for-in</code> isn't for looping through arrays, it's for looping through the names
of an object's properties. It does often seem to work for looping through
arrays as a by-product of the fact that arrays are objects, but it doesn't
just loop through the array indexes, it loops through <strong>all</strong> enumerable
properties of the object (including inherited ones). (It also used to be that
the order wasn't specified; it is now [details in this other answer], but even
though the order is specified now, the rules are complex, there are
exceptions, and relying on the order is not best practice.)</p>
<p>The only real use cases for <code>for-in</code> on an array are:</p>
<ul>
<li>It's a <em>sparse</em> array with <strong>massive</strong> gaps in it, or</li>
<li>You're using non-element properties on the array object and you want to include them in the loop</li>
</ul>
<p>Looking only at that first example: You can use <code>for-in</code> to visit those sparse
array elements if you use appropriate safeguards:</p>
<div class="code"><pre class="code literal-block"><span class="o">//</span><span class="w"> </span><span class="err">`</span><span class="n">a</span><span class="err">`</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">sparse</span><span class="w"> </span><span class="k">array</span>
<span class="n">const</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">[]</span><span class="p">;</span>
<span class="n">a</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">"a"</span><span class="p">;</span>
<span class="n">a</span><span class="o">[</span><span class="n">10</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">"b"</span><span class="p">;</span>
<span class="n">a</span><span class="o">[</span><span class="n">10000</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">"c"</span><span class="p">;</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">const</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">Object</span><span class="p">.</span><span class="n">hasOwn</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">       </span><span class="o">//</span><span class="w"> </span><span class="n">These</span><span class="w"> </span><span class="n">checks</span><span class="w"> </span><span class="k">are</span>
<span class="w">        </span><span class="o">/^</span><span class="mi">0</span><span class="err">$</span><span class="o">|^[</span><span class="n">1-9</span><span class="o">]</span><span class="err">\</span><span class="n">d</span><span class="o">*</span><span class="err">$</span><span class="o">/</span><span class="p">.</span><span class="n">test</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">explained</span>
<span class="w">        </span><span class="n">name</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">4294967294</span><span class="w">              </span><span class="o">//</span><span class="w"> </span><span class="n">below</span>
<span class="w">       </span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="n">const</span><span class="w"> </span><span class="k">element</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="o">[</span><span class="n">name</span><span class="o">]</span><span class="p">;</span>
<span class="w">        </span><span class="n">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="n">a</span><span class="o">[</span><span class="n">name</span><span class="o">]</span><span class="p">);</span>
<span class="w">    </span><span class="err">}</span>
<span class="err">}</span>
</pre></div>

<p>Note the three checks:</p>
<ol>
<li>
<p>That the object has its <em>own</em> property by that name (not one it inherits from its prototype; this check is also often written as <code>a.hasOwnProperty(name)</code> but ES2022 adds <code>Object.hasOwn</code> which can be more reliable), and</p>
</li>
<li>
<p>That the name is all decimal digits (e.g., normal string form, not scientific notation), and</p>
</li>
<li>
<p>That the name's value when coerced to a number is &lt;= 2^32 - 2 (which is 4,294,967,294). Where does that number come from? It's part of the definition of an array index in the specification. Other numbers (non-integers, negative numbers, numbers greater than 2^32 - 2) are not array indexes. The reason it's 2^32 - <strong>2</strong> is that that makes the greatest index value one lower than 2^32 - <strong>1</strong> , which is the maximum value an array's <code>length</code> can have. (E.g., an array's length fits in a 32-bit unsigned integer.)</p>
</li>
</ol>
<p>...although with that said, most code only does the <code>hasOwnProperty</code> check.</p>
<p>You wouldn't do that in inline code, of course. You'd write a utility
function. Perhaps:</p>
<p>Show code snippet</p>
<div class="code"><pre class="code literal-block"><span class="o">//</span><span class="w"> </span><span class="n">Utility</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">antiquated</span><span class="w"> </span><span class="n">environments</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="err">`</span><span class="n">forEach</span><span class="err">`</span>
<span class="k">const</span><span class="w"> </span><span class="n">hasOwn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb nb-Type">Object</span><span class="o">.</span><span class="n">prototype</span><span class="o">.</span><span class="n">hasOwnProperty</span><span class="o">.</span><span class="n">call</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="nb nb-Type">Object</span><span class="o">.</span><span class="n">prototype</span><span class="o">.</span><span class="n">hasOwnProperty</span><span class="p">);</span>
<span class="k">const</span><span class="w"> </span><span class="n">rexNum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">/^</span><span class="mi">0</span><span class="o">$|^</span><span class="p">[</span><span class="mi">1</span><span class="o">-</span><span class="mi">9</span><span class="p">]</span>\<span class="n">d</span><span class="o">*$/</span><span class="p">;</span>
<span class="n">function</span><span class="w"> </span><span class="n">sparseEach</span><span class="p">(</span><span class="n">array</span><span class="p">,</span><span class="w"> </span><span class="n">callback</span><span class="p">,</span><span class="w"> </span><span class="n">thisArg</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">array</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">const</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">+</span><span class="n">name</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">hasOwn</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">            </span><span class="n">rexNum</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">            </span><span class="n">index</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">4294967294</span>
<span class="w">           </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">callback</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">thisArg</span><span class="p">,</span><span class="w"> </span><span class="n">array</span><span class="p">[</span><span class="n">name</span><span class="p">],</span><span class="w"> </span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="n">array</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">const</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
<span class="n">a</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"five"</span><span class="p">;</span>
<span class="n">a</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"ten"</span><span class="p">;</span>
<span class="n">a</span><span class="p">[</span><span class="mi">100000</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"one hundred thousand"</span><span class="p">;</span>
<span class="n">a</span><span class="o">.</span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"bee"</span><span class="p">;</span>

<span class="n">sparseEach</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">"Value at "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">" is "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">value</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>

<p>Like <code>for</code>, <code>for-in</code> works well in asynchronous functions if the work within
it needs to be done in series.</p>
<p>Show code snippet</p>
<div class="code"><pre class="code literal-block"><span class="k">function</span><span class="w"> </span><span class="n">delay</span><span class="p">(</span><span class="n">ms</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Promise</span><span class="p">(</span><span class="n">resolve</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="n">setTimeout</span><span class="p">(</span><span class="n">resolve</span><span class="p">,</span><span class="w"> </span><span class="n">ms</span><span class="p">);</span>
<span class="w">    </span><span class="err">}</span><span class="p">);</span>
<span class="err">}</span>

<span class="n">async</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">showSlowly</span><span class="p">(</span><span class="n">messages</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">const</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">messages</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">messages</span><span class="p">.</span><span class="n">hasOwnProperty</span><span class="p">(</span><span class="n">name</span><span class="p">))</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">Almost</span><span class="w"> </span><span class="n">always</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">only</span><span class="w"> </span><span class="k">check</span><span class="w"> </span><span class="n">people</span><span class="w"> </span><span class="n">do</span>
<span class="w">            </span><span class="n">const</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">messages</span><span class="o">[</span><span class="n">name</span><span class="o">]</span><span class="p">;</span>
<span class="w">            </span><span class="n">await</span><span class="w"> </span><span class="n">delay</span><span class="p">(</span><span class="mi">400</span><span class="p">);</span>
<span class="w">            </span><span class="n">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
<span class="w">        </span><span class="err">}</span>
<span class="w">    </span><span class="err">}</span>
<span class="err">}</span>

<span class="n">showSlowly</span><span class="p">(</span><span class="o">[</span>
<span class="n">    "So", "long", "and", "thanks", "for", "all", "the", "fish!"</span>
<span class="o">]</span><span class="p">);</span>
<span class="o">//</span><span class="w"> </span><span class="err">`</span><span class="p">.</span><span class="k">catch</span><span class="err">`</span><span class="w"> </span><span class="n">omitted</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">know</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">never</span><span class="w"> </span><span class="n">rejects</span>
</pre></div>

<h4>5. Use an iterator explicitly (ES2015+)</h4>
<p><code>for-of</code> uses an iterator implicitly, doing all the scut work for you.
Sometimes, you might want to use an iterator <em>explicitly</em>. It looks like this:</p>
<div class="code"><pre class="code literal-block"><span class="k">const</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">"a"</span><span class="p">,</span><span class="w"> </span><span class="s2">"b"</span><span class="p">,</span><span class="w"> </span><span class="s2">"c"</span><span class="p">];</span>
<span class="k">const</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="o">.</span><span class="n">values</span><span class="p">();</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">Or</span><span class="w"> </span><span class="err">`</span><span class="k">const</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">Symbol</span><span class="o">.</span><span class="n">iterator</span><span class="p">]();</span><span class="err">`</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">like</span>
<span class="n">let</span><span class="w"> </span><span class="n">entry</span><span class="p">;</span>
<span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">entry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">it</span><span class="o">.</span><span class="n">next</span><span class="p">())</span><span class="o">.</span><span class="n">done</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">element</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">entry</span><span class="o">.</span><span class="n">value</span><span class="p">;</span>
<span class="w">    </span><span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">element</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>

<p>An iterator is an object matching the Iterator definition in the
specification. Its <code>next</code> method returns a new <em>result object</em> each time you
call it. The result object has a property, <code>done</code>, telling us whether it's
done, and a property <code>value</code> with the value for that iteration. (<code>done</code> is
optional if it would be <code>false</code>, <code>value</code> is optional if it would be
<code>undefined</code>.)</p>
<p>What you get for <code>value</code> varies depending on the iterator. On arrays, the
default iterator provides the value of each array element (<code>"a"</code>, <code>"b"</code>, and
<code>"c"</code> in the example earlier). Arrays also have three other methods that
return iterators:</p>
<ul>
<li>
<code>values()</code>: This is an alias for the <code>[Symbol.iterator]</code> method that returns the default iterator.</li>
<li>
<code>keys()</code>: Returns an iterator that provides each key (index) in the array. In the example above, it would provide <code>"0"</code>, then <code>"1"</code>, then <code>"2"</code> (yes, as strings).</li>
<li>
<code>entries()</code>: Returns an iterator that provides <code>[key, value]</code> arrays.</li>
</ul>
<p>Since iterator objects don't advance until you call <code>next</code>, they work well in
<code>async</code> function loops. Here's the earlier <code>for-of</code> example using the iterator
explicitly:</p>
<p>Show code snippet</p>
<div class="code"><pre class="code literal-block"><span class="n">function</span><span class="w"> </span><span class="n">delay</span><span class="p">(</span><span class="n">ms</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">Promise</span><span class="p">(</span><span class="n">resolve</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">setTimeout</span><span class="p">(</span><span class="n">resolve</span><span class="p">,</span><span class="w"> </span><span class="n">ms</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>
<span class="p">}</span>

<span class="n">async</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">showSlowly</span><span class="p">(</span><span class="n">messages</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">messages</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">entry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">it</span><span class="o">.</span><span class="n">next</span><span class="p">())</span><span class="o">.</span><span class="n">done</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">await</span><span class="w"> </span><span class="n">delay</span><span class="p">(</span><span class="mi">400</span><span class="p">);</span>
<span class="w">        </span><span class="k">const</span><span class="w"> </span><span class="n">element</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">entry</span><span class="o">.</span><span class="n">value</span><span class="p">;</span>
<span class="w">        </span><span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">element</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="n">showSlowly</span><span class="p">([</span>
<span class="w">    </span><span class="s2">"So"</span><span class="p">,</span><span class="w"> </span><span class="s2">"long"</span><span class="p">,</span><span class="w"> </span><span class="s2">"and"</span><span class="p">,</span><span class="w"> </span><span class="s2">"thanks"</span><span class="p">,</span><span class="w"> </span><span class="s2">"for"</span><span class="p">,</span><span class="w"> </span><span class="s2">"all"</span><span class="p">,</span><span class="w"> </span><span class="s2">"the"</span><span class="p">,</span><span class="w"> </span><span class="s2">"fish!"</span>
<span class="p">]);</span>
<span class="o">//</span><span class="w"> </span><span class="err">`</span><span class="o">.</span><span class="n">catch</span><span class="err">`</span><span class="w"> </span><span class="n">omitted</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">know</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">never</span><span class="w"> </span><span class="n">rejects</span>
</pre></div>

<h3>For Array-Like Objects</h3>
<p>Aside from true arrays, there are also <em>array-like</em> objects that have a
<code>length</code> property and properties with all-digits names: <code>NodeList</code> instances,
<code>HTMLCollection</code> instances, the <code>arguments</code> object, etc. How do we loop
through their contents?</p>
<h4>Use most of the options above</h4>
<p>At least some, and possibly most or even all, of the array approaches above
apply equally well to array-like objects:</p>
<ol>
<li><strong>Use<code>for-of</code> (use an iterator implicitly) (ES2015+)</strong></li>
</ol>
<p><code>for-of</code> uses the iterator provided by the object (if any). That includes
host-provided objects (like DOM collections and lists). For instance,
<code>HTMLCollection</code> instances from <code>getElementsByXYZ</code> methods and <code>NodeList</code>s
instances from <code>querySelectorAll</code> both support iteration. (This is defined
<strong>quite</strong> subtly by the HTML and DOM specifications. Basically, any object
with <code>length</code> and indexed access is automatically iterable. It <strong>doesn't</strong>
have to be marked <code>iterable</code>; that is used only for collections that, in
addition to being iterable, support <code>forEach</code>, <code>values</code>, <code>keys</code>, and <code>entries</code>
methods. <code>NodeList</code> does; <code>HTMLCollection</code> doesn't, but both are iterable.)</p>
<p>Here's an example of looping through <code>div</code> elements:</p>
<p>Show code snippet</p>
<div class="code"><pre class="code literal-block">const<span class="w"> </span>divs<span class="w"> </span>=<span class="w"> </span>document.querySelectorAll("div");
for<span class="w"> </span>(const<span class="w"> </span>div<span class="w"> </span>of<span class="w"> </span>divs)<span class="w"> </span>{
<span class="w">    </span>div.textContent<span class="w"> </span>=<span class="w"> </span>Math.random();
}


<span class="nt">&lt;div&gt;</span>zero<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;div&gt;</span>one<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;div&gt;</span>two<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;div&gt;</span>three<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;div&gt;</span>four<span class="nt">&lt;/div&gt;</span>
</pre></div>

<ol>
<li><strong>Use<code>forEach</code> and related (ES5+)</strong></li>
</ol>
<p>The various functions on <code>Array.prototype</code> are "intentionally generic" and can
be used on array-like objects via <code>Function#call</code> (spec | MDN) or
<code>Function#apply</code> (spec | MDN). (If you have to deal with IE8 or earlier
[ouch], see the "Caveat for host-provided objects" at the end of this answer,
but it's not an issue with vaguely-modern browsers.)</p>
<p>Suppose you wanted to use <code>forEach</code> on a <code>Node</code>'s <code>childNodes</code> collection
(which, being an <code>HTMLCollection</code>, doesn't have <code>forEach</code> natively). You'd do
this:</p>
<div class="code"><pre class="code literal-block"><span class="w">    </span><span class="k">Array</span><span class="p">.</span><span class="n">prototype</span><span class="p">.</span><span class="n">forEach</span><span class="p">.</span><span class="k">call</span><span class="p">(</span><span class="n">node</span><span class="p">.</span><span class="n">childNodes</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">child</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="k">Do</span><span class="w"> </span><span class="n">something</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n n-Quoted">`child`</span>
<span class="err">}</span><span class="p">);</span>
</pre></div>

<p>(Note, though, that you could just use <code>for-of</code> on <code>node.childNodes</code>.)</p>
<p>If you're going to do that a lot, you might want to grab a copy of the
function reference into a variable for reuse, e.g.:</p>
<div class="code"><pre class="code literal-block"><span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="p">(</span><span class="n">This</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">all</span><span class="w"> </span><span class="n">presumably</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="k">some</span><span class="w"> </span><span class="n">scoping</span><span class="w"> </span><span class="k">function</span><span class="p">)</span>
<span class="n">const</span><span class="w"> </span><span class="n">forEach</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">Array</span><span class="p">.</span><span class="n">prototype</span><span class="p">.</span><span class="n">forEach</span><span class="p">.</span><span class="k">call</span><span class="p">.</span><span class="n">bind</span><span class="p">(</span><span class="k">Array</span><span class="p">.</span><span class="n">prototype</span><span class="p">.</span><span class="n">forEach</span><span class="p">);</span>

<span class="o">//</span><span class="w"> </span><span class="k">Then</span><span class="w"> </span><span class="n">later</span><span class="p">...</span>
<span class="n">forEach</span><span class="p">(</span><span class="n">node</span><span class="p">.</span><span class="n">childNodes</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">child</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="k">Do</span><span class="w"> </span><span class="n">something</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n n-Quoted">`child`</span>
<span class="err">}</span><span class="p">);</span>
</pre></div>

<ol>
<li><strong>Use a simple<code>for</code> loop</strong></li>
</ol>
<p>Perhaps obviously, a simple <code>for</code> loop works for array-like objects.</p>
<ol>
<li><strong>Use an iterator explicitly (ES2015+)</strong></li>
</ol>
<p>See #1.</p>
<p>You <em><strong>may</strong></em> be able to get away with <code>for-in</code> (with safeguards), but with
all of these more appropriate options, there's no reason to try.</p>
<h4>Create a true array</h4>
<p>Other times, you may want to convert an array-like object into a true array.
Doing that is surprisingly easy:</p>
<ol>
<li><strong>Use<code>Array.from</code></strong></li>
</ol>
<p><code>Array.from</code> (spec) | (MDN) (ES2015+, but easily polyfilled) creates an array
from an array-like object, optionally passing the entries through a mapping
function first. So:</p>
<div class="code"><pre class="code literal-block"><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">divs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb nb-Type">Array</span><span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="n">document</span><span class="o">.</span><span class="n">querySelectorAll</span><span class="p">(</span><span class="s2">"div"</span><span class="p">));</span>
</pre></div>

<p>...takes the <code>NodeList</code> from <code>querySelectorAll</code> and makes an array from it.</p>
<p>The mapping function is handy if you were going to map the contents in some
way. For instance, if you wanted to get an array of the tag names of the
elements with a given class:</p>
<div class="code"><pre class="code literal-block"><span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="n">Typical</span><span class="w"> </span><span class="n">use</span><span class="w"> </span><span class="p">(</span><span class="n">with</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">arrow</span><span class="w"> </span><span class="n">function</span><span class="p">):</span>
<span class="k">const</span><span class="w"> </span><span class="n">divs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb nb-Type">Array</span><span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="n">document</span><span class="o">.</span><span class="n">querySelectorAll</span><span class="p">(</span><span class="s2">".some-class"</span><span class="p">),</span><span class="w"> </span><span class="n">element</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">element</span><span class="o">.</span><span class="n">tagName</span><span class="p">);</span>

<span class="o">//</span><span class="w"> </span><span class="n">Traditional</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="p">(</span><span class="n">since</span><span class="w"> </span><span class="err">`</span><span class="nb nb-Type">Array</span><span class="o">.</span><span class="n">from</span><span class="err">`</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">polyfilled</span><span class="p">):</span>
<span class="k">var</span><span class="w"> </span><span class="n">divs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb nb-Type">Array</span><span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="n">document</span><span class="o">.</span><span class="n">querySelectorAll</span><span class="p">(</span><span class="s2">".some-class"</span><span class="p">),</span><span class="w"> </span><span class="n">function</span><span class="p">(</span><span class="n">element</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">element</span><span class="o">.</span><span class="n">tagName</span><span class="p">;</span>
<span class="p">});</span>
</pre></div>

<ol>
<li><strong>Use spread syntax (<code>...</code>)</strong></li>
</ol>
<p>It's also possible to use ES2015's spread syntax. Like <code>for-of</code>, this uses the
iterator provided by the object (see #1 in the previous section):</p>
<div class="code"><pre class="code literal-block"><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">trueArray</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="o">...</span><span class="n">iterableObject</span><span class="p">];</span>
</pre></div>

<p>So for instance, if we want to convert a <code>NodeList</code> into a true array, with
spread syntax this becomes quite succinct:</p>
<div class="code"><pre class="code literal-block"><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">divs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="o">...</span><span class="n">document</span><span class="o">.</span><span class="n">querySelectorAll</span><span class="p">(</span><span class="s2">"div"</span><span class="p">)];</span>
</pre></div>

<ol>
<li><strong>Use the<code>slice</code> method of arrays</strong></li>
</ol>
<p>We can use the <code>slice</code> method of arrays, which like the other methods
mentioned above is "intentionally generic" and so can be used with array-like
objects, like this:</p>
<div class="code"><pre class="code literal-block"><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">trueArray</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb nb-Type">Array</span><span class="o">.</span><span class="n">prototype</span><span class="o">.</span><span class="n">slice</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">arrayLikeObject</span><span class="p">);</span>
</pre></div>

<p>So for instance, if we want to convert a <code>NodeList</code> into a true array, we
could do this:</p>
<div class="code"><pre class="code literal-block"><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">divs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb nb-Type">Array</span><span class="o">.</span><span class="n">prototype</span><span class="o">.</span><span class="n">slice</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">document</span><span class="o">.</span><span class="n">querySelectorAll</span><span class="p">(</span><span class="s2">"div"</span><span class="p">));</span>
</pre></div>

<p>(If you still have to handle IE8 [ouch], will fail; IE8 didn't let you use
host-provided objects as <code>this</code> like that.)</p>
<h4>Caveat for host-provided objects</h4>
<p>If you use <code>Array.prototype</code> functions with <em>host-provided</em> array-like objects
(for example, DOM collections and such provided by the browser rather than the
JavaScript engine), obsolete browsers like IE8 didn't necessarily handle that
way, so if you have to support them, be sure to test in your target
environments. But it's not an issue with vaguely-modern browsers. (For non-
browser environments, naturally it'll depend on the environment.)</p>
<p><br></p>
<h3>更多建议</h3>
<p><strong>注意</strong> ：这个答案已经过时了。对于更现代的方法，请查看array 上可用的方法。感兴趣的方法可能是：</p>
<ul>
<li>为每个</li>
<li>地图</li>
<li>筛选</li>
<li>压缩</li>
<li>减少</li>
<li>每一个</li>
<li>一些</li>
</ul>
<hr>
<p>在JavaScript中迭代数组的标准方法是 vanilla<code>for</code>循环：</p>
<div class="code"><pre class="code literal-block"><span class="nf">var</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">arr</span><span class="p">.</span><span class="n">length</span><span class="p">,</span>
<span class="w">    </span><span class="k">element</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">null</span><span class="p">;</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nf">var</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">length</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">  </span><span class="k">element</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">arr</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">;</span>
<span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Do</span><span class="w"> </span><span class="n">something</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="k">element</span>
<span class="err">}</span>
</pre></div>

<p>但是请注意，这种方法只有在你有一个密集数组并且每个索引都被一个元素占用时才有用。如果数组是稀疏的，那么使用这种方法可能会遇到性能问题，因为您将遍历数组中
<em>实际上</em> 不存在的许多索引。在这种情况下，<code>for .. in</code>-loop 可能是更好的主意。 <strong>但是</strong>
，您必须使用适当的安全措施来确保仅对数组的所需属性（即数组元素）进行操作，因为 -loop
也会<code>for..in</code>在旧版浏览器中被枚举，或者如果附加属性定义为<code>enumerable</code>.</p>
<p>在ECMAScript 5中，数组原型上将有一个 forEach
方法，但它在旧版浏览器中不受支持。因此，为了能够始终如一地使用它，您必须拥有支持它的环境（例如，用于服务器端 JavaScript
的Node.js），或者使用“Polyfill”。然而，用于此功能的 Polyfill 是微不足道的，并且由于它使代码更易于阅读，因此包含它是一个很好的
polyfill。</p>
<p><br><br><a href="posts/loop-for-each-over-an-array-in-javascript/">查看原文</a></p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-17.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-15.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
