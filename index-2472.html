<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 2472) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-2472.html">
<link rel="prev" href="index-2473.html" type="text/html">
<link rel="next" href="index-2471.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/auto-reloading-python-flask-app-upon-code-changes/" class="u-url">Auto reloading python Flask app upon code changes</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/auto-reloading-python-flask-app-upon-code-changes/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T18:40:06+08:00" itemprop="datePublished" title="2023-03-04 18:40">2023-03-04 18:40</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I'm investigating how to develop a decent web app with Python. Since I don't
want some high-order structures to get in my way, my choice fell on the
lightweight Flask framework. Time will tell if this was the right choice.</p>
<p>So, now I've set up an Apache server with mod_wsgi, and my test site is
running fine. However, I'd like to speed up the development routine by making
the site automatically reload upon any changes in py or template files I make.
I see that any changes in site's .wsgi file causes reloading (even without
WSGIScriptReloading On in the apache config file), but I still have to prod it
manually (ie, insert extra linebreak, save). Is there some way how to cause
reload when I edit some of the app's py files? Or, I am expected to use IDE
that refreshes the .wsgi file for me?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Run the <code>flask run</code> CLI command with debug mode enabled, which will
automatically enable the reloader. As of Flask 2.2, you can pass <code>--app</code> and
<code>--debug</code> options on the command line.</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span>flask<span class="w"> </span>--app<span class="w"> </span>main.py<span class="w"> </span>--debug<span class="w"> </span>run
</pre></div>

<p><code>--app</code> can also be set to <code>module:app</code> or <code>module:create_app</code> instead of
<code>module.py</code>. See the docs for a full explanation.</p>
<p>More options are available with:</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span>flask<span class="w"> </span>run<span class="w"> </span>--help
</pre></div>

<p>Prior to Flask 2.2, you needed to set the <code>FLASK_APP</code> and
<code>FLASK_ENV=development</code> environment variables.</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span><span class="nb">export</span><span class="w"> </span><span class="nv">FLASK_APP</span><span class="o">=</span>main.py
$<span class="w"> </span><span class="nb">export</span><span class="w"> </span><span class="nv">FLASK_ENV</span><span class="o">=</span>development
$<span class="w"> </span>flask<span class="w"> </span>run
</pre></div>

<p>It is still possible to set <code>FLASK_APP</code> and <code>FLASK_DEBUG=1</code> in Flask 2.2.</p>
<p><br></p>
<h3>Suggest</h3>
<p>If you are talking about test/dev environments, then just use the debug
option. It will auto-reload the flask app when a code change happens.</p>
<div class="code"><pre class="code literal-block">app.run(debug=True)
</pre></div>

<p>Or, from the shell:</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span><span class="nb">export</span><span class="w"> </span><span class="nv">FLASK_DEBUG</span><span class="o">=</span><span class="m">1</span>
$<span class="w"> </span>flask<span class="w"> </span>run
</pre></div>

<p>http://flask.palletsprojects.com/quickstart/#debug-mode</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-do-i-hide-a-menu-item-in-the-actionbar/" class="u-url">How do I hide a menu item in the actionbar?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-do-i-hide-a-menu-item-in-the-actionbar/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T18:38:18+08:00" itemprop="datePublished" title="2023-03-04 18:38">2023-03-04 18:38</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I have an action bar with a menuitem. How can I hide/show that menu item?</p>
<p>This is what I'm trying to do:</p>
<div class="code"><pre class="code literal-block">MenuItem item = (MenuItem) findViewById(R.id.addAction);
item.setVisible(false);
this.invalidateOptionsMenu();
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<p>Get a <code>MenuItem</code> pointing to such item, call <code>setVisible</code> on it to adjust its
visibility and then call <code>invalidateOptionsMenu()</code> on your activity so the
ActionBar menu is adjusted accordingly.</p>
<p><strong>Update:</strong> A <code>MenuItem</code> is not a regular view that's part of your layout. Its
something special, completely different. Your code returns <code>null</code> for <code>item</code>
and that's causing the crash. What you need instead is to do:</p>
<div class="code"><pre class="code literal-block">MenuItem item = menu.findItem(R.id.addAction);
</pre></div>

<p>Here is the sequence in which you should call: first call
<code>invalidateOptionsMenu()</code> and then inside <code>onCreateOptionsMenu(Menu)</code> obtain a
reference to the MenuItem (by calling <code>menu.findItem()</code>) and call
<code>setVisible()</code> on it</p>
<p><br></p>
<h3>Suggest</h3>
<p>Found an addendum to this question:</p>
<p>If you want to change the visibility of your menu items on the go you just
need to set a member variable in your activity to remember that you want to
hide the menu and call <code>invalidateOptionsMenu()</code> and hide the items in your
overridden <code>onCreateOptionsMenu(...)</code> method.</p>
<div class="code"><pre class="code literal-block"><span class="c1">//anywhere in your code</span>
<span class="p">...</span>
<span class="n">mState</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">HIDE_MENU</span><span class="p">;</span><span class="w"> </span><span class="c1">// setting state</span>
<span class="n">invalidateOptionsMenu</span><span class="p">();</span><span class="w"> </span><span class="c1">// now onCreateOptionsMenu(...) is called again</span>
<span class="p">...</span>

<span class="p">@</span><span class="n">Override</span>
<span class="n">public</span><span class="w"> </span><span class="n">boolean</span><span class="w"> </span><span class="n">onCreateOptionsMenu</span><span class="p">(</span><span class="n">Menu</span><span class="w"> </span><span class="n">menu</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="c1">// inflate menu from xml</span>
<span class="w">    </span><span class="n">MenuInflater</span><span class="w"> </span><span class="n">inflater</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">getSupportMenuInflater</span><span class="p">();</span>
<span class="w">    </span><span class="n">inflater</span><span class="p">.</span><span class="n">inflate</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="n">menu</span><span class="p">.</span><span class="n">settings</span><span class="p">,</span><span class="w"> </span><span class="n">menu</span><span class="p">);</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mState</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">HIDE_MENU</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nb">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">menu</span><span class="p">.</span><span class="nb">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">            </span><span class="n">menu</span><span class="p">.</span><span class="n">getItem</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">setVisible</span><span class="p">(</span><span class="n">false</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p>In my example I've hidden all items.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/xpath-contains-text-some-string-doesn-t-work-when-used-with-node-with-more-than-one-text-subnode/" class="u-url">XPath contains(text(),'some string') doesn't work when used with node with more than one Text subnode</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/xpath-contains-text-some-string-doesn-t-work-when-used-with-node-with-more-than-one-text-subnode/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T18:36:06+08:00" itemprop="datePublished" title="2023-03-04 18:36">2023-03-04 18:36</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I have a small problem with XPath contains with dom4j ...</p>
<p>Let's say my XML is</p>
<div class="code"><pre class="code literal-block"><span class="nt">&lt;Home&gt;</span>
<span class="w">    </span><span class="nt">&lt;Addr&gt;</span>
<span class="w">        </span><span class="nt">&lt;Street&gt;</span>ABC<span class="nt">&lt;/Street&gt;</span>
<span class="w">        </span><span class="nt">&lt;Number&gt;</span>5<span class="nt">&lt;/Number&gt;</span>
<span class="w">        </span><span class="nt">&lt;Comment&gt;</span>BLAH<span class="w"> </span>BLAH<span class="w"> </span>BLAH<span class="w"> </span><span class="nt">&lt;br/&gt;&lt;br/&gt;</span>ABC<span class="nt">&lt;/Comment&gt;</span>
<span class="w">    </span><span class="nt">&lt;/Addr&gt;</span>
<span class="nt">&lt;/Home&gt;</span>
</pre></div>

<p>Let's say I want to find all the nodes that have ABC in the text given the
root Element...</p>
<p>So the XPath that I would needed to write would be</p>
<p><code>//*[contains(text(),'ABC')]</code></p>
<p>However this is not what dom4j returns .... is this a dom4j problem or my
understanding how XPath works, since that query returns only the <code>Street</code>
element and not the <code>Comment</code> element?</p>
<p>The DOM makes the <code>Comment</code> element a composite element with four tags two</p>
<div class="code"><pre class="code literal-block"><span class="o">[</span><span class="n">Text = 'XYZ'</span><span class="o">][</span><span class="n">BR</span><span class="o">][</span><span class="n">BR</span><span class="o">][</span><span class="n">Text = 'ABC'</span><span class="o">]</span>
</pre></div>

<p>I would assume that the query should still return the element since it should
find the element and run contains on it, but it doesn't ...</p>
<p>The following query returns the element, but it returns far more then just the
element – it returns the parent elements as well, which is undesirable to the
problem.</p>
<div class="code"><pre class="code literal-block"><span class="c1">//*[contains(text(),'ABC')]</span>
</pre></div>

<p>Does any one know the XPath query that would return just the elements
<code>&lt;Street/&gt;</code> and <code>&lt;Comment/&gt;</code> ?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>The <code>&lt;Comment&gt;</code> tag contains two text nodes and two <code>&lt;br&gt;</code> nodes as children.</p>
<p>Your xpath expression was</p>
<div class="code"><pre class="code literal-block"><span class="c1">//*[contains(text(),'ABC')]</span>
</pre></div>

<p>To break this down,</p>
<ol>
<li>
<code>*</code> is a selector that matches any element (i.e. tag) -- it returns a node-set.</li>
<li>The <code>[]</code> are a conditional that operates on each individual node in that node set. It matches if any of the individual nodes it operates on match the conditions inside the brackets.</li>
<li>
<code>text()</code> is a <em>selector</em> that matches all of the text nodes that are children of the context node -- it returns a node set.</li>
<li>
<code>contains</code> is a function that operates on a string. If it is passed a node set, the node set is converted into a string by returning the string-value of the node in the node-set that is first in document order. Hence, it can match only the first text node in your <code>&lt;Comment&gt;</code> element -- namely <code>BLAH BLAH BLAH</code>. Since that doesn't match, you don't get a <code>&lt;Comment&gt;</code> in your results.</li>
</ol>
<p>You need to change this to</p>
<div class="code"><pre class="code literal-block"><span class="c1">//*[text()[contains(.,'ABC')]]</span>
</pre></div>

<ol>
<li>
<code>*</code> is a selector that matches any element (i.e. tag) -- it returns a node-set.</li>
<li>The outer <code>[]</code> are a conditional that operates on each individual node in that node set -- here it operates on each element in the document.</li>
<li>
<code>text()</code> is a <em>selector</em> that matches all of the text nodes that are children of the context node -- it returns a node set.</li>
<li>The inner <code>[]</code> are a conditional that operates on each node in that node set -- here each individual text node. Each individual text node is the starting point for any path in the brackets, and can also be referred to explicitly as <code>.</code> within the brackets. It matches if any of the individual nodes it operates on match the conditions inside the brackets.</li>
<li>
<code>contains</code> is a function that operates on a string. Here it is passed an individual text node (<code>.</code>). Since it is passed the second text node in the <code>&lt;Comment&gt;</code> tag individually, it will see the <code>'ABC'</code> string and be able to match it.</li>
</ol>
<p><br></p>
<h3>Suggest</h3>
<p>The XML document:</p>
<div class="code"><pre class="code literal-block"><span class="nt">&lt;Home&gt;</span>
<span class="w">    </span><span class="nt">&lt;Addr&gt;</span>
<span class="w">        </span><span class="nt">&lt;Street&gt;</span>ABC<span class="nt">&lt;/Street&gt;</span>
<span class="w">        </span><span class="nt">&lt;Number&gt;</span>5<span class="nt">&lt;/Number&gt;</span>
<span class="w">        </span><span class="nt">&lt;Comment&gt;</span>BLAH<span class="w"> </span>BLAH<span class="w"> </span>BLAH<span class="w"> </span><span class="nt">&lt;br/&gt;&lt;br/&gt;</span>ABC<span class="nt">&lt;/Comment&gt;</span>
<span class="w">    </span><span class="nt">&lt;/Addr&gt;</span>
<span class="nt">&lt;/Home&gt;</span>
</pre></div>

<p>The XPath expression:</p>
<div class="code"><pre class="code literal-block"><span class="c1">//*[contains(text(), 'ABC')]</span>
</pre></div>

<p><code>//*</code> matches any descendant element of the root node. That is, any element
but the root node.</p>
<p><code>[...]</code> is a predicate, it filters the node-set. It returns nodes for which
<code>...</code> is <code>true</code>:</p>
<blockquote>
<p>A predicate filters a node-set [...] to produce a new node-set. For each
node in the node-set to be filtered, the PredicateExpr is evaluated [...];
if PredicateExpr evaluates to true for that node, the node is included in
the new node-set; otherwise, it is not included.</p>
</blockquote>
<p><code>contains('haystack', 'needle')</code> returns <code>true</code> if <code>haystack</code> contains
<code>needle</code>:</p>
<blockquote>
<p>Function: boolean contains(string, string)</p>
<p>The contains function returns true if the first argument string contains the
second argument string, and otherwise returns false.</p>
</blockquote>
<p>But <code>contains()</code> takes a string as its first parameter. And it's passed nodes.
To deal with that every node or node-set passed as the first parameter is
converted to a string by the <code>string()</code> function:</p>
<blockquote>
<p>An argument is converted to type string as if by calling the string
function.</p>
</blockquote>
<p><code>string()</code> function returns <code>string-value</code> of the first node:</p>
<blockquote>
<p>A node-set is converted to a string by returning the string-value of the
node in the node-set that is first in document order. If the node-set is
empty, an empty string is returned.</p>
</blockquote>
<p><code>string-value</code> of an element node:</p>
<blockquote>
<p>The string-value of an element node is the concatenation of the string-
values of all text node descendants of the element node in document order.</p>
</blockquote>
<p><code>string-value</code> of a text node:</p>
<blockquote>
<p>The string-value of a text node is the character data.</p>
</blockquote>
<p>So, basically <code>string-value</code> is all text that is contained in a node
(concatenation of all descendant text nodes).</p>
<p><code>text()</code> is a node test that matches any text node:</p>
<blockquote>
<p>The node test text() is true for any text node. For example, child::text()
will select the text node children of the context node.</p>
</blockquote>
<p>Having that said, <code>//*[contains(text(), 'ABC')]</code> matches any element (but the
root node), the first text node of which contains <code>ABC</code>. Since <code>text()</code>
returns a node-set that contains all child text nodes of the context node
(relative to which an expression is evaluated). But <code>contains()</code> takes only
the first one. So for the document above the path matches the <code>Street</code>
element.</p>
<p>The following expression <code>//*[text()[contains(., 'ABC')]]</code> matches any element
(but the root node), that has at least one child text node, that contains
<code>ABC</code>. <code>.</code> represents the context node. In this case, it's a child text node
of any element but the root node. So for the document above the path matches
the <code>Street</code>, and the <code>Comment</code> elements.</p>
<p>Now then, <code>//*[contains(., 'ABC')]</code> matches any element (but the root node)
that contains <code>ABC</code> (in the concatenation of the descendant text nodes). For
the document above it matches the <code>Home</code>, the <code>Addr</code>, the <code>Street</code>, and the
<code>Comment</code> elements. As such, <code>//*[contains(., 'BLAH ABC')]</code> matches the
<code>Home</code>, the <code>Addr</code>, and the <code>Comment</code> elements.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-2473.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-2471.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
