<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 616) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-616.html">
<link rel="prev" href="index-617.html" type="text/html">
<link rel="next" href="index-615.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/argparse-optional-positional-arguments/" class="u-url">Argparse optional positional arguments?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/argparse-optional-positional-arguments/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T11:26:08+08:00" itemprop="datePublished" title="2023-02-17 11:26">2023-02-17 11:26</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I have a script which is meant to be used like this: <code>usage: installer.py dir
[-h] [-v]</code></p>
<p><code>dir</code> is a positional argument which is defined like this:</p>
<div class="code"><pre class="code literal-block">parser.add_argument('dir', default=os.getcwd())
</pre></div>

<p>I want the <code>dir</code> to be optional: when it's not specified it should just be
<code>cwd</code>.</p>
<p>Unfortunately when I don't specify the <code>dir</code> argument, I get <code>Error: Too few
arguments</code>.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Use <code>nargs='?'</code> (or <code>nargs='*'</code> if you need more than one dir)</p>
<div class="code"><pre class="code literal-block">parser.add_argument('dir', nargs='?', default=os.getcwd())
</pre></div>

<p>extended example:</p>
<div class="code"><pre class="code literal-block"><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">argparse</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">'-v'</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">'store_true'</span><span class="p">)</span>
<span class="n">_StoreTrueAction</span><span class="p">(</span><span class="n">option_strings</span><span class="o">=</span><span class="p">[</span><span class="s1">'-v'</span><span class="p">],</span> <span class="n">dest</span><span class="o">=</span><span class="s1">'v'</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">const</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">'dir'</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="s1">'?'</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>
<span class="n">_StoreAction</span><span class="p">(</span><span class="n">option_strings</span><span class="o">=</span><span class="p">[],</span> <span class="n">dest</span><span class="o">=</span><span class="s1">'dir'</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="s1">'?'</span><span class="p">,</span> <span class="n">const</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">'/home/vinay'</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="s1">'somedir -v'</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
<span class="n">Namespace</span><span class="p">(</span><span class="nb">dir</span><span class="o">=</span><span class="s1">'somedir'</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="s1">'-v'</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
<span class="n">Namespace</span><span class="p">(</span><span class="nb">dir</span><span class="o">=</span><span class="s1">'/home/vinay'</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="s1">''</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
<span class="n">Namespace</span><span class="p">(</span><span class="nb">dir</span><span class="o">=</span><span class="s1">'/home/vinay'</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">([</span><span class="s1">'somedir'</span><span class="p">])</span>
<span class="n">Namespace</span><span class="p">(</span><span class="nb">dir</span><span class="o">=</span><span class="s1">'somedir'</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="s1">'somedir -h -v'</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
<span class="n">usage</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">v</span><span class="p">]</span> <span class="p">[</span><span class="nb">dir</span><span class="p">]</span>

<span class="n">positional</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="nb">dir</span>

<span class="n">optional</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">--</span><span class="n">help</span>  <span class="n">show</span> <span class="n">this</span> <span class="n">help</span> <span class="n">message</span> <span class="ow">and</span> <span class="n">exit</span>
  <span class="o">-</span><span class="n">v</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>As an extension to @VinaySajip answer. There are additional <code>nargs</code> worth
mentioning.</p>
<ol>
<li><code>parser.add_argument('dir', nargs=1, default=os.getcwd())</code></li>
</ol>
<p>N (an integer). N arguments from the command line will be gathered together
into a list</p>
<ol>
<li><code>parser.add_argument('dir', nargs='*', default=os.getcwd())</code></li>
</ol>
<p>'<em>'. All command-line arguments present are gathered into a list. </em><em>Note</em>*
that it generally doesn't make much sense to have more than one positional
argument with <code>nargs='*'</code>, but multiple optional arguments with <code>nargs='*'</code> is
possible.</p>
<ol>
<li><code>parser.add_argument('dir', nargs='+', default=os.getcwd())</code></li>
</ol>
<p>'+'. Just like '*', all command-line args present are gathered into a list.
Additionally, an error message will be generated if there wasn’t at least one
command-line argument present.</p>
<ol>
<li><code>parser.add_argument('dir', nargs=argparse.REMAINDER, default=os.getcwd())</code></li>
</ol>
<p><code>argparse.REMAINDER</code>. All the remaining command-line arguments are gathered
into a list. This is commonly useful for command line utilities that dispatch
to other command line utilities</p>
<p>If the <code>nargs</code> keyword argument is not provided, the number of arguments
consumed is determined by the action. Generally this means a single command-
line argument will be consumed and a single item (not a list) will be
produced.</p>
<p><strong>Edit (copied from a comment by @Acumenus)</strong> <code>nargs='?'</code> The docs say: '?'.
One argument will be consumed from the command line if possible and produced
as a single item. If no command-line argument is present, the value from
default will be produced.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/typeerror-a-bytes-like-object-is-required-not-str-when-handling-file-content-in-python-3/" class="u-url">"TypeError: a bytes-like object is required, not 'str'" when handling file content in Python 3</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/typeerror-a-bytes-like-object-is-required-not-str-when-handling-file-content-in-python-3/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T11:25:43+08:00" itemprop="datePublished" title="2023-02-17 11:25">2023-02-17 11:25</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I've very recently migrated to Python 3.5. This code was working properly in
Python 2.7:</p>
<div class="code"><pre class="code literal-block"><span class="nv">with</span><span class="w"> </span><span class="nv">open</span><span class="ss">(</span><span class="nv">fname</span>,<span class="w"> </span><span class="s1">'rb'</span><span class="ss">)</span><span class="w"> </span><span class="nv">as</span><span class="w"> </span><span class="nv">f</span>:
<span class="w">    </span><span class="nv">lines</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>[<span class="nv">x</span>.<span class="nv">strip</span><span class="ss">()</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">f</span>.<span class="nv">readlines</span><span class="ss">()</span>]

<span class="k">for</span><span class="w"> </span><span class="nv">line</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">lines</span>:
<span class="w">    </span><span class="nv">tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">line</span>.<span class="nv">strip</span><span class="ss">()</span>.<span class="nv">lower</span><span class="ss">()</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="s1">'some-pattern'</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">tmp</span>:<span class="w"> </span><span class="k">continue</span>
<span class="w">    </span>#<span class="w"> </span>...<span class="w"> </span><span class="nv">code</span>
</pre></div>

<p>But in 3.5, on the <code>if 'some-pattern' in tmp: continue</code> line, I get an error
which says:</p>
<div class="code"><pre class="code literal-block"><span class="n">TypeError</span><span class="o">:</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">bytes</span><span class="o">-</span><span class="n">like</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">required</span><span class="o">,</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="s1">'str'</span>
</pre></div>

<p>I was unable to fix the problem using <code>.decode()</code> on either side of the <code>in</code>,
nor could I fix it using</p>
<div class="code"><pre class="code literal-block"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nv">tmp</span>.<span class="nv">find</span><span class="ss">(</span><span class="s1">'some-pattern'</span><span class="ss">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>:<span class="w"> </span><span class="k">continue</span>
</pre></div>

<p>What is wrong, and how do I fix it?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>You opened the file in binary mode:</p>
<div class="code"><pre class="code literal-block">with open(fname, 'rb') as f:
</pre></div>

<p>This means that all data read from the file is returned as <code>bytes</code> objects,
not <code>str</code>. You cannot then use a string in a containment test:</p>
<div class="code"><pre class="code literal-block"><span class="k">if</span><span class="w"> </span><span class="s1">'some-pattern'</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">tmp</span>:<span class="w"> </span><span class="k">continue</span>
</pre></div>

<p>You'd have to use a <code>bytes</code> object to test against <code>tmp</code> instead:</p>
<div class="code"><pre class="code literal-block"><span class="k">if</span><span class="w"> </span><span class="nv">b</span><span class="s1">'some-pattern'</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">tmp</span>:<span class="w"> </span><span class="k">continue</span>
</pre></div>

<p>or open the file as a textfile instead by replacing the <code>'rb'</code> mode with
<code>'r'</code>.</p>
<p><br></p>
<h3>Suggest</h3>
<p>You can encode your string by using <code>.encode()</code></p>
<p>Example:</p>
<div class="code"><pre class="code literal-block">'Hello World'.encode()
</pre></div>

<p>As the error describes, in order to write a string to a file you need to
encode it to a byte-like object first, and <code>encode()</code> is encoding it to a
byte-string.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/xcode-7-error-missing-ios-distribution-signing-identity-for/" class="u-url">Xcode 7 error: "Missing iOS Distribution signing identity for ..."</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/xcode-7-error-missing-ios-distribution-signing-identity-for/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T11:25:16+08:00" itemprop="datePublished" title="2023-02-17 11:25">2023-02-17 11:25</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I tried to upload my App to iTunes Connect resp. AppStore and got the
following error:</p>
<blockquote>
<p>Failed to locate or generate matching signing assets</p>
<p>Xcode attempted to locate or generate matching signing assets and failed to
do so because of the following issues.</p>
<p>Missing iOS Distribution signing identity for ... Xcode can request one for
you.</p>
</blockquote>
<p>Before I set up a new development machine, exported the developer accounts via
Xcode 7 from the old to the new machine.</p>
<p>What can I do to fix this?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>From Apple -</p>
<blockquote>
<p>Thanks for bringing this to the attention of the community and apologies for
the issues you’ve been having. This issue stems from having a copy of the
expired WWDR Intermediate certificate in both your System and Login
keychains. To resolve the issue, you should first download and install the
new WWDR intermediate certificate (by double-clicking on the file). Next, in
the Keychain Access application, select the System keychain. Make sure to
select “Show Expired Certificates” in the View menu and then delete the
expired version of the Apple Worldwide Developer Relations Certificate
Authority Intermediate certificate (expired on February 14, 2016). Your
certificates should now appear as valid in Keychain Access and be available
to Xcode for submissions to the App Store.</p>
</blockquote>
<p>As noted in a comment below, the expired certificate also needs to be removed
from the <code>login</code> section, as well:</p>
<blockquote>
<p>To all that cannot get it working despite the instructions... There are two
expired WWDR certs. One is in login keychain, and the other one is in the
System. You have to delete both of them in order to make things working</p>
</blockquote>
<p><br></p>
<h3>Suggest</h3>
<p>I also faced the same issue today. The following steps fixed my issue.</p>
<ol>
<li>Download https://developer.apple.com/certificationauthority/AppleWWDRCA.cer</li>
<li>Double-click to install to Keychain.</li>
<li>Then in Keychain, Select View -&gt; "Show Expired Certificates" in Keychain app.</li>
<li>It will list all the expired certifcates.</li>
<li>Delete "Apple Worldwide Developer Relations Certificate Authority certificates" from "login" tab</li>
<li>And also delete it from "System" tab.</li>
</ol>
<p>Now you are ready go.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-617.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-615.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
