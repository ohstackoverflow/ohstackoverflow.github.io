<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 405) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-405.html">
<link rel="prev" href="index-406.html" type="text/html">
<link rel="next" href="index-404.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/convert-a-string-representation-of-a-dictionary-to-a-dictionary/" class="u-url">Convert a String representation of a Dictionary to a dictionary</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/convert-a-string-representation-of-a-dictionary-to-a-dictionary/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T06:01:51+08:00" itemprop="datePublished" title="2023-02-17 06:01">2023-02-17 06:01</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>How can I convert the <code>str</code> representation of a <code>dict</code>, such as the following
string, into a <code>dict</code>?</p>
<div class="code"><pre class="code literal-block">s = "{'muffin' : 'lolz', 'foo' : 'kitty'}"
</pre></div>

<p>I prefer not to use <code>eval</code>. What else can I use?</p>
<p>The main reason for this, is one of my coworkers classes he wrote, converts
all input into strings. I'm not in the mood to go and modify his classes, to
deal with this issue.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>You can use the built-in <code>ast.literal_eval</code>:</p>
<div class="code"><pre class="code literal-block"><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">ast</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="s2">"{'muffin' : 'lolz', 'foo' : 'kitty'}"</span><span class="p">)</span>
<span class="p">{</span><span class="s1">'muffin'</span><span class="p">:</span> <span class="s1">'lolz'</span><span class="p">,</span> <span class="s1">'foo'</span><span class="p">:</span> <span class="s1">'kitty'</span><span class="p">}</span>
</pre></div>

<p>This is safer than using <code>eval</code>. As its own docs say:</p>
<div class="code"><pre class="code literal-block">&gt;&gt;&gt; help(ast.literal_eval)
Help on function literal_eval in module ast:

literal_eval(node_or_string)
    Safely evaluate an expression node or a string containing a Python
    expression.  The string or node provided may only consist of the following
    Python literal structures: strings, numbers, tuples, lists, dicts, booleans,
    and None.
</pre></div>

<p>For example:</p>
<div class="code"><pre class="code literal-block"><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="nv">eval</span><span class="ss">(</span><span class="s2">"shutil.rmtree('mongo')"</span><span class="ss">)</span>
<span class="nv">Traceback</span><span class="w"> </span><span class="ss">(</span><span class="nv">most</span><span class="w"> </span><span class="nv">recent</span><span class="w"> </span><span class="k">call</span><span class="w"> </span><span class="nl">last</span><span class="ss">)</span>:
<span class="w">  </span><span class="nv">File</span><span class="w"> </span><span class="s2">"&lt;stdin&gt;"</span>,<span class="w"> </span><span class="nv">line</span><span class="w"> </span><span class="mi">1</span>,<span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="o">&lt;</span><span class="nv">module</span><span class="o">&gt;</span>
<span class="w">  </span><span class="nv">File</span><span class="w"> </span><span class="s2">"&lt;string&gt;"</span>,<span class="w"> </span><span class="nv">line</span><span class="w"> </span><span class="mi">1</span>,<span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="o">&lt;</span><span class="nv">module</span><span class="o">&gt;</span>
<span class="w">  </span><span class="nv">File</span><span class="w"> </span><span class="s2">"/opt/Python-2.6.1/lib/python2.6/shutil.py"</span>,<span class="w"> </span><span class="nv">line</span><span class="w"> </span><span class="mi">208</span>,<span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">rmtree</span>
<span class="w">    </span><span class="nv">onerror</span><span class="ss">(</span><span class="nv">os</span>.<span class="nv">listdir</span>,<span class="w"> </span><span class="nv">path</span>,<span class="w"> </span><span class="nv">sys</span>.<span class="nv">exc_info</span><span class="ss">())</span>
<span class="w">  </span><span class="nv">File</span><span class="w"> </span><span class="s2">"/opt/Python-2.6.1/lib/python2.6/shutil.py"</span>,<span class="w"> </span><span class="nv">line</span><span class="w"> </span><span class="mi">206</span>,<span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">rmtree</span>
<span class="w">    </span><span class="nv">names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">os</span>.<span class="nv">listdir</span><span class="ss">(</span><span class="nv">path</span><span class="ss">)</span>
<span class="nv">OSError</span>:<span class="w"> </span>[<span class="nv">Errno</span><span class="w"> </span><span class="mi">2</span>]<span class="w"> </span><span class="nv">No</span><span class="w"> </span><span class="nv">such</span><span class="w"> </span><span class="nv">file</span><span class="w"> </span><span class="nv">or</span><span class="w"> </span><span class="nv">directory</span>:<span class="w"> </span><span class="s1">'mongo'</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="nv">ast</span>.<span class="nv">literal_eval</span><span class="ss">(</span><span class="s2">"shutil.rmtree('mongo')"</span><span class="ss">)</span>
<span class="nv">Traceback</span><span class="w"> </span><span class="ss">(</span><span class="nv">most</span><span class="w"> </span><span class="nv">recent</span><span class="w"> </span><span class="k">call</span><span class="w"> </span><span class="nl">last</span><span class="ss">)</span>:
<span class="w">  </span><span class="nv">File</span><span class="w"> </span><span class="s2">"&lt;stdin&gt;"</span>,<span class="w"> </span><span class="nv">line</span><span class="w"> </span><span class="mi">1</span>,<span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="o">&lt;</span><span class="nv">module</span><span class="o">&gt;</span>
<span class="w">  </span><span class="nv">File</span><span class="w"> </span><span class="s2">"/opt/Python-2.6.1/lib/python2.6/ast.py"</span>,<span class="w"> </span><span class="nv">line</span><span class="w"> </span><span class="mi">68</span>,<span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">literal_eval</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nv">_convert</span><span class="ss">(</span><span class="nv">node_or_string</span><span class="ss">)</span>
<span class="w">  </span><span class="nv">File</span><span class="w"> </span><span class="s2">"/opt/Python-2.6.1/lib/python2.6/ast.py"</span>,<span class="w"> </span><span class="nv">line</span><span class="w"> </span><span class="mi">67</span>,<span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">_convert</span>
<span class="w">    </span><span class="nv">raise</span><span class="w"> </span><span class="nv">ValueError</span><span class="ss">(</span><span class="s1">'malformed string'</span><span class="ss">)</span>
<span class="nv">ValueError</span>:<span class="w"> </span><span class="nv">malformed</span><span class="w"> </span><span class="nv">string</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>https://docs.python.org/library/json.html</p>
<p>JSON can solve this problem, though its decoder wants double quotes around
keys and values. If you don't mind a replace hack...</p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="nn">json</span>
<span class="n">s</span> <span class="o">=</span> <span class="s2">"{'muffin' : 'lolz', 'foo' : 'kitty'}"</span>
<span class="n">json_acceptable_string</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">"'"</span><span class="p">,</span> <span class="s2">"</span><span class="se">\"</span><span class="s2">"</span><span class="p">)</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json_acceptable_string</span><span class="p">)</span>
<span class="c1"># d = {u'muffin': u'lolz', u'foo': u'kitty'}</span>
</pre></div>

<p>NOTE that if you have single quotes as a part of your keys or values this will
fail due to improper character replacement. This solution is only recommended
if you have a strong aversion to the eval solution.</p>
<p>More about json single quote: jQuery.parseJSON throws “Invalid JSON” error due
to escaped single quote in JSON</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/switch-statement-for-multiple-cases-in-javascript/" class="u-url">Switch statement for multiple cases in JavaScript</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/switch-statement-for-multiple-cases-in-javascript/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T06:01:23+08:00" itemprop="datePublished" title="2023-02-17 06:01">2023-02-17 06:01</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I need multiple cases in switch statement in JavaScript, Something like:</p>
<div class="code"><pre class="code literal-block"><span class="n">switch</span><span class="w"> </span><span class="p">(</span><span class="n">varName</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="n">case</span><span class="w"> </span><span class="s2">"afshin"</span><span class="p">,</span><span class="w"> </span><span class="s2">"saeed"</span><span class="p">,</span><span class="w"> </span><span class="s2">"larry"</span><span class="p">:</span>
<span class="w">       </span><span class="n">alert</span><span class="p">(</span><span class="s1">'Hey'</span><span class="p">);</span>
<span class="w">       </span><span class="k">break</span><span class="p">;</span>

<span class="w">   </span><span class="n">default</span><span class="p">:</span>
<span class="w">       </span><span class="n">alert</span><span class="p">(</span><span class="s1">'Default case'</span><span class="p">);</span>
<span class="w">       </span><span class="k">break</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<p>How can I do that? If there's no way to do something like that in JavaScript,
I want to know an alternative solution that also follows the DRY concept.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Use the fall-through feature of the <code>switch</code> statement. A matched case will
run until a <code>break</code> (or the end of the <code>switch</code> statement) is found, so you
could write it like:</p>
<div class="code"><pre class="code literal-block"><span class="n">switch</span><span class="w"> </span><span class="p">(</span><span class="n">varName</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="n">case</span><span class="w"> </span><span class="s2">"afshin"</span><span class="p">:</span>
<span class="w">   </span><span class="n">case</span><span class="w"> </span><span class="s2">"saeed"</span><span class="p">:</span>
<span class="w">   </span><span class="n">case</span><span class="w"> </span><span class="s2">"larry"</span><span class="p">:</span><span class="w"> </span>
<span class="w">       </span><span class="n">alert</span><span class="p">(</span><span class="s1">'Hey'</span><span class="p">);</span>
<span class="w">       </span><span class="k">break</span><span class="p">;</span>

<span class="w">   </span><span class="n">default</span><span class="p">:</span><span class="w"> </span>
<span class="w">       </span><span class="n">alert</span><span class="p">(</span><span class="s1">'Default case'</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>This works in regular JavaScript:</p>
<div class="code"><pre class="code literal-block"><span class="n">function</span><span class="w"> </span><span class="n">theTest</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">var</span><span class="w"> </span><span class="n">answer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">;</span>
<span class="w">  </span><span class="n">switch</span><span class="p">(</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">case</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="w"> </span><span class="n">case</span><span class="w"> </span><span class="mi">2</span><span class="p">:</span><span class="w"> </span><span class="n">case</span><span class="w"> </span><span class="mi">3</span><span class="p">:</span>
<span class="w">      </span><span class="n">answer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Low"</span><span class="p">;</span>
<span class="w">      </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="n">case</span><span class="w"> </span><span class="mi">4</span><span class="p">:</span><span class="w"> </span><span class="n">case</span><span class="w"> </span><span class="mi">5</span><span class="p">:</span><span class="w"> </span><span class="n">case</span><span class="w"> </span><span class="mi">6</span><span class="p">:</span>
<span class="w">      </span><span class="n">answer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Mid"</span><span class="p">;</span>
<span class="w">      </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="n">case</span><span class="w"> </span><span class="mi">7</span><span class="p">:</span><span class="w"> </span><span class="n">case</span><span class="w"> </span><span class="mi">8</span><span class="p">:</span><span class="w"> </span><span class="n">case</span><span class="w"> </span><span class="mi">9</span><span class="p">:</span>
<span class="w">      </span><span class="n">answer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"High"</span><span class="p">;</span>
<span class="w">      </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="n">default</span><span class="p">:</span>
<span class="w">      </span><span class="n">answer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Massive or Tiny?"</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">answer</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">theTest</span><span class="p">(</span><span class="mi">9</span><span class="p">);</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/do-the-parentheses-after-the-type-name-make-a-difference-with-new/" class="u-url">Do the parentheses after the type name make a difference with new?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/do-the-parentheses-after-the-type-name-make-a-difference-with-new/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T06:00:56+08:00" itemprop="datePublished" title="2023-02-17 06:00">2023-02-17 06:00</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>If 'Test' is an ordinary class, is there any difference between:</p>
<div class="code"><pre class="code literal-block">Test* test = new Test;
</pre></div>

<p>and</p>
<div class="code"><pre class="code literal-block">Test* test = new Test();
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<p>Let's get pedantic, because there are differences that can actually affect
your code's behavior. Much of the following is taken from comments made to an
"Old New Thing" article.</p>
<p>Sometimes the memory returned by the new operator will be initialized, and
sometimes it won't depending on whether the type you're newing up is a POD
(plain old data), or if it's a class that contains POD members and is using a
compiler-generated default constructor.</p>
<ul>
<li>In C++1998 there are 2 types of initialization: zero and default</li>
<li>In C++2003 a 3rd type of initialization, value initialization was added.</li>
</ul>
<p>Assume:</p>
<div class="code"><pre class="code literal-block">struct A { int m; }; // POD
struct B { ~B(); int m; }; // non-POD, compiler generated default ctor
struct C { C() : m() {}; ~C(); int m; }; // non-POD, default-initialising m
</pre></div>

<p>In a C++98 compiler, the following should occur:</p>
<ul>
<li>
<code>new A</code> - indeterminate value</li>
<li>
<p><code>new A()</code> - zero-initialize</p>
</li>
<li>
<p><code>new B</code> - default construct (B::m is uninitialized)</p>
</li>
<li>
<p><code>new B()</code> - default construct (B::m is uninitialized)</p>
</li>
<li>
<p><code>new C</code> - default construct (C::m is zero-initialized)</p>
</li>
<li>
<p><code>new C()</code> - default construct (C::m is zero-initialized)</p>
</li>
</ul>
<p>In a C++03 conformant compiler, things should work like so:</p>
<ul>
<li>
<code>new A</code> - indeterminate value</li>
<li>
<p><code>new A()</code> - value-initialize A, which is zero-initialization since it's a POD.</p>
</li>
<li>
<p><code>new B</code> - default-initializes (leaves B::m uninitialized)</p>
</li>
<li>
<p><code>new B()</code> - value-initializes B which zero-initializes all fields since its default ctor is compiler generated as opposed to user-defined.</p>
</li>
<li>
<p><code>new C</code> - default-initializes C, which calls the default ctor.</p>
</li>
<li>
<p><code>new C()</code> - value-initializes C, which calls the default ctor.</p>
</li>
</ul>
<p>So in all versions of C++ there's a difference between <code>new A</code> and <code>new A()</code>
because A is a POD.</p>
<p>And there's a difference in behavior between C++98 and C++03 for the case <code>new
B()</code>.</p>
<p>This is one of the dusty corners of C++ that can drive you crazy. When
constructing an object, sometimes you want/need the parens, sometimes you
absolutely cannot have them, and sometimes it doesn't matter.</p>
<p><br></p>
<h3>Suggest</h3>
<p><code>new Thing();</code> is explicit that you want a constructor called whereas <code>new
Thing;</code> is taken to imply you don't mind if the constructor isn't called.</p>
<p>If used on a struct/class with a user-defined constructor, there is no
difference. If called on a trivial struct/class (e.g. <code>struct Thing { int i;
};</code>) then <code>new Thing;</code> is like <code>malloc(sizeof(Thing));</code> whereas <code>new Thing();</code>
is like <code>calloc(sizeof(Thing));</code> - it gets zero initialized.</p>
<p>The gotcha lies in-between:</p>
<div class="code"><pre class="code literal-block">struct Thingy {
  ~Thingy(); // No-longer a trivial class
  virtual WaxOn();
  int i;
};
</pre></div>

<p>The behavior of <code>new Thingy;</code> vs <code>new Thingy();</code> in this case changed between
C++98 and C++2003. See Michael Burr's explanation for how and why.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-406.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-404.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
