<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 405) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-405.html">
<link rel="prev" href="index-406.html" type="text/html">
<link rel="next" href="index-404.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/switch-statement-for-multiple-cases-in-javascript/" class="u-url">Switch statement for multiple cases in JavaScript</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/switch-statement-for-multiple-cases-in-javascript/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T06:01:23+08:00" itemprop="datePublished" title="2023-02-17 06:01">2023-02-17 06:01</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I need multiple cases in switch statement in JavaScript, Something like:</p>
<div class="code"><pre class="code literal-block"><span class="n">switch</span><span class="w"> </span><span class="p">(</span><span class="n">varName</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="n">case</span><span class="w"> </span><span class="s2">"afshin"</span><span class="p">,</span><span class="w"> </span><span class="s2">"saeed"</span><span class="p">,</span><span class="w"> </span><span class="s2">"larry"</span><span class="p">:</span>
<span class="w">       </span><span class="n">alert</span><span class="p">(</span><span class="s1">'Hey'</span><span class="p">);</span>
<span class="w">       </span><span class="k">break</span><span class="p">;</span>

<span class="w">   </span><span class="n">default</span><span class="p">:</span>
<span class="w">       </span><span class="n">alert</span><span class="p">(</span><span class="s1">'Default case'</span><span class="p">);</span>
<span class="w">       </span><span class="k">break</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<p>How can I do that? If there's no way to do something like that in JavaScript,
I want to know an alternative solution that also follows the DRY concept.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Use the fall-through feature of the <code>switch</code> statement. A matched case will
run until a <code>break</code> (or the end of the <code>switch</code> statement) is found, so you
could write it like:</p>
<div class="code"><pre class="code literal-block"><span class="n">switch</span><span class="w"> </span><span class="p">(</span><span class="n">varName</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="n">case</span><span class="w"> </span><span class="s2">"afshin"</span><span class="p">:</span>
<span class="w">   </span><span class="n">case</span><span class="w"> </span><span class="s2">"saeed"</span><span class="p">:</span>
<span class="w">   </span><span class="n">case</span><span class="w"> </span><span class="s2">"larry"</span><span class="p">:</span><span class="w"> </span>
<span class="w">       </span><span class="n">alert</span><span class="p">(</span><span class="s1">'Hey'</span><span class="p">);</span>
<span class="w">       </span><span class="k">break</span><span class="p">;</span>

<span class="w">   </span><span class="n">default</span><span class="p">:</span><span class="w"> </span>
<span class="w">       </span><span class="n">alert</span><span class="p">(</span><span class="s1">'Default case'</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>This works in regular JavaScript:</p>
<div class="code"><pre class="code literal-block"><span class="n">function</span><span class="w"> </span><span class="n">theTest</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">var</span><span class="w"> </span><span class="n">answer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">;</span>
<span class="w">  </span><span class="n">switch</span><span class="p">(</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">case</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="w"> </span><span class="n">case</span><span class="w"> </span><span class="mi">2</span><span class="p">:</span><span class="w"> </span><span class="n">case</span><span class="w"> </span><span class="mi">3</span><span class="p">:</span>
<span class="w">      </span><span class="n">answer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Low"</span><span class="p">;</span>
<span class="w">      </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="n">case</span><span class="w"> </span><span class="mi">4</span><span class="p">:</span><span class="w"> </span><span class="n">case</span><span class="w"> </span><span class="mi">5</span><span class="p">:</span><span class="w"> </span><span class="n">case</span><span class="w"> </span><span class="mi">6</span><span class="p">:</span>
<span class="w">      </span><span class="n">answer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Mid"</span><span class="p">;</span>
<span class="w">      </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="n">case</span><span class="w"> </span><span class="mi">7</span><span class="p">:</span><span class="w"> </span><span class="n">case</span><span class="w"> </span><span class="mi">8</span><span class="p">:</span><span class="w"> </span><span class="n">case</span><span class="w"> </span><span class="mi">9</span><span class="p">:</span>
<span class="w">      </span><span class="n">answer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"High"</span><span class="p">;</span>
<span class="w">      </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="n">default</span><span class="p">:</span>
<span class="w">      </span><span class="n">answer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Massive or Tiny?"</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">answer</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">theTest</span><span class="p">(</span><span class="mi">9</span><span class="p">);</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/do-the-parentheses-after-the-type-name-make-a-difference-with-new/" class="u-url">Do the parentheses after the type name make a difference with new?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/do-the-parentheses-after-the-type-name-make-a-difference-with-new/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T06:00:56+08:00" itemprop="datePublished" title="2023-02-17 06:00">2023-02-17 06:00</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>If 'Test' is an ordinary class, is there any difference between:</p>
<div class="code"><pre class="code literal-block">Test* test = new Test;
</pre></div>

<p>and</p>
<div class="code"><pre class="code literal-block">Test* test = new Test();
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<p>Let's get pedantic, because there are differences that can actually affect
your code's behavior. Much of the following is taken from comments made to an
"Old New Thing" article.</p>
<p>Sometimes the memory returned by the new operator will be initialized, and
sometimes it won't depending on whether the type you're newing up is a POD
(plain old data), or if it's a class that contains POD members and is using a
compiler-generated default constructor.</p>
<ul>
<li>In C++1998 there are 2 types of initialization: zero and default</li>
<li>In C++2003 a 3rd type of initialization, value initialization was added.</li>
</ul>
<p>Assume:</p>
<div class="code"><pre class="code literal-block">struct A { int m; }; // POD
struct B { ~B(); int m; }; // non-POD, compiler generated default ctor
struct C { C() : m() {}; ~C(); int m; }; // non-POD, default-initialising m
</pre></div>

<p>In a C++98 compiler, the following should occur:</p>
<ul>
<li>
<code>new A</code> - indeterminate value</li>
<li>
<p><code>new A()</code> - zero-initialize</p>
</li>
<li>
<p><code>new B</code> - default construct (B::m is uninitialized)</p>
</li>
<li>
<p><code>new B()</code> - default construct (B::m is uninitialized)</p>
</li>
<li>
<p><code>new C</code> - default construct (C::m is zero-initialized)</p>
</li>
<li>
<p><code>new C()</code> - default construct (C::m is zero-initialized)</p>
</li>
</ul>
<p>In a C++03 conformant compiler, things should work like so:</p>
<ul>
<li>
<code>new A</code> - indeterminate value</li>
<li>
<p><code>new A()</code> - value-initialize A, which is zero-initialization since it's a POD.</p>
</li>
<li>
<p><code>new B</code> - default-initializes (leaves B::m uninitialized)</p>
</li>
<li>
<p><code>new B()</code> - value-initializes B which zero-initializes all fields since its default ctor is compiler generated as opposed to user-defined.</p>
</li>
<li>
<p><code>new C</code> - default-initializes C, which calls the default ctor.</p>
</li>
<li>
<p><code>new C()</code> - value-initializes C, which calls the default ctor.</p>
</li>
</ul>
<p>So in all versions of C++ there's a difference between <code>new A</code> and <code>new A()</code>
because A is a POD.</p>
<p>And there's a difference in behavior between C++98 and C++03 for the case <code>new
B()</code>.</p>
<p>This is one of the dusty corners of C++ that can drive you crazy. When
constructing an object, sometimes you want/need the parens, sometimes you
absolutely cannot have them, and sometimes it doesn't matter.</p>
<p><br></p>
<h3>Suggest</h3>
<p><code>new Thing();</code> is explicit that you want a constructor called whereas <code>new
Thing;</code> is taken to imply you don't mind if the constructor isn't called.</p>
<p>If used on a struct/class with a user-defined constructor, there is no
difference. If called on a trivial struct/class (e.g. <code>struct Thing { int i;
};</code>) then <code>new Thing;</code> is like <code>malloc(sizeof(Thing));</code> whereas <code>new Thing();</code>
is like <code>calloc(sizeof(Thing));</code> - it gets zero initialized.</p>
<p>The gotcha lies in-between:</p>
<div class="code"><pre class="code literal-block">struct Thingy {
  ~Thingy(); // No-longer a trivial class
  virtual WaxOn();
  int i;
};
</pre></div>

<p>The behavior of <code>new Thingy;</code> vs <code>new Thingy();</code> in this case changed between
C++98 and C++2003. See Michael Burr's explanation for how and why.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/why-does-the-c-preprocessor-interpret-the-word-linux-as-the-constant-1/" class="u-url">Why does the C preprocessor interpret the word "linux" as the constant "1"?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/why-does-the-c-preprocessor-interpret-the-word-linux-as-the-constant-1/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T06:00:31+08:00" itemprop="datePublished" title="2023-02-17 06:00">2023-02-17 06:00</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Why does the <strong>C</strong> preprocessor in <strong>GCC</strong> interpret the word <code>linux</code> (small
letters) as the constant <code>1</code>?</p>
<p><strong>test.c:</strong></p>
<div class="code"><pre class="code literal-block"><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span><span class="w">       </span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">linux</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<p>Result of <code>$ gcc -E test.c</code> (stop after the preprocessing stage):</p>
<div class="code"><pre class="code literal-block">....
<span class="nv">int</span><span class="w"> </span><span class="nv">main</span><span class="ss">(</span><span class="nv">void</span><span class="ss">)</span>
{
<span class="w">    </span><span class="nv">int</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="c1">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="c1">;</span>
}
</pre></div>

<p>Which of course yields an error.</p>
<p>(BTW: There is no <code>#define linux</code> in the <code>stdio.h</code> file.)</p>
<p><br><br></p>
<h2>Answer</h2>
<p>In the Old Days (pre-ANSI), predefining symbols such as <code>unix</code> and <code>vax</code> was a
way to allow code to detect at compile time what system it was being compiled
for. There was no official language standard back then (beyond the reference
material at the back of the first edition of K&amp;R), and C code of any
complexity was typically a complex maze of <code>#ifdef</code>s to allow for differences
between systems. These macro definitions were generally set by the compiler
itself, not defined in a library header file. Since there were no real rules
about which identifiers could be used by the implementation and which were
reserved for programmers, compiler writers felt free to use simple names like
<code>unix</code> and assumed that programmers would simply avoid using those names for
their own purposes.</p>
<p>The 1989 ANSI C standard introduced rules restricting what symbols an
implementation could legally predefine. A macro predefined by the compiler
could only have a name starting with two underscores, or with an underscore
followed by an uppercase letter, leaving programmers free to use identifiers
not matching that pattern and not used in the standard library.</p>
<p>As a result, any compiler that predefines <code>unix</code> or <code>linux</code> is non-conforming,
since it will fail to compile perfectly legal code that uses something like
<code>int linux = 5;</code>.</p>
<p>As it happens, gcc is non-conforming by default -- but it can be made to
conform (reasonably well) with the right command-line options:</p>
<div class="code"><pre class="code literal-block">gcc -std=c90 -pedantic ... # or -std=c89 or -ansi
gcc -std=c99 -pedantic
gcc -std=c11 -pedantic
</pre></div>

<p>See the gcc manual for more details.</p>
<p>gcc will be phasing out these definitions in future releases, so you shouldn't
write code that depends on them. If your program needs to know whether it's
being compiled for a Linux target or not it can check whether <code>__linux__</code> is
defined (assuming you're using gcc or a compiler that's compatible with it).
See the GNU C preprocessor manual for more information.</p>
<p>A largely irrelevant aside: the "Best One Liner" winner of the 1987
International Obfuscated C Code Contest, by David Korn (yes, the author of the
Korn Shell) took advantage of the predefined <code>unix</code> macro:</p>
<div class="code"><pre class="code literal-block">main() { printf(&amp;unix["\021%six\012\0"],(unix)["have"]+"fun"-0x60);}
</pre></div>

<p>It prints <code>"unix"</code>, but for reasons that have absolutely nothing to do with
the spelling of the macro name.</p>
<p>I don't want to post any spoilers here, and I encourage anyone reading this to
try to understand that code on their own first. But if you really want to give
up, I've posted an explanation here: https://gist.github.com/Keith-S-
Thompson/6920347</p>
<p><br></p>
<h3>Suggest</h3>
<p>This appears to be an (undocumented) "GNU extension": [ <em>correction</em> : I
finally found a mention in the docs. See below.]</p>
<p>The following command uses the <code>-dM</code> option to print all preprocessor defines;
since the input "file" is empty, it shows exactly the predefined macros. It
was run with gcc-4.7.3 on a standard ubuntu install. You can see that the
preprocessor is standard-aware. In total, there 243 macros with <code>-std=gnu99</code>
and 240 with <code>-std=c99</code>; I filtered the output for relevance.</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span>cpp<span class="w"> </span>--std<span class="o">=</span>c89<span class="w"> </span>-dM<span class="w"> </span>&lt;<span class="w"> </span>/dev/null<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>linux
<span class="c1">#define __linux 1</span>
<span class="c1">#define __linux__ 1</span>
<span class="c1">#define __gnu_linux__ 1</span>

$<span class="w"> </span>cpp<span class="w"> </span>--std<span class="o">=</span>gnu89<span class="w"> </span>-dM<span class="w"> </span>&lt;<span class="w"> </span>/dev/null<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>linux
<span class="c1">#define __linux 1</span>
<span class="c1">#define __linux__ 1</span>
<span class="c1">#define __gnu_linux__ 1</span>
<span class="c1">#define linux 1</span>

$<span class="w"> </span>cpp<span class="w"> </span>--std<span class="o">=</span>c99<span class="w"> </span>-dM<span class="w"> </span>&lt;<span class="w"> </span>/dev/null<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>linux
<span class="c1">#define __linux 1</span>
<span class="c1">#define __linux__ 1</span>
<span class="c1">#define __gnu_linux__ 1</span>

$<span class="w"> </span>cpp<span class="w"> </span>--std<span class="o">=</span>gnu99<span class="w"> </span>-dM<span class="w"> </span>&lt;<span class="w"> </span>/dev/null<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>linux
<span class="c1">#define __linux 1</span>
<span class="c1">#define __linux__ 1</span>
<span class="c1">#define __gnu_linux__ 1</span>
<span class="c1">#define linux 1</span>
</pre></div>

<p>The "gnu standard" versions also <code>#define unix</code>. (Using <code>c11</code> and <code>gnu11</code>
produces the same results.)</p>
<p>I suppose they had their reasons, but it seems to me to make the default
installation of gcc (which compiles C code with <code>-std=gnu89</code> unless otherwise
specified) non-conformant, and -- as in this question -- surprising. Polluting
the global namespace with macros whose names don't begin with an underscore is
not permitted in a conformant implementation. (6.8.10p2: "Any other predefined
macro names shall begin with a leading underscore followed by an uppercase
letter or a second underscore," but, as mentioned in Appendix J.5 (portability
issues), such names are often predefined.)</p>
<p>When I originally wrote this answer, I wasn't able to find any documentation
in gcc about this issue, but I did finally discover it, not in C
implementation-defined behaviour nor in C extensions but in the <code>cpp</code> manual
section 3.7.3, where it notes that:</p>
<blockquote>
<p>We are slowly phasing out all predefined macros which are outside the
reserved namespace. You should never use them in new programs…</p>
</blockquote>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-406.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-404.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
