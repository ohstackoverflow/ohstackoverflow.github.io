<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 236) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-236.html">
<link rel="prev" href="index-237.html" type="text/html">
<link rel="next" href="index-235.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-directly-initialize-a-hashmap-in-a-literal-way/" class="u-url">How to directly initialize a HashMap (in a literal way)?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-directly-initialize-a-hashmap-in-a-literal-way/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T01:42:09+08:00" itemprop="datePublished" title="2023-02-17 01:42">2023-02-17 01:42</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Is there some way of initializing a Java HashMap like this?:</p>
<div class="code"><pre class="code literal-block">Map&lt;String,String&gt; test = 
    new HashMap&lt;String, String&gt;{"test":"test","test":"test"};
</pre></div>

<p>What would be the correct syntax? I have not found anything regarding this. Is
this possible? I am looking for the shortest/fastest way to put some
"final/static" values in a map that never change and are known in advance when
creating the Map.</p>
<p><br><br></p>
<h2>Answer</h2>
<h2>All Versions</h2>
<p>In case you happen to need just a single entry: There is
<code>Collections.singletonMap("key", "value")</code>.</p>
<h2>For Java Version 9 or higher:</h2>
<p>Yes, this is possible now. In Java 9 a couple of factory methods have been
added that simplify the creation of maps :</p>
<div class="code"><pre class="code literal-block"><span class="o">//</span> <span class="n">this</span> <span class="n">works</span> <span class="k">for</span> <span class="n">up</span> <span class="n">to</span> <span class="mi">10</span> <span class="n">elements</span><span class="p">:</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">test1</span> <span class="o">=</span> <span class="n">Map</span><span class="o">.</span><span class="n">of</span><span class="p">(</span>
    <span class="s2">"a"</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">,</span>
    <span class="s2">"c"</span><span class="p">,</span> <span class="s2">"d"</span>
<span class="p">);</span>

<span class="o">//</span> <span class="n">this</span> <span class="n">works</span> <span class="k">for</span> <span class="nb">any</span> <span class="n">number</span> <span class="n">of</span> <span class="n">elements</span><span class="p">:</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Map</span><span class="o">.</span><span class="n">entry</span><span class="p">;</span>    
<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">test2</span> <span class="o">=</span> <span class="n">Map</span><span class="o">.</span><span class="n">ofEntries</span><span class="p">(</span>
    <span class="n">entry</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">),</span>
    <span class="n">entry</span><span class="p">(</span><span class="s2">"c"</span><span class="p">,</span> <span class="s2">"d"</span><span class="p">)</span>
<span class="p">);</span>
</pre></div>

<p>In the example above both <code>test</code> and <code>test2</code> will be the same, just with
different ways of expressing the Map. The <code>Map.of</code> method is defined for up to
ten elements in the map, while the <code>Map.ofEntries</code> method will have no such
limit.</p>
<p>Note that in this case the resulting map will be an immutable map. If you want
the map to be mutable, you could copy it again, e.g. using <code>mutableMap = new
HashMap&lt;&gt;(Map.of("a", "b"));</code>. Also note that in this case keys and values
must not be <code>null</code>.</p>
<p>(See also JEP 269 and the Javadoc)</p>
<h2>For up to Java Version 8:</h2>
<p>No, you will have to add all the elements manually. You can use an initializer
in an anonymous subclass to make the syntax a little bit shorter:</p>
<div class="code"><pre class="code literal-block">Map&lt;String, String&gt; myMap = new HashMap&lt;String, String&gt;() {{
    put("a", "b");
    put("c", "d");
}};
</pre></div>

<p>However, the anonymous subclass might introduce unwanted behavior in some
cases. This includes for example:</p>
<ul>
<li>It generates an additional class which increases memory consumption, disk space consumption and startup-time</li>
<li>In case of a non-static method: It holds a reference to the object the creating method was called upon. That means the object of the outer class cannot be garbage collected while the created map object is still referenced, thus blocking additional memory</li>
</ul>
<p>Using a function for initialization will also enable you to generate a map in
an initializer, but avoids nasty side-effects:</p>
<div class="code"><pre class="code literal-block"><span class="nv">Map</span><span class="o">&lt;</span><span class="nv">String</span>,<span class="w"> </span><span class="nv">String</span><span class="o">&gt;</span><span class="w"> </span><span class="nv">myMap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">createMap</span><span class="ss">()</span><span class="c1">;</span>

<span class="nv">private</span><span class="w"> </span><span class="nv">static</span><span class="w"> </span><span class="nv">Map</span><span class="o">&lt;</span><span class="nv">String</span>,<span class="w"> </span><span class="nv">String</span><span class="o">&gt;</span><span class="w"> </span><span class="nv">createMap</span><span class="ss">()</span><span class="w"> </span>{
<span class="w">    </span><span class="nv">Map</span><span class="o">&lt;</span><span class="nv">String</span>,<span class="nv">String</span><span class="o">&gt;</span><span class="w"> </span><span class="nv">myMap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">HashMap</span><span class="o">&lt;</span><span class="nv">String</span>,<span class="nv">String</span><span class="o">&gt;</span><span class="ss">()</span><span class="c1">;</span>
<span class="w">    </span><span class="nv">myMap</span>.<span class="nv">put</span><span class="ss">(</span><span class="s2">"a"</span>,<span class="w"> </span><span class="s2">"b"</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">    </span><span class="nv">myMap</span>.<span class="nv">put</span><span class="ss">(</span><span class="s2">"c"</span>,<span class="w"> </span><span class="s2">"d"</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nv">myMap</span><span class="c1">;</span>
}
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>This is one way.</p>
<div class="code"><pre class="code literal-block">Map&lt;String, String&gt; h = new HashMap&lt;String, String&gt;() {{
    put("a","b");
}};
</pre></div>

<p>However, you should be careful and make sure that you understand the above
code (it creates a new class that inherits from HashMap). Therefore, you
should read more here: http://www.c2.com/cgi/wiki?DoubleBraceInitialization ,
or simply use Guava:</p>
<div class="code"><pre class="code literal-block">Map&lt;String, Integer&gt; left = ImmutableMap.of("a", 1, "b", 2, "c", 3);
</pre></div>

<p><code>ImmutableMap.of</code> works for up to 5 entries. Otherwise, use the builder:
source.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/relative-imports-for-the-billionth-time/" class="u-url">Relative imports for the billionth time</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/relative-imports-for-the-billionth-time/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T01:41:42+08:00" itemprop="datePublished" title="2023-02-17 01:41">2023-02-17 01:41</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I've been here:</p>
<ul>
<li>http://www.python.org/dev/peps/pep-0328/</li>
<li>http://docs.python.org/2/tutorial/modules.html#packages</li>
<li>Python packages: relative imports</li>
<li>python relative import example code does not work</li>
<li>Relative imports in python 2.5</li>
<li>Relative imports in Python</li>
<li>Python: Disabling relative import</li>
</ul>
<p>and plenty of URLs that I did not copy, some on SO, some on other sites, back
when I thought I'd have the solution quickly.</p>
<p>The forever-recurring question is this: how do I solve this "Attempted
relative import in non-package" message?</p>
<div class="code"><pre class="code literal-block"><span class="ne">ImportError</span><span class="p">:</span> <span class="n">attempted</span> <span class="n">relative</span> <span class="kn">import</span> <span class="nn">with</span> <span class="n">no</span> <span class="n">known</span> <span class="n">parent</span> <span class="n">package</span>
</pre></div>

<p>I built an exact replica of the package on pep-0328:</p>
<div class="code"><pre class="code literal-block">package/
    __init__.py
    subpackage1/
        __init__.py
        moduleX.py
        moduleY.py
    subpackage2/
        __init__.py
        moduleZ.py
    moduleA.py
</pre></div>

<p>The imports were done from the console.</p>
<p>I did make functions named spam and eggs in their appropriate modules.
Naturally, it didn't work. The answer is apparently in the 4th URL I listed,
but it's all alumni to me. There was this response on one of the URLs I
visited:</p>
<blockquote>
<p>Relative imports use a module's name attribute to determine that module's
position in the package hierarchy. If the module's name does not contain any
package information (e.g. it is set to 'main') then relative imports are
resolved as if the module were a top level module, regardless of where the
module is actually located on the file system.</p>
</blockquote>
<p>The above response looks promising, but it's all hieroglyphs to me. So my
question, how do I make Python not return to me "Attempted relative import in
non-package"? has an answer that involves -m, supposedly.</p>
<p>Can somebody please tell me why Python gives that error message, what it means
by "non-package", why and how do you define a 'package', and <em>the precise
answer put in terms easy enough for a kindergartener to understand</em>.</p>
<p><br><br></p>
<h2>Answer</h2>
<p><strong>Script vs. Module</strong></p>
<p>Here's an explanation. The short version is that there is a big difference
between directly running a Python file, and importing that file from somewhere
else. <strong>Just knowing what directory a file is in does not determine what
package Python thinks it is in.</strong> That depends, additionally, on how you load
the file into Python (by running or by importing).</p>
<p>There are two ways to load a Python file: as the top-level script, or as a
module. A file is loaded as the top-level script if you execute it directly,
for instance by typing <code>python myfile.py</code> on the command line. It is loaded as
a module when an <code>import</code> statement is encountered inside some other file.
There can only be one top-level script at a time; the top-level script is the
Python file you ran to start things off.</p>
<p><strong>Naming</strong></p>
<p>When a file is loaded, it is given a name (which is stored in its <code>__name__</code>
attribute).</p>
<ul>
<li>If it was loaded as the top-level script, its name is <code>__main__</code>.</li>
<li>If it was loaded as a module, its name is [ the filename, preceded by the names of any packages/subpackages of which it is a part, separated by dots ], for example, <code>package.subpackage1.moduleX</code>.</li>
</ul>
<p>But be aware, if you load <code>moduleX</code> as a module from shell command line using
something like <code>python -m package.subpackage1.moduleX</code>, the <code>__name__</code> will
still be <code>__main__</code>.</p>
<p>So for instance in your example:</p>
<div class="code"><pre class="code literal-block">package/
    __init__.py
    subpackage1/
        __init__.py
        moduleX.py
    moduleA.py
</pre></div>

<p>if you imported <code>moduleX</code> (note: <em>imported</em> , not directly executed), its name
would be <code>package.subpackage1.moduleX</code>. If you imported <code>moduleA</code>, its name
would be <code>package.moduleA</code>. However, if you <em>directly run</em> <code>moduleX</code> from the
command line, its name will instead be <code>__main__</code>, and if you directly run
<code>moduleA</code> from the command line, its name will be <code>__main__</code>. When a module is
run as the top-level script, it loses its normal name and its name is instead
<code>__main__</code>.</p>
<p><strong>Accessing a module NOT through its containing package</strong></p>
<p>There is an additional wrinkle: the module's name depends on whether it was
imported "directly" from the directory it is in or imported via a package.
This only makes a difference if you run Python in a directory, and try to
import a file in that same directory (or a subdirectory of it). For instance,
if you start the Python interpreter in the directory <code>package/subpackage1</code> and
then do <code>import moduleX</code>, the name of <code>moduleX</code> will just be <code>moduleX</code>, and
not <code>package.subpackage1.moduleX</code>. This is because Python adds the current
directory to its search path when the interpreter is entered interactively; if
it finds the to-be-imported module in the current directory, it will not know
that that directory is part of a package, and the package information will not
become part of the module's name.</p>
<p>A special case is if you run the interpreter interactively (e.g., just type
<code>python</code> and start entering Python code on the fly). In this case, the name of
that interactive session is <code>__main__</code>.</p>
<p>Now here is the crucial thing for your error message: <strong>if a module's name has
no dots, it is not considered to be part of a package</strong>. It doesn't matter
where the file actually is on disk. All that matters is what its name is, and
its name depends on how you loaded it.</p>
<p>Now look at the quote you included in your question:</p>
<blockquote>
<p>Relative imports use a module's name attribute to determine that module's
position in the package hierarchy. If the module's name does not contain any
package information (e.g. it is set to 'main') then relative imports are
resolved as if the module were a top-level module, regardless of where the
module is actually located on the file system.</p>
</blockquote>
<p><strong>Relative imports...</strong></p>
<p>Relative imports use the module's <em>name</em> to determine where it is in a
package. When you use a relative import like <code>from .. import foo</code>, the dots
indicate to step up some number of levels in the package hierarchy. For
instance, if your current module's name is <code>package.subpackage1.moduleX</code>, then
<code>..moduleA</code> would mean <code>package.moduleA</code>. For a <code>from .. import</code> to work, the
module's name must have at least as many dots as there are in the <code>import</code>
statement.</p>
<p><strong>... are only relative in a package</strong></p>
<p>However, if your module's name is <code>__main__</code>, it is not considered to be in a
package. Its name has no dots, and therefore you cannot use <code>from .. import</code>
statements inside it. If you try to do so, you will get the "relative-import
in non-package" error.</p>
<p><strong>Scripts can't import relative</strong></p>
<p>What you probably did is you tried to run <code>moduleX</code> or the like from the
command line. When you did this, its name was set to <code>__main__</code>, which means
that relative imports within it will fail, because its name does not reveal
that it is in a package. Note that this will also happen if you run Python
from the same directory where a module is, and then try to import that module,
because, as described above, Python will find the module in the current
directory "too early" without realizing it is part of a package.</p>
<p>Also remember that when you run the interactive interpreter, the "name" of
that interactive session is always <code>__main__</code>. Thus <strong>you cannot do relative
imports directly from an interactive session</strong>. Relative imports are only for
use within module files.</p>
<p><strong>Two solutions:</strong></p>
<ol>
<li>
<p>If you really do want to run <code>moduleX</code> directly, but you still want it to be considered part of a package, you can do <code>python -m package.subpackage1.moduleX</code>. The <code>-m</code> tells Python to load it as a module, not as the top-level script.</p>
</li>
<li>
<p>Or perhaps you don't actually want to <em>run</em> <code>moduleX</code>, you just want to run some other script, say <code>myfile.py</code>, that <em>uses</em> functions inside <code>moduleX</code>. If that is the case, put <code>myfile.py</code> <em>somewhere else</em> – <em>not</em> inside the <code>package</code> directory – and run it. If inside <code>myfile.py</code> you do things like <code>from package.moduleA import spam</code>, it will work fine.</p>
</li>
</ol>
<p><strong>Notes</strong></p>
<ul>
<li>
<p>For either of these solutions, the package directory (<code>package</code> in your example) must be accessible from the Python module search path (<code>sys.path</code>). If it is not, you will not be able to use anything in the package reliably at all.</p>
</li>
<li>
<p>Since Python 2.6, the module's "name" for package-resolution purposes is determined not just by its <code>__name__</code> attributes but also by the <code>__package__</code> attribute. That's why I'm avoiding using the explicit symbol <code>__name__</code> to refer to the module's "name". Since Python 2.6 a module's "name" is effectively <code>__package__ + '.' + __name__</code>, or just <code>__name__</code> if <code>__package__</code> is <code>None</code>.)</p>
</li>
</ul>
<p><br></p>
<h3>Suggest</h3>
<p>This is really a problem within python. <strong>The origin of confusion is that
people mistakenly takes the relative import as path relative which is not.</strong></p>
<p>For example when you write in <em>faa.py</em> :</p>
<div class="code"><pre class="code literal-block"><span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">foo</span>
</pre></div>

<p>This has a meaning only if <em>faa.py</em> was <em>identified and loaded</em> by python,
during execution, as a part of a package. In that case,the <strong>module's name</strong>
for <em>faa.py</em> would be for example <em>some_packagename.faa</em>. If the file was
loaded just because it is in the current directory, when python is run, then
its name would not refer to any package and eventually relative import would
fail.</p>
<p>A simple solution to refer modules in the current directory, is to use this:</p>
<div class="code"><pre class="code literal-block"><span class="k">if</span> <span class="n">__package__</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">__package__</span> <span class="o">==</span> <span class="s1">''</span><span class="p">:</span>
    <span class="c1"># uses current directory visibility</span>
    <span class="kn">import</span> <span class="nn">foo</span>
<span class="k">else</span><span class="p">:</span>
    <span class="c1"># uses current package visibility</span>
    <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">foo</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-do-i-show-my-global-git-configuration/" class="u-url">How do I show my global Git configuration?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-do-i-show-my-global-git-configuration/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T01:41:13+08:00" itemprop="datePublished" title="2023-02-17 01:41">2023-02-17 01:41</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I'd like to show all configured Git sections.</p>
<p>I only found <code>git config --get core.editor</code>, and I'd like to output everything
that's configured globally, not only the configured default editor.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>You can use:</p>
<div class="code"><pre class="code literal-block">git config --list
</pre></div>

<p>or look at your <code>~/.gitconfig</code> file. The local configuration will be in your
repository's <code>.git/config</code> file.</p>
<p>Use:</p>
<div class="code"><pre class="code literal-block"><span class="nv">git</span><span class="w"> </span><span class="nv">config</span><span class="w"> </span><span class="o">--</span><span class="nv">list</span><span class="w"> </span><span class="o">--</span><span class="k">show</span><span class="o">-</span><span class="nv">origin</span>
</pre></div>

<p>to see where that setting is defined (global, user, repo, etc...)</p>
<p><br></p>
<h3>Suggest</h3>
<p>The shortest,</p>
<div class="code"><pre class="code literal-block">git config -l
</pre></div>

<p>shows all inherited values from: system, global and local</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-237.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-235.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
