<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 2441) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-2441.html">
<link rel="prev" href="index-2442.html" type="text/html">
<link rel="next" href="index-2440.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/java-8-difference-between-two-localdatetime-in-multiple-units/" class="u-url">Java 8: Difference between two LocalDateTime in multiple units</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/java-8-difference-between-two-localdatetime-in-multiple-units/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T16:24:43+08:00" itemprop="datePublished" title="2023-03-04 16:24">2023-03-04 16:24</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I am trying to calculate the difference between two <code>LocalDateTime</code>.</p>
<p>The output needs to be of the format <code>y years m months d days h hours m
minutes s seconds</code>. Here is what I have written:</p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="nn">java.time.Duration</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.time.Instant</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.time.LocalDateTime</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.time.Period</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.time.ZoneId</span><span class="p">;</span>

<span class="n">public</span> <span class="k">class</span> <span class="nc">Main</span> <span class="p">{</span>

    <span class="n">static</span> <span class="n">final</span> <span class="nb">int</span> <span class="n">MINUTES_PER_HOUR</span> <span class="o">=</span> <span class="mi">60</span><span class="p">;</span>
    <span class="n">static</span> <span class="n">final</span> <span class="nb">int</span> <span class="n">SECONDS_PER_MINUTE</span> <span class="o">=</span> <span class="mi">60</span><span class="p">;</span>
    <span class="n">static</span> <span class="n">final</span> <span class="nb">int</span> <span class="n">SECONDS_PER_HOUR</span> <span class="o">=</span> <span class="n">SECONDS_PER_MINUTE</span> <span class="o">*</span> <span class="n">MINUTES_PER_HOUR</span><span class="p">;</span>

    <span class="n">public</span> <span class="n">static</span> <span class="n">void</span> <span class="n">main</span><span class="p">(</span><span class="n">String</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">LocalDateTime</span> <span class="n">toDateTime</span> <span class="o">=</span> <span class="n">LocalDateTime</span><span class="o">.</span><span class="n">of</span><span class="p">(</span><span class="mi">2014</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">45</span><span class="p">);</span>
        <span class="n">LocalDateTime</span> <span class="n">fromDateTime</span> <span class="o">=</span> <span class="n">LocalDateTime</span><span class="o">.</span><span class="n">of</span><span class="p">(</span><span class="mi">1984</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">55</span><span class="p">);</span>

        <span class="n">Period</span> <span class="n">period</span> <span class="o">=</span> <span class="n">getPeriod</span><span class="p">(</span><span class="n">fromDateTime</span><span class="p">,</span> <span class="n">toDateTime</span><span class="p">);</span>
        <span class="n">long</span> <span class="n">time</span><span class="p">[]</span> <span class="o">=</span> <span class="n">getTime</span><span class="p">(</span><span class="n">fromDateTime</span><span class="p">,</span> <span class="n">toDateTime</span><span class="p">);</span>

        <span class="n">System</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">println</span><span class="p">(</span><span class="n">period</span><span class="o">.</span><span class="n">getYears</span><span class="p">()</span> <span class="o">+</span> <span class="s2">" years "</span> <span class="o">+</span> 
                <span class="n">period</span><span class="o">.</span><span class="n">getMonths</span><span class="p">()</span> <span class="o">+</span> <span class="s2">" months "</span> <span class="o">+</span> 
                <span class="n">period</span><span class="o">.</span><span class="n">getDays</span><span class="p">()</span> <span class="o">+</span> <span class="s2">" days "</span> <span class="o">+</span>
                <span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">" hours "</span> <span class="o">+</span>
                <span class="n">time</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s2">" minutes "</span> <span class="o">+</span>
                <span class="n">time</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="s2">" seconds."</span><span class="p">);</span>


    <span class="p">}</span>

    <span class="n">private</span> <span class="n">static</span> <span class="n">Period</span> <span class="n">getPeriod</span><span class="p">(</span><span class="n">LocalDateTime</span> <span class="n">dob</span><span class="p">,</span> <span class="n">LocalDateTime</span> <span class="n">now</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">Period</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="n">dob</span><span class="o">.</span><span class="n">toLocalDate</span><span class="p">(),</span> <span class="n">now</span><span class="o">.</span><span class="n">toLocalDate</span><span class="p">());</span>
    <span class="p">}</span>

    <span class="n">private</span> <span class="n">static</span> <span class="n">long</span><span class="p">[]</span> <span class="n">getTime</span><span class="p">(</span><span class="n">LocalDateTime</span> <span class="n">dob</span><span class="p">,</span> <span class="n">LocalDateTime</span> <span class="n">now</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">LocalDateTime</span> <span class="n">today</span> <span class="o">=</span> <span class="n">LocalDateTime</span><span class="o">.</span><span class="n">of</span><span class="p">(</span><span class="n">now</span><span class="o">.</span><span class="n">getYear</span><span class="p">(),</span>
                <span class="n">now</span><span class="o">.</span><span class="n">getMonthValue</span><span class="p">(),</span> <span class="n">now</span><span class="o">.</span><span class="n">getDayOfMonth</span><span class="p">(),</span> <span class="n">dob</span><span class="o">.</span><span class="n">getHour</span><span class="p">(),</span> <span class="n">dob</span><span class="o">.</span><span class="n">getMinute</span><span class="p">(),</span> <span class="n">dob</span><span class="o">.</span><span class="n">getSecond</span><span class="p">());</span>
        <span class="n">Duration</span> <span class="n">duration</span> <span class="o">=</span> <span class="n">Duration</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="n">today</span><span class="p">,</span> <span class="n">now</span><span class="p">);</span>

        <span class="n">long</span> <span class="n">seconds</span> <span class="o">=</span> <span class="n">duration</span><span class="o">.</span><span class="n">getSeconds</span><span class="p">();</span>

        <span class="n">long</span> <span class="n">hours</span> <span class="o">=</span> <span class="n">seconds</span> <span class="o">/</span> <span class="n">SECONDS_PER_HOUR</span><span class="p">;</span>
        <span class="n">long</span> <span class="n">minutes</span> <span class="o">=</span> <span class="p">((</span><span class="n">seconds</span> <span class="o">%</span> <span class="n">SECONDS_PER_HOUR</span><span class="p">)</span> <span class="o">/</span> <span class="n">SECONDS_PER_MINUTE</span><span class="p">);</span>
        <span class="n">long</span> <span class="n">secs</span> <span class="o">=</span> <span class="p">(</span><span class="n">seconds</span> <span class="o">%</span> <span class="n">SECONDS_PER_MINUTE</span><span class="p">);</span>

        <span class="k">return</span> <span class="n">new</span> <span class="n">long</span><span class="p">[]{</span><span class="n">hours</span><span class="p">,</span> <span class="n">minutes</span><span class="p">,</span> <span class="n">secs</span><span class="p">};</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p>The output that I am getting is <code>29 years 8 months 24 days 12 hours 0 minutes
50 seconds</code>. I have checked my result from this website (with values
<code>12/16/1984 07:45:55</code> and <code>09/09/2014 19:46:45</code>). The following screenshot
shows the output:</p>
<p><img alt="Epoch Converter" src="images/SAJE4.png"></p>
<p>I am pretty sure that the fields after the month value is coming wrong from my
code. Any suggestion would be very helpful.</p>
<h3>Update</h3>
<p>I have tested my result from another website and the result I got is
different. Here it is: Calculate duration between two dates (result: 29 years,
8 months, 24 days, 12 hours, 0 minutes and 50 seconds).</p>
<h3>Update</h3>
<p>Since I got two different results from two different sites, I am wondering if
the algorithm of my calculation is legitimate or not. If I use following two
<code>LocalDateTime</code> objects:</p>
<div class="code"><pre class="code literal-block">LocalDateTime toDateTime = LocalDateTime.of(2014, 9, 10, 6, 40, 45);
LocalDateTime fromDateTime = LocalDateTime.of(1984, 12, 16, 7, 45, 55);
</pre></div>

<p>Then the output is coming: <code>29 years 8 months 25 days -1 hours -5 minutes -10
seconds.</code></p>
<p>From this link it should be <code>29 years 8 months 24 days 22 hours, 54 minutes
and 50 seconds</code>. So the algorithm needs to handle the negative numbers too.</p>
<p><strong>Note the question is not about which site gave me what result, I need to
know the right algorithm and need to have right results.</strong></p>
<p><br><br></p>
<h2>Answer</h2>
<p>Unfortunately, there doesn't seem to be a period class that spans time as
well, so you might have to do the calculations on your own.</p>
<p>Fortunately, the date and time classes have a lot of utility methods that
simplify that to some degree. Here's a way to calculate the difference
although not necessarily the fastest:</p>
<div class="code"><pre class="code literal-block"><span class="nv">LocalDateTime</span><span class="w"> </span><span class="nv">fromDateTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">LocalDateTime</span>.<span class="nv">of</span><span class="ss">(</span><span class="mi">1984</span>,<span class="w"> </span><span class="mi">12</span>,<span class="w"> </span><span class="mi">16</span>,<span class="w"> </span><span class="mi">7</span>,<span class="w"> </span><span class="mi">45</span>,<span class="w"> </span><span class="mi">55</span><span class="ss">)</span><span class="c1">;</span>
<span class="nv">LocalDateTime</span><span class="w"> </span><span class="nv">toDateTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">LocalDateTime</span>.<span class="nv">of</span><span class="ss">(</span><span class="mi">2014</span>,<span class="w"> </span><span class="mi">9</span>,<span class="w"> </span><span class="mi">10</span>,<span class="w"> </span><span class="mi">6</span>,<span class="w"> </span><span class="mi">40</span>,<span class="w"> </span><span class="mi">45</span><span class="ss">)</span><span class="c1">;</span>

<span class="nv">LocalDateTime</span><span class="w"> </span><span class="nv">tempDateTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">LocalDateTime</span>.<span class="nv">from</span><span class="ss">(</span><span class="w"> </span><span class="nv">fromDateTime</span><span class="w"> </span><span class="ss">)</span><span class="c1">;</span>

<span class="nv">long</span><span class="w"> </span><span class="nv">years</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">tempDateTime</span>.<span class="k">until</span><span class="ss">(</span><span class="w"> </span><span class="nv">toDateTime</span>,<span class="w"> </span><span class="nv">ChronoUnit</span>.<span class="nv">YEARS</span><span class="w"> </span><span class="ss">)</span><span class="c1">;</span>
<span class="nv">tempDateTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">tempDateTime</span>.<span class="nv">plusYears</span><span class="ss">(</span><span class="w"> </span><span class="nv">years</span><span class="w"> </span><span class="ss">)</span><span class="c1">;</span>

<span class="nv">long</span><span class="w"> </span><span class="nv">months</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">tempDateTime</span>.<span class="k">until</span><span class="ss">(</span><span class="w"> </span><span class="nv">toDateTime</span>,<span class="w"> </span><span class="nv">ChronoUnit</span>.<span class="nv">MONTHS</span><span class="w"> </span><span class="ss">)</span><span class="c1">;</span>
<span class="nv">tempDateTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">tempDateTime</span>.<span class="nv">plusMonths</span><span class="ss">(</span><span class="w"> </span><span class="nv">months</span><span class="w"> </span><span class="ss">)</span><span class="c1">;</span>

<span class="nv">long</span><span class="w"> </span><span class="nv">days</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">tempDateTime</span>.<span class="k">until</span><span class="ss">(</span><span class="w"> </span><span class="nv">toDateTime</span>,<span class="w"> </span><span class="nv">ChronoUnit</span>.<span class="nv">DAYS</span><span class="w"> </span><span class="ss">)</span><span class="c1">;</span>
<span class="nv">tempDateTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">tempDateTime</span>.<span class="nv">plusDays</span><span class="ss">(</span><span class="w"> </span><span class="nv">days</span><span class="w"> </span><span class="ss">)</span><span class="c1">;</span>


<span class="nv">long</span><span class="w"> </span><span class="nv">hours</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">tempDateTime</span>.<span class="k">until</span><span class="ss">(</span><span class="w"> </span><span class="nv">toDateTime</span>,<span class="w"> </span><span class="nv">ChronoUnit</span>.<span class="nv">HOURS</span><span class="w"> </span><span class="ss">)</span><span class="c1">;</span>
<span class="nv">tempDateTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">tempDateTime</span>.<span class="nv">plusHours</span><span class="ss">(</span><span class="w"> </span><span class="nv">hours</span><span class="w"> </span><span class="ss">)</span><span class="c1">;</span>

<span class="nv">long</span><span class="w"> </span><span class="nv">minutes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">tempDateTime</span>.<span class="k">until</span><span class="ss">(</span><span class="w"> </span><span class="nv">toDateTime</span>,<span class="w"> </span><span class="nv">ChronoUnit</span>.<span class="nv">MINUTES</span><span class="w"> </span><span class="ss">)</span><span class="c1">;</span>
<span class="nv">tempDateTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">tempDateTime</span>.<span class="nv">plusMinutes</span><span class="ss">(</span><span class="w"> </span><span class="nv">minutes</span><span class="w"> </span><span class="ss">)</span><span class="c1">;</span>

<span class="nv">long</span><span class="w"> </span><span class="nv">seconds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">tempDateTime</span>.<span class="k">until</span><span class="ss">(</span><span class="w"> </span><span class="nv">toDateTime</span>,<span class="w"> </span><span class="nv">ChronoUnit</span>.<span class="nv">SECONDS</span><span class="w"> </span><span class="ss">)</span><span class="c1">;</span>

<span class="nv">System</span>.<span class="nv">out</span>.<span class="nv">println</span><span class="ss">(</span><span class="w"> </span><span class="nv">years</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">" years "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">        </span><span class="nv">months</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">" months "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">        </span><span class="nv">days</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">" days "</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="nv">hours</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">" hours "</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="nv">minutes</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">" minutes "</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="nv">seconds</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">" seconds."</span><span class="ss">)</span><span class="c1">;</span>

<span class="o">//</span><span class="nv">prints</span>:<span class="w"> </span><span class="mi">29</span><span class="w"> </span><span class="nv">years</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="nv">months</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="nv">days</span><span class="w"> </span><span class="mi">22</span><span class="w"> </span><span class="nv">hours</span><span class="w"> </span><span class="mi">54</span><span class="w"> </span><span class="nv">minutes</span><span class="w"> </span><span class="mi">50</span><span class="w"> </span><span class="nv">seconds</span>.
</pre></div>

<p>The basic idea is this: create a temporary start date and get the full years
to the end. Then adjust that date by the number of years so that the start
date is less then a year from the end. Repeat that for each time unit in
descending order.</p>
<p><em>Finally a disclaimer</em> : I didn't take different timezones into account (both
dates should be in the same timezone) and I also didn't test/check how
daylight saving time or other changes in a calendar (like the timezone changes
in Samoa) affect this calculation. So use with care.</p>
<p><br></p>
<h3>Suggest</h3>
<p>Unfortunately, there doesn't seem to be a period class that spans time as
well, so you might have to do the calculations on your own.</p>
<p>Fortunately, the date and time classes have a lot of utility methods that
simplify that to some degree. Here's a way to calculate the difference
although not necessarily the fastest:</p>
<div class="code"><pre class="code literal-block"><span class="nv">LocalDateTime</span><span class="w"> </span><span class="nv">fromDateTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">LocalDateTime</span>.<span class="nv">of</span><span class="ss">(</span><span class="mi">1984</span>,<span class="w"> </span><span class="mi">12</span>,<span class="w"> </span><span class="mi">16</span>,<span class="w"> </span><span class="mi">7</span>,<span class="w"> </span><span class="mi">45</span>,<span class="w"> </span><span class="mi">55</span><span class="ss">)</span><span class="c1">;</span>
<span class="nv">LocalDateTime</span><span class="w"> </span><span class="nv">toDateTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">LocalDateTime</span>.<span class="nv">of</span><span class="ss">(</span><span class="mi">2014</span>,<span class="w"> </span><span class="mi">9</span>,<span class="w"> </span><span class="mi">10</span>,<span class="w"> </span><span class="mi">6</span>,<span class="w"> </span><span class="mi">40</span>,<span class="w"> </span><span class="mi">45</span><span class="ss">)</span><span class="c1">;</span>

<span class="nv">LocalDateTime</span><span class="w"> </span><span class="nv">tempDateTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">LocalDateTime</span>.<span class="nv">from</span><span class="ss">(</span><span class="w"> </span><span class="nv">fromDateTime</span><span class="w"> </span><span class="ss">)</span><span class="c1">;</span>

<span class="nv">long</span><span class="w"> </span><span class="nv">years</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">tempDateTime</span>.<span class="k">until</span><span class="ss">(</span><span class="w"> </span><span class="nv">toDateTime</span>,<span class="w"> </span><span class="nv">ChronoUnit</span>.<span class="nv">YEARS</span><span class="w"> </span><span class="ss">)</span><span class="c1">;</span>
<span class="nv">tempDateTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">tempDateTime</span>.<span class="nv">plusYears</span><span class="ss">(</span><span class="w"> </span><span class="nv">years</span><span class="w"> </span><span class="ss">)</span><span class="c1">;</span>

<span class="nv">long</span><span class="w"> </span><span class="nv">months</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">tempDateTime</span>.<span class="k">until</span><span class="ss">(</span><span class="w"> </span><span class="nv">toDateTime</span>,<span class="w"> </span><span class="nv">ChronoUnit</span>.<span class="nv">MONTHS</span><span class="w"> </span><span class="ss">)</span><span class="c1">;</span>
<span class="nv">tempDateTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">tempDateTime</span>.<span class="nv">plusMonths</span><span class="ss">(</span><span class="w"> </span><span class="nv">months</span><span class="w"> </span><span class="ss">)</span><span class="c1">;</span>

<span class="nv">long</span><span class="w"> </span><span class="nv">days</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">tempDateTime</span>.<span class="k">until</span><span class="ss">(</span><span class="w"> </span><span class="nv">toDateTime</span>,<span class="w"> </span><span class="nv">ChronoUnit</span>.<span class="nv">DAYS</span><span class="w"> </span><span class="ss">)</span><span class="c1">;</span>
<span class="nv">tempDateTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">tempDateTime</span>.<span class="nv">plusDays</span><span class="ss">(</span><span class="w"> </span><span class="nv">days</span><span class="w"> </span><span class="ss">)</span><span class="c1">;</span>


<span class="nv">long</span><span class="w"> </span><span class="nv">hours</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">tempDateTime</span>.<span class="k">until</span><span class="ss">(</span><span class="w"> </span><span class="nv">toDateTime</span>,<span class="w"> </span><span class="nv">ChronoUnit</span>.<span class="nv">HOURS</span><span class="w"> </span><span class="ss">)</span><span class="c1">;</span>
<span class="nv">tempDateTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">tempDateTime</span>.<span class="nv">plusHours</span><span class="ss">(</span><span class="w"> </span><span class="nv">hours</span><span class="w"> </span><span class="ss">)</span><span class="c1">;</span>

<span class="nv">long</span><span class="w"> </span><span class="nv">minutes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">tempDateTime</span>.<span class="k">until</span><span class="ss">(</span><span class="w"> </span><span class="nv">toDateTime</span>,<span class="w"> </span><span class="nv">ChronoUnit</span>.<span class="nv">MINUTES</span><span class="w"> </span><span class="ss">)</span><span class="c1">;</span>
<span class="nv">tempDateTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">tempDateTime</span>.<span class="nv">plusMinutes</span><span class="ss">(</span><span class="w"> </span><span class="nv">minutes</span><span class="w"> </span><span class="ss">)</span><span class="c1">;</span>

<span class="nv">long</span><span class="w"> </span><span class="nv">seconds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">tempDateTime</span>.<span class="k">until</span><span class="ss">(</span><span class="w"> </span><span class="nv">toDateTime</span>,<span class="w"> </span><span class="nv">ChronoUnit</span>.<span class="nv">SECONDS</span><span class="w"> </span><span class="ss">)</span><span class="c1">;</span>

<span class="nv">System</span>.<span class="nv">out</span>.<span class="nv">println</span><span class="ss">(</span><span class="w"> </span><span class="nv">years</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">" years "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">        </span><span class="nv">months</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">" months "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">        </span><span class="nv">days</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">" days "</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="nv">hours</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">" hours "</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="nv">minutes</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">" minutes "</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="nv">seconds</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">" seconds."</span><span class="ss">)</span><span class="c1">;</span>

<span class="o">//</span><span class="nv">prints</span>:<span class="w"> </span><span class="mi">29</span><span class="w"> </span><span class="nv">years</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="nv">months</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="nv">days</span><span class="w"> </span><span class="mi">22</span><span class="w"> </span><span class="nv">hours</span><span class="w"> </span><span class="mi">54</span><span class="w"> </span><span class="nv">minutes</span><span class="w"> </span><span class="mi">50</span><span class="w"> </span><span class="nv">seconds</span>.
</pre></div>

<p>The basic idea is this: create a temporary start date and get the full years
to the end. Then adjust that date by the number of years so that the start
date is less then a year from the end. Repeat that for each time unit in
descending order.</p>
<p><em>Finally a disclaimer</em> : I didn't take different timezones into account (both
dates should be in the same timezone) and I also didn't test/check how
daylight saving time or other changes in a calendar (like the timezone changes
in Samoa) affect this calculation. So use with care.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-make-a-phone-call-using-intent-in-android/" class="u-url">How to make a phone call using intent in Android?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-make-a-phone-call-using-intent-in-android/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T16:22:56+08:00" itemprop="datePublished" title="2023-03-04 16:22">2023-03-04 16:22</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I'm using the following code to make a call in Android but it is giving me
security exception please help.</p>
<div class="code"><pre class="code literal-block"><span class="w"> </span><span class="nt">posted_by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"111-333-222-4"</span><span class="o">;</span>

<span class="w"> </span><span class="nt">String</span><span class="w"> </span><span class="nt">uri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"tel:"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nt">posted_by</span><span class="p">.</span><span class="nc">trim</span><span class="o">()</span><span class="w"> </span><span class="o">;</span>
<span class="w"> </span><span class="nt">Intent</span><span class="w"> </span><span class="nt">intent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">new</span><span class="w"> </span><span class="nt">Intent</span><span class="o">(</span><span class="nt">Intent</span><span class="p">.</span><span class="nc">ACTION_CALL</span><span class="o">);</span>
<span class="w"> </span><span class="nt">intent</span><span class="p">.</span><span class="nc">setData</span><span class="o">(</span><span class="nt">Uri</span><span class="p">.</span><span class="nc">parse</span><span class="o">(</span><span class="nt">uri</span><span class="o">));</span>
<span class="w"> </span><span class="nt">startActivity</span><span class="o">(</span><span class="nt">intent</span><span class="o">);</span>
</pre></div>

<p>permissions</p>
<div class="code"><pre class="code literal-block"> &lt;uses-permission android:name="android.permission.CALL_PHONE" /&gt;
</pre></div>

<p>Exception</p>
<div class="code"><pre class="code literal-block"><span class="mf">11</span><span class="o">-</span><span class="mf">25</span><span class="w"> </span><span class="mf">14</span><span class="p">:</span><span class="mf">47</span><span class="p">:</span><span class="mf">01.661</span><span class="p">:</span><span class="w"> </span><span class="n">ERROR</span><span class="o">/</span><span class="ow">And</span><span class="n">roidRuntime</span><span class="p">(</span><span class="mf">302</span><span class="p">):</span><span class="w"> </span><span class="n">Uncaught</span><span class="w"> </span><span class="n">handler</span><span class="p">:</span><span class="w"> </span><span class="n">thread</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="n">exiting</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="kr">to</span><span class="w"> </span><span class="n">uncaught</span><span class="w"> </span><span class="n">exception</span>
<span class="mf">11</span><span class="o">-</span><span class="mf">25</span><span class="w"> </span><span class="mf">14</span><span class="p">:</span><span class="mf">47</span><span class="p">:</span><span class="mf">01.681</span><span class="p">:</span><span class="w"> </span><span class="n">ERROR</span><span class="o">/</span><span class="ow">And</span><span class="n">roidRuntime</span><span class="p">(</span><span class="mf">302</span><span class="p">):</span><span class="w"> </span><span class="n">java</span><span class="mf">.</span><span class="n">lang</span><span class="mf">.</span><span class="n">SecurityException</span><span class="p">:</span><span class="w"> </span><span class="n">Permission</span><span class="w"> </span><span class="n">Denial</span><span class="p">:</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="nb">Int</span><span class="n">ent</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="n">act</span><span class="o">=</span><span class="ow">and</span><span class="n">roid</span><span class="mf">.</span><span class="nb">int</span><span class="n">ent</span><span class="mf">.</span><span class="n">action</span><span class="mf">.</span><span class="n">CALL</span><span class="w"> </span><span class="n">dat</span><span class="o">=</span><span class="n">tel</span><span class="p">:</span><span class="mf">111</span><span class="o">-</span><span class="mf">333</span><span class="o">-</span><span class="mf">222</span><span class="o">-</span><span class="mf">4</span><span class="w"> </span><span class="n">cmp</span><span class="o">=</span><span class="n">com</span><span class="mf">.</span><span class="ow">and</span><span class="n">roid</span><span class="mf">.</span><span class="n">phone</span><span class="o">/</span><span class="mf">.</span><span class="n">OutgoingCallBroadcaster</span><span class="w"> </span><span class="err">}</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">ProcessRecord</span><span class="err">{</span><span class="mf">43</span><span class="n">d32508</span><span class="w"> </span><span class="mf">302</span><span class="p">:</span><span class="n">com</span><span class="mf">.</span><span class="n">Finditnear</span><span class="o">/</span><span class="mf">10026</span><span class="err">}</span><span class="w"> </span><span class="p">(</span><span class="n">pid</span><span class="o">=</span><span class="mf">302</span><span class="p">,</span><span class="w"> </span><span class="n">uid</span><span class="o">=</span><span class="mf">10026</span><span class="p">)</span><span class="w"> </span><span class="n">requires</span><span class="w"> </span><span class="ow">and</span><span class="n">roid</span><span class="mf">.</span><span class="n">permission</span><span class="mf">.</span><span class="n">CALL_PHONE</span>
<span class="mf">11</span><span class="o">-</span><span class="mf">25</span><span class="w"> </span><span class="mf">14</span><span class="p">:</span><span class="mf">47</span><span class="p">:</span><span class="mf">01.681</span><span class="p">:</span><span class="w"> </span><span class="n">ERROR</span><span class="o">/</span><span class="ow">And</span><span class="n">roidRuntime</span><span class="p">(</span><span class="mf">302</span><span class="p">):</span><span class="w">     </span><span class="n">at</span><span class="w"> </span><span class="ow">and</span><span class="n">roid</span><span class="mf">.</span><span class="n">os</span><span class="mf">.</span><span class="n">Parcel</span><span class="mf">.</span><span class="kr">read</span><span class="n">Exception</span><span class="p">(</span><span class="n">Parcel</span><span class="mf">.</span><span class="n">java</span><span class="p">:</span><span class="mf">1218</span><span class="p">)</span>
<span class="mf">11</span><span class="o">-</span><span class="mf">25</span><span class="w"> </span><span class="mf">14</span><span class="p">:</span><span class="mf">47</span><span class="p">:</span><span class="mf">01.681</span><span class="p">:</span><span class="w"> </span><span class="n">ERROR</span><span class="o">/</span><span class="ow">And</span><span class="n">roidRuntime</span><span class="p">(</span><span class="mf">302</span><span class="p">):</span><span class="w">     </span><span class="n">at</span><span class="w"> </span><span class="ow">and</span><span class="n">roid</span><span class="mf">.</span><span class="n">os</span><span class="mf">.</span><span class="n">Parcel</span><span class="mf">.</span><span class="kr">read</span><span class="n">Exception</span><span class="p">(</span><span class="n">Parcel</span><span class="mf">.</span><span class="n">java</span><span class="p">:</span><span class="mf">1206</span><span class="p">)</span>
<span class="mf">11</span><span class="o">-</span><span class="mf">25</span><span class="w"> </span><span class="mf">14</span><span class="p">:</span><span class="mf">47</span><span class="p">:</span><span class="mf">01.681</span><span class="p">:</span><span class="w"> </span><span class="n">ERROR</span><span class="o">/</span><span class="ow">And</span><span class="n">roidRuntime</span><span class="p">(</span><span class="mf">302</span><span class="p">):</span><span class="w">     </span><span class="n">at</span><span class="w"> </span><span class="ow">and</span><span class="n">roid</span><span class="mf">.</span><span class="n">app</span><span class="mf">.</span><span class="n">ActivityManagerProxy</span><span class="mf">.</span><span class="n">startActivity</span><span class="p">(</span><span class="n">ActivityManagerNative</span><span class="mf">.</span><span class="n">java</span><span class="p">:</span><span class="mf">1214</span><span class="p">)</span>
<span class="mf">11</span><span class="o">-</span><span class="mf">25</span><span class="w"> </span><span class="mf">14</span><span class="p">:</span><span class="mf">47</span><span class="p">:</span><span class="mf">01.681</span><span class="p">:</span><span class="w"> </span><span class="n">ERROR</span><span class="o">/</span><span class="ow">And</span><span class="n">roidRuntime</span><span class="p">(</span><span class="mf">302</span><span class="p">):</span><span class="w">     </span><span class="n">at</span><span class="w"> </span><span class="ow">and</span><span class="n">roid</span><span class="mf">.</span><span class="n">app</span><span class="mf">.</span><span class="n">Instrumentation</span><span class="mf">.</span><span class="n">execStartActivity</span><span class="p">(</span><span class="n">Instrumentation</span><span class="mf">.</span><span class="n">java</span><span class="p">:</span><span class="mf">1373</span><span class="p">)</span>
<span class="mf">11</span><span class="o">-</span><span class="mf">25</span><span class="w"> </span><span class="mf">14</span><span class="p">:</span><span class="mf">47</span><span class="p">:</span><span class="mf">01.681</span><span class="p">:</span><span class="w"> </span><span class="n">ERROR</span><span class="o">/</span><span class="ow">And</span><span class="n">roidRuntime</span><span class="p">(</span><span class="mf">302</span><span class="p">):</span><span class="w">     </span><span class="n">at</span><span class="w"> </span><span class="ow">and</span><span class="n">roid</span><span class="mf">.</span><span class="n">app</span><span class="mf">.</span><span class="n">Activity</span><span class="mf">.</span><span class="n">startActivityForResult</span><span class="p">(</span><span class="n">Activity</span><span class="mf">.</span><span class="n">java</span><span class="p">:</span><span class="mf">2749</span><span class="p">)</span>
<span class="mf">11</span><span class="o">-</span><span class="mf">25</span><span class="w"> </span><span class="mf">14</span><span class="p">:</span><span class="mf">47</span><span class="p">:</span><span class="mf">01.681</span><span class="p">:</span><span class="w"> </span><span class="n">ERROR</span><span class="o">/</span><span class="ow">And</span><span class="n">roidRuntime</span><span class="p">(</span><span class="mf">302</span><span class="p">):</span><span class="w">     </span><span class="n">at</span><span class="w"> </span><span class="ow">and</span><span class="n">roid</span><span class="mf">.</span><span class="n">app</span><span class="mf">.</span><span class="n">Activity</span><span class="mf">.</span><span class="n">startActivity</span><span class="p">(</span><span class="n">Activity</span><span class="mf">.</span><span class="n">java</span><span class="p">:</span><span class="mf">2855</span><span class="p">)</span>
<span class="mf">11</span><span class="o">-</span><span class="mf">25</span><span class="w"> </span><span class="mf">14</span><span class="p">:</span><span class="mf">47</span><span class="p">:</span><span class="mf">01.681</span><span class="p">:</span><span class="w"> </span><span class="n">ERROR</span><span class="o">/</span><span class="ow">And</span><span class="n">roidRuntime</span><span class="p">(</span><span class="mf">302</span><span class="p">):</span><span class="w">     </span><span class="n">at</span><span class="w"> </span><span class="n">com</span><span class="mf">.</span><span class="n">Finditnear</span><span class="mf">.</span><span class="nb">Pos</span><span class="n">tDetail$</span><span class="mf">2</span><span class="err">$</span><span class="mf">1</span><span class="err">$</span><span class="mf">1</span><span class="err">$</span><span class="mf">1.</span><span class="kr">on</span><span class="n">Click</span><span class="p">(</span><span class="nb">Pos</span><span class="n">tDetail</span><span class="mf">.</span><span class="n">java</span><span class="p">:</span><span class="mf">604</span><span class="p">)</span>
<span class="mf">11</span><span class="o">-</span><span class="mf">25</span><span class="w"> </span><span class="mf">14</span><span class="p">:</span><span class="mf">47</span><span class="p">:</span><span class="mf">01.681</span><span class="p">:</span><span class="w"> </span><span class="n">ERROR</span><span class="o">/</span><span class="ow">And</span><span class="n">roidRuntime</span><span class="p">(</span><span class="mf">302</span><span class="p">):</span><span class="w">     </span><span class="n">at</span><span class="w"> </span><span class="n">com</span><span class="mf">.</span><span class="ow">and</span><span class="n">roid</span><span class="mf">.</span><span class="nb">int</span><span class="n">ernal</span><span class="mf">.</span><span class="n">app</span><span class="mf">.</span><span class="n">AlertController$AlertParams$</span><span class="mf">3.</span><span class="kr">on</span><span class="n">ItemClick</span><span class="p">(</span><span class="n">AlertController</span><span class="mf">.</span><span class="n">java</span><span class="p">:</span><span class="mf">884</span><span class="p">)</span>
<span class="mf">11</span><span class="o">-</span><span class="mf">25</span><span class="w"> </span><span class="mf">14</span><span class="p">:</span><span class="mf">47</span><span class="p">:</span><span class="mf">01.681</span><span class="p">:</span><span class="w"> </span><span class="n">ERROR</span><span class="o">/</span><span class="ow">And</span><span class="n">roidRuntime</span><span class="p">(</span><span class="mf">302</span><span class="p">):</span><span class="w">     </span><span class="n">at</span><span class="w"> </span><span class="ow">and</span><span class="n">roid</span><span class="mf">.</span><span class="n">widget</span><span class="mf">.</span><span class="n">AdapterView</span><span class="mf">.</span><span class="n">performItemClick</span><span class="p">(</span><span class="n">AdapterView</span><span class="mf">.</span><span class="n">java</span><span class="p">:</span><span class="mf">284</span><span class="p">)</span>
<span class="mf">11</span><span class="o">-</span><span class="mf">25</span><span class="w"> </span><span class="mf">14</span><span class="p">:</span><span class="mf">47</span><span class="p">:</span><span class="mf">01.681</span><span class="p">:</span><span class="w"> </span><span class="n">ERROR</span><span class="o">/</span><span class="ow">And</span><span class="n">roidRuntime</span><span class="p">(</span><span class="mf">302</span><span class="p">):</span><span class="w">     </span><span class="n">at</span><span class="w"> </span><span class="ow">and</span><span class="n">roid</span><span class="mf">.</span><span class="n">widget</span><span class="mf">.</span><span class="kr">List</span><span class="n">View</span><span class="mf">.</span><span class="n">performItemClick</span><span class="p">(</span><span class="kr">List</span><span class="n">View</span><span class="mf">.</span><span class="n">java</span><span class="p">:</span><span class="mf">3285</span><span class="p">)</span>
<span class="mf">11</span><span class="o">-</span><span class="mf">25</span><span class="w"> </span><span class="mf">14</span><span class="p">:</span><span class="mf">47</span><span class="p">:</span><span class="mf">01.681</span><span class="p">:</span><span class="w"> </span><span class="n">ERROR</span><span class="o">/</span><span class="ow">And</span><span class="n">roidRuntime</span><span class="p">(</span><span class="mf">302</span><span class="p">):</span><span class="w">     </span><span class="n">at</span><span class="w"> </span><span class="ow">and</span><span class="n">roid</span><span class="mf">.</span><span class="n">widget</span><span class="mf">.</span><span class="nb">Abs</span><span class="kr">List</span><span class="n">View$PerformClick</span><span class="mf">.</span><span class="kr">run</span><span class="p">(</span><span class="nb">Abs</span><span class="kr">List</span><span class="n">View</span><span class="mf">.</span><span class="n">java</span><span class="p">:</span><span class="mf">1640</span><span class="p">)</span>
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<p>Every thing is fine.</p>
<p>i just placed call permissions tag before application tag in manifest file</p>
<p>and now every thing is working fine.</p>
<p><br></p>
<h3>Suggest</h3>
<p>This demo will helpful for you...</p>
<p>On call button click:</p>
<div class="code"><pre class="code literal-block"><span class="nt">Intent</span><span class="w"> </span><span class="nt">intent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">new</span><span class="w"> </span><span class="nt">Intent</span><span class="o">(</span><span class="nt">Intent</span><span class="p">.</span><span class="nc">ACTION_CALL</span><span class="o">,</span><span class="w"> </span><span class="nt">Uri</span><span class="p">.</span><span class="nc">parse</span><span class="o">(</span><span class="s2">"tel:"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">"Your Phone_number"</span><span class="o">));</span>
<span class="nt">startActivity</span><span class="o">(</span><span class="nt">intent</span><span class="o">);</span>
</pre></div>

<p>Permission in Manifest:</p>
<div class="code"><pre class="code literal-block"> &lt;uses-permission android:name="android.permission.CALL_PHONE" /&gt;
</pre></div>

<p><strong>EDIT IN 2021</strong></p>
<p>You should write it in your manifest file but at the same time you should ask
in runtime.Like this code:</p>
<div class="code"><pre class="code literal-block"><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">ContextCompat</span>.<span class="nv">checkSelfPermission</span><span class="ss">(</span><span class="nv">this</span>,<span class="nv">android</span>.<span class="nv">Manifest</span>.<span class="nv">permission</span>.<span class="nv">CALL_PHONE</span><span class="ss">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nv">PackageManager</span>.<span class="nv">PERMISSION_GRANTED</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">            </span><span class="nv">ActivityCompat</span>.<span class="nv">requestPermissions</span><span class="ss">(</span><span class="nv">this</span>,<span class="w"> </span><span class="nv">arrayOf</span><span class="ss">(</span><span class="nv">android</span>.<span class="nv">Manifest</span>.<span class="nv">permission</span>.<span class="nv">CALL_PHONE</span><span class="ss">)</span>,
<span class="w">                </span><span class="nv">REQUEST_CODE</span><span class="ss">)</span>

<span class="w">        </span>}<span class="w"> </span><span class="k">else</span><span class="w"> </span>{

<span class="o">//</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="nv">block</span><span class="w"> </span><span class="nv">means</span><span class="w"> </span><span class="nv">user</span><span class="w"> </span><span class="nv">has</span><span class="w"> </span><span class="nv">already</span><span class="w"> </span><span class="nv">accepted</span>.<span class="nv">And</span><span class="w"> </span><span class="nv">make</span><span class="w"> </span><span class="nv">your</span><span class="w"> </span><span class="nv">phone</span><span class="w"> </span><span class="k">call</span><span class="w"> </span><span class="nl">here</span>.

}
</pre></div>

<p>And if you want you can override onRequestPermissionsResult to give user
better experience if you write same code with else block here your user will
not need to click on your button again after you give permission it will
directly call.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-get-a-listbox-itemtemplate-to-stretch-horizontally-the-full-width-of-the-listbox/" class="u-url">How to get a ListBox ItemTemplate to stretch horizontally the full width of the ListBox?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-get-a-listbox-itemtemplate-to-stretch-horizontally-the-full-width-of-the-listbox/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T16:21:28+08:00" itemprop="datePublished" title="2023-03-04 16:21">2023-03-04 16:21</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I want to have the ListItems to extend with their orange background the full
width of the Listbox.</p>
<p>Currently they are only as wide as the FirstName + LastName.</p>
<p>I've set every element I can to: HorizontalAlignment="Stretch".</p>
<p>I want the background of the ListboxItems to expand as the user stretches the
Listbox so I don't want to put in absolute values.</p>
<p><strong>What do I have to do so that the background color of the ListBoxItems fill
the width of the ListBox?</strong></p>
<div class="code"><pre class="code literal-block"><span class="nt">&lt;Window</span><span class="w"> </span><span class="na">x:Class=</span><span class="s">"TestListBoxSelectedItemStyle.Window1"</span>
<span class="w">    </span><span class="na">xmlns=</span><span class="s">"http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span>
<span class="w">    </span><span class="na">xmlns:x=</span><span class="s">"http://schemas.microsoft.com/winfx/2006/xaml"</span>
<span class="w">    </span><span class="na">xmlns:local=</span><span class="s">"clr-namespace:TestListBoxSelectedItemStyle"</span>
<span class="w">    </span><span class="na">Title=</span><span class="s">"Window1"</span><span class="w"> </span><span class="na">Height=</span><span class="s">"300"</span><span class="w"> </span><span class="na">Width=</span><span class="s">"300"</span><span class="nt">&gt;</span>

<span class="w">    </span><span class="nt">&lt;Window.Resources&gt;</span>
<span class="w">        </span><span class="nt">&lt;local:CustomerViewModel</span><span class="w"> </span><span class="na">x:Key=</span><span class="s">"TheDataProvider"</span><span class="nt">/&gt;</span>

<span class="w">        </span><span class="nt">&lt;DataTemplate</span><span class="w"> </span><span class="na">x:Key=</span><span class="s">"CustomerItemTemplate"</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;Border</span><span class="w"> </span><span class="na">CornerRadius=</span><span class="s">"5"</span><span class="w"> </span><span class="na">Background=</span><span class="s">"Orange"</span><span class="w"> </span><span class="na">HorizontalAlignment=</span><span class="s">"Stretch"</span><span class="w"> </span><span class="na">Padding=</span><span class="s">"5"</span><span class="w"> </span><span class="na">Margin=</span><span class="s">"3"</span><span class="nt">&gt;</span>
<span class="w">                </span><span class="nt">&lt;StackPanel</span><span class="w"> </span><span class="na">Orientation=</span><span class="s">"Horizontal"</span><span class="w"> </span><span class="na">HorizontalAlignment=</span><span class="s">"Stretch"</span><span class="w"> </span><span class="na">Width=</span><span class="s">"Auto"</span><span class="nt">&gt;</span>
<span class="w">                    </span><span class="nt">&lt;TextBlock</span><span class="w"> </span><span class="na">HorizontalAlignment=</span><span class="s">"Stretch"</span><span class="nt">&gt;</span>
<span class="w">                    </span><span class="nt">&lt;TextBlock.Text&gt;</span>
<span class="w">                        </span><span class="nt">&lt;MultiBinding</span><span class="w"> </span><span class="na">StringFormat=</span><span class="s">"{}{0} {1}"</span><span class="nt">&gt;</span>
<span class="w">                            </span><span class="nt">&lt;Binding</span><span class="w"> </span><span class="na">Path=</span><span class="s">"FirstName"</span><span class="nt">/&gt;</span>
<span class="w">                            </span><span class="nt">&lt;Binding</span><span class="w"> </span><span class="na">Path=</span><span class="s">"LastName"</span><span class="nt">/&gt;</span>
<span class="w">                        </span><span class="nt">&lt;/MultiBinding&gt;</span>
<span class="w">                    </span><span class="nt">&lt;/TextBlock.Text&gt;</span>
<span class="w">                    </span><span class="nt">&lt;/TextBlock&gt;</span>
<span class="w">                </span><span class="nt">&lt;/StackPanel&gt;</span>
<span class="w">            </span><span class="nt">&lt;/Border&gt;</span>
<span class="w">        </span><span class="nt">&lt;/DataTemplate&gt;</span>

<span class="w">    </span><span class="nt">&lt;/Window.Resources&gt;</span>

<span class="w">    </span><span class="nt">&lt;Grid&gt;</span>
<span class="w">        </span><span class="nt">&lt;ListBox</span><span class="w"> </span><span class="na">ItemsSource=</span><span class="s">"{Binding Path=GetAllCustomers, Source={StaticResource TheDataProvider}}"</span>
<span class="w">                 </span><span class="na">ItemTemplate=</span><span class="s">"{StaticResource CustomerItemTemplate}"</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/Grid&gt;</span>
<span class="nt">&lt;/Window&gt;</span>
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<p>I'm sure this is a duplicate, but I can't find a question with the same
answer.</p>
<p>Add <code>HorizontalContentAlignment="Stretch"</code> to your ListBox. That should do the
trick. Just be careful with auto-complete because it is so easy to get
<code>HorizontalAlignment</code> by mistake.</p>
<p><br></p>
<h3>Suggest</h3>
<p>I'm sure this is a duplicate, but I can't find a question with the same
answer.</p>
<p>Add <code>HorizontalContentAlignment="Stretch"</code> to your ListBox. That should do the
trick. Just be careful with auto-complete because it is so easy to get
<code>HorizontalAlignment</code> by mistake.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-2442.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-2440.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
