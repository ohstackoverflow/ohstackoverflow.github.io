<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 173) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-173.html">
<link rel="prev" href="index-174.html" type="text/html">
<link rel="next" href="index-172.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/why-do-i-need-to-do-set-upstream-all-the-time/" class="u-url">Why do I need to do `--set-upstream` all the time?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/why-do-i-need-to-do-set-upstream-all-the-time/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-16T23:50:54+08:00" itemprop="datePublished" title="2023-02-16 23:50">2023-02-16 23:50</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I create a new branch in Git:</p>
<div class="code"><pre class="code literal-block">git branch my_branch
</pre></div>

<p>Push it:</p>
<div class="code"><pre class="code literal-block">git push origin my_branch
</pre></div>

<p>Now say someone made some changes on the server and I want to pull from
<code>origin/my_branch</code>. I do:</p>
<div class="code"><pre class="code literal-block">git pull
</pre></div>

<p>But I get:</p>
<div class="code"><pre class="code literal-block"><span class="nv">You</span><span class="w"> </span><span class="nv">asked</span><span class="w"> </span><span class="nv">me</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">pull</span><span class="w"> </span><span class="nv">without</span><span class="w"> </span><span class="nv">telling</span><span class="w"> </span><span class="nv">me</span><span class="w"> </span><span class="nv">which</span><span class="w"> </span><span class="nv">branch</span><span class="w"> </span><span class="nv">you</span>
<span class="nv">want</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">merge</span><span class="w"> </span><span class="nv">with</span>,<span class="w"> </span><span class="nv">and</span><span class="w"> </span><span class="s1">'branch.my_branch.merge'</span><span class="w"> </span><span class="nv">in</span>
<span class="nv">your</span><span class="w"> </span><span class="nv">configuration</span><span class="w"> </span><span class="nv">file</span><span class="w"> </span><span class="nv">does</span><span class="w"> </span><span class="nv">not</span><span class="w"> </span><span class="nv">tell</span><span class="w"> </span><span class="nv">me</span>,<span class="w"> </span><span class="nv">either</span>.<span class="w"> </span><span class="nv">Please</span>
<span class="nv">specify</span><span class="w"> </span><span class="nv">which</span><span class="w"> </span><span class="nv">branch</span><span class="w"> </span><span class="nv">you</span><span class="w"> </span><span class="nv">want</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">use</span><span class="w"> </span><span class="nv">on</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">command</span><span class="w"> </span><span class="nv">line</span><span class="w"> </span><span class="nv">and</span>
<span class="nv">try</span><span class="w"> </span><span class="nv">again</span><span class="w"> </span><span class="ss">(</span><span class="nv">e</span>.<span class="nv">g</span>.<span class="w"> </span><span class="s1">'git pull &lt;repository&gt; &lt;refspec&gt;'</span><span class="ss">)</span>.
<span class="nv">See</span><span class="w"> </span><span class="nv">git</span><span class="o">-</span><span class="nv">pull</span><span class="ss">(</span><span class="mi">1</span><span class="ss">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">details</span>.

<span class="k">If</span><span class="w"> </span><span class="nv">you</span><span class="w"> </span><span class="nv">often</span><span class="w"> </span><span class="nv">merge</span><span class="w"> </span><span class="nv">with</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">same</span><span class="w"> </span><span class="nv">branch</span>,<span class="w"> </span><span class="nv">you</span><span class="w"> </span><span class="nv">may</span><span class="w"> </span><span class="nv">want</span><span class="w"> </span><span class="nv">to</span>
<span class="nv">use</span><span class="w"> </span><span class="nv">something</span><span class="w"> </span><span class="nv">like</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">following</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">your</span><span class="w"> </span><span class="nv">configuration</span><span class="w"> </span><span class="nv">file</span>:

<span class="w">    </span>[<span class="nv">branch</span><span class="w"> </span><span class="s2">"my_branch"</span>]
<span class="w">    </span><span class="nv">remote</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&lt;</span><span class="nv">nickname</span><span class="o">&gt;</span>
<span class="w">    </span><span class="nv">merge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&lt;</span><span class="nv">remote</span><span class="o">-</span><span class="nv">ref</span><span class="o">&gt;</span>

<span class="w">    </span>[<span class="nv">remote</span><span class="w"> </span><span class="s2">"&lt;nickname&gt;"</span>]
<span class="w">    </span><span class="nv">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&lt;</span><span class="nv">url</span><span class="o">&gt;</span>
<span class="w">    </span><span class="nv">fetch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&lt;</span><span class="nv">refspec</span><span class="o">&gt;</span>

<span class="nv">See</span><span class="w"> </span><span class="nv">git</span><span class="o">-</span><span class="nv">config</span><span class="ss">(</span><span class="mi">1</span><span class="ss">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">details</span>.
</pre></div>

<p>I learned that I can make it work with:</p>
<div class="code"><pre class="code literal-block">git branch --set-upstream my_branch origin/my_branch
</pre></div>

<p>But why do I need to do this for every branch I create? Isn't it obvious that
if I push <code>my_branch</code> into <code>origin/my_branch</code>, then I would want to pull
<code>origin/my_branch</code> into <code>my_branch</code>? How can I make this the default behavior?</p>
<p><br><br></p>
<h2>Answer</h2>
<h4>Git v2.37.1 and above</h4>
<p>If you are using the mentioned version or above you can use this new config
entry to automatically setup remote tracking:</p>
<p><code>git config --global push.autoSetupRemote true</code></p>
<p>After that, when you do <code>git push</code> tracking is setup automatically. No need
for <code>git push -u origin my_branch</code></p>
<hr>
<p>A shortcut, which doesn't depend on remembering the syntax for <code>git branch
--set-upstream</code> 1 is to do:</p>
<div class="code"><pre class="code literal-block">git push -u origin my_branch
</pre></div>

<p>... the first time that you push that branch. Or, to push to the current
branch from a branch of the same name (handy for an alias):</p>
<div class="code"><pre class="code literal-block">git push -u origin HEAD
</pre></div>

<p>You only need to use <code>-u</code> once, and that sets up the association between your
branch and the one at <code>origin</code> in the same way as <code>git branch --set-upstream</code>
does.</p>
<p>Personally, I think it's a good thing to have to set up that association
between your branch and one on the remote explicitly. It's just a shame that
the rules are different for <code>git push</code> and <code>git pull</code>.</p>
<hr>
<p>1 It may sound silly, but I very frequently forget to specify the current
branch, assuming that's the default - it's not, and the results are most
confusing.</p>
<p><em>Update 2012-10-11</em> : Apparently I'm not the only person who found it easy to
get wrong! Thanks to VonC for pointing out that git 1.8.0 introduces the more
obvious <code>git branch --set-upstream-to</code>, which can be used as follows, if
you're on the branch <code>my_branch</code>:</p>
<div class="code"><pre class="code literal-block">git branch --set-upstream-to origin/my_branch
</pre></div>

<p>... or with the short option:</p>
<div class="code"><pre class="code literal-block">git branch -u origin/my_branch
</pre></div>

<p>This change, and its reasoning, is described in the release notes for git
1.8.0, release candidate 1:</p>
<blockquote>
<p>It was tempting to say <code>git branch --set-upstream origin/master</code>, but that
tells Git to arrange the local branch <code>origin/master</code> to integrate with the
currently checked out branch, which is highly unlikely to be what the user
meant. The option is deprecated; use the new <code>--set-upstream-to</code> (with a
short-and-sweet <code>-u</code>) option instead.</p>
</blockquote>
<p><br></p>
<h3>Suggest</h3>
<p>You can make this happen with less typing. First, change the way your push
works:</p>
<div class="code"><pre class="code literal-block">git config --global push.default current
</pre></div>

<p>This will infer the <code>origin my_branch</code> part, thus you can do:</p>
<div class="code"><pre class="code literal-block">git push -u
</pre></div>

<p>Which will both create the remote branch with the same name and track it.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/resolve-git-merge-conflicts-in-favor-of-their-changes-during-a-pull/" class="u-url">Resolve Git merge conflicts in favor of their changes during a pull</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/resolve-git-merge-conflicts-in-favor-of-their-changes-during-a-pull/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-16T23:50:24+08:00" itemprop="datePublished" title="2023-02-16 23:50">2023-02-16 23:50</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>How do I resolve a git merge conflict in favor of pulled changes?</p>
<p>I want to remove all conflicting changes from a working tree without having to
go through all of the conflicts with <code>git mergetool</code>, while keeping all
conflict-free changes. Preferably, I want to do this while pulling, not
afterwards.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>If you're already in conflicted state, and do not want to checkout path one by
one. You may try</p>
<div class="code"><pre class="code literal-block">git merge --abort
git pull -X theirs
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>You can use the recursive "theirs" strategy <em>option</em> :</p>
<div class="code"><pre class="code literal-block">git merge --strategy-option theirs
</pre></div>

<p>From the man:</p>
<div class="code"><pre class="code literal-block"><span class="nv">ours</span>
<span class="w">    </span><span class="nv">This</span><span class="w"> </span><span class="nv">option</span><span class="w"> </span><span class="nv">forces</span><span class="w"> </span><span class="nv">conflicting</span><span class="w"> </span><span class="nv">hunks</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">be</span><span class="w"> </span><span class="nv">auto</span><span class="o">-</span><span class="nv">resolved</span><span class="w"> </span><span class="nv">cleanly</span><span class="w"> </span><span class="nv">by</span><span class="w"> </span>
<span class="w">    </span><span class="nv">favoring</span><span class="w"> </span><span class="nv">our</span><span class="w"> </span><span class="nv">version</span>.<span class="w"> </span><span class="nv">Changes</span><span class="w"> </span><span class="nv">from</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">other</span><span class="w"> </span><span class="nv">tree</span><span class="w"> </span><span class="nv">that</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="nv">not</span><span class="w"> </span>
<span class="w">    </span><span class="nv">conflict</span><span class="w"> </span><span class="nv">with</span><span class="w"> </span><span class="nv">our</span><span class="w"> </span><span class="nv">side</span><span class="w"> </span><span class="nv">are</span><span class="w"> </span><span class="nv">reflected</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">merge</span><span class="w"> </span><span class="nb">result</span>.

<span class="w">    </span><span class="nv">This</span><span class="w"> </span><span class="nv">should</span><span class="w"> </span><span class="nv">not</span><span class="w"> </span><span class="nv">be</span><span class="w"> </span><span class="nv">confused</span><span class="w"> </span><span class="nv">with</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">ours</span><span class="w"> </span><span class="nv">merge</span><span class="w"> </span><span class="nv">strategy</span>,<span class="w"> </span><span class="nv">which</span><span class="w"> </span><span class="nv">does</span><span class="w"> </span>
<span class="w">    </span><span class="nv">not</span><span class="w"> </span><span class="nv">even</span><span class="w"> </span><span class="nv">look</span><span class="w"> </span><span class="nv">at</span><span class="w"> </span><span class="nv">what</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">other</span><span class="w"> </span><span class="nv">tree</span><span class="w"> </span><span class="nv">contains</span><span class="w"> </span><span class="nv">at</span><span class="w"> </span><span class="nv">all</span>.<span class="w"> </span><span class="nv">It</span><span class="w"> </span><span class="nv">discards</span><span class="w"> </span>
<span class="w">    </span><span class="nv">everything</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">other</span><span class="w"> </span><span class="nv">tree</span><span class="w"> </span><span class="nv">did</span>,<span class="w"> </span><span class="nv">declaring</span><span class="w"> </span><span class="nv">our</span><span class="w"> </span><span class="nv">history</span><span class="w"> </span><span class="nv">contains</span><span class="w"> </span><span class="nv">all</span><span class="w"> </span><span class="nv">that</span>
<span class="w">    </span><span class="nv">happened</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">it</span>.

<span class="nv">theirs</span>
<span class="w">    </span><span class="nv">This</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">opposite</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">ours</span>.
</pre></div>

<p>Note: as the man page says, the "ours" merge <strong>strategy-option</strong> is very
different from the "ours" merge <strong>strategy</strong>.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/addtransient-addscoped-and-addsingleton-services-differences/" class="u-url">AddTransient, AddScoped and AddSingleton Services Differences</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/addtransient-addscoped-and-addsingleton-services-differences/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-16T23:49:41+08:00" itemprop="datePublished" title="2023-02-16 23:49">2023-02-16 23:49</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I want to implement dependency injection (DI) in ASP.NET Core. So after adding
this code to <strong><code>ConfigureServices</code></strong> method, both ways work.</p>
<p>What is the difference between the <code>services.AddTransient</code> and
<code>service.AddScoped</code> methods in ASP.NET Core?</p>
<div class="code"><pre class="code literal-block">public void ConfigureServices(IServiceCollection services)
{
    // Add framework services.

    // Add application services.
    services.AddTransient&lt;IEmailSender, AuthMessageSender&gt;();
    services.AddScoped&lt;IEmailSender, AuthMessageSender&gt;();
}
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<p><strong>TL;DR</strong></p>
<blockquote>
<p>Transient objects are always different; a new instance is provided to every
controller and every service.</p>
<p>Scoped objects are the same within a request, but different across different
requests.</p>
<p>Singleton objects are the same for every object and every request.</p>
</blockquote>
<p>For more clarification, this example from .NET documentation shows the
difference:</p>
<p>To demonstrate the difference between these lifetime and registration options,
consider a simple interface that represents one or more tasks as an operation
with a unique identifier, <code>OperationId</code>. Depending on how we configure the
lifetime for this service, the container will provide either the same or
different instances of the service to the requesting class. To make it clear
which lifetime is being requested, we will create one type per lifetime
option:</p>
<div class="code"><pre class="code literal-block">using System;

namespace DependencyInjectionSample.Interfaces
{
    public interface IOperation
    {
        Guid OperationId { get; }
    }

    public interface IOperationTransient : IOperation
    {
    }

    public interface IOperationScoped : IOperation
    {
    }

    public interface IOperationSingleton : IOperation
    {
    }

    public interface IOperationSingletonInstance : IOperation
    {
    }
}
</pre></div>

<p>We implement these interfaces using a single class, <code>Operation</code>, that accepts
a GUID in its constructor, or uses a new GUID if none is provided:</p>
<div class="code"><pre class="code literal-block">using System;
using DependencyInjectionSample.Interfaces;
namespace DependencyInjectionSample.Classes
{
    public class Operation : IOperationTransient, IOperationScoped, IOperationSingleton, IOperationSingletonInstance
    {
        Guid _guid;
        public Operation() : this(Guid.NewGuid())
        {

        }

        public Operation(Guid guid)
        {
            _guid = guid;
        }

        public Guid OperationId =&gt; _guid;
    }
}
</pre></div>

<p>Next, in <code>ConfigureServices</code>, each type is added to the container according to
its named lifetime:</p>
<div class="code"><pre class="code literal-block">services.AddTransient&lt;IOperationTransient, Operation&gt;();
services.AddScoped&lt;IOperationScoped, Operation&gt;();
services.AddSingleton&lt;IOperationSingleton, Operation&gt;();
services.AddSingleton&lt;IOperationSingletonInstance&gt;(new Operation(Guid.Empty));
services.AddTransient&lt;OperationService, OperationService&gt;();
</pre></div>

<p>Note that the <code>IOperationSingletonInstance</code> service is using a specific
instance with a known ID of <code>Guid.Empty</code>, so it will be clear when this type
is in use. We have also registered an <code>OperationService</code> that depends on each
of the other <code>Operation</code> types, so that it will be clear within a request
whether this service is getting the same instance as the controller, or a new
one, for each operation type. All this service does is expose its dependencies
as properties, so they can be displayed in the view.</p>
<div class="code"><pre class="code literal-block">using DependencyInjectionSample.Interfaces;

namespace DependencyInjectionSample.Services
{
    public class OperationService
    {
        public IOperationTransient TransientOperation { get; }
        public IOperationScoped ScopedOperation { get; }
        public IOperationSingleton SingletonOperation { get; }
        public IOperationSingletonInstance SingletonInstanceOperation { get; }

        public OperationService(IOperationTransient transientOperation,
            IOperationScoped scopedOperation,
            IOperationSingleton singletonOperation,
            IOperationSingletonInstance instanceOperation)
        {
            TransientOperation = transientOperation;
            ScopedOperation = scopedOperation;
            SingletonOperation = singletonOperation;
            SingletonInstanceOperation = instanceOperation;
        }
    }
}
</pre></div>

<p>To demonstrate the object lifetimes within and between separate individual
requests to the application, the sample includes an <code>OperationsController</code>
that requests each kind of <code>IOperation</code> type as well as an <code>OperationService</code>.
The <code>Index</code> action then displays all of the controller’s and service’s
<code>OperationId</code> values.</p>
<div class="code"><pre class="code literal-block"><span class="nv">using</span><span class="w"> </span><span class="nv">DependencyInjectionSample</span>.<span class="nv">Interfaces</span><span class="c1">;</span>
<span class="nv">using</span><span class="w"> </span><span class="nv">DependencyInjectionSample</span>.<span class="nv">Services</span><span class="c1">;</span>
<span class="nv">using</span><span class="w"> </span><span class="nv">Microsoft</span>.<span class="nv">AspNetCore</span>.<span class="nv">Mvc</span><span class="c1">;</span>

<span class="nv">namespace</span><span class="w"> </span><span class="nv">DependencyInjectionSample</span>.<span class="nv">Controllers</span>
{
<span class="w">    </span><span class="nv">public</span><span class="w"> </span><span class="nv">class</span><span class="w"> </span><span class="nv">OperationsController</span><span class="w"> </span>:<span class="w"> </span><span class="nv">Controller</span>
<span class="w">    </span>{
<span class="w">        </span><span class="nv">private</span><span class="w"> </span><span class="nv">readonly</span><span class="w"> </span><span class="nv">OperationService</span><span class="w"> </span><span class="nv">_operationService</span><span class="c1">;</span>
<span class="w">        </span><span class="nv">private</span><span class="w"> </span><span class="nv">readonly</span><span class="w"> </span><span class="nv">IOperationTransient</span><span class="w"> </span><span class="nv">_transientOperation</span><span class="c1">;</span>
<span class="w">        </span><span class="nv">private</span><span class="w"> </span><span class="nv">readonly</span><span class="w"> </span><span class="nv">IOperationScoped</span><span class="w"> </span><span class="nv">_scopedOperation</span><span class="c1">;</span>
<span class="w">        </span><span class="nv">private</span><span class="w"> </span><span class="nv">readonly</span><span class="w"> </span><span class="nv">IOperationSingleton</span><span class="w"> </span><span class="nv">_singletonOperation</span><span class="c1">;</span>
<span class="w">        </span><span class="nv">private</span><span class="w"> </span><span class="nv">readonly</span><span class="w"> </span><span class="nv">IOperationSingletonInstance</span><span class="w"> </span><span class="nv">_singletonInstanceOperation</span><span class="c1">;</span>

<span class="w">        </span><span class="nv">public</span><span class="w"> </span><span class="nv">OperationsController</span><span class="ss">(</span><span class="nv">OperationService</span><span class="w"> </span><span class="nv">operationService</span>,
<span class="w">            </span><span class="nv">IOperationTransient</span><span class="w"> </span><span class="nv">transientOperation</span>,
<span class="w">            </span><span class="nv">IOperationScoped</span><span class="w"> </span><span class="nv">scopedOperation</span>,
<span class="w">            </span><span class="nv">IOperationSingleton</span><span class="w"> </span><span class="nv">singletonOperation</span>,
<span class="w">            </span><span class="nv">IOperationSingletonInstance</span><span class="w"> </span><span class="nv">singletonInstanceOperation</span><span class="ss">)</span>
<span class="w">        </span>{
<span class="w">            </span><span class="nv">_operationService</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">operationService</span><span class="c1">;</span>
<span class="w">            </span><span class="nv">_transientOperation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">transientOperation</span><span class="c1">;</span>
<span class="w">            </span><span class="nv">_scopedOperation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">scopedOperation</span><span class="c1">;</span>
<span class="w">            </span><span class="nv">_singletonOperation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">singletonOperation</span><span class="c1">;</span>
<span class="w">            </span><span class="nv">_singletonInstanceOperation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">singletonInstanceOperation</span><span class="c1">;</span>
<span class="w">        </span>}

<span class="w">        </span><span class="nv">public</span><span class="w"> </span><span class="nv">IActionResult</span><span class="w"> </span><span class="nv">Index</span><span class="ss">()</span>
<span class="w">        </span>{
<span class="w">            </span><span class="o">//</span><span class="w"> </span><span class="nv">ViewBag</span><span class="w"> </span><span class="nv">contains</span><span class="w"> </span><span class="nv">controller</span><span class="o">-</span><span class="nv">requested</span><span class="w"> </span><span class="nv">services</span>
<span class="w">            </span><span class="nv">ViewBag</span>.<span class="nv">Transient</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">_transientOperation</span><span class="c1">;</span>
<span class="w">            </span><span class="nv">ViewBag</span>.<span class="nv">Scoped</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">_scopedOperation</span><span class="c1">;</span>
<span class="w">            </span><span class="nv">ViewBag</span>.<span class="nv">Singleton</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">_singletonOperation</span><span class="c1">;</span>
<span class="w">            </span><span class="nv">ViewBag</span>.<span class="nv">SingletonInstance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">_singletonInstanceOperation</span><span class="c1">;</span>

<span class="w">            </span><span class="o">//</span><span class="w"> </span><span class="nv">Operation</span><span class="w"> </span><span class="nv">service</span><span class="w"> </span><span class="nv">has</span><span class="w"> </span><span class="nv">its</span><span class="w"> </span><span class="nv">own</span><span class="w"> </span><span class="nv">requested</span><span class="w"> </span><span class="nv">services</span>
<span class="w">            </span><span class="nv">ViewBag</span>.<span class="nv">Service</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">_operationService</span><span class="c1">;</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="nv">View</span><span class="ss">()</span><span class="c1">;</span>
<span class="w">        </span>}
<span class="w">    </span>}
}
</pre></div>

<p>Now two separate requests are made to this controller action:</p>
<p><img alt="First Request" src="images/ilUB6.png"></p>
<p><img alt="Second Request" src="images/X2QCd.png"></p>
<p>Observe which of the <code>OperationId</code> values varies within a request, and between
requests.</p>
<ul>
<li>
<p>Transient objects are always different; a new instance is provided to every controller and every service.</p>
</li>
<li>
<p>Scoped objects are the same within a request, but different across different requests</p>
</li>
<li>
<p>Singleton objects are the same for every object and every request (regardless of whether an instance is provided in <code>ConfigureServices</code>)</p>
</li>
</ul>
<p><br></p>
<h3>Suggest</h3>
<p>In .NET's dependency injection there are three major lifetimes:</p>
<p><strong>Singleton</strong> which creates a single instance throughout the application. It
creates the instance for the first time and reuses the same object in the all
calls.</p>
<p><strong>Scoped</strong> lifetime services are created once per request within the scope. It
is equivalent to a singleton in the current scope. For example, in MVC it
creates one instance for each HTTP request, but it uses the same instance in
the other calls within the same web request.</p>
<p><strong>Transient</strong> lifetime services are created each time they are requested. This
lifetime works best for lightweight, stateless services.</p>
<p>Here you can find and examples to see the difference:</p>
<p><em>ASP.NET 5 MVC6 Dependency Injection in 6 Steps</em> (web archive link due to dead
link)</p>
<p><em>Your Dependency Injection ready ASP.NET : ASP.NET 5</em></p>
<p>And this is the link to the official documentation:</p>
<p><em>Dependency injection in ASP.NET Core</em></p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-174.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-172.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
