<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 612) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-612.html">
<link rel="prev" href="index-613.html" type="text/html">
<link rel="next" href="index-611.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-can-i-iterate-over-files-in-a-given-directory/" class="u-url">How can I iterate over files in a given directory?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-can-i-iterate-over-files-in-a-given-directory/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T11:19:47+08:00" itemprop="datePublished" title="2023-02-17 11:19">2023-02-17 11:19</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I need to iterate through all <code>.asm</code> files inside a given directory and do
some actions on them.</p>
<p>How can this be done in a efficient way?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Python 3.6 version of the above answer, using <code>os</code> - assuming that you have
the directory path as a <code>str</code> object in a variable called <code>directory_in_str</code>:</p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="nn">os</span>

<span class="n">directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">fsencode</span><span class="p">(</span><span class="n">directory_in_str</span><span class="p">)</span>

<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">directory</span><span class="p">):</span>
     <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">fsdecode</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
     <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">".asm"</span><span class="p">)</span> <span class="ow">or</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">".py"</span><span class="p">):</span> 
         <span class="c1"># print(os.path.join(directory, filename))</span>
         <span class="k">continue</span>
     <span class="k">else</span><span class="p">:</span>
         <span class="k">continue</span>
</pre></div>

<p>Or recursively, using <code>pathlib</code>:</p>
<div class="code"><pre class="code literal-block"><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="n">pathlist</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">directory_in_str</span><span class="p">)</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">'**/*.asm'</span><span class="p">)</span>
<span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">pathlist</span><span class="p">:</span>
     <span class="c1"># because path is object not string</span>
     <span class="n">path_in_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
     <span class="c1"># print(path_in_str)</span>
</pre></div>

<ul>
<li>
<p>Use <code>rglob</code> to replace <code>glob('**/*.asm')</code> with <code>rglob('*.asm')</code></p>
<ul>
<li><em>This is like calling<code>Path.glob()</code> with <code>'**/'</code> added in front of the given relative pattern:</em></li>
</ul>
<p>from pathlib import Path</p>
<p>pathlist = Path(directory_in_str).rglob('*.asm')
for path in pathlist:
     # because path is object not string
     path_in_str = str(path)
     # print(path_in_str)</p>
</li>
</ul>
<hr>
<p>Original answer:</p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="nn">os</span>

<span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s2">"/path/to/dir/"</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">".asm"</span><span class="p">)</span> <span class="ow">or</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">".py"</span><span class="p">):</span> 
         <span class="c1"># print(os.path.join(directory, filename))</span>
        <span class="k">continue</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">continue</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>This will iterate over all descendant files, not just the immediate children
of the directory:</p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="nn">os</span>

<span class="k">for</span> <span class="n">subdir</span><span class="p">,</span> <span class="n">dirs</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">rootdir</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
        <span class="c1">#print os.path.join(subdir, file)</span>
        <span class="n">filepath</span> <span class="o">=</span> <span class="n">subdir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="n">file</span>

        <span class="k">if</span> <span class="n">filepath</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">".asm"</span><span class="p">):</span>
            <span class="nb">print</span> <span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-initialize-an-array-s-length-in-javascript/" class="u-url">How to initialize an array's length in JavaScript?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-initialize-an-array-s-length-in-javascript/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T11:19:17+08:00" itemprop="datePublished" title="2023-02-17 11:19">2023-02-17 11:19</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Most of the tutorials that I've read on arrays in JavaScript (including
w3schools and devguru) suggest that you can initialize an array with a certain
length by passing an integer to the Array constructor using the <code>var test =
new Array(4);</code> syntax.</p>
<p>After using this syntax liberally in my js files, I ran one of the files
through jsLint, and it freaked out:</p>
<blockquote>
<p>Error: Problem at line 1 character 22: Expected ')' and instead saw '4'.<br>
 var test = new Array(4);<br>
 Problem at line 1 character 23: Expected ';' and instead saw ')'.<br>
 var test = new Array(4);<br>
 Problem at line 1 character 23: Expected an identifier and instead saw ')'.</p>
</blockquote>
<p>After reading through jsLint's explanation of its behavior, it looks like
jsLint doesn't really like the <code>new Array()</code> syntax, and instead prefers <code>[]</code>
when declaring arrays.</p>
<p>So I have a couple questions:</p>
<p>First, why? Am I running any risk by using the <code>new Array()</code> syntax instead?
Are there browser incompatibilities that I should be aware of?</p>
<p>And second, if I switch to the square bracket syntax, is there any way to
declare an array and set its length all on one line, or do I have to do
something like this:</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
<span class="n">test</span><span class="o">.</span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span>
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<ol>
<li>
<p>Why do you want to initialize the length? Theoretically there is no need for this. It can even result in confusing behavior, because all tests that use the <code>length</code> to find out whether an array is empty or not will report that the array is not empty.<br>
Some tests show that setting the initial length of large arrays <em>can</em> be more
efficient if the array is filled afterwards, but the performance gain (if any)
seem to differ from browser to browser.</p>
</li>
<li>
<p>jsLint does not like <code>new Array()</code> because the constructer is ambiguous.</p>
<div class="code"><pre class="code literal-block">new Array(4);
</pre></div>

</li>
</ol>
<p>creates an empty array <strong>of length</strong> 4. But</p>
<div class="code"><pre class="code literal-block">    new Array('4');
</pre></div>

<p>creates an array <strong>containing the value</strong> <code>'4'</code>.</p>
<p>Regarding your comment: In JS you don't need to initialize the length of the
array. It grows dynamically. You can just store the length in some variable,
e.g.</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
<span class="k">var</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">defined</span><span class="w"> </span><span class="n">length</span>

<span class="k">for</span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">length</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">data</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">createSomeObject</span><span class="p">());</span>
<span class="p">}</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>With ES2015 <em><code>.fill()</code></em> you can now simply do:</p>
<div class="code"><pre class="code literal-block"><span class="o">//</span><span class="w"> </span><span class="n n-Quoted">`n`</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">initialize</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="k">array</span>
<span class="o">//</span><span class="w"> </span><span class="n n-Quoted">`0`</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">what</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">array</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">filled</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="p">(</span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="k">any</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="k">value</span><span class="p">)</span>
<span class="k">Array</span><span class="p">(</span><span class="n">n</span><span class="p">).</span><span class="n">fill</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

<p>Which is a lot more concise than <code>Array.apply(0, new Array(n)).map(i =&gt;
value)</code></p>
<p>It is possible to drop the <code>0</code> in <code>.fill()</code> and run without arguments, which
will fill the array with <code>undefined</code>. ( <em>However, this will fail in
Typescript</em> )</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-can-i-measure-the-actual-memory-usage-of-an-application-or-process/" class="u-url">How can I measure the actual memory usage of an application or process?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-can-i-measure-the-actual-memory-usage-of-an-application-or-process/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T11:18:45+08:00" itemprop="datePublished" title="2023-02-17 11:18">2023-02-17 11:18</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>How do you measure the memory usage of an application or process in Linux?</p>
<p>From the blog article of <em>Understanding memory usage on Linux</em> , <code>ps</code> is not
an accurate tool to use for this intent.</p>
<blockquote>
<p><strong>Why<code>ps</code> is "wrong"</strong></p>
<p>Depending on how you look at it, <code>ps</code> is not reporting the real memory usage
of processes. What it is really doing is showing how much real memory each
process would take up <strong>if it were the only process running</strong>. Of course, a
typical Linux machine has several dozen processes running at any given time,
which means that the VSZ and RSS numbers reported by <code>ps</code> are almost
definitely <em>wrong</em>.</p>
</blockquote>
<p>(Note: This question is covered here in great detail.)</p>
<p><br><br></p>
<h2>Answer</h2>
<p>With <code>ps</code> or similar tools you will only get the amount of memory pages
allocated by that process. This number is correct, but:</p>
<ul>
<li>
<p>does not reflect the actual amount of memory used by the application, only the amount of memory reserved for it</p>
</li>
<li>
<p>can be misleading if pages are shared, for example by several threads or by using dynamically linked libraries</p>
</li>
</ul>
<p>If you really want to know what amount of memory your application actually
uses, you need to run it within a profiler. For example, Valgrind can give you
insights about the amount of memory used, and, more importantly, about
possible memory leaks in your program. The heap profiler tool of Valgrind is
called 'massif':</p>
<blockquote>
<p>Massif is a heap profiler. It performs detailed heap profiling by taking
regular snapshots of a program's heap. It produces a graph showing heap
usage over time, including information about which parts of the program are
responsible for the most memory allocations. The graph is supplemented by a
text or HTML file that includes more information for determining where the
most memory is being allocated. Massif runs programs about 20x slower than
normal.</p>
</blockquote>
<p>As explained in the Valgrind documentation, you need to run the program
through Valgrind:</p>
<div class="code"><pre class="code literal-block"><span class="n">valgrind</span><span class="w"> </span><span class="o">--</span><span class="k">tool</span><span class="o">=</span><span class="n">massif</span><span class="w"> </span><span class="o">&lt;</span><span class="n">executable</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&lt;</span><span class="n">arguments</span><span class="o">&gt;</span>
</pre></div>

<p>Massif writes a dump of memory usage snapshots (e.g. <code>massif.out.12345</code>).
These provide, (1) a timeline of memory usage, (2) for each snapshot, a record
of where in your program memory was allocated. A great graphical tool for
analyzing these files is massif-visualizer. But I found <code>ms_print</code>, a simple
text-based tool shipped with Valgrind, to be of great help already.</p>
<p>To find memory leaks, use the (default) <code>memcheck</code> tool of valgrind.</p>
<p><br></p>
<h3>Suggest</h3>
<p>Try the pmap command:</p>
<div class="code"><pre class="code literal-block">sudo pmap -x &lt;process pid&gt;
</pre></div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-613.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-611.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
