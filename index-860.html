<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 860) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-860.html">
<link rel="prev" href="index-861.html" type="text/html">
<link rel="next" href="index-859.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/utf-8-he-unicode-you-shi-yao-qu-bie/" class="u-url">UTF-8 和 Unicode 有什么区别？</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/utf-8-he-unicode-you-shi-yao-qu-bie/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T18:06:54+08:00" itemprop="datePublished" title="2023-02-17 18:06">2023-02-17 18:06</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>根据维基百科 UTF-8页面，我听到了人们的不同意见。</p>
<p>它们是同一回事，不是吗？有人可以澄清吗？</p>
<p><br><br></p>
<h2>解答</h2>
<p>扩展其他人给出的答案：</p>
<p>我们有很多语言，有很多计算机应该理想地显示的字符。Unicode 为每个字符分配一个唯一的数字或代码点。</p>
<p>计算机处理字节这样的数字...在这里跳过一些历史并忽略内存寻址问题，8 位计算机会将 8 位字节视为硬件上容易表示的最大数字单位，16
位计算机将扩展那到两个字节，等等。</p>
<p>ASCII 等旧字符编码来自（前）8 位时代，并试图将当时计算中的主导语言（即英语）塞入 0 到 127（7 位）范围内的数字。字母表中有 26
个字母，包括大写和非大写形式、数字和标点符号，效果非常好。对于其他非英语语言，ASCII 扩展了第 8 位，但此扩展提供的额外 128
个数字/代码点将根据显示的语言映射到不同的字符。ISO-8859 标准是这种映射的最常见形式；ISO-8859-1 和 ISO-8859-15（也称为
ISO-Latin-1、latin1，是的，8859 ISO 标准也有两个不同的版本）。</p>
<p>但是，当您想要表示来自多种语言的字符时，这还不够，因此将所有可用字符塞入一个字节是行不通的。</p>
<p>本质上有两种不同类型的编码：一种通过添加更多位来扩展值范围。这些编码的示例是 UCS2（2 个字节 = 16 位）和 UCS4（4 个字节 = 32
位）。它们本质上与 ASCII 和 ISO-8859 标准存在相同的问题，因为它们的值范围仍然有限，即使限制要高得多。</p>
<p>另一种编码类型使用每个字符的可变字节数，最常见的编码是 UTF 编码。所有 UTF 编码的工作方式大致相同：您选择一个单位大小，UTF-8 为 8
位，UTF-16 为 16 位，UTF-32 为 32
位。然后，该标准将其中一些位定义为标志：如果设置了它们，则一系列单元中的下一个单元将被视为同一字符的一部分。如果未设置，则此单位完全代表一个字符。因此，最常见的（英语）字符在
UTF-8 中仅占用一个字节（UTF-16 中为两个字节，UTF-32 中为 4 个字节），但其他语言字符可占用六个字节或更多。</p>
<p>多字节编码（经过上面的解释应该说是multi-
unit）的优点是比较节省空间，缺点是查找子串、比较等操作都必须将字符解码为unicode码在可以执行此类操作之前的点（尽管有一些快捷方式）。</p>
<p>UCS 标准和 UTF 标准都按照 Unicode
中的定义对代码点进行编码。理论上，这些编码可用于编码任何数字（在编码支持的范围内）——但当然这些编码是用来编码 Unicode
代码点的。那就是你们之间的关系。</p>
<p>Windows 将所谓的“Unicode”字符串作为 UTF-16 字符串处理，而如今大多数 UNIX 默认为 UTF-8。HTTP 等通信协议往往最适合
UTF-8，因为 UTF-8 中的单位大小与 ASCII 中的单位大小相同，而且大多数此类协议都是在 ASCII
时代设计的。另一方面，UTF-16在表示所有现存语言时提供最佳的 <em>平均空间/处理性能。</em></p>
<p>Unicode 标准定义的代码点少于 32 位可以表示的代码点。因此，出于所有实际目的，UTF-32 和 UCS4 成为相同的编码，因为您不太可能必须处理
UTF-32 中的多单元字符。</p>
<p>希望填写一些细节。</p>
<p><br></p>
<h3>更多建议</h3>
<p>让我用一个例子来说明这个话题：</p>
<div class="code"><pre class="code literal-block">A Chinese character:      汉
its Unicode value:        U+6C49
convert 6C49 to binary:   01101100 01001001
</pre></div>

<p>到目前为止没有什么神奇的，它非常简单。现在，假设我们决定将这个角色存储在我们的硬盘上。为此，我们需要以二进制格式存储字符。我们可以简单地将其存储为“01101100
01001001”。完毕！</p>
<p>但是等一下，‘01101100
01001001’是一个字符还是两个字符？你知道这是一个字符，因为我告诉过你，但是当一台计算机读取它时，它不知道。所以我们需要某种编码来告诉计算机将其视为一个。</p>
<p>这是 UTF-8 规则的用武之地：https ://www.fileformat.info/info/unicode/utf8.htm</p>
<div class="code"><pre class="code literal-block">Binary format of bytes in sequence

1st Byte    2nd Byte    3rd Byte    4th Byte    Number of Free Bits   Maximum Expressible Unicode Value
0xxxxxxx                                                7             007F hex (127)
110xxxxx    10xxxxxx                                (5+6)=11          07FF hex (2047)
1110xxxx    10xxxxxx    10xxxxxx                  (4+6+6)=16          FFFF hex (65535)
11110xxx    10xxxxxx    10xxxxxx    10xxxxxx    (3+6+6+6)=21          10FFFF hex (1,114,111)
</pre></div>

<p>根据上表，如果我们想使用 UTF-8 格式存储这个字符，我们需要为我们的字符添加一些“标头”前缀。我们的汉字是 16
位长（二进制值自己算），所以我们将使用第 3 行的格式，因为它提供了足够的空间：</p>
<div class="code"><pre class="code literal-block">Header  Place holder    Fill in our Binary   Result         
1110    xxxx            0110                 11100110
10      xxxxxx          110001               10110001
10      xxxxxx          001001               10001001
</pre></div>

<p>在一行中写出结果：</p>
<div class="code"><pre class="code literal-block"><span class="mf">11100110</span><span class="w"> </span><span class="mf">10110001</span><span class="w"> </span><span class="mf">10001001</span>
</pre></div>

<p>这是汉字的UTF-8二进制值！自己看看： https:
//www.fileformat.info/info/unicode/char/6c49/index.htm</p>
<h3>概括</h3>
<div class="code"><pre class="code literal-block">A Chinese character:      汉
its Unicode value:        U+6C49
convert 6C49 to binary:   01101100 01001001
encode 6C49 as UTF-8:     11100110 10110001 10001001
</pre></div>

<p>PS 如果您想用 Python 学习本主题，请单击此处。</p>
<p><br><br><a href="posts/what-is-the-difference-between-utf-8-and-unicode/">查看原文</a></p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/bao-han-zuo-zhe-he-ri-qi-de-git-log-de-zui-duan-shu-chu/" class="u-url">包含作者和日期的 git log 的最短输出</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/bao-han-zuo-zhe-he-ri-qi-de-git-log-de-zui-duan-shu-chu/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T18:06:25+08:00" itemprop="datePublished" title="2023-02-17 18:06">2023-02-17 18:06</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>如何显示带有（至少）以下信息的 git log 输出：</p>
<div class="code"><pre class="code literal-block">* author
* commit date
* change
</pre></div>

<p>我希望每个日志条目将其压缩为一行。最短的格式是什么？</p>
<p>（试过<code>--format=oneline</code>但不显示日期）</p>
<p><br><br></p>
<h2>解答</h2>
<div class="code"><pre class="code literal-block">git log --pretty=format:"%h%x09%an%x09%ad%x09%s"
</pre></div>

<p>完成工作。这输出：</p>
<div class="code"><pre class="code literal-block"><span class="w">  </span><span class="nv">fbc3503</span><span class="w"> </span><span class="nv">mads</span><span class="w">    </span><span class="nv">Thu</span><span class="w"> </span><span class="nv">Dec</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">07</span>:<span class="mi">43</span>:<span class="mi">27</span><span class="w"> </span><span class="mi">2008</span><span class="w"> </span><span class="o">+</span><span class="mi">0000</span><span class="w">   </span><span class="k">show</span><span class="w"> </span><span class="nv">mobile</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nv">phone</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">null</span>...<span class="w">   </span>
<span class="w">  </span><span class="nv">ec36490</span><span class="w"> </span><span class="nv">jesper</span><span class="w">  </span><span class="nv">Wed</span><span class="w"> </span><span class="nv">Nov</span><span class="w"> </span><span class="mi">26</span><span class="w"> </span><span class="mi">05</span>:<span class="mi">41</span>:<span class="mi">37</span><span class="w"> </span><span class="mi">2008</span><span class="w"> </span><span class="o">+</span><span class="mi">0000</span><span class="w">  </span><span class="nv">Cleanup</span><span class="w"> </span><span class="nv">after</span><span class="w"> </span>[<span class="mi">942</span>]:<span class="w"> </span><span class="nv">Using</span><span class="w"> </span><span class="nv">timezon</span>
<span class="w">  </span><span class="nv">ae62afd</span><span class="w"> </span><span class="nv">tobias</span><span class="w">  </span><span class="nv">Tue</span><span class="w"> </span><span class="nv">Nov</span><span class="w"> </span><span class="mi">25</span><span class="w"> </span><span class="mi">21</span>:<span class="mi">42</span>:<span class="mi">55</span><span class="w"> </span><span class="mi">2008</span><span class="w"> </span><span class="o">+</span><span class="mi">0000</span><span class="w">  </span><span class="nv">Fixed</span><span class="w"> </span><span class="sc">#67</span><span class="w"> </span><span class="nv">by</span><span class="w"> </span><span class="nv">adding</span><span class="w"> </span><span class="nv">time</span><span class="w"> </span><span class="nv">zone</span><span class="w"> </span><span class="nv">supp</span>
<span class="w">  </span><span class="mi">164</span><span class="nv">be7e</span><span class="w"> </span><span class="nv">mads</span><span class="w">    </span><span class="nv">Tue</span><span class="w"> </span><span class="nv">Nov</span><span class="w"> </span><span class="mi">25</span><span class="w"> </span><span class="mi">19</span>:<span class="mi">56</span>:<span class="mi">43</span><span class="w"> </span><span class="mi">2008</span><span class="w"> </span><span class="o">+</span><span class="mi">0000</span><span class="w">  </span><span class="nv">fixed</span><span class="w"> </span><span class="nv">tests</span>,<span class="w"> </span><span class="nv">and</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="err">'unending appoi</span>
<span class="err">  93f1526 jesper  Tue Nov 25 09:45:56 2008 +0000  adding time.ZONE.now as time zone </span>
<span class="err">  2f0f8c1 tobias  Tue Nov 25 03:07:02 2008 +0000  Timezone configured in environment</span>
<span class="err">  a33c1dc jesper  Tue Nov 25 01:26:18 2008 +0000  updated to most recent will_pagina</span>
</pre></div>

<p>受 stackoverflow 问题的启发：“git log output like svn ls -v”，我发现我可以添加我需要的确切参数。</p>
<p>要缩短日期（不显示时间）使用<code>--date=short</code></p>
<p>如果您好奇不同的选项是什么：<br><code>%h</code>= 缩写提交散列<br><code>%x09</code>= 制表符（代码 9 的字符）<br><code>%an</code>= 作者姓名<br><code>%ad</code>= 作者日期（格式尊重 --date= 选项）<br><code>%s</code>= 主题<br>
来自kernel.org/pub/software/scm /git/docs/git-log.html（PRETTY FORMATS 部分）来自
Vivek 的评论。</p>
<p><br></p>
<h3>更多建议</h3>
<p>我使用这两个 .gitconfig 设置：</p>
<div class="code"><pre class="code literal-block"><span class="k">[log]</span>
<span class="w">  </span><span class="na">date</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">relative</span>
<span class="k">[format]</span>
<span class="w">  </span><span class="na">pretty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">format:%h %Cblue%ad%Creset %ae %Cgreen%s%Creset</span>
</pre></div>

<p>%ad 是作者日期，可以被<code>--date</code>.gitconfig 中 [log]
节中指定的选项覆盖。我喜欢相对日期，因为它可以让我立即感觉到什么时候提交的。输出如下所示：</p>
<div class="code"><pre class="code literal-block"><span class="mf">6</span><span class="n">c3e1a2</span><span class="w"> </span><span class="mf">2</span><span class="w"> </span><span class="n">hours</span><span class="w"> </span><span class="n">ago</span><span class="w"> </span><span class="n">you</span><span class="err">@</span><span class="n">me</span><span class="mf">.</span><span class="n">com</span><span class="w"> </span><span class="n">lsof</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">dependency</span><span class="w"> </span><span class="n">now</span><span class="mf">.</span>
<span class="mf">0754</span><span class="n">f18</span><span class="w"> </span><span class="mf">11</span><span class="w"> </span><span class="n">hours</span><span class="w"> </span><span class="n">ago</span><span class="w"> </span><span class="n">you</span><span class="err">@</span><span class="n">me</span><span class="mf">.</span><span class="n">com</span><span class="w"> </span><span class="n">Properly</span><span class="w"> </span><span class="n">unmount</span><span class="p">,</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">detaching</span><span class="w"> </span><span class="n">works</span><span class="mf">.</span>
<span class="mf">336</span><span class="n">a3ac</span><span class="w"> </span><span class="mf">13</span><span class="w"> </span><span class="n">hours</span><span class="w"> </span><span class="n">ago</span><span class="w"> </span><span class="n">you</span><span class="err">@</span><span class="n">me</span><span class="mf">.</span><span class="n">com</span><span class="w"> </span><span class="n">Show</span><span class="w"> </span><span class="n">ami</span><span class="w"> </span><span class="n">registration</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="kr">if</span><span class="w"> </span><span class="n">auto</span><span class="w"> </span><span class="n">register</span><span class="w"> </span><span class="n">fails</span>
<span class="n">be2ad45</span><span class="w"> </span><span class="mf">17</span><span class="w"> </span><span class="n">hours</span><span class="w"> </span><span class="n">ago</span><span class="w"> </span><span class="n">you</span><span class="err">@</span><span class="n">me</span><span class="mf">.</span><span class="n">com</span><span class="w"> </span><span class="n">Fixes</span><span class="w"> </span><span class="err">#</span><span class="mf">6.</span><span class="w"> </span><span class="n">Sao</span><span class="w"> </span><span class="n">Paolo</span><span class="w"> </span><span class="n">region</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">included</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">well</span><span class="mf">.</span>
<span class="mf">5</span><span class="n">aed68e</span><span class="w"> </span><span class="mf">17</span><span class="w"> </span><span class="n">hours</span><span class="w"> </span><span class="n">ago</span><span class="w"> </span><span class="n">you</span><span class="err">@</span><span class="n">me</span><span class="mf">.</span><span class="n">com</span><span class="w"> </span><span class="n">Shorten</span><span class="w"> </span><span class="n">while</span><span class="w"> </span><span class="n">loops</span>
</pre></div>

<p>这当然都是彩色的，所以很容易区分日志行的各个部分。<code>git log</code>由于 [format] 部分，它也是键入时的默认设置。</p>
<p>2014 更新：由于 git 现在支持填充，我对上面的版本进行了很好的修改：</p>
<div class="code"><pre class="code literal-block">pretty = format:%C(yellow)%h %Cblue%&gt;(12)%ad %Cgreen%&lt;(7)%aN%Cred%d %Creset%s
</pre></div>

<p>右对齐相对日期，左对齐提交者姓名，这意味着您将获得类似列的外观，看起来很舒服。</p>
<p><strong>截屏</strong></p>
<p><img alt="SS#1" src="https://i.imgur.com/eRYXa0F.png"></p>
<p>2016 年更新：由于 GPG 提交签名正在成为现实，我想我会用一个包含签名验证的版本更新这篇文章（在屏幕截图中，它是提交后的洋红色字母）。标志的简短解释：</p>
<blockquote>
<p>%G?: 显示“G”表示好的（有效）签名，“B”表示错误的签名，“U”表示正确的但未知有效性的签名，“N”表示无签名</p>
</blockquote>
<p>其他变化包括：</p>
<ul>
<li>如果输出到 tty 以外的其他东西（这对于 grepping 等很有用），现在会删除颜色</li>
<li>
<code>git log -g</code>现在包含 reflog 选择器。</li>
<li>在 refnames 上保存 2 个括号并将它们放在末尾（以保持列对齐）</li>
<li>如果相对日期太长则截断它们（例如<code>3 years, 4..</code>）</li>
<li>截断提交者名称（对于某些人来说可能有点短，只需更改<code>%&lt;(7,trunc)</code>或检查git .mailmap 功能以缩短提交者名称）</li>
</ul>
<p>这是配置：</p>
<div class="code"><pre class="code literal-block">pretty = format:%C(auto,yellow)%h%C(auto,magenta)% G? %C(auto,blue)%&gt;(12,trunc)%ad %C(auto,green)%&lt;(7,trunc)%aN%C(auto,reset)%s%C(auto,red)% gD% D
</pre></div>

<p>总而言之，现在以一些（希望如此）无用字符为代价，更好地保留了列对齐。如果您有任何改进，请随时进行编辑，我很乐意根据提交是否已签名来使消息颜色变亮，但 atm
似乎不可能。</p>
<p><strong>截屏</strong></p>
<p><img alt="git日志截图" src="https://i.imgur.com/fRyUrXV.png"></p>
<p><br><br><a href="posts/the-shortest-possible-output-from-git-log-containing-author-and-date/">查看原文</a></p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/wei-shi-yao-zai-c-zhong-bu-huo-bing-zhong-xin-pao-chu-yi-chang/" class="u-url">为什么在 C# 中捕获并重新抛出异常？</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/wei-shi-yao-zai-c-zhong-bu-huo-bing-zhong-xin-pao-chu-yi-chang/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T18:05:56+08:00" itemprop="datePublished" title="2023-02-17 18:05">2023-02-17 18:05</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>我正在查看文章 <em>C# - 可序列化 DTO 上的数据传输对象</em> 。</p>
<p>文章包括这段代码：</p>
<div class="code"><pre class="code literal-block"><span class="nv">public</span><span class="w"> </span><span class="nv">static</span><span class="w"> </span><span class="nv">string</span><span class="w"> </span><span class="nv">SerializeDTO</span><span class="ss">(</span><span class="nv">DTO</span><span class="w"> </span><span class="nv">dto</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">    </span><span class="nv">try</span><span class="w"> </span>{
<span class="w">        </span><span class="nv">XmlSerializer</span><span class="w"> </span><span class="nv">xmlSer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">XmlSerializer</span><span class="ss">(</span><span class="nv">dto</span>.<span class="nv">GetType</span><span class="ss">())</span><span class="c1">;</span>
<span class="w">        </span><span class="nv">StringWriter</span><span class="w"> </span><span class="nv">sWriter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">StringWriter</span><span class="ss">()</span><span class="c1">;</span>
<span class="w">        </span><span class="nv">xmlSer</span>.<span class="nv">Serialize</span><span class="ss">(</span><span class="nv">sWriter</span>,<span class="w"> </span><span class="nv">dto</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nv">sWriter</span>.<span class="nv">ToString</span><span class="ss">()</span><span class="c1">;</span>
<span class="w">    </span>}
<span class="w">    </span><span class="nv">catch</span><span class="ss">(</span><span class="nv">Exception</span><span class="w"> </span><span class="nv">ex</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">        </span><span class="nv">throw</span><span class="w"> </span><span class="nv">ex</span><span class="c1">;</span>
<span class="w">    </span>}
}
</pre></div>

<p>文章的其余部分看起来理智合理（对菜鸟来说），但是 try-catch-throw 抛出 WtfException ......
<strong>这不完全等同于根本不处理异常吗？</strong></p>
<p>因此：</p>
<div class="code"><pre class="code literal-block"><span class="nv">public</span><span class="w"> </span><span class="nv">static</span><span class="w"> </span><span class="nv">string</span><span class="w"> </span><span class="nv">SerializeDTO</span><span class="ss">(</span><span class="nv">DTO</span><span class="w"> </span><span class="nv">dto</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">    </span><span class="nv">XmlSerializer</span><span class="w"> </span><span class="nv">xmlSer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">XmlSerializer</span><span class="ss">(</span><span class="nv">dto</span>.<span class="nv">GetType</span><span class="ss">())</span><span class="c1">;</span>
<span class="w">    </span><span class="nv">StringWriter</span><span class="w"> </span><span class="nv">sWriter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">StringWriter</span><span class="ss">()</span><span class="c1">;</span>
<span class="w">    </span><span class="nv">xmlSer</span>.<span class="nv">Serialize</span><span class="ss">(</span><span class="nv">sWriter</span>,<span class="w"> </span><span class="nv">dto</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nv">sWriter</span>.<span class="nv">ToString</span><span class="ss">()</span><span class="c1">;</span>
}
</pre></div>

<p>还是我遗漏了一些有关 C# 错误处理的基本知识？它与 Java 几乎相同（减去已检查的异常），不是吗？... 也就是说，他们都改进了 C++。</p>
<p>Stack Overflow 问题 <em>重新抛出无参数 catch 和什么都不做之间的区别？</em> 似乎支持我的论点，即 try-catch-throw
是一个空操作。</p>
<hr>
<p><strong>编辑：</strong></p>
<p>只是为将来发现此线程的任何人总结......</p>
<p><strong>不要</strong></p>
<div class="code"><pre class="code literal-block"><span class="nv">try</span><span class="w"> </span>{
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="k">Do</span><span class="w"> </span><span class="nv">stuff</span><span class="w"> </span><span class="nv">that</span><span class="w"> </span><span class="nv">might</span><span class="w"> </span><span class="nv">throw</span><span class="w"> </span><span class="nv">an</span><span class="w"> </span><span class="nv">exception</span>
}
<span class="nv">catch</span><span class="w"> </span><span class="ss">(</span><span class="nv">Exception</span><span class="w"> </span><span class="nv">e</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">    </span><span class="nv">throw</span><span class="w"> </span><span class="nv">e</span><span class="c1">; // This destroys the strack trace information!</span>
}
</pre></div>

<p>堆栈跟踪信息对于确定问题的根本原因至关重要！</p>
<p><strong>做</strong></p>
<div class="code"><pre class="code literal-block"><span class="nv">try</span><span class="w"> </span>{
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="k">Do</span><span class="w"> </span><span class="nv">stuff</span><span class="w"> </span><span class="nv">that</span><span class="w"> </span><span class="nv">might</span><span class="w"> </span><span class="nv">throw</span><span class="w"> </span><span class="nv">an</span><span class="w"> </span><span class="nv">exception</span>
}
<span class="nv">catch</span><span class="w"> </span><span class="ss">(</span><span class="nv">SqlException</span><span class="w"> </span><span class="nv">e</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="nv">Log</span><span class="w"> </span><span class="nv">it</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">e</span>.<span class="nv">ErrorCode</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nv">NO_ROW_ERROR</span><span class="ss">)</span><span class="w"> </span>{<span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nv">filter</span><span class="w"> </span><span class="nv">out</span><span class="w"> </span><span class="nv">NoDataFound</span>.
<span class="w">        </span><span class="o">//</span><span class="w"> </span><span class="k">Do</span><span class="w"> </span><span class="nv">special</span><span class="w"> </span><span class="nv">cleanup</span>,<span class="w"> </span><span class="nv">like</span><span class="w"> </span><span class="nv">maybe</span><span class="w"> </span><span class="nv">closing</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="s2">"dirty"</span><span class="w"> </span><span class="nv">database</span><span class="w"> </span><span class="nv">connection</span>.
<span class="w">        </span><span class="nv">throw</span><span class="c1">; // This preserves the stack trace</span>
<span class="w">    </span>}
}
<span class="nv">catch</span><span class="w"> </span><span class="ss">(</span><span class="nv">IOException</span><span class="w"> </span><span class="nv">e</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="nv">Log</span><span class="w"> </span><span class="nv">it</span>
<span class="w">    </span><span class="nv">throw</span><span class="c1">;</span>
}
<span class="nv">catch</span><span class="w"> </span><span class="ss">(</span><span class="nv">Exception</span><span class="w"> </span><span class="nv">e</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="nv">Log</span><span class="w"> </span><span class="nv">it</span>
<span class="w">    </span><span class="nv">throw</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">DAOException</span><span class="ss">(</span><span class="s2">"Excrement occurred"</span>,<span class="w"> </span><span class="nv">e</span><span class="ss">)</span><span class="c1">; // wrapped &amp; chained exceptions (just like java).</span>
}
<span class="nv">finally</span><span class="w"> </span>{
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="nv">Normal</span><span class="w"> </span><span class="nv">clean</span><span class="w"> </span><span class="nv">goes</span><span class="w"> </span><span class="nv">here</span><span class="w"> </span><span class="ss">(</span><span class="nv">like</span><span class="w"> </span><span class="nv">closing</span><span class="w"> </span><span class="nv">open</span><span class="w"> </span><span class="nv">files</span><span class="ss">)</span>.
}
</pre></div>

<p>在不太具体的异常之前捕获更具体的异常（就像 Java）。</p>
<hr>
<p><strong>参考：</strong></p>
<ul>
<li>MSDN - 异常处理</li>
<li>MSDN - try-catch（C# 参考）</li>
</ul>
<p><br><br></p>
<h2>解答</h2>
<p>首先，文章中的代码执行它的方式是邪恶的。<code>throw ex</code>将异常中的调用堆栈重置到此 throw 语句丢失有关异常实际创建位置的信息的位置。</p>
<p>其次，如果你只是像那样抓住并重新投掷，我看不出有什么附加值。<code>throw ex</code>如果没有 try-
catch，上面的代码示例会一样好（或者，考虑到位，甚至更好）。</p>
<p>但是，在某些情况下，您可能想要捕获并重新抛出异常。日志记录可能是其中之一：</p>
<div class="code"><pre class="code literal-block">    try 
    {
        // code that may throw exceptions    
    }
    catch(Exception ex) 
    {
        // add error logging here
        throw;
    }
</pre></div>

<p><br></p>
<h3>更多建议</h3>
<p>不要这样做，</p>
<div class="code"><pre class="code literal-block">try 
{
...
}
catch(Exception ex)
{
   throw ex;
}
</pre></div>

<p>您将丢失堆栈跟踪信息...</p>
<p>要么做，</p>
<div class="code"><pre class="code literal-block">try { ... }
catch { throw; }
</pre></div>

<p>或者</p>
<div class="code"><pre class="code literal-block">try { ... }
catch (Exception ex)
{
    throw new Exception("My Custom Error Message", ex);
}
</pre></div>

<p>您可能想要重新抛出的原因之一是如果您正在处理不同的异常，例如</p>
<div class="code"><pre class="code literal-block"><span class="nv">try</span>
{
<span class="w">   </span>...
}
<span class="nv">catch</span><span class="ss">(</span><span class="nv">SQLException</span><span class="w"> </span><span class="nv">sex</span><span class="ss">)</span>
{
<span class="w">   </span><span class="o">//</span><span class="k">Do</span><span class="w"> </span><span class="nv">Custom</span><span class="w"> </span><span class="nv">Logging</span><span class="w"> </span>
<span class="w">   </span><span class="o">//</span><span class="nv">Don</span><span class="err">'t throw exception - swallow it here</span>
<span class="err">}</span>
<span class="err">catch(OtherException oex)</span>
<span class="err">{</span>
<span class="err">   //Do something else</span>
<span class="err">   throw new WrappedException("Other Exception occured");</span>
<span class="err">}</span>
<span class="err">catch</span>
<span class="err">{</span>
<span class="err">   System.Diagnostics.Debug.WriteLine("Eeep! an error, not to worry, will be handled higher up the call stack");</span>
<span class="err">   throw; //Chuck everything else back up the stack</span>
<span class="err">}</span>
</pre></div>

<p><br><br><a href="posts/why-catch-and-rethrow-an-exception-in-c/">查看原文</a></p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-861.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-859.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
