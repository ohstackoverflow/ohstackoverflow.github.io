<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 2625) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-2625.html">
<link rel="prev" href="index-2626.html" type="text/html">
<link rel="next" href="index-2624.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/why-does-0-5-3-return-true/" class="u-url">Why does (0 &lt; 5 &lt; 3) return true?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/why-does-0-5-3-return-true/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-05T05:47:18+08:00" itemprop="datePublished" title="2023-03-05 05:47">2023-03-05 05:47</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I was playing around in jsfiddle.net and I'm curious as to why this returns
true?</p>
<div class="code"><pre class="code literal-block"><span class="k">if</span><span class="ss">(</span><span class="mi">0</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">3</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">    </span><span class="nv">alert</span><span class="ss">(</span><span class="s2">"True"</span><span class="ss">)</span><span class="c1">;</span>
}
</pre></div>

<p>So does this:</p>
<div class="code"><pre class="code literal-block"><span class="k">if</span><span class="ss">(</span><span class="mi">0</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">2</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">    </span><span class="nv">alert</span><span class="ss">(</span><span class="s2">"True"</span><span class="ss">)</span><span class="c1">;</span>
}
</pre></div>

<p>But this doesn't:</p>
<div class="code"><pre class="code literal-block"><span class="k">if</span><span class="ss">(</span><span class="mi">0</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">    </span><span class="nv">alert</span><span class="ss">(</span><span class="s2">"True"</span><span class="ss">)</span><span class="c1">;</span>
}
</pre></div>

<p>Is this quirk ever useful?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Order of operations causes <code>(0 &lt; 5 &lt; 3)</code> to be interpreted in javascript as
<code>((0 &lt; 5) &lt; 3)</code> which produces <code>(true &lt; 3)</code> and true is counted as 1, causing
it to return true.</p>
<p>This is also why <code>(0 &lt; 5 &lt; 1)</code> returns false, <code>(0 &lt; 5)</code> returns true, which is
interpreted as <code>1</code>, resulting in <code>(1 &lt; 1)</code>.</p>
<p><br></p>
<h3>Suggest</h3>
<p>My guess is because <code>0 &lt; 5</code> is true, and <code>true &lt; 3</code> gets cast to <code>1 &lt; 3</code> which
is true.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/what-do-lambda-function-closures-capture/" class="u-url">What do lambda function closures capture?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/what-do-lambda-function-closures-capture/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-05T05:45:53+08:00" itemprop="datePublished" title="2023-03-05 05:45">2023-03-05 05:45</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Recently I started playing around with Python and I came around something
peculiar in the way closures work. Consider the following code:</p>
<div class="code"><pre class="code literal-block"><span class="n">adders</span><span class="o">=[</span><span class="n">None, None, None, None</span><span class="o">]</span>

<span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="o">[</span><span class="n">0,1,2,3</span><span class="o">]</span><span class="err">:</span>
<span class="w">   </span><span class="n">adders</span><span class="o">[</span><span class="n">i</span><span class="o">]=</span><span class="n">lambda</span><span class="w"> </span><span class="nl">a</span><span class="p">:</span><span class="w"> </span><span class="n">i</span><span class="o">+</span><span class="n">a</span>

<span class="k">print</span><span class="w"> </span><span class="n">adders</span><span class="o">[</span><span class="n">1</span><span class="o">]</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

<p>It builds a simple array of functions that take a single input and return that
input added by a number. The functions are constructed in <code>for</code> loop where the
iterator <code>i</code> runs from <code>0</code> to <code>3</code>. For each of these numbers a <code>lambda</code>
function is created which captures <code>i</code> and adds it to the function's input.
The last line calls the second <code>lambda</code> function with <code>3</code> as a parameter. To
my surprise the output was <code>6</code>.</p>
<p>I expected a <code>4</code>. My reasoning was: in Python everything is an object and thus
every variable is essential a pointer to it. When creating the <code>lambda</code>
closures for <code>i</code>, I expected it to store a pointer to the integer object
currently pointed to by <code>i</code>. That means that when <code>i</code> assigned a new integer
object it shouldn't effect the previously created closures. Sadly, inspecting
the <code>adders</code> array within a debugger shows that it does. All <code>lambda</code>
functions refer to the last value of <code>i</code>, <code>3</code>, which results in <code>adders[1](3)</code>
returning <code>6</code>.</p>
<p>Which make me wonder about the following:</p>
<ul>
<li>What do the closures capture exactly?</li>
<li>What is the most elegant way to convince the <code>lambda</code> functions to capture the current value of <code>i</code> in a way that will not be affected when <code>i</code> changes its value?</li>
</ul>
<hr>
<p>For a more accessible, practical version of the question, specific to the case
where a loop (or list comprehension, generator expression etc.) is used, see
Creating functions (or lambdas) in a loop (or comprehension). This question is
focused on understanding the underlying behaviour of the code in Python.</p>
<p>If you got here trying to fix a problem with making buttons in Tkinter, try
tkinter creating buttons in for loop passing command arguments for more
specific advice.</p>
<p>See What exactly is contained within a obj.<strong>closure</strong>? for technical details
of <strong>how</strong> Python implements closures. See What is the difference between
Early and Late Binding? for related terminology discussion.</p>
<p><br><br></p>
<h2>Answer</h2>
<blockquote>
<p>What do the closures capture exactly?</p>
</blockquote>
<p>Closures in Python use lexical scoping: they remember the name and scope of
the closed-over variable <em>where</em> it is created. <strong>However</strong> , they are still
<em>late binding</em> : the name is looked up <em>when</em> the code in the closure is used,
not when the closure is created. Since all the functions in your example are
created in the same scope and use the same variable name, they always refer to
the same variable.</p>
<p>There are at least two ways to get early binding instead:</p>
<ol>
<li>
<p>The most concise, but not strictly equivalent way is the one recommended by Adrien Plisson. Create a lambda with an extra argument, and set the extra argument's default value to the object you want preserved.</p>
</li>
<li>
<p>More verbosely but also more robustly, we can create a new scope for each created lambda:</p>
<div class="code"><pre class="code literal-block">&gt;&gt;&gt; adders = [0,1,2,3]
</pre></div>

<blockquote>
<blockquote>
<blockquote>
<p>for i in [0,1,2,3]:
...     adders[i] = (lambda b: lambda a: b + a)(i)
...   <br>
adders<a href="posts/what-do-lambda-function-closures-capture/3">1</a>
4
adders<a href="posts/what-do-lambda-function-closures-capture/3">2</a>
5</p>
</blockquote>
</blockquote>
</blockquote>
</li>
</ol>
<p>The scope here is created using a new function (another lambda, for brevity),
which binds its argument, and passing the value you want to bind as the
argument. In real code, though, you most likely will have an ordinary function
instead of the lambda to create the new scope:</p>
<div class="code"><pre class="code literal-block"><span class="w">    </span><span class="nv">def</span><span class="w"> </span><span class="nv">createAdder</span><span class="ss">(</span><span class="nv">x</span><span class="ss">)</span>:
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nv">lambda</span><span class="w"> </span><span class="nv">y</span>:<span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nv">x</span>
<span class="nv">adders</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>[<span class="nv">createAdder</span><span class="ss">(</span><span class="nv">i</span><span class="ss">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">range</span><span class="ss">(</span><span class="mi">4</span><span class="ss">)</span>]
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<blockquote>
<p>What do the closures capture exactly?</p>
</blockquote>
<p>Closures in Python use lexical scoping: they remember the name and scope of
the closed-over variable <em>where</em> it is created. <strong>However</strong> , they are still
<em>late binding</em> : the name is looked up <em>when</em> the code in the closure is used,
not when the closure is created. Since all the functions in your example are
created in the same scope and use the same variable name, they always refer to
the same variable.</p>
<p>There are at least two ways to get early binding instead:</p>
<ol>
<li>
<p>The most concise, but not strictly equivalent way is the one recommended by Adrien Plisson. Create a lambda with an extra argument, and set the extra argument's default value to the object you want preserved.</p>
</li>
<li>
<p>More verbosely but also more robustly, we can create a new scope for each created lambda:</p>
<div class="code"><pre class="code literal-block">&gt;&gt;&gt; adders = [0,1,2,3]
</pre></div>

<blockquote>
<blockquote>
<blockquote>
<p>for i in [0,1,2,3]:
...     adders[i] = (lambda b: lambda a: b + a)(i)
...   <br>
adders<a href="posts/what-do-lambda-function-closures-capture/3">1</a>
4
adders<a href="posts/what-do-lambda-function-closures-capture/3">2</a>
5</p>
</blockquote>
</blockquote>
</blockquote>
</li>
</ol>
<p>The scope here is created using a new function (another lambda, for brevity),
which binds its argument, and passing the value you want to bind as the
argument. In real code, though, you most likely will have an ordinary function
instead of the lambda to create the new scope:</p>
<div class="code"><pre class="code literal-block"><span class="w">    </span><span class="nv">def</span><span class="w"> </span><span class="nv">createAdder</span><span class="ss">(</span><span class="nv">x</span><span class="ss">)</span>:
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nv">lambda</span><span class="w"> </span><span class="nv">y</span>:<span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nv">x</span>
<span class="nv">adders</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>[<span class="nv">createAdder</span><span class="ss">(</span><span class="nv">i</span><span class="ss">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">range</span><span class="ss">(</span><span class="mi">4</span><span class="ss">)</span>]
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/what-is-the-difference-between-putting-a-property-on-application-yml-or-bootstrap-yml-in-spring-boot/" class="u-url">What is the difference between putting a property on application.yml or bootstrap.yml in spring boot?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/what-is-the-difference-between-putting-a-property-on-application-yml-or-bootstrap-yml-in-spring-boot/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-05T05:44:48+08:00" itemprop="datePublished" title="2023-03-05 05:44">2023-03-05 05:44</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>What is the difference between putting a property on application.yml or
bootstrap.yml in spring boot? In logging.config case, the application works
differently.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>I have just asked the <code>Spring Cloud</code> guys and thought I should share the info
I have here.</p>
<p><strong><code>bootstrap.yml</code> is loaded before <code>application.yml</code>.</strong></p>
<p>It is typically used for the following:</p>
<ul>
<li>when using Spring Cloud Config Server, you should specify <code>spring.application.name</code> and <code>spring.cloud.config.server.git.uri</code> inside <code>bootstrap.yml</code>
</li>
<li>some <code>encryption/decryption</code> information</li>
</ul>
<p>Technically, <code>bootstrap.yml</code> is loaded by a parent Spring
<code>ApplicationContext</code>. That parent <code>ApplicationContext</code> is loaded before the
one that uses <code>application.yml</code>.</p>
<p><br></p>
<h3>Suggest</h3>
<h4>
<code>bootstrap.yml</code> or <code>bootstrap.properties</code>
</h4>
<p>It's only used/needed if you're using <strong><em>Spring Cloud</em></strong> and your
application's configuration is stored on a remote configuration server (e.g.
Spring Cloud Config Server).</p>
<p>From the documentation:</p>
<blockquote>
<p>A Spring Cloud application operates by creating a "bootstrap" context, which
is a parent context for the main application. <strong><em>Out of the box it is
responsible for loading configuration properties from the external
sources</em></strong> , and also decrypting properties in the local external
configuration files.</p>
</blockquote>
<p>Note that the <code>bootstrap.yml</code> or <code>bootstrap.properties</code> <em>can</em> contain
additional configuration (e.g. defaults) but generally you only need to put
bootstrap config here.</p>
<p>Typically it contains two properties:</p>
<ul>
<li>location of the configuration server (<code>spring.cloud.config.uri</code>)</li>
<li>name of the application (<code>spring.application.name</code>)</li>
</ul>
<p>Upon startup, Spring Cloud makes an HTTP call to the config server with the
name of the application and retrieves back that application's configuration.</p>
<h4>
<code>application.yml</code> or <code>application.properties</code>
</h4>
<p>Contains standard application configuration - typically default configuration
since any configuration retrieved during the bootstrap process will override
configuration defined here.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-2626.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-2624.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
