<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 2535) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-2535.html">
<link rel="prev" href="index-2536.html" type="text/html">
<link rel="next" href="index-2534.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-can-i-read-from-standard-input-in-the-console/" class="u-url">How can I read from standard input in the console?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-can-i-read-from-standard-input-in-the-console/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T23:17:37+08:00" itemprop="datePublished" title="2023-03-04 23:17">2023-03-04 23:17</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I would like to read standard input from the command line, but my attempts
have ended with the program exiting before I'm prompted for input. I'm looking
for the equivalent of Console.ReadLine() in C#.</p>
<p>This is what I currently have:</p>
<div class="code"><pre class="code literal-block"><span class="n">package</span> <span class="n">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s2">"bufio"</span>
    <span class="s2">"fmt"</span>
    <span class="s2">"os"</span>
<span class="p">)</span>

<span class="n">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">reader</span> <span class="o">:=</span> <span class="n">bufio</span><span class="o">.</span><span class="n">NewReader</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">Stdin</span><span class="p">)</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Print</span><span class="p">(</span><span class="s2">"Enter text: "</span><span class="p">)</span>
    <span class="n">text</span><span class="p">,</span> <span class="n">_</span> <span class="o">:=</span> <span class="n">reader</span><span class="o">.</span><span class="n">ReadString</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

    <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s2">"Enter text: "</span><span class="p">)</span>
    <span class="n">text2</span> <span class="o">:=</span> <span class="s2">""</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Scanln</span><span class="p">(</span><span class="n">text2</span><span class="p">)</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">text2</span><span class="p">)</span>

    <span class="n">ln</span> <span class="o">:=</span> <span class="s2">""</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Sscanln</span><span class="p">(</span><span class="s2">"%v"</span><span class="p">,</span> <span class="n">ln</span><span class="p">)</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">ln</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<p>I'm not sure what's wrong with the block</p>
<div class="code"><pre class="code literal-block"><span class="nv">reader</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nv">bufio</span><span class="o">.</span><span class="nf">NewReader</span><span class="p">(</span><span class="nv">os</span><span class="o">.</span><span class="nv">Stdin</span><span class="p">)</span>
<span class="nv">fmt</span><span class="o">.</span><span class="nf">Print</span><span class="p">(</span><span class="s">"Enter text: "</span><span class="p">)</span>
<span class="nv">text</span><span class="p">,</span><span class="w"> </span><span class="nv">_</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nv">reader</span><span class="o">.</span><span class="nf">ReadString</span><span class="p">(</span><span class="o">'</span>\<span class="nv">n</span><span class="o">'</span><span class="p">)</span>
<span class="nv">fmt</span><span class="o">.</span><span class="nf">Println</span><span class="p">(</span><span class="nv">text</span><span class="p">)</span>
</pre></div>

<p>As it works on my machine. However, for the next block you need a pointer to
the variables you're assigning the input to. Try replacing <code>fmt.Scanln(text2)</code>
with <code>fmt.Scanln(&amp;text2)</code>. Don't use <code>Sscanln</code>, because it parses a string
already in memory instead of from stdin. If you want to do something like what
you were trying to do, replace it with <code>fmt.Scanf("%s", &amp;ln)</code></p>
<p>If this still doesn't work, your culprit might be some weird system settings
or a buggy IDE.</p>
<p><br></p>
<h3>Suggest</h3>
<p>You can as well try:</p>
<div class="code"><pre class="code literal-block"><span class="nv">scanner</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nv">bufio</span><span class="o">.</span><span class="nf">NewScanner</span><span class="p">(</span><span class="nv">os</span><span class="o">.</span><span class="nv">Stdin</span><span class="p">)</span>
<span class="k">for</span><span class="w"> </span><span class="nv">scanner</span><span class="o">.</span><span class="nf">Scan</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nv">fmt</span><span class="o">.</span><span class="nf">Println</span><span class="p">(</span><span class="nv">scanner</span><span class="o">.</span><span class="nf">Text</span><span class="p">())</span>
<span class="p">}</span>

<span class="k">if</span><span class="w"> </span><span class="nv">scanner</span><span class="o">.</span><span class="nf">Err</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nv">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="nv">Handle</span><span class="w"> </span><span class="nv">error</span><span class="o">.</span>
<span class="p">}</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/commandbutton-commandlink-ajax-action-listener-method-not-invoked-or-input-value-not-set-updated/" class="u-url">commandButton/commandLink/ajax action/listener method not invoked or input value not set/updated</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/commandbutton-commandlink-ajax-action-listener-method-not-invoked-or-input-value-not-set-updated/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T23:16:06+08:00" itemprop="datePublished" title="2023-03-04 23:16">2023-03-04 23:16</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Sometimes, when using <code>&lt;h:commandLink&gt;</code>, <code>&lt;h:commandButton&gt;</code> or <code>&lt;f:ajax&gt;</code>,
the <code>action</code>, <code>actionListener</code> or <code>listener</code> method associated with the tag
are simply not being invoked. Or, the bean properties are not updated with
submitted <code>UIInput</code> values.</p>
<p>What are the possible causes and solutions for this?</p>
<p><br><br></p>
<h2>Answer</h2>
<h3>Introduction</h3>
<p>Whenever an <code>UICommand</code> component (<code>&lt;h:commandXxx&gt;</code>, <code>&lt;p:commandXxx&gt;</code>, etc)
fails to invoke the associated action method, or an <code>UIInput</code> component
(<code>&lt;h:inputXxx&gt;</code>, <code>&lt;p:inputXxxx&gt;</code>, etc) fails to process the submitted values
and/or update the model values, and you aren't seeing any googlable exceptions
and/or warnings in the server log, also not when you configure an ajax
exception handler as per Exception handling in JSF ajax requests, nor when you
set below context parameter in <code>web.xml</code>,</p>
<div class="code"><pre class="code literal-block"><span class="nt">&lt;context-param&gt;</span>
<span class="w">    </span><span class="nt">&lt;param-name&gt;</span>javax.faces.PROJECT_STAGE<span class="nt">&lt;/param-name&gt;</span>
<span class="w">    </span><span class="nt">&lt;param-value&gt;</span>Development<span class="nt">&lt;/param-value&gt;</span>
<span class="nt">&lt;/context-param&gt;</span>
</pre></div>

<p>and you are also not seeing any googlable errors and/or warnings in browser's
JavaScript console (press F12 in Chrome/Firefox23+/IE9+ to open the web
developer toolset and then open the <em>Console</em> tab), then work through below
list of possible causes.</p>
<h3>Possible causes</h3>
<ol>
<li>
<p><code>UICommand</code> and <code>UIInput</code> components must be placed inside an <code>UIForm</code> component, e.g. <code>&lt;h:form&gt;</code> (and thus not plain HTML <code>&lt;form&gt;</code>), otherwise nothing can be sent to the server. <code>UICommand</code> components must also not have <code>type="button"</code> attribute, otherwise it will be a dead button which is only useful for JavaScript <code>onclick</code>. See also How to send form input values and invoke a method in JSF bean and <commandbutton> does not initiate a postback.</commandbutton></p>
</li>
<li>
<p>You cannot nest multiple <code>UIForm</code> components in each other. This is illegal in HTML. The browser behavior is unspecified. Watch out with include files! You can use <code>UIForm</code> components in parallel, but they won't process each other during submit. You should also watch out with "God Form" antipattern; make sure that you don't unintentionally process/validate all other (invisible) inputs in the very same form (e.g. having a hidden dialog with required inputs in the very same form). See also How to use </p>
<form> in JSF page? Single form? Multiple forms? Nested forms?.</form>
</li>
<li>
<p>No <code>UIInput</code> value validation/conversion error should have occurred. You can use <code>&lt;h:messages&gt;</code> to show any messages which are not shown by any input-specific <code>&lt;h:message&gt;</code> components. Don't forget to include the <code>id</code> of <code>&lt;h:messages&gt;</code> in the <code>&lt;f:ajax render&gt;</code>, if any, so that it will be updated as well on ajax requests. See also h:messages does not display messages when p:commandButton is pressed.</p>
</li>
<li>
<p>If <code>UICommand</code> or <code>UIInput</code> components are placed inside an iterating component like <code>&lt;h:dataTable&gt;</code>, <code>&lt;ui:repeat&gt;</code>, etc, then you need to ensure that exactly the same <code>value</code> of the iterating component is been preserved during the apply request values phase of the form submit request. JSF will reiterate over it to find the clicked link/button and submitted input values. Putting the bean in the view scope and/or making sure that you load the data model in <code>@PostConstruct</code> of the bean (and thus not in a getter method!) should fix it. See also How and when should I load the model from database for h:dataTable.</p>
</li>
<li>
<p>If <code>UICommand</code> or <code>UIInput</code> components are included by a dynamic source such as <code>&lt;ui:include src="#{bean.include}"&gt;</code>, then you need to ensure that exactly the same <code>#{bean.include}</code> value is preserved during the view build time of the form submit request. JSF will reexecute it during building the component tree. Putting the bean in the view scope and/or making sure that you load the data model in <code>@PostConstruct</code> of the bean (and thus not in a getter method!) should fix it. See also How to ajax-refresh dynamic include content by navigation menu? (JSF SPA).</p>
</li>
<li>
<p>The <code>rendered</code> attribute of the component and all of its parents and the <code>test</code> attribute of any parent <code>&lt;c:if&gt;</code>/<code>&lt;c:when&gt;</code> should not evaluate to <code>false</code> during the apply request values phase of the form submit request. JSF will recheck it as part of safeguard against tampered/hacked requests. Storing the variables responsible for the condition in a <code>@ViewScoped</code> bean or making sure that you're properly preinitializing the condition in <code>@PostConstruct</code> of a <code>@RequestScoped</code> bean should fix it. The same applies to the <code>disabled</code> and <code>readonly</code> attributes of the component, which should not evaluate to <code>true</code> during apply request values phase. See also JSF CommandButton action not invoked, Form submit in conditionally rendered component is not processed, h:commandButton is not working once I wrap it in a <panelgroup rendered> and Force JSF to process, validate and update readonly/disabled input components anyway</panelgroup></p>
</li>
<li>
<p>The <code>onclick</code> attribute of the <code>UICommand</code> component and the <code>onsubmit</code> attribute of the <code>UIForm</code> component should not return <code>false</code> or cause a JavaScript error. There should in case of <code>&lt;h:commandLink&gt;</code> or <code>&lt;f:ajax&gt;</code> also be no JS errors visible in the browser's JS console. Usually googling the exact error message will already give you the answer. See also Manually adding / loading jQuery with PrimeFaces results in Uncaught TypeErrors.</p>
</li>
<li>
<p>If you're using Ajax via JSF 2.x <code>&lt;f:ajax&gt;</code> or e.g. PrimeFaces <code>&lt;p:commandXxx&gt;</code>, make sure that you have a <code>&lt;h:head&gt;</code> in the master template instead of the <code>&lt;head&gt;</code>. Otherwise JSF won't be able to auto-include the necessary JavaScript files which contains the Ajax functions. This would result in a JavaScript error like "mojarra is not defined" or "PrimeFaces is not defined" in browser's JS console. See also h:commandLink actionlistener is not invoked when used with f:ajax and ui:repeat.</p>
</li>
<li>
<p>If you're using Ajax, and the submitted values end up being <code>null</code>, then make sure that the <code>UIInput</code> and <code>UICommand</code> components of interest are covered by the <code>&lt;f:ajax execute&gt;</code> or e.g. <code>&lt;p:commandXxx process&gt;</code>, otherwise they won't be executed/processed. See also Submitted form values not updated in model when adding <ajax> to <commandbutton> and Understanding PrimeFaces process/update and JSF f:ajax execute/render attributes.</commandbutton></ajax></p>
</li>
<li>
<p>If the submitted values still end up being <code>null</code>, and you're using CDI to manage beans, then make sure that you import the scope annotation from the correct package, else CDI will default to <code>@Dependent</code> which effectively recreates the bean on every single evaluation of the EL expression. See also @SessionScoped bean looses scope and gets recreated all the time, fields become null and What is the default Managed Bean Scope in a JSF 2 application?</p>
</li>
<li>
<p>If a parent of the <code>&lt;h:form&gt;</code> with the <code>UICommand</code> button is beforehand been rendered/updated by an ajax request coming from another form in the same page, then the first action will always fail in JSF 2.2 or older. The second and subsequent actions will work. This is caused by a bug in view state handling which is reported as JSF spec issue 790 and currently fixed in JSF 2.3. For older JSF versions, you need to explicitly specify the ID of the <code>&lt;h:form&gt;</code> in the <code>render</code> of the <code>&lt;f:ajax&gt;</code>. See also h:commandButton/h:commandLink does not work on first click, works only on second click.</p>
</li>
<li>
<p>If the <code>&lt;h:form&gt;</code> has <code>enctype="multipart/form-data"</code> set in order to support file uploading, then you need to make sure that you're using at least JSF 2.2, or that the servlet filter who is responsible for parsing multipart/form-data requests is properly configured, otherwise the <code>FacesServlet</code> will end up getting no request parameters at all and thus not be able to apply the request values. How to configure such a filter depends on the file upload component being used. For Tomahawk <code>&lt;t:inputFileUpload&gt;</code>, check this answer and for PrimeFaces <code>&lt;p:fileUpload&gt;</code>, check this answer. Or, if you're actually not uploading a file at all, then remove the attribute altogether.</p>
</li>
<li>
<p>Make sure that the <code>ActionEvent</code> argument of <code>actionListener</code> is an <code>javax.faces.event.ActionEvent</code> and thus not <code>java.awt.event.ActionEvent</code>, which is what most IDEs suggest as 1st autocomplete option. Having no argument is wrong as well if you use <code>actionListener="#{bean.method}"</code>. If you don't want an argument in your method, use <code>actionListener="#{bean.method()}"</code>. Or perhaps you actually want to use <code>action</code> instead of <code>actionListener</code>. See also Differences between action and actionListener.</p>
</li>
<li>
<p>Make sure that no <code>PhaseListener</code> or any <code>EventListener</code> in the request-response chain has changed the JSF lifecycle to skip the invoke action phase by for example calling <code>FacesContext#renderResponse()</code> or <code>FacesContext#responseComplete()</code>.</p>
</li>
<li>
<p>Make sure that no <code>Filter</code> or <code>Servlet</code> in the same request-response chain has blocked the request fo the <code>FacesServlet</code> somehow. For example, login/security filters such as Spring Security. Particularly in ajax requests that would by default end up with no UI feedback at all. See also Spring Security 4 and PrimeFaces 5 AJAX request handling.</p>
</li>
<li>
<p>If you are using a PrimeFaces <code>&lt;p:dialog&gt;</code> or a <code>&lt;p:overlayPanel&gt;</code>, then make sure that they have their own <code>&lt;h:form&gt;</code>. Because, these components are by default by JavaScript relocated to end of HTML <code>&lt;body&gt;</code>. So, if they were originally sitting inside a <code>&lt;form&gt;</code>, then they would now not anymore sit in a <code>&lt;form&gt;</code>. See also p:commandbutton action doesn't work inside p:dialog</p>
</li>
<li>
<p>Bug in the framework. For example, RichFaces has a "conversion error" when using a <code>rich:calendar</code> UI element with a <code>defaultLabel</code> attribute (or, in some cases, a <code>rich:placeholder</code> sub-element). This bug prevents the bean method from being invoked when no value is set for the calendar date. Tracing framework bugs can be accomplished by starting with a simple working example and building the page back up until the bug is discovered.</p>
</li>
</ol>
<h3>Debugging hints</h3>
<p>In case you still stucks, it's time to debug. In the client side, press F12 in
webbrowser to open the web developer toolset. Click the <em>Console</em> tab so see
the JavaScript conosle. It should be free of any JavaScript errors. Below
screenshot is an example from Chrome which demonstrates the case of submitting
an <code>&lt;f:ajax&gt;</code> enabled button while not having <code>&lt;h:head&gt;</code> declared (as
described in point 7 above).</p>
<p><img alt="js console" src="images/2qsLp.png"></p>
<p>Click the <em>Network</em> tab to see the HTTP traffic monitor. Submit the form and
investigate if the request headers and form data and the response body are as
per expectations. Below screenshot is an example from Chrome which
demonstrates a successful ajax submit of a simple form with a single
<code>&lt;h:inputText&gt;</code> and a single <code>&lt;h:commandButton&gt;</code> with <code>&lt;f:ajax execute="@form"
render="@form"&gt;</code>.</p>
<p><img alt="network monitor" src="images/mg5Al.png"></p>
<p><em>(warning: when you post screenshots from HTTP request headers like above from
a production environment, then make sure you scramble/obfuscate any session
cookies in the screenshot to avoid session hijacking attacks!)</em></p>
<p>In the server side, make sure that server is started in debug mode. Put a
debug breakpoint in a method of the JSF component of interest which you expect
to be called during processing the form submit. E.g. in case of <code>UICommand</code>
component, that would be <code>UICommand#queueEvent()</code> and in case of <code>UIInput</code>
component, that would be <code>UIInput#validate()</code>. Just step through the code
execution and inspect if the flow and variables are as per expectations. Below
screenshot is an example from Eclipse's debugger.</p>
<p><img alt="debug server" src="images/mnn5R.png"></p>
<p><br></p>
<h3>Suggest</h3>
<p>If your <code>h:commandLink</code> is inside a <code>h:dataTable</code> there is another reason why
the <code>h:commandLink</code> might not work:</p>
<p>The underlying data-source which is bound to the <code>h:dataTable</code> must also be
available in the second JSF-Lifecycle that is triggered when the link is
clicked.</p>
<p>So if the underlying data-source is request scoped, the <code>h:commandLink</code> does
not work!</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-prevent-tensorflow-from-allocating-the-totality-of-a-gpu-memory/" class="u-url">How to prevent tensorflow from allocating the totality of a GPU memory?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-prevent-tensorflow-from-allocating-the-totality-of-a-gpu-memory/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T23:14:36+08:00" itemprop="datePublished" title="2023-03-04 23:14">2023-03-04 23:14</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I work in an environment in which computational resources are shared, i.e., we
have a few server machines equipped with a few Nvidia Titan X GPUs each.</p>
<p>For small to moderate size models, the 12 GB of the Titan X is usually enough
for 2–3 people to run training concurrently on the same GPU. If the models are
small enough that a single model does not take full advantage of all the
computational units of the GPU, this can actually result in a speedup compared
with running one training process after the other. Even in cases where the
concurrent access to the GPU does slow down the individual training time, it
is still nice to have the flexibility of having multiple users simultaneously
train on the GPU.</p>
<p>The problem with TensorFlow is that, by default, it allocates the full amount
of available GPU memory when it is launched. Even for a small two-layer neural
network, I see that all 12 GB of the GPU memory is used up.</p>
<p>Is there a way to make TensorFlow only allocate, say, 4 GB of GPU memory, if
one knows that this is enough for a given model?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>You can set the fraction of GPU memory to be allocated when you construct a
<code>tf.Session</code> by passing a <code>tf.GPUOptions</code> as part of the optional <code>config</code>
argument:</p>
<div class="code"><pre class="code literal-block"># Assume that you have 12GB of GPU memory and want to allocate ~4GB:
gpu_options = tf.GPUOptions(per_process_gpu_memory_fraction=0.333)

sess = tf.Session(config=tf.ConfigProto(gpu_options=gpu_options))
</pre></div>

<p>The <code>per_process_gpu_memory_fraction</code> acts as a hard upper bound on the amount
of GPU memory that will be used by the process on each GPU on the same
machine. Currently, this fraction is applied uniformly to all of the GPUs on
the same machine; there is no way to set this on a per-GPU basis.</p>
<p><br></p>
<h3>Suggest</h3>
<div class="code"><pre class="code literal-block">config = tf.ConfigProto()
config.gpu_options.allow_growth=True
sess = tf.Session(config=config)
</pre></div>

<p>https://github.com/tensorflow/tensorflow/issues/1578</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-2536.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-2534.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
