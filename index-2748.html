<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 2748) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-2748.html">
<link rel="prev" href="index-2749.html" type="text/html">
<link rel="next" href="index-2747.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/removing-duplicate-elements-from-an-array-in-swift/" class="u-url">Removing duplicate elements from an array in Swift</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/removing-duplicate-elements-from-an-array-in-swift/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-05T14:58:52+08:00" itemprop="datePublished" title="2023-03-05 14:58">2023-03-05 14:58</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I might have an array that looks like the following:</p>
<div class="code"><pre class="code literal-block">[1, 4, 2, 2, 6, 24, 15, 2, 60, 15, 6]
</pre></div>

<p>Or, really, any sequence of like-typed portions of data. What I want to do is
ensure that there is only one of each identical element. For example, the
above array would become:</p>
<div class="code"><pre class="code literal-block">[1, 4, 2, 6, 24, 15, 60]
</pre></div>

<p>Notice that the duplicates of 2, 6, and 15 were removed to ensure that there
was only one of each identical element. Does Swift provide a way to do this
easily, or will I have to do it myself?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>You can roll your own, e.g. like this:</p>
<div class="code"><pre class="code literal-block"><span class="k">func</span><span class="w"> </span><span class="n">unique</span><span class="o">&lt;</span><span class="n">S</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Sequence</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Hashable</span><span class="o">&gt;</span><span class="p">(</span><span class="n">source</span><span class="p">:</span><span class="w"> </span><span class="n">S</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">T</span><span class="p">]</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="n">S</span><span class="o">.</span><span class="n">Iterator</span><span class="o">.</span><span class="n">Element</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">buffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">T</span><span class="p">]()</span>
<span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Set</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">elem</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="o">!</span><span class="n">added</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">buffer</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
<span class="w">            </span><span class="n">added</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">buffer</span>
<span class="p">}</span>

<span class="n">let</span><span class="w"> </span><span class="n">vals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">24</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">60</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">]</span>
<span class="n">let</span><span class="w"> </span><span class="n">uniqueVals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uniq</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">24</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="mi">60</span><span class="p">]</span>
</pre></div>

<p>And as an extension for <code>Array</code>:</p>
<div class="code"><pre class="code literal-block"><span class="n">extension</span><span class="w"> </span><span class="nb nb-Type">Array</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="n">Element</span><span class="p">:</span><span class="w"> </span><span class="n">Hashable</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">func</span><span class="w"> </span><span class="n">uniqued</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">Array</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">var</span><span class="w"> </span><span class="n">buffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb nb-Type">Array</span><span class="p">()</span>
<span class="w">        </span><span class="k">var</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Set</span><span class="o">&lt;</span><span class="n">Element</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">elem</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="o">!</span><span class="n">added</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">buffer</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
<span class="w">                </span><span class="n">added</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">buffer</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p>Or more elegantly (Swift 4/5):</p>
<div class="code"><pre class="code literal-block"><span class="n">extension</span><span class="w"> </span><span class="n">Sequence</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="n">Element</span><span class="p">:</span><span class="w"> </span><span class="n">Hashable</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">func</span><span class="w"> </span><span class="n">uniqued</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">Element</span><span class="p">]</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">var</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Set</span><span class="o">&lt;</span><span class="n">Element</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">set</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="o">$</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">inserted</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p>Which would be used:</p>
<div class="code"><pre class="code literal-block">[1,2,4,2,1].uniqued()  // =&gt; [1,2,4]
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>You can roll your own, e.g. like this:</p>
<div class="code"><pre class="code literal-block"><span class="k">func</span><span class="w"> </span><span class="n">unique</span><span class="o">&lt;</span><span class="n">S</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Sequence</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Hashable</span><span class="o">&gt;</span><span class="p">(</span><span class="n">source</span><span class="p">:</span><span class="w"> </span><span class="n">S</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">T</span><span class="p">]</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="n">S</span><span class="o">.</span><span class="n">Iterator</span><span class="o">.</span><span class="n">Element</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">buffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">T</span><span class="p">]()</span>
<span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Set</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">elem</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="o">!</span><span class="n">added</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">buffer</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
<span class="w">            </span><span class="n">added</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">buffer</span>
<span class="p">}</span>

<span class="n">let</span><span class="w"> </span><span class="n">vals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">24</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">60</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">]</span>
<span class="n">let</span><span class="w"> </span><span class="n">uniqueVals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uniq</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">24</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="mi">60</span><span class="p">]</span>
</pre></div>

<p>And as an extension for <code>Array</code>:</p>
<div class="code"><pre class="code literal-block"><span class="n">extension</span><span class="w"> </span><span class="nb nb-Type">Array</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="n">Element</span><span class="p">:</span><span class="w"> </span><span class="n">Hashable</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">func</span><span class="w"> </span><span class="n">uniqued</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">Array</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">var</span><span class="w"> </span><span class="n">buffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb nb-Type">Array</span><span class="p">()</span>
<span class="w">        </span><span class="k">var</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Set</span><span class="o">&lt;</span><span class="n">Element</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">elem</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="o">!</span><span class="n">added</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">buffer</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
<span class="w">                </span><span class="n">added</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">buffer</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p>Or more elegantly (Swift 4/5):</p>
<div class="code"><pre class="code literal-block"><span class="n">extension</span><span class="w"> </span><span class="n">Sequence</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="n">Element</span><span class="p">:</span><span class="w"> </span><span class="n">Hashable</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">func</span><span class="w"> </span><span class="n">uniqued</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">Element</span><span class="p">]</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">var</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Set</span><span class="o">&lt;</span><span class="n">Element</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">set</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="o">$</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">inserted</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p>Which would be used:</p>
<div class="code"><pre class="code literal-block">[1,2,4,2,1].uniqued()  // =&gt; [1,2,4]
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/i-get-conflicting-provisioning-settings-error-when-i-try-to-archive-to-submit-an-ios-app/" class="u-url">I get conflicting provisioning settings error when I try to archive to submit an iOS app</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/i-get-conflicting-provisioning-settings-error-when-i-try-to-archive-to-submit-an-ios-app/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-05T14:57:06+08:00" itemprop="datePublished" title="2023-03-05 14:57">2023-03-05 14:57</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Now I'm trying to Product&gt;Archive my iOS app to submit. However, I am getting
following errors:</p>
<blockquote>
<p>AppName has conflicting provisioning settings. AppName is automatically
signed for development, but a conflicting code signing identity iPhone
Distribution has been manually specified. Set the code signing identity
value to <code>iPhone Developer</code> in the build settings editor, or switch to
manual signing in the project editor.`</p>
<p>Code signing is required for product type 'Application' in SDK 'iOS 10.1'`</p>
</blockquote>
<p>The situation won't change even those I've retry a whole process to recreate
iOS certificates or provisioning profile.</p>
<p>I was setting as <code>iOS Distribution</code> in <code>TARGETS &gt; Code Signing Identity &gt;
Release &gt; Any iOS SDK</code>. When I changed the setting as <code>iOS Developer</code> here,
and changed the setting in <code>PROJECTS &gt; Code Signing Identity &gt; Release &gt; Any
iOS SDK</code> as <code>iOS Distribution</code>, I've succeeded in archiving. I'm wondering is
it necessary to set as <code>iOS Distribution</code> in the target editor or not. And if
it's mandatory, please someone let me know how can I work around this error.</p>
<p>My XCode version is 8.1.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>I had this same error, but I had already checked "Automatically manage
signing".</p>
<p>The solution was to uncheck it, then check it again and reselect the Team.
Xcode then fixed whatever was causing the issue on its own.</p>
<p><br></p>
<h3>Suggest</h3>
<p>I had the same problem, I noticed that If you want to make a release of your
iOs app and publish it on the App Store you don't need at all to put in the
"Code Signing Identity" as release, just keep it as iOs developer.</p>
<p>Go to Your project -&gt; Build Settings -&gt; Code Signing Identity and put
everything to iOs developer.</p>
<p><img alt="enter image description here" src="images/BdilV.png"></p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/create-singleton-using-gcd-s-dispatch-once-in-objective-c/" class="u-url">Create singleton using GCD's dispatch_once in Objective-C</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/create-singleton-using-gcd-s-dispatch-once-in-objective-c/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-05T14:55:03+08:00" itemprop="datePublished" title="2023-03-05 14:55">2023-03-05 14:55</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>If you can target iOS 4.0 or above</p>
<p>Using GCD, is it the best way to create singleton in Objective-C (thread
safe)?</p>
<div class="code"><pre class="code literal-block"><span class="p">+</span> <span class="p">(</span><span class="kt">instancetype</span><span class="p">)</span><span class="nf">sharedInstance</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="n">dispatch_once_t</span><span class="w"> </span><span class="n">once</span><span class="p">;</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="kt">id</span><span class="w"> </span><span class="n">sharedInstance</span><span class="p">;</span>
<span class="w">    </span><span class="n">dispatch_once</span><span class="p">(</span><span class="o">&amp;</span><span class="n">once</span><span class="p">,</span><span class="w"> </span><span class="o">^</span><span class="p">{</span>
<span class="w">        </span><span class="n">sharedInstance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="nb">self</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">init</span><span class="p">];</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">sharedInstance</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<p>This is a perfectly acceptable and thread-safe way to create an instance of
your class. It may not technically be a "singleton" (in that there can only
ever be 1 of these objects), but as long as you only use the <code>[Foo sharedFoo]</code>
method to access the object, this is good enough.</p>
<p><br></p>
<h3>Suggest</h3>
<h2>instancetype</h2>
<p><code>instancetype</code> is just one of the many language extensions to <code>Objective-C</code>,
with more being added with each new release.</p>
<p>Know it, love it.</p>
<p>And take it as an example of how paying attention to the low-level details can
give you insights into powerful new ways to transform Objective-C.</p>
<p>Refer here: instancetype</p>
<hr>
<div class="code"><pre class="code literal-block"><span class="p">+</span> <span class="p">(</span><span class="kt">instancetype</span><span class="p">)</span><span class="nf">sharedInstance</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="n">dispatch_once_t</span><span class="w"> </span><span class="n">once</span><span class="p">;</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="kt">id</span><span class="w"> </span><span class="n">sharedInstance</span><span class="p">;</span>

<span class="w">    </span><span class="n">dispatch_once</span><span class="p">(</span><span class="o">&amp;</span><span class="n">once</span><span class="p">,</span><span class="w"> </span><span class="o">^</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">sharedInstance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="nb">self</span><span class="w"> </span><span class="n">new</span><span class="p">];</span>
<span class="w">    </span><span class="p">});</span><span class="w">    </span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">sharedInstance</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<hr>
<div class="code"><pre class="code literal-block"><span class="p">+</span> <span class="p">(</span><span class="kt">Class</span><span class="o">*</span><span class="p">)</span><span class="nf">sharedInstance</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="n">dispatch_once_t</span><span class="w"> </span><span class="n">once</span><span class="p">;</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="kt">Class</span><span class="w"> </span><span class="o">*</span><span class="n">sharedInstance</span><span class="p">;</span>

<span class="w">    </span><span class="n">dispatch_once</span><span class="p">(</span><span class="o">&amp;</span><span class="n">once</span><span class="p">,</span><span class="w"> </span><span class="o">^</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">sharedInstance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="nb">self</span><span class="w"> </span><span class="n">new</span><span class="p">];</span>
<span class="w">    </span><span class="p">});</span><span class="w">    </span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">sharedInstance</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-2749.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-2747.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
