<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 1243) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-1243.html">
<link rel="prev" href="index-1244.html" type="text/html">
<link rel="next" href="index-1242.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-can-i-pass-an-argument-to-a-powershell-script/" class="u-url">How can I pass an argument to a PowerShell script?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-can-i-pass-an-argument-to-a-powershell-script/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T04:42:14+08:00" itemprop="datePublished" title="2023-02-18 04:42">2023-02-18 04:42</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>There's a PowerShell script named <code>itunesForward.ps1</code> that makes iTunes fast
forward 30 seconds:</p>
<div class="code"><pre class="code literal-block">$<span class="nv">iTunes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">New</span><span class="o">-</span><span class="nv">Object</span><span class="w"> </span><span class="o">-</span><span class="nv">ComObject</span><span class="w"> </span><span class="nv">iTunes</span>.<span class="nv">Application</span>

<span class="k">if</span><span class="w"> </span><span class="ss">(</span>$<span class="nv">iTunes</span>.<span class="nv">playerstate</span><span class="w"> </span><span class="o">-</span><span class="nv">eq</span><span class="w"> </span><span class="mi">1</span><span class="ss">)</span>
{
<span class="w">  </span>$<span class="nv">iTunes</span>.<span class="nv">PlayerPosition</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>$<span class="nv">iTunes</span>.<span class="nv">PlayerPosition</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">30</span>
}
</pre></div>

<p>It is executed with a prompt line command:</p>
<div class="code"><pre class="code literal-block">powershell.exe itunesForward.ps1
</pre></div>

<p>Is it possible to pass an argument from the command line and have it applied
in the script instead of the hardcoded 30 seconds value?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Tested as working:</p>
<div class="code"><pre class="code literal-block"><span class="c1">#Must be the first statement in your script (not counting comments)</span>
<span class="n">param</span>([<span class="n">Int32</span>]<span class="nv">$step</span>=<span class="mi">30</span>)

<span class="nv">$iTunes</span> = <span class="n">New-Object</span> -<span class="n">ComObject</span> <span class="n">iTunes</span>.<span class="n">Application</span>

<span class="k">if</span> (<span class="nv">$iTunes</span>.<span class="n">playerstate</span> -<span class="o">eq</span> <span class="mi">1</span>)
{
  <span class="nv">$iTunes</span>.<span class="n">PlayerPosition</span> = <span class="nv">$iTunes</span>.<span class="n">PlayerPosition</span> + <span class="nv">$step</span>
}
</pre></div>

<p>Call it with</p>
<div class="code"><pre class="code literal-block">powershell.exe -file itunesForward.ps1 -step 15
</pre></div>

<p>Multiple parameters syntax (comments are optional, but allowed):</p>
<div class="code"><pre class="code literal-block"><span class="o">&lt;</span><span class="err">#</span>
<span class="w">    </span><span class="n">Script</span><span class="w"> </span><span class="n">description</span><span class="p">.</span>

<span class="w">    </span><span class="ow">Some</span><span class="w"> </span><span class="n">notes</span><span class="p">.</span>
<span class="err">#</span><span class="o">&gt;</span>
<span class="n">param</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">height</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">largest</span><span class="w"> </span><span class="k">column</span><span class="w"> </span><span class="k">without</span><span class="w"> </span><span class="k">top</span><span class="w"> </span><span class="n">bar</span>
<span class="w">    </span><span class="o">[</span><span class="n">int</span><span class="o">]</span><span class="err">$</span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4000</span><span class="p">,</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">output</span><span class="w"> </span><span class="nc">image</span>
<span class="w">    </span><span class="o">[</span><span class="n">string</span><span class="o">]</span><span class="err">$</span><span class="nc">image</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'out.png'</span>
<span class="p">)</span>
</pre></div>

<p>And some example for advanced parameters, e.g. <em>Mandatory</em> :</p>
<div class="code"><pre class="code literal-block"><span class="o">&lt;</span><span class="err">#</span>
<span class="w">    </span><span class="n">Script</span><span class="w"> </span><span class="n">description</span><span class="p">.</span>

<span class="w">    </span><span class="ow">Some</span><span class="w"> </span><span class="n">notes</span><span class="p">.</span>
<span class="err">#</span><span class="o">&gt;</span>
<span class="n">param</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">height</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">largest</span><span class="w"> </span><span class="k">column</span><span class="w"> </span><span class="k">without</span><span class="w"> </span><span class="k">top</span><span class="w"> </span><span class="n">bar</span>
<span class="w">    </span><span class="o">[</span><span class="n">Parameter(Mandatory=$true)</span><span class="o">]</span>
<span class="w">    </span><span class="o">[</span><span class="n">int</span><span class="o">]</span><span class="err">$</span><span class="n">h</span><span class="p">,</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">output</span><span class="w"> </span><span class="nc">image</span>
<span class="w">    </span><span class="o">[</span><span class="n">string</span><span class="o">]</span><span class="err">$</span><span class="nc">image</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'out.png'</span>
<span class="p">)</span>

<span class="k">Write</span><span class="o">-</span><span class="k">Host</span><span class="w"> </span><span class="ss">"$image $h"</span>
</pre></div>

<p>A default value will not work with a mandatory parameter. You can omit the
<code>=$true</code> for advanced parameters of type boolean <code>[Parameter(Mandatory)]</code>.</p>
<p><br></p>
<h3>Suggest</h3>
<p>You can use also the <code>$args</code> variable (that's like position parameters):</p>
<div class="code"><pre class="code literal-block">$<span class="nv">step</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">$a</span><span class="nv">rgs</span>[<span class="mi">0</span>]

$<span class="nv">iTunes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">New</span><span class="o">-</span><span class="nv">Object</span><span class="w"> </span><span class="o">-</span><span class="nv">ComObject</span><span class="w"> </span><span class="nv">iTunes</span>.<span class="nv">Application</span>

<span class="k">if</span><span class="w"> </span><span class="ss">(</span>$<span class="nv">iTunes</span>.<span class="nv">playerstate</span><span class="w"> </span><span class="o">-</span><span class="nv">eq</span><span class="w"> </span><span class="mi">1</span><span class="ss">)</span>
{
<span class="w">  </span>$<span class="nv">iTunes</span>.<span class="nv">PlayerPosition</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>$<span class="nv">iTunes</span>.<span class="nv">PlayerPosition</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>$<span class="nv">step</span>
}
</pre></div>

<p>Then it can be called like:</p>
<div class="code"><pre class="code literal-block">powershell.exe -file itunersforward.ps1 15
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/regex-matching-up-to-the-first-occurrence-of-a-character/" class="u-url">Regex: matching up to the first occurrence of a character</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/regex-matching-up-to-the-first-occurrence-of-a-character/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T04:41:48+08:00" itemprop="datePublished" title="2023-02-18 04:41">2023-02-18 04:41</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I am looking for a pattern that matches everything <strong>until</strong> the first
occurrence of a specific character, say a ";" - a <strong>semicolon</strong>.</p>
<p>I wrote this:</p>
<div class="code"><pre class="code literal-block">/^(.*);/
</pre></div>

<p>But it actually matches everything (including the semicolon) until the last
occurrence of a semicolon.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>You need</p>
<div class="code"><pre class="code literal-block">/^[^;]*/
</pre></div>

<p>The <code>[^;]</code> is a <em>character class</em> , it matches everything but a semicolon.</p>
<p>^ (start of line anchor) is added to the beginning of the regex so only the
first match on each line is captured. This may or may not be required,
depending on whether possible subsequent matches are desired.</p>
<p>To cite the <code>perlre</code> manpage:</p>
<blockquote>
<p>You can specify a character class, by enclosing a list of characters in [] ,
which will match any character from the list. If the first character after
the "[" is "^", the class matches any character not in the list.</p>
</blockquote>
<p>This should work in most regex dialects.</p>
<p><br></p>
<h3>Suggest</h3>
<p>Would;</p>
<div class="code"><pre class="code literal-block">/^(.*?);/
</pre></div>

<p>work?</p>
<p>The <code>?</code> is a lazy operator, so the regex grabs as little as possible before
matching the <code>;</code>.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-check-if-an-element-is-in-an-array/" class="u-url">How to check if an element is in an array</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-check-if-an-element-is-in-an-array/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T04:41:21+08:00" itemprop="datePublished" title="2023-02-18 04:41">2023-02-18 04:41</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>In Swift, how can I check if an element exists in an array? Xcode does not
have any suggestions for <code>contain</code>, <code>include</code>, or <code>has</code>, and a quick search
through the book turned up nothing. Any idea how to check for this? I know
that there is a method <code>find</code> that returns the index number, but is there a
method that returns a boolean like ruby's <code>#include?</code>?</p>
<p>Example of what I need:</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">elements</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
<span class="k">if</span><span class="w"> </span><span class="n">elements</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="o">//</span><span class="n">do</span><span class="w"> </span><span class="n">something</span>
<span class="p">}</span>
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<p><strong>Swift 2, 3, 4, 5:</strong></p>
<div class="code"><pre class="code literal-block"><span class="nv">let</span><span class="w"> </span><span class="nv">elements</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>[<span class="mi">1</span>,<span class="w"> </span><span class="mi">2</span>,<span class="w"> </span><span class="mi">3</span>,<span class="w"> </span><span class="mi">4</span>,<span class="w"> </span><span class="mi">5</span>]
<span class="k">if</span><span class="w"> </span><span class="nv">elements</span>.<span class="nv">contains</span><span class="ss">(</span><span class="mi">5</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">    </span><span class="nv">print</span><span class="ss">(</span><span class="s2">"yes"</span><span class="ss">)</span>
}
</pre></div>

<p><code>contains()</code> is a <em>protocol extension method</em> of <code>SequenceType</code> (for sequences
of <code>Equatable</code> elements) and not a global method as in earlier releases.</p>
<p><em>Remarks:</em></p>
<ul>
<li>This <code>contains()</code> method requires that the sequence elements adopt the <code>Equatable</code> protocol, compare e.g. Andrews's answer.</li>
<li>If the sequence elements are instances of a <code>NSObject</code> subclass then you have to override <code>isEqual:</code>, see NSObject subclass in Swift: hash vs hashValue, isEqual vs ==.</li>
<li>There is another – more general – <code>contains()</code> method which does not require the elements to be equatable and takes a predicate as an argument, see e.g. Shorthand to test if an object exists in an array for Swift?.</li>
</ul>
<p><strong>Swift older versions:</strong></p>
<div class="code"><pre class="code literal-block"><span class="nv">let</span><span class="w"> </span><span class="nv">elements</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>[<span class="mi">1</span>,<span class="mi">2</span>,<span class="mi">3</span>,<span class="mi">4</span>,<span class="mi">5</span>]
<span class="k">if</span><span class="w"> </span><span class="nv">contains</span><span class="ss">(</span><span class="nv">elements</span>,<span class="w"> </span><span class="mi">5</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">    </span><span class="nv">println</span><span class="ss">(</span><span class="s2">"yes"</span><span class="ss">)</span>
}
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>For those who came here looking for a find and remove an object from an array:</p>
<p><strong>Swift 1</strong></p>
<div class="code"><pre class="code literal-block"><span class="k">if</span><span class="w"> </span><span class="nv">let</span><span class="w"> </span><span class="nv">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">find</span><span class="ss">(</span><span class="nv">itemList</span>,<span class="w"> </span><span class="nv">item</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">    </span><span class="nv">itemList</span>.<span class="nv">removeAtIndex</span><span class="ss">(</span><span class="nv">index</span><span class="ss">)</span>
}
</pre></div>

<p><strong>Swift 2</strong></p>
<div class="code"><pre class="code literal-block"><span class="k">if</span><span class="w"> </span><span class="nv">let</span><span class="w"> </span><span class="nv">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">itemList</span>.<span class="nv">indexOf</span><span class="ss">(</span><span class="nv">item</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">    </span><span class="nv">itemList</span>.<span class="nv">removeAtIndex</span><span class="ss">(</span><span class="nv">index</span><span class="ss">)</span>
}
</pre></div>

<p><strong>Swift 3, 4</strong></p>
<div class="code"><pre class="code literal-block"><span class="k">if</span><span class="w"> </span><span class="nv">let</span><span class="w"> </span><span class="nv">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">itemList</span>.<span class="nv">index</span><span class="ss">(</span><span class="nv">of</span>:<span class="w"> </span><span class="nv">item</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">    </span><span class="nv">itemList</span>.<span class="nv">remove</span><span class="ss">(</span><span class="nv">at</span>:<span class="w"> </span><span class="nv">index</span><span class="ss">)</span>
}
</pre></div>

<p><strong>Swift 5.2</strong></p>
<div class="code"><pre class="code literal-block"><span class="k">if</span><span class="w"> </span><span class="nv">let</span><span class="w"> </span><span class="nv">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">itemList</span>.<span class="nv">firstIndex</span><span class="ss">(</span><span class="nv">of</span>:<span class="w"> </span><span class="nv">item</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">    </span><span class="nv">itemList</span>.<span class="nv">remove</span><span class="ss">(</span><span class="nv">at</span>:<span class="w"> </span><span class="nv">index</span><span class="ss">)</span>
}
</pre></div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-1244.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-1242.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
