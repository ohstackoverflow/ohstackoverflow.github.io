<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 1978) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-1978.html">
<link rel="prev" href="index-1979.html" type="text/html">
<link rel="next" href="index-1977.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-fix-unchecked-runtime-lasterror-the-message-port-closed-before-a-response-was-received-chrome-issue/" class="u-url">How to fix 'Unchecked runtime.lastError: The message port closed before a response was received' chrome issue?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-fix-unchecked-runtime-lasterror-the-message-port-closed-before-a-response-was-received-chrome-issue/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T13:55:32+08:00" itemprop="datePublished" title="2023-03-03 13:55">2023-03-03 13:55</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p><strong>Want to improve this post?</strong> Provide detailed answers to this question,
including citations and an explanation of why your answer is correct. Answers
without enough detail may be edited or deleted.</p>
<p>I'm using VueJS and Laravel for my project. This issue started to show lately
and it shows even in the old git branches.</p>
<p>This error only shows in the Chrome browser.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>I disabled all installed extensions in Chrome - works for me. I have now clear
console without errors.</p>
<p><br></p>
<h3>Suggest</h3>
<p>In case you're an extension developer who googled your way here trying to stop
causing this error:</p>
<p>The issue isn't CORB (as another answer here states) as blocked CORs manifest
as warnings like -</p>
<blockquote>
<p>Cross-Origin Read Blocking (CORB) blocked cross-origin response
https://www.example.com/example.html with MIME type text/html. See
https://www.chromestatus.com/feature/5629709824032768 for more details.</p>
</blockquote>
<p>The issue is most likely a mishandled async response to runtime.sendMessage.
As MDN says:</p>
<blockquote>
<p>To send an asynchronous response, there are two options:</p>
<ul>
<li>return true from the event listener. This keeps the sendResponse
function valid after the listener returns, so you can call it later.</li>
<li>return a Promise from the event listener, and resolve when you have the
response (or reject it in case of an error).
</li>
</ul>
</blockquote>
<p>When you send an async response but fail to use either of these mechanisms,
the supplied <code>sendResponse</code> argument to <code>sendMessage</code> goes out of scope and
the result is exactly as the error message says: your message port (the
message-passing apparatus) is closed before the response was received.</p>
<p>Webextension-polyfill authors have already written about it in June 2018.</p>
<p>So bottom line, if you see your extension causing these errors - inspect
closely all your onMessage listeners. Some of them probably need to start
returning promises <del>(marking them as async should be enough).</del> [Thanks
@vdegenne]</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/passing-a-2d-array-to-a-c-function/" class="u-url">Passing a 2D array to a C++ function</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/passing-a-2d-array-to-a-c-function/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T13:55:05+08:00" itemprop="datePublished" title="2023-03-03 13:55">2023-03-03 13:55</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I have a function which I want to take, as a parameter, a 2D array of variable
size.</p>
<p>So far I have this:</p>
<div class="code"><pre class="code literal-block"><span class="n">void</span><span class="w"> </span><span class="n">myFunction</span><span class="p">(</span><span class="k">double</span><span class="o">**</span><span class="w"> </span><span class="n">myArray</span><span class="p">)</span><span class="err">{</span>
<span class="w">     </span><span class="n">myArray</span><span class="o">[</span><span class="n">x</span><span class="o">][</span><span class="n">y</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
<span class="w">     </span><span class="n">etc</span><span class="p">...</span>
<span class="err">}</span>
</pre></div>

<p>And I have declared an array elsewhere in my code:</p>
<div class="code"><pre class="code literal-block">double anArray[10][10];
</pre></div>

<p>However, calling <code>myFunction(anArray)</code> gives me an error.</p>
<p>I do not want to copy the array when I pass it in. Any changes made in
<code>myFunction</code> should alter the state of <code>anArray</code>. If I understand correctly, I
only want to pass in as an argument a pointer to a 2D array. The function
needs to accept arrays of different sizes also. So for example, <code>[10][10]</code> and
<code>[5][5]</code>. How can I do this?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>There are three ways to pass a 2D array to a function:</p>
<ol>
<li>
<p>The parameter is a 2D array</p>
<div class="code"><pre class="code literal-block">int array[10][10];
</pre></div>

<p>void passFunc(int a[][10])
{
    // ...
}
passFunc(array);</p>
</li>
<li>
<p>The parameter is an array containing pointers</p>
<div class="code"><pre class="code literal-block">int *array[10];
</pre></div>

<p>for(int i = 0; i &lt; 10; i++)
    array[i] = new int[10];
void passFunc(int *a[10]) //Array containing pointers
{
    // ...
}
passFunc(array);</p>
</li>
<li>
<p>The parameter is a pointer to a pointer</p>
<div class="code"><pre class="code literal-block">int **array;
</pre></div>

<p>array = new int <em>[10];
for(int i = 0; i &lt;10; i++)
    array[i] = new int[10];
void passFunc(int </em>*a)
{
    // ...
}
passFunc(array);</p>
</li>
</ol>
<p><br></p>
<h3>Suggest</h3>
<h3>Fixed Size</h3>
<p><strong>1. Pass by reference</strong></p>
<div class="code"><pre class="code literal-block"><span class="n">template</span><span class="w"> </span><span class="o">&lt;</span><span class="n">size_t</span><span class="w"> </span><span class="k">rows</span><span class="p">,</span><span class="w"> </span><span class="n">size_t</span><span class="w"> </span><span class="n">cols</span><span class="o">&gt;</span>
<span class="n">void</span><span class="w"> </span><span class="n">process_2d_array_template</span><span class="p">(</span><span class="nc">int</span><span class="w"> </span><span class="p">(</span><span class="o">&amp;</span><span class="k">array</span><span class="p">)</span><span class="o">[</span><span class="n">rows</span><span class="o">][</span><span class="n">cols</span><span class="o">]</span><span class="p">)</span>
<span class="err">{</span>
<span class="w">    </span><span class="nl">std</span><span class="p">:</span><span class="err">:</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">__func__</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="nl">std</span><span class="p">:</span><span class="err">:</span><span class="n">endl</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">size_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="k">rows</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span>
<span class="w">    </span><span class="err">{</span>
<span class="w">        </span><span class="nl">std</span><span class="p">:</span><span class="err">:</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="ss">": "</span><span class="p">;</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">size_t</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">cols</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">j</span><span class="p">)</span>
<span class="w">            </span><span class="nl">std</span><span class="p">:</span><span class="err">:</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="k">array</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s1">'\t'</span><span class="p">;</span>
<span class="w">        </span><span class="nl">std</span><span class="p">:</span><span class="err">:</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="nl">std</span><span class="p">:</span><span class="err">:</span><span class="n">endl</span><span class="p">;</span>
<span class="w">    </span><span class="err">}</span>
<span class="err">}</span>
</pre></div>

<p>In C++ passing the array by reference without losing the dimension information
is probably the safest, since one needn't worry about the caller passing an
incorrect dimension (compiler flags when mismatching). However, this isn't
possible with dynamic (freestore) arrays; it works for automatic (usually
stack-living) arrays only i.e. the dimensionality should be known at compile
time.</p>
<p><strong>2. Pass by pointer</strong></p>
<div class="code"><pre class="code literal-block"><span class="n">void</span><span class="w"> </span><span class="n">process_2d_array_pointer</span><span class="p">(</span><span class="nc">int</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="k">array</span><span class="p">)</span><span class="o">[</span><span class="n">5</span><span class="o">][</span><span class="n">10</span><span class="o">]</span><span class="p">)</span>
<span class="err">{</span>
<span class="w">    </span><span class="nl">std</span><span class="p">:</span><span class="err">:</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">__func__</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="nl">std</span><span class="p">:</span><span class="err">:</span><span class="n">endl</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">size_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span>
<span class="w">    </span><span class="err">{</span>
<span class="w">        </span><span class="nl">std</span><span class="p">:</span><span class="err">:</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="ss">": "</span><span class="p">;</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">size_t</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">j</span><span class="p">)</span>
<span class="w">            </span><span class="nl">std</span><span class="p">:</span><span class="err">:</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="k">array</span><span class="p">)</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s1">'\t'</span><span class="p">;</span>
<span class="w">        </span><span class="nl">std</span><span class="p">:</span><span class="err">:</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="nl">std</span><span class="p">:</span><span class="err">:</span><span class="n">endl</span><span class="p">;</span>
<span class="w">    </span><span class="err">}</span><span class="w">    </span>
<span class="err">}</span>
</pre></div>

<p>The C equivalent of the previous method is passing the array by pointer. This
should not be confused with passing by the array's decayed pointer type
<strong>(3)</strong> , which is the common, popular method, albeit less safe than this one
but more flexible. Like <strong>(1)</strong> , use this method when all the dimensions of
the array is fixed and known at compile-time. Note that when calling the
function the array's address should be passed <code>process_2d_array_pointer(&amp;a)</code>
and not the address of the first element by decay
<code>process_2d_array_pointer(a)</code>.</p>
<h3>Variable Size</h3>
<p>These are inherited from C but are less safe, the compiler has no way of
checking, guaranteeing that the caller is passing the required dimensions. The
function only banks on what the caller passes in as the dimension(s). These
are more flexible than the above ones since arrays of different lengths can be
passed to them invariably.</p>
<p>It is to be remembered that there's no such thing as passing an array directly
to a function in C [while in C++ they can be passed as a reference <strong>(1)</strong> ];
<strong>(2)</strong> is passing a pointer to the array and not the array itself. Always
passing an array as-is becomes a pointer-copy operation which is facilitated
by array's nature of decaying into a pointer.</p>
<p><strong>3. Pass by (value) a pointer to the decayed type</strong></p>
<div class="code"><pre class="code literal-block"><span class="o">//</span><span class="w"> </span><span class="nc">int</span><span class="w"> </span><span class="k">array</span><span class="err">[]</span><span class="o">[</span><span class="n">10</span><span class="o">]</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="n">fancy</span><span class="w"> </span><span class="n">notation</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">thing</span>
<span class="n">void</span><span class="w"> </span><span class="n">process_2d_array</span><span class="p">(</span><span class="nc">int</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="k">array</span><span class="p">)</span><span class="o">[</span><span class="n">10</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">size_t</span><span class="w"> </span><span class="k">rows</span><span class="p">)</span>
<span class="err">{</span>
<span class="w">    </span><span class="nl">std</span><span class="p">:</span><span class="err">:</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">__func__</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="nl">std</span><span class="p">:</span><span class="err">:</span><span class="n">endl</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">size_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="k">rows</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span>
<span class="w">    </span><span class="err">{</span>
<span class="w">        </span><span class="nl">std</span><span class="p">:</span><span class="err">:</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="ss">": "</span><span class="p">;</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">size_t</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">j</span><span class="p">)</span>
<span class="w">            </span><span class="nl">std</span><span class="p">:</span><span class="err">:</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="k">array</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s1">'\t'</span><span class="p">;</span>
<span class="w">        </span><span class="nl">std</span><span class="p">:</span><span class="err">:</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="nl">std</span><span class="p">:</span><span class="err">:</span><span class="n">endl</span><span class="p">;</span>
<span class="w">    </span><span class="err">}</span>
<span class="err">}</span>
</pre></div>

<p>Although <code>int array[][10]</code> is allowed, I'd not recommend it over the above
syntax since the above syntax makes it clear that the identifier <code>array</code> is a
single pointer to an array of 10 integers, while this syntax <em>looks</em> like it's
a 2D array but is the same pointer to an array of 10 integers. Here we know
the number of elements in a single row (i.e. the column size, 10 here) but the
number of rows is unknown and hence to be passed as an argument. In this case
there's some safety since the compiler can flag when a pointer to an array
with second dimension not equal to 10 is passed. The first dimension is the
varying part and can be omitted. See here for the rationale on why only the
first dimension is allowed to be omitted.</p>
<p><strong>4. Pass by pointer to a pointer</strong></p>
<div class="code"><pre class="code literal-block"><span class="o">//</span><span class="w"> </span><span class="nc">int</span><span class="w"> </span><span class="o">*</span><span class="k">array</span><span class="o">[</span><span class="n">10</span><span class="o">]</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="n">fancy</span><span class="w"> </span><span class="n">notation</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">thing</span>
<span class="n">void</span><span class="w"> </span><span class="n">process_pointer_2_pointer</span><span class="p">(</span><span class="nc">int</span><span class="w"> </span><span class="o">**</span><span class="k">array</span><span class="p">,</span><span class="w"> </span><span class="n">size_t</span><span class="w"> </span><span class="k">rows</span><span class="p">,</span><span class="w"> </span><span class="n">size_t</span><span class="w"> </span><span class="n">cols</span><span class="p">)</span>
<span class="err">{</span>
<span class="w">    </span><span class="nl">std</span><span class="p">:</span><span class="err">:</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">__func__</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="nl">std</span><span class="p">:</span><span class="err">:</span><span class="n">endl</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">size_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="k">rows</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span>
<span class="w">    </span><span class="err">{</span>
<span class="w">        </span><span class="nl">std</span><span class="p">:</span><span class="err">:</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="ss">": "</span><span class="p">;</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">size_t</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">cols</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">j</span><span class="p">)</span>
<span class="w">            </span><span class="nl">std</span><span class="p">:</span><span class="err">:</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="k">array</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s1">'\t'</span><span class="p">;</span>
<span class="w">        </span><span class="nl">std</span><span class="p">:</span><span class="err">:</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="nl">std</span><span class="p">:</span><span class="err">:</span><span class="n">endl</span><span class="p">;</span>
<span class="w">    </span><span class="err">}</span>
<span class="err">}</span>
</pre></div>

<p>Again there's an alternative syntax of <code>int *array[10]</code> which is the same as
<code>int **array</code>. In this syntax the <code>[10]</code> is ignored as it decays into a
pointer thereby becoming <code>int **array</code>. Perhaps it is just a cue to the caller
that the passed array should have at least 10 columns, even then row count is
required. In any case the compiler doesn't flag for any length/size violations
(it only checks if the type passed is a pointer to pointer), hence requiring
both row and column counts as parameter makes sense here.</p>
<p><strong>Note:</strong> <em>(4) is the least safest option</em> since it hardly has any type check
and the most inconvenient. One cannot legitimately pass a 2D array to this
function; C-FAQ condemns the usual workaround of doing <code>int x[5][10];
process_pointer_2_pointer((int**)&amp;x[0][0], 5, 10);</code> as it may potentially lead
to undefined behaviour due to array flattening. The right way of passing an
array in this method brings us to the inconvenient part i.e. we need an
additional (surrogate) array of pointers with each of its element pointing to
the respective row of the actual, to-be-passed array; this surrogate is then
passed to the function (see below); all this for getting the same job done as
the above methods which are more safer, cleaner and perhaps faster.</p>
<p>Here's a driver program to test the above functions:</p>
<div class="code"><pre class="code literal-block"><span class="n">#include</span><span class="w"> </span><span class="o">&lt;</span><span class="n">iostream</span><span class="o">&gt;</span>

<span class="o">//</span><span class="w"> </span><span class="n">copy</span><span class="w"> </span><span class="n">above</span><span class="w"> </span><span class="n">functions</span><span class="w"> </span><span class="n">here</span>

<span class="nc">int</span><span class="w"> </span><span class="n">main</span><span class="p">()</span>
<span class="err">{</span>
<span class="w">    </span><span class="nc">int</span><span class="w"> </span><span class="n">a</span><span class="o">[</span><span class="n">5</span><span class="o">][</span><span class="n">10</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="err">}</span><span class="w"> </span><span class="err">}</span><span class="p">;</span>
<span class="w">    </span><span class="n">process_2d_array_template</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
<span class="w">    </span><span class="n">process_2d_array_pointer</span><span class="p">(</span><span class="o">&amp;</span><span class="n">a</span><span class="p">);</span><span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="o">&lt;--</span><span class="w"> </span><span class="n">notice</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">unusual</span><span class="w"> </span><span class="k">usage</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">addressof</span><span class="w"> </span><span class="p">(</span><span class="o">&amp;</span><span class="p">)</span><span class="w"> </span><span class="n">operator</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="k">array</span>
<span class="w">    </span><span class="n">process_2d_array</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span>
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="n">works</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="n">a</span><span class="s1">'s first dimension decays into a pointer thereby becoming int (*)[10]</span>

<span class="s1">    int *b[5];  // surrogate</span>
<span class="s1">    for (size_t i = 0; i &lt; 5; ++i)</span>
<span class="s1">    {</span>
<span class="s1">        b[i] = a[i];</span>
<span class="s1">    }</span>
<span class="s1">    // another popular way to define b: here the 2D arrays dims may be non-const, runtime var</span>
<span class="s1">    // int **b = new int*[5];</span>
<span class="s1">    // for (size_t i = 0; i &lt; 5; ++i) b[i] = new int[10];</span>
<span class="s1">    process_pointer_2_pointer(b, 5, 10);</span>
<span class="s1">    // process_2d_array(b, 5);</span>
<span class="s1">    // doesn'</span><span class="n">t</span><span class="w"> </span><span class="k">work</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="n">b</span><span class="err">'</span><span class="n">s</span><span class="w"> </span><span class="k">first</span><span class="w"> </span><span class="n">dimension</span><span class="w"> </span><span class="n">decays</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">pointer</span><span class="w"> </span><span class="n">thereby</span><span class="w"> </span><span class="n">becoming</span><span class="w"> </span><span class="nc">int</span><span class="o">**</span>
<span class="err">}</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/what-is-external-linkage-and-internal-linkage/" class="u-url">What is external linkage and internal linkage?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/what-is-external-linkage-and-internal-linkage/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T13:54:40+08:00" itemprop="datePublished" title="2023-03-03 13:54">2023-03-03 13:54</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I want to understand the external linkage and internal linkage and their
difference.</p>
<p>I also want to know the meaning of</p>
<blockquote>
<p><code>const</code> variables internally link by default unless otherwise declared as
<code>extern</code>.</p>
</blockquote>
<p><br><br></p>
<h2>Answer</h2>
<p>When you write an implementation file (<code>.cpp</code>, <code>.cxx</code>, etc) your compiler
generates a <strong>translation unit</strong>. This is the source file from your
implementation plus all the headers you <code>#include</code>d in it.</p>
<p><em>Internal linkage</em> refers to everything only <strong>in scope of a translation
unit</strong>.</p>
<p><em>External linkage</em> refers to things that exist beyond a particular translation
unit. In other words, <strong>accessible through the whole program</strong> , which is the
combination of all translation units (or object files).</p>
<p><br></p>
<h3>Suggest</h3>
<p>As dudewat said <em>external</em> linkage means the symbol (function or global
variable) is accessible throughout your program and <em>internal</em> linkage means
that it is only accessible in one translation unit.</p>
<p>You can explicitly control the linkage of a symbol by using the <code>extern</code> and
<code>static</code> keywords. If the linkage is not specified then the default linkage is
<code>extern</code> (external linkage) for non-<code>const</code> symbols and <code>static</code> (internal
linkage) for <code>const</code> symbols.</p>
<div class="code"><pre class="code literal-block"><span class="o">//</span><span class="w"> </span><span class="n">In</span><span class="w"> </span><span class="n">namespace</span><span class="w"> </span><span class="n">scope</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">global</span><span class="w"> </span><span class="n">scope</span><span class="o">.</span>
<span class="nb nb-Type">int</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">extern</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">default</span>
<span class="k">const</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">ci</span><span class="p">;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">default</span>
<span class="n">extern</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">eci</span><span class="p">;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">explicitly</span><span class="w"> </span><span class="n">extern</span>
<span class="k">static</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">si</span><span class="p">;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">explicitly</span><span class="w"> </span><span class="k">static</span>

<span class="o">//</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">goes</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">functions</span><span class="w"> </span><span class="p">(</span><span class="n">but</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">functions</span><span class="p">)</span><span class="o">.</span>
<span class="nb nb-Type">int</span><span class="w"> </span><span class="n">f</span><span class="p">();</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">extern</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">default</span>
<span class="k">static</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">sf</span><span class="p">();</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">explicitly</span><span class="w"> </span><span class="k">static</span>
</pre></div>

<p>Note that instead of using <code>static</code> (internal linkage), it is better to use
<em>anonymous</em> namespaces into which you can also put <code>class</code>es. Though they
allow <code>extern</code> linkage, anonymous namespaces are unreachable from other
translation units, making linkage <em>effectively</em> <code>static</code>.</p>
<div class="code"><pre class="code literal-block">namespace {
  int i; // extern by default but unreachable from other translation units
  class C; // extern by default but unreachable from other translation units
}
</pre></div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-1979.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-1977.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
