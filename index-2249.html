<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 2249) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-2249.html">
<link rel="prev" href="index-2250.html" type="text/html">
<link rel="next" href="index-2248.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/really-killing-a-process-in-windows/" class="u-url">Really killing a process in Windows</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/really-killing-a-process-in-windows/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T02:06:23+08:00" itemprop="datePublished" title="2023-03-04 02:06">2023-03-04 02:06</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Occasionally a program on a Windows machine goes crazy and just hangs. So I'll
call up the task manager and hit the "End Process" button for it. However,
this doesn't always work; if I try it enough times then it'll usually die
eventually, but I'd really like to be able to just kill it immediately. On
Linux I could just <code>kill -9</code> to guarantee that a process will die.</p>
<p>This also could be used for writing batch scripts and writing batch scripts is
programming.</p>
<p><strong>Is there some</strong> program or <strong>command that comes with Windows that will
always kill a process?</strong> A free third-party app would be fine, although I'd
prefer to be able to do this on machines I sit down at for the first time.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>"End Process" on the Processes-Tab calls <code>TerminateProcess</code> which is the most
ultimate way Windows knows to kill a process.</p>
<p>If it doesn't go away, it's currently locked waiting on some kernel resource
(probably a buggy driver) and there is nothing (short of a reboot) you could
do to make the process go away.</p>
<p>Have a look at this blog-entry from wayback when:
http://blogs.technet.com/markrussinovich/archive/2005/08/17/unkillable-
processes.aspx</p>
<p>Unix based systems like Linux also have that problem where processes could
survive a <code>kill -9</code> if they are in what's known as "Uninterruptible sleep"
(shown by top and ps as state <code>D</code>) at which point the processes sleep so well
that they can't process incoming signals (which is what <code>kill</code> does - sending
signals).</p>
<p>Normally, Uninterruptible sleep should not last long, but as under Windows,
broken drivers or broken userpace programs (<code>vfork</code> without <code>exec</code>) can end up
sleeping in <code>D</code> forever.</p>
<p><br></p>
<h3>Suggest</h3>
<div class="code"><pre class="code literal-block">taskkill /im myprocess.exe /f
</pre></div>

<p>The "/f" is for "force". If you know the PID, then you can specify that, as
in:</p>
<div class="code"><pre class="code literal-block">taskkill /pid 1234 /f
</pre></div>

<p>Lots of other options are possible, just type taskkill /? for all of them. The
"/t" option kills a process and any child processes; that may be useful to
you.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/introducing-foreign-key-constraint-may-cause-cycles-or-multiple-cascade-paths-why/" class="u-url">Introducing FOREIGN KEY constraint may cause cycles or multiple cascade paths - why?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/introducing-foreign-key-constraint-may-cause-cycles-or-multiple-cascade-paths-why/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T02:04:45+08:00" itemprop="datePublished" title="2023-03-04 02:04">2023-03-04 02:04</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I've been wrestling with this for a while and can't quite figure out what's
happening. I have a Card entity which contains Sides (usually 2) - and both
Cards and Sides have a Stage. I'm using EF Codefirst migrations and the
migrations are failing with this error:</p>
<blockquote>
<p>Introducing FOREIGN KEY constraint 'FK_dbo.Sides_dbo.Cards_CardId' on table
'Sides' may cause cycles or multiple cascade paths. Specify ON DELETE NO
ACTION or ON UPDATE NO ACTION, or modify other FOREIGN KEY constraints.</p>
</blockquote>
<p>Here's my <strong>Card</strong> entity:</p>
<div class="code"><pre class="code literal-block"><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">Card</span>
<span class="err">{</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="n">Card</span><span class="p">()</span>
<span class="w">    </span><span class="err">{</span>
<span class="w">        </span><span class="n">Sides</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Collection</span><span class="o">&lt;</span><span class="n">Side</span><span class="o">&gt;</span><span class="p">();</span>
<span class="w">        </span><span class="n">Stage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Stage</span><span class="p">.</span><span class="n">ONE</span><span class="p">;</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="o">[</span><span class="n">Key</span><span class="o">]</span>
<span class="w">    </span><span class="o">[</span><span class="n">Required</span><span class="o">]</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="n">virtual</span><span class="w"> </span><span class="nc">int</span><span class="w"> </span><span class="n">CardId</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="err">}</span>

<span class="w">    </span><span class="o">[</span><span class="n">Required</span><span class="o">]</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="n">virtual</span><span class="w"> </span><span class="n">Stage</span><span class="w"> </span><span class="n">Stage</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="err">}</span>

<span class="w">    </span><span class="o">[</span><span class="n">Required</span><span class="o">]</span>
<span class="w">    </span><span class="o">[</span><span class="n">ForeignKey("CardId")</span><span class="o">]</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="n">virtual</span><span class="w"> </span><span class="n">ICollection</span><span class="o">&lt;</span><span class="n">Side</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Sides</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="err">}</span>
<span class="err">}</span>
</pre></div>

<p>Here's my <strong>Side</strong> entity:</p>
<div class="code"><pre class="code literal-block"><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">Side</span>
<span class="err">{</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="n">Side</span><span class="p">()</span>
<span class="w">    </span><span class="err">{</span>
<span class="w">        </span><span class="n">Stage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Stage</span><span class="p">.</span><span class="n">ONE</span><span class="p">;</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="o">[</span><span class="n">Key</span><span class="o">]</span>
<span class="w">    </span><span class="o">[</span><span class="n">Required</span><span class="o">]</span><span class="w">     </span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="n">virtual</span><span class="w"> </span><span class="nc">int</span><span class="w"> </span><span class="n">SideId</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="err">}</span>

<span class="w">    </span><span class="o">[</span><span class="n">Required</span><span class="o">]</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="n">virtual</span><span class="w"> </span><span class="n">Stage</span><span class="w"> </span><span class="n">Stage</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="err">}</span>

<span class="w">    </span><span class="o">[</span><span class="n">Required</span><span class="o">]</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="nc">int</span><span class="w"> </span><span class="n">CardId</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="err">}</span>

<span class="w">    </span><span class="o">[</span><span class="n">ForeignKey("CardId")</span><span class="o">]</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="n">virtual</span><span class="w"> </span><span class="n">Card</span><span class="w"> </span><span class="n">Card</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="err">}</span>

<span class="err">}</span>
</pre></div>

<p>And here's my <strong>Stage</strong> entity:</p>
<div class="code"><pre class="code literal-block"><span class="nv">public</span><span class="w"> </span><span class="nv">class</span><span class="w"> </span><span class="nv">Stage</span>
{
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="nv">Zero</span>
<span class="w">    </span><span class="nv">public</span><span class="w"> </span><span class="nv">static</span><span class="w"> </span><span class="nv">readonly</span><span class="w"> </span><span class="nv">Stage</span><span class="w"> </span><span class="nv">ONE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">Stage</span><span class="ss">(</span><span class="nv">new</span><span class="w"> </span><span class="nv">TimeSpan</span><span class="ss">(</span><span class="mi">0</span>,<span class="w"> </span><span class="mi">0</span>,<span class="w"> </span><span class="mi">0</span><span class="ss">)</span>,<span class="w"> </span><span class="s2">"ONE"</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="nv">Ten</span><span class="w"> </span><span class="nv">seconds</span>
<span class="w">    </span><span class="nv">public</span><span class="w"> </span><span class="nv">static</span><span class="w"> </span><span class="nv">readonly</span><span class="w"> </span><span class="nv">Stage</span><span class="w"> </span><span class="nv">TWO</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">Stage</span><span class="ss">(</span><span class="nv">new</span><span class="w"> </span><span class="nv">TimeSpan</span><span class="ss">(</span><span class="mi">0</span>,<span class="w"> </span><span class="mi">0</span>,<span class="w"> </span><span class="mi">10</span><span class="ss">)</span>,<span class="w"> </span><span class="s2">"TWO"</span><span class="ss">)</span><span class="c1">;</span>

<span class="w">    </span><span class="nv">public</span><span class="w"> </span><span class="nv">static</span><span class="w"> </span><span class="nv">IEnumerable</span><span class="o">&lt;</span><span class="nv">Stage</span><span class="o">&gt;</span><span class="w"> </span><span class="nv">Values</span>
<span class="w">    </span>{
<span class="w">        </span><span class="nv">get</span>
<span class="w">        </span>{
<span class="w">            </span><span class="nv">yield</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nv">ONE</span><span class="c1">;</span>
<span class="w">            </span><span class="nv">yield</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nv">TWO</span><span class="c1">;</span>
<span class="w">        </span>}

<span class="w">    </span>}

<span class="w">    </span><span class="nv">public</span><span class="w"> </span><span class="nv">int</span><span class="w"> </span><span class="nv">StageId</span><span class="w"> </span>{<span class="w"> </span><span class="nv">get</span><span class="c1">; set; }</span>
<span class="w">    </span><span class="nv">private</span><span class="w"> </span><span class="nv">readonly</span><span class="w"> </span><span class="nv">TimeSpan</span><span class="w"> </span><span class="nv">span</span><span class="c1">;</span>
<span class="w">    </span><span class="nv">public</span><span class="w"> </span><span class="nv">string</span><span class="w"> </span><span class="nv">Title</span><span class="w"> </span>{<span class="w"> </span><span class="nv">get</span><span class="c1">; set; }</span>

<span class="w">    </span><span class="nv">Stage</span><span class="ss">(</span><span class="nv">TimeSpan</span><span class="w"> </span><span class="nv">span</span>,<span class="w"> </span><span class="nv">string</span><span class="w"> </span><span class="nv">title</span><span class="ss">)</span>
<span class="w">    </span>{
<span class="w">        </span><span class="nv">this</span>.<span class="nv">span</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">span</span><span class="c1">;</span>
<span class="w">        </span><span class="nv">this</span>.<span class="nv">Title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">title</span><span class="c1">;</span>
<span class="w">    </span>}

<span class="w">    </span><span class="nv">public</span><span class="w"> </span><span class="nv">TimeSpan</span><span class="w"> </span><span class="nv">Span</span><span class="w"> </span>{<span class="w"> </span><span class="nv">get</span><span class="w"> </span>{<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nv">span</span><span class="c1">; } }</span>
}
</pre></div>

<p>What's odd is that if I add the following to my Stage class:</p>
<div class="code"><pre class="code literal-block">    public int? SideId { get; set; }
    [ForeignKey("SideId")]
    public virtual Side Side { get; set; }
</pre></div>

<p>The migration runs successfully. If I open up SSMS and look at the tables, I
can see that <code>Stage_StageId</code> has been added to <code>Cards</code> (as expected/desired),
however <code>Sides</code> contains no reference to <code>Stage</code> (not expected).</p>
<p>If I then add</p>
<div class="code"><pre class="code literal-block"><span class="w">    </span><span class="o">[</span><span class="n">Required</span><span class="o">]</span>
<span class="w">    </span><span class="o">[</span><span class="n">ForeignKey("StageId")</span><span class="o">]</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="n">virtual</span><span class="w"> </span><span class="n">Stage</span><span class="w"> </span><span class="n">Stage</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="err">}</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="nc">int</span><span class="w"> </span><span class="n">StageId</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="err">}</span>
</pre></div>

<p>To my Side class, I see <code>StageId</code> column added to my <code>Side</code> table.</p>
<p>This is working, but now throughout my application, any reference to <code>Stage</code>
contains a <code>SideId</code>, which is in some cases totally irrelevant. <strong>I'd like to
just give my<code>Card</code> and <code>Side</code> entities a <code>Stage</code> property based on the above
Stage class without polluting the stage class with reference properties if
possible</strong>... what am I doing wrong?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Because <code>Stage</code> is <em>required</em> , all one-to-many relationships where <code>Stage</code> is
involved will have cascading delete enabled by default. It means, if you
delete a <code>Stage</code> entity</p>
<ul>
<li>the delete will cascade directly to <code>Side</code>
</li>
<li>the delete will cascade directly to <code>Card</code> and because <code>Card</code> and <code>Side</code> have a required one-to-many relationship with cascading delete enabled by default again it will then cascade from <code>Card</code> to <code>Side</code>
</li>
</ul>
<p>So, you have two cascading delete paths from <code>Stage</code> to <code>Side</code> - which causes
the exception.</p>
<p>You must either make the <code>Stage</code> optional in at least one of the entities
(i.e. remove the <code>[Required]</code> attribute from the <code>Stage</code> properties) or
disable cascading delete with Fluent API (not possible with data annotations):</p>
<div class="code"><pre class="code literal-block">modelBuilder.Entity&lt;Card&gt;()
    .HasRequired(c =&gt; c.Stage)
    .WithMany()
    .WillCascadeOnDelete(false);

modelBuilder.Entity&lt;Side&gt;()
    .HasRequired(s =&gt; s.Stage)
    .WithMany()
    .WillCascadeOnDelete(false);
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>I had a table that had a circular relationship with others and I was getting
the same error. Turns out it is about the foreign key which was not nullable.
If the key is not nullable the related object must be deleted, and circular
relations don't allow that. So use nullable foreign key.</p>
<div class="code"><pre class="code literal-block"><span class="k">[ForeignKey("StageId")]</span>
<span class="na">public virtual Stage Stage { get; set; }</span>
<span class="na">public int? StageId { get; set; }</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/should-i-check-in-folder-node-modules-to-git-when-creating-a-node-js-app-on-heroku/" class="u-url">Should I check in folder "node_modules" to Git when creating a Node.js app on Heroku?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/should-i-check-in-folder-node-modules-to-git-when-creating-a-node-js-app-on-heroku/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T02:03:04+08:00" itemprop="datePublished" title="2023-03-04 02:03">2023-03-04 02:03</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I followed the basic <em>getting started</em> instructions for Node.js on Heroku
here:</p>
<p>https://devcenter.heroku.com/categories/nodejs</p>
<p>These instruction don't tell you to create a .gitignore node_modules, and
therefore imply that folder <em>node_modules</em> should be checked in to Git. When I
included <em>node_modules</em> in Git repository, my getting started application ran
correctly.</p>
<p>When I followed the more advanced example at:</p>
<ul>
<li><em>Building a Real-time, Polyglot Application with Node.js, Ruby, MongoDB and Socket.IO</em></li>
<li>https://github.com/mongolab/tractorpush-server (source)</li>
</ul>
<p>It instructed me to add folder <em>node_modules</em> to file <em>.gitignore</em>. So I
removed folder <em>node_modules</em> from Git, added it to file <em>.gitignore</em> , and
then redeployed. This time the deployed failed like so:</p>
<div class="code"><pre class="code literal-block"><span class="o">-----&gt;</span><span class="w"> </span><span class="n">Heroku</span><span class="w"> </span><span class="n">receiving</span><span class="w"> </span><span class="n">push</span>
<span class="o">-----&gt;</span><span class="w"> </span><span class="n">Node</span><span class="p">.</span><span class="n">js</span><span class="w"> </span><span class="n">app</span><span class="w"> </span><span class="n">detected</span>
<span class="o">-----&gt;</span><span class="w"> </span><span class="n">Resolving</span><span class="w"> </span><span class="n">engine</span><span class="w"> </span><span class="n">versions</span>
<span class="w">       </span><span class="n">Using</span><span class="w"> </span><span class="n">Node</span><span class="p">.</span><span class="n">js</span><span class="w"> </span><span class="n">version</span><span class="o">:</span><span class="w"> </span><span class="mf">0.8.2</span>
<span class="w">       </span><span class="n">Using</span><span class="w"> </span><span class="n">npm</span><span class="w"> </span><span class="n">version</span><span class="o">:</span><span class="w"> </span><span class="mf">1.0.106</span>
<span class="o">-----&gt;</span><span class="w"> </span><span class="n">Fetching</span><span class="w"> </span><span class="n">Node</span><span class="p">.</span><span class="n">js</span><span class="w"> </span><span class="n">binaries</span>
<span class="o">-----&gt;</span><span class="w"> </span><span class="n">Vendoring</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">slug</span>
<span class="o">-----&gt;</span><span class="w"> </span><span class="n">Installing</span><span class="w"> </span><span class="n">dependencies</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">npm</span>
<span class="w">       </span><span class="nl">Error</span><span class="p">:</span><span class="w"> </span><span class="n">npm</span><span class="w"> </span><span class="n">doesn</span><span class="err">'</span><span class="n">t</span><span class="w"> </span><span class="n">work</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="n">v0</span><span class="mf">.8.2</span>
<span class="w">       </span><span class="nl">Required</span><span class="p">:</span><span class="w"> </span><span class="n">node</span><span class="mf">@0.4</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">0.6</span>
<span class="w">           </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">node</span><span class="o">-</span><span class="n">npm</span><span class="mi">-5</span><span class="n">iGk</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">npm</span><span class="o">-</span><span class="n">cli</span><span class="p">.</span><span class="n">js</span><span class="o">:</span><span class="mi">57</span><span class="o">:</span><span class="mi">23</span>
<span class="w">           </span><span class="n">at</span><span class="w"> </span><span class="n">Object</span><span class="p">.</span><span class="o">&lt;</span><span class="n">anonymous</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">node</span><span class="o">-</span><span class="n">npm</span><span class="mi">-5</span><span class="n">iGk</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">npm</span><span class="o">-</span><span class="n">cli</span><span class="p">.</span><span class="n">js</span><span class="o">:</span><span class="mi">77</span><span class="o">:</span><span class="mi">3</span><span class="p">)</span>
<span class="w">           </span><span class="n">at</span><span class="w"> </span><span class="n">Module</span><span class="p">.</span><span class="n">_compile</span><span class="w"> </span><span class="p">(</span><span class="n">module</span><span class="p">.</span><span class="n">js</span><span class="o">:</span><span class="mi">449</span><span class="o">:</span><span class="mi">26</span><span class="p">)</span>
<span class="w">           </span><span class="n">at</span><span class="w"> </span><span class="n">Object</span><span class="p">.</span><span class="n">Module</span><span class="p">.</span><span class="n">_extensions</span><span class="p">..</span><span class="n">js</span><span class="w"> </span><span class="p">(</span><span class="n">module</span><span class="p">.</span><span class="n">js</span><span class="o">:</span><span class="mi">467</span><span class="o">:</span><span class="mi">10</span><span class="p">)</span>
<span class="w">           </span><span class="n">at</span><span class="w"> </span><span class="n">Module</span><span class="p">.</span><span class="n">load</span><span class="w"> </span><span class="p">(</span><span class="n">module</span><span class="p">.</span><span class="n">js</span><span class="o">:</span><span class="mi">356</span><span class="o">:</span><span class="mi">32</span><span class="p">)</span>
<span class="w">           </span><span class="n">at</span><span class="w"> </span><span class="n">Function</span><span class="p">.</span><span class="n">Module</span><span class="p">.</span><span class="n">_load</span><span class="w"> </span><span class="p">(</span><span class="n">module</span><span class="p">.</span><span class="n">js</span><span class="o">:</span><span class="mi">312</span><span class="o">:</span><span class="mi">12</span><span class="p">)</span>
<span class="w">           </span><span class="n">at</span><span class="w"> </span><span class="n">Module</span><span class="p">.</span><span class="n">require</span><span class="w"> </span><span class="p">(</span><span class="n">module</span><span class="p">.</span><span class="n">js</span><span class="o">:</span><span class="mi">362</span><span class="o">:</span><span class="mi">17</span><span class="p">)</span>
<span class="w">           </span><span class="n">at</span><span class="w"> </span><span class="n">require</span><span class="w"> </span><span class="p">(</span><span class="n">module</span><span class="p">.</span><span class="n">js</span><span class="o">:</span><span class="mi">378</span><span class="o">:</span><span class="mi">17</span><span class="p">)</span>
<span class="w">           </span><span class="n">at</span><span class="w"> </span><span class="n">Object</span><span class="p">.</span><span class="o">&lt;</span><span class="n">anonymous</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">node</span><span class="o">-</span><span class="n">npm</span><span class="mi">-5</span><span class="n">iGk</span><span class="o">/</span><span class="n">cli</span><span class="p">.</span><span class="n">js</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="mi">1</span><span class="p">)</span>
<span class="w">           </span><span class="n">at</span><span class="w"> </span><span class="n">Module</span><span class="p">.</span><span class="n">_compile</span><span class="w"> </span><span class="p">(</span><span class="n">module</span><span class="p">.</span><span class="n">js</span><span class="o">:</span><span class="mi">449</span><span class="o">:</span><span class="mi">26</span><span class="p">)</span>
<span class="w">       </span><span class="nl">Error</span><span class="p">:</span><span class="w"> </span><span class="n">npm</span><span class="w"> </span><span class="n">doesn</span><span class="err">'</span><span class="n">t</span><span class="w"> </span><span class="n">work</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="n">v0</span><span class="mf">.8.2</span>
<span class="w">       </span><span class="nl">Required</span><span class="p">:</span><span class="w"> </span><span class="n">node</span><span class="mf">@0.4</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">0.6</span>
<span class="w">           </span><span class="n">at</span><span class="w"> </span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">node</span><span class="o">-</span><span class="n">npm</span><span class="mi">-5</span><span class="n">iGk</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">npm</span><span class="o">-</span><span class="n">cli</span><span class="p">.</span><span class="n">js</span><span class="o">:</span><span class="mi">57</span><span class="o">:</span><span class="mi">23</span>
<span class="w">           </span><span class="n">at</span><span class="w"> </span><span class="n">Object</span><span class="p">.</span><span class="o">&lt;</span><span class="n">anonymous</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">node</span><span class="o">-</span><span class="n">npm</span><span class="mi">-5</span><span class="n">iGk</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">npm</span><span class="o">-</span><span class="n">cli</span><span class="p">.</span><span class="n">js</span><span class="o">:</span><span class="mi">77</span><span class="o">:</span><span class="mi">3</span><span class="p">)</span>
<span class="w">           </span><span class="n">at</span><span class="w"> </span><span class="n">Module</span><span class="p">.</span><span class="n">_compile</span><span class="w"> </span><span class="p">(</span><span class="n">module</span><span class="p">.</span><span class="n">js</span><span class="o">:</span><span class="mi">449</span><span class="o">:</span><span class="mi">26</span><span class="p">)</span>
<span class="w">           </span><span class="n">at</span><span class="w"> </span><span class="n">Object</span><span class="p">.</span><span class="n">Module</span><span class="p">.</span><span class="n">_extensions</span><span class="p">..</span><span class="n">js</span><span class="w"> </span><span class="p">(</span><span class="n">module</span><span class="p">.</span><span class="n">js</span><span class="o">:</span><span class="mi">467</span><span class="o">:</span><span class="mi">10</span><span class="p">)</span>
<span class="w">           </span><span class="n">at</span><span class="w"> </span><span class="n">Module</span><span class="p">.</span><span class="n">load</span><span class="w"> </span><span class="p">(</span><span class="n">module</span><span class="p">.</span><span class="n">js</span><span class="o">:</span><span class="mi">356</span><span class="o">:</span><span class="mi">32</span><span class="p">)</span>
<span class="w">           </span><span class="n">at</span><span class="w"> </span><span class="n">Function</span><span class="p">.</span><span class="n">Module</span><span class="p">.</span><span class="n">_load</span><span class="w"> </span><span class="p">(</span><span class="n">module</span><span class="p">.</span><span class="n">js</span><span class="o">:</span><span class="mi">312</span><span class="o">:</span><span class="mi">12</span><span class="p">)</span>
<span class="w">           </span><span class="n">at</span><span class="w"> </span><span class="n">Module</span><span class="p">.</span><span class="n">require</span><span class="w"> </span><span class="p">(</span><span class="n">module</span><span class="p">.</span><span class="n">js</span><span class="o">:</span><span class="mi">362</span><span class="o">:</span><span class="mi">17</span><span class="p">)</span>
<span class="w">           </span><span class="n">at</span><span class="w"> </span><span class="n">require</span><span class="w"> </span><span class="p">(</span><span class="n">module</span><span class="p">.</span><span class="n">js</span><span class="o">:</span><span class="mi">378</span><span class="o">:</span><span class="mi">17</span><span class="p">)</span>
<span class="w">           </span><span class="n">at</span><span class="w"> </span><span class="n">Object</span><span class="p">.</span><span class="o">&lt;</span><span class="n">anonymous</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">node</span><span class="o">-</span><span class="n">npm</span><span class="mi">-5</span><span class="n">iGk</span><span class="o">/</span><span class="n">cli</span><span class="p">.</span><span class="n">js</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="mi">1</span><span class="p">)</span>
<span class="w">           </span><span class="n">at</span><span class="w"> </span><span class="n">Module</span><span class="p">.</span><span class="n">_compile</span><span class="w"> </span><span class="p">(</span><span class="n">module</span><span class="p">.</span><span class="n">js</span><span class="o">:</span><span class="mi">449</span><span class="o">:</span><span class="mi">26</span><span class="p">)</span>
<span class="w">       </span><span class="n">Dependencies</span><span class="w"> </span><span class="n">installed</span>
<span class="o">-----&gt;</span><span class="w"> </span><span class="n">Discovering</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">types</span>
<span class="w">       </span><span class="n">Procfile</span><span class="w"> </span><span class="n">declares</span><span class="w"> </span><span class="n">types</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">mongod</span><span class="p">,</span><span class="w"> </span><span class="n">redis</span><span class="p">,</span><span class="w"> </span><span class="n">web</span>
<span class="o">-----&gt;</span><span class="w"> </span><span class="n">Compiled</span><span class="w"> </span><span class="n">slug</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="mf">5.0</span><span class="n">MB</span>
<span class="o">-----&gt;</span><span class="w"> </span><span class="n">Launching</span><span class="p">...</span><span class="w"> </span><span class="n">done</span><span class="p">,</span><span class="w"> </span><span class="n">v9</span>
</pre></div>

<p>Running "heroku ps" confirms the crash. OK, no problem, so I rolled back the
change, added folder <em>node_module</em> back to the Git repository and removed it
from file <em>.gitignore</em>. However, even after reverting, I still get the same
error message on deploy, but now the application is running correctly again.
Running "heroku ps" tells me the application is running.</p>
<p>What's the right way to do this? Include folder <em>node_modules</em> or not? And why
would I still be getting the error message when I rollback? My guess is the
Git repository is in a bad state on the Heroku side.</p>
<p><br><br></p>
<h2>Answer</h2>
<h3>Second Update</h3>
<p>The FAQ is not available anymore.</p>
<p>From the documentation of <code>shrinkwrap</code>:</p>
<blockquote>
<p>If you wish to lock down the specific bytes included in a package, for
example to have 100% confidence in being able to reproduce a deployment or
build, then you ought to check your dependencies into source control, or
pursue some other mechanism that can verify contents rather than versions.</p>
</blockquote>
<p>Shannon and Steven mentioned this before but I think it should be part of the
accepted answer.</p>
<hr>
<h3>Update</h3>
<p>The source listed for the below recommendation has been updated. They are no
longer recommending the <code>node_modules</code> folder be committed.</p>
<blockquote>
<p>Usually, no. Allow npm to resolve dependencies for your packages.</p>
<p>For packages you deploy, such as websites and apps, you should use npm
shrinkwrap to lock down your full dependency tree:</p>
<p>https://docs.npmjs.com/cli/shrinkwrap</p>
</blockquote>
<hr>
<h3>Original Post</h3>
<p>For reference, npm FAQ answers your question clearly:</p>
<blockquote>
<p>Check node_modules into git for things you deploy, such as websites and
apps. Do not check node_modules into git for libraries and modules intended
to be reused. Use npm to manage dependencies in your dev environment, but
not in your deployment scripts.</p>
</blockquote>
<p>and for some good rationale for this, read Mikeal Rogers' post on this.</p>
<hr>
<p>Source: https://docs.npmjs.com/misc/faq#should-i-check-my-node-modules-folder-
into-git</p>
<p><br></p>
<h3>Suggest</h3>
<p>My biggest concern with <em>not</em> checking folder <em>node_modules</em> into Git is that
10 years down the road, when your production application is still in use, npm
may not be around. Or npm might become corrupted; or the maintainers might
decide to remove the library that you rely on from their repository; or the
version you use might be trimmed out.</p>
<p>This can be mitigated with repository managers like Maven, because you can
always use your own local Nexus (Sonatype) or Artifactory to maintain a mirror
with the packages that you use. As far as I understand, such a system doesn't
exist for npm. The same goes for client-side library managers like Bower and
Jam.js.</p>
<p>If you've committed the files to your own Git repository, then you can update
them when you like, and you have the comfort of repeatable builds and the
knowledge that your application won't break because of some third-party
action.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-2250.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-2248.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
