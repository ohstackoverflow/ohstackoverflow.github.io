<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 2281) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-2281.html">
<link rel="prev" href="index-2282.html" type="text/html">
<link rel="next" href="index-2280.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/typescript-objects-as-dictionary-types-as-in-c/" class="u-url">TypeScript Objects as Dictionary types as in C#</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/typescript-objects-as-dictionary-types-as-in-c/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T04:30:25+08:00" itemprop="datePublished" title="2023-03-04 04:30">2023-03-04 04:30</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I have some JavaScript code that uses objects as dictionaries; for example a
'person' object will hold a some personal details keyed off the email address.</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">people</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="o">&lt;</span><span class="n">email</span><span class="o">&gt;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="o">&lt;</span><span class="s1">'some personal data'</span><span class="o">&gt;</span><span class="p">};</span>

<span class="n">adding</span><span class="w">   </span><span class="o">&gt;</span><span class="w"> </span><span class="s2">"people[&lt;email&gt;] = &lt;data&gt;;"</span><span class="w"> </span>
<span class="n">getting</span><span class="w">  </span><span class="o">&gt;</span><span class="w"> </span><span class="s2">"var data = people[&lt;email&gt;];"</span><span class="w"> </span>
<span class="n">deleting</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="s2">"delete people[&lt;email&gt;];"</span>
</pre></div>

<p>Is it possible to describe this in Typescript? or do I have to use an Array?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>In newer versions of typescript you can use:</p>
<div class="code"><pre class="code literal-block">type Customers = Record&lt;string, Customer&gt;
</pre></div>

<p>In older versions you can use:</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">map</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">[</span><span class="n">email</span><span class="p">:</span><span class="w"> </span><span class="n">string</span><span class="p">]:</span><span class="w"> </span><span class="n">Customer</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">};</span>
<span class="n">map</span><span class="p">[</span><span class="s1">'foo@gmail.com'</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">Customer</span><span class="p">();</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">OK</span>
<span class="n">map</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">Customer</span><span class="p">();</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">Not</span><span class="w"> </span><span class="n">OK</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">string</span>
<span class="n">map</span><span class="p">[</span><span class="s1">'bar@hotmail.com'</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'x'</span><span class="p">;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">Not</span><span class="w"> </span><span class="n">OK</span><span class="p">,</span><span class="w"> </span><span class="s1">'x'</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">customer</span>
</pre></div>

<p>You can also make an interface if you don't want to type that whole type
annotation out every time:</p>
<div class="code"><pre class="code literal-block"><span class="n">interface</span><span class="w"> </span><span class="n">StringToCustomerMap</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="p">[</span><span class="n">email</span><span class="p">:</span><span class="w"> </span><span class="n">string</span><span class="p">]:</span><span class="w"> </span><span class="n">Customer</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">var</span><span class="w"> </span><span class="n">map</span><span class="p">:</span><span class="w"> </span><span class="n">StringToCustomerMap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">};</span>
<span class="o">//</span><span class="w"> </span><span class="n">Equivalent</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">above</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>In addition to using an map- <em>like</em> object, there has been an actual <code>Map</code>
object for some time now, which is available in TypeScript when compiling to
ES6, or when using a polyfill with the ES6 type-definitions:</p>
<div class="code"><pre class="code literal-block">let people = new Map&lt;string, Person&gt;();
</pre></div>

<p>It supports the same functionality as <code>Object</code>, and more, with a slightly
different syntax:</p>
<div class="code"><pre class="code literal-block"><span class="c1">// Adding an item (a key-value pair):</span>
<span class="n">people</span><span class="p">.</span><span class="k">set</span><span class="p">(</span><span class="s">"John"</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">firstName</span><span class="p">:</span><span class="w"> </span><span class="s">"John"</span><span class="p">,</span><span class="w"> </span><span class="n">lastName</span><span class="p">:</span><span class="w"> </span><span class="s">"Doe"</span><span class="w"> </span><span class="p">});</span>

<span class="c1">// Checking for the presence of a key:</span>
<span class="n">people</span><span class="p">.</span><span class="n">has</span><span class="p">(</span><span class="s">"John"</span><span class="p">);</span><span class="w"> </span><span class="c1">// true</span>

<span class="c1">// Retrieving a value by a key:</span>
<span class="n">people</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="s">"John"</span><span class="p">).</span><span class="n">lastName</span><span class="p">;</span><span class="w"> </span><span class="c1">// "Doe"</span>

<span class="c1">// Deleting an item by a key:</span>
<span class="n">people</span><span class="p">.</span><span class="nb">delete</span><span class="p">(</span><span class="s">"John"</span><span class="p">);</span>
</pre></div>

<p>This alone has several advantages over using a map- <em>like</em> object, such as:</p>
<ul>
<li>Support for non-string based keys, e.g. numbers or objects, neither of which are supported by <code>Object</code> (no, <code>Object</code> does not support numbers, it converts them to strings)</li>
<li>Less room for errors when not using <code>--noImplicitAny</code>, as a <code>Map</code> always has a <em>key</em> type and a <em>value</em> type, whereas an object <em>might</em> not have an index-signature</li>
<li>The functionality of adding/removing items (key-value pairs) is optimized for the task, unlike creating properties on an <code>Object</code>
</li>
</ul>
<p>Additionally, a <code>Map</code> object provides a more powerful and elegant API for
common tasks, most of which are not available through simple <code>Object</code>s without
hacking together helper functions (although some of these require a full ES6
iterator/iterable polyfill for ES5 targets or below):</p>
<div class="code"><pre class="code literal-block"><span class="c1">// Iterate over Map entries:</span>
<span class="n">people</span><span class="p">.</span><span class="n">forEach</span><span class="p">((</span><span class="n">person</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">...);</span>

<span class="c1">// Clear the Map:</span>
<span class="n">people</span><span class="p">.</span><span class="nb">clear</span><span class="p">();</span>

<span class="c1">// Get Map size:</span>
<span class="n">people</span><span class="p">.</span><span class="nb">size</span><span class="p">;</span>

<span class="c1">// Extract keys into array (in insertion order):</span>
<span class="n">let</span><span class="w"> </span><span class="n">keys</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Array</span><span class="p">.</span><span class="n">from</span><span class="p">(</span><span class="n">people</span><span class="p">.</span><span class="n">keys</span><span class="p">());</span>

<span class="c1">// Extract values into array (in insertion order):</span>
<span class="n">let</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Array</span><span class="p">.</span><span class="n">from</span><span class="p">(</span><span class="n">people</span><span class="p">.</span><span class="n">values</span><span class="p">());</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/ruby-calling-class-method-from-instance/" class="u-url">Ruby: Calling class method from instance</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/ruby-calling-class-method-from-instance/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T04:29:06+08:00" itemprop="datePublished" title="2023-03-04 04:29">2023-03-04 04:29</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>In Ruby, how do you call a class method from one of that class's instances?
Say I have</p>
<div class="code"><pre class="code literal-block"><span class="k">class</span> <span class="n">Truck</span>
  <span class="n">def</span> <span class="nb">self</span>.<span class="n">default_make</span>
    <span class="c1"># Class method.</span>
    <span class="s">"mac"</span>
  <span class="nb">end</span>

  <span class="n">def</span> <span class="n">initialize</span>
    <span class="c1"># Instance method.</span>
    <span class="n">Truck</span>.<span class="n">default_make</span>  <span class="c1"># gets the default via the class's method.</span>
    <span class="c1"># But: I wish to avoid mentioning Truck. Seems I'm repeating myself.</span>
  <span class="nb">end</span>
<span class="nb">end</span>
</pre></div>

<p>the line <code>Truck.default_make</code> retrieves the default. But is there a way of
saying this without mentioning <code>Truck</code>? It seems like there should be.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Rather than referring to the literal name of the class, inside an instance
method you can just call <code>self.class.whatever</code>.</p>
<div class="code"><pre class="code literal-block"><span class="k">class</span> <span class="n">Foo</span>
    <span class="n">def</span> <span class="nb">self</span>.<span class="n">some_class_method</span>
        <span class="n">puts</span> <span class="nb">self</span>
    <span class="nb">end</span>

    <span class="n">def</span> <span class="n">some_instance_method</span>
        <span class="nb">self</span>.<span class="k">class</span>.<span class="n">some_class_method</span>
    <span class="nb">end</span>
<span class="nb">end</span>

<span class="nb">print</span> <span class="s">"Class method: "</span>
<span class="n">Foo</span>.<span class="n">some_class_method</span>

<span class="nb">print</span> <span class="s">"Instance method: "</span>
<span class="n">Foo</span>.<span class="nb">new</span>.<span class="n">some_instance_method</span>
</pre></div>

<p>Outputs:</p>
<div class="code"><pre class="code literal-block">Class method: Foo
Instance method: Foo
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>Using <code>self.class.blah</code> is NOT the same as using <code>ClassName.blah</code> when it
comes to inheritance.</p>
<div class="code"><pre class="code literal-block"><span class="k">class</span> <span class="n">Truck</span>
  <span class="n">def</span> <span class="nb">self</span>.<span class="n">default_make</span>
    <span class="s">"mac"</span>
  <span class="nb">end</span>

  <span class="n">def</span> <span class="n">make1</span>
    <span class="nb">self</span>.<span class="k">class</span>.<span class="n">default_make</span>
  <span class="nb">end</span>

  <span class="n">def</span> <span class="n">make2</span>
    <span class="n">Truck</span>.<span class="n">default_make</span>
  <span class="nb">end</span>
<span class="nb">end</span>


<span class="k">class</span> <span class="n">BigTruck</span> &lt; <span class="n">Truck</span>
  <span class="n">def</span> <span class="nb">self</span>.<span class="n">default_make</span>
    <span class="s">"bigmac"</span>
  <span class="nb">end</span>
<span class="nb">end</span>

<span class="n">ruby-1</span><span class="mf">.9.3</span><span class="o">-</span><span class="n">p0</span> :<span class="mo">021</span> &gt; <span class="n">b</span>=<span class="n">BigTruck</span>.<span class="nb">new</span>
 =&gt; <span class="c1">#&lt;BigTruck:0x0000000307f348&gt; </span>
<span class="n">ruby-1</span><span class="mf">.9.3</span><span class="o">-</span><span class="n">p0</span> :<span class="mo">022</span> &gt; <span class="n">b</span>.<span class="n">make1</span>
 =&gt; <span class="s">"bigmac"</span> 
<span class="n">ruby-1</span><span class="mf">.9.3</span><span class="o">-</span><span class="n">p0</span> :<span class="mo">023</span> &gt; <span class="n">b</span>.<span class="n">make2</span>
 =&gt; <span class="s">"mac"</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/apache-and-node-js-on-the-same-server/" class="u-url">Apache and Node.js on the Same Server</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/apache-and-node-js-on-the-same-server/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T04:27:49+08:00" itemprop="datePublished" title="2023-03-04 04:27">2023-03-04 04:27</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I want to use Node because it's swift, uses the same language I am using on
the client side, and it's non-blocking by definition. But the guy who I hired
to write the program for file handling (saving, editing, renaming,
downloading, uploading files, etc.), he wants to use apache. So, I must:</p>
<ol>
<li>
<p>Convince him to use Node (he's giving up little ground on that)</p>
</li>
<li>
<p>Figure out how to upload, download, rename, save, etc. files in node or</p>
</li>
<li>
<p>I must install apache and node on the same server.</p>
</li>
</ol>
<p>Which is the most favorable situation, and how do I implement that?</p>
<p><br><br></p>
<h2>Answer</h2>
<p><strong>Great question!</strong></p>
<p>There are many websites and free web apps implemented in PHP that run on
Apache, lots of people use it so you can mash up something pretty easy and
besides, its a no-brainer way of serving static content. Node is fast,
powerful, elegant, and a sexy tool with the raw power of V8 and a flat stack
with no in-built dependencies.</p>
<p>I also want the ease/flexibility of Apache and yet the grunt and elegance of
Node.JS, <em>why can't I have both</em>?</p>
<p>Fortunately with the ProxyPass directive in the Apache <code>httpd.conf</code> its not
too hard to pipe all requests on a particular URL to your Node.JS application.</p>
<div class="code"><pre class="code literal-block">ProxyPass /node http://localhost:8000
</pre></div>

<p>Also, make sure the following lines are NOT commented out so you get the right
proxy and submodule to reroute http requests:</p>
<div class="code"><pre class="code literal-block">LoadModule proxy_module modules/mod_proxy.so
LoadModule proxy_http_module modules/mod_proxy_http.so
</pre></div>

<p>Then run your Node app on port 8000!</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">http</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">require</span><span class="p">(</span><span class="s1">'http'</span><span class="p">);</span>
<span class="n">http</span><span class="o">.</span><span class="n">createServer</span><span class="p">(</span><span class="n">function</span><span class="w"> </span><span class="p">(</span><span class="n">req</span><span class="p">,</span><span class="w"> </span><span class="n">res</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">res</span><span class="o">.</span><span class="n">writeHead</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="s1">'Content-Type'</span><span class="p">:</span><span class="w"> </span><span class="s1">'text/plain'</span><span class="p">});</span>
<span class="w">  </span><span class="n">res</span><span class="o">.</span><span class="n">end</span><span class="p">(</span><span class="s1">'Hello Apache!</span><span class="se">\n</span><span class="s1">'</span><span class="p">);</span>
<span class="p">})</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="mi">8000</span><span class="p">,</span><span class="w"> </span><span class="s1">'127.0.0.1'</span><span class="p">);</span>
</pre></div>

<p>Then you can access all Node.JS logic using the <code>/node/</code> path on your url, the
rest of the website can be left to Apache to host your existing PHP pages:</p>
<p><img alt="enter image description here" src="images/xmjco.png"></p>
<p>Now the only thing left is convincing your hosting company let your run with
this configuration!!!</p>
<p><br></p>
<h3>Suggest</h3>
<p>This question belongs more on Server Fault but FWIW I'd say running Apache in
front of Node.js is not a good approach in most cases.</p>
<p>Apache's ProxyPass is awesome for lots of things (like exposing Tomcat based
services as part of a site) and if your Node.js app is just doing a specific,
small role or is an internal tool that's only likely to have a limited number
of users then it might be easier just to use it so you can get it working and
move on, but that doesn't sound like the case here.</p>
<p>If you want to take advantage of the performance and scale you'll get from
using Node.js - and especially if you want to use something that involves
maintaining a persistent connection like web sockets - you are better off
running both Apache and your Node.js on other ports (e.g. Apache on
localhost:8080, Node.js on localhost:3000) and then running something like
nginx, Varnish or HA proxy in front - and routing traffic that way.</p>
<p>With something like varnish or nginx you can route traffic based on path
and/or host. They both use much less system resources and is much more
scalable that using Apache to do the same thing.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-2282.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-2280.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
