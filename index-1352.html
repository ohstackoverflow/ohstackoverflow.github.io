<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 1352) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-1352.html">
<link rel="prev" href="index-1353.html" type="text/html">
<link rel="next" href="index-1351.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/infinite-recursion-with-jackson-json-and-hibernate-jpa-issue/" class="u-url">Infinite Recursion with Jackson JSON and Hibernate JPA issue</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/infinite-recursion-with-jackson-json-and-hibernate-jpa-issue/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T07:21:08+08:00" itemprop="datePublished" title="2023-02-18 07:21">2023-02-18 07:21</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>When trying to convert a JPA object that has a bi-directional association into
JSON, I keep getting</p>
<div class="code"><pre class="code literal-block">org.codehaus.jackson.map.JsonMappingException: Infinite recursion (StackOverflowError)
</pre></div>

<p>All I found is this thread which basically concludes with recommending to
avoid bi-directional associations. Does anyone have an idea for a workaround
for this spring bug?</p>
<p>------ EDIT 2010-07-24 16:26:22 -------</p>
<p>Codesnippets:</p>
<p>Business Object 1:</p>
<div class="code"><pre class="code literal-block"><span class="err">@</span><span class="n">Entity</span>
<span class="err">@</span><span class="n">Table</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"ta_trainee"</span><span class="p">,</span><span class="w"> </span><span class="n">uniqueConstraints</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="err">@</span><span class="n">UniqueConstraint</span><span class="p">(</span><span class="n">columnNames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="s2">"id"</span><span class="p">})})</span>
<span class="n">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">Trainee</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="n">BusinessObject</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="err">@</span><span class="n">Id</span>
<span class="w">    </span><span class="err">@</span><span class="n">GeneratedValue</span><span class="p">(</span><span class="n">strategy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GenerationType</span><span class="o">.</span><span class="n">TABLE</span><span class="p">)</span>
<span class="w">    </span><span class="err">@</span><span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"id"</span><span class="p">,</span><span class="w"> </span><span class="n">nullable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">false</span><span class="p">)</span>
<span class="w">    </span><span class="n">private</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>

<span class="w">    </span><span class="err">@</span><span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"name"</span><span class="p">,</span><span class="w"> </span><span class="n">nullable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">true</span><span class="p">)</span>
<span class="w">    </span><span class="n">private</span><span class="w"> </span><span class="nb nb-Type">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>

<span class="w">    </span><span class="err">@</span><span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"surname"</span><span class="p">,</span><span class="w"> </span><span class="n">nullable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">true</span><span class="p">)</span>
<span class="w">    </span><span class="n">private</span><span class="w"> </span><span class="nb nb-Type">String</span><span class="w"> </span><span class="n">surname</span><span class="p">;</span>

<span class="w">    </span><span class="err">@</span><span class="n">OneToMany</span><span class="p">(</span><span class="n">mappedBy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"trainee"</span><span class="p">,</span><span class="w"> </span><span class="n">fetch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FetchType</span><span class="o">.</span><span class="n">EAGER</span><span class="p">,</span><span class="w"> </span><span class="n">cascade</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CascadeType</span><span class="o">.</span><span class="n">ALL</span><span class="p">)</span>
<span class="w">    </span><span class="err">@</span><span class="n">Column</span><span class="p">(</span><span class="n">nullable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">true</span><span class="p">)</span>
<span class="w">    </span><span class="n">private</span><span class="w"> </span><span class="n">Set</span><span class="o">&lt;</span><span class="n">BodyStat</span><span class="o">&gt;</span><span class="w"> </span><span class="n">bodyStats</span><span class="p">;</span>

<span class="w">    </span><span class="err">@</span><span class="n">OneToMany</span><span class="p">(</span><span class="n">mappedBy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"trainee"</span><span class="p">,</span><span class="w"> </span><span class="n">fetch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FetchType</span><span class="o">.</span><span class="n">EAGER</span><span class="p">,</span><span class="w"> </span><span class="n">cascade</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CascadeType</span><span class="o">.</span><span class="n">ALL</span><span class="p">)</span>
<span class="w">    </span><span class="err">@</span><span class="n">Column</span><span class="p">(</span><span class="n">nullable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">true</span><span class="p">)</span>
<span class="w">    </span><span class="n">private</span><span class="w"> </span><span class="n">Set</span><span class="o">&lt;</span><span class="n">Training</span><span class="o">&gt;</span><span class="w"> </span><span class="n">trainings</span><span class="p">;</span>

<span class="w">    </span><span class="err">@</span><span class="n">OneToMany</span><span class="p">(</span><span class="n">mappedBy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"trainee"</span><span class="p">,</span><span class="w"> </span><span class="n">fetch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FetchType</span><span class="o">.</span><span class="n">EAGER</span><span class="p">,</span><span class="w"> </span><span class="n">cascade</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CascadeType</span><span class="o">.</span><span class="n">ALL</span><span class="p">)</span>
<span class="w">    </span><span class="err">@</span><span class="n">Column</span><span class="p">(</span><span class="n">nullable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">true</span><span class="p">)</span>
<span class="w">    </span><span class="n">private</span><span class="w"> </span><span class="n">Set</span><span class="o">&lt;</span><span class="n">ExerciseType</span><span class="o">&gt;</span><span class="w"> </span><span class="n">exerciseTypes</span><span class="p">;</span>

<span class="w">    </span><span class="n">public</span><span class="w"> </span><span class="n">Trainee</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">super</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="o">//...</span><span class="w"> </span><span class="n">getters</span><span class="o">/</span><span class="n">setters</span><span class="w"> </span><span class="o">...</span>
<span class="p">}</span>
</pre></div>

<p>Business Object 2:</p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="nn">javax.persistence.</span><span class="o">*</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.Date</span><span class="p">;</span>

<span class="nd">@Entity</span>
<span class="nd">@Table</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s2">"ta_bodystat"</span><span class="p">,</span> <span class="n">uniqueConstraints</span> <span class="o">=</span> <span class="p">{</span><span class="nd">@UniqueConstraint</span><span class="p">(</span><span class="n">columnNames</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"id"</span><span class="p">})})</span>
<span class="n">public</span> <span class="k">class</span> <span class="nc">BodyStat</span> <span class="n">extends</span> <span class="n">BusinessObject</span> <span class="p">{</span>

    <span class="nd">@Id</span>
    <span class="nd">@GeneratedValue</span><span class="p">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="n">GenerationType</span><span class="o">.</span><span class="n">TABLE</span><span class="p">)</span>
    <span class="nd">@Column</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s2">"id"</span><span class="p">,</span> <span class="n">nullable</span> <span class="o">=</span> <span class="n">false</span><span class="p">)</span>
    <span class="n">private</span> <span class="n">Integer</span> <span class="nb">id</span><span class="p">;</span>

    <span class="nd">@Column</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s2">"height"</span><span class="p">,</span> <span class="n">nullable</span> <span class="o">=</span> <span class="n">true</span><span class="p">)</span>
    <span class="n">private</span> <span class="n">Float</span> <span class="n">height</span><span class="p">;</span>

    <span class="nd">@Column</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s2">"measuretime"</span><span class="p">,</span> <span class="n">nullable</span> <span class="o">=</span> <span class="n">false</span><span class="p">)</span>
    <span class="nd">@Temporal</span><span class="p">(</span><span class="n">TemporalType</span><span class="o">.</span><span class="n">TIMESTAMP</span><span class="p">)</span>
    <span class="n">private</span> <span class="n">Date</span> <span class="n">measureTime</span><span class="p">;</span>

    <span class="nd">@ManyToOne</span><span class="p">(</span><span class="n">fetch</span> <span class="o">=</span> <span class="n">FetchType</span><span class="o">.</span><span class="n">EAGER</span><span class="p">,</span> <span class="n">cascade</span> <span class="o">=</span> <span class="n">CascadeType</span><span class="o">.</span><span class="n">ALL</span><span class="p">)</span>
    <span class="nd">@JoinColumn</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">"trainee_fk"</span><span class="p">)</span>
    <span class="n">private</span> <span class="n">Trainee</span> <span class="n">trainee</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<p>Controller:</p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="nn">org.slf4j.Logger</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.slf4j.LoggerFactory</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Controller</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.ui.Model</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestBody</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMapping</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMethod</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.ResponseBody</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">javax.servlet.http.HttpServletResponse</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.ConstraintViolation</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.</span><span class="o">*</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.concurrent.ConcurrentHashMap</span><span class="p">;</span>

<span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s2">"/trainees"</span><span class="p">)</span>
<span class="n">public</span> <span class="k">class</span> <span class="nc">TraineesController</span> <span class="p">{</span>

    <span class="n">final</span> <span class="n">Logger</span> <span class="n">logger</span> <span class="o">=</span> <span class="n">LoggerFactory</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">TraineesController</span><span class="o">.</span><span class="n">class</span><span class="p">);</span>

    <span class="n">private</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">Long</span><span class="p">,</span> <span class="n">Trainee</span><span class="o">&gt;</span> <span class="n">trainees</span> <span class="o">=</span> <span class="n">new</span> <span class="n">ConcurrentHashMap</span><span class="o">&lt;</span><span class="n">Long</span><span class="p">,</span> <span class="n">Trainee</span><span class="o">&gt;</span><span class="p">();</span>

    <span class="nd">@Autowired</span>
    <span class="n">private</span> <span class="n">ITraineeDAO</span> <span class="n">traineeDAO</span><span class="p">;</span>

    <span class="o">/**</span>
     <span class="o">*</span> <span class="n">Return</span> <span class="n">json</span> <span class="n">repres</span><span class="o">.</span> <span class="n">of</span> <span class="nb">all</span> <span class="n">trainees</span>
     <span class="o">*/</span>
    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s2">"/getAllTrainees"</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="n">GET</span><span class="p">)</span>
    <span class="nd">@ResponseBody</span>        
    <span class="n">public</span> <span class="n">Collection</span> <span class="n">getAllTrainees</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">Collection</span> <span class="n">allTrainees</span> <span class="o">=</span> <span class="n">this</span><span class="o">.</span><span class="n">traineeDAO</span><span class="o">.</span><span class="n">getAll</span><span class="p">();</span>

        <span class="n">this</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">"A total of "</span> <span class="o">+</span> <span class="n">allTrainees</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> <span class="o">+</span> <span class="s2">"  trainees was read from db"</span><span class="p">);</span>

        <span class="k">return</span> <span class="n">allTrainees</span><span class="p">;</span>
    <span class="p">}</span>    
<span class="p">}</span>
</pre></div>

<p>JPA-implementation of the trainee DAO:</p>
<div class="code"><pre class="code literal-block"><span class="nv">@Repository</span>
<span class="nv">@Transactional</span>
<span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">TraineeDAO</span><span class="w"> </span><span class="n">implements</span><span class="w"> </span><span class="n">ITraineeDAO</span><span class="w"> </span><span class="err">{</span>

<span class="w">    </span><span class="nv">@PersistenceContext</span>
<span class="w">    </span><span class="n">private</span><span class="w"> </span><span class="n">EntityManager</span><span class="w"> </span><span class="n">em</span><span class="p">;</span>

<span class="w">    </span><span class="nv">@Transactional</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="n">Trainee</span><span class="w"> </span><span class="k">save</span><span class="p">(</span><span class="n">Trainee</span><span class="w"> </span><span class="n">trainee</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="n">em</span><span class="p">.</span><span class="n">persist</span><span class="p">(</span><span class="n">trainee</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">trainee</span><span class="p">;</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="nv">@Transactional</span><span class="p">(</span><span class="n">readOnly</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="p">)</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="n">Collection</span><span class="w"> </span><span class="n">getAll</span><span class="p">()</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">Collection</span><span class="p">)</span><span class="w"> </span><span class="n">em</span><span class="p">.</span><span class="n">createQuery</span><span class="p">(</span><span class="ss">"SELECT t FROM Trainee t"</span><span class="p">).</span><span class="n">getResultList</span><span class="p">();</span>
<span class="w">    </span><span class="err">}</span>
<span class="err">}</span>
</pre></div>

<p>persistence.xml</p>
<div class="code"><pre class="code literal-block"><span class="nt">&lt;persistence</span><span class="w"> </span><span class="na">xmlns=</span><span class="s">"http://java.sun.com/xml/ns/persistence"</span>
<span class="w">             </span><span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
<span class="w">             </span><span class="na">xsi:schemaLocation=</span><span class="s">"http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd"</span>
<span class="w">             </span><span class="na">version=</span><span class="s">"1.0"</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;persistence-unit</span><span class="w"> </span><span class="na">name=</span><span class="s">"RDBMS"</span><span class="w"> </span><span class="na">transaction-type=</span><span class="s">"RESOURCE_LOCAL"</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;exclude-unlisted-classes&gt;</span>false<span class="nt">&lt;/exclude-unlisted-classes&gt;</span>
<span class="w">        </span><span class="nt">&lt;properties&gt;</span>
<span class="w">            </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"hibernate.hbm2ddl.auto"</span><span class="w"> </span><span class="na">value=</span><span class="s">"validate"</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"hibernate.archive.autodetection"</span><span class="w"> </span><span class="na">value=</span><span class="s">"class"</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">"dialect"</span><span class="w"> </span><span class="na">value=</span><span class="s">"org.hibernate.dialect.MySQL5InnoDBDialect"</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="cm">&lt;!-- &lt;property name="dialect" value="org.hibernate.dialect.HSQLDialect"/&gt;         --&gt;</span>
<span class="w">        </span><span class="nt">&lt;/properties&gt;</span>
<span class="w">    </span><span class="nt">&lt;/persistence-unit&gt;</span>
<span class="nt">&lt;/persistence&gt;</span>
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<p>You may use <code>@JsonIgnore</code> to break the cycle (reference).</p>
<p>You need to import <code>org.codehaus.jackson.annotate.JsonIgnore</code> (legacy
versions) or <code>com.fasterxml.jackson.annotation.JsonIgnore</code> (current versions).</p>
<p><br></p>
<h3>Suggest</h3>
<p>You may use <code>@JsonIgnore</code> to break the cycle (reference).</p>
<p>You need to import <code>org.codehaus.jackson.annotate.JsonIgnore</code> (legacy
versions) or <code>com.fasterxml.jackson.annotation.JsonIgnore</code> (current versions).</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/c-if-then-directives-for-debug-vs-release/" class="u-url">C# if/then directives for debug vs release</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/c-if-then-directives-for-debug-vs-release/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T07:20:42+08:00" itemprop="datePublished" title="2023-02-18 07:20">2023-02-18 07:20</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>In Solution properties, I have Configuration set to "release" for my one and
only project.</p>
<p>At the beginning of the main routine, I have this code, and it is showing
"Mode=Debug". I also have these two lines at the very top:</p>
<div class="code"><pre class="code literal-block">#define DEBUG 
#define RELEASE
</pre></div>

<p>Am I testing the right variable?</p>
<div class="code"><pre class="code literal-block">#<span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">DEBUG</span><span class="ss">)</span>
<span class="w">            </span><span class="nv">Console</span>.<span class="nv">WriteLine</span><span class="ss">(</span><span class="s2">"Mode=Debug"</span><span class="ss">)</span><span class="c1">; </span>
#<span class="nv">elif</span><span class="w"> </span><span class="ss">(</span><span class="nv">RELEASE</span><span class="ss">)</span>
<span class="w">            </span><span class="nv">Console</span>.<span class="nv">WriteLine</span><span class="ss">(</span><span class="s2">"Mode=Release"</span><span class="ss">)</span><span class="c1">; </span>
#<span class="k">endif</span>
</pre></div>

<p>My goal is to set different defaults for variables based on debug vs release
mode.</p>
<p><br><br></p>
<h2>Answer</h2>
<p><code>DEBUG</code>/<code>_DEBUG</code> should be defined in VS already.</p>
<p>Remove the <code>#define DEBUG</code> in your code. Set preprocessors in the build
configuration for that specific build.</p>
<p>The reason it prints "Mode=Debug" is because of your <code>#define</code> and then skips
the <code>elif</code>.</p>
<p>The right way to check is:</p>
<div class="code"><pre class="code literal-block">#<span class="k">if</span><span class="w"> </span><span class="nv">DEBUG</span>
<span class="w">    </span><span class="nv">Console</span>.<span class="nv">WriteLine</span><span class="ss">(</span><span class="s2">"Mode=Debug"</span><span class="ss">)</span><span class="c1">; </span>
#<span class="k">else</span>
<span class="w">    </span><span class="nv">Console</span>.<span class="nv">WriteLine</span><span class="ss">(</span><span class="s2">"Mode=Release"</span><span class="ss">)</span><span class="c1">; </span>
#<span class="k">endif</span>
</pre></div>

<p>Don't check for <code>RELEASE</code>.</p>
<p><br></p>
<h3>Suggest</h3>
<p>By default, Visual Studio defines DEBUG if project is compiled in Debug mode
and doesn't define it if it's in Release mode. RELEASE is not defined in
Release mode by default. Use something like this:</p>
<div class="code"><pre class="code literal-block">#<span class="k">if</span><span class="w"> </span><span class="nv">DEBUG</span>
<span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="nv">debug</span><span class="w"> </span><span class="nv">stuff</span><span class="w"> </span><span class="nv">goes</span><span class="w"> </span><span class="nv">here</span>
#<span class="k">else</span>
<span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="nv">release</span><span class="w"> </span><span class="nv">stuff</span><span class="w"> </span><span class="nv">goes</span><span class="w"> </span><span class="nv">here</span>
#<span class="k">endif</span>
</pre></div>

<p>If you want to do something only in release mode:</p>
<div class="code"><pre class="code literal-block">#<span class="k">if</span><span class="w"> </span><span class="o">!</span><span class="nv">DEBUG</span>
<span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="nv">release</span>...
#<span class="k">endif</span>
</pre></div>

<p>Also, it's worth pointing out that you can use <code>[Conditional("DEBUG")]</code>
attribute on methods that return <code>void</code> to have them only executed if a
certain symbol is defined. The compiler would remove all calls to those
methods if the symbol is not defined:</p>
<div class="code"><pre class="code literal-block"><span class="k">[Conditional("DEBUG")]</span>
<span class="na">void PrintLog() {</span>
<span class="w">    </span><span class="na">Console.WriteLine("Debug info");</span>
<span class="na">}</span>

<span class="na">void Test() {</span>
<span class="w">    </span><span class="na">PrintLog();</span>
<span class="na">}</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-disable-scrolling-temporarily/" class="u-url">How to disable scrolling temporarily?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-disable-scrolling-temporarily/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T07:20:13+08:00" itemprop="datePublished" title="2023-02-18 07:20">2023-02-18 07:20</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I'm using the scrollTo jQuery plugin and would like to know if it is somehow
possible to temporarily disable scrolling on the window element through
Javascript? The reason I'd like to disable scrolling is that when you scroll
while scrollTo is animating, it gets really ugly ;)</p>
<p>Of course, I could do a <code>$("body").css("overflow", "hidden");</code> and then put it
back to auto when the animation stops, but it would be better if the scrollbar
was still visible but inactive.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>The <code>scroll</code> event cannot be canceled. But you can do it by <strong>canceling</strong>
these interaction events:<br><strong>Mouse</strong> <em>&amp;</em> <strong>Touch scroll</strong> and <strong>Buttons</strong> associated with scrolling.</p>
<h3>[Working demo]</h3>
<div class="code"><pre class="code literal-block"><span class="o">//</span><span class="w"> </span><span class="n">left</span><span class="p">:</span><span class="w"> </span><span class="mi">37</span><span class="p">,</span><span class="w"> </span><span class="n">up</span><span class="p">:</span><span class="w"> </span><span class="mi">38</span><span class="p">,</span><span class="w"> </span><span class="n">right</span><span class="p">:</span><span class="w"> </span><span class="mi">39</span><span class="p">,</span><span class="w"> </span><span class="n">down</span><span class="p">:</span><span class="w"> </span><span class="mi">40</span><span class="p">,</span>
<span class="o">//</span><span class="w"> </span><span class="n">spacebar</span><span class="p">:</span><span class="w"> </span><span class="mi">32</span><span class="p">,</span><span class="w"> </span><span class="n">pageup</span><span class="p">:</span><span class="w"> </span><span class="mi">33</span><span class="p">,</span><span class="w"> </span><span class="n">pagedown</span><span class="p">:</span><span class="w"> </span><span class="mi">34</span><span class="p">,</span><span class="w"> </span><span class="n">end</span><span class="p">:</span><span class="w"> </span><span class="mi">35</span><span class="p">,</span><span class="w"> </span><span class="n">home</span><span class="p">:</span><span class="w"> </span><span class="mi">36</span>
<span class="k">var</span><span class="w"> </span><span class="n">keys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">37</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">38</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">39</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">};</span>

<span class="n">function</span><span class="w"> </span><span class="n">preventDefault</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">e</span><span class="o">.</span><span class="n">preventDefault</span><span class="p">();</span>
<span class="p">}</span>

<span class="n">function</span><span class="w"> </span><span class="n">preventDefaultForScrollKeys</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">keys</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">keyCode</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">preventDefault</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="bp">false</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">modern</span><span class="w"> </span><span class="n">Chrome</span><span class="w"> </span><span class="n">requires</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">passive</span><span class="p">:</span><span class="w"> </span><span class="bp">false</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="n">when</span><span class="w"> </span><span class="n">adding</span><span class="w"> </span><span class="n">event</span>
<span class="k">var</span><span class="w"> </span><span class="n">supportsPassive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">false</span><span class="p">;</span>
<span class="n">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">window</span><span class="o">.</span><span class="n">addEventListener</span><span class="p">(</span><span class="s2">"test"</span><span class="p">,</span><span class="w"> </span><span class="nb nb-Type">null</span><span class="p">,</span><span class="w"> </span><span class="nb nb-Type">Object</span><span class="o">.</span><span class="n">defineProperty</span><span class="p">({},</span><span class="w"> </span><span class="s1">'passive'</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">get</span><span class="p">:</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">supportsPassive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">true</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span>
<span class="w">  </span><span class="p">}));</span>
<span class="p">}</span><span class="w"> </span><span class="n">catch</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span>

<span class="k">var</span><span class="w"> </span><span class="n">wheelOpt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">supportsPassive</span><span class="w"> </span><span class="err">?</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">passive</span><span class="p">:</span><span class="w"> </span><span class="bp">false</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="bp">false</span><span class="p">;</span>
<span class="k">var</span><span class="w"> </span><span class="n">wheelEvent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'onwheel'</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">document</span><span class="o">.</span><span class="n">createElement</span><span class="p">(</span><span class="s1">'div'</span><span class="p">)</span><span class="w"> </span><span class="err">?</span><span class="w"> </span><span class="s1">'wheel'</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s1">'mousewheel'</span><span class="p">;</span>

<span class="o">//</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">Disable</span>
<span class="n">function</span><span class="w"> </span><span class="n">disableScroll</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">window</span><span class="o">.</span><span class="n">addEventListener</span><span class="p">(</span><span class="s1">'DOMMouseScroll'</span><span class="p">,</span><span class="w"> </span><span class="n">preventDefault</span><span class="p">,</span><span class="w"> </span><span class="bp">false</span><span class="p">);</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">older</span><span class="w"> </span><span class="n">FF</span>
<span class="w">  </span><span class="n">window</span><span class="o">.</span><span class="n">addEventListener</span><span class="p">(</span><span class="n">wheelEvent</span><span class="p">,</span><span class="w"> </span><span class="n">preventDefault</span><span class="p">,</span><span class="w"> </span><span class="n">wheelOpt</span><span class="p">);</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">modern</span><span class="w"> </span><span class="n">desktop</span>
<span class="w">  </span><span class="n">window</span><span class="o">.</span><span class="n">addEventListener</span><span class="p">(</span><span class="s1">'touchmove'</span><span class="p">,</span><span class="w"> </span><span class="n">preventDefault</span><span class="p">,</span><span class="w"> </span><span class="n">wheelOpt</span><span class="p">);</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">mobile</span>
<span class="w">  </span><span class="n">window</span><span class="o">.</span><span class="n">addEventListener</span><span class="p">(</span><span class="s1">'keydown'</span><span class="p">,</span><span class="w"> </span><span class="n">preventDefaultForScrollKeys</span><span class="p">,</span><span class="w"> </span><span class="bp">false</span><span class="p">);</span>
<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">Enable</span>
<span class="n">function</span><span class="w"> </span><span class="n">enableScroll</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">window</span><span class="o">.</span><span class="n">removeEventListener</span><span class="p">(</span><span class="s1">'DOMMouseScroll'</span><span class="p">,</span><span class="w"> </span><span class="n">preventDefault</span><span class="p">,</span><span class="w"> </span><span class="bp">false</span><span class="p">);</span>
<span class="w">  </span><span class="n">window</span><span class="o">.</span><span class="n">removeEventListener</span><span class="p">(</span><span class="n">wheelEvent</span><span class="p">,</span><span class="w"> </span><span class="n">preventDefault</span><span class="p">,</span><span class="w"> </span><span class="n">wheelOpt</span><span class="p">);</span><span class="w"> </span>
<span class="w">  </span><span class="n">window</span><span class="o">.</span><span class="n">removeEventListener</span><span class="p">(</span><span class="s1">'touchmove'</span><span class="p">,</span><span class="w"> </span><span class="n">preventDefault</span><span class="p">,</span><span class="w"> </span><span class="n">wheelOpt</span><span class="p">);</span>
<span class="w">  </span><span class="n">window</span><span class="o">.</span><span class="n">removeEventListener</span><span class="p">(</span><span class="s1">'keydown'</span><span class="p">,</span><span class="w"> </span><span class="n">preventDefaultForScrollKeys</span><span class="p">,</span><span class="w"> </span><span class="bp">false</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>

<p>UPDATE: fixed Chrome desktop and modern mobile browsers with passive listeners</p>
<p><br></p>
<h3>Suggest</h3>
<p>Do it simply by adding a class to the body:</p>
<div class="code"><pre class="code literal-block"><span class="na">.stop-scrolling</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nl">height:</span><span class="w"> </span><span class="err">100%</span><span class="c1">;</span>
<span class="w">  </span><span class="nl">overflow:</span><span class="w"> </span><span class="nf">hidden</span><span class="c1">;</span>
<span class="err">}</span>
</pre></div>

<p>Add the class then remove when you want to re-enable scrolling, tested in IE,
FF, Safari and Chrome.</p>
<div class="code"><pre class="code literal-block">$('body').addClass('stop-scrolling')
</pre></div>

<hr>
<p>For <strong>mobile devices</strong> , you'll need to handle the <code>touchmove</code> event:</p>
<div class="code"><pre class="code literal-block">$('body').bind('touchmove', function(e){e.preventDefault()})
</pre></div>

<p>And unbind to re-enable scrolling. Tested in iOS6 and Android 2.3.3</p>
<div class="code"><pre class="code literal-block">$('body').unbind('touchmove')
</pre></div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-1353.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-1351.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
