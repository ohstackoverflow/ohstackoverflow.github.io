<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 1481) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-1481.html">
<link rel="prev" href="index-1482.html" type="text/html">
<link rel="next" href="index-1480.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/unable-to-find-custom-chaincode-path-hyperledger-fabricv1-0-local-network-running-on-windows7/" class="u-url">Unable to find custom chaincode path Hyperledger Fabricv1.0 local network running on windows7</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/unable-to-find-custom-chaincode-path-hyperledger-fabricv1-0-local-network-running-on-windows7/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-28T05:00:40+08:00" itemprop="datePublished" title="2023-02-28 05:00">2023-02-28 05:00</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I am trying to install my custom chain code in my local Hyperledger Fabric
v1.0 environment.</p>
<p>For this I have followed the documentation build your first network and I am
using first network sample with in the github project. No it is up and running
with <code>./byfn.sh -m up</code> and executing all the scripts for channel creating,
chain code installation and instantiation and all by running script.sh file.</p>
<p>Now I have changed the following to tryout my custom chaincode</p>
<div class="code"><pre class="code literal-block"><span class="n">peer</span><span class="w"> </span><span class="n">chaincode</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="o">-</span><span class="n">n</span><span class="w"> </span><span class="n">mycc</span><span class="w"> </span><span class="o">-</span><span class="n">v</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">examples</span><span class="o">/</span><span class="n">chaincode</span><span class="o">/</span><span class="k">go</span><span class="o">/</span><span class="n">chaincode_example02</span><span class="o">&gt;&amp;</span><span class="nf">log</span><span class="p">.</span><span class="n">txt</span>
</pre></div>

<p>this I have changed to</p>
<div class="code"><pre class="code literal-block">peer chaincode install -n mycc -v 1.0 -p github.com/myuserId/fabrcicV1_chaincodes/mychaincode &gt;&amp;log.txt
</pre></div>

<p>Now by running <code>./byfn.sh -m up</code> getting the exception</p>
<div class="code"><pre class="code literal-block"><span class="mi">2017</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">22</span><span class="w"> </span><span class="mi">11</span><span class="err">:</span><span class="mi">01</span><span class="err">:</span><span class="mf">17.048</span><span class="w"> </span><span class="n">UTC</span><span class="w"> </span><span class="o">[</span><span class="n">msp</span><span class="o">]</span><span class="w"> </span><span class="n">GetDefaultSigningIdentity</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">DEBU</span><span class="w"> </span><span class="mi">002</span><span class="w"> </span><span class="n">Obtaining</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="n">signing</span><span class="w"> </span><span class="k">identity</span>
<span class="mi">2017</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">22</span><span class="w"> </span><span class="mi">11</span><span class="err">:</span><span class="mi">01</span><span class="err">:</span><span class="mf">17.048</span><span class="w"> </span><span class="n">UTC</span><span class="w"> </span><span class="o">[</span><span class="n">chaincodeCmd</span><span class="o">]</span><span class="w"> </span><span class="n">checkChaincodeCmdParams</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">INFO</span><span class="w"> </span><span class="mi">003</span><span class="w"> </span><span class="k">Using</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="n">escc</span>
<span class="mi">2017</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">22</span><span class="w"> </span><span class="mi">11</span><span class="err">:</span><span class="mi">01</span><span class="err">:</span><span class="mf">17.048</span><span class="w"> </span><span class="n">UTC</span><span class="w"> </span><span class="o">[</span><span class="n">chaincodeCmd</span><span class="o">]</span><span class="w"> </span><span class="n">checkChaincodeCmdParams</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">INFO</span><span class="w"> </span><span class="mi">004</span><span class="w"> </span><span class="k">Using</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="n">vscc</span>
<span class="nl">Error</span><span class="p">:</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="n">getting</span><span class="w"> </span><span class="n">chaincode</span><span class="w"> </span><span class="n">code</span><span class="w"> </span><span class="nl">chaincode</span><span class="p">:</span><span class="w"> </span><span class="k">path</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">chaincode</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nl">exist</span><span class="p">:</span><span class="w"> </span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">myuserId</span><span class="o">/</span><span class="n">fabrcicV1_chaincodes</span><span class="o">/</span><span class="n">mychaincode</span>
<span class="k">Usage</span><span class="err">:</span>
<span class="w">  </span><span class="n">peer</span><span class="w"> </span><span class="n">chaincode</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="o">[</span><span class="n">flags</span><span class="o">]</span>

<span class="nl">Flags</span><span class="p">:</span>
<span class="w">  </span><span class="o">-</span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">ctor</span><span class="w"> </span><span class="n">string</span><span class="w">      </span><span class="k">Constructor</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">chaincode</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">JSON</span><span class="w"> </span><span class="nf">format</span><span class="w"> </span><span class="p">(</span><span class="k">default</span><span class="w"> </span><span class="ss">"{}"</span><span class="p">)</span>
<span class="w">  </span><span class="o">-</span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">lang</span><span class="w"> </span><span class="n">string</span><span class="w">      </span><span class="k">Language</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">chaincode</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">written</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="p">(</span><span class="k">default</span><span class="w"> </span><span class="ss">"golang"</span><span class="p">)</span>
<span class="w">  </span><span class="o">-</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">name</span><span class="w"> </span><span class="n">string</span><span class="w">      </span><span class="n">Name</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">chaincode</span>
<span class="w">  </span><span class="o">-</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="k">path</span><span class="w"> </span><span class="n">string</span><span class="w">      </span><span class="k">Path</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">chaincode</span>
<span class="w">  </span><span class="o">-</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">version</span><span class="w"> </span><span class="n">string</span><span class="w">   </span><span class="n">Version</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">chaincode</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">install</span><span class="o">/</span><span class="n">instantiate</span><span class="o">/</span><span class="n">upgrade</span><span class="w"> </span><span class="n">commands</span>

<span class="k">Global</span><span class="w"> </span><span class="nl">Flags</span><span class="p">:</span>
<span class="w">      </span><span class="o">--</span><span class="n">cafile</span><span class="w"> </span><span class="n">string</span><span class="w">              </span><span class="k">Path</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">file</span><span class="w"> </span><span class="n">containing</span><span class="w"> </span><span class="n">PEM</span><span class="o">-</span><span class="n">encoded</span><span class="w"> </span><span class="n">trusted</span><span class="w"> </span><span class="n">certificate</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ordering</span><span class="w"> </span><span class="n">endpoi</span>
<span class="w">      </span><span class="o">--</span><span class="n">logging</span><span class="o">-</span><span class="k">level</span><span class="w"> </span><span class="n">string</span><span class="w">       </span><span class="k">Default</span><span class="w"> </span><span class="n">logging</span><span class="w"> </span><span class="k">level</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">overrides</span><span class="p">,</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">core</span><span class="p">.</span><span class="n">yaml</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">full</span><span class="w"> </span><span class="n">syntax</span>
<span class="w">  </span><span class="o">-</span><span class="n">o</span><span class="p">,</span><span class="w"> </span><span class="o">--</span><span class="n">orderer</span><span class="w"> </span><span class="n">string</span><span class="w">             </span><span class="n">Ordering</span><span class="w"> </span><span class="n">service</span><span class="w"> </span><span class="n">endpoint</span>
<span class="w">      </span><span class="o">--</span><span class="n">test</span><span class="p">.</span><span class="n">coverprofile</span><span class="w"> </span><span class="n">string</span><span class="w">   </span><span class="n">Done</span><span class="w"> </span><span class="p">(</span><span class="k">default</span><span class="w"> </span><span class="ss">"coverage.cov"</span><span class="p">)</span>
<span class="w">      </span><span class="o">--</span><span class="n">tls</span><span class="w">                        </span><span class="k">Use</span><span class="w"> </span><span class="n">TLS</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="n">communicating</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">orderer</span><span class="w"> </span><span class="n">endpoint</span>

<span class="err">!!!!!!!!!!!!!!!</span><span class="w"> </span><span class="n">Chaincode</span><span class="w"> </span><span class="n">installation</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="n">peer</span><span class="w"> </span><span class="n">PEER0</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="err">!!!!!!!!!!!!!!!!</span>
<span class="o">=========</span><span class="w"> </span><span class="n">ERROR</span><span class="w"> </span><span class="err">!!!</span><span class="w"> </span><span class="n">FAILED</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">execute</span><span class="w"> </span><span class="k">End</span><span class="o">-</span><span class="mi">2</span><span class="o">-</span><span class="k">End</span><span class="w"> </span><span class="n">Scenario</span><span class="w"> </span><span class="o">===========</span>
</pre></div>

<p>I have the repository there in github, then why it is not showing <strong>does not
exit</strong>?</p>
<p>I have <em>cloned</em> the same to <strong>Windows 7</strong> machine under the path
$GOPATH/src/github.com/ and given local path, then also I am getting the same
error. I am running all the commands through docker quick start terminal for
<strong>windows 7</strong>.</p>
<p>Please suggest where I am doing wrong.</p>
<p>Also in some of the network log I have found a location
<code>/opt/gopath/src/github.com/....</code> and where it is pointing to. In my windows
path gopath is <code>/c/users/public/fabricv1</code>.</p>
<p>Since I am not much familiar with the tool, please comment on this also.</p>
<blockquote>
<p>After doing some analysis from my side, it seems like the chain code is
reading from some pre-mounted directories <strong><em>sacc/, fabcar/, /marble02 ,
chaincode_example_02, hyperledger/</em></strong> under the path
<strong><em><code>root@7785f8b27559:/opt/gopath/src/chaincodedev/chaincode#</code></em></strong> and
chaincode also pre-loaded at the time of making the network up using docker
image. There it seems <strong><em>no effect by adding chaincode in windows folder</em></strong>
and it is from the above said virtual machine path.</p>
<p>So what can I do now to continue my work? is there any way to install my
custom chaincode to the local network. I tried with my githhub path and
local path but no use. please somebody help :(</p>
</blockquote>
<p><br><br></p>
<h2>Answer</h2>
<p>It seems that you do not have your chaincode in the $GOPATH, you need to run:</p>
<div class="code"><pre class="code literal-block"><span class="k">go</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">myuserId</span><span class="o">/</span><span class="n">fabrcicV1_chaincodes</span><span class="o">/</span><span class="n">mychaincode</span>
</pre></div>

<p>Before trying to install the chaincode on peer, in your case where you are
using <strong>build your first network</strong> , you need to make sure your new chaincode
inside <code>fabric-samples/chaincode</code> folder. And also note that you need to mount
folder with your chaincode into docker cli container, see example of current
<code>docker-compose-cli.yaml</code> file:</p>
<div class="code"><pre class="code literal-block"><span class="n">volumes</span><span class="p">:</span>
<span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="p">:</span><span class="o">/</span><span class="n">host</span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span>
<span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="o">./../</span><span class="n">chaincode</span><span class="o">/</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">examples</span><span class="o">/</span><span class="n">chaincode</span><span class="o">/</span><span class="n">go</span>
<span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="o">./</span><span class="n">crypto</span><span class="o">-</span><span class="n">config</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span>
<span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="o">./</span><span class="n">scripts</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span>
<span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="o">./</span><span class="n">channel</span><span class="o">-</span><span class="n">artifacts</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">channel</span><span class="o">-</span><span class="n">artifacts</span>
</pre></div>

<p>In particular, you probably need to replace here with your chaincode or make
sure to mount an additional folder within <code>$GOPATH</code> of cli container:</p>
<div class="code"><pre class="code literal-block"><span class="o">-</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="n">chaincode</span><span class="o">/</span><span class="err">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">examples</span><span class="o">/</span><span class="n">chaincode</span><span class="o">/</span><span class="k">go</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/geth-option-allow-insecure-unlock-what-exactly-does-it-mean/" class="u-url">geth option "--allow-insecure-unlock", what exactly does it mean?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/geth-option-allow-insecure-unlock-what-exactly-does-it-mean/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-28T05:00:23+08:00" itemprop="datePublished" title="2023-02-28 05:00">2023-02-28 05:00</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>The doc on github says:</p>
<blockquote>
<p>--allow-insecure-unlock Allow insecure account unlocking when account-
related RPCs are exposed by http</p>
</blockquote>
<p>And, I have to add the option when start <code>geth</code>, otherwise can't unlock the
account.</p>
<hr>
<h3>Questions</h3>
<ul>
<li>What does this option exactly mean? I read the doc and searhed on Google, still can't fully understand it.</li>
<li>Is it safe to use this option, will it create security holes?</li>
</ul>
<p><br><br></p>
<h2>Answer</h2>
<p>If you access to a node with geth via HTTP protocol you can´t unlock account
with personal.unlockAccount(web3.eth.account, password). If you try, you'll
receive error " <strong>account unlock with HTTP access is forbidden</strong> ". So, to
avoid that you have to use the flag <strong><em>allow-insecure-unlock</em></strong>.</p>
<p>That is because the unlock operation is unsafe if the node is exposed to
external. That "protection" was added in go-ethereum in PR #17037
(https://github.com/ethereum/go-ethereum/pull/17037)</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/i-notice-when-i-try-and-use-borsh-to-serialize-deserialize-i-ll-get-errors/" class="u-url">I notice when I try and use Borsh to serialize/deserialize I'll get errors</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/i-notice-when-i-try-and-use-borsh-to-serialize-deserialize-i-ll-get-errors/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-28T05:00:06+08:00" itemprop="datePublished" title="2023-02-28 05:00">2023-02-28 05:00</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I notice when I try and use Borsh to serialize/deserialize I'll get errors
when the data sizes don't match. For example, if I have an array in the
account data and then I go and try and add another element. If I don't already
have a placeholder data item in there with dummy values in the fields the
serialization attempt will fail. Am I doing something wrong or is this just
the way that it is and I just have to accept that?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>If you are passing in the &amp;[u8] of data to try_from_slice but the overall
account data size is greater than your data you will get that borsh error as
it defaults to checking the deserialized length with the overall slice length
(or something like that):</p>
<ul>
<li>Capture the actual size of the data you are storing by taking the .len() of the try_to_vec() output and write that in the account data block and then store your data. When you deserialize, use the stored len and use that to create a slice of that size from the account data to pass to try_from_slice. You can see an example (using a BTreeMap instead of your array but you get the idea) here https://github.com/hashblock/solana-cli-program-template/blob/main/program/src/account_state.rs at L66 (serialize) and L85 (deserialize).</li>
</ul>
</div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-1482.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-1480.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
