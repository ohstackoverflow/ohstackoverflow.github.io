<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 596) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-596.html">
<link rel="prev" href="index-597.html" type="text/html">
<link rel="next" href="index-595.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-do-you-declare-an-interface-in-c/" class="u-url">How do you declare an interface in C++?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-do-you-declare-an-interface-in-c/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T10:56:00+08:00" itemprop="datePublished" title="2023-02-17 10:56">2023-02-17 10:56</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>How do I setup a class that represents an interface? Is this just an abstract
base class?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>To expand on the answer by bradtgmurray, you may want to make one exception to
the pure virtual method list of your interface by adding a virtual destructor.
This allows you to pass pointer ownership to another party without exposing
the concrete derived class. The destructor doesn't have to do anything,
because the interface doesn't have any concrete members. It might seem
contradictory to define a function as both virtual and inline, but trust me -
it isn't.</p>
<div class="code"><pre class="code literal-block"><span class="nt">class</span><span class="w"> </span><span class="nt">IDemo</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">public</span><span class="p">:</span>
<span class="w">        </span><span class="n">virtual</span><span class="w"> </span><span class="o">~</span><span class="nf">IDemo</span><span class="p">()</span><span class="w"> </span><span class="err">{</span><span class="p">}</span>
<span class="w">        </span><span class="nt">virtual</span><span class="w"> </span><span class="nt">void</span><span class="w"> </span><span class="nt">OverrideMe</span><span class="o">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">0</span><span class="o">;</span>
<span class="err">}</span><span class="o">;</span>

<span class="nt">class</span><span class="w"> </span><span class="nt">Parent</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">public</span><span class="p">:</span>
<span class="w">        </span><span class="n">virtual</span><span class="w"> </span><span class="o">~</span><span class="nf">Parent</span><span class="p">();</span>
<span class="p">}</span><span class="o">;</span>

<span class="nt">class</span><span class="w"> </span><span class="nt">Child</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nt">public</span><span class="w"> </span><span class="nt">Parent</span><span class="o">,</span><span class="w"> </span><span class="nt">public</span><span class="w"> </span><span class="nt">IDemo</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">public</span><span class="p">:</span>
<span class="w">        </span><span class="n">virtual</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="nf">OverrideMe</span><span class="p">()</span>
<span class="w">        </span><span class="err">{</span>
<span class="w">            </span><span class="o">//</span><span class="n">do</span><span class="w"> </span><span class="n">stuff</span>
<span class="w">        </span><span class="p">}</span>
<span class="err">}</span><span class="o">;</span>
</pre></div>

<p>You don't have to include a body for the virtual destructor - it turns out
some compilers have trouble optimizing an empty destructor and you're better
off using the default.</p>
<p><br></p>
<h3>Suggest</h3>
<p>Make a class with pure virtual methods. Use the interface by creating another
class that overrides those virtual methods.</p>
<p>A pure virtual method is a class method that is defined as virtual and
assigned to 0.</p>
<div class="code"><pre class="code literal-block"><span class="nt">class</span><span class="w"> </span><span class="nt">IDemo</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">public</span><span class="p">:</span>
<span class="w">        </span><span class="n">virtual</span><span class="w"> </span><span class="o">~</span><span class="nf">IDemo</span><span class="p">()</span><span class="w"> </span><span class="err">{</span><span class="p">}</span>
<span class="w">        </span><span class="nt">virtual</span><span class="w"> </span><span class="nt">void</span><span class="w"> </span><span class="nt">OverrideMe</span><span class="o">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">0</span><span class="o">;</span>
<span class="err">}</span><span class="o">;</span>

<span class="nt">class</span><span class="w"> </span><span class="nt">Child</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nt">public</span><span class="w"> </span><span class="nt">IDemo</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">public</span><span class="p">:</span>
<span class="w">        </span><span class="n">virtual</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="nf">OverrideMe</span><span class="p">()</span>
<span class="w">        </span><span class="err">{</span>
<span class="w">            </span><span class="o">//</span><span class="w"> </span><span class="n">do</span><span class="w"> </span><span class="n">stuff</span>
<span class="w">        </span><span class="p">}</span>
<span class="err">}</span><span class="o">;</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/are-double-square-brackets-preferable-over-single-square-brackets-in-bash/" class="u-url">Are double square brackets [[ ]] preferable over single square brackets [ ] in Bash?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/are-double-square-brackets-preferable-over-single-square-brackets-in-bash/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T10:55:35+08:00" itemprop="datePublished" title="2023-02-17 10:55">2023-02-17 10:55</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>A coworker claimed recently in a code review that the <code>[[ ]]</code> construct is to
be preferred over <code>[ ]</code> in constructs like</p>
<div class="code"><pre class="code literal-block"><span class="k">if</span><span class="w"> </span>[<span class="w"> </span><span class="s2">"`id -nu`"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"$someuser"</span><span class="w"> </span>]<span class="w"> </span><span class="c1">; then</span>
<span class="w">     </span><span class="nv">echo</span><span class="w"> </span><span class="s2">"I love you madly, $someuser"</span>
<span class="nv">fi</span>
</pre></div>

<p>He couldn't provide a rationale. Is there one?</p>
<p><br><br></p>
<h2>Answer</h2>
<p><code>[[</code> has fewer surprises and is generally safer to use. But it is not portable
- POSIX doesn't specify what it does and only some shells support it (beside
bash, I heard ksh supports it too). For example, you can do</p>
<div class="code"><pre class="code literal-block">[[ -e $b ]]
</pre></div>

<p>to test whether a file exists. But with <code>[</code>, you have to quote <code>$b</code>, because
it splits the argument and expands things like <code>"a*"</code> (where <code>[[</code> takes it
literally). That has also to do with how <code>[</code> can be an external program and
receives its argument just normally like every other program (although it can
also be a builtin, but then it still has not this special handling).</p>
<p><code>[[</code> also has some other nice features, like regular expression matching with
<code>=~</code> along with operators like they are known in C-like languages. Here is a
good page about it: What is the difference between test, <code>[</code> and <code>[[</code> ? and
Bash Tests</p>
<p><br></p>
<h3>Suggest</h3>
<p><strong>Behavior differences</strong></p>
<p>Some differences on Bash 4.3.11:</p>
<ul>
<li>
<p>POSIX vs Bash extension:</p>
<ul>
<li>
<code>[</code> is POSIX</li>
<li>
<code>[[</code> is a Bash extension inspired from KornShell</li>
<li>
<p>regular command vs magic</p>
</li>
<li>
<p><code>[</code> is just a regular command with a weird name.</p>
</li>
</ul>
</li>
</ul>
<p><code>]</code> is just the last argument of <code>[</code>.</p>
<p>Ubuntu 16.04 actually has an executable for it at <code>/usr/bin/[</code> provided by
coreutils, but the Bash built-in version takes precedence.</p>
<p>Nothing is altered in the way that Bash parses the command.</p>
<p>In particular, <code>&lt;</code> is redirection, <code>&amp;&amp;</code> and <code>||</code> concatenate multiple
commands, <code>( )</code> generates subshells unless escaped by <code>\</code>, and word expansion
happens as usual.</p>
<div class="code"><pre class="code literal-block"><span class="o">*</span><span class="w"> </span><span class="n n-Quoted">`[[ X ]]`</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="n">construct</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">makes</span><span class="w"> </span><span class="n n-Quoted">`X`</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">parsed</span><span class="w"> </span><span class="n">magically</span><span class="p">.</span><span class="w"> </span><span class="n n-Quoted">`&lt;`</span><span class="p">,</span><span class="w"> </span><span class="n n-Quoted">`&amp;&amp;`</span><span class="p">,</span><span class="w"> </span><span class="n n-Quoted">`||`</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n n-Quoted">`()`</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">treated</span><span class="w"> </span><span class="n">specially</span><span class="p">,</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">word</span><span class="w"> </span><span class="n">splitting</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">different</span><span class="p">.</span>
</pre></div>

<p>There are also further differences like <code>=</code> and <code>=~</code>.</p>
<p>In Bashese: <code>[</code> is a built-in command, and <code>[[</code> is a keyword: <em>What's the
difference between shell builtin and shell keyword?</em></p>
<ul>
<li>
<p><code>&lt;</code></p>
<ul>
<li>
<code>[[ a &lt; b ]]</code>: lexicographical comparison</li>
<li>
<code>[ a \&lt; b ]</code>: Same as above. <code>\</code> required or else does redirection like for any other command. Bash extension.</li>
<li>
<code>expr x"$x" \&lt; x"$y" &gt; /dev/null</code> or <code>[ "$(expr x"$x" \&lt; x"$y")" = 1 ]</code>: POSIX equivalents, see: <em>How to test strings for lexicographic less than or equal in Bash?</em>
</li>
<li>
<p><code>&amp;&amp;</code> and <code>||</code></p>
</li>
<li>
<p><code>[[ a = a &amp;&amp; b = b ]]</code>: true, logical <em>and</em></p>
</li>
<li>
<code>[ a = a &amp;&amp; b = b ]</code>: syntax error, <code>&amp;&amp;</code> parsed as an AND command separator <code>cmd1 &amp;&amp; cmd2</code>
</li>
<li>
<code>[ a = a ] &amp;&amp; [ b = b ]</code>: POSIX reliable equivalent</li>
<li>
<code>[ a = a -a b = b ]</code>: almost equivalent, but deprecated by POSIX because it is insane and fails for some values of <code>a</code> or <code>b</code> like <code>!</code> or <code>(</code> which would be interpreted as logical operations</li>
<li>
<p><code>(</code></p>
</li>
<li>
<p><code>[[ (a = a || a = b) &amp;&amp; a = b ]]</code>: false. Without <code>( )</code> it would be true, because <code>[[ &amp;&amp; ]]</code> has greater precedence than <code>[[ || ]]</code></p>
</li>
<li>
<code>[ ( a = a ) ]</code>: syntax error, <code>()</code> is interpreted as a subshell</li>
<li>
<code>[ \( a = a -o a = b \) -a a = b ]</code>: equivalent, but <code>()</code>, <code>-a</code>, and <code>-o</code> are deprecated by POSIX. Without <code>\( \)</code> it would be true, because <code>-a</code> has greater precedence than <code>-o</code>
</li>
<li>
<code>{ [ a = a ] || [ a = b ]; } &amp;&amp; [ a = b ]</code> non-deprecated POSIX equivalent. In this particular case however, we could have written just: <code>[ a = a ] || [ a = b ] &amp;&amp; [ a = b ]</code>, because the <code>||</code> and <code>&amp;&amp;</code> shell operators have equal precedence, unlike <code>[[ || ]]</code> and <code>[[ &amp;&amp; ]]</code> and <code>-o</code>, <code>-a</code> and <code>[</code>
</li>
<li>
<p>word splitting and filename generation upon expansions (split+glob)</p>
</li>
<li>
<p><code>x='a b'; [[ $x = 'a b' ]]</code>: true. Quotes are not needed</p>
</li>
<li>
<code>x='a b'; [ $x = 'a b' ]</code>: syntax error. It expands to <code>[ a b = 'a b' ]</code>
</li>
<li>
<code>x='*'; [ $x = 'a b' ]</code>: syntax error if there's more than one file in the current directory.</li>
<li>
<code>x='a b'; [ "$x" = 'a b' ]</code>: POSIX equivalent</li>
<li>
<p><code>=</code></p>
</li>
<li>
<p><code>[[ ab = a? ]]</code>: true, because it does pattern matching (<code>* ? [</code> are magic). Does not glob expand to files in the current directory.</p>
</li>
<li>
<code>[ ab = a? ]</code>: <code>a?</code> glob expands. So it may be true or false depending on the files in the current directory.</li>
<li>
<code>[ ab = a\? ]</code>: false, not glob expansion</li>
<li>
<code>=</code> and <code>==</code> are the same in both <code>[</code> and <code>[[</code>, but <code>==</code> is a Bash extension.</li>
<li>
<code>case ab in (a?) echo match; esac</code>: POSIX equivalent</li>
<li>
<code>[[ ab =~ 'ab?' ]]</code>: false, loses magic with <code>''</code> in Bash 3.2 and above and provided compatibility to Bash 3.1 is not enabled (like with <code>BASH_COMPAT=3.1</code>)</li>
<li>
<code>[[ ab? =~ 'ab?' ]]</code>: true</li>
<li>
<p><code>=~</code></p>
</li>
<li>
<p><code>[[ ab =~ ab? ]]</code>: true. POSIX extended regular expression match and <code>?</code> does not glob expand</p>
</li>
<li>
<code>[ a =~ a ]</code>: syntax error. No Bash equivalent.</li>
<li>
<code>printf 'ab\n' | grep -Eq 'ab?'</code>: POSIX equivalent (single-line data only)</li>
<li>
<code>awk 'BEGIN{exit !(ARGV[1] ~ ARGV[2])}' ab 'ab?'</code>: POSIX equivalent.</li>
</ul>
</li>
</ul>
<p><strong>Recommendation: always use<code>[]</code></strong></p>
<p>There are POSIX equivalents for every <code>[[ ]]</code> construct I've seen.</p>
<p>If you use <code>[[ ]]</code> you:</p>
<ul>
<li>lose portability</li>
<li>force the reader to learn the intricacies of another Bash extension. <code>[</code> is just a regular command with a weird name, and no special semantics are involved.</li>
</ul>
<p>Thanks to Stéphane Chazelas for important corrections and additions.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/what-s-the-difference-between-struct-and-class-in-net/" class="u-url">What's the difference between struct and class in .NET?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/what-s-the-difference-between-struct-and-class-in-net/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T10:55:07+08:00" itemprop="datePublished" title="2023-02-17 10:55">2023-02-17 10:55</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>What's the difference between struct and class in .NET?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>In .NET, there are two categories of types, <em>reference types</em> and <em>value
types</em>.</p>
<p>Structs are <em>value types</em> and classes are <em>reference types</em>.</p>
<p>The general difference is that a <em>reference type</em> lives on the heap, and a
<em>value type</em> lives inline, that is, wherever it is your variable or field is
defined.</p>
<p>A variable containing a <em>value type</em> contains the entire <em>value type</em> value.
For a struct, that means that the variable contains the entire struct, with
all its fields.</p>
<p>A variable containing a <em>reference type</em> contains a pointer, or a <em>reference</em>
to somewhere else in memory where the actual value resides.</p>
<p>This has one benefit, to begin with:</p>
<ul>
<li>
<em>value types</em> always contains a value</li>
<li>
<em>reference types</em> can contain a <em>null</em> -reference, meaning that they don't refer to anything at all at the moment</li>
</ul>
<p>Internally, <em>reference type</em> s are implemented as pointers, and knowing that,
and knowing how variable assignment works, there are other behavioral
patterns:</p>
<ul>
<li>copying the contents of a <em>value type</em> variable into another variable, copies the entire contents into the new variable, making the two distinct. In other words, after the copy, changes to one won't affect the other</li>
<li>copying the contents of a <em>reference type</em> variable into another variable, copies the reference, which means you now have two references to the same <em>somewhere else</em> storage of the actual data. In other words, after the copy, changing the data in one reference will appear to affect the other as well, but only because you're really just looking at the same data both places</li>
</ul>
<p>When you declare variables or fields, here's how the two types differ:</p>
<ul>
<li>variable: <em>value type</em> lives on the stack, <em>reference type</em> lives on the stack as a pointer to somewhere in heap memory where the actual memory lives (though note Eric Lipperts article series: The Stack Is An Implementation Detail.)</li>
<li>class/struct-field: <em>value type</em> lives completely inside the type, <em>reference type</em> lives inside the type as a pointer to somewhere in heap memory where the actual memory lives.</li>
</ul>
<p><br></p>
<h3>Suggest</h3>
<p>A short summary of each:</p>
<p><strong>Classes Only:</strong></p>
<ul>
<li>Can support inheritance</li>
<li>Are reference (pointer) types</li>
<li>The reference can be null</li>
<li>Have memory overhead per new instance</li>
</ul>
<p><strong>Structs Only:</strong></p>
<ul>
<li>Cannot support inheritance</li>
<li>Are value types</li>
<li>Are passed by value (like integers)</li>
<li>Cannot have a null reference (unless Nullable is used)</li>
<li>Do not have a memory overhead per new instance - unless 'boxed'</li>
</ul>
<p><strong>Both Classes and Structs:</strong></p>
<ul>
<li>Are compound data types typically used to contain a few variables that have some logical relationship</li>
<li>Can contain methods and events</li>
<li>Can support interfaces</li>
</ul>
</div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-597.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-595.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
