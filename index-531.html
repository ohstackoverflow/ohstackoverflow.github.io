<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 531) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-531.html">
<link rel="prev" href="index-532.html" type="text/html">
<link rel="next" href="index-530.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-remove-items-from-a-list-while-iterating/" class="u-url">How to remove items from a list while iterating?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-remove-items-from-a-list-while-iterating/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T09:15:34+08:00" itemprop="datePublished" title="2023-02-17 09:15">2023-02-17 09:15</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p><strong>This question's answers are a community effort</strong>. Edit existing answers to
improve this post. It is not currently accepting new answers or interactions.</p>
<p>I'm iterating over a list of tuples in Python, and am attempting to remove
them if they meet certain criteria.</p>
<div class="code"><pre class="code literal-block"><span class="k">for</span><span class="w"> </span><span class="nv">tup</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">somelist</span>:
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nv">determine</span><span class="ss">(</span><span class="nv">tup</span><span class="ss">)</span>:
<span class="w">         </span><span class="nv">code_to_remove_tup</span>
</pre></div>

<p>What should I use in place of <code>code_to_remove_tup</code>? I can't figure out how to
remove the item in this fashion.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>You can use a list comprehension to create a new list containing only the
elements you don't want to remove:</p>
<div class="code"><pre class="code literal-block"><span class="nv">somelist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>[<span class="nv">x</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">somelist</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nv">not</span><span class="w"> </span><span class="nv">determine</span><span class="ss">(</span><span class="nv">x</span><span class="ss">)</span>]
</pre></div>

<p>Or, by assigning to the slice <code>somelist[:]</code>, you can mutate the existing list
to contain only the items you want:</p>
<div class="code"><pre class="code literal-block"><span class="nv">somelist</span>[:]<span class="w"> </span><span class="o">=</span><span class="w"> </span>[<span class="nv">x</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">somelist</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nv">not</span><span class="w"> </span><span class="nv">determine</span><span class="ss">(</span><span class="nv">x</span><span class="ss">)</span>]
</pre></div>

<p>This approach could be useful if there are other references to <code>somelist</code> that
need to reflect the changes.</p>
<p>Instead of a comprehension, you could also use <code>itertools</code>. In Python 2:</p>
<div class="code"><pre class="code literal-block"><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">ifilterfalse</span>
<span class="n">somelist</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">ifilterfalse</span><span class="p">(</span><span class="n">determine</span><span class="p">,</span> <span class="n">somelist</span><span class="p">)</span>
</pre></div>

<p>Or in Python 3:</p>
<div class="code"><pre class="code literal-block"><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">filterfalse</span>
<span class="n">somelist</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">filterfalse</span><span class="p">(</span><span class="n">determine</span><span class="p">,</span> <span class="n">somelist</span><span class="p">)</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>The answers suggesting list comprehensions are <em>almost</em> correct—except that
they build a completely new list and then give it the same name the old list
as, they do <em>not</em> modify the old list in place. That's different from what
you'd be doing by selective removal, as in Lennart's suggestion—it's faster,
but if your list is accessed via multiple references the fact that you're just
reseating one of the references and <em>not</em> altering the list object itself can
lead to subtle, disastrous bugs.</p>
<p>Fortunately, it's extremely easy to get both the speed of list comprehensions
AND the required semantics of in-place alteration—just code:</p>
<div class="code"><pre class="code literal-block"><span class="nv">somelist</span>[:]<span class="w"> </span><span class="o">=</span><span class="w"> </span>[<span class="nv">tup</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">tup</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">somelist</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nv">determine</span><span class="ss">(</span><span class="nv">tup</span><span class="ss">)</span>]
</pre></div>

<p>Note the subtle difference with other answers: this one is <em>not</em> assigning to
a barename. It's assigning to a list slice that just happens to be the entire
list, thereby replacing the list <em>contents</em> <strong>within the same Python list
object</strong> , rather than just reseating one reference (from the previous list
object to the new list object) like the other answers.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/insert-ignore-vs-insert-on-duplicate-key-update/" class="u-url">"INSERT IGNORE" vs "INSERT ... ON DUPLICATE KEY UPDATE"</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/insert-ignore-vs-insert-on-duplicate-key-update/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T09:15:06+08:00" itemprop="datePublished" title="2023-02-17 09:15">2023-02-17 09:15</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>While executing an <code>INSERT</code> statement with many rows, I want to skip duplicate
entries that would otherwise cause failure. After some research, my options
appear to be the use of either:</p>
<ul>
<li>
<code>ON DUPLICATE KEY UPDATE</code> which implies an unnecessary update at some cost, or</li>
<li>
<code>INSERT IGNORE</code> implies an invitation for other kinds of failure to slip in unannounced.</li>
</ul>
<p>Am I right in these assumptions? What's the best way to simply skip the rows
that might cause duplicates and just continue on to the other rows?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>I would recommend using <code>INSERT...ON DUPLICATE KEY UPDATE</code>.</p>
<p>If you use <code>INSERT IGNORE</code>, then the row won't actually be inserted if it
results in a duplicate key. But the statement won't generate an error. It
generates a warning instead. These cases include:</p>
<ul>
<li>Inserting a duplicate key in columns with <code>PRIMARY KEY</code> or <code>UNIQUE</code> constraints. </li>
<li>Inserting a NULL into a column with a <code>NOT NULL</code> constraint.</li>
<li>Inserting a row to a partitioned table, but the values you insert don't map to a partition.</li>
</ul>
<p>If you use <code>REPLACE</code>, MySQL actually does a <code>DELETE</code> followed by an <code>INSERT</code>
internally, which has some unexpected side effects:</p>
<ul>
<li>A new auto-increment ID is allocated.</li>
<li>Dependent rows with foreign keys may be deleted (if you use cascading foreign keys) or else prevent the <code>REPLACE</code>.</li>
<li>Triggers that fire on <code>DELETE</code> are executed unnecessarily.</li>
<li>Side effects are propagated to replicas too.</li>
</ul>
<p><strong>correction:</strong> both <code>REPLACE</code> and <code>INSERT...ON DUPLICATE KEY UPDATE</code> are non-
standard, proprietary inventions specific to MySQL. ANSI SQL 2003 defines a
<code>MERGE</code> statement that can solve the same need (and more), but MySQL does not
support the <code>MERGE</code> statement.</p>
<hr>
<p>A user tried to edit this post (the edit was rejected by moderators). The edit
tried to add a claim that <code>INSERT...ON DUPLICATE KEY UPDATE</code> causes a new
auto-increment id to be allocated. It's true that the new id is <em>generated</em> ,
but it is not used in the changed row.</p>
<p>See demonstration below, tested with Percona Server 5.5.28. The configuration
variable <code>innodb_autoinc_lock_mode=1</code> (the default):</p>
<div class="code"><pre class="code literal-block"><span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="k">create</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="kt">serial</span><span class="w"> </span><span class="k">primary</span><span class="w"> </span><span class="k">key</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="k">unique</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="p">));</span>
<span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="k">values</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">foo</span><span class="p">;</span>
<span class="o">+----+------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">u</span><span class="w">    </span><span class="o">|</span>
<span class="o">+----+------+</span>
<span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="o">|</span><span class="w">   </span><span class="mi">10</span><span class="w"> </span><span class="o">|</span>
<span class="o">+----+------+</span>

<span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="k">create</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">foo</span><span class="err">\</span><span class="n">G</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n n-Quoted">`foo`</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="n n-Quoted">`id`</span><span class="w"> </span><span class="kt">bigint</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">unsigned</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="no">NULL</span><span class="w"> </span><span class="k">AUTO_INCREMENT</span><span class="p">,</span>
<span class="w">  </span><span class="n n-Quoted">`u`</span><span class="w"> </span><span class="kt">int</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="no">NULL</span><span class="p">,</span>
<span class="w">  </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n n-Quoted">`id`</span><span class="p">),</span>
<span class="w">  </span><span class="k">UNIQUE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="n n-Quoted">`u`</span><span class="w"> </span><span class="p">(</span><span class="n n-Quoted">`u`</span><span class="p">)</span>
<span class="p">)</span><span class="w"> </span><span class="k">ENGINE</span><span class="o">=</span><span class="n">InnoDB</span><span class="w"> </span><span class="k">AUTO_INCREMENT</span><span class="o">=</span><span class="mi">2</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CHARSET</span><span class="o">=</span><span class="n">latin1</span>

<span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="k">values</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="k">duplicate</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="k">update</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span>
<span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">foo</span><span class="p">;</span>
<span class="o">+----+------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">u</span><span class="w">    </span><span class="o">|</span>
<span class="o">+----+------+</span>
<span class="o">|</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="o">|</span><span class="w">   </span><span class="mi">20</span><span class="w"> </span><span class="o">|</span>
<span class="o">+----+------+</span>

<span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="k">create</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">foo</span><span class="err">\</span><span class="n">G</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n n-Quoted">`foo`</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="n n-Quoted">`id`</span><span class="w"> </span><span class="kt">bigint</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">unsigned</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="no">NULL</span><span class="w"> </span><span class="k">AUTO_INCREMENT</span><span class="p">,</span>
<span class="w">  </span><span class="n n-Quoted">`u`</span><span class="w"> </span><span class="kt">int</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="no">NULL</span><span class="p">,</span>
<span class="w">  </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n n-Quoted">`id`</span><span class="p">),</span>
<span class="w">  </span><span class="k">UNIQUE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="n n-Quoted">`u`</span><span class="w"> </span><span class="p">(</span><span class="n n-Quoted">`u`</span><span class="p">)</span>
<span class="p">)</span><span class="w"> </span><span class="k">ENGINE</span><span class="o">=</span><span class="n">InnoDB</span><span class="w"> </span><span class="k">AUTO_INCREMENT</span><span class="o">=</span><span class="mi">3</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CHARSET</span><span class="o">=</span><span class="n">latin1</span>
</pre></div>

<p>The above demonstrates that the IODKU statement detects the duplicate, and
invokes the update to change the value of <code>u</code>. Note the <code>AUTO_INCREMENT=3</code>
indicates an id was generated, but not used in the row.</p>
<p>Whereas <code>REPLACE</code> does delete the original row and inserts a new row,
generating <em>and</em> storing a new auto-increment id:</p>
<div class="code"><pre class="code literal-block"><span class="c">mysql</span><span class="nv">&gt;</span><span class="c"> select * from foo;</span>
<span class="nb">+----+------+</span>
<span class="c">| id | u    |</span>
<span class="nb">+----+------+</span>
<span class="c">|  1 |   20 |</span>
<span class="nb">+----+------+</span>
<span class="c">mysql</span><span class="nv">&gt;</span><span class="c"> replace into foo (u) values (20);</span>
<span class="c">mysql</span><span class="nv">&gt;</span><span class="c"> select * from foo;</span>
<span class="nb">+----+------+</span>
<span class="c">| id | u    |</span>
<span class="nb">+----+------+</span>
<span class="c">|  3 |   20 |</span>
<span class="nb">+----+------+</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>In case you want to see what this all means, here is a blow-by-blow of
everything:</p>
<div class="code"><pre class="code literal-block"><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n n-Quoted">`users_partners`</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="n n-Quoted">`uid`</span><span class="w"> </span><span class="kt">int</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="no">NULL</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="s1">'0'</span><span class="p">,</span>
<span class="w">  </span><span class="n n-Quoted">`pid`</span><span class="w"> </span><span class="kt">int</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="no">NULL</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="s1">'0'</span><span class="p">,</span>
<span class="w">  </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n n-Quoted">`uid`</span><span class="p">,</span><span class="n n-Quoted">`pid`</span><span class="p">),</span>
<span class="w">  </span><span class="k">KEY</span><span class="w"> </span><span class="n n-Quoted">`partner_user`</span><span class="w"> </span><span class="p">(</span><span class="n n-Quoted">`pid`</span><span class="p">,</span><span class="n n-Quoted">`uid`</span><span class="p">)</span>
<span class="p">)</span><span class="w"> </span><span class="k">ENGINE</span><span class="o">=</span><span class="n">MyISAM</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CHARSET</span><span class="o">=</span><span class="n">utf8</span>
</pre></div>

<p>The primary key is based on both columns of this quick reference table. A
Primary key requires unique values.</p>
<p>Let's begin:</p>
<div class="code"><pre class="code literal-block"><span class="nv">INSERT</span><span class="w"> </span><span class="nv">INTO</span><span class="w"> </span><span class="nv">users_partners</span><span class="w"> </span><span class="ss">(</span><span class="nv">uid</span>,<span class="nv">pid</span><span class="ss">)</span><span class="w"> </span><span class="nv">VALUES</span><span class="w"> </span><span class="ss">(</span><span class="mi">1</span>,<span class="mi">1</span><span class="ss">)</span><span class="c1">;</span>
...<span class="mi">1</span><span class="w"> </span><span class="nv">row</span><span class="ss">(</span><span class="nv">s</span><span class="ss">)</span><span class="w"> </span><span class="nv">affected</span>

<span class="nv">INSERT</span><span class="w"> </span><span class="nv">INTO</span><span class="w"> </span><span class="nv">users_partners</span><span class="w"> </span><span class="ss">(</span><span class="nv">uid</span>,<span class="nv">pid</span><span class="ss">)</span><span class="w"> </span><span class="nv">VALUES</span><span class="w"> </span><span class="ss">(</span><span class="mi">1</span>,<span class="mi">1</span><span class="ss">)</span><span class="c1">;</span>
...<span class="nv">Error</span><span class="w"> </span><span class="nv">Code</span><span class="w"> </span>:<span class="w"> </span><span class="mi">1062</span>
...<span class="nv">Duplicate</span><span class="w"> </span><span class="nv">entry</span><span class="w"> </span><span class="s1">'1-1'</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">key</span><span class="w"> </span><span class="s1">'PRIMARY'</span>

<span class="nv">INSERT</span><span class="w"> </span><span class="nv">IGNORE</span><span class="w"> </span><span class="nv">INTO</span><span class="w"> </span><span class="nv">users_partners</span><span class="w"> </span><span class="ss">(</span><span class="nv">uid</span>,<span class="nv">pid</span><span class="ss">)</span><span class="w"> </span><span class="nv">VALUES</span><span class="w"> </span><span class="ss">(</span><span class="mi">1</span>,<span class="mi">1</span><span class="ss">)</span><span class="c1">;</span>
...<span class="mi">0</span><span class="w"> </span><span class="nv">row</span><span class="ss">(</span><span class="nv">s</span><span class="ss">)</span><span class="w"> </span><span class="nv">affected</span>

<span class="nv">INSERT</span><span class="w"> </span><span class="nv">INTO</span><span class="w"> </span><span class="nv">users_partners</span><span class="w"> </span><span class="ss">(</span><span class="nv">uid</span>,<span class="nv">pid</span><span class="ss">)</span><span class="w"> </span><span class="nv">VALUES</span><span class="w"> </span><span class="ss">(</span><span class="mi">1</span>,<span class="mi">1</span><span class="ss">)</span><span class="w"> </span><span class="nv">ON</span><span class="w"> </span><span class="nv">DUPLICATE</span><span class="w"> </span><span class="nv">KEY</span><span class="w"> </span><span class="nv">UPDATE</span><span class="w"> </span><span class="nv">uid</span><span class="o">=</span><span class="nv">uid</span>
...<span class="mi">0</span><span class="w"> </span><span class="nv">row</span><span class="ss">(</span><span class="nv">s</span><span class="ss">)</span><span class="w"> </span><span class="nv">affected</span>
</pre></div>

<p>note, the above saved too much extra work by setting the column equal to
itself, no update actually needed</p>
<div class="code"><pre class="code literal-block">REPLACE INTO users_partners (uid,pid) VALUES (1,1)
...2 row(s) affected
</pre></div>

<p>and now some multiple row tests:</p>
<div class="code"><pre class="code literal-block"><span class="nv">INSERT</span><span class="w"> </span><span class="nv">INTO</span><span class="w"> </span><span class="nv">users_partners</span><span class="w"> </span><span class="ss">(</span><span class="nv">uid</span>,<span class="nv">pid</span><span class="ss">)</span><span class="w"> </span><span class="nv">VALUES</span><span class="w"> </span><span class="ss">(</span><span class="mi">1</span>,<span class="mi">1</span><span class="ss">)</span>,<span class="ss">(</span><span class="mi">1</span>,<span class="mi">2</span><span class="ss">)</span>,<span class="ss">(</span><span class="mi">1</span>,<span class="mi">3</span><span class="ss">)</span>,<span class="ss">(</span><span class="mi">1</span>,<span class="mi">4</span><span class="ss">)</span>
...<span class="nv">Error</span><span class="w"> </span><span class="nv">Code</span><span class="w"> </span>:<span class="w"> </span><span class="mi">1062</span>
...<span class="nv">Duplicate</span><span class="w"> </span><span class="nv">entry</span><span class="w"> </span><span class="s1">'1-1'</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">key</span><span class="w"> </span><span class="s1">'PRIMARY'</span>

<span class="nv">INSERT</span><span class="w"> </span><span class="nv">IGNORE</span><span class="w"> </span><span class="nv">INTO</span><span class="w"> </span><span class="nv">users_partners</span><span class="w"> </span><span class="ss">(</span><span class="nv">uid</span>,<span class="nv">pid</span><span class="ss">)</span><span class="w"> </span><span class="nv">VALUES</span><span class="w"> </span><span class="ss">(</span><span class="mi">1</span>,<span class="mi">1</span><span class="ss">)</span>,<span class="ss">(</span><span class="mi">1</span>,<span class="mi">2</span><span class="ss">)</span>,<span class="ss">(</span><span class="mi">1</span>,<span class="mi">3</span><span class="ss">)</span>,<span class="ss">(</span><span class="mi">1</span>,<span class="mi">4</span><span class="ss">)</span>
...<span class="mi">3</span><span class="w"> </span><span class="nv">row</span><span class="ss">(</span><span class="nv">s</span><span class="ss">)</span><span class="w"> </span><span class="nv">affected</span>
</pre></div>

<p>no other messages were generated in the console, and it now has those 4 values
in the table data. I deleted everything except (1,1) so I could test from the
same playing field</p>
<div class="code"><pre class="code literal-block">INSERT INTO users_partners (uid,pid) VALUES (1,1),(1,2),(1,3),(1,4) ON DUPLICATE KEY UPDATE uid=uid
...3 row(s) affected

REPLACE INTO users_partners (uid,pid) VALUES (1,1),(1,2),(1,3),(1,4)
...5 row(s) affected
</pre></div>

<p>So there you have it. Since this was all performed on a fresh table with
nearly no data and not in production, the times for execution were microscopic
and irrelevant. Anyone with real-world data would be more than welcome to
contribute it.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/change-the-selected-value-of-a-drop-down-list-with-jquery/" class="u-url">Change the selected value of a drop-down list with jQuery</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/change-the-selected-value-of-a-drop-down-list-with-jquery/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T09:14:38+08:00" itemprop="datePublished" title="2023-02-17 09:14">2023-02-17 09:14</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I have a drop-down list with known values. What I'm trying to do is set the
drop down list to a particular value that I know exists using <strong>jQuery</strong>.
Using regular <strong>JavaScript</strong> , I would do something like:</p>
<div class="code"><pre class="code literal-block">ddl = document.getElementById("ID of element goes here");
ddl.value = 2; // 2 being the value I want to set it too.
</pre></div>

<p>However, I need to do this with <strong>jQuery</strong> , because I'm using a <strong>CSS</strong> class
for my selector (stupid ASP.NET client ids...).</p>
<p>Here are a few things I've tried:</p>
<div class="code"><pre class="code literal-block">$("._statusDDL").val(2); // Doesn't find 2 as a value.
$("._statusDDL").children("option").val(2) // Also failed.
</pre></div>

<blockquote>
<p>How can I do it with <strong>jQuery</strong>?</p>
</blockquote>
<hr>
<p><strong>Update</strong></p>
<p>So as it turns out, I had it right the first time with:</p>
<div class="code"><pre class="code literal-block">$("._statusDDL").val(2);
</pre></div>

<p>When I put an alert just above it works fine, but when I remove the alert and
let it run at full speed, I get the error</p>
<blockquote>
<p>Could not set the selected property. Invalid Index</p>
</blockquote>
<p>I'm not sure if it's a bug with jQuery or <strong>Internet Explorer 6</strong> (I'm
guessing Internet <strong>Explorer 6</strong> ), but it's terribly annoying.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>jQuery's documentation states:</p>
<blockquote>
<p>[jQuery.val] checks, or <em><strong>selects</strong></em> , all the radio buttons, checkboxes,
and select options that match the set of values.</p>
</blockquote>
<p>This behavior is in <code>jQuery</code> versions <code>1.2</code> and above.</p>
<p>You most likely want this:</p>
<div class="code"><pre class="code literal-block">$("._statusDDL").val('2');
</pre></div>

<p>Add <code>.change()</code> to see the option in the dropdown list frontend:</p>
<div class="code"><pre class="code literal-block">$("._statusDDL").val('2').change();
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>With hidden field you need to use like this:</p>
<div class="code"><pre class="code literal-block">$("._statusDDL").val(2);
$("._statusDDL").change();
</pre></div>

<p>or</p>
<div class="code"><pre class="code literal-block">$("._statusDDL").val(2).change();
</pre></div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-532.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-530.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
