<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 2124) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-2124.html">
<link rel="prev" href="index-2125.html" type="text/html">
<link rel="next" href="index-2123.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-dynamically-change-header-based-on-angularjs-partial-view/" class="u-url">How to dynamically change header based on AngularJS partial view?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-dynamically-change-header-based-on-angularjs-partial-view/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T17:29:56+08:00" itemprop="datePublished" title="2023-03-03 17:29">2023-03-03 17:29</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I am using ng-view to include AngularJS partial views, and I want to update
the page title and h1 header tags based on the included view. These are out of
scope of the partial view controllers though, and so I can't figure out how to
bind them to data set in the controllers.</p>
<p>If it was ASP.NET MVC you could use @ViewBag to do this, but I don't know the
equivalent in AngularJS. I've searched about shared services, events etc but
still can't get it working. Any way to modify my example so it works would be
much appreciated.</p>
<p>My HTML:</p>
<div class="code"><pre class="code literal-block"><span class="nt">&lt;html</span><span class="w"> </span><span class="na">data-ng-app=</span><span class="s">"myModule"</span><span class="nt">&gt;</span>
<span class="nt">&lt;head&gt;</span>
<span class="cm">&lt;!-- include js files --&gt;</span>
<span class="nt">&lt;title&gt;</span><span class="cm">&lt;!-- should changed when ng-view changes --&gt;</span><span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
<span class="nt">&lt;h1&gt;</span><span class="cm">&lt;!-- should changed when ng-view changes --&gt;</span><span class="nt">&lt;/h1&gt;</span>

<span class="nt">&lt;div</span><span class="w"> </span><span class="err">data-ng-view</span><span class="nt">&gt;&lt;/div&gt;</span>

<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>

<p>My JavaScript:</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">myModule</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">angular</span><span class="o">.</span><span class="n">module</span><span class="p">(</span><span class="s1">'myModule'</span><span class="p">,</span><span class="w"> </span><span class="p">[]);</span>
<span class="n">myModule</span><span class="o">.</span><span class="n">config</span><span class="p">([</span><span class="s1">'$routeProvider'</span><span class="p">,</span><span class="w"> </span><span class="n">function</span><span class="p">(</span><span class="o">$</span><span class="n">routeProvider</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="o">$</span><span class="n">routeProvider</span><span class="o">.</span>
<span class="w">        </span><span class="n">when</span><span class="p">(</span><span class="s1">'/test1'</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="n">templateUrl</span><span class="p">:</span><span class="w"> </span><span class="s1">'test1.html'</span><span class="p">,</span><span class="w"> </span><span class="n">controller</span><span class="p">:</span><span class="w"> </span><span class="n">Test1Ctrl</span><span class="p">})</span><span class="o">.</span>
<span class="w">        </span><span class="n">when</span><span class="p">(</span><span class="s1">'/test2'</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="n">templateUrl</span><span class="p">:</span><span class="w"> </span><span class="s1">'test2.html'</span><span class="p">,</span><span class="w"> </span><span class="n">controller</span><span class="p">:</span><span class="w"> </span><span class="n">Test2Ctrl</span><span class="p">})</span><span class="o">.</span>
<span class="w">        </span><span class="n">otherwise</span><span class="p">({</span><span class="n">redirectTo</span><span class="p">:</span><span class="w"> </span><span class="s1">'/test1'</span><span class="p">});</span>
<span class="p">}]);</span>

<span class="n">function</span><span class="w"> </span><span class="n">Test1Ctrl</span><span class="p">(</span><span class="o">$</span><span class="n">scope</span><span class="p">,</span><span class="w"> </span><span class="o">$</span><span class="n">http</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="o">$</span><span class="n">scope</span><span class="o">.</span><span class="n">header</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Test 1"</span><span class="p">;</span><span class="w"> </span>
<span class="w">                                  </span><span class="o">/*</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">how</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="n">put</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">title</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">h1</span><span class="w"> </span><span class="o">*/</span><span class="w"> </span><span class="p">}</span>
<span class="n">function</span><span class="w"> </span><span class="n">Test2Ctrl</span><span class="p">(</span><span class="o">$</span><span class="n">scope</span><span class="p">,</span><span class="w"> </span><span class="o">$</span><span class="n">http</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="o">$</span><span class="n">scope</span><span class="o">.</span><span class="n">header</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Test 2"</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<p>You could define controller at the <code>&lt;html&gt;</code> level.</p>
<div class="code"><pre class="code literal-block"><span class="w"> </span><span class="nt">&lt;html</span><span class="w"> </span><span class="na">ng-app=</span><span class="s">"app"</span><span class="w"> </span><span class="na">ng-controller=</span><span class="s">"titleCtrl"</span><span class="nt">&gt;</span>
<span class="w">   </span><span class="nt">&lt;head&gt;</span>
<span class="w">     </span><span class="nt">&lt;title&gt;</span><span class="cp">{{</span> <span class="nv">Page.title</span><span class="o">()</span> <span class="cp">}}</span><span class="nt">&lt;/title&gt;</span>
<span class="w"> </span>...
</pre></div>

<p>You create service: <code>Page</code> and modify from controllers.</p>
<div class="code"><pre class="code literal-block"><span class="n">myModule</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="s1">'Page'</span><span class="p">,</span><span class="w"> </span><span class="n">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="k">var</span><span class="w"> </span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'default'</span><span class="p">;</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="n">title</span><span class="p">:</span><span class="w"> </span><span class="n">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">title</span><span class="p">;</span><span class="w"> </span><span class="p">},</span>
<span class="w">     </span><span class="n">setTitle</span><span class="p">:</span><span class="w"> </span><span class="n">function</span><span class="p">(</span><span class="n">newTitle</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newTitle</span><span class="w"> </span><span class="p">}</span>
<span class="w">   </span><span class="p">};</span>
<span class="p">});</span>
</pre></div>

<p>Inject <code>Page</code> and Call 'Page.setTitle()' from controllers.</p>
<p>Here is the concrete example: http://plnkr.co/edit/0e7T6l</p>
<p><br></p>
<h3>Suggest</h3>
<p>You could define controller at the <code>&lt;html&gt;</code> level.</p>
<div class="code"><pre class="code literal-block"><span class="w"> </span><span class="nt">&lt;html</span><span class="w"> </span><span class="na">ng-app=</span><span class="s">"app"</span><span class="w"> </span><span class="na">ng-controller=</span><span class="s">"titleCtrl"</span><span class="nt">&gt;</span>
<span class="w">   </span><span class="nt">&lt;head&gt;</span>
<span class="w">     </span><span class="nt">&lt;title&gt;</span><span class="cp">{{</span> <span class="nv">Page.title</span><span class="o">()</span> <span class="cp">}}</span><span class="nt">&lt;/title&gt;</span>
<span class="w"> </span>...
</pre></div>

<p>You create service: <code>Page</code> and modify from controllers.</p>
<div class="code"><pre class="code literal-block"><span class="n">myModule</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="s1">'Page'</span><span class="p">,</span><span class="w"> </span><span class="n">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="k">var</span><span class="w"> </span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'default'</span><span class="p">;</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="n">title</span><span class="p">:</span><span class="w"> </span><span class="n">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">title</span><span class="p">;</span><span class="w"> </span><span class="p">},</span>
<span class="w">     </span><span class="n">setTitle</span><span class="p">:</span><span class="w"> </span><span class="n">function</span><span class="p">(</span><span class="n">newTitle</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newTitle</span><span class="w"> </span><span class="p">}</span>
<span class="w">   </span><span class="p">};</span>
<span class="p">});</span>
</pre></div>

<p>Inject <code>Page</code> and Call 'Page.setTitle()' from controllers.</p>
<p>Here is the concrete example: http://plnkr.co/edit/0e7T6l</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/if-a-dom-element-is-removed-are-its-listeners-also-removed-from-memory/" class="u-url">If a DOM Element is removed, are its listeners also removed from memory?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/if-a-dom-element-is-removed-are-its-listeners-also-removed-from-memory/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T17:29:34+08:00" itemprop="datePublished" title="2023-03-03 17:29">2023-03-03 17:29</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>If a DOM Element is removed, are its listeners removed from memory too?</p>
<p><br><br></p>
<h2>Answer</h2>
<h3>Modern browsers</h3>
<p><strong>Plain JavaScript</strong></p>
<p>If a DOM element which is removed is reference-free (no references pointing to
it) then <strong>yes</strong> - the element itself is picked up by the garbage collector
as well as any event handlers/listeners associated with it.</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">document</span><span class="o">.</span><span class="n">createElement</span><span class="p">(</span><span class="s1">'div'</span><span class="p">);</span>
<span class="k">var</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">document</span><span class="o">.</span><span class="n">createElement</span><span class="p">(</span><span class="s1">'p'</span><span class="p">);</span>
<span class="o">//</span><span class="w"> </span><span class="n">Add</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="n">listeners</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="n">etc</span><span class="o">...</span>
<span class="n">a</span><span class="o">.</span><span class="n">appendChild</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>
<span class="n">a</span><span class="o">.</span><span class="n">removeChild</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>
<span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb nb-Type">null</span><span class="p">;</span><span class="w"> </span>
<span class="o">//</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="n">reference</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="s1">'b'</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">longer</span><span class="w"> </span><span class="n">exists</span><span class="w"> </span>
<span class="o">//</span><span class="w"> </span><span class="n">Therefore</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">element</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="n">listeners</span><span class="w"> </span><span class="n">attached</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">removed</span><span class="o">.</span>
</pre></div>

<p>However; if there are references that still point to said element, the element
and its event listeners are retained in memory.</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">document</span><span class="o">.</span><span class="n">createElement</span><span class="p">(</span><span class="s1">'div'</span><span class="p">);</span>
<span class="k">var</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">document</span><span class="o">.</span><span class="n">createElement</span><span class="p">(</span><span class="s1">'p'</span><span class="p">);</span><span class="w"> </span>
<span class="o">//</span><span class="w"> </span><span class="n">Add</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="n">listeners</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="n">etc</span><span class="o">...</span>
<span class="n">a</span><span class="o">.</span><span class="n">appendChild</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>
<span class="n">a</span><span class="o">.</span><span class="n">removeChild</span><span class="p">(</span><span class="n">b</span><span class="p">);</span><span class="w"> </span>
<span class="o">//</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="n">reference</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="s1">'b'</span><span class="w"> </span><span class="n">still</span><span class="w"> </span><span class="n">exists</span><span class="w"> </span>
<span class="o">//</span><span class="w"> </span><span class="n">Therefore</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">element</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">associated</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="n">listeners</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">still</span><span class="w"> </span><span class="n">retained</span><span class="o">.</span>
</pre></div>

<p><strong>jQuery</strong></p>
<p>It would be fair to assume that the relevant methods in jQuery (such as
<code>remove()</code>) would function in the exact same way (considering <code>remove()</code> was
written using <code>removeChild()</code> for example).</p>
<p>However, <strong>this isn't true</strong> ; the jQuery library actually has an internal
method (which is undocumented and in theory could be changed at any time)
called <code>cleanData()</code> (here is what this method looks like) which automatically
cleans up all the data/events associated with an element upon removal from the
DOM (be this via. <code>remove()</code>, <code>empty()</code>, <code>html("")</code> etc).</p>
<hr>
<h3>Older browsers</h3>
<p>Older browsers - specifically older versions of IE - are known to have memory
leak issues due to event listeners keeping hold of references to the elements
they were attached to.</p>
<p>If you want a more in-depth explanation of the causes, patterns and solutions
used to fix legacy IE version memory leaks, I fully recommend you read <strong>this
MSDN article on Understanding and Solving Internet Explorer Leak Patterns.</strong></p>
<p>A few more articles relevant to this:</p>
<ul>
<li>JScript memory leaks</li>
<li>Memory leaks in IE8</li>
<li>JavaScript Memory Leaks</li>
</ul>
<p>Manually removing the listeners yourself would probably be a good habit to get
into in this case (only if the memory is that vital to your application and
you are actually targeting such browsers).</p>
<p><br></p>
<h3>Suggest</h3>
<p>regarding jQuery:</p>
<blockquote>
<p>the .remove() method takes elements out of the DOM. Use .remove() when you
want to remove the element itself, as well as everything inside it. In
addition to the elements themselves, all bound events and jQuery data
associated with the elements are removed. To remove the elements without
removing data and events, use .detach() instead.</p>
</blockquote>
<p>Reference: http://api.jquery.com/remove/</p>
<p>jQuery v1.8.2 <code>.remove()</code> source code:</p>
<div class="code"><pre class="code literal-block"><span class="nl">remove</span><span class="p">:</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="w"> </span><span class="n">selector</span><span class="p">,</span><span class="w"> </span><span class="n">keepData</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="nf">var</span><span class="w"> </span><span class="n">elem</span><span class="p">,</span>
<span class="w">        </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="p">(</span><span class="n">elem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">this</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">null</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="err">!</span><span class="n">selector</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">jQuery</span><span class="p">.</span><span class="k">filter</span><span class="p">(</span><span class="w"> </span><span class="n">selector</span><span class="p">,</span><span class="w"> </span><span class="o">[</span><span class="n"> elem </span><span class="o">]</span><span class="w"> </span><span class="p">).</span><span class="n">length</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="err">!</span><span class="n">keepData</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">elem</span><span class="p">.</span><span class="n">nodeType</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">                </span><span class="n">jQuery</span><span class="p">.</span><span class="n">cleanData</span><span class="p">(</span><span class="w"> </span><span class="n">elem</span><span class="p">.</span><span class="n">getElementsByTagName</span><span class="p">(</span><span class="ss">"*"</span><span class="p">)</span><span class="w"> </span><span class="p">);</span>
<span class="w">                </span><span class="n">jQuery</span><span class="p">.</span><span class="n">cleanData</span><span class="p">(</span><span class="w"> </span><span class="o">[</span><span class="n"> elem </span><span class="o">]</span><span class="w"> </span><span class="p">);</span>
<span class="w">            </span><span class="err">}</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">elem</span><span class="p">.</span><span class="n">parentNode</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">                </span><span class="n">elem</span><span class="p">.</span><span class="n">parentNode</span><span class="p">.</span><span class="n">removeChild</span><span class="p">(</span><span class="w"> </span><span class="n">elem</span><span class="w"> </span><span class="p">);</span>
<span class="w">            </span><span class="err">}</span>
<span class="w">        </span><span class="err">}</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this</span><span class="p">;</span>
<span class="err">}</span>
</pre></div>

<p>apparently jQuery uses <code>node.removeChild()</code></p>
<p>According to this : https://developer.mozilla.org/en-
US/docs/DOM/Node.removeChild ,</p>
<p><code>The removed child node still exists in memory, but is no longer part of the
DOM. You may reuse the removed node later in your code, via the oldChild
object reference.</code></p>
<p>ie event listeners might get removed, but <code>node</code> still exists in memory.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/what-is-the-lifetime-of-a-static-variable-in-a-c-function/" class="u-url">What is the lifetime of a static variable in a C++ function?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/what-is-the-lifetime-of-a-static-variable-in-a-c-function/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T17:29:13+08:00" itemprop="datePublished" title="2023-03-03 17:29">2023-03-03 17:29</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>If a variable is declared as <code>static</code> in a function's scope it is only
initialized once and retains its value between function calls. What exactly is
its lifetime? When do its constructor and destructor get called?</p>
<div class="code"><pre class="code literal-block">void foo() 
{ 
    static string plonk = "When will I die?";
}
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<p>The lifetime of function <code>static</code> variables begins the first time[0] the
program flow encounters the declaration and it ends at program termination.
This means that the run-time must perform some book keeping in order to
destruct it only if it was actually constructed.</p>
<p>Additionally, since the standard says that the destructors of static objects
must run in the reverse order of the completion of their construction[1], and
the order of construction may depend on the specific program run, the order of
construction must be taken into account.</p>
<p><strong>Example</strong></p>
<div class="code"><pre class="code literal-block"><span class="n">struct</span><span class="w"> </span><span class="n">emitter</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="nb">str</span><span class="p">;</span>
<span class="w">    </span><span class="n">emitter</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s2">"Created "</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="nb">str</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="o">~</span><span class="n">emitter</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s2">"Destroyed "</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="nb">str</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="p">};</span>

<span class="nb nb-Type">void</span><span class="w"> </span><span class="n">foo</span><span class="p">(</span><span class="nb nb-Type">bool</span><span class="w"> </span><span class="n">skip_first</span><span class="p">)</span><span class="w"> </span>
<span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">skip_first</span><span class="p">)</span>
<span class="w">        </span><span class="k">static</span><span class="w"> </span><span class="n">emitter</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="s2">"in if"</span><span class="p">);</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="n">emitter</span><span class="w"> </span><span class="n">b</span><span class="p">(</span><span class="s2">"in foo"</span><span class="p">);</span>
<span class="p">}</span>

<span class="nb nb-Type">int</span><span class="w"> </span><span class="n">main</span><span class="p">(</span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="nb">char</span><span class="o">*</span><span class="p">[])</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">foo</span><span class="p">(</span><span class="n">argc</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">argc</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span>
<span class="w">        </span><span class="n">foo</span><span class="p">(</span><span class="bp">false</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>

<p><strong>Output:</strong></p>
<blockquote>
<p>C:&gt;sample.exe<br>
 Created in foo<br>
 Destroyed in foo</p>
<p>C:&gt;sample.exe 1<br>
 Created in if<br>
 Created in foo<br>
 Destroyed in foo<br>
 Destroyed in if</p>
<p>C:&gt;sample.exe 1 2<br>
 Created in foo<br>
 Created in if<br>
 Destroyed in if<br>
 Destroyed in foo</p>
</blockquote>
<p><code>[0]</code> Since <strong>C++98</strong> [2] has no reference to multiple threads how this will
be behave in a multi-threaded environment is unspecified, and can be
problematic as Roddy mentions.</p>
<p><code>[1]</code> <strong>C++98</strong> section <code>3.6.3.1</code> <em>[basic.start.term]</em></p>
<p><code>[2]</code> In C++11 statics are initialized in a thread safe way, this is also
known as <em>Magic Statics</em>.</p>
<p><br></p>
<h3>Suggest</h3>
<p>Motti is right about the order, but there are some other things to consider:</p>
<p>Compilers typically use a hidden flag variable to indicate if the local
statics have already been initialized, and this flag is checked on every entry
to the function. Obviously this is a small performance hit, but what's more of
a concern is that this flag is not guaranteed to be thread-safe.</p>
<p>If you have a local static as above, and <code>foo</code> is called from multiple
threads, you may have race conditions causing <code>plonk</code> to be initialized
incorrectly or even multiple times. Also, in this case <code>plonk</code> may get
destructed by a different thread than the one which constructed it.</p>
<p>Despite what the standard says, I'd be very wary of the actual order of local
static destruction, because it's possible that you may unwittingly rely on a
static being still valid after it's been destructed, and this is really
difficult to track down.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-2125.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-2123.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
