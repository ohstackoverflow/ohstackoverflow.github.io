<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 207) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-207.html">
<link rel="prev" href="index-208.html" type="text/html">
<link rel="next" href="index-206.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-can-i-make-a-dictionary-dict-from-separate-lists-of-keys-and-values/" class="u-url">How can I make a dictionary (dict) from separate lists of keys and values?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-can-i-make-a-dictionary-dict-from-separate-lists-of-keys-and-values/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T00:52:25+08:00" itemprop="datePublished" title="2023-02-17 00:52">2023-02-17 00:52</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I want to combine these:</p>
<div class="code"><pre class="code literal-block">keys = ['name', 'age', 'food']
values = ['Monty', 42, 'spam']
</pre></div>

<p>Into a single dictionary:</p>
<div class="code"><pre class="code literal-block">{'name': 'Monty', 'age': 42, 'food': 'spam'}
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<p>Like this:</p>
<div class="code"><pre class="code literal-block">keys = ['a', 'b', 'c']
values = [1, 2, 3]
dictionary = dict(zip(keys, values))
print(dictionary) # {'a': 1, 'b': 2, 'c': 3}
</pre></div>

<p>Voila :-) The pairwise <code>dict</code> constructor and <code>zip</code> function are awesomely
useful.</p>
<p><br></p>
<h3>Suggest</h3>
<blockquote>
<p>Imagine that you have:</p>
<div class="code"><pre class="code literal-block">keys = ('name', 'age', 'food')
values = ('Monty', 42, 'spam')
</pre></div>

<p><strong>What is the simplest way to produce the following dictionary ?</strong></p>
<div class="code"><pre class="code literal-block">dict = {'name' : 'Monty', 'age' : 42, 'food' : 'spam'}
</pre></div>

</blockquote>
<h3>Most performant, <code>dict</code> constructor with <code>zip</code>
</h3>
<div class="code"><pre class="code literal-block">new_dict = dict(zip(keys, values))
</pre></div>

<p>In Python 3, zip now returns a lazy iterator, and this is now the most
performant approach.</p>
<p><code>dict(zip(keys, values))</code> does require the one-time global lookup each for
<code>dict</code> and <code>zip</code>, but it doesn't form any unnecessary intermediate data-
structures or have to deal with local lookups in function application.</p>
<h3>Runner-up, dict comprehension:</h3>
<p>A close runner-up to using the dict constructor is to use the native syntax of
a dict comprehension (not a <em>list</em> comprehension, as others have mistakenly
put it):</p>
<div class="code"><pre class="code literal-block"><span class="nv">new_dict</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>{<span class="nv">k</span>:<span class="w"> </span><span class="nv">v</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">k</span>,<span class="w"> </span><span class="nv">v</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">zip</span><span class="ss">(</span><span class="nv">keys</span>,<span class="w"> </span><span class="nv">values</span><span class="ss">)</span>}
</pre></div>

<p>Choose this when you need to map or filter based on the keys or value.</p>
<p>In Python 2, <code>zip</code> returns a list, to avoid creating an unnecessary list, use
<code>izip</code> instead (aliased to zip can reduce code changes when you move to Python
3).</p>
<div class="code"><pre class="code literal-block"><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">izip</span> <span class="k">as</span> <span class="nb">zip</span>
</pre></div>

<p>So that is still (2.7):</p>
<div class="code"><pre class="code literal-block"><span class="nv">new_dict</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>{<span class="nv">k</span>:<span class="w"> </span><span class="nv">v</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">k</span>,<span class="w"> </span><span class="nv">v</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">zip</span><span class="ss">(</span><span class="nv">keys</span>,<span class="w"> </span><span class="nv">values</span><span class="ss">)</span>}
</pre></div>

<h3>Python 2, ideal for &lt;= 2.6</h3>
<p><code>izip</code> from <code>itertools</code> becomes <code>zip</code> in Python 3. <code>izip</code> is better than zip
for Python 2 (because it avoids the unnecessary list creation), and ideal for
2.6 or below:</p>
<div class="code"><pre class="code literal-block"><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">izip</span>
<span class="n">new_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">izip</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">values</span><span class="p">))</span>
</pre></div>

<h3>Result for all cases:</h3>
<p>In all cases:</p>
<div class="code"><pre class="code literal-block">&gt;&gt;&gt; new_dict
{'age': 42, 'name': 'Monty', 'food': 'spam'}
</pre></div>

<h3>Explanation:</h3>
<p>If we look at the help on <code>dict</code> we see that it takes a variety of forms of
arguments:</p>
<div class="code"><pre class="code literal-block"><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">help</span><span class="p">(</span><span class="n">dict</span><span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="n">dict</span><span class="p">(</span><span class="k">object</span><span class="p">)</span>
<span class="w"> </span><span class="o">|</span><span class="w">  </span><span class="n">dict</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">empty</span><span class="w"> </span><span class="k">dictionary</span>
<span class="w"> </span><span class="o">|</span><span class="w">  </span><span class="n">dict</span><span class="p">(</span><span class="n">mapping</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="k">dictionary</span><span class="w"> </span><span class="n">initialized</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">mapping</span><span class="w"> </span><span class="k">object</span><span class="err">'</span><span class="n">s</span>
<span class="w"> </span><span class="o">|</span><span class="w">      </span><span class="p">(</span><span class="k">key</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="p">)</span><span class="w"> </span><span class="n">pairs</span>
<span class="w"> </span><span class="o">|</span><span class="w">  </span><span class="n">dict</span><span class="p">(</span><span class="n">iterable</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="k">dictionary</span><span class="w"> </span><span class="n">initialized</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nl">via</span><span class="p">:</span>
<span class="w"> </span><span class="o">|</span><span class="w">      </span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{}</span>
<span class="w"> </span><span class="o">|</span><span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">iterable</span><span class="p">:</span>
<span class="w"> </span><span class="o">|</span><span class="w">          </span><span class="n">d</span><span class="o">[</span><span class="n">k</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v</span>
<span class="w"> </span><span class="o">|</span><span class="w">  </span><span class="n">dict</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="k">dictionary</span><span class="w"> </span><span class="n">initialized</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">name</span><span class="o">=</span><span class="k">value</span><span class="w"> </span><span class="n">pairs</span>
<span class="w"> </span><span class="o">|</span><span class="w">      </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">keyword</span><span class="w"> </span><span class="n">argument</span><span class="w"> </span><span class="n">list</span><span class="p">.</span><span class="w">  </span><span class="k">For</span><span class="w"> </span><span class="nl">example</span><span class="p">:</span><span class="w">  </span><span class="n">dict</span><span class="p">(</span><span class="n">one</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">two</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

<p>The optimal approach is to use an iterable while avoiding creating unnecessary
data structures. In Python 2, zip creates an unnecessary list:</p>
<div class="code"><pre class="code literal-block">&gt;&gt;&gt; zip(keys, values)
[('name', 'Monty'), ('age', 42), ('food', 'spam')]
</pre></div>

<p>In Python 3, the equivalent would be:</p>
<div class="code"><pre class="code literal-block">&gt;&gt;&gt; list(zip(keys, values))
[('name', 'Monty'), ('age', 42), ('food', 'spam')]
</pre></div>

<p>and Python 3's <code>zip</code> merely creates an iterable object:</p>
<div class="code"><pre class="code literal-block">&gt;&gt;&gt; zip(keys, values)
&lt;zip object at 0x7f0e2ad029c8&gt;
</pre></div>

<p>Since we want to avoid creating unnecessary data structures, we usually want
to avoid Python 2's <code>zip</code> (since it creates an unnecessary list).</p>
<h3>Less performant alternatives:</h3>
<p>This is a generator expression being passed to the dict constructor:</p>
<div class="code"><pre class="code literal-block"><span class="nv">generator_expression</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">((</span><span class="nv">k</span>,<span class="w"> </span><span class="nv">v</span><span class="ss">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">k</span>,<span class="w"> </span><span class="nv">v</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">zip</span><span class="ss">(</span><span class="nv">keys</span>,<span class="w"> </span><span class="nv">values</span><span class="ss">))</span>
<span class="nv">dict</span><span class="ss">(</span><span class="nv">generator_expression</span><span class="ss">)</span>
</pre></div>

<p>or equivalently:</p>
<div class="code"><pre class="code literal-block"><span class="nv">dict</span><span class="ss">((</span><span class="nv">k</span>,<span class="w"> </span><span class="nv">v</span><span class="ss">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">k</span>,<span class="w"> </span><span class="nv">v</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">zip</span><span class="ss">(</span><span class="nv">keys</span>,<span class="w"> </span><span class="nv">values</span><span class="ss">))</span>
</pre></div>

<p>And this is a list comprehension being passed to the dict constructor:</p>
<div class="code"><pre class="code literal-block"><span class="nv">dict</span><span class="ss">(</span>[<span class="ss">(</span><span class="nv">k</span>,<span class="w"> </span><span class="nv">v</span><span class="ss">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">k</span>,<span class="w"> </span><span class="nv">v</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">zip</span><span class="ss">(</span><span class="nv">keys</span>,<span class="w"> </span><span class="nv">values</span><span class="ss">)</span>]<span class="ss">)</span>
</pre></div>

<p>In the first two cases, an extra layer of non-operative (thus unnecessary)
computation is placed over the zip iterable, and in the case of the list
comprehension, an extra list is unnecessarily created. I would expect all of
them to be less performant, and certainly not more-so.</p>
<h3>Performance review:</h3>
<p>In 64 bit Python 3.8.2 provided by Nix, on Ubuntu 16.04, ordered from fastest
to slowest:</p>
<div class="code"><pre class="code literal-block"><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">timeit</span><span class="p">.</span><span class="n">repeat</span><span class="p">(</span><span class="nl">lambda</span><span class="p">:</span><span class="w"> </span><span class="n">dict</span><span class="p">(</span><span class="n">zip</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span><span class="w"> </span><span class="k">values</span><span class="p">))))</span>
<span class="mf">0.6695233230129816</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">timeit</span><span class="p">.</span><span class="n">repeat</span><span class="p">(</span><span class="nl">lambda</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="nl">k</span><span class="p">:</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">zip</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span><span class="w"> </span><span class="k">values</span><span class="p">)</span><span class="err">}</span><span class="p">))</span>
<span class="mf">0.6941362579818815</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">timeit</span><span class="p">.</span><span class="n">repeat</span><span class="p">(</span><span class="nl">lambda</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="n">keys</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="k">values</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">keys</span><span class="p">))</span><span class="err">}</span><span class="p">))</span>
<span class="mf">0.8782548159942962</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">timeit</span><span class="p">.</span><span class="n">repeat</span><span class="p">(</span><span class="nl">lambda</span><span class="p">:</span><span class="w"> </span><span class="n">dict</span><span class="p">(</span><span class="o">[</span><span class="n">(k, v) for k, v in zip(keys, values)</span><span class="o">]</span><span class="p">)))</span>
<span class="mf">1.077607496001292</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">timeit</span><span class="p">.</span><span class="n">repeat</span><span class="p">(</span><span class="nl">lambda</span><span class="p">:</span><span class="w"> </span><span class="n">dict</span><span class="p">((</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">zip</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span><span class="w"> </span><span class="k">values</span><span class="p">))))</span>
<span class="mf">1.1840861019445583</span>
</pre></div>

<p><code>dict(zip(keys, values))</code> wins even with small sets of keys and values, but
for larger sets, the differences in performance will become greater.</p>
<p>A commenter said:</p>
<blockquote>
<p><code>min</code> seems like a bad way to compare performance. Surely <code>mean</code> and/or
<code>max</code> would be much more useful indicators for real usage.</p>
</blockquote>
<p>We use <code>min</code> because these algorithms are deterministic. We want to know the
performance of the algorithms under the best conditions possible.</p>
<p>If the operating system hangs for any reason, it has nothing to do with what
we're trying to compare, so we need to exclude those kinds of results from our
analysis.</p>
<p>If we used <code>mean</code>, those kinds of events would skew our results greatly, and
if we used <code>max</code> we will only get the most extreme result - the one most
likely affected by such an event.</p>
<p>A commenter also says:</p>
<blockquote>
<p>In python 3.6.8, using mean values, the dict comprehension is indeed still
faster, by about 30% for these small lists. For larger lists (10k random
numbers), the <code>dict</code> call is about 10% faster.</p>
</blockquote>
<p>I presume we mean <code>dict(zip(...</code> with 10k random numbers. That does sound like
a fairly unusual use case. It does makes sense that the most direct calls
would dominate in large datasets, and I wouldn't be surprised if OS hangs are
dominating given how long it would take to run that test, further skewing your
numbers. And if you use <code>mean</code> or <code>max</code> I would consider your results
meaningless.</p>
<p>Let's use a more realistic size on our top examples:</p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">timeit</span>
<span class="n">l1</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="n">l2</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
</pre></div>

<p>And we see here that <code>dict(zip(...</code> does indeed run faster for larger datasets
by about 20%.</p>
<div class="code"><pre class="code literal-block"><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="nv">min</span><span class="ss">(</span><span class="nv">timeit</span>.<span class="nv">repeat</span><span class="ss">(</span><span class="nv">lambda</span>:<span class="w"> </span>{<span class="nv">k</span>:<span class="w"> </span><span class="nv">v</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">k</span>,<span class="w"> </span><span class="nv">v</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">zip</span><span class="ss">(</span><span class="nv">l1</span>,<span class="w"> </span><span class="nv">l2</span><span class="ss">)</span>}<span class="ss">))</span>
<span class="mi">9</span>.<span class="mi">698965263989521</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="nv">min</span><span class="ss">(</span><span class="nv">timeit</span>.<span class="nv">repeat</span><span class="ss">(</span><span class="nv">lambda</span>:<span class="w"> </span><span class="nv">dict</span><span class="ss">(</span><span class="nv">zip</span><span class="ss">(</span><span class="nv">l1</span>,<span class="w"> </span><span class="nv">l2</span><span class="ss">))))</span>
<span class="mi">7</span>.<span class="mi">9965161079890095</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/why-not-inherit-from-list-t/" class="u-url">Why not inherit from List&lt;T&gt;?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/why-not-inherit-from-list-t/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T00:51:54+08:00" itemprop="datePublished" title="2023-02-17 00:51">2023-02-17 00:51</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>When planning out my programs, I often start with a chain of thought like so:</p>
<blockquote>
<p>A football team is just a list of football players. Therefore, I should
represent it with:</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">football_team</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">FootballPlayer</span><span class="o">&gt;</span><span class="p">();</span>
</pre></div>

<p>The ordering of this list represent the order in which the players are
listed in the roster.</p>
</blockquote>
<p>But I realize later that teams also have other properties, besides the mere
list of players, that must be recorded. For example, the running total of
scores this season, the current budget, the uniform colors, a <code>string</code>
representing the name of the team, etc..</p>
<p>So then I think:</p>
<blockquote>
<p>Okay, a football team is just like a list of players, but additionally, it
has a name (a <code>string</code>) and a running total of scores (an <code>int</code>). .NET does
not provide a class for storing football teams, so I will make my own class.
The most similar and relevant existing structure is <code>List&lt;FootballPlayer&gt;</code>,
so I will inherit from it:</p>
<div class="code"><pre class="code literal-block"><span class="k">class</span> <span class="n">FootballTeam</span> : <span class="nb">List</span><span class="s">&lt;FootballPlayer&gt;</span>
{
    <span class="n">public</span> <span class="n">string</span> <span class="n">TeamName</span>;
    <span class="n">public</span> <span class="n">int</span> <span class="n">RunningTotal</span>
}
</pre></div>

</blockquote>
<p>But it turns out that a guideline says you shouldn't inherit from <code>List&lt;T&gt;</code>.
I'm thoroughly confused by this guideline in two respects.</p>
<h3>Why not?</h3>
<p>Apparently <code>List</code> is somehow optimized for performance. How so? What
performance problems will I cause if I extend <code>List</code>? What exactly will break?</p>
<p>Another reason I've seen is that <code>List</code> is provided by Microsoft, and I have
no control over it, so I cannot change it later, after exposing a "public
API". But I struggle to understand this. What is a public API and why should I
care? If my current project does not and is not likely to ever have this
public API, can I safely ignore this guideline? If I do inherit from <code>List</code>
<em>and</em> it turns out I need a public API, what difficulties will I have?</p>
<p>Why does it even matter? A list is a list. What could possibly change? What
could I possibly want to change?</p>
<p>And lastly, if Microsoft did not want me to inherit from <code>List</code>, why didn't
they make the class <code>sealed</code>?</p>
<h3>What else am I supposed to use?</h3>
<p>Apparently, for custom collections, Microsoft has provided a <code>Collection</code>
class which should be extended instead of <code>List</code>. But this class is very bare,
and does not have many useful things, such as <code>AddRange</code>, for instance.
jvitor83's answer provides a performance rationale for that particular method,
but how is a slow <code>AddRange</code> not better than no <code>AddRange</code>?</p>
<p>Inheriting from <code>Collection</code> is way more work than inheriting from <code>List</code>, and
I see no benefit. Surely Microsoft wouldn't tell me to do extra work for no
reason, so I can't help feeling like I am somehow misunderstanding something,
and inheriting <code>Collection</code> is actually not the right solution for my problem.</p>
<p>I've seen suggestions such as implementing <code>IList</code>. Just no. This is dozens of
lines of boilerplate code which gains me nothing.</p>
<p>Lastly, some suggest wrapping the <code>List</code> in something:</p>
<div class="code"><pre class="code literal-block"><span class="k">class</span> <span class="n">FootballTeam</span> 
{ 
    <span class="n">public</span> <span class="nb">List</span><span class="s">&lt;FootballPlayer&gt;</span> <span class="n">Players</span>; 
}
</pre></div>

<p>There are two problems with this:</p>
<ol>
<li>
<p>It makes my code needlessly verbose. I must now call <code>my_team.Players.Count</code> instead of just <code>my_team.Count</code>. Thankfully, with C# I can define indexers to make indexing transparent, and forward all the methods of the internal <code>List</code>... But that's a lot of code! What do I get for all that work?</p>
</li>
<li>
<p>It just plain doesn't make any sense. A football team doesn't "have" a list of players. It <em>is</em> the list of players. You don't say "John McFootballer has joined SomeTeam's players". You say "John has joined SomeTeam". You don't add a letter to "a string's characters", you add a letter to a string. You don't add a book to a library's books, you add a book to a library.</p>
</li>
</ol>
<p>I realize that what happens "under the hood" can be said to be "adding X to
Y's internal list", but this seems like a very counter-intuitive way of
thinking about the world.</p>
<h3>My question (summarized)</h3>
<p>What is the correct C# way of representing a data structure, which,
"logically" (that is to say, "to the human mind") is just a <code>list</code> of <code>things</code>
with a few bells and whistles?</p>
<p>Is inheriting from <code>List&lt;T&gt;</code> always unacceptable? When is it acceptable?
Why/why not? What must a programmer consider, when deciding whether to inherit
from <code>List&lt;T&gt;</code> or not?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>There are some good answers here. I would add to them the following points.</p>
<blockquote>
<p>What is the correct C# way of representing a data structure, which,
"logically" (that is to say, "to the human mind") is just a list of things
with a few bells and whistles?</p>
</blockquote>
<p>Ask any ten non-computer-programmer people who are familiar with the existence
of football to fill in the blank:</p>
<blockquote>
<p>A football team is a particular kind of _____</p>
</blockquote>
<p>Did <em>anyone</em> say "list of football players with a few bells and whistles", or
did they all say "sports team" or "club" or "organization"? Your notion that a
football team is <em>a particular kind of list of players</em> is in your human mind
and your human mind alone.</p>
<p><code>List&lt;T&gt;</code> is a <em>mechanism</em>. Football team is a <em>business object</em> -- that is,
an object that represents some concept that is in the <em>business domain</em> of the
program. Don't mix those! A football team <em>is a kind of</em> team; it <em>has a</em>
roster, a roster <em>is a list of players</em>. A roster is not a <em>particular kind of
list of players</em>. A roster <em>is</em> a list of players. So make a property called
<code>Roster</code> that is a <code>List&lt;Player&gt;</code>. And make it <code>ReadOnlyList&lt;Player&gt;</code> while
you're at it, unless you believe that everyone who knows about a football team
gets to delete players from the roster.</p>
<blockquote>
<p>Is inheriting from <code>List&lt;T&gt;</code> always unacceptable?</p>
</blockquote>
<p>Unacceptable to whom? Me? No.</p>
<blockquote>
<p>When is it acceptable?</p>
</blockquote>
<p>When you're building a mechanism that <em>extends the<code>List&lt;T&gt;</code> mechanism</em>.</p>
<blockquote>
<p>What must a programmer consider, when deciding whether to inherit from
<code>List&lt;T&gt;</code> or not?</p>
</blockquote>
<p>Am I building a <em>mechanism</em> or a <em>business object</em>?</p>
<blockquote>
<p>But that's a lot of code! What do I get for all that work?</p>
</blockquote>
<p>You spent more time typing up your question that it would have taken you to
write forwarding methods for the relevant members of <code>List&lt;T&gt;</code> fifty times
over. You're clearly not afraid of verbosity, and we are talking about a very
small amount of code here; this is a few minutes work.</p>
<h3>UPDATE</h3>
<p>I gave it some more thought and there is another reason to not model a
football team as a list of players. In fact it might be a bad idea to model a
football team as <em>having</em> a list of players too. The problem with a team
as/having a list of players is that what you've got is a <em>snapshot</em> of the
team <em>at a moment in time</em>. I don't know what your business case is for this
class, but if I had a class that represented a football team I would want to
ask it questions like "how many Seahawks players missed games due to injury
between 2003 and 2013?" or "What Denver player who previously played for
another team had the largest year-over-year increase in yards ran?" or "Did
the Piggers go all the way this year?"</p>
<p>That is, a football team seems to me to be well modeled as <em>a collection of
historical facts</em> such as when a player was recruited, injured, retired, etc.
Obviously the current player roster is an important fact that should probably
be front-and-center, but there may be other interesting things you want to do
with this object that require a more historical perspective.</p>
<p><br></p>
<h3>Suggest</h3>
<p>Wow, your post has an entire slew of questions and points. Most of the
reasoning you get from Microsoft is exactly on point. Let's start with
everything about <code>List&lt;T&gt;</code></p>
<ul>
<li>
<code>List&lt;T&gt;</code> <strong>is</strong> highly optimized. Its main usage is to be used as a private member of an object.</li>
<li>Microsoft did not seal it because sometimes you might want to create a class that has a friendlier name: <code>class MyList&lt;T, TX&gt; : List&lt;CustomObject&lt;T, Something&lt;TX&gt;&gt; { ... }</code>. Now it's as easy as doing <code>var list = new MyList&lt;int, string&gt;();</code>.</li>
<li>CA1002: Do not expose generic lists: Basically, even if you plan to use this app as the sole developer, it's worthwhile to develop with good coding practices, so they become instilled into you and second nature. You are still allowed to expose the list as an <code>IList&lt;T&gt;</code> if you need any consumer to have an indexed list. This lets you change the implementation within a class later on.</li>
<li>Microsoft made <code>Collection&lt;T&gt;</code> very generic because it is a generic concept... the name says it all; it is just a collection. There are more precise versions such as <code>SortedCollection&lt;T&gt;</code>, <code>ObservableCollection&lt;T&gt;</code>, <code>ReadOnlyCollection&lt;T&gt;</code>, etc. each of which implement <code>IList&lt;T&gt;</code> but <strong>not</strong> <code>List&lt;T&gt;</code>.</li>
<li>
<code>Collection&lt;T&gt;</code> allows for members (i.e. Add, Remove, etc.) to be overridden because they are virtual. <code>List&lt;T&gt;</code> does not.</li>
<li>The last part of your question is spot on. A Football team is more than just a list of players, so it should be a class that contains that list of players. Think Composition vs Inheritance. A Football team <em>has</em> a list of players (a roster), it isn't a list of players.</li>
</ul>
<hr>
<p>If I were writing this code, the class would probably look something like so:</p>
<div class="code"><pre class="code literal-block"><span class="nv">public</span><span class="w"> </span><span class="nv">class</span><span class="w"> </span><span class="nv">FootballTeam</span><span class="o">&lt;</span><span class="nv">T</span><span class="o">&gt;//</span><span class="nv">generic</span><span class="w"> </span><span class="nv">class</span>
{
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="nv">Football</span><span class="w"> </span><span class="nv">team</span><span class="w"> </span><span class="nv">rosters</span><span class="w"> </span><span class="nv">are</span><span class="w"> </span><span class="nv">generally</span><span class="w"> </span><span class="mi">53</span><span class="w"> </span><span class="nv">total</span><span class="w"> </span><span class="nv">players</span>.
<span class="w">    </span><span class="nv">private</span><span class="w"> </span><span class="nv">readonly</span><span class="w"> </span><span class="nv">List</span><span class="o">&lt;</span><span class="nv">T</span><span class="o">&gt;</span><span class="w"> </span><span class="nv">_roster</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">List</span><span class="o">&lt;</span><span class="nv">T</span><span class="o">&gt;</span><span class="ss">(</span><span class="mi">53</span><span class="ss">)</span><span class="c1">;</span>

<span class="w">    </span><span class="nv">public</span><span class="w"> </span><span class="nv">IList</span><span class="o">&lt;</span><span class="nv">T</span><span class="o">&gt;</span><span class="w"> </span><span class="nv">Roster</span>
<span class="w">    </span>{
<span class="w">        </span><span class="nv">get</span><span class="w"> </span>{<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nv">_roster</span><span class="c1">; }</span>
<span class="w">    </span>}

<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="nv">Yes</span>.<span class="w"> </span><span class="nv">I</span><span class="w"> </span><span class="nv">used</span><span class="w"> </span><span class="nv">LINQ</span><span class="w"> </span><span class="nv">here</span>.<span class="w"> </span><span class="nv">This</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">so</span><span class="w"> </span><span class="nv">I</span><span class="w"> </span><span class="nv">don</span><span class="err">'t have to worry about</span>
<span class="err">    // _roster.Length vs _roster.Count vs anything else.</span>
<span class="err">    public int PlayerCount</span>
<span class="err">    {</span>
<span class="err">        get { return _roster.Count(); }</span>
<span class="err">    }</span>

<span class="err">    // Any additional members you want to expose/wrap.</span>
<span class="err">}</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-measure-time-taken-by-a-function-to-execute/" class="u-url">How to measure time taken by a function to execute</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-measure-time-taken-by-a-function-to-execute/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T00:51:22+08:00" itemprop="datePublished" title="2023-02-17 00:51">2023-02-17 00:51</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I need to get execution time in milliseconds.</p>
<blockquote>
<p>I originally asked this question back in 2008. The accepted answer then was
to use <code>new Date().getTime()</code> However, we can all agree now that using the
standard <code>performance.now()</code> API is more appropriate. I am therefore
changing the accepted answer to this one.</p>
</blockquote>
<p><br><br></p>
<h2>Answer</h2>
<h3>Using <strong>performance.now()</strong> :</h3>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">startTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">performance</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>

<span class="n">doSomething</span><span class="p">()</span><span class="w">   </span><span class="o">//</span><span class="w"> </span><span class="o">&lt;----</span><span class="w"> </span><span class="n">measured</span><span class="w"> </span><span class="n">code</span><span class="w"> </span><span class="n">goes</span><span class="w"> </span><span class="n">between</span><span class="w"> </span><span class="n">startTime</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">endTime</span>

<span class="k">var</span><span class="w"> </span><span class="n">endTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">performance</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>

<span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="err">`</span><span class="n">Call</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">doSomething</span><span class="w"> </span><span class="n">took</span><span class="w"> </span><span class="o">$</span><span class="p">{</span><span class="n">endTime</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">startTime</span><span class="p">}</span><span class="w"> </span><span class="n">milliseconds</span><span class="err">`</span><span class="p">)</span>
</pre></div>

<blockquote>
<p>In <code>Node.js</code> it is required to import the <code>performance</code> class</p>
</blockquote>
<p>importing performance</p>
<div class="code"><pre class="code literal-block"><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">performance</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">require</span><span class="p">(</span><span class="s1">'perf_hooks'</span><span class="p">);</span>
</pre></div>

<hr>
<h3>Using <strong>console.time</strong> : (living standard)</h3>
<div class="code"><pre class="code literal-block"><span class="nv">console</span>.<span class="nv">time</span><span class="ss">(</span><span class="s1">'doSomething'</span><span class="ss">)</span>

<span class="nv">doSomething</span><span class="ss">()</span><span class="w">   </span><span class="o">//</span><span class="w"> </span><span class="o">&lt;----</span><span class="w"> </span><span class="nv">The</span><span class="w"> </span><span class="nv">function</span><span class="w"> </span><span class="nv">you</span><span class="err">'re measuring time for</span>

<span class="nv">console</span>.<span class="nv">timeEnd</span><span class="ss">(</span><span class="s1">'doSomething'</span><span class="ss">)</span>
</pre></div>

<p><em><strong>Note:</strong></em><br>
The string being passed to the <code>time()</code> and <code>timeEnd()</code> methods must match<br>
( <em>for the timer to finish as expected</em> ).</p>
<blockquote>
<h4>
<code>console.time()</code> documentations:</h4>
<ul>
<li>MDN documentation</li>
<li>Node.js documentation
</li>
</ul>
</blockquote>
<p><br></p>
<h3>Suggest</h3>
<p>use new Date().getTime()</p>
<blockquote>
<p>The getTime() method returns the number of milliseconds since midnight of
January 1, 1970.</p>
</blockquote>
<p>ex.</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">Date</span><span class="p">()</span><span class="o">.</span><span class="n">getTime</span><span class="p">();</span>

<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">50000</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="o">//</span><span class="w"> </span><span class="n">do</span><span class="w"> </span><span class="n">something</span>
<span class="p">}</span>

<span class="k">var</span><span class="w"> </span><span class="n">end</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">Date</span><span class="p">()</span><span class="o">.</span><span class="n">getTime</span><span class="p">();</span>
<span class="k">var</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="p">;</span>
<span class="n">alert</span><span class="p">(</span><span class="s1">'Execution time: '</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">time</span><span class="p">);</span>
</pre></div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-208.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-206.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
