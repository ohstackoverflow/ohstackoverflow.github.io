<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 942) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-942.html">
<link rel="prev" href="index-943.html" type="text/html">
<link rel="next" href="index-941.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/yong-yu-fang-wen-lie-biao-huo-shu-ju-kuang-yuan-su-de-fang-gua-hao-he-shuang-fang-gua-hao-zhi-jian-de-qu-bie/" class="u-url">用于访问列表或数据框元素的方括号 [ ] 和双方括号 [[ ]] 之间的区别</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/yong-yu-fang-wen-lie-biao-huo-shu-ju-kuang-yuan-su-de-fang-gua-hao-he-shuang-fang-gua-hao-zhi-jian-de-qu-bie/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T20:20:48+08:00" itemprop="datePublished" title="2023-02-17 20:20">2023-02-17 20:20</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>R 提供了两种不同的方法来访问列表或 data.frame 的元素：<code>[]</code>和<code>[[]]</code>.</p>
<p>两者之间有什么区别，我什么时候应该使用一个而不是另一个？</p>
<p><br><br></p>
<h2>解答</h2>
<p>R 语言定义可以方便地回答这些类型的问题：</p>
<ul>
<li>http://cran.r-project.org/doc/manuals/R-lang.html#Indexing</li>
</ul>
<blockquote>
<p>R 有三个基本的索引运算符，语法如下所示</p>
<p>``</p>
<div class="code"><pre class="code literal-block"><span class="w">    </span><span class="n">x</span><span class="o">[</span><span class="n">i</span><span class="o">]</span>
<span class="w">    </span><span class="n">x</span><span class="o">[</span><span class="n">i, j</span><span class="o">]</span>
<span class="w">    </span><span class="n">x</span><span class="o">[</span><span class="n">[i</span><span class="o">]</span><span class="err">]</span>
<span class="w">    </span><span class="n">x</span><span class="o">[</span><span class="n">[i, j</span><span class="o">]</span><span class="err">]</span>
<span class="w">    </span><span class="n">x</span><span class="err">$</span><span class="n">a</span>
<span class="w">    </span><span class="n">x</span><span class="err">$</span><span class="ss">"a"</span>
</pre></div>

<p>对于向量和矩阵，<code>[[</code>很少使用形式，尽管它们与<code>[</code>形式有一些细微的语义差异（例如，它删除了任何名称或 dimnames
属性，并且部分匹配用于字符索引）。当使用单个索引对多维结构进行索引时，<code>x[[i]]</code>or<code>x[i]</code>将返回<code>i</code>的第 th 个顺序元素<code>x</code>。</p>
<p>对于列表，通常用于<code>[[</code>选择任何单个元素，而<code>[</code>返回所选元素的列表。</p>
<p>该<code>[[</code>形式仅允许使用整数或字符索引选择单个元素，而<code>[</code>允许通过向量进行索引。请注意，对于列表，索引可以是向量，向量的每个元素依次应用于列表、所选组件、该组件的所选组件等。结果仍然是单个元素。</p>
</blockquote>
<p><br></p>
<h3>更多建议</h3>
<p>这两种方法之间的显着差异在于它们在用于提取时返回的对象的类，以及它们是否可以接受一系列值，或者在赋值期间只接受单个值。</p>
<p>考虑以下列表中数据提取的情况：</p>
<div class="code"><pre class="code literal-block"><span class="n">foo</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="w"> </span><span class="n">str</span><span class="o">=</span><span class="s">'R'</span><span class="p">,</span><span class="w"> </span><span class="n">vec</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">),</span><span class="w"> </span><span class="n">bool</span><span class="o">=</span><span class="kc">TRUE</span><span class="w"> </span><span class="p">)</span>
</pre></div>

<p>假设我们想从 foo 中提取 bool
存储的值并在<code>if()</code>语句中使用它。这将说明返回值之间的差异<code>[]</code>以及<code>[[]]</code>它们用于数据提取的时间。该<code>[]</code>方法返回类列表的对象（如果 foo
是 data.frame，则返回 data.frame），而该<code>[[]]</code>方法返回其类由其值的类型确定的对象。</p>
<p>因此，使用该<code>[]</code>方法会产生以下结果：</p>
<div class="code"><pre class="code literal-block"><span class="k">if</span><span class="ss">(</span><span class="w"> </span><span class="nv">foo</span>[<span class="w"> </span><span class="s1">'bool'</span><span class="w"> </span>]<span class="w"> </span><span class="ss">)</span>{<span class="w"> </span><span class="nv">print</span><span class="ss">(</span><span class="s2">"Hi!"</span><span class="ss">)</span><span class="w"> </span>}
<span class="nv">Error</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">foo</span>[<span class="s2">"bool"</span>]<span class="ss">)</span><span class="w"> </span>{<span class="w"> </span>:<span class="w"> </span><span class="nv">argument</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">not</span><span class="w"> </span><span class="nv">interpretable</span><span class="w"> </span><span class="nv">as</span><span class="w"> </span><span class="nv">logical</span>

<span class="nv">class</span><span class="ss">(</span><span class="w"> </span><span class="nv">foo</span>[<span class="w"> </span><span class="s1">'bool'</span><span class="w"> </span>]<span class="w"> </span><span class="ss">)</span>
[<span class="mi">1</span>]<span class="w"> </span><span class="s2">"list"</span>
</pre></div>

<p>这是因为该<code>[]</code>方法返回了一个列表，而列表不是要直接传递到<code>if()</code>语句中的有效对象。在这种情况下，我们需要使用<code>[[]]</code>，因为它将返回存储在“bool”中的“裸”对象，该对象将具有适当的类：</p>
<div class="code"><pre class="code literal-block"><span class="k">if</span><span class="ss">(</span><span class="w"> </span><span class="nv">foo</span>[[<span class="w"> </span><span class="s1">'bool'</span><span class="w"> </span>]]<span class="w"> </span><span class="ss">)</span>{<span class="w"> </span><span class="nv">print</span><span class="ss">(</span><span class="s2">"Hi!"</span><span class="ss">)</span><span class="w"> </span>}
[<span class="mi">1</span>]<span class="w"> </span><span class="s2">"Hi!"</span>

<span class="nv">class</span><span class="ss">(</span><span class="w"> </span><span class="nv">foo</span>[[<span class="w"> </span><span class="s1">'bool'</span><span class="w"> </span>]]<span class="w"> </span><span class="ss">)</span>
[<span class="mi">1</span>]<span class="w"> </span><span class="s2">"logical"</span>
</pre></div>

<p>第二个区别是<code>[]</code>运算符可用于访问列表中的 <strong>一系列</strong><code>[[]]</code>槽或数据帧中的列，而运算符仅限于访问 <strong>单个</strong>
槽或列。考虑使用第二个列表赋值的情况<code>bar()</code>：</p>
<div class="code"><pre class="code literal-block"><span class="n">bar</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="w"> </span><span class="n">mat</span><span class="o">=</span><span class="nf">matrix</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="n">nrow</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="n">ncol</span><span class="o">=</span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="n">rand</span><span class="o">=</span><span class="nf">rnorm</span><span class="p">(</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
</pre></div>

<p>假设我们想用 bar 中包含的数据覆盖 foo 的最后两个槽。如果我们尝试使用<code>[[]]</code>运算符，则会发生以下情况：</p>
<div class="code"><pre class="code literal-block"><span class="n">foo</span><span class="p">[[</span><span class="w"> </span><span class="m">2</span><span class="o">:</span><span class="m">3</span><span class="w"> </span><span class="p">]]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">bar</span>
<span class="n">Error</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">foo</span><span class="p">[[</span><span class="m">2</span><span class="o">:</span><span class="m">3</span><span class="p">]]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">bar</span><span class="w"> </span><span class="o">:</span><span class="w"> </span>
<span class="n">more</span><span class="w"> </span><span class="n">elements</span><span class="w"> </span><span class="n">supplied</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">replace</span>
</pre></div>

<p>这是因为<code>[[]]</code>仅限于访问单个元素。我们需要使用<code>[]</code>：</p>
<div class="code"><pre class="code literal-block"><span class="n">foo</span><span class="p">[</span><span class="w"> </span><span class="m">2</span><span class="o">:</span><span class="m">3</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">bar</span>
<span class="nf">print</span><span class="p">(</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="p">)</span>

<span class="o">$</span><span class="n">str</span>
<span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="s">"R"</span>

<span class="o">$</span><span class="n">vec</span>
<span class="w">     </span><span class="p">[,</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="p">[,</span><span class="m">2</span><span class="p">]</span>
<span class="p">[</span><span class="m">1</span><span class="p">,]</span><span class="w">    </span><span class="m">0</span><span class="w">    </span><span class="m">0</span>
<span class="p">[</span><span class="m">2</span><span class="p">,]</span><span class="w">    </span><span class="m">0</span><span class="w">    </span><span class="m">0</span>

<span class="o">$</span><span class="n">bool</span>
<span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="m">-0.6291121</span>
</pre></div>

<p>请注意，虽然分配成功，但 foo 中的插槽保留了它们的原始名称。</p>
<p><br><br><a href="posts/the-difference-between-bracket-and-double-bracket-for-accessing-the-elements-of-a-list-or-dataframe/">查看原文</a></p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/zai-javascript-han-shu-zhong-ding-yi-yi-ge-quan-ju-bian-liang/" class="u-url">在 JavaScript 函数中定义一个全局变量</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/zai-javascript-han-shu-zhong-ding-yi-yi-ge-quan-ju-bian-liang/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T20:19:49+08:00" itemprop="datePublished" title="2023-02-17 20:19">2023-02-17 20:19</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>是否可以在 JavaScript 函数中定义全局变量？</p>
<p>我想在其他函数中使用<code>trailimage</code>变量（在函数中声明<code>makeObj</code>）。</p>
<div class="code"><pre class="code literal-block"><span class="nt">&lt;html</span><span class="w"> </span><span class="na">xmlns=</span><span class="s">"http://www.w3.org/1999/xhtml"</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;head</span><span class="w"> </span><span class="na">id=</span><span class="s">"Head1"</span><span class="w"> </span><span class="na">runat=</span><span class="s">"server"</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;title&gt;&lt;/title&gt;</span>
<span class="w">        </span><span class="nt">&lt;script</span><span class="w"> </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
<span class="w">            </span>var<span class="w"> </span>offsetfrommouse<span class="w"> </span>=<span class="w"> </span>[10,<span class="w"> </span>-20];
<span class="w">            </span>var<span class="w"> </span>displayduration<span class="w"> </span>=<span class="w"> </span>0;
<span class="w">            </span>var<span class="w"> </span>obj_selected<span class="w"> </span>=<span class="w"> </span>0;
<span class="w">            </span>function<span class="w"> </span>makeObj(address)<span class="w"> </span>{
<span class="w">                </span>**var<span class="w"> </span>trailimage<span class="w"> </span>=<span class="w"> </span>[address,<span class="w"> </span>50,<span class="w"> </span>50];**
<span class="w">                </span>document.write('<span class="nt">&lt;img</span><span class="w"> </span><span class="na">id=</span><span class="s">"trailimageid"</span><span class="w"> </span><span class="na">src=</span><span class="s">"' + trailimage[0] + '"</span><span class="w"> </span><span class="na">border=</span><span class="s">"0"</span><span class="w">  </span><span class="na">style=</span><span class="s">" position: absolute; visibility:visible; left: 0px; top: 0px; width: ' + trailimage[1] + 'px; height: ' + trailimage[2] + 'px"</span><span class="nt">&gt;</span>');
<span class="w">                </span>obj_selected<span class="w"> </span>=<span class="w"> </span>1;
<span class="w">            </span>}

<span class="w">            </span>function<span class="w"> </span>truebody()<span class="w"> </span>{
<span class="w">                </span>return<span class="w"> </span>(!window.opera<span class="w"> </span><span class="err">&amp;&amp;</span><span class="w"> </span>document.compatMode<span class="w"> </span><span class="err">&amp;&amp;</span><span class="w"> </span>document.compatMode<span class="w"> </span>!=<span class="w"> </span>"BackCompat")<span class="w"> </span>?<span class="w"> </span>document.documentElement<span class="w"> </span>:<span class="w"> </span>document.body;
<span class="w">            </span>}
<span class="w">            </span>function<span class="w"> </span>hidetrail()<span class="w"> </span>{
<span class="w">                </span>var<span class="w"> </span>x<span class="w"> </span>=<span class="w"> </span>document.getElementById("trailimageid").style;
<span class="w">                </span>x.visibility<span class="w"> </span>=<span class="w"> </span>"hidden";
<span class="w">                </span>document.onmousemove<span class="w"> </span>=<span class="w"> </span>"";
<span class="w">            </span>}
<span class="w">            </span>function<span class="w"> </span>followmouse(e)<span class="w"> </span>{
<span class="w">                </span>var<span class="w"> </span>xcoord<span class="w"> </span>=<span class="w"> </span>offsetfrommouse[0];
<span class="w">                </span>var<span class="w"> </span>ycoord<span class="w"> </span>=<span class="w"> </span>offsetfrommouse[1];
<span class="w">                </span>var<span class="w"> </span>x<span class="w"> </span>=<span class="w"> </span>document.getElementById("trailimageid").style;
<span class="w">                </span>if<span class="w"> </span>(typeof<span class="w"> </span>e<span class="w"> </span>!=<span class="w"> </span>"undefined")<span class="w"> </span>{
<span class="w">                    </span>xcoord<span class="w"> </span>+=<span class="w"> </span>e.pageX;
<span class="w">                    </span>ycoord<span class="w"> </span>+=<span class="w"> </span>e.pageY;
<span class="w">                </span>}
<span class="w">                </span>else<span class="w"> </span>if<span class="w"> </span>(typeof<span class="w"> </span>window.event<span class="w"> </span>!=<span class="w"> </span>"undefined")<span class="w"> </span>{
<span class="w">                    </span>xcoord<span class="w"> </span>+=<span class="w"> </span>truebody().scrollLeft<span class="w"> </span>+<span class="w"> </span>event.clientX;
<span class="w">                    </span>ycoord<span class="w"> </span>+=<span class="w"> </span>truebody().scrollTop<span class="w"> </span>+<span class="w"> </span>event.clientY;
<span class="w">                </span>}
<span class="w">                </span>var<span class="w"> </span>docwidth<span class="w"> </span>=<span class="w"> </span>1395;
<span class="w">                </span>var<span class="w"> </span>docheight<span class="w"> </span>=<span class="w"> </span>676;
<span class="w">                </span>if<span class="w"> </span>(xcoord<span class="w"> </span>+<span class="w"> </span>trailimage[1]<span class="w"> </span>+<span class="w"> </span>3<span class="w"> </span>&gt;<span class="w"> </span>docwidth<span class="w"> </span>||<span class="w"> </span>ycoord<span class="w"> </span>+<span class="w"> </span>trailimage[2]<span class="w"> </span>&gt;<span class="w"> </span>docheight)<span class="w"> </span>{
<span class="w">                    </span>x.display<span class="w"> </span>=<span class="w"> </span>"none";
<span class="w">                    </span>alert("inja");
<span class="w">                </span>}
<span class="w">                </span>else
<span class="w">                    </span>x.display<span class="w"> </span>=<span class="w"> </span>"";
<span class="w">                </span>x.left<span class="w"> </span>=<span class="w"> </span>xcoord<span class="w"> </span>+<span class="w"> </span>"px";
<span class="w">                </span>x.top<span class="w"> </span>=<span class="w"> </span>ycoord<span class="w"> </span>+<span class="w"> </span>"px";
<span class="w">            </span>}

<span class="w">            </span>if<span class="w"> </span>(obj_selected<span class="w"> </span>=<span class="w"> </span>1)<span class="w"> </span>{
<span class="w">                </span>alert("obj_selected<span class="w"> </span>=<span class="w"> </span>true");
<span class="w">                </span>document.onmousemove<span class="w"> </span>=<span class="w"> </span>followmouse;
<span class="w">                </span>if<span class="w"> </span>(displayduration<span class="w"> </span>&gt;<span class="w"> </span>0)
<span class="w">                    </span>setTimeout("hidetrail()",<span class="w"> </span>displayduration<span class="w"> </span>*<span class="w"> </span>1000);
<span class="w">            </span>}
<span class="w">        </span><span class="nt">&lt;/script&gt;</span>
<span class="w">    </span><span class="nt">&lt;/head&gt;</span>
<span class="w">    </span><span class="nt">&lt;body&gt;</span>
<span class="w">        </span><span class="nt">&lt;form</span><span class="w"> </span><span class="na">id=</span><span class="s">"form1"</span><span class="w"> </span><span class="na">runat=</span><span class="s">"server"</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;img</span><span class="w"> </span><span class="na">alt=</span><span class="s">""</span><span class="w"> </span><span class="na">id=</span><span class="s">"house"</span><span class="w"> </span><span class="na">src=</span><span class="s">"Pictures/sides/right.gif"</span><span class="w"> </span><span class="na">style=</span><span class="s">"z-index: 1; left: 372px;</span>
<span class="s">            top: 219px; position: absolute; height: 138px; width: 120px"</span><span class="w"> </span><span class="na">onclick=</span><span class="s">"javascript:makeObj('Pictures/sides/sides-not-clicked.gif');"</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;/form&gt;</span>
<span class="w">    </span><span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>

<p><br><br></p>
<h2>解答</h2>
<p>正如其他人所说，您可以<code>var</code>在全局范围内（在所有函数和模块之外）使用来声明全局变量：</p>
<div class="code"><pre class="code literal-block"><span class="nt">&lt;script&gt;</span>
var<span class="w"> </span>yourGlobalVariable;
function<span class="w"> </span>foo()<span class="w"> </span>{
<span class="w">    </span>//<span class="w"> </span>...
}
<span class="nt">&lt;/script&gt;</span>
</pre></div>

<p>（请注意，这仅在 <em>全局</em> 范围内是正确的。如果该代码在模块中——<code>&lt;script type="module"&gt;...&lt;/script&gt;</code>
它不会在全局范围内，因此不会创建全局。）</p>
<p>或者：</p>
<p><code>globalThis</code>在现代环境中，您可以分配给引用对象的属性（<code>globalThis</code>在 ES2020 中添加）：</p>
<div class="code"><pre class="code literal-block"><span class="nt">&lt;script&gt;</span>
function<span class="w"> </span>foo()<span class="w"> </span>{
<span class="w">    </span>globalThis.yourGlobalVariable<span class="w"> </span>=<span class="w"> </span>...;
}
<span class="nt">&lt;/script&gt;</span>
</pre></div>

<p>在浏览器上，你可以对全局调用做同样的事情<code>window</code>：</p>
<div class="code"><pre class="code literal-block"><span class="nt">&lt;script&gt;</span>
function<span class="w"> </span>foo()<span class="w"> </span>{
<span class="w">    </span>window.yourGlobalVariable<span class="w"> </span>=<span class="w"> </span>...;
}
<span class="nt">&lt;/script&gt;</span>
</pre></div>

<p>...因为在浏览器中，声明的 <del>所有全局变量</del><code>var</code>全局变量都是<code>window</code>对象的属性。（新的<code>let</code>、<code>const</code>和<code>class</code>语句
[在 ES2015 中添加] 在全局范围内创建的全局变量不是全局对象的属性；这是 ES2015 中的一个新概念。）</p>
<p>（隐式全局变量也很可怕，但不要故意这样做，尽量避免意外地这样做，也许可以使用 ES5 的<code>"use strict"</code>.）</p>
<p>综上所述：如果可能的话，我会避免使用全局变量（而且几乎可以肯定）。正如我所提到的，它们最终成为 的属性<code>window</code>，并且<code>window</code>已经
<em>足够拥挤了</em> ，所有带有 的元素<code>id</code>（以及许多只有<code>name</code>）都被倾倒在其中（并且无论即将到来的规范如何，IE 都会倾倒任何带有 a
的元素<code>name</code>） ).</p>
<p>相反，在现代环境中，使用模块：</p>
<div class="code"><pre class="code literal-block"><span class="nt">&lt;script</span><span class="w"> </span><span class="na">type=</span><span class="s">"module"</span><span class="nt">&gt;</span>
let<span class="w"> </span>yourVariable<span class="w"> </span>=<span class="w"> </span>42;
//<span class="w"> </span>...
<span class="nt">&lt;/script&gt;</span>
</pre></div>

<p>模块中的顶级代码在模块范围内，而不是全局范围内，因此创建了一个变量，该模块中的所有代码都可以看到，但不是全局的。</p>
<p>在没有模块支持的过时环境中，将代码包装在作用域函数中并使用该作用域函数的局部变量，并在其中关闭其他函数：</p>
<div class="code"><pre class="code literal-block"><span class="nt">&lt;script&gt;</span>
(function()<span class="w"> </span>{<span class="w"> </span>//<span class="w"> </span>Begin<span class="w"> </span>scoping<span class="w"> </span>function
<span class="w">    </span>var<span class="w"> </span>yourGlobalVariable;<span class="w"> </span>//<span class="w"> </span>Global<span class="w"> </span>to<span class="w"> </span>your<span class="w"> </span>code,<span class="w"> </span>invisible<span class="w"> </span>outside<span class="w"> </span>the<span class="w"> </span>scoping<span class="w"> </span>function
<span class="w">    </span>function<span class="w"> </span>foo()<span class="w"> </span>{
<span class="w">        </span>//<span class="w"> </span>...
<span class="w">    </span>}
})();<span class="w">         </span>//<span class="w"> </span>End<span class="w"> </span>scoping<span class="w"> </span>function
<span class="nt">&lt;/script&gt;</span>
</pre></div>

<p><br></p>
<h3>更多建议</h3>
<p>只需声明</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">trialImage</span><span class="p">;</span>
</pre></div>

<p>外部。然后</p>
<div class="code"><pre class="code literal-block">function makeObj(address) {
    trialImage = [address, 50, 50];
    ...
    ...
}
</pre></div>

<p><br><br><a href="posts/define-a-global-variable-in-a-javascript-function/">查看原文</a></p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/jian-cha-dui-xiang-shi-fou-wei-jquery-dui-xiang/" class="u-url">检查对象是否为 jQuery 对象</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/jian-cha-dui-xiang-shi-fou-wei-jquery-dui-xiang/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T20:19:16+08:00" itemprop="datePublished" title="2023-02-17 20:19">2023-02-17 20:19</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>有没有一种快速检查对象是 jQuery 对象还是原生 JavaScript 对象的方法？</p>
<p>例子：</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{};</span>
<span class="k">var</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="s1">'#element'</span><span class="p">);</span>

<span class="n">function</span><span class="w"> </span><span class="n">doStuff</span><span class="p">(</span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">selector</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">'object is jQuery'</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="n">doStuff</span><span class="p">(</span><span class="n">o</span><span class="p">);</span>
<span class="n">doStuff</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
</pre></div>

<p>显然，上面的代码可以工作，但并不安全。您可能会向<code>o</code>对象添加一个选择器键并获得相同的结果。有没有更好的方法来确保该对象实际上是一个 jQuery 对象？</p>
<p>符合的东西<code>(typeof obj == 'jquery')</code></p>
<p><br><br></p>
<h2>解答</h2>
<p>您可以使用<code>instanceof</code>运算符：</p>
<div class="code"><pre class="code literal-block"><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">obj</span><span class="w"> </span><span class="nv">instanceof</span><span class="w"> </span><span class="nv">jQuery</span><span class="ss">)</span>{
<span class="w">    </span><span class="nv">console</span>.<span class="nv">log</span><span class="ss">(</span><span class="s1">'object is jQuery'</span><span class="ss">)</span><span class="c1">;</span>
}
</pre></div>

<p><strong>说明</strong> ：<code>jQuery</code>函数（又名）作为构造函数<code>$</code>实现。构造函数将使用前缀调用。<code>new</code></p>
<p>当您调用时<code>$(foo)</code>，jQuery 在内部将其转换为<code>new jQuery(foo)</code>1。JavaScript
继续在构造函数内部初始化<code>this</code>以指向 的新实例<code>jQuery</code>，将其属性设置为在<code>jQuery.prototype</code>(aka <code>jQuery.fn</code>)
上找到的属性。因此，你得到一个<code>new</code>对象 where <code>instanceof jQuery</code>is <code>true</code>。</p>
<hr>
<p>1它实际上是<code>new jQuery.prototype.init(foo)</code>：构造函数逻辑已被卸载到另一个构造函数调用<code>init</code>，但概念是相同的。</p>
<p><br></p>
<h3>更多建议</h3>
<p>您也可以按照此处所述使用 .jquery 属性： http: //api.jquery.com/jquery-2/</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">what</span><span class="p">:</span><span class="w"> </span><span class="s2">"A regular JS object"</span><span class="w"> </span><span class="p">},</span>
<span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="s1">'body'</span><span class="p">);</span>

<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">a</span><span class="o">.</span><span class="n">jquery</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">falsy</span><span class="p">,</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="n">it</span><span class="s1">'s undefined</span>
<span class="w">    </span><span class="n">alert</span><span class="p">(</span><span class="s1">' a is a jQuery object! '</span><span class="p">);</span><span class="w">    </span>
<span class="p">}</span>

<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">b</span><span class="o">.</span><span class="n">jquery</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">truthy</span><span class="p">,</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="n">it</span><span class="s1">'s a string</span>
<span class="w">    </span><span class="n">alert</span><span class="p">(</span><span class="s1">' b is a jQuery object! '</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>

<p><br><br><a href="posts/check-if-object-is-a-jquery-object/">查看原文</a></p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-943.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-941.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
