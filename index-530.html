<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 530) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-530.html">
<link rel="prev" href="index-531.html" type="text/html">
<link rel="next" href="index-529.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-do-i-replace-na-values-with-zeros-in-an-r-dataframe/" class="u-url">How do I replace NA values with zeros in an R dataframe?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-do-i-replace-na-values-with-zeros-in-an-r-dataframe/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T09:14:08+08:00" itemprop="datePublished" title="2023-02-17 09:14">2023-02-17 09:14</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I have a data frame and some columns have <code>NA</code> values.</p>
<p>How do I replace these <code>NA</code> values with zeroes?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>See my comment in @gsk3 answer. A simple example:</p>
<div class="code"><pre class="code literal-block"><span class="o">&gt;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">matrix</span><span class="p">(</span><span class="nf">sample</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">),</span><span class="w"> </span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="n">replace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span><span class="w"> </span><span class="m">10</span><span class="p">)</span>
<span class="o">&gt;</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="w">   </span><span class="n">V1</span><span class="w"> </span><span class="n">V2</span><span class="w"> </span><span class="n">V3</span><span class="w"> </span><span class="n">V4</span><span class="w"> </span><span class="n">V5</span><span class="w"> </span><span class="n">V6</span><span class="w"> </span><span class="n">V7</span><span class="w"> </span><span class="n">V8</span><span class="w"> </span><span class="n">V9</span><span class="w"> </span><span class="n">V10</span>
<span class="m">1</span><span class="w">   </span><span class="m">4</span><span class="w">  </span><span class="m">3</span><span class="w"> </span><span class="kc">NA</span><span class="w">  </span><span class="m">3</span><span class="w">  </span><span class="m">7</span><span class="w">  </span><span class="m">6</span><span class="w">  </span><span class="m">6</span><span class="w"> </span><span class="m">10</span><span class="w">  </span><span class="m">6</span><span class="w">   </span><span class="m">5</span>
<span class="m">2</span><span class="w">   </span><span class="m">9</span><span class="w">  </span><span class="m">8</span><span class="w">  </span><span class="m">9</span><span class="w">  </span><span class="m">5</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="kc">NA</span><span class="w">  </span><span class="m">2</span><span class="w">  </span><span class="m">1</span><span class="w">  </span><span class="m">7</span><span class="w">   </span><span class="m">2</span>
<span class="m">3</span><span class="w">   </span><span class="m">1</span><span class="w">  </span><span class="m">1</span><span class="w">  </span><span class="m">6</span><span class="w">  </span><span class="m">3</span><span class="w">  </span><span class="m">6</span><span class="w"> </span><span class="kc">NA</span><span class="w">  </span><span class="m">1</span><span class="w">  </span><span class="m">4</span><span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">6</span>
<span class="m">4</span><span class="w">  </span><span class="kc">NA</span><span class="w">  </span><span class="m">4</span><span class="w"> </span><span class="kc">NA</span><span class="w">  </span><span class="m">7</span><span class="w"> </span><span class="m">10</span><span class="w">  </span><span class="m">2</span><span class="w"> </span><span class="kc">NA</span><span class="w">  </span><span class="m">4</span><span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">8</span>
<span class="m">5</span><span class="w">   </span><span class="m">1</span><span class="w">  </span><span class="m">2</span><span class="w">  </span><span class="m">4</span><span class="w"> </span><span class="kc">NA</span><span class="w">  </span><span class="m">2</span><span class="w">  </span><span class="m">6</span><span class="w">  </span><span class="m">2</span><span class="w">  </span><span class="m">6</span><span class="w">  </span><span class="m">7</span><span class="w">   </span><span class="m">4</span>
<span class="m">6</span><span class="w">  </span><span class="kc">NA</span><span class="w">  </span><span class="m">3</span><span class="w"> </span><span class="kc">NA</span><span class="w"> </span><span class="kc">NA</span><span class="w"> </span><span class="m">10</span><span class="w">  </span><span class="m">2</span><span class="w">  </span><span class="m">1</span><span class="w"> </span><span class="m">10</span><span class="w">  </span><span class="m">8</span><span class="w">   </span><span class="m">4</span>
<span class="m">7</span><span class="w">   </span><span class="m">4</span><span class="w">  </span><span class="m">4</span><span class="w">  </span><span class="m">9</span><span class="w"> </span><span class="m">10</span><span class="w">  </span><span class="m">9</span><span class="w">  </span><span class="m">8</span><span class="w">  </span><span class="m">9</span><span class="w">  </span><span class="m">4</span><span class="w"> </span><span class="m">10</span><span class="w">  </span><span class="kc">NA</span>
<span class="m">8</span><span class="w">   </span><span class="m">5</span><span class="w">  </span><span class="m">8</span><span class="w">  </span><span class="m">3</span><span class="w">  </span><span class="m">2</span><span class="w">  </span><span class="m">1</span><span class="w">  </span><span class="m">4</span><span class="w">  </span><span class="m">5</span><span class="w">  </span><span class="m">9</span><span class="w">  </span><span class="m">4</span><span class="w">   </span><span class="m">7</span>
<span class="m">9</span><span class="w">   </span><span class="m">3</span><span class="w">  </span><span class="m">9</span><span class="w"> </span><span class="m">10</span><span class="w">  </span><span class="m">1</span><span class="w">  </span><span class="m">9</span><span class="w">  </span><span class="m">9</span><span class="w"> </span><span class="m">10</span><span class="w">  </span><span class="m">5</span><span class="w">  </span><span class="m">3</span><span class="w">   </span><span class="m">3</span>
<span class="m">10</span><span class="w">  </span><span class="m">4</span><span class="w">  </span><span class="m">2</span><span class="w">  </span><span class="m">2</span><span class="w">  </span><span class="m">5</span><span class="w"> </span><span class="kc">NA</span><span class="w">  </span><span class="m">9</span><span class="w">  </span><span class="m">7</span><span class="w">  </span><span class="m">2</span><span class="w">  </span><span class="m">5</span><span class="w">   </span><span class="m">5</span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">d</span><span class="p">[</span><span class="nf">is.na</span><span class="p">(</span><span class="n">d</span><span class="p">)]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0</span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">d</span>
<span class="w">   </span><span class="n">V1</span><span class="w"> </span><span class="n">V2</span><span class="w"> </span><span class="n">V3</span><span class="w"> </span><span class="n">V4</span><span class="w"> </span><span class="n">V5</span><span class="w"> </span><span class="n">V6</span><span class="w"> </span><span class="n">V7</span><span class="w"> </span><span class="n">V8</span><span class="w"> </span><span class="n">V9</span><span class="w"> </span><span class="n">V10</span>
<span class="m">1</span><span class="w">   </span><span class="m">4</span><span class="w">  </span><span class="m">3</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">3</span><span class="w">  </span><span class="m">7</span><span class="w">  </span><span class="m">6</span><span class="w">  </span><span class="m">6</span><span class="w"> </span><span class="m">10</span><span class="w">  </span><span class="m">6</span><span class="w">   </span><span class="m">5</span>
<span class="m">2</span><span class="w">   </span><span class="m">9</span><span class="w">  </span><span class="m">8</span><span class="w">  </span><span class="m">9</span><span class="w">  </span><span class="m">5</span><span class="w"> </span><span class="m">10</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">2</span><span class="w">  </span><span class="m">1</span><span class="w">  </span><span class="m">7</span><span class="w">   </span><span class="m">2</span>
<span class="m">3</span><span class="w">   </span><span class="m">1</span><span class="w">  </span><span class="m">1</span><span class="w">  </span><span class="m">6</span><span class="w">  </span><span class="m">3</span><span class="w">  </span><span class="m">6</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">1</span><span class="w">  </span><span class="m">4</span><span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">6</span>
<span class="m">4</span><span class="w">   </span><span class="m">0</span><span class="w">  </span><span class="m">4</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">7</span><span class="w"> </span><span class="m">10</span><span class="w">  </span><span class="m">2</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">4</span><span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">8</span>
<span class="m">5</span><span class="w">   </span><span class="m">1</span><span class="w">  </span><span class="m">2</span><span class="w">  </span><span class="m">4</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">2</span><span class="w">  </span><span class="m">6</span><span class="w">  </span><span class="m">2</span><span class="w">  </span><span class="m">6</span><span class="w">  </span><span class="m">7</span><span class="w">   </span><span class="m">4</span>
<span class="m">6</span><span class="w">   </span><span class="m">0</span><span class="w">  </span><span class="m">3</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w"> </span><span class="m">10</span><span class="w">  </span><span class="m">2</span><span class="w">  </span><span class="m">1</span><span class="w"> </span><span class="m">10</span><span class="w">  </span><span class="m">8</span><span class="w">   </span><span class="m">4</span>
<span class="m">7</span><span class="w">   </span><span class="m">4</span><span class="w">  </span><span class="m">4</span><span class="w">  </span><span class="m">9</span><span class="w"> </span><span class="m">10</span><span class="w">  </span><span class="m">9</span><span class="w">  </span><span class="m">8</span><span class="w">  </span><span class="m">9</span><span class="w">  </span><span class="m">4</span><span class="w"> </span><span class="m">10</span><span class="w">   </span><span class="m">0</span>
<span class="m">8</span><span class="w">   </span><span class="m">5</span><span class="w">  </span><span class="m">8</span><span class="w">  </span><span class="m">3</span><span class="w">  </span><span class="m">2</span><span class="w">  </span><span class="m">1</span><span class="w">  </span><span class="m">4</span><span class="w">  </span><span class="m">5</span><span class="w">  </span><span class="m">9</span><span class="w">  </span><span class="m">4</span><span class="w">   </span><span class="m">7</span>
<span class="m">9</span><span class="w">   </span><span class="m">3</span><span class="w">  </span><span class="m">9</span><span class="w"> </span><span class="m">10</span><span class="w">  </span><span class="m">1</span><span class="w">  </span><span class="m">9</span><span class="w">  </span><span class="m">9</span><span class="w"> </span><span class="m">10</span><span class="w">  </span><span class="m">5</span><span class="w">  </span><span class="m">3</span><span class="w">   </span><span class="m">3</span>
<span class="m">10</span><span class="w">  </span><span class="m">4</span><span class="w">  </span><span class="m">2</span><span class="w">  </span><span class="m">2</span><span class="w">  </span><span class="m">5</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">9</span><span class="w">  </span><span class="m">7</span><span class="w">  </span><span class="m">2</span><span class="w">  </span><span class="m">5</span><span class="w">   </span><span class="m">5</span>
</pre></div>

<p>There's no need to apply <code>apply</code>. =)</p>
<p><strong>EDIT</strong></p>
<p>You should also take a look at <code>norm</code> package. It has a lot of nice features
for missing data analysis. =)</p>
<p><br></p>
<h3>Suggest</h3>
<p>The dplyr hybridized options are now around 30% faster than the Base R subset
reassigns. On a 100M datapoint dataframe <code>mutate_all(~replace(., is.na(.),
0))</code> runs a half a second faster than the base R <code>d[is.na(d)] &lt;- 0</code> option.
What one wants to avoid specifically is using an <code>ifelse()</code> or an <code>if_else()</code>.
(The complete 600 trial analysis ran to over 4.5 hours mostly due to including
these approaches.) Please see benchmark analyses below for the complete
results.</p>
<p>If you are struggling with massive dataframes, <code>data.table</code> is the fastest
option of all: 40% faster than the standard <em>Base R</em> approach. It also
modifies the data in place, effectively allowing you to work with nearly twice
as much of the data at once.</p>
<hr>
<h4>A clustering of other helpful tidyverse replacement approaches</h4>
<p><em><strong>Locationally:</strong></em></p>
<ul>
<li>
<em>index</em> <code>mutate_at(c(5:10), ~replace(., is.na(.), 0))</code>
</li>
<li>
<em>direct reference</em> <code>mutate_at(vars(var5:var10), ~replace(., is.na(.), 0))</code>
</li>
<li>
<p><em>fixed match</em> <code>mutate_at(vars(contains("1")), ~replace(., is.na(.), 0))</code></p>
</li>
<li>
<p>or in place of <code>contains()</code>, try <code>ends_with()</code>,<code>starts_with()</code></p>
</li>
<li>
<p><em>pattern match</em> <code>mutate_at(vars(matches("\\d{2}")), ~replace(., is.na(.), 0))</code></p>
</li>
</ul>
<p><em><strong>Conditionally:</strong></em><br>
(change just single type and leave other types alone.)</p>
<ul>
<li>
<em>integers</em> <code>mutate_if(is.integer, ~replace(., is.na(.), 0))</code>
</li>
<li>
<em>numbers</em> <code>mutate_if(is.numeric, ~replace(., is.na(.), 0))</code>
</li>
<li>
<em>strings</em> <code>mutate_if(is.character, ~replace(., is.na(.), 0))</code>
</li>
</ul>
<hr>
<h3>The Complete Analysis - _Updated for dplyr 0.8.0: functions use purrr format</h3>
<p><strong><code>~</code></strong> symbols: replacing deprecated <code>funs()</code> arguments._</p>
<h4>Approaches tested:</h4>
<div class="code"><pre class="code literal-block"><span class="err">#</span><span class="w"> </span><span class="n">Base</span><span class="w"> </span><span class="nl">R</span><span class="p">:</span><span class="w"> </span>
<span class="n">baseR</span><span class="p">.</span><span class="n">sbst</span><span class="p">.</span><span class="n">rssgn</span><span class="w">   </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="n">x</span><span class="o">[</span><span class="n">is.na(x)</span><span class="o">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="err">}</span>
<span class="n">baseR</span><span class="p">.</span><span class="nf">replace</span><span class="w">      </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="nf">replace</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="k">is</span><span class="p">.</span><span class="n">na</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="err">}</span>
<span class="n">baseR</span><span class="p">.</span><span class="k">for</span><span class="w">          </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="mi">1</span><span class="err">:</span><span class="n">ncol</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="w">    </span><span class="n">x</span><span class="o">[</span><span class="n">[j</span><span class="o">]</span><span class="err">]</span><span class="o">[</span><span class="n">is.na(x[[j</span><span class="o">]</span><span class="err">]</span><span class="p">)</span><span class="err">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="err">}</span>

<span class="err">#</span><span class="w"> </span><span class="n">tidyverse</span>
<span class="err">##</span><span class="w"> </span><span class="n">dplyr</span>
<span class="n">dplyr_if_else</span><span class="w">      </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="n">mutate_all</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="o">~</span><span class="n">if_else</span><span class="p">(</span><span class="k">is</span><span class="p">.</span><span class="n">na</span><span class="p">(.),</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="p">.))</span><span class="w"> </span><span class="err">}</span>
<span class="n">dplyr_coalesce</span><span class="w">     </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="n">mutate_all</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="o">~</span><span class="k">coalesce</span><span class="p">(.,</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="err">}</span>

<span class="err">##</span><span class="w"> </span><span class="n">tidyr</span>
<span class="n">tidyr_replace_na</span><span class="w">   </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="n">replace_na</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="k">as</span><span class="p">.</span><span class="n">list</span><span class="p">(</span><span class="n">setNames</span><span class="p">(</span><span class="n">rep</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">),</span><span class="w"> </span><span class="k">as</span><span class="p">.</span><span class="n">list</span><span class="p">(</span><span class="n">c</span><span class="p">(</span><span class="n">paste0</span><span class="p">(</span><span class="ss">"var"</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="err">:</span><span class="mi">10</span><span class="p">))))))</span><span class="w"> </span><span class="err">}</span>

<span class="err">##</span><span class="w"> </span><span class="n">hybrid</span><span class="w"> </span>
<span class="n">hybrd</span><span class="p">.</span><span class="n">ifelse</span><span class="w">     </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="n">mutate_all</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="o">~</span><span class="n">ifelse</span><span class="p">(</span><span class="k">is</span><span class="p">.</span><span class="n">na</span><span class="p">(.),</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="p">.))</span><span class="w"> </span><span class="err">}</span>
<span class="n">hybrd</span><span class="p">.</span><span class="n">replace_na</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="n">mutate_all</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="o">~</span><span class="n">replace_na</span><span class="p">(.,</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="err">}</span>
<span class="n">hybrd</span><span class="p">.</span><span class="nf">replace</span><span class="w">    </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="n">mutate_all</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="o">~</span><span class="nf">replace</span><span class="p">(.,</span><span class="w"> </span><span class="k">is</span><span class="p">.</span><span class="n">na</span><span class="p">(.),</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="err">}</span>
<span class="n">hybrd</span><span class="p">.</span><span class="n">rplc_at</span><span class="p">.</span><span class="n">idx</span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="n">mutate_at</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="err">:</span><span class="mi">10</span><span class="p">),</span><span class="w"> </span><span class="o">~</span><span class="nf">replace</span><span class="p">(.,</span><span class="w"> </span><span class="k">is</span><span class="p">.</span><span class="n">na</span><span class="p">(.),</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="err">}</span>
<span class="n">hybrd</span><span class="p">.</span><span class="n">rplc_at</span><span class="p">.</span><span class="n">nse</span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="n">mutate_at</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">vars</span><span class="p">(</span><span class="nl">var1</span><span class="p">:</span><span class="n">var10</span><span class="p">),</span><span class="w"> </span><span class="o">~</span><span class="nf">replace</span><span class="p">(.,</span><span class="w"> </span><span class="k">is</span><span class="p">.</span><span class="n">na</span><span class="p">(.),</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="err">}</span>
<span class="n">hybrd</span><span class="p">.</span><span class="n">rplc_at</span><span class="p">.</span><span class="n">stw</span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="n">mutate_at</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">vars</span><span class="p">(</span><span class="n">starts_with</span><span class="p">(</span><span class="ss">"var"</span><span class="p">)),</span><span class="w"> </span><span class="o">~</span><span class="nf">replace</span><span class="p">(.,</span><span class="w"> </span><span class="k">is</span><span class="p">.</span><span class="n">na</span><span class="p">(.),</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="err">}</span>
<span class="n">hybrd</span><span class="p">.</span><span class="n">rplc_at</span><span class="p">.</span><span class="n">ctn</span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="n">mutate_at</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">vars</span><span class="p">(</span><span class="k">contains</span><span class="p">(</span><span class="ss">"var"</span><span class="p">)),</span><span class="w"> </span><span class="o">~</span><span class="nf">replace</span><span class="p">(.,</span><span class="w"> </span><span class="k">is</span><span class="p">.</span><span class="n">na</span><span class="p">(.),</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="err">}</span>
<span class="n">hybrd</span><span class="p">.</span><span class="n">rplc_at</span><span class="p">.</span><span class="n">mtc</span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="n">mutate_at</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">vars</span><span class="p">(</span><span class="n">matches</span><span class="p">(</span><span class="ss">"\\d+"</span><span class="p">)),</span><span class="w"> </span><span class="o">~</span><span class="nf">replace</span><span class="p">(.,</span><span class="w"> </span><span class="k">is</span><span class="p">.</span><span class="n">na</span><span class="p">(.),</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="err">}</span>
<span class="n">hybrd</span><span class="p">.</span><span class="n">rplc_if</span><span class="w">    </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="n">mutate_if</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="k">is</span><span class="p">.</span><span class="nc">numeric</span><span class="p">,</span><span class="w"> </span><span class="o">~</span><span class="nf">replace</span><span class="p">(.,</span><span class="w"> </span><span class="k">is</span><span class="p">.</span><span class="n">na</span><span class="p">(.),</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="err">}</span>

<span class="err">#</span><span class="w"> </span><span class="k">data</span><span class="p">.</span><span class="nc">table</span><span class="w">   </span>
<span class="n">library</span><span class="p">(</span><span class="k">data</span><span class="p">.</span><span class="nc">table</span><span class="p">)</span>
<span class="n">DT</span><span class="p">.</span><span class="k">for</span><span class="p">.</span><span class="k">set</span><span class="p">.</span><span class="n">nms</span><span class="w">   </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">names</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="w">    </span><span class="k">set</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">which</span><span class="p">(</span><span class="k">is</span><span class="p">.</span><span class="n">na</span><span class="p">(</span><span class="n">x</span><span class="o">[</span><span class="n">[j</span><span class="o">]</span><span class="err">]</span><span class="p">)),</span><span class="n">j</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="err">}</span>
<span class="n">DT</span><span class="p">.</span><span class="k">for</span><span class="p">.</span><span class="k">set</span><span class="p">.</span><span class="n">sqln</span><span class="w">  </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">seq_len</span><span class="p">(</span><span class="n">ncol</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
<span class="w">    </span><span class="k">set</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">which</span><span class="p">(</span><span class="k">is</span><span class="p">.</span><span class="n">na</span><span class="p">(</span><span class="n">x</span><span class="o">[</span><span class="n">[j</span><span class="o">]</span><span class="err">]</span><span class="p">)),</span><span class="n">j</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="err">}</span>
<span class="n">DT</span><span class="p">.</span><span class="n">nafill</span><span class="w">        </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="n">nafill</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="err">}</span>
<span class="n">DT</span><span class="p">.</span><span class="n">setnafill</span><span class="w">     </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="n">setnafill</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="err">}</span>
</pre></div>

<h4>The code for this analysis:</h4>
<div class="code"><pre class="code literal-block"><span class="n">library</span><span class="p">(</span><span class="n">microbenchmark</span><span class="p">)</span>
<span class="c1"># 20% NA filled dataframe of 10 Million rows and 10 columns</span>
<span class="n">set</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span><span class="w"> </span><span class="c1"># to recreate the exact dataframe</span>
<span class="n">dfN</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">as</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">frame</span><span class="p">(</span><span class="n">matrix</span><span class="p">(</span><span class="n">sample</span><span class="p">(</span><span class="n">c</span><span class="p">(</span><span class="n">NA</span><span class="p">,</span><span class="w"> </span><span class="k">as</span><span class="o">.</span><span class="n">numeric</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">)),</span><span class="w"> </span><span class="mf">1e7</span><span class="o">*</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">replace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TRUE</span><span class="p">),</span>
<span class="w">                            </span><span class="n">dimnames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">list</span><span class="p">(</span><span class="n">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">paste0</span><span class="p">(</span><span class="s2">"var"</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="mi">10</span><span class="p">)),</span><span class="w"> </span>
<span class="w">                            </span><span class="n">ncol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">))</span>
<span class="c1"># Running 600 trials with each replacement method </span>
<span class="c1"># (the functions are excecuted locally - so that the original dataframe remains unmodified in all cases)</span>
<span class="n">perf_results</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">microbenchmark</span><span class="p">(</span>
<span class="w">    </span><span class="n">hybrd</span><span class="o">.</span><span class="n">ifelse</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">hybrd</span><span class="o">.</span><span class="n">ifelse</span><span class="p">(</span><span class="n">copy</span><span class="p">(</span><span class="n">dfN</span><span class="p">)),</span>
<span class="w">    </span><span class="n">dplyr_if_else</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">dplyr_if_else</span><span class="p">(</span><span class="n">copy</span><span class="p">(</span><span class="n">dfN</span><span class="p">)),</span>
<span class="w">    </span><span class="n">hybrd</span><span class="o">.</span><span class="n">replace_na</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hybrd</span><span class="o">.</span><span class="n">replace_na</span><span class="p">(</span><span class="n">copy</span><span class="p">(</span><span class="n">dfN</span><span class="p">)),</span>
<span class="w">    </span><span class="n">baseR</span><span class="o">.</span><span class="n">sbst</span><span class="o">.</span><span class="n">rssgn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">baseR</span><span class="o">.</span><span class="n">sbst</span><span class="o">.</span><span class="n">rssgn</span><span class="p">(</span><span class="n">copy</span><span class="p">(</span><span class="n">dfN</span><span class="p">)),</span>
<span class="w">    </span><span class="n">baseR</span><span class="o">.</span><span class="n">replace</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">baseR</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">copy</span><span class="p">(</span><span class="n">dfN</span><span class="p">)),</span>
<span class="w">    </span><span class="n">dplyr_coalesce</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">dplyr_coalesce</span><span class="p">(</span><span class="n">copy</span><span class="p">(</span><span class="n">dfN</span><span class="p">)),</span>
<span class="w">    </span><span class="n">tidyr_replace_na</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tidyr_replace_na</span><span class="p">(</span><span class="n">copy</span><span class="p">(</span><span class="n">dfN</span><span class="p">)),</span>
<span class="w">    </span><span class="n">hybrd</span><span class="o">.</span><span class="n">replace</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">hybrd</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">copy</span><span class="p">(</span><span class="n">dfN</span><span class="p">)),</span>
<span class="w">    </span><span class="n">hybrd</span><span class="o">.</span><span class="n">rplc_at</span><span class="o">.</span><span class="n">ctn</span><span class="o">=</span><span class="w"> </span><span class="n">hybrd</span><span class="o">.</span><span class="n">rplc_at</span><span class="o">.</span><span class="n">ctn</span><span class="p">(</span><span class="n">copy</span><span class="p">(</span><span class="n">dfN</span><span class="p">)),</span>
<span class="w">    </span><span class="n">hybrd</span><span class="o">.</span><span class="n">rplc_at</span><span class="o">.</span><span class="n">nse</span><span class="o">=</span><span class="w"> </span><span class="n">hybrd</span><span class="o">.</span><span class="n">rplc_at</span><span class="o">.</span><span class="n">nse</span><span class="p">(</span><span class="n">copy</span><span class="p">(</span><span class="n">dfN</span><span class="p">)),</span>
<span class="w">    </span><span class="n">baseR</span><span class="o">.</span><span class="k">for</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="n">baseR</span><span class="o">.</span><span class="k">for</span><span class="p">(</span><span class="n">copy</span><span class="p">(</span><span class="n">dfN</span><span class="p">)),</span>
<span class="w">    </span><span class="n">hybrd</span><span class="o">.</span><span class="n">rplc_at</span><span class="o">.</span><span class="n">idx</span><span class="o">=</span><span class="w"> </span><span class="n">hybrd</span><span class="o">.</span><span class="n">rplc_at</span><span class="o">.</span><span class="n">idx</span><span class="p">(</span><span class="n">copy</span><span class="p">(</span><span class="n">dfN</span><span class="p">)),</span>
<span class="w">    </span><span class="n">DT</span><span class="o">.</span><span class="k">for</span><span class="o">.</span><span class="n">set</span><span class="o">.</span><span class="n">nms</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">DT</span><span class="o">.</span><span class="k">for</span><span class="o">.</span><span class="n">set</span><span class="o">.</span><span class="n">nms</span><span class="p">(</span><span class="n">copy</span><span class="p">(</span><span class="n">dfN</span><span class="p">)),</span>
<span class="w">    </span><span class="n">DT</span><span class="o">.</span><span class="k">for</span><span class="o">.</span><span class="n">set</span><span class="o">.</span><span class="n">sqln</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">DT</span><span class="o">.</span><span class="k">for</span><span class="o">.</span><span class="n">set</span><span class="o">.</span><span class="n">sqln</span><span class="p">(</span><span class="n">copy</span><span class="p">(</span><span class="n">dfN</span><span class="p">)),</span>
<span class="w">    </span><span class="n">times</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">600</span><span class="n">L</span>
<span class="p">)</span>
</pre></div>

<h4>Summary of Results</h4>
<blockquote>
<div class="code"><pre class="code literal-block">&gt; print(perf_results)
Unit: milliseconds
              expr       min        lq     mean   median       uq
</pre></div>

<p>max neval
          hybrd.ifelse 6171.0439 6339.7046 6425.221 6407.397 6496.992
7052.851   600
         dplyr_if_else 3737.4954 3877.0983 3953.857 3946.024 4023.301
4539.428   600
      hybrd.replace_na 1497.8653 1706.1119 1748.464 1745.282 1789.804
2127.166   600
      baseR.sbst.rssgn 1480.5098 1686.1581 1730.006 1728.477 1772.951
2010.215   600
         baseR.replace 1457.4016 1681.5583 1725.481 1722.069 1766.916
2089.627   600
        dplyr_coalesce 1227.6150 1483.3520 1524.245 1519.454 1561.488
1996.859   600
      tidyr_replace_na 1248.3292 1473.1707 1521.889 1520.108 1570.382
1995.768   600
         hybrd.replace  913.1865 1197.3133 1233.336 1238.747 1276.141
1438.646   600
     hybrd.rplc_at.ctn  916.9339 1192.9885 1224.733 1227.628 1268.644
1466.085   600
     hybrd.rplc_at.nse  919.0270 1191.0541 1228.749 1228.635 1275.103
2882.040   600
             baseR.for  869.3169 1180.8311 1216.958 1224.407 1264.737
1459.726   600
     hybrd.rplc_at.idx  839.8915 1189.7465 1223.326 1228.329 1266.375
1565.794   600
        DT.for.set.nms  761.6086  915.8166 1015.457 1001.772 1106.315
1363.044   600
       DT.for.set.sqln  787.3535  918.8733 1017.812 1002.042 1122.474
1321.860   600
</p>
</blockquote>
<h4>Boxplot of Results</h4>
<div class="code"><pre class="code literal-block">ggplot(perf_results, aes(x=expr, y=time/10^9)) +
    geom_boxplot() +
    xlab('Expression') +
    ylab('Elapsed Time (Seconds)') +
    scale_y_continuous(breaks = seq(0,7,1)) +
    coord_flip()
</pre></div>

<p><img alt="Boxplot Comparison of Elapsed Time" src="images/6BoFk.png"></p>
<h4>Color-coded Scatterplot of Trials (with y-axis on a log scale)</h4>
<div class="code"><pre class="code literal-block">qplot(y=time/10^9, data=perf_results, colour=expr) + 
    labs(y = "log10 Scaled Elapsed Time per Trial (secs)", x = "Trial Number") +
    coord_cartesian(ylim = c(0.75, 7.5)) +
    scale_y_log10(breaks=c(0.75, 0.875, 1, 1.25, 1.5, 1.75, seq(2, 7.5)))
</pre></div>

<p><img alt="Scatterplot of All Trial Times" src="images/x1uaK.png"></p>
<h4>A note on the other high performers</h4>
<p>When the datasets get larger, <em>Tidyr</em> ''s <code>replace_na</code> had historically pulled
out in front. With the current collection of 100M data points to run through,
it performs almost exactly as well as a <em>Base R</em> For Loop. I am curious to see
what happens for different sized dataframes.</p>
<p>Additional examples for the <code>mutate</code> and <code>summarize</code> <code>_at</code> and <code>_all</code> function
variants can be found here: https://rdrr.io/cran/dplyr/man/summarise_all.html
Additionally, I found helpful demonstrations and collections of examples here:
https://blog.exploratory.io/dplyr-0-5-is-awesome-heres-why-be095fd4eb8a</p>
<h4>Attributions and Appreciations</h4>
<p>With special thanks to:</p>
<ul>
<li>Tyler Rinker and Akrun for demonstrating microbenchmark.</li>
<li>alexis_laz for working on helping me understand the use of <code>local()</code>, and (with Frank's patient help, too) the role that silent coercion plays in speeding up many of these approaches.</li>
<li>ArthurYip for the poke to add the newer <code>coalesce()</code> function in and update the analysis.</li>
<li>Gregor for the nudge to figure out the <code>data.table</code> functions well enough to finally include them in the lineup.</li>
<li>
<em>Base R</em> For loop: <em>alexis_laz</em>
</li>
<li>
<em>data.table</em> For Loops: <em>Matt_Dowle</em>
</li>
<li>Roman for explaining what <code>is.numeric()</code> really tests.</li>
</ul>
<p><em>(Of course, please reach over and give them upvotes, too if you find those
approaches useful.)</em></p>
<p><em><strong>Note on my use of Numerics:</strong></em> If you do have a pure integer dataset, all
of your functions will run faster. Please see alexiz_laz's work for more
information. IRL, I can't recall encountering a data set containing more than
10-15% integers, so I am running these tests on fully numeric dataframes.</p>
<p><em><strong>Hardware Used</strong></em> 3.9 GHz CPU with 24 GB RAM</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-determine-equality-for-two-javascript-objects/" class="u-url">How to determine equality for two JavaScript objects?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-determine-equality-for-two-javascript-objects/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T09:13:39+08:00" itemprop="datePublished" title="2023-02-17 09:13">2023-02-17 09:13</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>A strict equality operator will tell you if two object <strong>types</strong> are equal.
However, is there a way to tell if two objects are equal, <strong>much like the hash
code</strong> value in Java?</p>
<p>Stack Overflow question <em>Is there any kind of hashCode function in
JavaScript?</em> is similar to this question, but requires a more academic answer.
The scenario above demonstrates why it would be necessary to have one, and I'm
wondering if there is any <strong>equivalent solution</strong>.</p>
<p><br><br></p>
<h2>Answer</h2>
<p><strong>The short answer</strong></p>
<p>The simple answer is: No, there is no generic means to determine that an
object is equal to another in the sense you mean. The exception is when you
are strictly thinking of an object being typeless.</p>
<p><strong>The long answer</strong></p>
<p>The concept is that of an Equals method that compares two different instances
of an object to indicate whether they are equal at a value level. However, it
is up to the specific type to define how an <code>Equals</code> method should be
implemented. An iterative comparison of attributes that have primitive values
may not be enough: an object may contain attributes which are not relevant to
equality. For example,</p>
<div class="code"><pre class="code literal-block"><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="nf">MyClass</span><span class="p">(</span>a, b<span class="p">)</span>
<span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="nb">var</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
<span class="w">     </span><span class="n">this</span><span class="p">.</span><span class="n">getCLazy</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="o">==</span><span class="p">=</span><span class="w"> </span><span class="n">undefined</span><span class="p">)</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">imagine</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">really</span><span class="w"> </span><span class="n">expensive</span>
<span class="w">         </span><span class="k">return</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
<span class="w">     </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
</pre></div>

<p>In this above case, <code>c</code> is not really important to determine whether any two
instances of MyClass are equal, only <code>a</code> and <code>b</code> are important. In some cases
<code>c</code> might vary between instances and yet not be significant during comparison.</p>
<p>Note this issue applies when members may themselves also be instances of a
type and these each would all be required to have a means of determining
equality.</p>
<p>Further complicating things is that in JavaScript the distinction between data
and method is blurred.</p>
<p>An object may reference a method that is to be called as an event handler, and
this would likely not be considered part of its 'value state'. Whereas another
object may well be assigned a function that performs an important calculation
and thereby makes this instance different from others simply because it
references a different function.</p>
<p>What about an object that has one of its existing prototype methods overridden
by another function? Could it still be considered equal to another instance
that it otherwise identical? That question can only be answered in each
specific case for each type.</p>
<p>As stated earlier, the exception would be a strictly typeless object. In which
case the only sensible choice is an iterative and recursive comparison of each
member. Even then one has to ask what is the 'value' of a function?</p>
<p><br></p>
<h3>Suggest</h3>
<p><strong>The short answer</strong></p>
<p>The simple answer is: No, there is no generic means to determine that an
object is equal to another in the sense you mean. The exception is when you
are strictly thinking of an object being typeless.</p>
<p><strong>The long answer</strong></p>
<p>The concept is that of an Equals method that compares two different instances
of an object to indicate whether they are equal at a value level. However, it
is up to the specific type to define how an <code>Equals</code> method should be
implemented. An iterative comparison of attributes that have primitive values
may not be enough: an object may contain attributes which are not relevant to
equality. For example,</p>
<div class="code"><pre class="code literal-block"><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="nf">MyClass</span><span class="p">(</span>a, b<span class="p">)</span>
<span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="nb">var</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
<span class="w">     </span><span class="n">this</span><span class="p">.</span><span class="n">getCLazy</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="o">==</span><span class="p">=</span><span class="w"> </span><span class="n">undefined</span><span class="p">)</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">imagine</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">really</span><span class="w"> </span><span class="n">expensive</span>
<span class="w">         </span><span class="k">return</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
<span class="w">     </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
</pre></div>

<p>In this above case, <code>c</code> is not really important to determine whether any two
instances of MyClass are equal, only <code>a</code> and <code>b</code> are important. In some cases
<code>c</code> might vary between instances and yet not be significant during comparison.</p>
<p>Note this issue applies when members may themselves also be instances of a
type and these each would all be required to have a means of determining
equality.</p>
<p>Further complicating things is that in JavaScript the distinction between data
and method is blurred.</p>
<p>An object may reference a method that is to be called as an event handler, and
this would likely not be considered part of its 'value state'. Whereas another
object may well be assigned a function that performs an important calculation
and thereby makes this instance different from others simply because it
references a different function.</p>
<p>What about an object that has one of its existing prototype methods overridden
by another function? Could it still be considered equal to another instance
that it otherwise identical? That question can only be answered in each
specific case for each type.</p>
<p>As stated earlier, the exception would be a strictly typeless object. In which
case the only sensible choice is an iterative and recursive comparison of each
member. Even then one has to ask what is the 'value' of a function?</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/difference-between-npx-and-npm/" class="u-url">Difference between npx and npm?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/difference-between-npx-and-npm/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T09:12:53+08:00" itemprop="datePublished" title="2023-02-17 09:12">2023-02-17 09:12</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I have just started learning React, and Facebook helps in simplifying the
initial setup by providing the following ready-made project.</p>
<p>If I have to install the skeleton project I have to type <code>npx create-react-app
my-app</code> in command-line.</p>
<p>I was wondering why does the Facebook in Github have <code>npx create-react-app my-
app</code> rather than <code>npm create-react-app my-app</code>?</p>
<p><br><br></p>
<h2>Answer</h2>
<h3>Introducing npx: an npm package runner</h3>
<h4>
<code>NPM</code> - <em>Manages</em> packages <em>but</em> doesn't make life easy <em>executing</em> any.</h4>
<p><code>NPX</code> - A tool for <em>executing</em> Node packages.</p>
<blockquote>
<p><code>NPX</code> comes bundled with <code>NPM</code> version <code>5.2+</code><br></p>
</blockquote>
<p><code>NPM</code> by itself does not simply run any package. It doesn't run any package as
a matter of fact. If you want to run a package using NPM, you must specify
that package in your <code>package.json</code> file.</p>
<p>When executables are installed via NPM packages, NPM links to them:</p>
<ol>
<li>
<em>local</em> installs have "links" created at <code>./node_modules/.bin/</code> directory.</li>
<li>
<em>global</em> installs have "links" created from the global <code>bin/</code> directory (e.g. <code>/usr/local/bin</code>) on Linux or at <code>%AppData%/npm</code> on Windows.</li>
</ol>
<p><strong>Documentation you should read</strong></p>
<hr>
<h2>NPM:</h2>
<p>One might install a package locally on a certain project:</p>
<div class="code"><pre class="code literal-block">npm install some-package
</pre></div>

<p>Now let's say you want NodeJS to execute that package from the command line:</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span>some-package
</pre></div>

<p>The above will <strong>fail</strong>. Only <strong>globally installed</strong> packages can be executed
by typing their name <em>only</em>.</p>
<p>To fix this, and have it run, you must type the local path:</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span>./node_modules/.bin/some-package
</pre></div>

<p>You can technically run a locally installed package by editing your
<code>packages.json</code> file and adding that package in the <code>scripts</code> section:</p>
<div class="code"><pre class="code literal-block">{
  "name": "whatever",
  "version": "1.0.0",
  "scripts": {
    "some-package": "some-package"
  }
}
</pre></div>

<p>Then run the script using <code>npm run-script</code> (or <code>npm run</code>):</p>
<div class="code"><pre class="code literal-block">npm run some-package
</pre></div>

<hr>
<h2>NPX:</h2>
<p><code>npx</code> will check whether <code>&lt;command&gt;</code> exists in <code>$PATH</code>, or in the local
project binaries, and execute it. So, for the above example, if you wish to
execute the locally-installed package <code>some-package</code> all you need to do is
type:</p>
<div class="code"><pre class="code literal-block">npx some-package
</pre></div>

<p>Another <strong>major</strong> advantage of <code>npx</code> is the ability to execute a package which
wasn't previously installed:</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span>npx<span class="w"> </span>create-react-app<span class="w"> </span>my-app
</pre></div>

<p>The above example will generate a <code>react</code> app boilerplate <em>within</em> the path
the command had run in, and ensures that you always use the latest version of
a generator or build tool without having to upgrade each time you’re about to
use it.</p>
<hr>
<h4>Use-Case Example:</h4>
<p><code>npx</code> command may be helpful in the <code>script</code> section of a <code>package.json</code> file,
when it is unwanted to define a dependency which might not be commonly used or
any other reason:</p>
<div class="code"><pre class="code literal-block"><span class="s">"scripts"</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="s">"start"</span><span class="o">:</span><span class="w"> </span><span class="s">"npx gulp@3.9.1"</span><span class="p">,</span>
<span class="w">    </span><span class="s">"serve"</span><span class="o">:</span><span class="w"> </span><span class="s">"npx http-server"</span>
<span class="p">}</span>
</pre></div>

<p>Call with: <code>npm run serve</code></p>
<hr>
<h4>Related questions:</h4>
<ol>
<li>How to use package installed locally in node_modules?</li>
<li>NPM: how to source ./node_modules/.bin folder?</li>
<li>How do you run a js file using npm scripts?</li>
</ol>
<p><br></p>
<h3>Suggest</h3>
<p><em><strong>npx</strong></em> is a npm package runner (x probably stands for eXecute). One common
way to use <em>npx</em> is to download and run a package temporarily or for trials.</p>
<p><em><strong>create-react-app</strong></em> is an npm package that is expected to be run only once
in a project's lifecycle. Hence, it is preferred to use npx to install and run
it in a single step.</p>
<p>As mentioned in the main page https://www.npmjs.com/package/npx, <em>npx</em> can run
commands in the PATH or from node_modules/.bin by default.</p>
<p><strong>Note:</strong> With some digging, we can find that create-react-app points to a
Javascript file (possibly to /usr/lib/node_modules/create-react-app/index.js
on Linux systems) that is executed within the node environment. This is simply
a global tool that does some checks. The actual setup is done by react-
scripts, whose latest version is installed in the project. Refer
https://github.com/facebook/create-react-app for more info.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-531.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-529.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
