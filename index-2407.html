<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 2407) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-2407.html">
<link rel="prev" href="index-2408.html" type="text/html">
<link rel="next" href="index-2406.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/declaring-variables-inside-loops-good-practice-or-bad-practice/" class="u-url">Declaring variables inside loops, good practice or bad practice?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/declaring-variables-inside-loops-good-practice-or-bad-practice/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T13:49:47+08:00" itemprop="datePublished" title="2023-03-04 13:49">2023-03-04 13:49</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p><strong>Question #1:</strong> Is declaring a variable inside a loop a good practice or bad
practice?</p>
<p>I've read the other threads about whether or not there is a performance issue
(most said no), and that you should always declare variables as close to where
they are going to be used. What I'm wondering is whether or not this should be
avoided or if it's actually preferred.</p>
<p>Example:</p>
<div class="code"><pre class="code literal-block"><span class="k">for</span><span class="ss">(</span><span class="nv">int</span><span class="w"> </span><span class="nv">counter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="c1">; counter &lt;= 10; counter++)</span>
{
<span class="w">   </span><span class="nv">string</span><span class="w"> </span><span class="nv">someString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"testing"</span><span class="c1">;</span>

<span class="w">   </span><span class="nv">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="nv">someString</span><span class="c1">;</span>
}
</pre></div>

<p><strong>Question #2:</strong> Do most compilers realize that the variable has already been
declared and just skip that portion, or does it actually create a spot for it
in memory each time?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>This is <strong>excellent</strong> practice.</p>
<p>By creating variables inside loops, you ensure their scope is restricted to
inside the loop. It cannot be referenced nor called outside of the loop.</p>
<p>This way:</p>
<ul>
<li>
<p>If the name of the variable is a bit "generic" (like "i"), there is no risk to mix it with another variable of same name somewhere later in your code (can also be mitigated using the <code>-Wshadow</code> warning instruction on GCC)</p>
</li>
<li>
<p>The compiler knows that the variable scope is limited to inside the loop, and therefore will issue a proper error message if the variable is by mistake referenced elsewhere.</p>
</li>
<li>
<p>Last but not least, some dedicated optimization can be performed more efficiently by the compiler (most importantly register allocation), since it knows that the variable cannot be used outside of the loop. For example, no need to store the result for later re-use.</p>
</li>
</ul>
<p>In short, you are right to do it.</p>
<p>Note however that the variable is <em>not supposed to retain its value</em> between
each loop. In such case, you may need to initialize it every time. You can
also create a larger block, encompassing the loop, whose sole purpose is to
declare variables which must retain their value from one loop to another. This
typically includes the loop counter itself.</p>
<div class="code"><pre class="code literal-block">{
<span class="w">    </span><span class="nv">int</span><span class="w"> </span><span class="nv">i</span>,<span class="w"> </span><span class="nv">retainValue</span><span class="c1">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="ss">(</span><span class="nv">i</span><span class="o">=</span><span class="mi">0</span><span class="c1">; i&lt;N; i++)</span>
<span class="w">    </span>{
<span class="w">       </span><span class="nv">int</span><span class="w"> </span><span class="nv">tmpValue</span><span class="c1">;</span>
<span class="w">       </span><span class="cm">/* tmpValue is uninitialized */</span>
<span class="w">       </span><span class="cm">/* retainValue still has its previous value from previous loop */</span>

<span class="w">       </span><span class="cm">/* Do some stuff here */</span>
<span class="w">    </span>}
<span class="w">    </span><span class="cm">/* Here, retainValue is still valid; tmpValue no longer */</span>
}
</pre></div>

<p>For question #2: The variable is allocated once, when the function is called.
In fact, from an allocation perspective, it is (nearly) the same as declaring
the variable at the beginning of the function. The only difference is the
scope: the variable cannot be used outside of the loop. It may even be
possible that the variable is not allocated, just re-using some free slot
(from other variable whose scope has ended).</p>
<p>With restricted and more precise scope come more accurate optimizations. But
more importantly, it makes your code safer, with less states (i.e. variables)
to worry about when reading other parts of the code.</p>
<p>This is true even outside of an <code>if(){...}</code> block. Typically, instead of :</p>
<div class="code"><pre class="code literal-block"><span class="w">    </span><span class="nv">int</span><span class="w"> </span><span class="nb">result</span><span class="c1">;</span>
<span class="w">    </span><span class="ss">(</span>...<span class="ss">)</span>
<span class="w">    </span><span class="nb">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">f1</span><span class="ss">()</span><span class="c1">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nb">result</span><span class="ss">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span>{<span class="w"> </span><span class="ss">(</span>...<span class="ss">)</span><span class="w"> </span>}
<span class="w">    </span><span class="ss">(</span>...<span class="ss">)</span>
<span class="w">    </span><span class="nb">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">f2</span><span class="ss">()</span><span class="c1">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nb">result</span><span class="ss">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span>{<span class="w"> </span><span class="ss">(</span>...<span class="ss">)</span><span class="w"> </span>}
</pre></div>

<p>it's safer to write :</p>
<div class="code"><pre class="code literal-block"><span class="w">    </span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f1</span><span class="p">();</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="p">)</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">(</span><span class="o">...</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f2</span><span class="p">();</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="p">)</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">(</span><span class="o">...</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
</pre></div>

<p>The difference may seem minor, especially on such a small example. But on a
larger code base, it will help : now there is no risk to transport some
<code>result</code> value from <code>f1()</code> to <code>f2()</code> block. Each <code>result</code> is strictly limited
to its own scope, making its role more accurate. From a reviewer perspective,
it's much nicer, since he has less <em>long range state variables</em> to worry about
and track.</p>
<p>Even the compiler will help better : assuming that, in the future, after some
erroneous change of code, <code>result</code> is not properly initialized with <code>f2()</code>.
The second version will simply refuse to work, stating a clear error message
at compile time (way better than run time). The first version will not spot
anything, the result of <code>f1()</code> will simply be tested a second time, being
confused for the result of <code>f2()</code>.</p>
<h4>Complementary information</h4>
<p>The open-source tool CppCheck (a static analysis tool for C/C++ code) provides
some excellent hints regarding optimal scope of variables.</p>
<p>In response to comment on allocation: The above rule is true in C, but might
not be for some C++ classes.</p>
<p>For standard types and structures, the size of variable is known at
compilation time. There is no such thing as "construction" in C, so the space
for the variable will simply be allocated into the stack (without any
initialization), when the function is called. That's why there is a "zero"
cost when declaring the variable inside a loop.</p>
<p>However, for C++ classes, there is this constructor thing which I know much
less about. I guess allocation is probably not going to be the issue, since
the compiler shall be clever enough to reuse the same space, but the
initialization is likely to take place at each loop iteration.</p>
<p><br></p>
<h3>Suggest</h3>
<p>Generally, it's a very good practice to keep it very close.</p>
<p>In some cases, there will be a consideration such as performance which
justifies pulling the variable out of the loop.</p>
<p>In your example, the program creates and destroys the string each time. Some
libraries use a small string optimization (SSO), so the dynamic allocation
could be avoided in some cases.</p>
<p>Suppose you wanted to avoid those redundant creations/allocations, you would
write it as:</p>
<div class="code"><pre class="code literal-block"><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">counter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">counter</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"> </span><span class="n">counter</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="o">//</span><span class="w"> </span><span class="n">compiler</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">pull</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">out</span>
<span class="w">   </span><span class="k">const</span><span class="w"> </span><span class="nb">char</span><span class="w"> </span><span class="n">testing</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"testing"</span><span class="p">;</span>
<span class="w">   </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">testing</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<p>or you can pull the constant out:</p>
<div class="code"><pre class="code literal-block"><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="p">::</span><span class="n">string</span><span class="w"> </span><span class="n">testing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"testing"</span><span class="p">;</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">counter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">counter</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"> </span><span class="n">counter</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">testing</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<blockquote>
<p>Do most compilers realize that the variable has already been declared and
just skip that portion, or does it actually create a spot for it in memory
each time?</p>
</blockquote>
<p>It can reuse the space the <em>variable</em> consumes, and it can pull invariants out
of your loop. In the case of the const char array (above) - that array could
be pulled out. However, the constructor and destructor must be executed at
each iteration in the case of an object (such as <code>std::string</code>). In the case
of the <code>std::string</code>, that 'space' includes a pointer which contains the
dynamic allocation representing the characters. So this:</p>
<div class="code"><pre class="code literal-block"><span class="k">for</span><span class="w"> </span><span class="ss">(</span><span class="nv">int</span><span class="w"> </span><span class="nv">counter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="c1">; counter &lt;= 10; counter++) {</span>
<span class="w">   </span><span class="nv">string</span><span class="w"> </span><span class="nv">testing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"testing"</span><span class="c1">;</span>
<span class="w">   </span><span class="nv">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="nv">testing</span><span class="c1">;</span>
}
</pre></div>

<p>would require redundant copying in each case, and dynamic allocation and free
if the variable sits above the threshold for SSO character count (and SSO is
implemented by your std library).</p>
<p>Doing this:</p>
<div class="code"><pre class="code literal-block"><span class="nv">string</span><span class="w"> </span><span class="nv">testing</span><span class="c1">;</span>
<span class="k">for</span><span class="w"> </span><span class="ss">(</span><span class="nv">int</span><span class="w"> </span><span class="nv">counter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="c1">; counter &lt;= 10; counter++) {</span>
<span class="w">   </span><span class="nv">testing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"testing"</span><span class="c1">;</span>
<span class="w">   </span><span class="nv">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="nv">testing</span><span class="c1">;</span>
}
</pre></div>

<p>would still require a physical copy of the characters at each iteration, but
the form could result in one dynamic allocation because you assign the string
and the implementation should see there is no need to resize the string's
backing allocation. Of course, you wouldn't do that in this example (because
multiple superior alternatives have already been demonstrated), but you might
consider it when the string or vector's content varies.</p>
<p>So what do you do with all those options (and more)? Keep it very close as a
default -- until you understand the costs well and know when you should
deviate.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/what-s-the-difference-between-deadlock-and-livelock/" class="u-url">What's the difference between deadlock and livelock?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/what-s-the-difference-between-deadlock-and-livelock/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T13:48:25+08:00" itemprop="datePublished" title="2023-03-04 13:48">2023-03-04 13:48</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Can somebody please explain with examples (of code) what is the difference
between <strong>deadlock</strong> and <strong>livelock</strong>?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Taken from http://en.wikipedia.org/wiki/Deadlock:</p>
<blockquote>
<p>In concurrent computing, a <strong>deadlock</strong> is a state in which each member of a
group of actions, is waiting for some other member to release a lock</p>
<p>A <strong>livelock</strong> is similar to a deadlock, except that the states of the
processes involved in the livelock constantly change with regard to one
another, none progressing. Livelock is a special case of resource
starvation; the general definition only states that a specific process is
not progressing.</p>
<p>A real-world example of livelock occurs when two people meet in a narrow
corridor, and each tries to be polite by moving aside to let the other pass,
but they end up swaying from side to side without making any progress
because they both repeatedly move the same way at the same time.</p>
<p>Livelock is a risk with some algorithms that detect and recover from
deadlock. If more than one process takes action, the deadlock detection
algorithm can be repeatedly triggered. This can be avoided by ensuring that
only one process (chosen randomly or by priority) takes action.</p>
</blockquote>
<p><br></p>
<h3>Suggest</h3>
<p><strong>Livelock</strong></p>
<blockquote>
<p>A thread often acts in response to the action of another thread. If the
other thread's action is also a response to the action of another thread,
then livelock may result.</p>
<p>As with deadlock, livelocked threads are <strong>unable to make further
progress</strong>. However, the <strong>threads are not blocked</strong> — they are simply <strong>too
busy responding to each other to resume work</strong>. This is comparable to two
people attempting to pass each other in a corridor: Alphonse moves to his
left to let Gaston pass, while Gaston moves to his right to let Alphonse
pass. Seeing that they are still blocking each other, Alphonse moves to his
right, while Gaston moves to his left. They're still blocking each other,
and so on...</p>
</blockquote>
<p>The main difference between <strong><em>livelock</em></strong> and <strong><em>deadlock</em></strong> is that threads
are not going to be blocked, instead they will try to respond to each other
continuously.</p>
<p>In this image, both circles (threads or processes) will try to give space to
the other by moving left and right. But they can't move any further.</p>
<p><img alt="enter image description here" src="images/OAda8.jpg"></p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-pass-parameters-using-ui-sref-in-ui-router-to-the-controller/" class="u-url">How to pass parameters using ui-sref in ui-router to the controller</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-pass-parameters-using-ui-sref-in-ui-router-to-the-controller/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T13:47:01+08:00" itemprop="datePublished" title="2023-03-04 13:47">2023-03-04 13:47</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I need to pass and receive two parameters to the state I want to transit to
using <code>ui-sref</code> of ui-router.</p>
<p>Something like using the link below for transitioning the state to <code>home</code> with
<code>foo</code> and <code>bar</code> parameters:</p>
<div class="code"><pre class="code literal-block"><span class="nt">&lt;a</span><span class="w"> </span><span class="na">ui-sref=</span><span class="s">"home({foo: 'fooVal', bar: 'barVal'})"</span><span class="nt">&gt;</span>Go<span class="w"> </span>to<span class="w"> </span>home<span class="w"> </span>state<span class="w"> </span>with<span class="w"> </span>foo<span class="w"> </span>and<span class="w"> </span>bar<span class="w"> </span>parameters<span class="w"> </span><span class="nt">&lt;/a&gt;</span>
</pre></div>

<p>Receiving <code>foo</code> and <code>bar</code> values in a controller:</p>
<div class="code"><pre class="code literal-block"><span class="n">app</span><span class="o">.</span><span class="n">controller</span><span class="p">(</span><span class="s1">'SomeController'</span><span class="p">,</span><span class="w"> </span><span class="n">function</span><span class="p">(</span><span class="o">$</span><span class="n">scope</span><span class="p">,</span><span class="w"> </span><span class="o">$</span><span class="n">stateParam</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="o">//..</span>
<span class="w">  </span><span class="k">var</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">$</span><span class="n">stateParam</span><span class="o">.</span><span class="n">foo</span><span class="p">;</span><span class="w"> </span><span class="o">//</span><span class="n">getting</span><span class="w"> </span><span class="n">fooVal</span>
<span class="w">  </span><span class="k">var</span><span class="w"> </span><span class="n">bar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">$</span><span class="n">stateParam</span><span class="o">.</span><span class="n">bar</span><span class="p">;</span><span class="w"> </span><span class="o">//</span><span class="n">getting</span><span class="w"> </span><span class="n">barVal</span>
<span class="w">  </span><span class="o">//..</span>
<span class="p">});</span>
</pre></div>

<p>I get <code>undefined</code> for <code>$stateParam</code> in the controller.</p>
<p>Could somebody help me understand how to get it done?</p>
<p><strong>Edit:</strong></p>
<div class="code"><pre class="code literal-block"><span class="na">.state</span><span class="p">(</span><span class="err">'</span><span class="no">home</span><span class="err">'</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nl">url:</span><span class="w"> </span><span class="err">'/',</span>
<span class="w">  </span><span class="nl">views:</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="err">'':</span><span class="w"> </span><span class="err">{</span>
<span class="w">      </span><span class="nl">templateUrl:</span><span class="w"> </span><span class="err">'</span><span class="nf">home.html</span><span class="err">'</span><span class="p">,</span>
<span class="w">      </span><span class="nl">controller:</span><span class="w"> </span><span class="err">'</span><span class="nf">MainRootCtrl</span><span class="err">'</span>

<span class="w">    </span><span class="err">},</span>

<span class="w">    </span><span class="err">'</span><span class="nf">A@home</span><span class="err">'</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nl">templateUrl:</span><span class="w"> </span><span class="err">'</span><span class="nf">a.html</span><span class="err">'</span><span class="p">,</span>
<span class="w">      </span><span class="nl">controller:</span><span class="w"> </span><span class="err">'</span><span class="nf">MainCtrl</span><span class="err">'</span>
<span class="w">    </span><span class="err">},</span>

<span class="w">    </span><span class="err">'</span><span class="nf">B@home</span><span class="err">'</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nl">templateUrl:</span><span class="w"> </span><span class="err">'</span><span class="nf">b.html</span><span class="err">'</span><span class="p">,</span>
<span class="w">      </span><span class="nl">controller:</span><span class="w"> </span><span class="err">'</span><span class="nf">SomeController</span><span class="err">'</span>
<span class="w">    </span><span class="err">}</span>
<span class="w">  </span><span class="err">}</span>

<span class="err">})</span><span class="c1">;</span>
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<p>I've created an example to show how to. Updated <code>state</code> definition would be:</p>
<div class="code"><pre class="code literal-block">  $stateProvider
    .state('home', {
      url: '/:foo?bar',
      views: {
        '': {
          templateUrl: 'tpl.home.html',
          controller: 'MainRootCtrl'

        },
        ...
      }
</pre></div>

<p>And this would be the controller:</p>
<div class="code"><pre class="code literal-block"><span class="o">.</span><span class="n">controller</span><span class="p">(</span><span class="s1">'MainRootCtrl'</span><span class="p">,</span><span class="w"> </span><span class="n">function</span><span class="p">(</span><span class="o">$</span><span class="n">scope</span><span class="p">,</span><span class="w"> </span><span class="o">$</span><span class="n">state</span><span class="p">,</span><span class="w"> </span><span class="o">$</span><span class="n">stateParams</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="o">//..</span>
<span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">$</span><span class="n">stateParams</span><span class="o">.</span><span class="n">foo</span><span class="p">;</span><span class="w"> </span><span class="o">//</span><span class="n">getting</span><span class="w"> </span><span class="n">fooVal</span>
<span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">bar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">$</span><span class="n">stateParams</span><span class="o">.</span><span class="n">bar</span><span class="p">;</span><span class="w"> </span><span class="o">//</span><span class="n">getting</span><span class="w"> </span><span class="n">barVal</span>
<span class="w">    </span><span class="o">//..</span>
<span class="w">    </span><span class="o">$</span><span class="n">scope</span><span class="o">.</span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">$</span><span class="n">state</span><span class="o">.</span><span class="n">current</span>
<span class="w">    </span><span class="o">$</span><span class="n">scope</span><span class="o">.</span><span class="n">params</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">$</span><span class="n">stateParams</span><span class="p">;</span><span class="w"> </span>
<span class="p">})</span>
</pre></div>

<p>What we can see is that the state home now has url defined as:</p>
<div class="code"><pre class="code literal-block">url: '/:foo?bar',
</pre></div>

<p>which means, that the params in url are expected as</p>
<div class="code"><pre class="code literal-block">/fooVal?bar=barValue
</pre></div>

<p>These two links will correctly pass arguments into the controller:</p>
<div class="code"><pre class="code literal-block">&lt;a ui-sref="home({foo: 'fooVal1', bar: 'barVal1'})"&gt;
&lt;a ui-sref="home({foo: 'fooVal2', bar: 'barVal2'})"&gt;
</pre></div>

<p>Also, the controller does consume <code>$stateParams</code> instead of <code>$stateParam</code>.</p>
<p>Link to doc:</p>
<ul>
<li>URL Parameters</li>
</ul>
<p>You can check it here</p>
<h4><code>params : {}</code></h4>
<p>There is also <em>new</em> , more granular setting <em><code>params : {}</code></em>. As we've already
seen, we can declare parameters as part of <strong><code>url</code></strong>. But with <code>params : {}</code>
configuration - we can extend this definition or even introduce paramters
which are not part of the url:</p>
<div class="code"><pre class="code literal-block"><span class="na">.state</span><span class="p">(</span><span class="err">'</span><span class="no">other</span><span class="err">'</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nl">url:</span><span class="w"> </span><span class="err">'/</span><span class="nf">other</span><span class="err">/</span><span class="p">:</span><span class="no">foo</span><span class="err">?</span><span class="no">bar</span><span class="err">'</span><span class="p">,</span>
<span class="w">    </span><span class="nl">params:</span><span class="w"> </span><span class="err">{</span><span class="w"> </span>
<span class="w">        </span><span class="c1">// here we define default value for foo</span>
<span class="w">        </span><span class="c1">// we also set squash to false, to force injecting</span>
<span class="w">        </span><span class="c1">// even the default value into url</span>
<span class="w">        </span><span class="nl">foo:</span><span class="w"> </span><span class="err">{</span>
<span class="w">          </span><span class="nl">value:</span><span class="w"> </span><span class="err">'</span><span class="nf">defaultValue</span><span class="err">'</span><span class="p">,</span>
<span class="w">          </span><span class="nl">squash:</span><span class="w"> </span><span class="nf">false</span><span class="p">,</span>
<span class="w">        </span><span class="err">},</span>
<span class="w">        </span><span class="c1">// this parameter is now array</span>
<span class="w">        </span><span class="c1">// we can pass more items, and expect them as []</span>
<span class="w">        </span><span class="nf">bar</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="w">          </span><span class="no">array</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="no">true</span><span class="p">,</span>
<span class="w">        </span><span class="err">},</span>
<span class="w">        </span><span class="c1">// this param is not part of url</span>
<span class="w">        </span><span class="c1">// it could be passed with $state.go or ui-sref </span>
<span class="w">        </span><span class="nl">hiddenParam:</span><span class="w"> </span><span class="err">'</span><span class="nf">YES</span><span class="err">'</span><span class="p">,</span>
<span class="w">      </span><span class="err">},</span>
<span class="w">    </span><span class="na">...</span>
</pre></div>

<p>Settings available for params are described in the documentation of the
$stateProvider</p>
<p>Below is just an extract</p>
<ul>
<li>
<strong>value - {object|function=}</strong> : specifies the default value for this parameter. This implicitly sets this parameter as optional...</li>
<li>
<strong>array - {boolean=}:</strong> (default: false) If true, the param value will be treated as an array of values. </li>
<li>
<strong>squash - {bool|string=}:</strong> squash configures how a default parameter value is represented in the URL when the current parameter value is the same as the default value.</li>
</ul>
<p>We can call these params this way:</p>
<div class="code"><pre class="code literal-block"><span class="c1">// hidden param cannot be passed via url</span>
<span class="o">&lt;</span><span class="n">a</span><span class="w"> </span><span class="n">href</span><span class="p">=</span><span class="s">"#/other/fooVal?bar=1&amp;amp;bar=2"</span><span class="o">&gt;</span>
<span class="c1">// default foo is skipped</span>
<span class="o">&lt;</span><span class="n">a</span><span class="w"> </span><span class="n">ui</span><span class="o">-</span><span class="n">sref</span><span class="p">=</span><span class="s">"other({bar: [4,5]})"</span><span class="o">&gt;</span>
</pre></div>

<p>Check it in action here</p>
<p><br></p>
<h3>Suggest</h3>
<p>You don't necessarily need to have the parameters inside the URL.</p>
<p>For instance, with:</p>
<div class="code"><pre class="code literal-block"><span class="nf">$stateProvider</span>
<span class="na">.state</span><span class="p">(</span><span class="err">'</span><span class="no">home</span><span class="err">'</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nl">url:</span><span class="w"> </span><span class="err">'/',</span>
<span class="w">  </span><span class="nl">views:</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="err">'':</span><span class="w"> </span><span class="err">{</span>
<span class="w">      </span><span class="nl">templateUrl:</span><span class="w"> </span><span class="err">'</span><span class="nf">home.html</span><span class="err">'</span><span class="p">,</span>
<span class="w">      </span><span class="nl">controller:</span><span class="w"> </span><span class="err">'</span><span class="nf">MainRootCtrl</span><span class="err">'</span>

<span class="w">    </span><span class="err">},</span>
<span class="w">  </span><span class="err">},</span>
<span class="w">  </span><span class="nl">params:</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="nl">foo:</span><span class="w"> </span><span class="nf">null</span><span class="p">,</span>
<span class="w">    </span><span class="nl">bar:</span><span class="w"> </span><span class="nf">null</span>
<span class="w">  </span><span class="err">}</span>
<span class="err">})</span>
</pre></div>

<p>You will be able to send parameters to the state, using either:</p>
<div class="code"><pre class="code literal-block">$state.go('home',<span class="w"> </span>{foo:<span class="w"> </span>true,<span class="w"> </span>bar:<span class="w"> </span>1});
//<span class="w"> </span>or
<span class="nt">&lt;a</span><span class="w"> </span><span class="na">ui-sref=</span><span class="s">"home({foo: true, bar: 1})"</span><span class="nt">&gt;</span>Go!<span class="nt">&lt;/a&gt;</span>
</pre></div>

<p>Of course, if you reload the page once on the <code>home</code> state, you will loose the
state parameters, as they are not stored anywhere.</p>
<p>A full description of this behavior is documented here, under the <code>params</code> row
in the <code>state(name, stateConfig)</code> section.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-2408.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-2406.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
