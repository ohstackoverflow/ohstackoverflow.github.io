<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 1345) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-1345.html">
<link rel="prev" href="index-1346.html" type="text/html">
<link rel="next" href="index-1344.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/what-is-the-purpose-of-looper-and-how-to-use-it/" class="u-url">What is the purpose of Looper and how to use it?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/what-is-the-purpose-of-looper-and-how-to-use-it/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T07:10:53+08:00" itemprop="datePublished" title="2023-02-18 07:10">2023-02-18 07:10</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I am new to Android. I want to know what the <code>Looper</code> class does and also how
to use it. I have read the Android Looper class documentation but I am unable
to completely understand it. I have seen it in a lot of places but unable to
understand its purpose. Can anyone help me by defining the purpose of <code>Looper</code>
and also by giving a simple example if possible?</p>
<p><br><br></p>
<h2>Answer</h2>
<p><strong>What is Looper?</strong></p>
<p>Looper is a class which is used to execute the Messages(Runnables) in a queue.
Normal threads have no such queue, e.g. simple thread does not have any queue.
It executes once and after method execution finishes, the thread will not run
another Message(Runnable).</p>
<p><strong>Where we can use Looper class?</strong></p>
<p>If someone wants to execute multiple messages(Runnables) then he should use
the Looper class which is responsible for creating a queue in the thread. For
example, while writing an application that downloads files from the internet,
we can use Looper class to put files to be downloaded in the queue.</p>
<p><strong>How it works?</strong></p>
<p>There is <code>prepare()</code> method to prepare the Looper. Then you can use <code>loop()</code>
method to create a message loop in the current thread and now your Looper is
ready to execute the requests in the queue until you quit the loop.</p>
<p>Here is the code by which you can prepare the Looper.</p>
<div class="code"><pre class="code literal-block"><span class="k">class</span><span class="w"> </span><span class="n">LooperThread</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="n">Thread</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">public</span><span class="w"> </span><span class="n">Handler</span><span class="w"> </span><span class="n">mHandler</span><span class="p">;</span>

<span class="w">      </span><span class="err">@</span><span class="n">Override</span>
<span class="w">      </span><span class="n">public</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="w"> </span><span class="n">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="n">Looper</span><span class="o">.</span><span class="n">prepare</span><span class="p">();</span>

<span class="w">          </span><span class="n">mHandler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">Handler</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="err">@</span><span class="n">Override</span>
<span class="w">              </span><span class="n">public</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="w"> </span><span class="n">handleMessage</span><span class="p">(</span><span class="n">Message</span><span class="w"> </span><span class="n">msg</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                  </span><span class="o">//</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">incoming</span><span class="w"> </span><span class="n">messages</span><span class="w"> </span><span class="n">here</span>
<span class="w">              </span><span class="p">}</span>
<span class="w">          </span><span class="p">};</span>

<span class="w">          </span><span class="n">Looper</span><span class="o">.</span><span class="n">loop</span><span class="p">();</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>You can better understand what Looper is in the context of the GUI framework.
Looper is made to do 2 things.</p>
<ol>
<li>
<p>Looper transforms a normal thread into something run continuously until Android app is running.</p>
</li>
<li>
<p>Looper provides a queue where jobs to be done are enqueued.</p>
</li>
</ol>
<p>As you may know, when an application is launched, the system creates a thread
of execution for the application, called “main”, and Android applications
normally run entirely on a single thread by default the “main thread”. But
<strong>main thread is not a secret, special thread</strong>. It's just a normal thread
similar to one you can create with <code>new Thread()</code>, which means it terminates
when its <code>run()</code> method returns! Think of below example.</p>
<div class="code"><pre class="code literal-block">public class HelloRunnable implements Runnable {
    public void run() {
        System.out.println("Hello from a thread!");
    }

    public static void main(String args[]) {
        (new Thread(new HelloRunnable())).start();
    }
}
</pre></div>

<p>Now, let's apply this simple principle to Android apps. What would happen if
an Android app runs on a normal thread? A thread called "main" or "UI" or
whatever starts your application and draws all UI. So the first screen is
displayed to users. What now? The main thread terminates? No, it shouldn’t. It
should wait until users do something, right? But how can we achieve this
behavior? Well, we can try with <code>Object.wait()</code> or <code>Thread.sleep()</code>. For
example, main thread finishes its initial job to display first screen, and
sleeps. It awakes, which means interrupted, when a new job to do is fetched.
So far so good, but at this moment we need a queue-like data structure to hold
multiple jobs. Think about a case when a user touches screen serially, and a
task takes longer time to finish. So, we need to have a data structure to hold
jobs to be done in first-in-first-out manner. Also, you may imagine,
implementing ever-running-and-process-job-when-arrived thread using interrupt
is not easy, and leads to complex and often unmaintainable code. We'd rather
create a new mechanism for such purpose, and <em><strong>that is what Looper is all
about</strong></em>. The official document of Looper class says, "Threads by default do
not have a message loop associated with them", and Looper is a class "used to
run a message loop for a thread". Now you can understand what it means.</p>
<p>To make things more clear, let's check the code where the main thread is
transformed. It all happens in ActivityThread class. In its main() method, you
can find below code, which turns a normal thread into something that we need.</p>
<div class="code"><pre class="code literal-block"><span class="nv">public</span><span class="w"> </span><span class="nv">final</span><span class="w"> </span><span class="nv">class</span><span class="w"> </span><span class="nv">ActivityThread</span><span class="w"> </span>{
<span class="w">    </span>...
<span class="w">    </span><span class="nv">public</span><span class="w"> </span><span class="nv">static</span><span class="w"> </span><span class="nv">void</span><span class="w"> </span><span class="nv">main</span><span class="ss">(</span><span class="nv">String</span>[]<span class="w"> </span><span class="nv">args</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">        </span>...
<span class="w">        </span><span class="nv">Looper</span>.<span class="nv">prepareMainLooper</span><span class="ss">()</span><span class="c1">;</span>
<span class="w">        </span><span class="nv">Looper</span>.<span class="k">loop</span><span class="ss">()</span><span class="c1">;</span>
<span class="w">        </span>...
<span class="w">    </span>}
}
</pre></div>

<p>and <code>Looper.loop()</code> method loop infinitely and dequeue a message and process
one at a time:</p>
<div class="code"><pre class="code literal-block"><span class="nv">public</span><span class="w"> </span><span class="nv">static</span><span class="w"> </span><span class="nv">void</span><span class="w"> </span><span class="k">loop</span><span class="ss">()</span><span class="w"> </span>{
<span class="w">    </span>...
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="ss">(</span><span class="c1">;;) {</span>
<span class="w">        </span><span class="nv">Message</span><span class="w"> </span><span class="nv">msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">queue</span>.<span class="k">next</span><span class="ss">()</span><span class="c1">; // might block</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">msg</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nv">null</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">            </span><span class="o">//</span><span class="w"> </span><span class="nv">No</span><span class="w"> </span><span class="nv">message</span><span class="w"> </span><span class="nv">indicates</span><span class="w"> </span><span class="nv">that</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">message</span><span class="w"> </span><span class="nv">queue</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">quitting</span>.
<span class="w">            </span><span class="k">return</span><span class="c1">;</span>
<span class="w">        </span>}
<span class="w">        </span>...
<span class="w">        </span><span class="nv">msg</span>.<span class="nv">target</span>.<span class="nv">dispatchMessage</span><span class="ss">(</span><span class="nv">msg</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">        </span>...
<span class="w">    </span>}
}
</pre></div>

<p>So, basically, Looper is a class that is made to address a problem that occurs
in the GUI framework. But this kind of need can also happen in other
situations as well. Actually, it is a pretty famous pattern for multi-thread
applications, and you can learn more about it in " <em>Concurrent Programming in
Java</em> " by Doug Lea(Especially, chapter 4.1.4 "Worker Threads" would be
helpful). Also, you can imagine this kind of mechanism is not unique in
Android framework, but all GUI framework may need somewhat similar. You can
find almost same mechanism in Java Swing framework too.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/maven-modules-building-a-single-specific-module/" class="u-url">Maven Modules + Building a Single Specific Module</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/maven-modules-building-a-single-specific-module/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T07:10:24+08:00" itemprop="datePublished" title="2023-02-18 07:10">2023-02-18 07:10</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I have a multi-module Maven project with a parent project <code>P</code> and three sub-
modules <code>A</code>, <code>B</code>, and <code>C</code>. Both <code>B</code> and <code>C</code> are war projects and both depend
on <code>A</code>.</p>
<p>I can type <code>mvn compile</code> in <code>P</code> and have all of the sub-modules properly
compiled. The problem comes when I want to do operations for specific modules.</p>
<p>I'd like to be able to package a war for project <code>B</code>, but when I run the
package command from <code>B</code>'s directory, it complains that it can't find the
dependencies for <code>A</code>.</p>
<p>I understand from this question: Maven and dependent modules that perhaps
Maven isn't really designed for this type of dependency resolution, but that
begs the question of how do I package <code>B</code>?</p>
<ol>
<li>
<p>Do I have to run <code>mvn package</code> for the entire project hierarchy when I really just want <code>B</code>? </p>
</li>
<li>
<p>Do I have to install snapshots of A into my local repository every time I want to package <code>B</code>? </p>
</li>
</ol>
<p>This second scenario isn't much fun when <code>A</code> is still under active
development.</p>
<p>Any best practices here?</p>
<p><br><br></p>
<h2>Answer</h2>
<blockquote>
<p>Any best practices here?</p>
</blockquote>
<p>Use the Maven advanced reactor options, more specifically:</p>
<div class="code"><pre class="code literal-block"><span class="o">-</span><span class="nv">pl</span>,<span class="w"> </span><span class="o">--</span><span class="nv">projects</span>
<span class="w">        </span><span class="nv">Build</span><span class="w"> </span><span class="nv">specified</span><span class="w"> </span><span class="nv">reactor</span><span class="w"> </span><span class="nv">projects</span><span class="w"> </span><span class="nv">instead</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">all</span><span class="w"> </span><span class="nv">projects</span>
<span class="o">-</span><span class="nv">am</span>,<span class="w"> </span><span class="o">--</span><span class="nv">also</span><span class="o">-</span><span class="nv">make</span>
<span class="w">        </span><span class="k">If</span><span class="w"> </span><span class="nv">project</span><span class="w"> </span><span class="nv">list</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">specified</span>,<span class="w"> </span><span class="nv">also</span><span class="w"> </span><span class="nv">build</span><span class="w"> </span><span class="nv">projects</span><span class="w"> </span><span class="nv">required</span><span class="w"> </span><span class="nv">by</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">list</span>
</pre></div>

<p>So just <code>cd</code> into the parent P directory and run:</p>
<div class="code"><pre class="code literal-block">mvn install -pl B -am
</pre></div>

<p>And this will build B and the modules required by B.</p>
<p>Note that you need to use a colon if you are referencing an <code>artifactId</code> which
differs from the directory name:</p>
<div class="code"><pre class="code literal-block">mvn install -pl :B -am
</pre></div>

<p>As described here:</p>
<ul>
<li>Define modules list which shall be build in Maven multiproject build</li>
</ul>
<p><br></p>
<h3>Suggest</h3>
<p>Say Parent pom.xml contains 6 modules and you want to run <strong>A</strong> , <strong>B</strong> and
<strong>F</strong>.</p>
<div class="code"><pre class="code literal-block"><span class="nt">&lt;modules&gt;</span>
<span class="w">        </span><span class="nt">&lt;module&gt;</span>A<span class="nt">&lt;/module&gt;</span>
<span class="w">        </span><span class="nt">&lt;module&gt;</span>B<span class="nt">&lt;/module&gt;</span>
<span class="w">        </span><span class="nt">&lt;module&gt;</span>C<span class="nt">&lt;/module&gt;</span>
<span class="w">        </span><span class="nt">&lt;module&gt;</span>D<span class="nt">&lt;/module&gt;</span>
<span class="w">        </span><span class="nt">&lt;module&gt;</span>E<span class="nt">&lt;/module&gt;</span>
<span class="w">        </span><span class="nt">&lt;module&gt;</span>F<span class="nt">&lt;/module&gt;</span>
<span class="w">  </span><span class="nt">&lt;/modules&gt;</span>
</pre></div>

<p>1- cd into parent project</p>
<div class="code"><pre class="code literal-block"> mvn --projects A,B,F --also-make clean install
</pre></div>

<p>OR</p>
<div class="code"><pre class="code literal-block">mvn -pl A,B,F -am clean install
</pre></div>

<p>OR</p>
<div class="code"><pre class="code literal-block">mvn -pl A,B,F -amd clean install
</pre></div>

<p><strong>Note:</strong> When you specify a project with the <strong>-am</strong> option, Maven will build
all of the projects that the specified project depends upon (either directly
or indirectly). Maven will examine the list of projects and walk down the
dependency tree, finding all of the projects that it needs to build.</p>
<p>While the <strong>-am</strong> command makes all of the projects required by a particular
project in a multi-module build, the <strong>-amd</strong> or <strong>--also-make-dependents</strong>
option configures Maven to build a project and any project that depends on
that project. When using <strong>--also-make-dependents</strong> , Maven will examine all
of the projects in our reactor to find projects that depend on a particular
project. It will automatically build those projects and nothing else.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/docker-container-will-automatically-stop-after-docker-run-d/" class="u-url">Docker container will automatically stop after "docker run -d"</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/docker-container-will-automatically-stop-after-docker-run-d/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T07:09:57+08:00" itemprop="datePublished" title="2023-02-18 07:09">2023-02-18 07:09</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>According to tutorial I read so far, use "<code>docker run -d</code>" will start a
container from image, and the container will run in background. This is how it
looks like, we can see we already have container id.</p>
<div class="code"><pre class="code literal-block"><span class="n">root</span><span class="nv">@docker</span><span class="err">:</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">root</span><span class="err">#</span><span class="w"> </span><span class="n">docker</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="n">centos</span>
<span class="mf">605e3928</span><span class="n">cdddb844526bab691af51d0c9262e0a1fc3d41de3f59be1a58e1bd1d</span>
</pre></div>

<p>But if I ran " <strong><code>docker ps</code></strong> ", nothing was returned.</p>
<p>So I tried " <strong><code>docker ps -a</code></strong> ", I can see container already exited:</p>
<div class="code"><pre class="code literal-block"><span class="n">root</span><span class="nv">@docker</span><span class="err">:</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">root</span><span class="err">#</span><span class="w"> </span><span class="n">docker</span><span class="w"> </span><span class="n">ps</span><span class="w"> </span><span class="o">-</span><span class="n">a</span>
<span class="n">CONTAINER</span><span class="w"> </span><span class="n">ID</span><span class="w">        </span><span class="nc">IMAGE</span><span class="w">                 </span><span class="n">COMMAND</span><span class="w">             </span><span class="n">CREATED</span><span class="w">             </span><span class="n">STATUS</span><span class="w">                         </span><span class="n">PORTS</span><span class="w">               </span><span class="k">NAMES</span>
<span class="mf">605e3928</span><span class="n">cddd</span><span class="w">        </span><span class="nl">centos</span><span class="p">:</span><span class="n">latest</span><span class="w">         </span><span class="ss">"/bin/bash"</span><span class="w">         </span><span class="mi">31</span><span class="w"> </span><span class="n">minutes</span><span class="w"> </span><span class="n">ago</span><span class="w">      </span><span class="n">Exited</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="mi">31</span><span class="w"> </span><span class="n">minutes</span><span class="w"> </span><span class="n">ago</span><span class="w">                          </span><span class="n">kickass_swartz</span>
</pre></div>

<p>Anything I did wrong? How can I troubleshoot this issue?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>The centos dockerfile has a default command <code>bash</code>.</p>
<p>That means, when run in background (<code>-d</code>), the shell exits immediately.</p>
<p><strong>Update 2017</strong></p>
<p>More recent versions of docker authorize to run a container both in detached
mode <em>and</em> in foreground mode (<code>-t</code>, <code>-i</code> or <code>-it</code>)</p>
<p>In that case, you don't need any additional command and this is enough:</p>
<div class="code"><pre class="code literal-block">docker run -t -d centos
</pre></div>

<p>The bash will wait in the background.<br>
That was initially reported in kalyani-chaudhari's answer and detailed in
jersey bean's answer.</p>
<div class="code"><pre class="code literal-block"><span class="n">vonc</span><span class="nv">@voncvb</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="n">ps</span><span class="w"> </span><span class="o">-</span><span class="n">a</span>
<span class="n">CONTAINER</span><span class="w"> </span><span class="n">ID</span><span class="w">        </span><span class="nc">IMAGE</span><span class="w">               </span><span class="n">COMMAND</span><span class="w">             </span><span class="n">CREATED</span><span class="w">             </span><span class="n">STATUS</span><span class="w">              </span><span class="n">PORTS</span><span class="w">               </span><span class="k">NAMES</span>
<span class="mi">4</span><span class="n">a50fd9e9189</span><span class="w">        </span><span class="n">centos</span><span class="w">              </span><span class="ss">"/bin/bash"</span><span class="w">         </span><span class="mi">8</span><span class="w"> </span><span class="n">seconds</span><span class="w"> </span><span class="n">ago</span><span class="w">       </span><span class="n">Up</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">seconds</span><span class="w">                            </span><span class="n">wonderful_wright</span>
</pre></div>

<p>Note that for <strong>alpine</strong> , Marinos An reports in the comments:</p>
<blockquote>
<p><code>docker run -t -d alpine/git</code> does not keep the process up.<br>
 Had to do: <code>docker run --entrypoint "/bin/sh" -it alpine/git</code></p>
</blockquote>
<hr>
<p>Original answer (2015)</p>
<p>As mentioned in this article:</p>
<blockquote>
<p>Instead of running with <code>docker run -i -t image your-command</code>, using <code>-d</code> is
recommended because you can run your container with just one command and you
don’t need to detach terminal of container by hitting <code>Ctrl</code> + <code>P</code> + <code>Q</code>.</p>
<p>However, there is a problem with <code>-d</code> option. <strong>Your container immediately
stops unless the commands keep running in foreground</strong>.<br>
 Docker requires your command to keep running in the foreground. Otherwise,
it thinks that your applications stops and shutdown the container.</p>
<p>The problem is that some application does not run in the foreground. How can
we make it easier?</p>
<p>In this situation, you can add <code>tail -f /dev/null</code> to your command.<br>
 By doing this, even if your main command runs in the background, your
container doesn’t stop because tail is keep running in the foreground.</p>
</blockquote>
<p>So this would work:</p>
<div class="code"><pre class="code literal-block">docker run -d centos tail -f /dev/null
</pre></div>

<p>Or in Dockerfile:</p>
<div class="code"><pre class="code literal-block">ENTRYPOINT ["tail"]
CMD ["-f","/dev/null"]
</pre></div>

<p>A <code>docker ps</code> would show the centos container still running.</p>
<p>From there, you can attach to it or detach from it (or <code>docker exec</code> some
commands).</p>
<p><br></p>
<h3>Suggest</h3>
<p>According to this answer, adding the <code>-t</code> flag will prevent the container from
exiting when running in the background. You can then use <code>docker exec -i -t
&lt;image&gt; /bin/bash</code> to get into a shell prompt.</p>
<div class="code"><pre class="code literal-block">docker run -t -d &lt;image&gt; &lt;command&gt;
</pre></div>

<p>It seems that the -t option isn't documented very well, though the help says
that it "allocates a pseudo-TTY."</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-1346.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-1344.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
