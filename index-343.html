<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 343) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-343.html">
<link rel="prev" href="index-344.html" type="text/html">
<link rel="next" href="index-342.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/zai-bash-zhong-shi-yong-dan-ge-ming-ling-wei-shell-bian-liang-fen-pei-mo-ren-zhi/" class="u-url">在 bash 中使用单个命令为 shell 变量分配默认值</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/zai-bash-zhong-shi-yong-dan-ge-ming-ling-wei-shell-bian-liang-fen-pei-mo-ren-zhi/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T04:31:53+08:00" itemprop="datePublished" title="2023-02-17 04:31">2023-02-17 04:31</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>我在 bash (3.00) shell 脚本中对变量进行了一大堆测试，如果未设置变量，则会分配默认值，例如：</p>
<div class="code"><pre class="code literal-block">if<span class="w"> </span>[<span class="w"> </span>-z<span class="w"> </span>"<span class="cp">${</span><span class="n">VARIABLE</span><span class="cp">}</span>"<span class="w"> </span>];<span class="w"> </span>then<span class="w"> </span>
<span class="w">    </span>FOO='default'
else<span class="w"> </span>
<span class="w">    </span>FOO=<span class="cp">${</span><span class="n">VARIABLE</span><span class="cp">}</span>
fi
</pre></div>

<p>我似乎记得有一些语法可以在一行中执行此操作，类似于三元运算符，例如：</p>
<div class="code"><pre class="code literal-block">FOO=<span class="cp">${</span> <span class="err">$</span><span class="p">{</span><span class="n">VARIABLE</span><span class="cp">}</span><span class="w"> </span>:<span class="w"> </span>'default'<span class="w"> </span>}
</pre></div>

<p>（虽然我知道那是行不通的......）</p>
<p>我是疯了，还是存在类似的东西？</p>
<p><br><br></p>
<h2>解答</h2>
<p>实际上，非常接近您发布的内容。您可以使用称为Bash 参数扩展的东西来完成此操作。</p>
<p>要获取分配的值，或者<code>default</code>如果它丢失：</p>
<div class="code"><pre class="code literal-block"><span class="nv">FOO</span><span class="s s-Atom">=</span><span class="s2">"${VARIABLE:-default}"</span>  <span class="s s-Atom">#</span> <span class="nv">If</span> <span class="s s-Atom">variable</span> <span class="o">not</span> <span class="s s-Atom">set</span> <span class="s s-Atom">or</span> <span class="s s-Atom">null</span><span class="p">,</span> <span class="s s-Atom">use</span> <span class="s s-Atom">default</span><span class="p">.</span>
<span class="s s-Atom">#</span> <span class="nv">If</span> <span class="nv">VARIABLE</span> <span class="s s-Atom">was</span> <span class="s s-Atom">unset</span> <span class="s s-Atom">or</span> <span class="s s-Atom">null</span><span class="p">,</span> <span class="s s-Atom">it</span> <span class="s s-Atom">still</span> <span class="o">is</span> <span class="s s-Atom">after</span> <span class="nf">this</span> <span class="p">(</span><span class="s s-Atom">no</span> <span class="s s-Atom">assignment</span> <span class="s s-Atom">done</span><span class="p">).</span>
</pre></div>

<p>或者同时分配<code>default</code>给：<code>VARIABLE</code></p>
<div class="code"><pre class="code literal-block"><span class="n">FOO</span><span class="o">=</span><span class="s2">"${VARIABLE:=default}"</span><span class="w">  </span><span class="c1"># If variable not set or null, set it to default.</span>
</pre></div>

<p><br></p>
<h3>更多建议</h3>
<p>对于命令行参数：</p>
<div class="code"><pre class="code literal-block"><span class="nv">VARIABLE</span><span class="s s-Atom">=</span><span class="s2">"${1:-$DEFAULTVALUE}"</span>
</pre></div>

<p>它分配给传递给脚本的第一个参数的值或者如果没有传递这样的参数<code>VARIABLE</code>的值。<code>DEFAULTVALUE</code>引用可防止通配符和分词。</p>
<p><br><br><a href="posts/assigning-default-values-to-shell-variables-with-a-single-command-in-bash/">查看原文</a></p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/fen-zhi-biao-qian-he-zhu-gan-zai-subversion-cun-chu-ku-zhong-shi-shi-yao-yi-si/" class="u-url">“分支”、“标签”和“主干”在 Subversion 存储库中是什么意思？</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/fen-zhi-biao-qian-he-zhu-gan-zai-subversion-cun-chu-ku-zhong-shi-shi-yao-yi-si/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T04:31:27+08:00" itemprop="datePublished" title="2023-02-17 04:31">2023-02-17 04:31</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>我在 Subversion（我猜是通用存储库）讨论中经常看到这些词。在过去的几年里，<br>
我一直在为我的项目使用 <strong>SVN ，但我从未掌握这些目录的完整概念。</strong></p>
<p>他们的意思是什么？</p>
<p><br><br></p>
<h2>解答</h2>
<p>嗯，不确定我是否同意 Nick re tag 类似于分支。标签只是一个标记</p>
<ul>
<li>
<p><strong>主干</strong> 将是开发的主体，从项目开始一直到现在。</p>
</li>
<li>
<p><strong>分支</strong> 将是从主干中的某个点派生的代码副本，用于对代码进行重大更改，同时保持主干中代码的完整性。如果主要更改按计划进行，它们通常会合并回主干。</p>
</li>
<li>
<p><strong>标签</strong> 将是您希望保留的主干或分支上的时间点。保留的两个主要原因是这是软件的主要版本，无论是 alpha、beta、RC 还是 RTM，或者这是在主干上应用重大修订之前软件的最稳定点。</p>
</li>
</ul>
<p>在开源项目中，未被项目利益相关者接受到主干中的主要分支可以成为分叉的基础 <em>——</em> 例如，与其他源代码共享一个共同来源的完全独立的项目。</p>
<p>分支和标记子树与主干的区别如下：</p>
<p>Subversion 允许系统管理员创建 <em>挂钩脚本</em> ，这些脚本在特定事件发生时被触发执行；例如，提交对存储库的更改。典型的 Subversion
存储库实现在创建后将任何包含“/tag/”的路径视为写保护是很常见的；最终结果是标签一旦创建就不可更改（至少对于“普通”用户而言）。
<strong>这是通过钩子脚本完成的，如果标记</strong> 是已更改对象的父节点，则钩子脚本通过防止进一步更改来强制执行不变性。</p>
<p>Subversion 从 1.5 版开始还添加了与“分支合并跟踪”相关的功能，因此提交到分支的更改 <strong>可以</strong> 合并回主干，并支持增量“智能”合并。</p>
<p><br></p>
<h3>更多建议</h3>
<p>首先，正如@AndrewFinnell 和@KenLiu 指出的那样，在 SVN
中，目录名称本身没有任何意义——“主干、分支和标签”只是大多数存储库使用的通用约定。并非所有项目都使用所有目录（根本不使用“标签”是很常见的），事实上，没有什么可以阻止您随意调用它们，尽管打破惯例通常会造成混淆。</p>
<p>我将描述分支和标签最常见的使用场景，并给出一个示例场景来说明它们是如何使用的。</p>
<ul>
<li>
<p><strong>Trunk</strong> : 主要开发区域。这是代码的下一个主要版本所在的位置，并且通常具有所有最新功能。</p>
</li>
<li>
<p><strong>分支</strong> ：每次发布主要版本时，都会创建一个分支。这使您可以修复错误并发布新版本，而不必发布最新的（可能未完成或未测试的）功能。</p>
</li>
<li>
<p><strong>标签</strong> ：每次发布一个版本（最终版本、候选发布版 (RC) 和测试版）时，您都会为它创建一个标签。这为您提供了代码在该状态下的时间点副本，允许您返回并在必要时重现过去版本中的任何错误，或者完全按原样重新发布过去的版本。SVN 中的分支和标签是轻量级的——在服务器上，它不会制作文件的完整副本，只是一个标记“这些文件是在这个修订版复制的”，只占用几个字节。考虑到这一点，您永远不必担心为任何已发布的代码创建标签。正如我之前所说，标签通常会被省略，取而代之的是，变更日志或其他文档会在发布时阐明修订号。</p>
</li>
</ul>
<hr>
<p>例如，假设您开始了一个新项目。您开始在“主干”中工作，研究最终将作为 1.0 版发布的内容。</p>
<ul>
<li><strong>trunk/ - 开发版本，即将成为 1.0</strong></li>
<li>分支/ - 空</li>
</ul>
<p>1.0.0 完成后，将主干分支到一个新的“1.0”分支，并创建一个“1.0.0”标签。现在在主干中继续研究最终将成为 1.1 的内容。</p>
<ul>
<li>trunk/ - 开发版本， <strong>即将成为 1.1</strong>
</li>
<li><strong>branches/1.0 - 1.0.0 发布版本</strong></li>
<li><strong>tags/1.0.0 - 1.0.0 发布版本</strong></li>
</ul>
<p>你在代码中遇到一些错误，并在主干中修复它们，然后将修复合并到 1.0 分支。你也可以反其道而行之，修复 1.0
分支中的错误，然后将它们合并回主干，但通常项目坚持单向合并只是为了减少丢失某些东西的机会。有时一个错误只能在 1.0 中修复，因为它在 1.1
中已过时。这并不重要：您只想确保您发布的 1.1 版本中没有 1.0 中已修复的相同错误。</p>
<ul>
<li>trunk/ - 开发版本，即将成为 1.1</li>
<li>branches/1.0 - <strong>即将发布的 1.0.1 版本</strong>
</li>
<li>tags/1.0.0 - 1.0.0 发布版本</li>
</ul>
<p>一旦你发现了足够多的错误（或者可能是一个严重的错误），你决定发布 1.0.1 版本。所以你从 1.0
分支创建一个标签“1.0.1”，然后发布代码。此时，主干将包含 1.1，而“1.0”分支包含 1.0.1 代码。下次您发布 1.0 的更新时，它将是
1.0.2。</p>
<ul>
<li>trunk/ - 开发版本，即将成为 1.1</li>
<li>branches/1.0 - <strong>即将发布的 1.0.2 版本</strong>
</li>
<li>tags/1.0.0 - 1.0.0 发布版本</li>
<li><strong>tags/1.0.1 - 1.0.1 发布版本</strong></li>
</ul>
<p>最终你几乎准备好发布 1.1，但你想先做一个测试版。在这种情况下，您可能会执行“1.1”分支和“1.1beta1”标记。现在，1.2（或 2.0
可能）的工作在主干中继续，但 1.1 的工作在“1.1”分支中继续。</p>
<ul>
<li>trunk/ - 开发版本， <strong>即将成为 1.2</strong>
</li>
<li>branches/1.0 - 即将发布的 1.0.2 版本</li>
<li><strong>branches/1.1 - 即将发布的 1.1.0 版本</strong></li>
<li>tags/1.0.0 - 1.0.0 发布版本</li>
<li>tags/1.0.1 - 1.0.1 发布版本</li>
<li><strong>tags/1.1beta1 - 1.1 beta 1 发布版本</strong></li>
</ul>
<p>一旦你发布了 1.1 final，你就可以从“1.1”分支做一个“1.1”标签。</p>
<p>如果愿意，您还可以继续维护 1.0，在所有三个分支（1.0、1.1
和主干）之间移植错误修复。重要的是，对于您正在维护的软件的每个主要版本，您都有一个分支，其中包含该版本的最新版本代码。</p>
<hr>
<p>分支的另一个用途是功能。这是您分支主干（或您的发布分支之一）并独立处理新功能的地方。功能完成后，将其合并回去并删除分支。</p>
<ul>
<li>trunk/ - 开发版本，即将成为 1.2</li>
<li>branches/1.1 - 即将发布的 1.1.0 版本</li>
<li><strong>branches/ui-rewrite - 实验特性分支</strong></li>
</ul>
<p>这个想法是当你在做一些破坏性的事情（这会阻碍或干扰其他人的工作），一些实验性的事情（甚至可能不会成功），或者可能只是需要很长时间的事情（当你准备从主干分支
1.2 时，你担心它是否会阻止 1.2
版本），你可以在分支中单独进行。通常，您通过始终将更改合并到主干中来使其与主干保持同步，这使得在完成时更容易重新集成（合并回主干）。</p>
<hr>
<p>另请注意，我在这里使用的版本控制方案只是众多方案之一。一些团队会将错误修复/维护版本作为 1.1、1.2 等，将主要更改作为 1.x、2.x
等。这里的用法是相同的，但您可以将分支命名为“1”或“1”
.x”而不是“1.0”或“1.0.x”。（此外，语义版本控制是关于如何处理版本号的一个很好的指南）。</p>
<p><br><br><a href="posts/what-do-branch-tag-and-trunk-mean-in-subversion-repositories/">查看原文</a></p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/wo-ru-he-tong-guo-guan-dao-chuan-shu-stderr-er-bu-shi-stdout/" class="u-url">我如何通过管道传输 stderr 而不是 stdout？</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/wo-ru-he-tong-guo-guan-dao-chuan-shu-stderr-er-bu-shi-stdout/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T04:31:02+08:00" itemprop="datePublished" title="2023-02-17 04:31">2023-02-17 04:31</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p><code>stdout</code>我有一个将信息写入and的程序<code>stderr</code>，我需要处理<code>stderr</code>with <code>grep</code>，放在<code>stdout</code>一边。</p>
<p>使用临时文件，可以分两步完成：</p>
<div class="code"><pre class="code literal-block">command &gt; /dev/null 2&gt; temp.file
grep 'something' temp.file
</pre></div>

<p>但是，如果没有临时文件，如何使用一个命令和管道来实现这一目标呢？</p>
<p><br><br></p>
<h2>解答</h2>
<p>首先将 stderr 重定向到 stdout — 管道；然后将 stdout 重定向到<code>/dev/null</code>（不更改 stderr 的去向）：</p>
<div class="code"><pre class="code literal-block">command 2&gt;&amp;1 &gt;/dev/null | grep 'something'
</pre></div>

<p>有关各种 I/O 重定向的详细信息，请参阅Bash 参考手册中有关重定向的章节。</p>
<p>请注意，I/O 重定向的顺序是从左到右解释的，但是管道是在解释 I/O 重定向之前设置的。诸如 1 和 2
之类的文件描述符是对打开文件描述的引用。该操作<code>2&gt;&amp;1</code>使文件描述符 2 aka stderr 引用与文件描述符 1 aka stdout
当前引用的相同的打开文件描述（参见<code>dup2()</code>和<code>open()</code>）。然后该操作<code>&gt;/dev/null</code>更改文件描述符 1，使其引用
的打开文件描述<code>/dev/null</code>，但这不会改变文件描述符 2 引用文件描述符 1 最初指向的打开文件描述这一事实，即管道。</p>
<p><br></p>
<h3>更多建议</h3>
<p>或者交换标准错误和标准输出的输出，使用：</p>
<div class="code"><pre class="code literal-block">command 3&gt;&amp;1 1&gt;&amp;2 2&gt;&amp;3
</pre></div>

<p>这将创建一个新的文件描述符 (3) 并将其分配到与 1（标准输出）相同的位置，然后将 fd 1（标准输出）分配到与 fd 2（标准错误）相同的位置，最后分配
fd 2（标准错误） ) 到与 fd 3（标准输出）相同的位置。</p>
<p>标准错误现在可作为标准输出使用，旧的标准输出保留在标准错误中。这可能有点矫枉过正，但它有望提供有关 Bash 文件描述符的更多详细信息（每个进程有 9
个可用）。</p>
<p><br><br><a href="posts/how-can-i-pipe-stderr-and-not-stdout/">查看原文</a></p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-344.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-342.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
