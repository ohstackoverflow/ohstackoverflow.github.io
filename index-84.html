<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 84) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-84.html">
<link rel="prev" href="index-85.html" type="text/html">
<link rel="next" href="index-83.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/powershell-says-execution-of-scripts-is-disabled-on-this-system/" class="u-url">PowerShell says "execution of scripts is disabled on this system."</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/powershell-says-execution-of-scripts-is-disabled-on-this-system/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-16T20:45:15+08:00" itemprop="datePublished" title="2023-02-16 20:45">2023-02-16 20:45</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I am trying to run a <code>cmd</code> file that calls a PowerShell script from <code>cmd.exe</code>,
but I am getting this error:</p>
<blockquote>
<p><code>Management_Install.ps1</code> cannot be loaded because the execution of scripts
is disabled on this system.</p>
</blockquote>
<p>I ran this command:</p>
<div class="code"><pre class="code literal-block">Set-ExecutionPolicy -ExecutionPolicy Unrestricted
</pre></div>

<p>When I run <code>Get-ExecutionPolicy</code> from PowerShell, it returns <code>Unrestricted</code>.</p>
<div class="code"><pre class="code literal-block">Get-ExecutionPolicy
</pre></div>

<p>Output:</p>
<div class="code"><pre class="code literal-block">Unrestricted
</pre></div>

<hr>
<blockquote>
<p>cd "C:\Projects\Microsoft.Practices.ESB\Source\Samples\Management
Portal\Install\Scripts" powershell .\Management_Install.ps1 1</p>
<p>WARNING: Running x86 PowerShell...</p>
<p>File <code>C:\Projects\Microsoft.Practices.ESB\Source\Samples\Management
Portal\Install\Scripts\Management_Install.ps1</code> cannot be loaded because the
execution of scripts is disabled on this system. Please see "<code>get-help
about_signing</code>" for more details.</p>
<p>At line:1 char:25</p>
<ul>
<li>
<p><code>.\Management_Install.ps1</code> &lt;&lt;&lt;&lt; 1</p>
<ul>
<li>
<p>CategoryInfo : NotSpecified: (:) [], PSSecurityException</p>
</li>
<li>
<p>FullyQualifiedErrorId : RuntimeException</p>
</li>
</ul>
</li>
</ul>
<p>C:\Projects\Microsoft.Practices.ESB\Source\Samples\Management
Portal\Install\Scripts&gt; PAUSE</p>
<p>Press any key to continue . . .</p>
</blockquote>
<hr>
<p>The system is Windows Server 2008 R2.</p>
<p>What am I doing wrong?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>If you're using Windows Server 2008 R2 then there is an <em>x64</em> and <em>x86</em>
version of PowerShell both of which have to have their execution policies set.
Did you set the execution policy on both hosts?</p>
<p>As an <em>Administrator</em> , you can set the execution policy by typing this into
your PowerShell window:</p>
<div class="code"><pre class="code literal-block">Set-ExecutionPolicy RemoteSigned
</pre></div>

<p>For more information, see <em>Using the Set-ExecutionPolicy Cmdlet</em>.</p>
<p>When you are done, you can set the policy back to its default value with:</p>
<div class="code"><pre class="code literal-block">Set-ExecutionPolicy Restricted
</pre></div>

<p>You may see an error:</p>
<div class="code"><pre class="code literal-block"><span class="n">Access</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">registry</span><span class="w"> </span><span class="n">key</span>
<span class="p">'</span><span class="n">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\PowerShell\1\ShellIds\Microsoft.PowerShell'</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">denied</span><span class="p">.</span><span class="w"> </span>
<span class="n">To</span><span class="w"> </span><span class="n">change</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">execution</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="p">(</span><span class="n">LocalMachine</span><span class="p">)</span><span class="w"> </span><span class="n">scope</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="n">start</span><span class="w"> </span><span class="n">Windows</span><span class="w"> </span><span class="n">PowerShell</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="s">"Run as administrator"</span><span class="w"> </span><span class="n">option</span><span class="p">.</span><span class="w"> </span>
<span class="n">To</span><span class="w"> </span><span class="n">change</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">execution</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="n">user</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="n">run</span><span class="w"> </span><span class="s">"Set-ExecutionPolicy -Scope CurrentUser"</span><span class="p">.</span>
</pre></div>

<p>So you may need to run the command like this (as seen in comments):</p>
<div class="code"><pre class="code literal-block">Set-ExecutionPolicy RemoteSigned -Scope CurrentUser
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>You can bypass this policy for a single file by adding <code>-ExecutionPolicy
Bypass</code> when running PowerShell</p>
<div class="code"><pre class="code literal-block">powershell -ExecutionPolicy Bypass -File script.ps1
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-do-i-install-pip-on-windows/" class="u-url">How do I install pip on Windows?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-do-i-install-pip-on-windows/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-16T20:44:08+08:00" itemprop="datePublished" title="2023-02-16 20:44">2023-02-16 20:44</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p><code>pip</code> is a replacement for <code>easy_install</code>. But should I install <code>pip</code> using
<code>easy_install</code> on Windows? Is there a better way?</p>
<p><br><br></p>
<h2>Answer</h2>
<h3>Python 3.4+ and 2.7.9+</h3>
<p>Good news! Python 3.4 (released March 2014) and Python 2.7.9 (released
December 2014) ship with Pip. This is the best feature of any Python release.
It makes the community's wealth of libraries accessible to everyone. Newbies
are no longer excluded from using community libraries by the prohibitive
difficulty of setup. In shipping with a package manager, Python joins Ruby,
Node.js, Haskell, Perl, Go—almost every other contemporary language with a
majority open-source community. Thank you, Python.</p>
<p>If you do find that pip is not available, simply run <code>ensurepip</code>.</p>
<ul>
<li>
<p>On Windows:</p>
<div class="code"><pre class="code literal-block">py -3 -m ensurepip
</pre></div>

</li>
<li>
<p>Otherwise:</p>
<div class="code"><pre class="code literal-block">python3 -m ensurepip
</pre></div>

</li>
</ul>
<p>Of course, that doesn't mean Python packaging is problem solved. The
experience remains frustrating. I discuss this in the Stack Overflow question
<em>Does Python have a package/module management system?</em>.</p>
<h3>Python 3 ≤ 3.3 and 2 ≤ 2.7.8</h3>
<p>Flying in the face of its 'batteries included' motto, Python ships without a
package manager. To make matters worse, Pip was—until recently—ironically
difficult to install.</p>
<h4>Official instructions</h4>
<p>Per https://pip.pypa.io/en/stable/installing/#do-i-need-to-install-pip:</p>
<p>Download <code>get-pip.py</code>, being careful to save it as a <code>.py</code> file rather than
<code>.txt</code>. Then, run it from the command prompt:</p>
<div class="code"><pre class="code literal-block">python get-pip.py
</pre></div>

<p>You possibly need an administrator command prompt to do this. Follow <em>Start a
Command Prompt as an Administrator</em> (Microsoft TechNet).</p>
<p>This installs the pip package, which (in Windows) contains ...\Scripts\pip.exe
that path must be in PATH environment variable to use pip from the command
line (see the second part of 'Alternative Instructions' for adding it to your
PATH,</p>
<h4>Alternative instructions</h4>
<p>The official documentation tells users to install Pip and each of its
dependencies from source. That's tedious for the experienced and prohibitively
difficult for newbies.</p>
<p>For our sake, Christoph Gohlke prepares Windows installers (<code>.msi</code>) for
popular Python packages. He builds installers for all Python versions, both 32
and 64 bit. You need to:</p>
<ol>
<li>Install setuptools</li>
<li>Install pip</li>
</ol>
<p>For me, this installed Pip at <code>C:\Python27\Scripts\pip.exe</code>. Find <code>pip.exe</code> on
your computer, then add its folder (for example, <code>C:\Python27\Scripts</code>) to
your path (Start / Edit environment variables). Now you should be able to run
<code>pip</code> from the command line. Try installing a package:</p>
<div class="code"><pre class="code literal-block">pip install httpie
</pre></div>

<p>There you go (hopefully)! Solutions for common problems are given below:</p>
<h4>Proxy problems</h4>
<p>If you work in an office, you might be behind an HTTP proxy. If so, set the
environment variables <code>http_proxy</code> and <code>https_proxy</code>. Most Python applications
(and other free software) respect these. Example syntax:</p>
<div class="code"><pre class="code literal-block"><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="nl">proxy_url</span><span class="p">:</span><span class="n">port</span>
<span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="nl">username</span><span class="p">:</span><span class="n">password</span><span class="nv">@proxy_url</span><span class="err">:</span><span class="n">port</span>
</pre></div>

<p>If you're really unlucky, your proxy might be a Microsoft NTLM proxy. Free
software can't cope. The only solution is to install a free software friendly
proxy that forwards to the nasty proxy. http://cntlm.sourceforge.net/</p>
<h4>Unable to find vcvarsall.bat</h4>
<p>Python modules can be partly written in C or C++. Pip tries to compile from
source. If you don't have a C/C++ compiler installed and configured, you'll
see this cryptic error message.</p>
<blockquote>
<p>Error: Unable to find vcvarsall.bat</p>
</blockquote>
<p>You can fix that by installing a C++ compiler such as MinGW or Visual C++.
Microsoft actually ships one specifically for use with Python. Or try
<em>Microsoft Visual C++ Compiler for Python 2.7</em>.</p>
<p>Often though it's easier to check Christoph's site for your package.</p>
<p><br></p>
<h3>Suggest</h3>
<p><del>-- <strong>Outdated</strong> -- use distribute, not setuptools as described here. --</del><br>
-- <strong>Outdated #2</strong> -- use setuptools as distribute is deprecated.</p>
<p>As you mentioned pip doesn't include an independent installer, but you can
install it with its predecessor easy_install.</p>
<p>So:</p>
<ol>
<li>Download the last pip version from here: http://pypi.python.org/pypi/pip#downloads</li>
<li>Uncompress it</li>
<li>Download the last easy installer for Windows: ( <strong>download the .exe at the bottom of http://pypi.python.org/pypi/setuptools</strong> ). Install it.</li>
<li>copy the uncompressed pip folder <strong>content</strong> into <code>C:\Python2x\</code> folder (don't copy the whole folder into it, just the content), because python command doesn't work outside <code>C:\Python2x</code> folder and then run: <code>python setup.py install</code>
</li>
<li>Add your python <code>C:\Python2x\Scripts</code> to the path</li>
</ol>
<p>You are done.</p>
<p>Now you can use <code>pip install package</code> to easily install packages as in Linux
:)</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-mkdir-only-if-a-directory-does-not-already-exist/" class="u-url">How to mkdir only if a directory does not already exist?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-mkdir-only-if-a-directory-does-not-already-exist/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-16T20:43:16+08:00" itemprop="datePublished" title="2023-02-16 20:43">2023-02-16 20:43</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I am writing a shell script to run under the KornShell (ksh) on AIX. I would
like to use the <code>mkdir</code> command to create a directory. But the directory may
already exist, in which case I do not want to do anything. So I want to either
test to see that the directory does not exist, or suppress the "File exists"
error that <code>mkdir</code> throws when it tries to create an existing directory.</p>
<p>How can I best do this?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Try <code>mkdir -p</code>:</p>
<div class="code"><pre class="code literal-block">mkdir -p foo
</pre></div>

<p>Note that this will also create any intermediate directories that don't exist;
for instance,</p>
<div class="code"><pre class="code literal-block">mkdir -p foo/bar/baz
</pre></div>

<p>will create directories <code>foo</code>, <code>foo/bar</code>, and <code>foo/bar/baz</code> if they don't
exist.</p>
<p>Some implementation like GNU <code>mkdir</code> include <code>mkdir --parents</code> as a more
readable alias, but this is not specified in POSIX/Single Unix Specification
and not available on many common platforms like macOS, various BSDs, and
various commercial Unixes, so it should be avoided.</p>
<p>If you want an error when parent directories don't exist, and want to create
the directory if it doesn't exist, then you can <code>test</code> for the existence of
the directory first:</p>
<div class="code"><pre class="code literal-block">[ -d foo ] || mkdir foo
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>This should work:</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span>mkdir<span class="w"> </span>-p<span class="w"> </span>dir
</pre></div>

<p>or:</p>
<div class="code"><pre class="code literal-block"><span class="k">if</span><span class="w"> </span>[[<span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="o">-</span><span class="nv">e</span><span class="w"> </span><span class="mh">$d</span><span class="nv">ir</span><span class="w"> </span>]]<span class="c1">; then</span>
<span class="w">    </span><span class="nv">mkdir</span><span class="w"> </span><span class="mh">$d</span><span class="nv">ir</span>
<span class="nv">elif</span><span class="w"> </span>[[<span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="o">-</span><span class="nv">d</span><span class="w"> </span><span class="mh">$d</span><span class="nv">ir</span><span class="w"> </span>]]<span class="c1">; then</span>
<span class="w">    </span><span class="nv">echo</span><span class="w"> </span><span class="s2">"$dir already exists but is not a directory"</span><span class="w"> </span><span class="mi">1</span><span class="o">&gt;&amp;</span><span class="mi">2</span>
<span class="nv">fi</span>
</pre></div>

<p>which will create the directory if it doesn't exist, but warn you if the name
of the directory you're trying to create is already in use by something other
than a directory.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-85.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-83.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
