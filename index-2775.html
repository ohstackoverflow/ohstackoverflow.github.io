<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 2775) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-2775.html">
<link rel="prev" href="index-2776.html" type="text/html">
<link rel="next" href="index-2774.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/convert-an-nsurl-to-an-nsstring/" class="u-url">Convert an NSURL to an NSString</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/convert-an-nsurl-to-an-nsstring/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-05T17:03:36+08:00" itemprop="datePublished" title="2023-03-05 17:03">2023-03-05 17:03</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I have an app where the user can choose an image either from the built-in app
images or from the iphone photo library. I use an object Occasion that has an
<code>NSString</code> property to save the <code>imagePath</code>.</p>
<p>Now in the case of the built-in app images I do get the file name as an
<code>NSString</code> an save in the <code>[occasion imagePath]</code>. But in the 2nd case where
the user picks an image form the photo library I get an <code>NSURL</code> which I want
to convert to an <code>NSString</code> to be able to save it in <code>[occasion imagePath</code>].</p>
<p>Is it possible to convert the <code>NSURL</code> to an <code>NSString</code>?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>In Objective-C:</p>
<div class="code"><pre class="code literal-block">NSString *myString = myURL.absoluteString;
</pre></div>

<p>In Swift:</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">myString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">myURL</span><span class="o">.</span><span class="n">absoluteString</span>
</pre></div>

<p>More info in the docs:</p>
<p><br></p>
<h3>Suggest</h3>
<p>If you're interested in the pure string:</p>
<div class="code"><pre class="code literal-block"><span class="p">[</span><span class="n">myUrl</span><span class="w"> </span><span class="n">absoluteString</span><span class="p">];</span>
</pre></div>

<p>If you're interested in the path represented by the URL (and to be used with
<code>NSFileManager</code> methods for example):</p>
<div class="code"><pre class="code literal-block"><span class="p">[</span><span class="n">myUrl</span><span class="w"> </span><span class="n">path</span><span class="p">];</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/typescript-cloning-object/" class="u-url">typescript - cloning object</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/typescript-cloning-object/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-05T17:01:52+08:00" itemprop="datePublished" title="2023-03-05 17:01">2023-03-05 17:01</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I have a super class that is the parent (<code>Entity</code>) for many subclass
(<code>Customer</code>, <code>Product</code>, <code>ProductCategory</code>...)</p>
<p>I'm looking to clone dynamically an object that contains different sub objects
in Typescript.</p>
<p>In example : a <code>Customer</code> that has different <code>Product</code> who has a
<code>ProductCategory</code></p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">cust</span><span class="p">:</span><span class="n">Customer</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">Customer</span><span class="w"> </span><span class="p">();</span>

<span class="n">cust</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"someName"</span><span class="p">;</span>
<span class="n">cust</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">new</span><span class="w"> </span><span class="n">Product</span><span class="p">(</span><span class="n">someId1</span><span class="p">));</span>
<span class="n">cust</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">new</span><span class="w"> </span><span class="n">Product</span><span class="p">(</span><span class="n">someId2</span><span class="p">));</span>
</pre></div>

<p>In order to clone the whole tree of object I created a function in <code>Entity</code></p>
<div class="code"><pre class="code literal-block"><span class="k">public</span><span class="w"> </span><span class="n">clone</span><span class="p">()</span><span class="err">:</span><span class="ow">any</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="nf">var</span><span class="w"> </span><span class="n">cloneObj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">this</span><span class="p">.</span><span class="k">constructor</span><span class="p">();</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nf">var</span><span class="w"> </span><span class="n">attribut</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">this</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">typeof</span><span class="w"> </span><span class="n">this</span><span class="o">[</span><span class="n">attribut</span><span class="o">]</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="ss">"object"</span><span class="p">)</span><span class="err">{</span>
<span class="w">           </span><span class="n">cloneObj</span><span class="o">[</span><span class="n">attribut</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">this</span><span class="p">.</span><span class="n">clone</span><span class="p">();</span>
<span class="w">        </span><span class="err">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="err">{</span>
<span class="w">           </span><span class="n">cloneObj</span><span class="o">[</span><span class="n">attribut</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">this</span><span class="o">[</span><span class="n">attribut</span><span class="o">]</span><span class="p">;</span>
<span class="w">        </span><span class="err">}</span>
<span class="w">    </span><span class="err">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">cloneObj</span><span class="p">;</span>
<span class="err">}</span>
</pre></div>

<p>The <code>new</code> rises the following error when it is transpiled to javascript:
<code>error TS2351: Cannot use 'new' with an expression whose type lacks a call or
construct signature.</code></p>
<p>Although the script works, <strong><em>I would like to get rid of the transpiled
error</em></strong></p>
<p><br><br></p>
<h2>Answer</h2>
<h2>Solving The Specific Issue</h2>
<p>You can use a type assertion to tell the compiler that you know better:</p>
<div class="code"><pre class="code literal-block"><span class="k">public</span><span class="w"> </span><span class="n">clone</span><span class="p">()</span><span class="err">:</span><span class="w"> </span><span class="ow">any</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="nf">var</span><span class="w"> </span><span class="n">cloneObj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="p">(</span><span class="n">this</span><span class="p">.</span><span class="k">constructor</span><span class="p">()</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="ow">any</span><span class="p">);</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nf">var</span><span class="w"> </span><span class="n">attribut</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">this</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">typeof</span><span class="w"> </span><span class="n">this</span><span class="o">[</span><span class="n">attribut</span><span class="o">]</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="ss">"object"</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">            </span><span class="n">cloneObj</span><span class="o">[</span><span class="n">attribut</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">this</span><span class="o">[</span><span class="n">attribut</span><span class="o">]</span><span class="p">.</span><span class="n">clone</span><span class="p">();</span>
<span class="w">        </span><span class="err">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="err">{</span>
<span class="w">            </span><span class="n">cloneObj</span><span class="o">[</span><span class="n">attribut</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">this</span><span class="o">[</span><span class="n">attribut</span><span class="o">]</span><span class="p">;</span>
<span class="w">        </span><span class="err">}</span>
<span class="w">    </span><span class="err">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">cloneObj</span><span class="p">;</span>
<span class="err">}</span>
</pre></div>

<h2>Cloning</h2>
<p>As of 2022, there is a proposal to allow <code>structuredClone</code> to deep copy many
types.</p>
<div class="code"><pre class="code literal-block"><span class="k">const</span><span class="w"> </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">structuredClone</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</pre></div>

<p>There are some limitations on what kind of thing you can use this on.</p>
<p>Bear in mind that sometimes it is better to write your own mapping - rather
than being totally dynamic. However, there are a few "cloning" tricks you can
use that give you different effects.</p>
<p>I will use the following code for all the subsequent examples:</p>
<div class="code"><pre class="code literal-block"><span class="k">class</span><span class="w"> </span><span class="n">Example</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">constructor</span><span class="p">(</span><span class="n">public</span><span class="w"> </span><span class="n">type</span><span class="p">:</span><span class="w"> </span><span class="n">string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">class</span><span class="w"> </span><span class="n">Customer</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">constructor</span><span class="p">(</span><span class="n">public</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="n">public</span><span class="w"> </span><span class="n">example</span><span class="p">:</span><span class="w"> </span><span class="n">Example</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">greet</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s1">'Hello '</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">this</span><span class="o">.</span><span class="n">name</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">var</span><span class="w"> </span><span class="n">customer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">Customer</span><span class="p">(</span><span class="s1">'David'</span><span class="p">,</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">Example</span><span class="p">(</span><span class="s1">'DavidType'</span><span class="p">));</span>
</pre></div>

<hr>
<p>Option 1: Spread</p>
<p>Properties: <strong>Yes</strong><br>
Methods: No<br>
Deep Copy: No</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">clone</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="o">...</span><span class="n">customer</span><span class="w"> </span><span class="p">};</span>

<span class="n">alert</span><span class="p">(</span><span class="n">clone</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">' '</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">clone</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">type</span><span class="p">);</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">David</span><span class="w"> </span><span class="n">DavidType</span>
<span class="o">//</span><span class="n">alert</span><span class="p">(</span><span class="n">clone</span><span class="o">.</span><span class="n">greet</span><span class="p">());</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">Not</span><span class="w"> </span><span class="n">OK</span>

<span class="n">clone</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Steve'</span><span class="p">;</span>
<span class="n">clone</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'SteveType'</span><span class="p">;</span>

<span class="n">alert</span><span class="p">(</span><span class="n">customer</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">' '</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">customer</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">type</span><span class="p">);</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">David</span><span class="w"> </span><span class="n">SteveType</span>
</pre></div>

<hr>
<p>Option 2: Object.assign</p>
<p>Properties: <strong>Yes</strong><br>
Methods: No<br>
Deep Copy: No</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">clone</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb nb-Type">Object</span><span class="o">.</span><span class="n">assign</span><span class="p">({},</span><span class="w"> </span><span class="n">customer</span><span class="p">);</span>

<span class="n">alert</span><span class="p">(</span><span class="n">clone</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">' '</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">clone</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">type</span><span class="p">);</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">David</span><span class="w"> </span><span class="n">DavidType</span>
<span class="n">alert</span><span class="p">(</span><span class="n">clone</span><span class="o">.</span><span class="n">greet</span><span class="p">());</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">Not</span><span class="w"> </span><span class="n">OK</span><span class="p">,</span><span class="w"> </span><span class="n">although</span><span class="w"> </span><span class="n">compiler</span><span class="w"> </span><span class="n">won</span><span class="s1">'t spot it</span>

<span class="n">clone</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Steve'</span><span class="p">;</span>
<span class="n">clone</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'SteveType'</span><span class="p">;</span>

<span class="n">alert</span><span class="p">(</span><span class="n">customer</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">' '</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">customer</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">type</span><span class="p">);</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">David</span><span class="w"> </span><span class="n">SteveType</span>
</pre></div>

<hr>
<p>Option 3: Object.create</p>
<p>Properties: <em>Inherited</em><br>
Methods: <em>Inherited</em><br>
Deep Copy: <em>Shallow Inherited</em> (deep changes affect both original and clone)</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">clone</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb nb-Type">Object</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">customer</span><span class="p">);</span>

<span class="n">alert</span><span class="p">(</span><span class="n">clone</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">' '</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">clone</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">type</span><span class="p">);</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">David</span><span class="w"> </span><span class="n">DavidType</span>
<span class="n">alert</span><span class="p">(</span><span class="n">clone</span><span class="o">.</span><span class="n">greet</span><span class="p">());</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">OK</span>

<span class="n">customer</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Misha'</span><span class="p">;</span>
<span class="n">customer</span><span class="o">.</span><span class="n">example</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">Example</span><span class="p">(</span><span class="s2">"MishaType"</span><span class="p">);</span>

<span class="o">//</span><span class="w"> </span><span class="n">clone</span><span class="w"> </span><span class="n">sees</span><span class="w"> </span><span class="n">changes</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">original</span><span class="w"> </span>
<span class="n">alert</span><span class="p">(</span><span class="n">clone</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">' '</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">clone</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">type</span><span class="p">);</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">Misha</span><span class="w"> </span><span class="n">MishaType</span>

<span class="n">clone</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Steve'</span><span class="p">;</span>
<span class="n">clone</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'SteveType'</span><span class="p">;</span>

<span class="o">//</span><span class="w"> </span><span class="n">original</span><span class="w"> </span><span class="n">sees</span><span class="w"> </span><span class="n">changes</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">clone</span>
<span class="n">alert</span><span class="p">(</span><span class="n">customer</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">' '</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">customer</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">type</span><span class="p">);</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">Misha</span><span class="w"> </span><span class="n">SteveType</span>
</pre></div>

<hr>
<p>Option 4: Deep Copy Function</p>
<p>Properties: <strong>Yes</strong><br>
Methods: No<br>
Deep Copy: <strong>Yes</strong></p>
<div class="code"><pre class="code literal-block"><span class="k">function</span><span class="w"> </span><span class="n">deepCopy</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="nf">var</span><span class="w"> </span><span class="n">copy</span><span class="p">;</span>

<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="n">Handle</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="n">simple</span><span class="w"> </span><span class="n">types</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">undefined</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">null</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="ss">"object"</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">typeof</span><span class="w"> </span><span class="n">obj</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">obj</span><span class="p">;</span>

<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="n">Handle</span><span class="w"> </span><span class="nc">Date</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">obj</span><span class="w"> </span><span class="n">instanceof</span><span class="w"> </span><span class="nc">Date</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nc">Date</span><span class="p">();</span>
<span class="w">        </span><span class="n">copy</span><span class="p">.</span><span class="n">setTime</span><span class="p">(</span><span class="n">obj</span><span class="p">.</span><span class="n">getTime</span><span class="p">());</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">copy</span><span class="p">;</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="n">Handle</span><span class="w"> </span><span class="k">Array</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">obj</span><span class="w"> </span><span class="n">instanceof</span><span class="w"> </span><span class="k">Array</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">[]</span><span class="p">;</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nf">var</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nf">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obj</span><span class="p">.</span><span class="n">length</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nf">len</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">            </span><span class="n">copy</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deepCopy</span><span class="p">(</span><span class="n">obj</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">);</span>
<span class="w">        </span><span class="err">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">copy</span><span class="p">;</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="n">Handle</span><span class="w"> </span><span class="k">Object</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">obj</span><span class="w"> </span><span class="n">instanceof</span><span class="w"> </span><span class="k">Object</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{}</span><span class="p">;</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nf">var</span><span class="w"> </span><span class="n">attr</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">obj</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">obj</span><span class="p">.</span><span class="n">hasOwnProperty</span><span class="p">(</span><span class="n">attr</span><span class="p">))</span><span class="w"> </span><span class="n">copy</span><span class="o">[</span><span class="n">attr</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deepCopy</span><span class="p">(</span><span class="n">obj</span><span class="o">[</span><span class="n">attr</span><span class="o">]</span><span class="p">);</span>
<span class="w">        </span><span class="err">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">copy</span><span class="p">;</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Error</span><span class="p">(</span><span class="ss">"Unable to copy obj! Its type isn't supported."</span><span class="p">);</span>
<span class="err">}</span>

<span class="nf">var</span><span class="w"> </span><span class="n">clone</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deepCopy</span><span class="p">(</span><span class="n">customer</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">Customer</span><span class="p">;</span>

<span class="n">alert</span><span class="p">(</span><span class="n">clone</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">' '</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">clone</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">type</span><span class="p">);</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">David</span><span class="w"> </span><span class="n">DavidType</span>
<span class="o">//</span><span class="w"> </span><span class="n">alert</span><span class="p">(</span><span class="n">clone</span><span class="p">.</span><span class="n">greet</span><span class="p">());</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="ow">Not</span><span class="w"> </span><span class="n">OK</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">really</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">customer</span>

<span class="n">clone</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Steve'</span><span class="p">;</span>
<span class="n">clone</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'SteveType'</span><span class="p">;</span>

<span class="n">alert</span><span class="p">(</span><span class="n">customer</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">' '</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">customer</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">type</span><span class="p">);</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">David</span><span class="w"> </span><span class="n">DavidType</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<ol>
<li>Use spread operator <code>...</code><div class="code"><pre class="code literal-block"><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">obj1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">param</span><span class="p">:</span><span class="w"> </span><span class="s2">"value"</span><span class="w"> </span><span class="p">};</span>
</pre></div>

<p>const obj2 = { ...obj1 };</p>
</li>
</ol>
<p>Spread operator takes all fields from obj1 and spread them over obj2. In the
result you get new object with new reference and the same fields as original
one.</p>
<p>Remember that it is shallow copy, it means that if object is nested then its
nested composite params will exists in the new object by the same reference.</p>
<ol>
<li>
<code>Object.assign()</code><div class="code"><pre class="code literal-block"><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">obj1</span><span class="o">=</span><span class="p">{</span><span class="w"> </span><span class="n">param</span><span class="p">:</span><span class="w"> </span><span class="s2">"value"</span><span class="w"> </span><span class="p">};</span>
</pre></div>

<p>const obj2:any = Object.assign({}, obj1);</p>
</li>
</ol>
<p><strong>Object.assign</strong> create real copy, but only own properties, so properties in
prototype will not exist in copied object. It is also shallow copy.</p>
<hr>
<ol>
<li>
<code>Object.create()</code><div class="code"><pre class="code literal-block"><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">obj1</span><span class="o">=</span><span class="p">{</span><span class="w"> </span><span class="n">param</span><span class="p">:</span><span class="w"> </span><span class="s2">"value"</span><span class="w"> </span><span class="p">};</span>
</pre></div>

<p>const obj2:any = Object.create(obj1);</p>
</li>
</ol>
<p><code>Object.create</code> <strong>is not doing real cloning</strong> , it is creating object from
prototype. So use it if the object should clone primary type properties,
because primary type properties assignment is not done by reference.</p>
<p>Pluses of <strong>Object.create</strong> are that any functions declared in prototype will
be available in our newly created object.</p>
<hr>
<p><strong>Few things about shallow copy</strong></p>
<p>Shallow copy puts into new object all fields of the old one, but it also means
that if original object has composite type fields (object, arrays etc.) then
those fields are put in new object with the same references. Mutation such
field in original object will be reflected in new object.</p>
<p>It maybe looks like a pitfall, but really situation when the whole complex
object needs to be copied is rare. Shallow copy will re-use most of memory
which means that is very cheap in comparison to deep copy.</p>
<hr>
<p><strong>Deep copy</strong></p>
<p>Spread operator can be handy for deep copy.</p>
<div class="code"><pre class="code literal-block"><span class="k">const</span><span class="w"> </span><span class="n">obj1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">param</span><span class="p">:</span><span class="w"> </span><span class="s2">"value"</span><span class="p">,</span><span class="w"> </span><span class="n">complex</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s2">"John"</span><span class="p">}}</span>
<span class="k">const</span><span class="w"> </span><span class="n">obj2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="o">...</span><span class="n">obj1</span><span class="p">,</span><span class="w"> </span><span class="n">complex</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="o">...</span><span class="n">obj1</span><span class="o">.</span><span class="n">complex</span><span class="p">}};</span>
</pre></div>

<p>Above code created deep copy of obj1. Composite field "complex" was also
copied into obj2. Mutation field "complex" will not reflect the copy.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/unity-scripts-edited-in-visual-studio-don-t-provide-autocomplete/" class="u-url">Unity Scripts edited in Visual studio don't provide autocomplete</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/unity-scripts-edited-in-visual-studio-don-t-provide-autocomplete/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-05T16:59:49+08:00" itemprop="datePublished" title="2023-03-05 16:59">2023-03-05 16:59</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>When I want to edit C# Unity scripts, they open in Visual Studio. It is
supposed to provide auto complete for all Unity related code, but it doesn't
work.</p>
<p>Here you can see the missing functionality:</p>
<p><img alt="Video of missing autocomplete feature" src="images/UbgaT.gif"></p>
<p>As seen, the <code>transform</code> object does not open the autocomplete menu.</p>
<blockquote>
<p>Unity version: 5.5.2f1<br>
 Visual studio 2015<br>
 Visual Studio Tools for Unity is installed</p>
</blockquote>
<p><br><br></p>
<h2>Answer</h2>
<p>There is no auto-completion because the script says " <em>Miscellaneous Files</em> "
instead of the of the name of the Project. Take a look at the image below that
came from the video in your question:</p>
<p><img alt="enter image description here" src="images/FnZMa.png"></p>
<p>The " <em>Miscellaneous Files</em> " message can happen for many reasons:</p>
<ol>
<li>
<p>It can happen when you open your Unity C# file from another folder instead of opening it from Unity Editor.</p>
</li>
<li>
<p>This can also happen because Unity crashed while Visual Studio is still open therefore corrupting some files.</p>
</li>
<li>
<p>It can happen because Unity was closed then re-opened but is no longer connected to Visual Studio. When Visual Studio is opened you get " <em>Miscellaneous Files</em> " and no auto-completion.</p>
</li>
<li>
<p>This can happen when <em>Visual Studio Tools for unity</em> is not installed.</p>
</li>
<li>
<p>When you create a script from Unity then quickly open it before Unity finish processing it or before the round icon animation stuff finish animating.</p>
</li>
</ol>
<hr>
<p><em>Most of the times, restarting Unity and Visual Studio should fix this.</em></p>
<p>I can't tell which one is causing the problem but I will cover the most likely
solution to fix this.</p>
<p><strong>Fix Part 1</strong> :</p>
<ol>
<li>
<p>Download and Install <em>Visual Studio Tools for unity</em> from this link. Do this while Unity and Visual Studio are both closed.</p>
</li>
<li>
<p>From Unity Editor, go to <em>Edit</em> → <em>Preferences</em>... → <em>External Tools</em>. On the <em>External Script Editor</em> drop down menu, change that to <em>Visual Studio 2015</em>.</p>
</li>
</ol>
<p><img alt="enter image description here" src="images/I6mZ8.gif"></p>
<hr>
<p><strong>Fix Part 2</strong> :</p>
<p>If newly created C# files are coming up as <em>Miscellaneous</em> then follow the
instruction below:</p>
<ol>
<li>From Visual Studio, go to <em>Tools</em> → <em>Options...</em> → <em>Tools for Unity</em> → <em>Miscellaneous</em>. Under <em>Show connectivity icon</em> , set it to <code>true</code> then restart Visual Studio.</li>
</ol>
<p><img alt="enter image description here" src="images/cQ5qZ.gif"></p>
<ol>
<li>When you re-start, connection icon should now be available in Visual Studio. Click it then choose the Unity instance to connect to. The red 'x' icon should now turn into a brown checkmark icon. Now, when you create a new C# file in Unity, it should open without saying <em>Miscellaneous</em>.</li>
</ol>
<p><img alt="enter image description here" src="images/gcTtT.gif"></p>
<hr>
<p><strong>Fix Part 3</strong> :</p>
<p>Still not fixed?</p>
<p>Re-import project then open C# Project.</p>
<ol>
<li>
<p>Close Visual Studio.</p>
</li>
<li>
<p>From Unity, re-import project by going to <em>Assets</em> → <em>Reimport All</em>.</p>
</li>
</ol>
<p><img alt="enter image description here" src="images/cXz71.gif"></p>
<ol>
<li>Now, open the project in Visual Studio by going to <em>Assets</em> → <em>Open C# Project</em>. This will reload the project and fix possible solution file problems.</li>
</ol>
<p><img alt="enter image description here" src="images/ymH26.gif"></p>
<hr>
<p><strong>Fix Part 4</strong> :</p>
<p>Still not fixed?</p>
<p>Fix each C# file individually.</p>
<ol>
<li>Click on <em>Show All Files</em> icon.</li>
</ol>
<p><img alt="enter image description here" src="images/N9Up2.gif"></p>
<ol>
<li>Select the script that doesn't do auto-complete then right-click and select <em>Include In Project</em>.</li>
</ol>
<p><img alt="enter image description here" src="images/ne57W.gif"></p>
<hr>
<p><strong>Fix Part 5</strong> :</p>
<p>Not fixed yet?</p>
<p>Credit goes to <strong>chrisvarnz</strong> for this particular solution which seems to have
worked for multiple people.</p>
<ol>
<li>
<p>Close Visual Studio</p>
</li>
<li>
<p>Go your project directory and delete all the generated Visual Studio files.</p>
</li>
</ol>
<p>These are the files extensions to delete:</p>
<div class="code"><pre class="code literal-block">* `.csproj`
* `.user`
* `.sln`
</pre></div>

<p>Example:</p>
<p>Let's say that the name of your Project is called <code>Target_Shoot</code>, these are
what the files to delete should look like:</p>
<div class="code"><pre class="code literal-block">* `Target_Shoot.csproj`
* `Target_Shoot.Editor.csproj`
* `Target_Shoot.Editor.csproj.user`
* `Target_Shoot.Player.csproj`
* `Target_Shoot.Player.csproj.user`
* `Target_Shoot.sln`
</pre></div>

<p>Do not delete anything else.</p>
<ol>
<li>Double click on the script again <strong>from Unity</strong> which should generate new Visual Studio file then open Visual Studio. This may solve your problem.</li>
</ol>
<hr>
<p><strong>Fix Part 6</strong> :</p>
<p>If not working, check if you are having this error:</p>
<blockquote>
<p>The "GetReferenceNearestTargetFrameworkTask" task was not found</p>
</blockquote>
<ol>
<li>
<p>Install <em>Nuget PackageManager</em> from here.</p>
</li>
<li>
<p>Restart Visual Studio.</p>
</li>
</ol>
<p>See this answer for more information.</p>
<hr>
<p><strong>Fix Part 7</strong></p>
<p>Make sure all of the projects are loaded. In Solution Explorer it should tell
you # of # projects. If all of the projects are not showing, right click on
"Solution (# of # projects)" and click Load Projects.</p>
<p><br></p>
<h3>Suggest</h3>
<p>Try this,</p>
<ol>
<li>
<p>In Unity Editor Go to Menu, Click on Edit -&gt; Preferences -&gt; External Tools -&gt; External Script Editor. Set it to Visual Studio (your installed version of VS).</p>
</li>
<li>
<p>Now in Menubar go to Edit -&gt; Project Settings -&gt; Player Settings -&gt; Other Settings -&gt; Under Configuration -&gt; Check API Compatibility Level -&gt; Change it to your installed .Net version. In my case I set it to .Net 4.x</p>
</li>
</ol>
<p>Now if Visual Studio is running already go to Visual Studio, it will ask to
reload project. Reload the project. Check if it works, if not close Visual
Studio. Now Open cs file from Unity Editor, and now it should work.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-2776.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-2774.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
