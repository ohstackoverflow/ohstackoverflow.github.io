<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 2727) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-2727.html">
<link rel="prev" href="index-2728.html" type="text/html">
<link rel="next" href="index-2726.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/what-is-code-coverage-and-how-do-you-measure-it/" class="u-url">What is code coverage and how do YOU measure it?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/what-is-code-coverage-and-how-do-you-measure-it/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-05T13:25:17+08:00" itemprop="datePublished" title="2023-03-05 13:25">2023-03-05 13:25</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>What is code coverage and how do YOU measure it?</p>
<p>I was asked this question regarding our automating testing code coverage. It
seems to be that, outside of automated tools, it is more art than science. Are
there any real-world examples of how to use code coverage?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Code coverage is a measurement of how many lines/blocks/arcs of your code are
executed while the automated tests are running.</p>
<p>Code coverage is collected by using a specialized tool to instrument the
binaries to add tracing calls and run a full set of automated tests against
the instrumented product. A good tool will give you not only the percentage of
the code that is executed, but also will allow you to drill into the data and
see exactly which lines of code were executed during a particular test.</p>
<p>Our team uses Magellan - an in-house set of code coverage tools. If you are a
.NET shop, Visual Studio has integrated tools to collect code coverage. You
can also roll some custom tools, like this article describes.</p>
<p>If you are a C++ shop, Intel has some tools that run for Windows and Linux,
though I haven't used them. I've also heard there's the gcov tool for GCC, but
I don't know anything about it and can't give you a link.</p>
<p>As to how we use it - code coverage is one of our exit criteria for each
milestone. We have actually three code coverage metrics - coverage from unit
tests (from the development team), scenario tests (from the test team) and
combined coverage.</p>
<p>BTW, while code coverage is a good metric of how much testing you are doing,
it is not necessarily a good metric of how well you are testing your product.
There are other metrics you should use along with code coverage to ensure the
quality.</p>
<p><br></p>
<h3>Suggest</h3>
<p>Code coverage basically tells you how much of your code is covered under
tests. For example, if you have 90% code coverage, it means 10% of the code is
not covered under tests.</p>
<p>I know you might be thinking that if 90% of the code is covered, it's good
enough, but you have to look from a different angle. What is stopping you from
getting 100% code coverage?</p>
<p>A good example will be this:</p>
<div class="code"><pre class="code literal-block"><span class="k">if</span><span class="ss">(</span><span class="nv">customer</span>.<span class="nv">IsOldCustomer</span><span class="ss">())</span><span class="w"> </span>
{
}
<span class="k">else</span><span class="w"> </span>
{
}
</pre></div>

<p>Now, in the code above, there are two paths/branches. If you are always
hitting the "YES" branch, you are not covering the "else" part and it will be
shown in the Code Coverage results. This is good because now you know that
what is not covered and you can write a test to cover the "else" part. If
there was no code coverage, you are just sitting on a time bomb, waiting to
explode.</p>
<p>NCover is a good tool to measure code coverage.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/split-explode-pandas-dataframe-string-entry-to-separate-rows/" class="u-url">Split (explode) pandas dataframe string entry to separate rows</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/split-explode-pandas-dataframe-string-entry-to-separate-rows/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-05T13:24:02+08:00" itemprop="datePublished" title="2023-03-05 13:24">2023-03-05 13:24</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I have a <code>pandas dataframe</code> in which one column of text strings contains
comma-separated values. I want to split each CSV field and create a new row
per entry (assume that CSV are clean and need only be split on ','). For
example, <code>a</code> should become <code>b</code>:</p>
<div class="code"><pre class="code literal-block"><span class="n">In</span><span class="w"> </span><span class="p">[</span><span class="mi">7</span><span class="p">]:</span><span class="w"> </span><span class="n">a</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">7</span><span class="p">]:</span><span class="w"> </span>
<span class="w">    </span><span class="n">var1</span><span class="w">  </span><span class="n">var2</span>
<span class="mi">0</span><span class="w">  </span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="w">     </span><span class="mi">1</span>
<span class="mi">1</span><span class="w">  </span><span class="n">d</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">f</span><span class="w">     </span><span class="mi">2</span>

<span class="n">In</span><span class="w"> </span><span class="p">[</span><span class="mi">8</span><span class="p">]:</span><span class="w"> </span><span class="n">b</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">8</span><span class="p">]:</span><span class="w"> </span>
<span class="w">  </span><span class="n">var1</span><span class="w">  </span><span class="n">var2</span>
<span class="mi">0</span><span class="w">    </span><span class="n">a</span><span class="w">     </span><span class="mi">1</span>
<span class="mi">1</span><span class="w">    </span><span class="n">b</span><span class="w">     </span><span class="mi">1</span>
<span class="mi">2</span><span class="w">    </span><span class="n">c</span><span class="w">     </span><span class="mi">1</span>
<span class="mi">3</span><span class="w">    </span><span class="n">d</span><span class="w">     </span><span class="mi">2</span>
<span class="mi">4</span><span class="w">    </span><span class="n">e</span><span class="w">     </span><span class="mi">2</span>
<span class="mi">5</span><span class="w">    </span><span class="n">f</span><span class="w">     </span><span class="mi">2</span>
</pre></div>

<p>So far, I have tried various simple functions, but the <code>.apply</code> method seems
to only accept one row as return value when it is used on an axis, and I can't
get <code>.transform</code> to work. Any suggestions would be much appreciated!</p>
<p>Example data:</p>
<div class="code"><pre class="code literal-block"><span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">DataFrame</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">([{</span><span class="s1">'var1'</span><span class="p">:</span> <span class="s1">'a,b,c'</span><span class="p">,</span> <span class="s1">'var2'</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
               <span class="p">{</span><span class="s1">'var1'</span><span class="p">:</span> <span class="s1">'d,e,f'</span><span class="p">,</span> <span class="s1">'var2'</span><span class="p">:</span> <span class="mi">2</span><span class="p">}])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">([{</span><span class="s1">'var1'</span><span class="p">:</span> <span class="s1">'a'</span><span class="p">,</span> <span class="s1">'var2'</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
               <span class="p">{</span><span class="s1">'var1'</span><span class="p">:</span> <span class="s1">'b'</span><span class="p">,</span> <span class="s1">'var2'</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
               <span class="p">{</span><span class="s1">'var1'</span><span class="p">:</span> <span class="s1">'c'</span><span class="p">,</span> <span class="s1">'var2'</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
               <span class="p">{</span><span class="s1">'var1'</span><span class="p">:</span> <span class="s1">'d'</span><span class="p">,</span> <span class="s1">'var2'</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span>
               <span class="p">{</span><span class="s1">'var1'</span><span class="p">:</span> <span class="s1">'e'</span><span class="p">,</span> <span class="s1">'var2'</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span>
               <span class="p">{</span><span class="s1">'var1'</span><span class="p">:</span> <span class="s1">'f'</span><span class="p">,</span> <span class="s1">'var2'</span><span class="p">:</span> <span class="mi">2</span><span class="p">}])</span>
</pre></div>

<p>I know this won't work because we lose DataFrame meta-data by going through
numpy, but it should give you a sense of what I tried to do:</p>
<div class="code"><pre class="code literal-block"><span class="n">def</span><span class="w"> </span><span class="n">fun</span><span class="p">(</span><span class="k">row</span><span class="p">)</span><span class="err">:</span>
<span class="w">    </span><span class="n">letters</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">row</span><span class="o">[</span><span class="n">'var1'</span><span class="o">]</span>
<span class="w">    </span><span class="n">letters</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">letters</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s1">','</span><span class="p">)</span>
<span class="w">    </span><span class="k">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="k">array</span><span class="p">(</span><span class="o">[</span><span class="n">row</span><span class="o">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">letters</span><span class="p">))</span>
<span class="w">    </span><span class="k">out</span><span class="o">[</span><span class="n">'var1'</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">letters</span>
<span class="n">a</span><span class="o">[</span><span class="n">'idx'</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">range</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">shape</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="p">)</span>
<span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'idx'</span><span class="p">)</span>
<span class="n">z</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">fun</span><span class="p">)</span>
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<p>How about something like this:</p>
<div class="code"><pre class="code literal-block"><span class="n">In</span><span class="w"> </span><span class="p">[</span><span class="mi">55</span><span class="p">]:</span><span class="w"> </span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">Series</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">'var2'</span><span class="p">],</span><span class="w"> </span><span class="n">row</span><span class="p">[</span><span class="s1">'var1'</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">','</span><span class="p">))</span><span class="w">              </span>
<span class="w">                    </span><span class="k">for</span><span class="w"> </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">row</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="o">.</span><span class="n">iterrows</span><span class="p">()])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">55</span><span class="p">]:</span><span class="w"> </span>
<span class="w">  </span><span class="n">index</span><span class="w">  </span><span class="mi">0</span>
<span class="mi">0</span><span class="w">     </span><span class="n">a</span><span class="w">  </span><span class="mi">1</span>
<span class="mi">1</span><span class="w">     </span><span class="n">b</span><span class="w">  </span><span class="mi">1</span>
<span class="mi">2</span><span class="w">     </span><span class="n">c</span><span class="w">  </span><span class="mi">1</span>
<span class="mi">3</span><span class="w">     </span><span class="n">d</span><span class="w">  </span><span class="mi">2</span>
<span class="mi">4</span><span class="w">     </span><span class="n">e</span><span class="w">  </span><span class="mi">2</span>
<span class="mi">5</span><span class="w">     </span><span class="n">f</span><span class="w">  </span><span class="mi">2</span>
</pre></div>

<p>Then you just have to rename the columns</p>
<p><br></p>
<h3>Suggest</h3>
<p>After painful experimentation to find something faster than the accepted
answer, I got this to work. It ran around 100x faster on the dataset I tried
it on.</p>
<p>If someone knows a way to make this more elegant, by all means please modify
my code. I couldn't find a way that works without setting the other columns
you want to keep as the index and then resetting the index and re-naming the
columns, but I'd imagine there's something else that works.</p>
<div class="code"><pre class="code literal-block"><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DataFrame</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">var1</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">','</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span><span class="w"> </span><span class="n">index</span><span class="o">=</span><span class="n">a</span><span class="o">.</span><span class="n">var2</span><span class="p">)</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
<span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()[[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s1">'var2'</span><span class="p">]]</span><span class="w"> </span><span class="c1"># var1 variable is currently labeled 0</span>
<span class="n">b</span><span class="o">.</span><span class="n">columns</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">'var1'</span><span class="p">,</span><span class="w"> </span><span class="s1">'var2'</span><span class="p">]</span><span class="w"> </span><span class="c1"># renaming var1</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-do-you-generate-dynamic-parameterized-unit-tests-in-python/" class="u-url">How do you generate dynamic (parameterized) unit tests in Python?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-do-you-generate-dynamic-parameterized-unit-tests-in-python/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-05T13:21:31+08:00" itemprop="datePublished" title="2023-03-05 13:21">2023-03-05 13:21</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I have some kind of test data and want to create a unit test for each item. My
first idea was to do it like this:</p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="nn">unittest</span>

<span class="n">l</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">"foo"</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,],</span> <span class="p">[</span><span class="s2">"bar"</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">],</span> <span class="p">[</span><span class="s2">"lee"</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">]]</span>

<span class="k">class</span> <span class="nc">TestSequence</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">testsample</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="n">l</span><span class="p">:</span>
            <span class="nb">print</span> <span class="s2">"test"</span><span class="p">,</span> <span class="n">name</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
    <span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>
</pre></div>

<p>The downside of this is that it handles all data in one test. I would like to
generate one test for each item on the fly. Any suggestions?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>This is called "parametrization".</p>
<p>There are several tools that support this approach. E.g.:</p>
<ul>
<li>pytest's decorator</li>
<li>parameterized</li>
</ul>
<p>The resulting code looks like this:</p>
<div class="code"><pre class="code literal-block"><span class="kn">from</span> <span class="nn">parameterized</span> <span class="kn">import</span> <span class="n">parameterized</span>

<span class="k">class</span> <span class="nc">TestSequence</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="nd">@parameterized</span><span class="o">.</span><span class="n">expand</span><span class="p">([</span>
        <span class="p">[</span><span class="s2">"foo"</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,],</span>
        <span class="p">[</span><span class="s2">"bar"</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">"lee"</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">],</span>
    <span class="p">])</span>
    <span class="k">def</span> <span class="nf">test_sequence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
</pre></div>

<p>Which will generate the tests:</p>
<div class="code"><pre class="code literal-block"><span class="n">test_sequence_0_foo</span><span class="w"> </span><span class="p">(</span><span class="n">__main__</span><span class="o">.</span><span class="n">TestSequence</span><span class="p">)</span><span class="w"> </span><span class="o">...</span><span class="w"> </span><span class="n">ok</span>
<span class="n">test_sequence_1_bar</span><span class="w"> </span><span class="p">(</span><span class="n">__main__</span><span class="o">.</span><span class="n">TestSequence</span><span class="p">)</span><span class="w"> </span><span class="o">...</span><span class="w"> </span><span class="n">FAIL</span>
<span class="n">test_sequence_2_lee</span><span class="w"> </span><span class="p">(</span><span class="n">__main__</span><span class="o">.</span><span class="n">TestSequence</span><span class="p">)</span><span class="w"> </span><span class="o">...</span><span class="w"> </span><span class="n">ok</span>

<span class="o">======================================================================</span>
<span class="n">FAIL</span><span class="p">:</span><span class="w"> </span><span class="n">test_sequence_1_bar</span><span class="w"> </span><span class="p">(</span><span class="n">__main__</span><span class="o">.</span><span class="n">TestSequence</span><span class="p">)</span>
<span class="o">----------------------------------------------------------------------</span>
<span class="n">Traceback</span><span class="w"> </span><span class="p">(</span><span class="n">most</span><span class="w"> </span><span class="n">recent</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="n">last</span><span class="p">):</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s2">"/usr/local/lib/python2.7/site-packages/parameterized/parameterized.py"</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">233</span><span class="p">,</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="o">&lt;</span><span class="n">lambda</span><span class="o">&gt;</span>
<span class="w">    </span><span class="n">standalone_func</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lambda</span><span class="w"> </span><span class="o">*</span><span class="n">a</span><span class="p">:</span><span class="w"> </span><span class="k">func</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p</span><span class="o">.</span><span class="n">args</span><span class="p">),</span><span class="w"> </span><span class="o">**</span><span class="n">p</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s2">"x.py"</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">test_sequence</span>
<span class="w">    </span><span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
<span class="n">AssertionError</span><span class="p">:</span><span class="w"> </span><span class="s1">'a'</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s1">'b'</span>
</pre></div>

<p>For historical reasons I'll leave the original answer circa 2008):</p>
<p>I use something like this:</p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="nn">unittest</span>

<span class="n">l</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">"foo"</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,],</span> <span class="p">[</span><span class="s2">"bar"</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">],</span> <span class="p">[</span><span class="s2">"lee"</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">]]</span>

<span class="k">class</span> <span class="nc">TestSequense</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">def</span> <span class="nf">test_generator</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">test</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">l</span><span class="p">:</span>
        <span class="n">test_name</span> <span class="o">=</span> <span class="s1">'test_</span><span class="si">%s</span><span class="s1">'</span> <span class="o">%</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">test</span> <span class="o">=</span> <span class="n">test_generator</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="n">TestSequense</span><span class="p">,</span> <span class="n">test_name</span><span class="p">,</span> <span class="n">test</span><span class="p">)</span>
    <span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p><strong>Using unittest (since 3.4)</strong></p>
<p>Since Python 3.4, the standard library <code>unittest</code> package has the <code>subTest</code>
context manager.</p>
<p>See the documentation:</p>
<ul>
<li>26.4.7. Distinguishing test iterations using subtests</li>
<li>subTest</li>
</ul>
<p>Example:</p>
<div class="code"><pre class="code literal-block"><span class="kn">from</span> <span class="nn">unittest</span> <span class="kn">import</span> <span class="n">TestCase</span>

<span class="n">param_list</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">'a'</span><span class="p">,</span> <span class="s1">'a'</span><span class="p">),</span> <span class="p">(</span><span class="s1">'a'</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">),</span> <span class="p">(</span><span class="s1">'b'</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">)]</span>

<span class="k">class</span> <span class="nc">TestDemonstrateSubtest</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">test_works_as_expected</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="ow">in</span> <span class="n">param_list</span><span class="p">:</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">subTest</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span>
</pre></div>

<p>You can also specify a custom message and parameter values to <code>subTest()</code>:</p>
<div class="code"><pre class="code literal-block"><span class="nv">with</span><span class="w"> </span><span class="nv">self</span>.<span class="nv">subTest</span><span class="ss">(</span><span class="nv">msg</span><span class="o">=</span><span class="s2">"Checking if p1 equals p2"</span>,<span class="w"> </span><span class="nv">p1</span><span class="o">=</span><span class="nv">p1</span>,<span class="w"> </span><span class="nv">p2</span><span class="o">=</span><span class="nv">p2</span><span class="ss">)</span>:
</pre></div>

<p><strong>Using nose</strong></p>
<p>The nose testing framework supports this.</p>
<p>Example (the code below is the entire contents of the file containing the
test):</p>
<div class="code"><pre class="code literal-block"><span class="nv">param_list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>[<span class="ss">(</span><span class="s1">'a'</span>,<span class="w"> </span><span class="s1">'a'</span><span class="ss">)</span>,<span class="w"> </span><span class="ss">(</span><span class="s1">'a'</span>,<span class="w"> </span><span class="s1">'b'</span><span class="ss">)</span>,<span class="w"> </span><span class="ss">(</span><span class="s1">'b'</span>,<span class="w"> </span><span class="s1">'b'</span><span class="ss">)</span>]

<span class="nv">def</span><span class="w"> </span><span class="nv">test_generator</span><span class="ss">()</span>:
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nb">params</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">param_list</span>:
<span class="w">        </span><span class="nv">yield</span><span class="w"> </span><span class="nv">check_em</span>,<span class="w"> </span><span class="nb">params</span>[<span class="mi">0</span>],<span class="w"> </span><span class="nb">params</span>[<span class="mi">1</span>]

<span class="nv">def</span><span class="w"> </span><span class="nv">check_em</span><span class="ss">(</span><span class="nv">a</span>,<span class="w"> </span><span class="nv">b</span><span class="ss">)</span>:
<span class="w">    </span><span class="nv">assert</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nv">b</span>
</pre></div>

<p>The output of the nosetests command:</p>
<div class="code"><pre class="code literal-block">&gt; nosetests -v
testgen.test_generator('a', 'a') ... ok
testgen.test_generator('a', 'b') ... FAIL
testgen.test_generator('b', 'b') ... ok

======================================================================
FAIL: testgen.test_generator('a', 'b')
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/usr/lib/python2.5/site-packages/nose-0.10.1-py2.5.egg/nose/case.py", line 203, in runTest
    self.test(*self.arg)
  File "testgen.py", line 7, in check_em
    assert a == b
AssertionError

----------------------------------------------------------------------
Ran 3 tests in 0.006s

FAILED (failures=1)
</pre></div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-2728.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-2726.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
