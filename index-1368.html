<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 1368) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-1368.html">
<link rel="prev" href="index-1369.html" type="text/html">
<link rel="next" href="index-1367.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/continuous-output-in-neural-networks/" class="u-url">Continuous output in Neural Networks</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/continuous-output-in-neural-networks/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-28T02:35:04+08:00" itemprop="datePublished" title="2023-02-28 02:35">2023-02-28 02:35</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>How can I set Neural Networks so they accept and output a continuous range of
values instead of a discrete ones? From what I recall from doing a Neural
Network class a couple of years ago, the activation function would be a
sigmoid, which yields a value between 0 and 1. If I want my neural network to
yield a real valued scalar, what should I do? I thought maybe if I wanted a
value between 0 and 10 I could just multiply the value by 10? What if I have
negative values? Is this what people usually do or is there any other way?
What about the input?</p>
<p>Thanks</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Much of the work in the field of neuroevolution involves using neural networks
with continuous inputs and outputs.</p>
<p>There are several common approaches:</p>
<ul>
<li>
<strong>One node per value</strong><ul>
<li>
<strong>Linear activation functions</strong> - as others have noted, you can use non-sigmoid activation functions on output nodes if you are concerned about the limited range of sigmoid functions. However, this can cause your output to become arbitrarily large, which can cause problems during training.</li>
<li>
<strong>Sigmoid activation functions</strong> - simply scaling sigmoid output (or shifting and scaling, if you want negative values) is a common approach in neuroevolution. However, it is worth making sure that your sigmoid function isn't too steep: a steep activation function means that the "useful" range of values is small, which forces network weights to be small. <em>(This is mainly an issue with genetic algorithms, which use a fixed weight modification strategy that doesn't work well when small weights are desired.)</em>
</li>
</ul>
</li>
</ul>
<p><img alt="regular sigmoid" src="images/UBEfv.gif"><br>
(source: natekohl.net)<br><img alt="steep sigmoid" src="images/jHYnJ.gif"><br>
(source: natekohl.net)</p>
<ul>
<li>
<strong>Multiple nodes per value</strong> - spreading a single continuous value over multiple nodes is a common strategy for representing continuous inputs. It has the benefit of providing more "features" for a network to play with, at the cost of increasing network size. <ul>
<li>
<strong>Binning</strong> - spread a single input over multiple nodes (e.g. RBF networks, where each node is a basis function with a different center that will be partially activated by the input). You get some of the benefits of discrete inputs without losing a smooth representation. </li>
<li>
<strong>Binary representation</strong> - divide a single continuous value into 2N chunks, then feed that value into the network as a binary pattern to N nodes. This approach is compact, but kind of brittle and results in input that changes in a non-continuous manner.</li>
</ul>
</li>
</ul>
<p><br></p>
<h3>Suggest</h3>
<p><strong>There are no rules which require the output ( * ) to be any particular
function</strong>. In fact we typically need to <em>add</em> some arithmetic operations at
the end of the function per-se implemented in a given node, in order to scale
and otherwise coerce the output to a particular form.</p>
<p>The advantage of working with all-or-nothing outputs and/or 0.0 to 1.0
normalized output is that it makes things more easily tractable, and also
avoid issues of overflowing and such.</p>
<p>( * ) "Output" can be understood here as either the ouptut a given node
(neuron) within the network or that of the network as a whole.<br>
As indicated by Mark Bessey the input [to the network as a whole] and the
output [of the network] typically receive some filtering/conversion. As hinted
in this response and in Mark's comment, it may be preferable to have
normalized/standard nodes in the "hidden" layers of the network, and apply
some normalization/conversion/discretization as required for the input and/or
for the output of the network; Such practice is however only a matter of
practicality rather than an imperative requirement of Neural Networks in
general.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/batch-normalization-instead-of-input-normalization/" class="u-url">Batch normalization instead of input normalization</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/batch-normalization-instead-of-input-normalization/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-28T02:34:36+08:00" itemprop="datePublished" title="2023-02-28 02:34">2023-02-28 02:34</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Can I use batch normalization layer right after input layer and not normalize
my data? May I expect to get similar effect/performance?</p>
<p>In keras functional it would be something like this:</p>
<div class="code"><pre class="code literal-block">x = Input (...)
x = Batchnorm(...)(x)
...
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<p>You can do it. But the nice thing about batchnorm, in addition to activation
distribution stabilization, is that the mean and std deviation are likely
migrate as the network learns.</p>
<p>Effectively, setting the batchnorm right after the input layer is a fancy
<em>data pre-processing</em> step. It helps, sometimes a lot (e.g. in linear
regression). But it's easier and more efficient to compute the mean and
variance of the whole training sample once, than learn it per-batch. Note that
batchnorm isn't free in terms of performance and you shouldn't abuse it.</p>
<hr>
</div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/quadrilateral-shape-finding-algorithm/" class="u-url">Quadrilateral Shape Finding Algorithm</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/quadrilateral-shape-finding-algorithm/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-28T02:34:04+08:00" itemprop="datePublished" title="2023-02-28 02:34">2023-02-28 02:34</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I want to detect and <strong>COMPLETE</strong> all possible quadrilateral shapes from
randomly located line segments!</p>
<p>The photo attached is an example, the lines might always appear in very
different locations.</p>
<p>Anyone can point out any good algorithm for this?</p>
<ul>
<li>note the line segments are the output of Hough transform using opencv 2.4.2</li>
</ul>
<p><img alt="enter image description here" src="images/mbs2i.jpg"></p>
<p>The solution is to <strong>detect</strong> and <strong>predict</strong> the yellow quadrilateral</p>
<p><img alt="enter image description here" src="images/3quuY.jpg"></p>
<p><br><br></p>
<h2>Answer</h2>
<p>In the case of 11 line segments, you have 330 ways of choosing four segments.
You could determine the likelihood of each combination making a quadrilateral,
and grade that way.</p>
<p>It is possible to have a Hough transform detect forms other than lines, though
it becomes harder to visualise as the accumulator space would require more
than two dimensions. Circles can be found in three dimensions (midX, midY,
radius), ellipses in four (I believe). I'm not sure exactly how few parameters
you'd need to model a quadrilateral, and I believe that the performance of the
Hough transform starts to drop off when you get higher than three dimensions.
The accumulator space becomes so large that the noise ratio increases
significantly.</p>
<p>Here's a related question that may have some interesting answers for you.</p>
<p>Let us know how you get on!</p>
<hr>
<h3>EDIT</h3>
<p>I took a stab at this problem today, and uploaded my solution to GitHub. There
is too much code to post here.</p>
<p>Here's a screenshot showing the output:</p>
<p><img alt="" src="https://raw.github.com/drewnoakes/quadrilateral-%0Afinder/master/screenshot.png"></p>
<p>The solution I took is basically what I described above before this edit.</p>
<ol>
<li>Find all combinations of four lines</li>
<li>Find all permutations of those four lines</li>
<li>Evaluate the likelihood that those four lines form a quadrilateral</li>
<li>Take the best match</li>
</ol>
<p>The evaluation works by calculating a crude error score. This is the sum of
two different types of error:</p>
<ol>
<li>The deviation at each corner from 90 degrees (I use the sum of squared errors across all four corners)</li>
<li>When the line segments intersect within the line segment, it's likely not a valid corner</li>
</ol>
<p>The second type of error could possibly be determined in a more robust way. It
was necessary to find a solution for your sample data set.</p>
<p>I haven't experimented with other data sets. It may need some tweaking to make
it more robust. I have tried to avoid using too many parameters so that it
should be straightforward to adjust to a particular environment. For example
to control sensitivity to occlusion, as seen in your sample image.</p>
<p>It finds the solution in about 160ms on my laptop. However I haven't made any
performance optimisations. I expect that the methods of finding
combinations/permutations could be significantly optimised if you needed this
to run closer to real-time, as is often the case with computer vision
experiments.</p>
<p><br></p>
<h3>Suggest</h3>
<p>About any four lines can be completed to form a quadrilateral if you don't
impose constraints on angles etc.</p>
<p><em>Image with potentially wrong quadrilaterals:</em> <img alt="enter image description
here" src="images/ix2iq.png"></p>
<p>Probably you don't want to include quadrilaterals like the yellow one shown in
my example. You should have constraints on angles, minimum/maximum size,
aspect ratio and the degree of completion allowed. If 90 percent of the lines
have to be added in order to form a complete quadrilateral this would probably
not be a very good candidate.</p>
<p>I fear that you will have to test every possible combination of lines and
apply a heuristic on them to give them points. Many points for angles close to
90 degrees (if what you want are rectangles), for completeness, for aspect
ratios close to the expected one etc.</p>
<hr>
<p><strong>UPDATE</strong></p>
<p>Using a point system has advantages over just applying strict rules.</p>
<ul>
<li>A point system allows you to evaluate the quality of quadrilaterals and to take the best one or to reject a quadrilateral completely.</li>
<li>The good quality of one property can help outweigh the poor quality of another one.</li>
<li>It allows you to give different weights to different properties.</li>
</ul>
<p>Let's say you have a strict rule (in pseudo code):</p>
<div class="code"><pre class="code literal-block">(angles == 90 +/- 10 degrees) &amp;&amp; (line_completeness&gt;50%)
</pre></div>

<p>This would work, can however lead to situations like <code>angles == 90 +/- 1
degree) &amp;&amp; (line_completeness == 45%)</code>. According to the rules this
quadrilateral would not pass because of the poor line completeness; however,
the quality of the angles is exceptional, still making it a very good
candidate.</p>
<p>It is better to give points. Say 20 points for an angle of exactly 90 degrees,
falling to 0 points for an angle of 90 +/-15 degrees and 10 points for
complete lines towards 0 points for lines complete by only 25% for instance.
This makes angles more important than line completeness and also creates
softer conditions for a problem that does not have absolute rules.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-1369.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-1367.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
