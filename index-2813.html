<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 2813) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-2813.html">
<link rel="prev" href="index-2814.html" type="text/html">
<link rel="next" href="index-2812.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-sum-up-elements-of-a-c-vector/" class="u-url">How to sum up elements of a C++ vector?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-sum-up-elements-of-a-c-vector/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-05T19:51:58+08:00" itemprop="datePublished" title="2023-03-05 19:51">2023-03-05 19:51</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>What are the <em>good</em> ways of finding the sum of all the elements in a
<code>std::vector</code>?</p>
<p>Suppose I have a vector <code>std::vector&lt;int&gt; vector</code> with a few elements in it.
Now I want to find the sum of all the elements. What are the different ways
for the same?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Actually there are quite a few methods.</p>
<div class="code"><pre class="code literal-block">int sum_of_elems = 0;
</pre></div>

<h3>C++03</h3>
<ol>
<li>
<p>Classic for loop:</p>
<div class="code"><pre class="code literal-block"><span class="w"> </span><span class="nt">for</span><span class="o">(</span><span class="nt">std</span><span class="p">::</span><span class="nd">vector</span><span class="o">&lt;</span><span class="nt">int</span><span class="o">&gt;</span><span class="p">::</span><span class="nd">iterator</span><span class="w"> </span><span class="nt">it</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">vector</span><span class="p">.</span><span class="nc">begin</span><span class="o">();</span><span class="w"> </span><span class="nt">it</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nt">vector</span><span class="p">.</span><span class="nc">end</span><span class="o">();</span><span class="w"> </span><span class="o">++</span><span class="nt">it</span><span class="o">)</span>
<span class="w"> </span><span class="nt">sum_of_elems</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="o">*</span><span class="nt">it</span><span class="o">;</span>
</pre></div>

</li>
<li>
<p>Using a standard algorithm:</p>
<div class="code"><pre class="code literal-block"><span class="w"> </span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;numeric&gt;</span>
</pre></div>

<p>sum_of_elems = std::accumulate(vector.begin(), vector.end(), 0);</p>
</li>
</ol>
<p><strong>Important Note:</strong> The last argument's type is used not just for the initial
value, but for <em>the type of the result</em> as well. If you put an int there, it
will accumulate ints even if the vector has float. If you are summing
floating-point numbers, change <code>0</code> to <code>0.0</code> or <code>0.0f</code> (thanks to nneonneo).
See also the C++11 solution below.</p>
<h3>C++11 and higher</h3>
<ol>
<li>
<p>b. Automatically keeping track of the vector type even in case of future changes:</p>
<div class="code"><pre class="code literal-block"><span class="w"> </span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;numeric&gt;</span>
</pre></div>

<p>sum_of_elems = std::accumulate(vector.begin(), vector.end(),
                                decltype(vector)::value_type(0));</p>
</li>
<li>
<p>Using <code>std::for_each</code>:</p>
<div class="code"><pre class="code literal-block"><span class="w"> </span><span class="nt">std</span><span class="p">::</span><span class="nd">for_each</span><span class="o">(</span><span class="nt">vector</span><span class="p">.</span><span class="nc">begin</span><span class="o">(),</span><span class="w"> </span><span class="nt">vector</span><span class="p">.</span><span class="nc">end</span><span class="o">(),</span><span class="w"> </span><span class="cp">[</span><span class="o">&amp;</span><span class="cp">]</span><span class="w"> </span><span class="o">(</span><span class="nt">int</span><span class="w"> </span><span class="nt">n</span><span class="o">)</span><span class="w"> </span><span class="p">{</span>
<span class="w"> </span><span class="err">sum_of_elems</span><span class="w"> </span><span class="err">+=</span><span class="w"> </span><span class="err">n</span><span class="p">;</span>
</pre></div>

<p>});</p>
</li>
<li>
<p>Using a range-based for loop (thanks to Roger Pate):</p>
<div class="code"><pre class="code literal-block"><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="ss">(</span><span class="nv">auto</span><span class="o">&amp;</span><span class="w"> </span><span class="nv">n</span><span class="w"> </span>:<span class="w"> </span><span class="nv">vector</span><span class="ss">)</span>
<span class="w"> </span><span class="nv">sum_of_elems</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nv">n</span><span class="c1">;</span>
</pre></div>

</li>
</ol>
<h3>C++17 and above</h3>
<ol>
<li>Using <code>std::reduce</code> which also takes care of the result type, e.g if you have <code>std::vector&lt;int&gt;</code>, you get <code>int</code> as result. If you have <code>std::vector&lt;float&gt;</code>, you get <code>float</code>. Or if you have <code>std::vector&lt;std::string&gt;</code>, you get <code>std::string</code> (all strings concatenated). Interesting, isn't it?<div class="code"><pre class="code literal-block"><span class="nt">auto</span><span class="w"> </span><span class="nt">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">std</span><span class="p">::</span><span class="nd">reduce</span><span class="o">(</span><span class="nt">v</span><span class="p">.</span><span class="nc">begin</span><span class="o">(),</span><span class="w"> </span><span class="nt">v</span><span class="p">.</span><span class="nc">end</span><span class="o">());</span>
</pre></div>

</li>
</ol>
<p>There are other overloads of this function which you can run even parallelly,
in case if you have a large collection and you want to get the result quickly.</p>
<p><br></p>
<h3>Suggest</h3>
<p>The easiest way is to use <code>std:accumulate</code> of a <code>vector&lt;int&gt; A</code>:</p>
<div class="code"><pre class="code literal-block"><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;numeric&gt;</span>
<span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">accumulate</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="nf">begin</span><span class="p">(),</span><span class="w"> </span><span class="n">A</span><span class="p">.</span><span class="nf">end</span><span class="p">(),</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/difference-between-pre-increment-and-post-increment-in-a-loop/" class="u-url">Difference between pre-increment and post-increment in a loop?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/difference-between-pre-increment-and-post-increment-in-a-loop/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-05T19:50:27+08:00" itemprop="datePublished" title="2023-03-05 19:50">2023-03-05 19:50</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Is there a difference in <code>++i</code> and <code>i++</code> in a <code>for</code> loop? Is it simply a
syntax thing?</p>
<p><br><br></p>
<h2>Answer</h2>
<p><strong>a++ is known as postfix.</strong></p>
<p>add 1 to a, returns the old value.</p>
<p><strong>++a is known as prefix.</strong></p>
<p>add 1 to a, returns the new value.</p>
<p>C#:</p>
<div class="code"><pre class="code literal-block">string[] items = {"a","b","c","d"};
int i = 0;
foreach (string item in items)
{
    Console.WriteLine(++i);
}
Console.WriteLine("");

i = 0;
foreach (string item in items)
{
    Console.WriteLine(i++);
}
</pre></div>

<p>Output:</p>
<div class="code"><pre class="code literal-block"><span class="mf">1</span>
<span class="mf">2</span>
<span class="mf">3</span>
<span class="mf">4</span>

<span class="mf">0</span>
<span class="mf">1</span>
<span class="mf">2</span>
<span class="mf">3</span>
</pre></div>

<p><code>foreach</code> and <code>while</code> loops depend on which increment type you use. With for
loops like below it makes no difference as you're not using the return value
of i:</p>
<div class="code"><pre class="code literal-block"><span class="k">for</span><span class="w"> </span><span class="ss">(</span><span class="nv">int</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="c1">; i &lt; 5; i++) { Console.Write(i);}</span>
<span class="nv">Console</span>.<span class="nv">WriteLine</span><span class="ss">(</span><span class="s2">""</span><span class="ss">)</span><span class="c1">;</span>
<span class="k">for</span><span class="w"> </span><span class="ss">(</span><span class="nv">int</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="c1">; i &lt; 5; ++i) { Console.Write(i); }</span>
</pre></div>

<blockquote>
<p>0 1 2 3 4<br>
 0 1 2 3 4</p>
</blockquote>
<p>If the value as evaluated is used then the type of increment becomes
significant:</p>
<div class="code"><pre class="code literal-block"><span class="nv">int</span><span class="w"> </span><span class="nv">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="c1">;</span>
<span class="k">for</span><span class="w"> </span><span class="ss">(</span><span class="nv">int</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="c1">; n &lt; 5; n = i++) { }</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p><strong>Pre-increment ++i</strong> increments the value of i and evaluates to the new
incremented value.</p>
<div class="code"><pre class="code literal-block">int i = 3;
int preIncrementResult = ++i;
Assert( preIncrementResult == 4 );
Assert( i == 4 );
</pre></div>

<p><strong>Post-increment i++</strong> increments the value of i and evaluates to the original
non-incremented value.</p>
<div class="code"><pre class="code literal-block">int i = 3;
int postIncrementResult = i++;
Assert( postIncrementtResult == 3 );
Assert( i == 4 );
</pre></div>

<hr>
<p>In C++, the pre-increment is usually preferred where you can use either.</p>
<p>This is because if you use post-increment, it can require the compiler to have
to generate code that creates an extra temporary variable. This is because
both the previous and new values of the variable being incremented need to be
held somewhere because they may be needed elsewhere in the expression being
evaluated.</p>
<p>So, in C++ at least, there can be a performance difference which guides your
choice of which to use.</p>
<p>This is mainly only a problem when the variable being incremented is a user
defined type with an overridden ++ operator. For primitive types (int, etc)
there's no performance difference. But, it's worth sticking to the pre-
increment operator as a guideline unless the post-increment operator is
definitely what's required.</p>
<p>There's some more discussion here.</p>
<p>In C++ if you're using STL, then you may be using for loops with iterators.
These mainly have overridden ++ operators, so sticking to pre-increment is a
good idea. Compilers get smarter all the time though, and newer ones may be
able to perform optimizations that mean there's no performance difference -
especially if the type being incremented is defined inline in header file (as
STL implementations often are) so that the compiler can see how the method is
implemented and can then know what optimizations are safe to perform. Even so,
it's probably still worth sticking to pre-increment because loops get executed
lots of times and this means a small performance penalty could soon get
amplified.</p>
<hr>
<p>In other languages such as C# where the ++ operator can't be overloaded there
is no performance difference. Used in a loop to advance the loop variable, the
pre and post increment operators are equivalent.</p>
<p>Correction: overloading ++ in C# is allowed. It seems though, that compared to
C++, in C# you cannot overload the pre and post versions independently. So, I
would assume that if the result of calling ++ in C# is not assigned to a
variable or used as part of a complex expression, then the compiler would
reduce the pre and post versions of ++ down to code that performs
equivalently.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-make-a-simple-c-makefile/" class="u-url">How to make a SIMPLE C++ Makefile</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-make-a-simple-c-makefile/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-05T19:48:44+08:00" itemprop="datePublished" title="2023-03-05 19:48">2023-03-05 19:48</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>We are required to use a Makefile to pull everything together for our project,
but our professor never showed us how to.</p>
<p>I only have <em>one</em> file, <code>a3driver.cpp</code>. The driver imports a class from a
location, <code>"/user/cse232/Examples/example32.sequence.cpp"</code>.</p>
<p>That's it. Everything else is contained with the <code>.cpp</code>.</p>
<p>How would I go about making a simple Makefile that creates an executable
called <code>a3a.exe</code>?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Since this is for Unix, the executables don't have any extensions.</p>
<p>One thing to note is that <code>root-config</code> is a utility which provides the right
compilation and linking flags; and the right libraries for building
applications against root. That's just a detail related to the original
audience for this document.</p>
<h3>Make Me Baby</h3>
<p><strong>or You Never Forget The First Time You Got Made</strong></p>
<p>An introductory discussion of make, and how to write a simple makefile</p>
<p><strong>What is Make? And Why Should I Care?</strong></p>
<p>The tool called Make is a build dependency manager. That is, it takes care of
knowing what commands need to be executed in what order to take your software
project from a collection of source files, object files, libraries, headers,
etc., etc.---some of which may have changed recently---and turning them into a
correct up-to-date version of the program.</p>
<p>Actually, you can use Make for other things too, but I'm not going to talk
about that.</p>
<p><strong>A Trivial Makefile</strong></p>
<p>Suppose that you have a directory containing: <code>tool</code> <code>tool.cc</code> <code>tool.o</code>
<code>support.cc</code> <code>support.hh</code>, and <code>support.o</code> which depend on <code>root</code> and are
supposed to be compiled into a program called <code>tool</code>, and suppose that you've
been hacking on the source files (which means the existing <code>tool</code> is now out
of date) and want to compile the program.</p>
<p>To do this yourself you could</p>
<ol>
<li>
<p>Check if either <code>support.cc</code> or <code>support.hh</code> is newer than <code>support.o</code>, and if so run a command like</p>
<div class="code"><pre class="code literal-block"><span class="nv">g</span><span class="o">++</span><span class="w"> </span><span class="o">-</span><span class="nv">g</span><span class="w"> </span><span class="o">-</span><span class="nv">c</span><span class="w"> </span><span class="o">-</span><span class="nv">pthread</span><span class="w"> </span><span class="o">-</span><span class="nv">I</span><span class="o">/</span><span class="nv">sw</span><span class="o">/</span><span class="k">include</span><span class="o">/</span><span class="nv">root</span><span class="w"> </span><span class="nv">support</span>.<span class="nv">cc</span>
</pre></div>

</li>
<li>
<p>Check if either <code>support.hh</code> or <code>tool.cc</code> are newer than <code>tool.o</code>, and if so run a command like</p>
<div class="code"><pre class="code literal-block"><span class="n">g</span><span class="o">++</span><span class="w"> </span><span class="o">-</span><span class="n">g</span><span class="w">  </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="o">-</span><span class="n">pthread</span><span class="w"> </span><span class="o">-</span><span class="n">I</span><span class="o">/</span><span class="n">sw</span><span class="o">/</span><span class="n">include</span><span class="o">/</span><span class="n">root</span><span class="w"> </span><span class="k">tool</span><span class="o">.</span><span class="n">cc</span>
</pre></div>

</li>
<li>
<p>Check if <code>tool.o</code> is newer than <code>tool</code>, and if so run a command like</p>
<div class="code"><pre class="code literal-block"><span class="n">g</span><span class="o">++</span><span class="w"> </span><span class="o">-</span><span class="n">g</span><span class="w"> </span><span class="k">tool</span><span class="o">.</span><span class="n">o</span><span class="w"> </span><span class="n">support</span><span class="o">.</span><span class="n">o</span><span class="w"> </span><span class="o">-</span><span class="n">L</span><span class="o">/</span><span class="n">sw</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="n">lCore</span><span class="w"> </span><span class="o">-</span><span class="n">lCint</span><span class="w"> </span><span class="o">-</span><span class="n">lRIO</span><span class="w"> </span><span class="o">-</span><span class="n">lNet</span><span class="w"> </span><span class="o">-</span><span class="n">lHist</span><span class="w"> </span><span class="o">-</span><span class="n">lGraf</span><span class="w"> </span><span class="o">-</span><span class="n">lGraf3d</span><span class="w"> </span><span class="o">-</span><span class="n">lGpad</span><span class="w"> </span><span class="o">-</span><span class="n">lTree</span><span class="w"> </span><span class="o">-</span><span class="n">lRint</span><span class="w"> </span>\
</pre></div>

<p>-lPostscript -lMatrix -lPhysics -lMathCore -lThread -lz -L/sw/lib -lfreetype -lz -Wl,-framework,CoreServices \
-Wl,-framework,ApplicationServices -pthread -Wl,-rpath,/sw/lib/root -lm -ldl</p>
</li>
</ol>
<p>Phew! What a hassle! There is a lot to remember and several chances to make
mistakes. (BTW-- the particulars of the command lines exhibited here depend on
our software environment. These ones work on my computer.)</p>
<p>Of course, you could just run all three commands every time. That would work,
but it doesn't scale well to a substantial piece of software (like DOGS which
takes more than 15 minutes to compile from the ground up on my MacBook).</p>
<p>Instead you could write a file called <code>makefile</code> like this:</p>
<div class="code"><pre class="code literal-block"><span class="n">tool</span><span class="o">:</span><span class="w"> </span><span class="n">tool</span><span class="o">.</span><span class="na">o</span><span class="w"> </span><span class="n">support</span><span class="o">.</span><span class="na">o</span>
<span class="w">    </span><span class="n">g</span><span class="o">++</span><span class="w"> </span><span class="o">-</span><span class="n">g</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">tool</span><span class="w"> </span><span class="n">tool</span><span class="o">.</span><span class="na">o</span><span class="w"> </span><span class="n">support</span><span class="o">.</span><span class="na">o</span><span class="w"> </span><span class="o">-</span><span class="n">L</span><span class="sr">/sw/lib/root -lCore -lCint -lRIO -lNet -lHist -lGraf -lGraf3d -lGpad -lTree -lRint \</span>
<span class="sr">        -lPostscript -lMatrix -lPhysics -lMathCore -lThread -lz -L/sw/lib -lfreetype -lz -Wl,-framework,CoreServices \</span>
<span class="sr">        -Wl,-framework,ApplicationServices -pthread -Wl,-rpath,/sw/lib/</span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="n">lm</span><span class="w"> </span><span class="o">-</span><span class="n">ldl</span>

<span class="n">tool</span><span class="o">.</span><span class="na">o</span><span class="o">:</span><span class="w"> </span><span class="n">tool</span><span class="o">.</span><span class="na">cc</span><span class="w"> </span><span class="n">support</span><span class="o">.</span><span class="na">hh</span>
<span class="w">    </span><span class="n">g</span><span class="o">++</span><span class="w"> </span><span class="o">-</span><span class="n">g</span><span class="w">  </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="o">-</span><span class="n">pthread</span><span class="w"> </span><span class="o">-</span><span class="n">I</span><span class="sr">/sw/include/</span><span class="n">root</span><span class="w"> </span><span class="n">tool</span><span class="o">.</span><span class="na">cc</span>

<span class="n">support</span><span class="o">.</span><span class="na">o</span><span class="o">:</span><span class="w"> </span><span class="n">support</span><span class="o">.</span><span class="na">hh</span><span class="w"> </span><span class="n">support</span><span class="o">.</span><span class="na">cc</span>
<span class="w">    </span><span class="n">g</span><span class="o">++</span><span class="w"> </span><span class="o">-</span><span class="n">g</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="o">-</span><span class="n">pthread</span><span class="w"> </span><span class="o">-</span><span class="n">I</span><span class="sr">/sw/include/</span><span class="n">root</span><span class="w"> </span><span class="n">support</span><span class="o">.</span><span class="na">cc</span>
</pre></div>

<p>and just type <code>make</code> at the command line. Which will perform the three steps
shown above automatically.</p>
<p>The unindented lines here have the form <em>"target: dependencies"</em> and tell Make
that the associated commands (indented lines) should be run if any of the
dependencies are newer than the target. That is, the dependency lines describe
the logic of what needs to be rebuilt to accommodate changes in various files.
If <code>support.cc</code> changes that means that <code>support.o</code> must be rebuilt, but
<code>tool.o</code> can be left alone. When <code>support.o</code> changes <code>tool</code> must be rebuilt.</p>
<p>The commands associated with each dependency line are set off with a tab (see
below) should modify the target (or at least touch it to update the
modification time).</p>
<h3>Variables, Built In Rules, and Other Goodies</h3>
<p>At this point, our makefile is simply remembering the work that needs doing,
but we still had to figure out and type each and every needed command in its
entirety. It does not have to be that way: Make is a powerful language with
variables, text manipulation functions, and a whole slew of built-in rules
which can make this much easier for us.</p>
<p><strong>Make Variables</strong></p>
<p>The syntax for accessing a make variable is <code>$(VAR)</code>.</p>
<p>The syntax for assigning to a Make variable is: <code>VAR = A text value of some
kind</code> (or <code>VAR := A different text value but ignore this for the moment</code>).</p>
<p>You can use variables in rules like this improved version of our makefile:</p>
<div class="code"><pre class="code literal-block"><span class="n">CPPFLAGS</span><span class="o">=-</span><span class="n">g</span><span class="w"> </span><span class="o">-</span><span class="n">pthread</span><span class="w"> </span><span class="o">-</span><span class="n">I</span><span class="o">/</span><span class="n">sw</span><span class="o">/</span><span class="n">include</span><span class="o">/</span><span class="n">root</span>
<span class="n">LDFLAGS</span><span class="o">=-</span><span class="n">g</span>
<span class="n">LDLIBS</span><span class="o">=-</span><span class="n">L</span><span class="o">/</span><span class="n">sw</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="n">lCore</span><span class="w"> </span><span class="o">-</span><span class="n">lCint</span><span class="w"> </span><span class="o">-</span><span class="n">lRIO</span><span class="w"> </span><span class="o">-</span><span class="n">lNet</span><span class="w"> </span><span class="o">-</span><span class="n">lHist</span><span class="w"> </span><span class="o">-</span><span class="n">lGraf</span><span class="w"> </span><span class="o">-</span><span class="n">lGraf3d</span><span class="w"> </span><span class="o">-</span><span class="n">lGpad</span><span class="w"> </span><span class="o">-</span><span class="n">lTree</span><span class="w"> </span><span class="o">-</span><span class="n">lRint</span><span class="w"> </span>\
<span class="w">       </span><span class="o">-</span><span class="n">lPostscript</span><span class="w"> </span><span class="o">-</span><span class="n">lMatrix</span><span class="w"> </span><span class="o">-</span><span class="n">lPhysics</span><span class="w"> </span><span class="o">-</span><span class="n">lMathCore</span><span class="w"> </span><span class="o">-</span><span class="n">lThread</span><span class="w"> </span><span class="o">-</span><span class="n">lz</span><span class="w"> </span><span class="o">-</span><span class="n">L</span><span class="o">/</span><span class="n">sw</span><span class="o">/</span><span class="n">lib</span><span class="w"> </span><span class="o">-</span><span class="n">lfreetype</span><span class="w"> </span><span class="o">-</span><span class="n">lz</span><span class="w"> </span>\
<span class="w">       </span><span class="o">-</span><span class="n">Wl</span><span class="p">,</span><span class="o">-</span><span class="n">framework</span><span class="p">,</span><span class="n">CoreServices</span><span class="w"> </span><span class="o">-</span><span class="n">Wl</span><span class="p">,</span><span class="o">-</span><span class="n">framework</span><span class="p">,</span><span class="n">ApplicationServices</span><span class="w"> </span><span class="o">-</span><span class="n">pthread</span><span class="w"> </span><span class="o">-</span><span class="n">Wl</span><span class="p">,</span><span class="o">-</span><span class="n">rpath</span><span class="p">,</span><span class="o">/</span><span class="n">sw</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">root</span><span class="w"> </span>\
<span class="w">       </span><span class="o">-</span><span class="n">lm</span><span class="w"> </span><span class="o">-</span><span class="n">ldl</span>

<span class="k">tool</span><span class="p">:</span><span class="w"> </span><span class="k">tool</span><span class="o">.</span><span class="n">o</span><span class="w"> </span><span class="n">support</span><span class="o">.</span><span class="n">o</span>
<span class="w">    </span><span class="n">g</span><span class="o">++</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">LDFLAGS</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="k">tool</span><span class="w"> </span><span class="k">tool</span><span class="o">.</span><span class="n">o</span><span class="w"> </span><span class="n">support</span><span class="o">.</span><span class="n">o</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">LDLIBS</span><span class="p">)</span>

<span class="k">tool</span><span class="o">.</span><span class="n">o</span><span class="p">:</span><span class="w"> </span><span class="k">tool</span><span class="o">.</span><span class="n">cc</span><span class="w"> </span><span class="n">support</span><span class="o">.</span><span class="n">hh</span>
<span class="w">    </span><span class="n">g</span><span class="o">++</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">CPPFLAGS</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="k">tool</span><span class="o">.</span><span class="n">cc</span>

<span class="n">support</span><span class="o">.</span><span class="n">o</span><span class="p">:</span><span class="w"> </span><span class="n">support</span><span class="o">.</span><span class="n">hh</span><span class="w"> </span><span class="n">support</span><span class="o">.</span><span class="n">cc</span>
<span class="w">    </span><span class="n">g</span><span class="o">++</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">CPPFLAGS</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="n">support</span><span class="o">.</span><span class="n">cc</span>
</pre></div>

<p>which is a little more readable, but still requires a lot of typing</p>
<p><strong>Make Functions</strong></p>
<p>GNU make supports a variety of functions for accessing information from the
filesystem or other commands on the system. In this case we are interested in
<code>$(shell ...)</code> which expands to the output of the argument(s), and <code>$(subst
opat,npat,text)</code> which replaces all instances of <code>opat</code> with <code>npat</code> in text.</p>
<p>Taking advantage of this gives us:</p>
<div class="code"><pre class="code literal-block"><span class="n">CPPFLAGS</span><span class="o">=-</span><span class="n">g</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">shell</span><span class="w"> </span><span class="n">root</span><span class="o">-</span><span class="n">config</span><span class="w"> </span><span class="o">--</span><span class="n">cflags</span><span class="p">)</span>
<span class="n">LDFLAGS</span><span class="o">=-</span><span class="n">g</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">shell</span><span class="w"> </span><span class="n">root</span><span class="o">-</span><span class="n">config</span><span class="w"> </span><span class="o">--</span><span class="n">ldflags</span><span class="p">)</span>
<span class="n">LDLIBS</span><span class="o">=$</span><span class="p">(</span><span class="n">shell</span><span class="w"> </span><span class="n">root</span><span class="o">-</span><span class="n">config</span><span class="w"> </span><span class="o">--</span><span class="n">libs</span><span class="p">)</span>

<span class="n">SRCS</span><span class="o">=</span><span class="k">tool</span><span class="o">.</span><span class="n">cc</span><span class="w"> </span><span class="n">support</span><span class="o">.</span><span class="n">cc</span>
<span class="n">OBJS</span><span class="o">=$</span><span class="p">(</span><span class="n">subst</span><span class="w"> </span><span class="o">.</span><span class="n">cc</span><span class="p">,</span><span class="o">.</span><span class="n">o</span><span class="p">,</span><span class="o">$</span><span class="p">(</span><span class="n">SRCS</span><span class="p">))</span>

<span class="k">tool</span><span class="p">:</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">OBJS</span><span class="p">)</span>
<span class="w">    </span><span class="n">g</span><span class="o">++</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">LDFLAGS</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="k">tool</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">OBJS</span><span class="p">)</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">LDLIBS</span><span class="p">)</span>

<span class="k">tool</span><span class="o">.</span><span class="n">o</span><span class="p">:</span><span class="w"> </span><span class="k">tool</span><span class="o">.</span><span class="n">cc</span><span class="w"> </span><span class="n">support</span><span class="o">.</span><span class="n">hh</span>
<span class="w">    </span><span class="n">g</span><span class="o">++</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">CPPFLAGS</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="k">tool</span><span class="o">.</span><span class="n">cc</span>

<span class="n">support</span><span class="o">.</span><span class="n">o</span><span class="p">:</span><span class="w"> </span><span class="n">support</span><span class="o">.</span><span class="n">hh</span><span class="w"> </span><span class="n">support</span><span class="o">.</span><span class="n">cc</span>
<span class="w">    </span><span class="n">g</span><span class="o">++</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">CPPFLAGS</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="n">support</span><span class="o">.</span><span class="n">cc</span>
</pre></div>

<p>which is easier to type and much more readable.</p>
<p>Notice that</p>
<ol>
<li>We are still stating explicitly the dependencies for each object file and the final executable</li>
<li>We've had to explicitly type the compilation rule for both source files</li>
</ol>
<p><strong>Implicit and Pattern Rules</strong></p>
<p>We would generally expect that all C++ source files should be treated the same
way, and Make provides three ways to state this:</p>
<ol>
<li>suffix rules (considered obsolete in GNU make, but kept for backwards compatibility)</li>
<li>implicit rules</li>
<li>pattern rules</li>
</ol>
<p>Implicit rules are built in, and a few will be discussed below. Pattern rules
are specified in a form like</p>
<div class="code"><pre class="code literal-block"><span class="c">%.o: %.c</span>
<span class="w">    </span>$<span class="p">(</span><span class="n">CC</span><span class="p">)</span><span class="w"> </span>$<span class="p">(</span><span class="n">CFLAGS</span><span class="p">)</span><span class="w"> </span>$<span class="p">(</span><span class="n">CPPFLAGS</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span>$<span class="o">&lt;</span>
</pre></div>

<p>which means that object files are generated from C source files by running the
command shown, where the "automatic" variable <code>$&lt;</code> expands to the name of the
first dependency.</p>
<p><strong>Built-in Rules</strong></p>
<p>Make has a whole host of built-in rules that mean that very often, a project
can be compile by a very simple makefile, indeed.</p>
<p>The GNU make built in rule for C source files is the one exhibited above.
Similarly we create object files from C++ source files with a rule like
<code>$(CXX) -c $(CPPFLAGS) $(CFLAGS)</code>.</p>
<p>Single object files are linked using <code>$(LD) $(LDFLAGS) n.o $(LOADLIBES)
$(LDLIBS)</code>, but this won't work in our case, because we want to link multiple
object files.</p>
<p><strong>Variables Used By Built-in Rules</strong></p>
<p>The built-in rules use a set of standard variables that allow you to specify
local environment information (like where to find the ROOT include files)
without re-writing all the rules. The ones most likely to be interesting to us
are:</p>
<ul>
<li>
<code>CC</code> -- the C compiler to use</li>
<li>
<code>CXX</code> -- the C++ compiler to use</li>
<li>
<code>LD</code> -- the linker to use</li>
<li>
<code>CFLAGS</code> -- compilation flag for C source files</li>
<li>
<code>CXXFLAGS</code> -- compilation flags for C++ source files</li>
<li>
<code>CPPFLAGS</code> -- flags for the c-preprocessor (typically include file paths and symbols defined on the command line), used by C and C++</li>
<li>
<code>LDFLAGS</code> -- linker flags</li>
<li>
<code>LDLIBS</code> -- libraries to link</li>
</ul>
<p><strong>A Basic Makefile</strong></p>
<p>By taking advantage of the built-in rules we can simplify our makefile to:</p>
<div class="code"><pre class="code literal-block"><span class="n">CC</span><span class="o">=</span><span class="n">gcc</span>
<span class="n">CXX</span><span class="o">=</span><span class="n">g</span><span class="o">++</span>
<span class="n">RM</span><span class="o">=</span><span class="n">rm</span><span class="w"> </span><span class="o">-</span><span class="n">f</span>
<span class="n">CPPFLAGS</span><span class="o">=-</span><span class="n">g</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">shell</span><span class="w"> </span><span class="n">root</span><span class="o">-</span><span class="n">config</span><span class="w"> </span><span class="o">--</span><span class="n">cflags</span><span class="p">)</span>
<span class="n">LDFLAGS</span><span class="o">=-</span><span class="n">g</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">shell</span><span class="w"> </span><span class="n">root</span><span class="o">-</span><span class="n">config</span><span class="w"> </span><span class="o">--</span><span class="n">ldflags</span><span class="p">)</span>
<span class="n">LDLIBS</span><span class="o">=$</span><span class="p">(</span><span class="n">shell</span><span class="w"> </span><span class="n">root</span><span class="o">-</span><span class="n">config</span><span class="w"> </span><span class="o">--</span><span class="n">libs</span><span class="p">)</span>

<span class="n">SRCS</span><span class="o">=</span><span class="k">tool</span><span class="o">.</span><span class="n">cc</span><span class="w"> </span><span class="n">support</span><span class="o">.</span><span class="n">cc</span>
<span class="n">OBJS</span><span class="o">=$</span><span class="p">(</span><span class="n">subst</span><span class="w"> </span><span class="o">.</span><span class="n">cc</span><span class="p">,</span><span class="o">.</span><span class="n">o</span><span class="p">,</span><span class="o">$</span><span class="p">(</span><span class="n">SRCS</span><span class="p">))</span>

<span class="n">all</span><span class="p">:</span><span class="w"> </span><span class="k">tool</span>

<span class="k">tool</span><span class="p">:</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">OBJS</span><span class="p">)</span>
<span class="w">    </span><span class="o">$</span><span class="p">(</span><span class="n">CXX</span><span class="p">)</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">LDFLAGS</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="k">tool</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">OBJS</span><span class="p">)</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">LDLIBS</span><span class="p">)</span>

<span class="k">tool</span><span class="o">.</span><span class="n">o</span><span class="p">:</span><span class="w"> </span><span class="k">tool</span><span class="o">.</span><span class="n">cc</span><span class="w"> </span><span class="n">support</span><span class="o">.</span><span class="n">hh</span>

<span class="n">support</span><span class="o">.</span><span class="n">o</span><span class="p">:</span><span class="w"> </span><span class="n">support</span><span class="o">.</span><span class="n">hh</span><span class="w"> </span><span class="n">support</span><span class="o">.</span><span class="n">cc</span>

<span class="n">clean</span><span class="p">:</span>
<span class="w">    </span><span class="o">$</span><span class="p">(</span><span class="n">RM</span><span class="p">)</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">OBJS</span><span class="p">)</span>

<span class="n">distclean</span><span class="p">:</span><span class="w"> </span><span class="n">clean</span>
<span class="w">    </span><span class="o">$</span><span class="p">(</span><span class="n">RM</span><span class="p">)</span><span class="w"> </span><span class="k">tool</span>
</pre></div>

<p>We have also added several standard targets that perform special actions (like
cleaning up the source directory).</p>
<p>Note that when make is invoked without an argument, it uses the first target
found in the file (in this case all), but you can also name the target to get
which is what makes <code>make clean</code> remove the object files in this case.</p>
<p>We still have all the dependencies hard-coded.</p>
<p><strong>Some Mysterious Improvements</strong></p>
<div class="code"><pre class="code literal-block"><span class="n">CC</span><span class="o">=</span><span class="n">gcc</span>
<span class="n">CXX</span><span class="o">=</span><span class="n">g</span><span class="o">++</span>
<span class="n">RM</span><span class="o">=</span><span class="n">rm</span><span class="w"> </span><span class="o">-</span><span class="n">f</span>
<span class="n">CPPFLAGS</span><span class="o">=-</span><span class="n">g</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">shell</span><span class="w"> </span><span class="n">root</span><span class="o">-</span><span class="n">config</span><span class="w"> </span><span class="o">--</span><span class="n">cflags</span><span class="p">)</span>
<span class="n">LDFLAGS</span><span class="o">=-</span><span class="n">g</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">shell</span><span class="w"> </span><span class="n">root</span><span class="o">-</span><span class="n">config</span><span class="w"> </span><span class="o">--</span><span class="n">ldflags</span><span class="p">)</span>
<span class="n">LDLIBS</span><span class="o">=$</span><span class="p">(</span><span class="n">shell</span><span class="w"> </span><span class="n">root</span><span class="o">-</span><span class="n">config</span><span class="w"> </span><span class="o">--</span><span class="n">libs</span><span class="p">)</span>

<span class="n">SRCS</span><span class="o">=</span><span class="k">tool</span><span class="o">.</span><span class="n">cc</span><span class="w"> </span><span class="n">support</span><span class="o">.</span><span class="n">cc</span>
<span class="n">OBJS</span><span class="o">=$</span><span class="p">(</span><span class="n">subst</span><span class="w"> </span><span class="o">.</span><span class="n">cc</span><span class="p">,</span><span class="o">.</span><span class="n">o</span><span class="p">,</span><span class="o">$</span><span class="p">(</span><span class="n">SRCS</span><span class="p">))</span>

<span class="n">all</span><span class="p">:</span><span class="w"> </span><span class="k">tool</span>

<span class="k">tool</span><span class="p">:</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">OBJS</span><span class="p">)</span>
<span class="w">    </span><span class="o">$</span><span class="p">(</span><span class="n">CXX</span><span class="p">)</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">LDFLAGS</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="k">tool</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">OBJS</span><span class="p">)</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">LDLIBS</span><span class="p">)</span>

<span class="n">depend</span><span class="p">:</span><span class="w"> </span><span class="o">.</span><span class="n">depend</span>

<span class="o">.</span><span class="n">depend</span><span class="p">:</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">SRCS</span><span class="p">)</span>
<span class="w">    </span><span class="o">$</span><span class="p">(</span><span class="n">RM</span><span class="p">)</span><span class="w"> </span><span class="o">./.</span><span class="n">depend</span>
<span class="w">    </span><span class="o">$</span><span class="p">(</span><span class="n">CXX</span><span class="p">)</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">CPPFLAGS</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="n">MM</span><span class="w"> </span><span class="o">$^&gt;&gt;./.</span><span class="n">depend</span><span class="p">;</span>

<span class="n">clean</span><span class="p">:</span>
<span class="w">    </span><span class="o">$</span><span class="p">(</span><span class="n">RM</span><span class="p">)</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">OBJS</span><span class="p">)</span>

<span class="n">distclean</span><span class="p">:</span><span class="w"> </span><span class="n">clean</span>
<span class="w">    </span><span class="o">$</span><span class="p">(</span><span class="n">RM</span><span class="p">)</span><span class="w"> </span><span class="o">*~</span><span class="w"> </span><span class="o">.</span><span class="n">depend</span>

<span class="n">include</span><span class="w"> </span><span class="o">.</span><span class="n">depend</span>
</pre></div>

<p>Notice that</p>
<ol>
<li>There are no longer any dependency lines for the source files!?!</li>
<li>There is some strange magic related to .depend and depend</li>
<li>If you do <code>make</code> then <code>ls -A</code> you see a file named <code>.depend</code> which contains things that look like make dependency lines</li>
</ol>
<p><strong>Other Reading</strong></p>
<ul>
<li>GNU make manual</li>
<li>Recursive Make Considered Harmful on a common way of writing makefiles that is less than optimal, and how to avoid it.</li>
</ul>
<p><strong>Know Bugs and Historical Notes</strong></p>
<p>The input language for Make is whitespace sensitive. In particular, <em>the
action lines following dependencies must start with a tab</em>. But a series of
spaces can look the same (and indeed there are editors that will silently
convert tabs to spaces or vice versa), which results in a Make file that looks
right and still doesn't work. This was identified as a bug early on, but (the
story goes) it was not fixed, because there were already 10 users.</p>
<p>(This was copied from a wiki post I wrote for physics graduate students.)</p>
<p><br></p>
<h3>Suggest</h3>
<p>I've always thought this was easier to learn with a detailed example, so
here's how I think of makefiles. For each section you have one line that's not
indented and it shows the name of the section followed by dependencies. The
dependencies can be either other sections (which will be run before the
current section) or files (which if updated will cause the current section to
be run again next time you run <code>make</code>).</p>
<p>Here's a quick example (keep in mind that I'm using 4 spaces where I should be
using a tab, Stack Overflow won't let me use tabs):</p>
<div class="code"><pre class="code literal-block"><span class="n">a3driver</span><span class="o">:</span><span class="w"> </span><span class="n">a3driver</span><span class="o">.</span><span class="na">o</span>
<span class="w">    </span><span class="n">g</span><span class="o">++</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">a3driver</span><span class="w"> </span><span class="n">a3driver</span><span class="o">.</span><span class="na">o</span>

<span class="n">a3driver</span><span class="o">.</span><span class="na">o</span><span class="o">:</span><span class="w"> </span><span class="n">a3driver</span><span class="o">.</span><span class="na">cpp</span>
<span class="w">    </span><span class="n">g</span><span class="o">++</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="n">a3driver</span><span class="o">.</span><span class="na">cpp</span>
</pre></div>

<p>When you type <code>make</code>, it will choose the first section (a3driver). a3driver
depends on a3driver.o, so it will go to that section. a3driver.o depends on
a3driver.cpp, so it will only run if a3driver.cpp has changed since it was
last run. Assuming it has (or has never been run), it will compile
a3driver.cpp to a .o file, then go back to a3driver and compile the final
executable.</p>
<p>Since there's only one file, it could even be reduced to:</p>
<div class="code"><pre class="code literal-block"><span class="n">a3driver</span><span class="o">:</span><span class="w"> </span><span class="n">a3driver</span><span class="o">.</span><span class="na">cpp</span>
<span class="w">    </span><span class="n">g</span><span class="o">++</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">a3driver</span><span class="w"> </span><span class="n">a3driver</span><span class="o">.</span><span class="na">cpp</span>
</pre></div>

<p>The reason I showed the first example is that it shows the power of makefiles.
If you need to compile another file, you can just add another section. Here's
an example with a secondFile.cpp (which loads in a header named secondFile.h):</p>
<div class="code"><pre class="code literal-block"><span class="n">a3driver</span><span class="o">:</span><span class="w"> </span><span class="n">a3driver</span><span class="o">.</span><span class="na">o</span><span class="w"> </span><span class="n">secondFile</span><span class="o">.</span><span class="na">o</span>
<span class="w">    </span><span class="n">g</span><span class="o">++</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">a3driver</span><span class="w"> </span><span class="n">a3driver</span><span class="o">.</span><span class="na">o</span><span class="w"> </span><span class="n">secondFile</span><span class="o">.</span><span class="na">o</span>

<span class="n">a3driver</span><span class="o">.</span><span class="na">o</span><span class="o">:</span><span class="w"> </span><span class="n">a3driver</span><span class="o">.</span><span class="na">cpp</span>
<span class="w">    </span><span class="n">g</span><span class="o">++</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="n">a3driver</span><span class="o">.</span><span class="na">cpp</span>

<span class="n">secondFile</span><span class="o">.</span><span class="na">o</span><span class="o">:</span><span class="w"> </span><span class="n">secondFile</span><span class="o">.</span><span class="na">cpp</span><span class="w"> </span><span class="n">secondFile</span><span class="o">.</span><span class="na">h</span>
<span class="w">    </span><span class="n">g</span><span class="o">++</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="n">secondFile</span><span class="o">.</span><span class="na">cpp</span>
</pre></div>

<p>This way if you change something in secondFile.cpp or secondFile.h and
recompile, it will only recompile secondFile.cpp (not a3driver.cpp). Or
alternately, if you change something in a3driver.cpp, it won't recompile
secondFile.cpp.</p>
<p>Let me know if you have any questions about it.</p>
<p>It's also traditional to include a section named "all" and a section named
"clean". "all" will usually build all of the executables, and "clean" will
remove "build artifacts" like .o files and the executables:</p>
<div class="code"><pre class="code literal-block"><span class="n">all</span><span class="o">:</span><span class="w"> </span><span class="n">a3driver</span><span class="w"> </span><span class="o">;</span>

<span class="n">clean</span><span class="o">:</span>
<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="k">this</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">succeed</span><span class="w"> </span><span class="n">even</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">don</span><span class="err">'</span><span class="n">t</span><span class="w"> </span><span class="n">exist</span>
<span class="w">    </span><span class="n">rm</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="n">a3driver</span><span class="w"> </span><span class="n">a3driver</span><span class="o">.</span><span class="na">o</span>
</pre></div>

<p>EDIT: I didn't notice you're on Windows. I think the only difference is
changing the <code>-o a3driver</code> to <code>-o a3driver.exe</code>.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-2814.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-2812.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
