<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 2637) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-2637.html">
<link rel="prev" href="index-2638.html" type="text/html">
<link rel="next" href="index-2636.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-convert-a-git-shallow-clone-to-a-full-clone/" class="u-url">How to convert a Git shallow clone to a full clone?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-convert-a-git-shallow-clone-to-a-full-clone/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-05T06:40:58+08:00" itemprop="datePublished" title="2023-03-05 06:40">2023-03-05 06:40</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Follow-up of this so-question: if I have a shallow clone, how to fetch all
older commits to make it a full clone?</p>
<p><br><br></p>
<h2>Answer</h2>
<p><strong>EDIT:</strong> <code>git fetch --unshallow</code> now is an option (thanks Jack O'Connor).</p>
<p>You can run <code>git fetch --depth=2147483647</code></p>
<p>From the docs on shallow:</p>
<blockquote>
<p>The special depth 2147483647 (or 0x7fffffff, the largest positive number a
signed 32-bit integer can contain) means infinite depth.</p>
</blockquote>
<p><br></p>
<h3>Suggest</h3>
<p><strong>EDIT:</strong> <code>git fetch --unshallow</code> now is an option (thanks Jack O'Connor).</p>
<p>You can run <code>git fetch --depth=2147483647</code></p>
<p>From the docs on shallow:</p>
<blockquote>
<p>The special depth 2147483647 (or 0x7fffffff, the largest positive number a
signed 32-bit integer can contain) means infinite depth.</p>
</blockquote>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/adding-a-new-value-to-an-existing-enum-type/" class="u-url">Adding a new value to an existing ENUM Type</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/adding-a-new-value-to-an-existing-enum-type/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-05T06:40:10+08:00" itemprop="datePublished" title="2023-03-05 06:40">2023-03-05 06:40</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I have a table column that uses an <code>enum</code> type. I wish to update that <code>enum</code>
type to have an additional possible value. I don't want to delete any existing
values, just add the new value. What is the simplest way to do this?</p>
<p><br><br></p>
<h2>Answer</h2>
<p><strong>NOTE</strong> if you're using PostgreSQL 9.1 or later, and you are ok with making
changes outside of a transaction, see this answer for a simpler approach.</p>
<hr>
<p>I had the same problem few days ago and found this post. So my answer can be
helpful for someone who is looking for solution :)</p>
<p>If you have only one or two columns which use the enum type you want to
change, you can try this. Also you can change the order of values in the new
type.</p>
<div class="code"><pre class="code literal-block"><span class="o">--</span><span class="w"> </span><span class="mf">1.</span><span class="w"> </span><span class="n">rename</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">enum</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">change</span>
<span class="n">alter</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">some_enum_type</span><span class="w"> </span><span class="n">rename</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">_some_enum_type</span><span class="p">;</span>
<span class="o">--</span><span class="w"> </span><span class="mf">2.</span><span class="w"> </span><span class="n">create</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">type</span>
<span class="n">create</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">some_enum_type</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="k">enum</span><span class="w"> </span><span class="p">(</span><span class="s1">'old'</span><span class="p">,</span><span class="w"> </span><span class="s1">'values'</span><span class="p">,</span><span class="w"> </span><span class="s1">'and'</span><span class="p">,</span><span class="w"> </span><span class="s1">'new'</span><span class="p">,</span><span class="w"> </span><span class="s1">'ones'</span><span class="p">);</span>
<span class="o">--</span><span class="w"> </span><span class="mf">3.</span><span class="w"> </span><span class="n">rename</span><span class="w"> </span><span class="n">column</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">uses</span><span class="w"> </span><span class="n">our</span><span class="w"> </span><span class="k">enum</span><span class="w"> </span><span class="n">type</span>
<span class="n">alter</span><span class="w"> </span><span class="n">table</span><span class="w"> </span><span class="n">some_table</span><span class="w"> </span><span class="n">rename</span><span class="w"> </span><span class="n">column</span><span class="w"> </span><span class="n">some_column</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">_some_column</span><span class="p">;</span>
<span class="o">--</span><span class="w"> </span><span class="mf">4.</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">column</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">type</span>
<span class="n">alter</span><span class="w"> </span><span class="n">table</span><span class="w"> </span><span class="n">some_table</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="n">some_column</span><span class="w"> </span><span class="n">some_enum_type</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nb nb-Type">null</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="s1">'new'</span><span class="p">;</span>
<span class="o">--</span><span class="w"> </span><span class="mf">5.</span><span class="w"> </span><span class="n">copy</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">column</span>
<span class="n">update</span><span class="w"> </span><span class="n">some_table</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">some_column</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_some_column</span><span class="p">::</span><span class="n">text</span><span class="p">::</span><span class="n">some_enum_type</span><span class="p">;</span>
<span class="o">--</span><span class="w"> </span><span class="mf">6.</span><span class="w"> </span><span class="n">remove</span><span class="w"> </span><span class="n">old</span><span class="w"> </span><span class="n">column</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">type</span>
<span class="n">alter</span><span class="w"> </span><span class="n">table</span><span class="w"> </span><span class="n">some_table</span><span class="w"> </span><span class="n">drop</span><span class="w"> </span><span class="n">column</span><span class="w"> </span><span class="n">_some_column</span><span class="p">;</span>
<span class="n">drop</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">_some_enum_type</span><span class="p">;</span>
</pre></div>

<p>3-6 should be repeated if there is more than 1 column.</p>
<p><br></p>
<h3>Suggest</h3>
<p><strong>NOTE</strong> if you're using PostgreSQL 9.1 or later, and you are ok with making
changes outside of a transaction, see this answer for a simpler approach.</p>
<hr>
<p>I had the same problem few days ago and found this post. So my answer can be
helpful for someone who is looking for solution :)</p>
<p>If you have only one or two columns which use the enum type you want to
change, you can try this. Also you can change the order of values in the new
type.</p>
<div class="code"><pre class="code literal-block"><span class="o">--</span><span class="w"> </span><span class="mf">1.</span><span class="w"> </span><span class="n">rename</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">enum</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">change</span>
<span class="n">alter</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">some_enum_type</span><span class="w"> </span><span class="n">rename</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">_some_enum_type</span><span class="p">;</span>
<span class="o">--</span><span class="w"> </span><span class="mf">2.</span><span class="w"> </span><span class="n">create</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">type</span>
<span class="n">create</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">some_enum_type</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="k">enum</span><span class="w"> </span><span class="p">(</span><span class="s1">'old'</span><span class="p">,</span><span class="w"> </span><span class="s1">'values'</span><span class="p">,</span><span class="w"> </span><span class="s1">'and'</span><span class="p">,</span><span class="w"> </span><span class="s1">'new'</span><span class="p">,</span><span class="w"> </span><span class="s1">'ones'</span><span class="p">);</span>
<span class="o">--</span><span class="w"> </span><span class="mf">3.</span><span class="w"> </span><span class="n">rename</span><span class="w"> </span><span class="n">column</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">uses</span><span class="w"> </span><span class="n">our</span><span class="w"> </span><span class="k">enum</span><span class="w"> </span><span class="n">type</span>
<span class="n">alter</span><span class="w"> </span><span class="n">table</span><span class="w"> </span><span class="n">some_table</span><span class="w"> </span><span class="n">rename</span><span class="w"> </span><span class="n">column</span><span class="w"> </span><span class="n">some_column</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">_some_column</span><span class="p">;</span>
<span class="o">--</span><span class="w"> </span><span class="mf">4.</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">column</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">type</span>
<span class="n">alter</span><span class="w"> </span><span class="n">table</span><span class="w"> </span><span class="n">some_table</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="n">some_column</span><span class="w"> </span><span class="n">some_enum_type</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nb nb-Type">null</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="s1">'new'</span><span class="p">;</span>
<span class="o">--</span><span class="w"> </span><span class="mf">5.</span><span class="w"> </span><span class="n">copy</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">column</span>
<span class="n">update</span><span class="w"> </span><span class="n">some_table</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">some_column</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_some_column</span><span class="p">::</span><span class="n">text</span><span class="p">::</span><span class="n">some_enum_type</span><span class="p">;</span>
<span class="o">--</span><span class="w"> </span><span class="mf">6.</span><span class="w"> </span><span class="n">remove</span><span class="w"> </span><span class="n">old</span><span class="w"> </span><span class="n">column</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">type</span>
<span class="n">alter</span><span class="w"> </span><span class="n">table</span><span class="w"> </span><span class="n">some_table</span><span class="w"> </span><span class="n">drop</span><span class="w"> </span><span class="n">column</span><span class="w"> </span><span class="n">_some_column</span><span class="p">;</span>
<span class="n">drop</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">_some_enum_type</span><span class="p">;</span>
</pre></div>

<p>3-6 should be repeated if there is more than 1 column.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/generate-json-string-from-nsdictionary-in-ios/" class="u-url">Generate JSON string from NSDictionary in iOS</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/generate-json-string-from-nsdictionary-in-ios/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-05T06:38:47+08:00" itemprop="datePublished" title="2023-03-05 06:38">2023-03-05 06:38</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I have a <code>dictionary</code> I need to generate a <code>JSON string</code> by using
<code>dictionary</code>. Is it possible to convert it? Can you guys please help on this?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Here are categories for NSArray and NSDictionary to make this super-easy. I've
added an option for pretty-print (newlines and tabs to make easier to read).</p>
<div class="code"><pre class="code literal-block"><span class="k">@interface</span> <span class="bp">NSDictionary</span> <span class="nl">(BVJSONString)</span>
<span class="p">-(</span><span class="bp">NSString</span><span class="o">*</span><span class="p">)</span> <span class="nf">bv_jsonStringWithPrettyPrint:</span><span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span> <span class="nv">prettyPrint</span><span class="p">;</span>
<span class="k">@end</span>
</pre></div>

<p>.</p>
<div class="code"><pre class="code literal-block"><span class="k">@implementation</span> <span class="bp">NSDictionary</span> <span class="nl">(BVJSONString)</span>

<span class="w">  </span><span class="o">-</span><span class="p">(</span><span class="bp">NSString</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">bv_jsonStringWithPrettyPrint</span><span class="o">:</span><span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="w"> </span><span class="n">prettyPrint</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="bp">NSError</span><span class="w"> </span><span class="o">*</span><span class="n">error</span><span class="p">;</span>
<span class="w">     </span><span class="bp">NSData</span><span class="w"> </span><span class="o">*</span><span class="n">jsonData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="bp">NSJSONSerialization</span><span class="w"> </span><span class="n">dataWithJSONObject</span><span class="o">:</span><span class="nb">self</span>
<span class="w">                                                   </span><span class="nl">options</span><span class="p">:(</span><span class="n">NSJSONWritingOptions</span><span class="p">)</span><span class="w">    </span><span class="p">(</span><span class="n">prettyPrint</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">NSJSONWritingPrettyPrinted</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">                                                     </span><span class="nl">error</span><span class="p">:</span><span class="o">&amp;</span><span class="n">error</span><span class="p">];</span>

<span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="w"> </span><span class="n">jsonData</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">NSLog</span><span class="p">(</span><span class="s">@"%s: error: %@"</span><span class="p">,</span><span class="w"> </span><span class="n">__func__</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="p">.</span><span class="n">localizedDescription</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">@"{}"</span><span class="p">;</span>
<span class="w">     </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">[[</span><span class="bp">NSString</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">initWithData</span><span class="o">:</span><span class="n">jsonData</span><span class="w"> </span><span class="n">encoding</span><span class="o">:</span><span class="n">NSUTF8StringEncoding</span><span class="p">];</span>
<span class="w">     </span><span class="p">}</span><span class="w"> </span>
<span class="w"> </span><span class="p">}</span>
<span class="k">@end</span>
</pre></div>

<p>.</p>
<div class="code"><pre class="code literal-block"><span class="k">@interface</span> <span class="bp">NSArray</span> <span class="nl">(BVJSONString)</span>
<span class="p">-</span> <span class="p">(</span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nf">bv_jsonStringWithPrettyPrint:</span><span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nv">prettyPrint</span><span class="p">;</span>
<span class="k">@end</span>
</pre></div>

<p>.</p>
<div class="code"><pre class="code literal-block"><span class="k">@implementation</span> <span class="bp">NSArray</span> <span class="nl">(BVJSONString)</span>
<span class="p">-(</span><span class="bp">NSString</span><span class="o">*</span><span class="p">)</span> <span class="nf">bv_jsonStringWithPrettyPrint:</span><span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span> <span class="nv">prettyPrint</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="bp">NSError</span><span class="w"> </span><span class="o">*</span><span class="n">error</span><span class="p">;</span>
<span class="w">    </span><span class="bp">NSData</span><span class="w"> </span><span class="o">*</span><span class="n">jsonData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="bp">NSJSONSerialization</span><span class="w"> </span><span class="n">dataWithJSONObject</span><span class="o">:</span><span class="nb">self</span>
<span class="w">                                                       </span><span class="nl">options</span><span class="p">:(</span><span class="n">NSJSONWritingOptions</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">prettyPrint</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">NSJSONWritingPrettyPrinted</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">                                                         </span><span class="nl">error</span><span class="p">:</span><span class="o">&amp;</span><span class="n">error</span><span class="p">];</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="w"> </span><span class="n">jsonData</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">NSLog</span><span class="p">(</span><span class="s">@"%s: error: %@"</span><span class="p">,</span><span class="w"> </span><span class="n">__func__</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="p">.</span><span class="n">localizedDescription</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">@"[]"</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">[[</span><span class="bp">NSString</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">initWithData</span><span class="o">:</span><span class="n">jsonData</span><span class="w"> </span><span class="n">encoding</span><span class="o">:</span><span class="n">NSUTF8StringEncoding</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
<span class="k">@end</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>Here are categories for NSArray and NSDictionary to make this super-easy. I've
added an option for pretty-print (newlines and tabs to make easier to read).</p>
<div class="code"><pre class="code literal-block"><span class="k">@interface</span> <span class="bp">NSDictionary</span> <span class="nl">(BVJSONString)</span>
<span class="p">-(</span><span class="bp">NSString</span><span class="o">*</span><span class="p">)</span> <span class="nf">bv_jsonStringWithPrettyPrint:</span><span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span> <span class="nv">prettyPrint</span><span class="p">;</span>
<span class="k">@end</span>
</pre></div>

<p>.</p>
<div class="code"><pre class="code literal-block"><span class="k">@implementation</span> <span class="bp">NSDictionary</span> <span class="nl">(BVJSONString)</span>

<span class="w">  </span><span class="o">-</span><span class="p">(</span><span class="bp">NSString</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">bv_jsonStringWithPrettyPrint</span><span class="o">:</span><span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="w"> </span><span class="n">prettyPrint</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="bp">NSError</span><span class="w"> </span><span class="o">*</span><span class="n">error</span><span class="p">;</span>
<span class="w">     </span><span class="bp">NSData</span><span class="w"> </span><span class="o">*</span><span class="n">jsonData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="bp">NSJSONSerialization</span><span class="w"> </span><span class="n">dataWithJSONObject</span><span class="o">:</span><span class="nb">self</span>
<span class="w">                                                   </span><span class="nl">options</span><span class="p">:(</span><span class="n">NSJSONWritingOptions</span><span class="p">)</span><span class="w">    </span><span class="p">(</span><span class="n">prettyPrint</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">NSJSONWritingPrettyPrinted</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">                                                     </span><span class="nl">error</span><span class="p">:</span><span class="o">&amp;</span><span class="n">error</span><span class="p">];</span>

<span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="w"> </span><span class="n">jsonData</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">NSLog</span><span class="p">(</span><span class="s">@"%s: error: %@"</span><span class="p">,</span><span class="w"> </span><span class="n">__func__</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="p">.</span><span class="n">localizedDescription</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">@"{}"</span><span class="p">;</span>
<span class="w">     </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">[[</span><span class="bp">NSString</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">initWithData</span><span class="o">:</span><span class="n">jsonData</span><span class="w"> </span><span class="n">encoding</span><span class="o">:</span><span class="n">NSUTF8StringEncoding</span><span class="p">];</span>
<span class="w">     </span><span class="p">}</span><span class="w"> </span>
<span class="w"> </span><span class="p">}</span>
<span class="k">@end</span>
</pre></div>

<p>.</p>
<div class="code"><pre class="code literal-block"><span class="k">@interface</span> <span class="bp">NSArray</span> <span class="nl">(BVJSONString)</span>
<span class="p">-</span> <span class="p">(</span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nf">bv_jsonStringWithPrettyPrint:</span><span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nv">prettyPrint</span><span class="p">;</span>
<span class="k">@end</span>
</pre></div>

<p>.</p>
<div class="code"><pre class="code literal-block"><span class="k">@implementation</span> <span class="bp">NSArray</span> <span class="nl">(BVJSONString)</span>
<span class="p">-(</span><span class="bp">NSString</span><span class="o">*</span><span class="p">)</span> <span class="nf">bv_jsonStringWithPrettyPrint:</span><span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span> <span class="nv">prettyPrint</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="bp">NSError</span><span class="w"> </span><span class="o">*</span><span class="n">error</span><span class="p">;</span>
<span class="w">    </span><span class="bp">NSData</span><span class="w"> </span><span class="o">*</span><span class="n">jsonData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="bp">NSJSONSerialization</span><span class="w"> </span><span class="n">dataWithJSONObject</span><span class="o">:</span><span class="nb">self</span>
<span class="w">                                                       </span><span class="nl">options</span><span class="p">:(</span><span class="n">NSJSONWritingOptions</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">prettyPrint</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">NSJSONWritingPrettyPrinted</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">                                                         </span><span class="nl">error</span><span class="p">:</span><span class="o">&amp;</span><span class="n">error</span><span class="p">];</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="w"> </span><span class="n">jsonData</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">NSLog</span><span class="p">(</span><span class="s">@"%s: error: %@"</span><span class="p">,</span><span class="w"> </span><span class="n">__func__</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="p">.</span><span class="n">localizedDescription</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">@"[]"</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">[[</span><span class="bp">NSString</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">initWithData</span><span class="o">:</span><span class="n">jsonData</span><span class="w"> </span><span class="n">encoding</span><span class="o">:</span><span class="n">NSUTF8StringEncoding</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
<span class="k">@end</span>
</pre></div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-2638.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-2636.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
