<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 401) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-401.html">
<link rel="prev" href="index-402.html" type="text/html">
<link rel="next" href="index-400.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/returning-json-from-a-php-script/" class="u-url">Returning JSON from a PHP Script</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/returning-json-from-a-php-script/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T05:55:47+08:00" itemprop="datePublished" title="2023-02-17 05:55">2023-02-17 05:55</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I want to return JSON from a PHP script.</p>
<p>Do I just echo the result? Do I have to set the <code>Content-Type</code> header?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>While you're usually fine without it, you can and should set the <code>Content-
Type</code> header:</p>
<div class="code"><pre class="code literal-block"><span class="cp">&lt;?php</span>
<span class="nv">$data</span> <span class="o">=</span> <span class="sd">/** whatever you're serializing **/</span><span class="p">;</span>
<span class="nb">header</span><span class="p">(</span><span class="s1">'Content-Type: application/json; charset=utf-8'</span><span class="p">);</span>
<span class="k">echo</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>
</pre></div>

<p>If I'm not using a particular framework, I usually allow some request params
to modify the output behavior. It can be useful, generally for quick
troubleshooting, to not send a header, or sometimes <code>print_r</code> the data payload
to eyeball it (though in most cases, it shouldn't be necessary).</p>
<p><br></p>
<h3>Suggest</h3>
<p>A complete piece of nice and clear PHP code returning JSON is:</p>
<div class="code"><pre class="code literal-block"><span class="err">$</span><span class="s s-Atom">option</span> <span class="o">=</span> <span class="err">$</span><span class="k">_</span><span class="nv">GET</span><span class="p">[</span><span class="s s-Atom">'option'</span><span class="p">];</span>

<span class="nf">if</span> <span class="p">(</span> <span class="err">$</span><span class="s s-Atom">option</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">{</span>
    <span class="err">$</span><span class="s s-Atom">data</span> <span class="o">=</span> <span class="p">[</span> <span class="s s-Atom">'a'</span><span class="p">,</span> <span class="s s-Atom">'b'</span><span class="p">,</span> <span class="s s-Atom">'c'</span> <span class="p">];</span>
    <span class="o">//</span> <span class="s s-Atom">will</span> <span class="s s-Atom">encode</span> <span class="s s-Atom">to</span> <span class="nv">JSON</span> <span class="s s-Atom">array</span><span class="p">:</span> <span class="p">[</span><span class="s2">"a"</span><span class="p">,</span><span class="s2">"b"</span><span class="p">,</span><span class="s2">"c"</span><span class="p">]</span>
    <span class="o">//</span> <span class="s s-Atom">accessed</span> <span class="s s-Atom">as</span> <span class="s s-Atom">example</span> <span class="s s-Atom">in</span> <span class="nv">JavaScript</span> <span class="s s-Atom">like</span><span class="p">:</span> <span class="s s-Atom">result</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">(</span><span class="s s-Atom">returns</span> <span class="s2">"b"</span><span class="p">)</span>
<span class="p">}</span> <span class="s s-Atom">else</span> <span class="p">{</span>
    <span class="err">$</span><span class="s s-Atom">data</span> <span class="o">=</span> <span class="p">[</span> <span class="s s-Atom">'name'</span> <span class="o">=&gt;</span> <span class="s s-Atom">'God'</span><span class="p">,</span> <span class="s s-Atom">'age'</span> <span class="o">=&gt;</span> <span class="o">-</span><span class="mi">1</span> <span class="p">];</span>
    <span class="o">//</span> <span class="s s-Atom">will</span> <span class="s s-Atom">encode</span> <span class="s s-Atom">to</span> <span class="nv">JSON</span> <span class="s s-Atom">object</span><span class="p">:</span> <span class="p">{</span><span class="s2">"name"</span><span class="o">:</span><span class="s2">"God"</span><span class="p">,</span><span class="s2">"age"</span><span class="o">:-</span><span class="mi">1</span><span class="p">}</span>  
    <span class="o">//</span> <span class="s s-Atom">accessed</span> <span class="s s-Atom">as</span> <span class="s s-Atom">example</span> <span class="s s-Atom">in</span> <span class="nv">JavaScript</span> <span class="s s-Atom">like</span><span class="p">:</span> <span class="s s-Atom">result</span><span class="p">.</span><span class="s s-Atom">name</span> <span class="s s-Atom">or</span> <span class="s s-Atom">result</span><span class="p">[</span><span class="s s-Atom">'name'</span><span class="p">]</span> <span class="p">(</span><span class="s s-Atom">returns</span> <span class="s2">"God"</span><span class="p">)</span>
<span class="p">}</span>

<span class="nf">header</span><span class="p">(</span><span class="s s-Atom">'Content-type: application/json'</span><span class="p">);</span>
<span class="s s-Atom">echo</span> <span class="nf">json_encode</span><span class="p">(</span> <span class="err">$</span><span class="s s-Atom">data</span> <span class="p">);</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-do-i-type-hint-a-method-with-the-type-of-the-enclosing-class/" class="u-url">How do I type hint a method with the type of the enclosing class?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-do-i-type-hint-a-method-with-the-type-of-the-enclosing-class/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T05:55:19+08:00" itemprop="datePublished" title="2023-02-17 05:55">2023-02-17 05:55</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I have the following code in Python 3:</p>
<div class="code"><pre class="code literal-block"><span class="k">class</span> <span class="n">Position:</span>

    <span class="n">def</span> <span class="n">__init__</span>(<span class="nb">self</span>, <span class="o">x</span>: <span class="n">int</span>, <span class="n">y:</span> <span class="n">int</span>):
        <span class="nb">self</span>.<span class="nb">x</span> = <span class="nb">x</span>
        <span class="nb">self</span>.<span class="n">y</span> = <span class="n">y</span>

    <span class="n">def</span> <span class="n">__add__</span>(<span class="nb">self</span>, <span class="n">other:</span> <span class="n">Position</span>) -&gt; <span class="n">Position:</span>
        <span class="k">return</span> <span class="n">Position</span>(<span class="nb">self</span>.<span class="nb">x</span> + <span class="n">other</span>.<span class="nb">x</span>, <span class="nb">self</span>.<span class="n">y</span> + <span class="n">other</span>.<span class="n">y</span>)
</pre></div>

<p>But my editor (PyCharm) says that the reference <code>Position</code> can not be resolved
(in the <code>__add__</code> method). How should I specify that I expect the return type
to be of type <code>Position</code>?</p>
<p>Edit: I think this is actually a PyCharm issue. It actually uses the
information in its warnings, and code completion.</p>
<p><img alt="" src="https://i.imgur.com/yjjCWw3.png"></p>
<p>But correct me if I'm wrong, and need to use some other syntax.</p>
<p><br><br></p>
<h2>Answer</h2>
<p><strong>TL;DR</strong> : As of today (2019), in Python 3.7+ you can turn this feature on
using a "future" statement, <code>from __future__ import annotations</code>.</p>
<p>(The behaviour enabled by <code>from __future__ import annotations</code> <em>might</em> become
the default in future versions of Python, and was going to be made the default
in Python 3.10. However, the change in 3.10 was reverted at the last minute,
and now may not happen at all.)</p>
<p>In Python 3.6 or below, you should use a string.</p>
<hr>
<p>I guess you got this exception:</p>
<div class="code"><pre class="code literal-block"><span class="n">NameError</span><span class="o">:</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="s1">'Position'</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">defined</span>
</pre></div>

<p>This is because <code>Position</code> must be defined before you can use it in an
annotation, unless you are using Python with PEP 563 changes enabled.</p>
<h3>Python 3.7+: <code>from __future__ import annotations</code>
</h3>
<p>Python 3.7 introduces PEP 563: postponed evaluation of annotations. A module
that uses the future statement <code>from __future__ import annotations</code> will store
annotations as strings automatically:</p>
<div class="code"><pre class="code literal-block"><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="k">class</span> <span class="nc">Position</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Position</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Position</span><span class="p">:</span>
        <span class="o">...</span>
</pre></div>

<p>This had been scheduled to become the default in Python 3.10, but this change
has now been postponed. Since Python still is a dynamically typed language so
no type-checking is done at runtime, typing annotations should have no
performance impact, right? Wrong! Before Python 3.7, the typing module used to
be one of the slowest python modules in core so <strong>for code that involves
importing the<code>typing</code> module, you will see an up to 7 times increase in
performance when you upgrade to 3.7.</strong></p>
<h3>Python &lt;3.7: use a string</h3>
<p>According to PEP 484, you should use a string instead of the class itself:</p>
<div class="code"><pre class="code literal-block"><span class="k">class</span> <span class="n">Position:</span>
    ...
    <span class="n">def</span> <span class="n">__add__</span>(<span class="nb">self</span>, <span class="n">other:</span> <span class="s">'Position'</span>) -&gt; <span class="s">'Position'</span>:
       ...
</pre></div>

<p>If you use the Django framework, this may be familiar, as Django models also
use strings for forward references (foreign key definitions where the foreign
model is <code>self</code> or is not declared yet). This should work with Pycharm and
other tools.</p>
<h3>Sources</h3>
<p>The relevant parts of PEP 484 and PEP 563, to spare you the trip:</p>
<blockquote>
<h2>Forward references</h2>
<p>When a type hint contains names that have not been defined yet, that
definition may be expressed as a string literal, to be resolved later.</p>
<p>A situation where this occurs commonly is the definition of a container
class, where the class being defined occurs in the signature of some of the
methods. For example, the following code (the start of a simple binary tree
implementation) does not work:</p>
<div class="code"><pre class="code literal-block"><span class="k">class</span> <span class="n">Tree:</span>
    <span class="n">def</span> <span class="n">__init__</span>(<span class="nb">self</span>, <span class="n">left:</span> <span class="n">Tree</span>, <span class="n">right:</span> <span class="n">Tree</span>):
        <span class="nb">self</span>.<span class="n">left</span> = <span class="n">left</span>
        <span class="nb">self</span>.<span class="nb">right</span> = <span class="nb">right</span>
</pre></div>

<p>To address this, we write:</p>
<div class="code"><pre class="code literal-block"><span class="k">class</span> <span class="n">Tree:</span>
    <span class="n">def</span> <span class="n">__init__</span>(<span class="nb">self</span>, <span class="n">left:</span> <span class="s">'Tree'</span>, <span class="n">right:</span> <span class="s">'Tree'</span>):
        <span class="nb">self</span>.<span class="n">left</span> = <span class="n">left</span>
        <span class="nb">self</span>.<span class="nb">right</span> = <span class="nb">right</span>
</pre></div>

<p>The string literal should contain a valid Python expression (i.e.,
compile(lit, '', 'eval') should be a valid code object) and it should
evaluate without errors once the module has been fully loaded. The local and
global namespace in which it is evaluated should be the same namespaces in
which default arguments to the same function would be evaluated.</p>
</blockquote>
<p>and PEP 563:</p>
<blockquote>
<h2>Implementation</h2>
<p>In Python 3.10, function and variable annotations will no longer be
evaluated at definition time. Instead, a string form will be preserved in
the respective <code>__annotations__</code> dictionary. Static type checkers will see
no difference in behavior, whereas tools using annotations at runtime will
have to perform postponed evaluation.</p>
<p>...</p>
<h3>Enabling the future behavior in Python 3.7</h3>
<p>The functionality described above can be enabled starting from Python 3.7
using the following special import:</p>
<div class="code"><pre class="code literal-block"><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>
</pre></div>

</blockquote>
<h3>Things that you may be tempted to do instead</h3>
<h4>A. Define a dummy <code>Position</code>
</h4>
<p>Before the class definition, place a dummy definition:</p>
<div class="code"><pre class="code literal-block"><span class="k">class</span> <span class="n">Position</span>(<span class="n">object</span>):
    <span class="nb">pass</span>


<span class="k">class</span> <span class="n">Position</span>(<span class="n">object</span>):
    ...
</pre></div>

<p>This will get rid of the <code>NameError</code> and may even look OK:</p>
<div class="code"><pre class="code literal-block"><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="nv">Position</span>.<span class="nv">__add__</span>.<span class="nv">__annotations__</span>
{<span class="s1">'other'</span>:<span class="w"> </span><span class="nv">__main__</span>.<span class="nv">Position</span>,<span class="w"> </span><span class="s1">'return'</span>:<span class="w"> </span><span class="nv">__main__</span>.<span class="nv">Position</span>}
</pre></div>

<p>But is it?</p>
<div class="code"><pre class="code literal-block"><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">k</span>,<span class="w"> </span><span class="nv">v</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">Position</span>.<span class="nv">__add__</span>.<span class="nv">__annotations__</span>.<span class="nv">items</span><span class="ss">()</span>:
...<span class="w">     </span><span class="nv">print</span><span class="ss">(</span><span class="nv">k</span>,<span class="w"> </span><span class="s1">'is Position:'</span>,<span class="w"> </span><span class="nv">v</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">Position</span><span class="ss">)</span><span class="w">                                                                                                                                                                                                                  </span>
<span class="k">return</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">Position</span>:<span class="w"> </span><span class="nv">False</span>
<span class="nv">other</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">Position</span>:<span class="w"> </span><span class="nv">False</span>
</pre></div>

<h4>B. Monkey-patch in order to add the annotations:</h4>
<p>You may want to try some Python metaprogramming magic and write a decorator to
monkey-patch the class definition in order to add annotations:</p>
<div class="code"><pre class="code literal-block"><span class="k">class</span> <span class="n">Position:</span>
    ...
    <span class="n">def</span> <span class="n">__add__</span>(<span class="nb">self</span>, <span class="n">other</span>):
        <span class="k">return</span> <span class="nb">self</span>.<span class="n">__class__</span>(<span class="nb">self</span>.<span class="nb">x</span> + <span class="n">other</span>.<span class="nb">x</span>, <span class="nb">self</span>.<span class="n">y</span> + <span class="n">other</span>.<span class="n">y</span>)
</pre></div>

<p>The decorator should be responsible for the equivalent of this:</p>
<div class="code"><pre class="code literal-block"><span class="nv">Position</span>.<span class="nv">__add__</span>.<span class="nv">__annotations__</span>[<span class="s1">'return'</span>]<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">Position</span>
<span class="nv">Position</span>.<span class="nv">__add__</span>.<span class="nv">__annotations__</span>[<span class="s1">'other'</span>]<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">Position</span>
</pre></div>

<p>At least it seems right:</p>
<div class="code"><pre class="code literal-block"><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">k</span>,<span class="w"> </span><span class="nv">v</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">Position</span>.<span class="nv">__add__</span>.<span class="nv">__annotations__</span>.<span class="nv">items</span><span class="ss">()</span>:
...<span class="w">     </span><span class="nv">print</span><span class="ss">(</span><span class="nv">k</span>,<span class="w"> </span><span class="s1">'is Position:'</span>,<span class="w"> </span><span class="nv">v</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">Position</span><span class="ss">)</span><span class="w">                                                                                                                                                                                                                  </span>
<span class="k">return</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">Position</span>:<span class="w"> </span><span class="nv">True</span>
<span class="nv">other</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">Position</span>:<span class="w"> </span><span class="nv">True</span>
</pre></div>

<p>Probably too much trouble.</p>
<p><br></p>
<h3>Suggest</h3>
<p>Starting in Python 3.11 (to be released in late 2022), you'll be able to use
<code>Self</code> as the return type.</p>
<div class="code"><pre class="code literal-block"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Self</span>


<span class="k">class</span> <span class="nc">Position</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Position</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</pre></div>

<p><code>Self</code> is also included in the <code>typing-extensions</code> package (available on
PyPi), which although not part of the standard library, is sort of a "preview"
version of the <code>typing</code> module. From https://pypi.org/project/typing-
extensions/,</p>
<blockquote>
<p>The typing_extensions module serves two related purposes:</p>
<ul>
<li>Enable use of new type system features on older Python versions. For
example, typing.TypeGuard is new in Python 3.10, but typing_extensions
allows users on Python 3.6 through 3.9 to use it too.</li>
<li>Enable experimentation with new type system PEPs before they are
accepted and added to the typing module.
</li>
</ul>
</blockquote>
<p>Currently, <code>typing-extensions</code> officially supports Python 3.7 and later.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/what-is-the-difference-between-and-in-directive-scope-in-angularjs/" class="u-url">What is the difference between '@' and '=' in directive scope in AngularJS?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/what-is-the-difference-between-and-in-directive-scope-in-angularjs/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T05:54:51+08:00" itemprop="datePublished" title="2023-02-17 05:54">2023-02-17 05:54</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I've read the <strong>AngularJS</strong> documentation on the topic carefully, and then
fiddled around with a directive. Here's the fiddle.</p>
<p>And here are some relevant snippets:</p>
<ul>
<li>
<p>From the <strong>HTML</strong> :</p>
<div class="code"><pre class="code literal-block"><span class="nt">&lt;pane</span><span class="w"> </span><span class="na">bi-title=</span><span class="s">"title"</span><span class="w"> </span><span class="na">title=</span><span class="s">"</span><span class="cp">{{</span><span class="nv">title</span><span class="cp">}}</span><span class="s">"</span><span class="nt">&gt;</span><span class="cp">{{</span><span class="nv">text</span><span class="cp">}}</span><span class="nt">&lt;/pane&gt;</span>
</pre></div>

</li>
<li>
<p>From the pane directive:</p>
<div class="code"><pre class="code literal-block">scope: { biTitle: '=', title: '@', bar: '=' },
</pre></div>

</li>
</ul>
<p>There are several things I don't get:</p>
<ul>
<li>Why do I have to use <code>"{{title}}"</code> with <code>'@'</code> and <code>"title"</code> with <code>'='</code>?</li>
<li>Can I also access the parent scope directly, without decorating my element with an attribute?</li>
<li>The documentation says <em>"Often it's desirable to pass data from the isolated scope via expression and to the parent scope"</em> , but that seems to work fine with bidirectional binding too. Why would the expression route be better?</li>
</ul>
<p>I found another fiddle that shows the expression solution too:
http://jsfiddle.net/maxisam/QrCXh/</p>
<p><br><br></p>
<h2>Answer</h2>
<blockquote>
<p>Why do I have to use "{{title}}" with ' <strong>@</strong> ' and "title" with ' <strong>=</strong> '?</p>
</blockquote>
<p><strong>@</strong> binds a local/directive scope property to the <strong>evaluated value of the
DOM attribute</strong>. If you use <code>title=title1</code> or <code>title="title1"</code>, the value of
DOM attribute "title" is simply the string <code>title1</code>. If you use
<code>title="{{title}}"</code>, the value of the DOM attribute "title" is the
interpolated value of <code>{{title}}</code>, hence the string will be whatever parent
scope property "title" is currently set to. Since attribute values are always
strings, you will always end up with a string value for this property in the
directive's scope when using <strong>@</strong>.</p>
<p><strong>=</strong> binds a local/directive scope property to <strong>a parent scope property</strong>.
So with <strong>=</strong> , you use the parent model/scope property name as the value of
the DOM attribute. You can't use <code>{{}}</code>s with <strong>=</strong>.</p>
<p>With @, you can do things like <code>title="{{title}} and then some"</code> -- {{title}}
is interpolated, then the string "and them some" is concatenated with it. The
final concatenated string is what the local/directive scope property gets.
(You can't do this with <strong>=</strong> , only <strong>@</strong>.)</p>
<p>With <strong>@</strong> , you will need to use <code>attr.$observe('title', function(value) {
... })</code> if you need to use the value in your link(ing) function. E.g.,
<code>if(scope.title == "...")</code> won't work like you expect. Note that this means
you can only access this attribute <em>asynchronously</em>. You don't need to use
$observe() if you are only using the value in a template. E.g., <code>template:
'&lt;div&gt;{{title}}&lt;/div&gt;'</code>.</p>
<p>With <strong>=</strong> , you don't need to use $observe.</p>
<blockquote>
<p>Can I also access the parent scope directly, without decorating my element
with an attribute?</p>
</blockquote>
<p>Yes, but only if you don't use an isolate scope. Remove this line from your
directive</p>
<p><code>scope: { ... }</code></p>
<p>and then your directive will not create a new scope. It will use the parent
scope. You can then access all of the parent scope properties directly.</p>
<blockquote>
<p>The documentation says "Often it's desirable to pass data from the isolated
scope via an expression and to the parent scope", but that seems to work
fine with bidirectional binding too. Why would the expression route be
better?</p>
</blockquote>
<p>Yes, bidirectional binding allows the local/directive scope and the parent
scope to share data. "Expression binding" allows the directive to call an
expression (or function) defined by a DOM attribute -- and you can also pass
data as arguments to the expression or function. So, if you don't need to
share data with the parent -- you just want to call a function defined in the
parent scope -- you can use the <strong>&amp;</strong> syntax.</p>
<p>See also</p>
<ul>
<li>Lukas's isolated scope blog post (covers @, =, &amp;)</li>
<li>dnc253's explanation of @ and =</li>
<li>my blog-like answer about scopes -- the <strong>directives</strong> section (way at the bottom, just before the Summary section) has a picture of an isolate scope and its parent scope -- the directive scope uses @ for one property and = for another</li>
<li>What is the difference between &amp; vs @ and = in angularJS</li>
</ul>
<p><br></p>
<h3>Suggest</h3>
<p>There are a lot of great answers here, but I would like to offer my
perspective on the differences between <code>@</code>, <code>=</code>, and <code>&amp;</code> binding that proved
useful for me.</p>
<p>All three bindings are ways of passing data from your parent scope to your
directive's isolated scope through the element's attributes:</p>
<blockquote>
<ol>
<li>
<p><strong>@</strong> binding is for passing strings. These strings support <code>{{}}</code>
expressions for interpolated values. For example: . The interpolated
expression is evaluated against directive's parent scope.</p>
</li>
<li>
<p><strong>=</strong> binding is for two-way model binding. The model in parent scope
is linked to the model in the directive's isolated scope. Changes to one
model affects the other, and vice versa.</p>
</li>
<li>
<p><strong>&amp;</strong> binding is for passing a method into your directive's scope so
that it can be called within your directive. The method is pre-bound to the
directive's parent scope, and supports arguments. For example if the method
is hello(name) in parent scope, then in order to execute the method from
inside your directive, you must call $scope.hello({name:'world'})</p>
</li>
</ol>
</blockquote>
<p>I find that it's easier to remember these differences by referring to the
scope bindings by a shorter description:</p>
<ul>
<li>
<code>@</code> <em>Attribute string binding</em>
</li>
<li>
<code>=</code> <em>Two-way model binding</em>
</li>
<li>
<code>&amp;</code> <em>Callback method binding</em>
</li>
</ul>
<p>The symbols also make it clearer as to what the scope variable represents
inside of your directive's implementation:</p>
<ul>
<li>
<code>@</code> <em>string</em>
</li>
<li>
<code>=</code> <em>model</em>
</li>
<li>
<code>&amp;</code> <em>method</em>
</li>
</ul>
<p>In order of usefulness (for me anyways):</p>
<ol>
<li>=</li>
<li>@</li>
<li>&amp;</li>
</ol>
</div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-402.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-400.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
