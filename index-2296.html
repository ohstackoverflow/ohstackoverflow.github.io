<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 2296) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-2296.html">
<link rel="prev" href="index-2297.html" type="text/html">
<link rel="next" href="index-2295.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/extract-a-single-unsigned-integer-from-a-string/" class="u-url">Extract a single (unsigned) integer from a string</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/extract-a-single-unsigned-integer-from-a-string/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T05:37:07+08:00" itemprop="datePublished" title="2023-03-04 05:37">2023-03-04 05:37</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I want to extract the digits from a string that contains numbers and letters
like:</p>
<div class="code"><pre class="code literal-block">"In My Cart : 11 items"
</pre></div>

<p>I want to extract the number <code>11</code>.</p>
<p><br><br></p>
<h2>Answer</h2>
<div class="code"><pre class="code literal-block"><span class="n">$str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">'</span><span class="n">In</span><span class="w"> </span><span class="n">My</span><span class="w"> </span><span class="n">Cart</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mh">11</span><span class="w"> </span><span class="mh">12</span><span class="w"> </span><span class="n">items</span><span class="p">';</span>
<span class="n">preg_match_all</span><span class="p">('</span><span class="o">!</span><span class="n">\d+!',</span><span class="w"> </span><span class="n">$str</span><span class="p">,</span><span class="w"> </span><span class="n">$matches</span><span class="p">);</span>
<span class="n">print_r</span><span class="p">(</span><span class="n">$matches</span><span class="p">);</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<div class="code"><pre class="code literal-block"><span class="n">$str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">'</span><span class="n">In</span><span class="w"> </span><span class="n">My</span><span class="w"> </span><span class="n">Cart</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mh">11</span><span class="w"> </span><span class="mh">12</span><span class="w"> </span><span class="n">items</span><span class="p">';</span>
<span class="n">preg_match_all</span><span class="p">('</span><span class="o">!</span><span class="n">\d+!',</span><span class="w"> </span><span class="n">$str</span><span class="p">,</span><span class="w"> </span><span class="n">$matches</span><span class="p">);</span>
<span class="n">print_r</span><span class="p">(</span><span class="n">$matches</span><span class="p">);</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-many-threads-is-too-many/" class="u-url">How many threads is too many?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-many-threads-is-too-many/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T05:35:26+08:00" itemprop="datePublished" title="2023-03-04 05:35">2023-03-04 05:35</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I am writing a server, and I send each action of into a separate thread when
the request is received. I do this because almost every request makes a
database query. I am using a threadpool library to cut down on
construction/destruction of threads.</p>
<p>My question is: what is a good cutoff point for I/O threads like these? I know
it would just be a rough estimate, but are we talking hundreds? Thousands?</p>
<p>How would I go about figuring out what this cutoff would be?</p>
<hr>
<h4>EDIT:</h4>
<p>Thank you all for your responses, it seems like I am just going to have to
test it to find out my thread count ceiling. The question is though: how do I
know I've hit that ceiling? What exactly should I measure?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Some people would say that <em>two</em> threads is too many - I'm not quite in that
camp :-)</p>
<p>Here's my advice: <em>measure, don't guess.</em> One suggestion is to make it
configurable and initially set it to 100, then release your software to the
wild and monitor what happens.</p>
<p>If your thread usage peaks at 3, then 100 is too much. If it remains at 100
for most of the day, bump it up to 200 and see what happens.</p>
<p>You <em>could</em> actually have your code itself monitor usage and adjust the
configuration for the next time it starts but that's probably overkill.</p>
<hr>
<p><em>For clarification and elaboration:</em></p>
<p>I'm not advocating rolling your own thread pooling subsystem, by all means use
the one you have. But, since you were asking about a good cut-off point for
threads, I assume your thread pool implementation has the ability to limit the
maximum number of threads created (which is a good thing).</p>
<p>I've written thread and database connection pooling code and they have the
following features (which I believe are essential for performance):</p>
<ul>
<li>a minimum number of active threads.</li>
<li>a maximum number of threads.</li>
<li>shutting down threads that haven't been used for a while.</li>
</ul>
<p>The first sets a baseline for minimum performance in terms of the thread pool
client (this number of threads is always available for use). The second sets a
restriction on resource usage by active threads. The third returns you to the
baseline in quiet times so as to minimise resource use.</p>
<p>You need to balance the resource usage of having unused threads (A) against
the resource usage of not having enough threads to do the work (B).</p>
<p>(A) is generally memory usage (stacks and so on) since a thread doing no work
will not be using much of the CPU. (B) will generally be a delay in the
processing of requests as they arrive as you need to wait for a thread to
become available.</p>
<p>That's why you measure. As you state, the vast majority of your threads will
be waiting for a response from the database so they won't be running. There
are two factors that affect how many threads you should allow for.</p>
<p>The first is the number of DB connections available. This may be a hard limit
unless you can increase it at the DBMS - I'm going to assume your DBMS can
take an unlimited number of connections in this case (although you should
ideally be measuring that as well).</p>
<p>Then, the number of threads you should have depend on your historical use. The
minimum you should have running is the minimum number that you've ever had
running + A%, with an absolute minimum of (for example, and make it
configurable just like A) 5.</p>
<p>The maximum number of threads should be your historical maximum + B%.</p>
<p>You should also be monitoring for behaviour changes. If, for some reason, your
usage goes to 100% of available for a significant time (so that it would
affect the performance of clients), you should bump up the maximum allowed
until it's once again B% higher.</p>
<hr>
<p><em>In response to the "what exactly should I measure?" question:</em></p>
<p>What you should measure specifically is the maximum amount of threads in
concurrent use (e.g., waiting on a return from the DB call) under load. Then
add a safety factor of 10% for <em>example</em> (emphasised, since other posters seem
to take my examples as fixed recommendations).</p>
<p>In addition, this should be done in the production environment for tuning.
It's okay to get an estimate beforehand but you never know what production
will throw your way (which is why all these things should be configurable at
runtime). This is to catch a situation such as unexpected doubling of the
client calls coming in.</p>
<p><br></p>
<h3>Suggest</h3>
<p>This question has been discussed quite thoroughly and I didn't get a chance to
read all the responses. But here's few things to take into consideration while
looking at the upper limit on number of simultaneous threads that can co-exist
peacefully in a given system.</p>
<ol>
<li>Thread Stack Size : In Linux the default thread stack size is 8MB (you can use ulimit -a to find it out). </li>
<li>Max Virtual memory that a given OS variant supports. Linux Kernel 2.4 supports a memory address space of 2 GB. with Kernel 2.6 , I a bit bigger (3GB ) </li>
<li>[1] shows the calculations for the max number of threads per given Max VM Supported. For 2.4 it turns out to be about 255 threads. for 2.6 the number is a bit larger. </li>
<li>What kindda kernel scheduler you have . Comparing Linux 2.4 kernel scheduler with 2.6 , the later gives you a O(1) scheduling with no dependence upon number of tasks existing in a system while first one is more of a O(n). So also the SMP Capabilities of the kernel schedule also play a good role in max number of sustainable threads in a system. </li>
</ol>
<p>Now you can tune your stack size to incorporate more threads but then you have
to take into account the overheads of thread management(creation/destruction
and scheduling). You can enforce CPU Affinity to a given process as well as to
a given thread to tie them down to specific CPUs to avoid thread migration
overheads between the CPUs and avoid cold cash issues.</p>
<p>Note that one can create thousands of threads at his/her wish , but when Linux
runs out of VM it just randomly starts killing processes (thus threads). This
is to keep the utility profile from being maxed out. (The utility function
tells about system wide utility for a given amount of resources. With a
constant resources in this case CPU Cycles and Memory, the utility curve
flattens out with more and more number of tasks ).</p>
<p>I am sure windows kernel scheduler also does something of this sort to deal
with over utilization of the resources</p>
<p>[1] http://adywicaksono.wordpress.com/2007/07/10/i-can-not-create-more-
than-255-threads-on-linux-what-is-the-solutions/</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/what-is-the-difference-between-jupyter-notebook-and-jupyterlab/" class="u-url">What is the difference between Jupyter Notebook and JupyterLab?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/what-is-the-difference-between-jupyter-notebook-and-jupyterlab/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T05:33:49+08:00" itemprop="datePublished" title="2023-03-04 05:33">2023-03-04 05:33</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I am new to Jupyter Notebook, what is the key difference between the Jupyter
Notebook and JupyterLab, suggest me to choose the best one, which should be
used in future.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Jupyter Notebook is a web-based interactive computational environment for
creating Jupyter notebook documents. It supports several languages like Python
(IPython), Julia, R etc. and is largely used for data analysis, data
visualization and further interactive, exploratory computing.</p>
<p>JupyterLab is the next-generation user interface <strong>including notebooks</strong>. It
has a modular structure, where you can open several notebooks or files (e.g.
HTML, Text, Markdowns etc) as tabs in the same window. It offers more of an
IDE-like experience.</p>
<p>For a beginner I would suggest starting with Jupyter Notebook as it just
consists of a filebrowser and an (notebook) editor view. It might be easier to
use. If you want more features, switch to JupyterLab. JupyterLab offers much
more features and an enhanced interface, which can be extended through
extensions: JupyterLab Extensions (GitHub)</p>
<p><br></p>
<h3>Suggest</h3>
<h4>1 - To answer your question directly:</h4>
<p>The single most important difference between the two is that <strong>you should
start using JupyterLab straight away</strong> , and that you should not worry about
Jupyter Notebook at all. Because:</p>
<blockquote>
<p>JupyterLab will eventually replace the classic Jupyter Notebook. Throughout
this transition, the same notebook document format will be supported by both
the classic Notebook and JupyterLab</p>
</blockquote>
<p>As of version 3.0, JupyterLab also comes with a <em><strong>visual debugger</strong></em> that
lets you interactively set breakpoints, step into functions, and inspect
variables.</p>
<h4>2 - To contradict the numerous claims in the comments that plotly does not</h4>
<p>run well with JLab:</p>
<p>JupyterLab is an absolutely fantastic tool both to build plotly figures, <em>and</em>
fire up complete Dash Apps both inline, as a tab, and externally in a browser.</p>
<h4>3 - And you would probably also like to know this:</h4>
<p>Other posts have suggested that Jupyter Notebook (JN) could potentially be
easier to use than JupyterLab (JL) for beginners. But I would have to
disagree.</p>
<p><strong>A great advantage with JL</strong> , and arguably one of the most important
differences between JL and JN, is that you can more easily run a single line
and even highlighted text. I prefer using a keyboard shortcut for this, and
assigning shortcuts is pretty straight-forward.</p>
<p>And the fact that you can execute code in a Python console makes JL much more
fun to work with. Other answers have already mentioned this, but JL can in
some ways be considered a tool to run Notebooks and <em>more</em>. So the way I use
JupyterLab is by having it set up with an .ipynb file, a file browser and a
python console like this:</p>
<p><img alt="enter image description here" src="images/TW9F4.png"></p>
<p>And now you have these tools at your disposal:</p>
<ol>
<li>View Files, running kernels, Commands, Notebook Tools, Open Tabs or Extension manager</li>
<li>Run cells using, among other options, <code>Ctrl+Enter</code>
</li>
<li>Run single expression, line or highlighted text using menu options or keyboard shortcuts</li>
<li>Run code directly in a console using <code>Shift+Enter</code>
</li>
<li>Inspect variables, dataframes or plots quickly and easily in a console without cluttering your notebook output.</li>
</ol>
</div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-2297.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-2295.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
