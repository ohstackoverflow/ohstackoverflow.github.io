<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 2056) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-2056.html">
<link rel="prev" href="index-2057.html" type="text/html">
<link rel="next" href="index-2055.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-does-one-declare-optional-methods-in-a-swift-protocol/" class="u-url">How does one declare optional methods in a Swift protocol?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-does-one-declare-optional-methods-in-a-swift-protocol/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T15:53:04+08:00" itemprop="datePublished" title="2023-03-03 15:53">2023-03-03 15:53</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Is it possible in Swift? If not then is there a workaround to do it?</p>
<p><br><br></p>
<h2>Answer</h2>
<h4>1. Using default implementations (preferred).</h4>
<div class="code"><pre class="code literal-block"><span class="n">protocol</span><span class="w"> </span><span class="n">MyProtocol</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">func</span><span class="w"> </span><span class="n">doSomething</span><span class="p">()</span>
<span class="p">}</span>

<span class="n">extension</span><span class="w"> </span><span class="n">MyProtocol</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">func</span><span class="w"> </span><span class="n">doSomething</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="o">/*</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="n">leave</span><span class="w"> </span><span class="n">empty</span><span class="w"> </span><span class="o">*/</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="n">struct</span><span class="w"> </span><span class="n">MyStruct</span><span class="p">:</span><span class="w"> </span><span class="n">MyProtocol</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="o">/*</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">compile</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="o">*/</span>
<span class="p">}</span>
</pre></div>

<p><strong>Advantages</strong></p>
<ul>
<li>
<p><strong>No Objective-C runtime is involved</strong> (well, no explicitly at least). This means you can conform structs, enums and non-<code>NSObject</code> classes to it. Also, this means you can take advantage of powerful generics system.</p>
</li>
<li>
<p><strong>You can always be sure that all requirements are met</strong> when encountering types that conform to such protocol. It's always either concrete implementation or default one. This is how "interfaces" or "contracts" behave in other languages.</p>
</li>
</ul>
<p><strong>Disadvantages</strong></p>
<ul>
<li>
<p><strong>For non-<code>Void</code> requirements, you need to have a reasonable default value</strong>, which is not always possible. However, when you encounter this problem, it means that either such requirement should really have no default implementation, or that your you made a mistake during API design.</p>
</li>
<li>
<p><strong>You can't distinguish between a default implementation and no implementation at all</strong> , at least without addressing that problem with special return values. Consider the following example:</p>
<div class="code"><pre class="code literal-block"><span class="n">protocol</span><span class="w"> </span><span class="n">SomeParserDelegate</span><span class="w"> </span><span class="p">{</span>
<span class="k">func</span><span class="w"> </span><span class="n">validate</span><span class="p">(</span><span class="n">value</span><span class="p">:</span><span class="w"> </span><span class="n">Any</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Bool</span>
</pre></div>

<p>}</p>
</li>
</ul>
<p>If you provide a default implementation which just returns <code>true</code> — it's fine
at the first glance. Now, consider the following pseudo code:</p>
<div class="code"><pre class="code literal-block"><span class="w">    </span><span class="n">final</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">SomeParser</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="n">func</span><span class="w"> </span><span class="nf">parse</span><span class="p">(</span><span class="k">data</span><span class="err">:</span><span class="w"> </span><span class="k">Data</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">[</span><span class="n">Any</span><span class="o">]</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="cm">/* delegate.validate(value:) is not implemented */</span><span class="w"> </span><span class="err">{</span>
<span class="w">            </span><span class="cm">/* parse very fast without validating */</span>
<span class="w">        </span><span class="err">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="err">{</span>
<span class="w">            </span><span class="cm">/* parse and validate every value */</span>
<span class="w">        </span><span class="err">}</span>
<span class="w">    </span><span class="err">}</span>
<span class="err">}</span>
</pre></div>

<p>There's no way to implement such an optimization — you can't know if your
delegate implements a method or not.</p>
<p>Although there's a number of different ways to overcome this problem (using
optional closures, different delegate objects for different operations to name
a few), that example presents the problem clearly.</p>
<hr>
<h4>2. Using <code>@objc optional</code>.</h4>
<div class="code"><pre class="code literal-block"><span class="err">@</span><span class="n">objc</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="n">MyProtocol</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="err">@</span><span class="n">objc</span><span class="w"> </span><span class="n">optional</span><span class="w"> </span><span class="k">func</span><span class="w"> </span><span class="n">doSomething</span><span class="p">()</span>
<span class="p">}</span>

<span class="k">class</span><span class="w"> </span><span class="n">MyClass</span><span class="p">:</span><span class="w"> </span><span class="n">NSObject</span><span class="p">,</span><span class="w"> </span><span class="n">MyProtocol</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="o">/*</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">compile</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="o">*/</span>
<span class="p">}</span>
</pre></div>

<p><strong>Advantages</strong></p>
<ul>
<li>
<strong>No default implementation is needed.</strong> You just declare an optional method or a variable and you're ready to go.</li>
</ul>
<p><strong>Disadvantages</strong></p>
<ul>
<li>
<p><strong>It severely limits your protocol's capabilities</strong> by requiring all conforming types to be Objective-C compatible. This means, only classes that inherit from <code>NSObject</code> can conform to such protocol. No structs, no enums, no associated types.</p>
</li>
<li>
<p><strong>You must always check if an optional method is implemented</strong> by either optionally calling or checking if the conforming type implements it. This might introduce a lot of boilerplate if you're calling optional methods often.</p>
</li>
</ul>
<p><br></p>
<h3>Suggest</h3>
<p>In Swift 2 and onwards it's possible to add default implementations of a
protocol. This creates a new way of optional methods in protocols.</p>
<div class="code"><pre class="code literal-block"><span class="n">protocol</span><span class="w"> </span><span class="n">MyProtocol</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">func</span><span class="w"> </span><span class="n">doSomethingNonOptionalMethod</span><span class="p">()</span>
<span class="w">    </span><span class="k">func</span><span class="w"> </span><span class="n">doSomethingOptionalMethod</span><span class="p">()</span>
<span class="p">}</span>

<span class="n">extension</span><span class="w"> </span><span class="n">MyProtocol</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">func</span><span class="w"> </span><span class="n">doSomethingOptionalMethod</span><span class="p">(){</span><span class="w"> </span>
<span class="w">        </span><span class="o">//</span><span class="w"> </span><span class="n">leaving</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">empty</span><span class="w"> </span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p>It's not a really nice way in creating optional protocol methods, but gives
you the possibility to use structs in in protocol callbacks.</p>
<p>I wrote a small summary here: https://www.avanderlee.com/swift-2-0/optional-
protocol-methods/</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/why-should-i-use-core-autocrlf-true-in-git/" class="u-url">Why should I use core.autocrlf=true in Git?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/why-should-i-use-core-autocrlf-true-in-git/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T15:52:32+08:00" itemprop="datePublished" title="2023-03-03 15:52">2023-03-03 15:52</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I have a Git repository that is accessed from both Windows and OS X, and that
I know already contains some files with CRLF line-endings. As far as I can
tell, there are two ways to deal with this:</p>
<ol>
<li>
<p>Set <code>core.autocrlf</code> to <code>false</code> everywhere,</p>
</li>
<li>
<p>Follow the instructions here (echoed on GitHub's help pages) to convert the repository to contain only LF line-endings, and thereafter set <code>core.autocrlf</code> to <code>true</code> on Windows and <code>input</code> on OS X. The problem with doing this is that if I have any binary files in the repository that: </p>
<ol>
<li>are not correctly marked as binary in gitattributes, and </li>
<li>happen to contain both CRLFs and LFs,</li>
</ol>
</li>
</ol>
<p>they will be corrupted. It is possible my repository contains such files.</p>
<p>So why shouldn't I just turn off Git's line-ending conversion? There are a lot
of vague warnings on the web about having <code>core.autocrlf</code> switched off causing
problems, but very few <em>specific</em> ones; the only that I've found so far are
that kdiff3 cannot handle CRLF endings (not a problem for me), and that some
text editors have line-ending issues (also not a problem for me).</p>
<p>The repository is internal to my company, and so I don't need to worry about
sharing it with people with different autocrlf settings or line-ending
requirements.</p>
<p>Are there any other problems with just leaving line-endings as-is that I am
unaware of?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>The only specific reasons to set <code>autocrlf</code> to <code>true</code> are:</p>
<ul>
<li>avoid <code>git status</code> showing all your files as <code>modified</code> because of the automatic EOL conversion done when cloning a Unix-based EOL Git repo to a Windows one (see issue 83 for instance)</li>
<li>
<em>and</em> your coding tools somehow depends on a <em>native</em> EOL style being present in your file: <ul>
<li>for instance, a code generator hard-coded to detect native EOL</li>
<li>other external batches (external to your repo) with regexp or code set to detect native EOL</li>
<li>I believe some Eclipse plugins can produce files with CRLF regardless on platform, which can be a problem.</li>
<li>You code with Notepad.exe (unless you are using a Windows 10 2018.09+, where Notepad respects the EOL character detected).</li>
</ul>
</li>
</ul>
<p>Unless you can see specific treatment which <em>must</em> deal with native EOL, you
are better off leaving <code>autocrlf</code> to <code>false</code> (<code>git config --global
core.autocrlf false</code>).</p>
<p>Note that this config would be a <em>local</em> one (because config isn't pushed from
repo to repo)</p>
<p>If you want the same config for all users cloning that repo, check out "What's
the best <code>CRLF</code> handling strategy with git?", using the <strong><code>text</code></strong> attribute
in the <strong><code>.gitattributes</code></strong> file.</p>
<p>Example:</p>
<div class="code"><pre class="code literal-block">*.vcproj    text eol=crlf
*.sh        text eol=lf
</pre></div>

<hr>
<p>Note: starting git 2.8 (March 2016), merge markers will <em>no longer</em> introduce
mixed line ending (LF) in a CRLF file.<br>
See "Make Git use CRLF on its “&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD” merge lines"</p>
<p><br></p>
<h3>Suggest</h3>
<p>I am a .NET developer and have used Git and Visual Studio for years. My strong
recommendation is to set line endings to true. And do it as early as you can
in the lifetime of your Repository.</p>
<p>That being said, I HATE that Git changes my line endings. Source control
should only save and retrieve the work I do, it should NOT modify it. Ever.
But it does.</p>
<p>What will happen if you don't have every developer set to true, is ONE
developer eventually will set to true. This will begin to change the line
endings of all of your files to LF in your repo. And when users set to false
check those out, Visual Studio will warn you, and ask you to change them. You
will have 2 things happen very quickly. One, you will get more and more of
those warnings, the bigger your team the more you get. The second, and worse
thing, is that it will show that every line of every modified file was
changed(because the line endings of every line will be changed by the true
guy). Eventually, you won't be able to track changes in your repo reliably
anymore. It is MUCH easier and cleaner to make everyone keep to true than to
try to keep everyone false. As horrible as it is to live with the fact that
your trusted source control is doing something it should not. Ever.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/nullable-annotation-usage/" class="u-url">@Nullable annotation usage</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/nullable-annotation-usage/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T15:52:11+08:00" itemprop="datePublished" title="2023-03-03 15:52">2023-03-03 15:52</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I saw some method in java declared as:</p>
<div class="code"><pre class="code literal-block"><span class="n">void</span><span class="w"> </span><span class="n">foo</span><span class="p">(</span><span class="nv">@Nullable</span><span class="w"> </span><span class="k">Object</span><span class="w"> </span><span class="n">obj</span><span class="p">)</span>
<span class="err">{</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="err">}</span>
</pre></div>

<p>What's the meaning of <code>@Nullable</code> here? Does it mean the input could be
<code>null</code>?</p>
<p>Without the annotation, the input can still be null, so I guess that's not
just it?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>It makes it clear that the method accepts null values, and that if you
override the method, you should also accept null values.</p>
<p>It also serves as a hint for code analyzers like FindBugs. For example, if
such a method dereferences its argument without checking for null first,
FindBugs will emit a warning.</p>
<p><br></p>
<h3>Suggest</h3>
<p>This annotation is commonly used to eliminate <code>NullPointerExceptions</code>.
<code>@Nullable</code> says that this parameter might be <code>null</code>. A good example of such
behaviour can be found in Google Guice. In this lightweight dependency
injection framework you can tell that this dependency might be <code>null</code>. If you
would try to pass <code>null</code> without an annotation the framework would refuse to
do it's job.</p>
<p>What is more, <code>@Nullable</code> might be used with <code>@NotNull</code> annotation. Here you
can find some tips on how to use them properly. Code inspection in IntelliJ
checks the annotations and helps to debug the code.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-2057.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-2055.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
