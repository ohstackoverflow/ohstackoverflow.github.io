<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 2214) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-2214.html">
<link rel="prev" href="index-2215.html" type="text/html">
<link rel="next" href="index-2213.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-get-stackpanel-s-children-to-fill-maximum-space-downward/" class="u-url">How to get StackPanel's children to fill maximum space downward?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-get-stackpanel-s-children-to-fill-maximum-space-downward/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T23:22:44+08:00" itemprop="datePublished" title="2023-03-03 23:22">2023-03-03 23:22</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I simply want flowing text on the left, and a help box on the right.</p>
<p>The help box should extend all the way to the bottom.</p>
<p>If you take out the outer <code>StackPanel</code> below it works great.</p>
<p>But for reasons of layout (I'm inserting UserControls dynamically) I need to
have the wrapping <code>StackPanel</code>.</p>
<p>How do I get the <code>GroupBox</code> to extend down to the bottom of the <code>StackPanel</code>,
as you can see I've tried:</p>
<ul>
<li><code>VerticalAlignment="Stretch"</code></li>
<li><code>VerticalContentAlignment="Stretch"</code></li>
<li><code>Height="Auto"</code></li>
</ul>
<p>XAML:</p>
<div class="code"><pre class="code literal-block"><span class="nt">&lt;Window</span><span class="w"> </span><span class="na">x:Class=</span><span class="s">"TestDynamic033.Test3"</span>
<span class="w">    </span><span class="na">xmlns=</span><span class="s">"http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span>
<span class="w">    </span><span class="na">xmlns:x=</span><span class="s">"http://schemas.microsoft.com/winfx/2006/xaml"</span>
<span class="w">    </span><span class="na">Title=</span><span class="s">"Test3"</span><span class="w"> </span><span class="na">Height=</span><span class="s">"300"</span><span class="w"> </span><span class="na">Width=</span><span class="s">"600"</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;StackPanel</span><span class="w"> </span>
<span class="w">        </span><span class="na">VerticalAlignment=</span><span class="s">"Stretch"</span><span class="w"> </span>
<span class="w">        </span><span class="na">Height=</span><span class="s">"Auto"</span><span class="nt">&gt;</span>

<span class="w">        </span><span class="nt">&lt;DockPanel</span><span class="w"> </span>
<span class="w">            </span><span class="na">HorizontalAlignment=</span><span class="s">"Stretch"</span><span class="w"> </span>
<span class="w">            </span><span class="na">VerticalAlignment=</span><span class="s">"Stretch"</span><span class="w"> </span>
<span class="w">            </span><span class="na">Height=</span><span class="s">"Auto"</span><span class="w"> </span>
<span class="w">            </span><span class="na">Margin=</span><span class="s">"10"</span><span class="nt">&gt;</span>

<span class="w">            </span><span class="nt">&lt;GroupBox</span><span class="w"> </span>
<span class="w">                </span><span class="na">DockPanel.Dock=</span><span class="s">"Right"</span><span class="w"> </span>
<span class="w">                </span><span class="na">Header=</span><span class="s">"Help"</span><span class="w"> </span>
<span class="w">                </span><span class="na">Width=</span><span class="s">"100"</span><span class="w"> </span>
<span class="w">                </span><span class="na">Background=</span><span class="s">"Beige"</span><span class="w"> </span>
<span class="w">                </span><span class="na">VerticalAlignment=</span><span class="s">"Stretch"</span><span class="w"> </span>
<span class="w">                </span><span class="na">VerticalContentAlignment=</span><span class="s">"Stretch"</span><span class="w"> </span>
<span class="w">                </span><span class="na">Height=</span><span class="s">"Auto"</span><span class="nt">&gt;</span>
<span class="w">                </span><span class="nt">&lt;TextBlock</span><span class="w"> </span><span class="na">Text=</span><span class="s">"This is the help that is available on the news screen."</span><span class="w"> </span><span class="na">TextWrapping=</span><span class="s">"Wrap"</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;/GroupBox&gt;</span>

<span class="w">            </span><span class="nt">&lt;StackPanel</span><span class="w"> </span><span class="na">DockPanel.Dock=</span><span class="s">"Left"</span><span class="w"> </span><span class="na">Margin=</span><span class="s">"10"</span><span class="w"> </span><span class="na">Width=</span><span class="s">"Auto"</span><span class="w"> </span><span class="na">HorizontalAlignment=</span><span class="s">"Stretch"</span><span class="nt">&gt;</span>
<span class="w">                </span><span class="nt">&lt;TextBlock</span><span class="w"> </span><span class="na">Text=</span><span class="s">"Here is the news that should wrap around."</span><span class="w"> </span><span class="na">TextWrapping=</span><span class="s">"Wrap"</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;/StackPanel&gt;</span>

<span class="w">        </span><span class="nt">&lt;/DockPanel&gt;</span>
<span class="w">    </span><span class="nt">&lt;/StackPanel&gt;</span>
<span class="nt">&lt;/Window&gt;</span>
</pre></div>

<h3>Answer:</h3>
<p>Thanks Mark, using <code>DockPanel</code> instead of <code>StackPanel</code> cleared it up. In
general, I find myself using <code>DockPanel</code> more and more now for WPF layouting,
here's the fixed XAML:</p>
<div class="code"><pre class="code literal-block"><span class="nt">&lt;Window</span><span class="w"> </span><span class="na">x:Class=</span><span class="s">"TestDynamic033.Test3"</span>
<span class="w">    </span><span class="na">xmlns=</span><span class="s">"http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span>
<span class="w">    </span><span class="na">xmlns:x=</span><span class="s">"http://schemas.microsoft.com/winfx/2006/xaml"</span>
<span class="w">    </span><span class="na">Title=</span><span class="s">"Test3"</span><span class="w"> </span><span class="na">Height=</span><span class="s">"300"</span><span class="w"> </span><span class="na">Width=</span><span class="s">"600"</span><span class="w"> </span><span class="na">MinWidth=</span><span class="s">"500"</span><span class="w"> </span><span class="na">MinHeight=</span><span class="s">"200"</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;DockPanel</span><span class="w"> </span>
<span class="w">        </span><span class="na">VerticalAlignment=</span><span class="s">"Stretch"</span><span class="w"> </span>
<span class="w">        </span><span class="na">Height=</span><span class="s">"Auto"</span><span class="nt">&gt;</span>

<span class="w">        </span><span class="nt">&lt;DockPanel</span><span class="w"> </span>
<span class="w">            </span><span class="na">HorizontalAlignment=</span><span class="s">"Stretch"</span><span class="w"> </span>
<span class="w">            </span><span class="na">VerticalAlignment=</span><span class="s">"Stretch"</span><span class="w"> </span>
<span class="w">            </span><span class="na">Height=</span><span class="s">"Auto"</span><span class="w"> </span>
<span class="w">            </span><span class="na">MinWidth=</span><span class="s">"400"</span>
<span class="w">            </span><span class="na">Margin=</span><span class="s">"10"</span><span class="nt">&gt;</span>

<span class="w">            </span><span class="nt">&lt;GroupBox</span><span class="w"> </span>
<span class="w">                </span><span class="na">DockPanel.Dock=</span><span class="s">"Right"</span><span class="w"> </span>
<span class="w">                </span><span class="na">Header=</span><span class="s">"Help"</span><span class="w"> </span>
<span class="w">                </span><span class="na">Width=</span><span class="s">"100"</span><span class="w"> </span>
<span class="w">                </span><span class="na">VerticalAlignment=</span><span class="s">"Stretch"</span><span class="w"> </span>
<span class="w">                </span><span class="na">VerticalContentAlignment=</span><span class="s">"Stretch"</span><span class="w"> </span>
<span class="w">                </span><span class="na">Height=</span><span class="s">"Auto"</span><span class="nt">&gt;</span>
<span class="w">                </span><span class="nt">&lt;Border</span><span class="w"> </span><span class="na">CornerRadius=</span><span class="s">"3"</span><span class="w"> </span><span class="na">Background=</span><span class="s">"Beige"</span><span class="nt">&gt;</span>
<span class="w">                    </span><span class="nt">&lt;TextBlock</span><span class="w"> </span><span class="na">Text=</span><span class="s">"This is the help that is available on the news screen."</span><span class="w"> </span><span class="na">TextWrapping=</span><span class="s">"Wrap"</span>

<span class="w">                </span><span class="na">Padding=</span><span class="s">"5"</span><span class="nt">/&gt;</span>
<span class="w">                </span><span class="nt">&lt;/Border&gt;</span>
<span class="w">            </span><span class="nt">&lt;/GroupBox&gt;</span>

<span class="w">            </span><span class="nt">&lt;StackPanel</span><span class="w"> </span><span class="na">DockPanel.Dock=</span><span class="s">"Left"</span><span class="w"> </span><span class="na">Margin=</span><span class="s">"10"</span><span class="w"> </span><span class="na">Width=</span><span class="s">"Auto"</span><span class="w"> </span><span class="na">HorizontalAlignment=</span><span class="s">"Stretch"</span><span class="nt">&gt;</span>
<span class="w">                </span><span class="nt">&lt;TextBlock</span><span class="w"> </span><span class="na">Text=</span><span class="s">"Here is the news that should wrap around."</span><span class="w"> </span><span class="na">TextWrapping=</span><span class="s">"Wrap"</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;/StackPanel&gt;</span>

<span class="w">        </span><span class="nt">&lt;/DockPanel&gt;</span>
<span class="w">    </span><span class="nt">&lt;/DockPanel&gt;</span>
<span class="nt">&lt;/Window&gt;</span>
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<p>It sounds like you want a <code>StackPanel</code> where the final element uses up all the
remaining space. But why not use a <code>DockPanel</code>? Decorate the other elements in
the <code>DockPanel</code> with <code>DockPanel.Dock="Top"</code>, and then your help control can
fill the remaining space.</p>
<p>XAML:</p>
<div class="code"><pre class="code literal-block"><span class="nt">&lt;DockPanel</span><span class="w"> </span><span class="na">Width=</span><span class="s">"200"</span><span class="w"> </span><span class="na">Height=</span><span class="s">"200"</span><span class="w"> </span><span class="na">Background=</span><span class="s">"PowderBlue"</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;TextBlock</span><span class="w"> </span><span class="na">DockPanel.Dock=</span><span class="s">"Top"</span><span class="nt">&gt;</span>Something<span class="nt">&lt;/TextBlock&gt;</span>
<span class="w">    </span><span class="nt">&lt;TextBlock</span><span class="w"> </span><span class="na">DockPanel.Dock=</span><span class="s">"Top"</span><span class="nt">&gt;</span>Something<span class="w"> </span>else<span class="nt">&lt;/TextBlock&gt;</span>
<span class="w">    </span><span class="nt">&lt;DockPanel</span>
<span class="w">        </span><span class="na">HorizontalAlignment=</span><span class="s">"Stretch"</span><span class="w"> </span>
<span class="w">        </span><span class="na">VerticalAlignment=</span><span class="s">"Stretch"</span><span class="w"> </span>
<span class="w">        </span><span class="na">Height=</span><span class="s">"Auto"</span><span class="w"> </span>
<span class="w">        </span><span class="na">Margin=</span><span class="s">"10"</span><span class="nt">&gt;</span>

<span class="w">      </span><span class="nt">&lt;GroupBox</span><span class="w"> </span>
<span class="w">        </span><span class="na">DockPanel.Dock=</span><span class="s">"Right"</span><span class="w"> </span>
<span class="w">        </span><span class="na">Header=</span><span class="s">"Help"</span><span class="w"> </span>
<span class="w">        </span><span class="na">Width=</span><span class="s">"100"</span><span class="w"> </span>
<span class="w">        </span><span class="na">Background=</span><span class="s">"Beige"</span><span class="w"> </span>
<span class="w">        </span><span class="na">VerticalAlignment=</span><span class="s">"Stretch"</span><span class="w"> </span>
<span class="w">        </span><span class="na">VerticalContentAlignment=</span><span class="s">"Stretch"</span><span class="w"> </span>
<span class="w">        </span><span class="na">Height=</span><span class="s">"Auto"</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;TextBlock</span><span class="w"> </span><span class="na">Text=</span><span class="s">"This is the help that is available on the news screen."</span><span class="w"> </span>
<span class="w">                   </span><span class="na">TextWrapping=</span><span class="s">"Wrap"</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">     </span><span class="nt">&lt;/GroupBox&gt;</span>

<span class="w">      </span><span class="nt">&lt;StackPanel</span><span class="w"> </span><span class="na">DockPanel.Dock=</span><span class="s">"Left"</span><span class="w"> </span><span class="na">Margin=</span><span class="s">"10"</span><span class="w"> </span>
<span class="w">           </span><span class="na">Width=</span><span class="s">"Auto"</span><span class="w"> </span><span class="na">HorizontalAlignment=</span><span class="s">"Stretch"</span><span class="nt">&gt;</span>
<span class="w">          </span><span class="nt">&lt;TextBlock</span><span class="w"> </span><span class="na">Text=</span><span class="s">"Here is the news that should wrap around."</span><span class="w"> </span>
<span class="w">                     </span><span class="na">TextWrapping=</span><span class="s">"Wrap"</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;/StackPanel&gt;</span>
<span class="w">    </span><span class="nt">&lt;/DockPanel&gt;</span>
<span class="nt">&lt;/DockPanel&gt;</span>
</pre></div>

<p>If you are on a platform without <code>DockPanel</code> available (e.g. WindowsStore),
you can create the same effect with a grid. Here's the above example
accomplished using grids instead:</p>
<div class="code"><pre class="code literal-block"><span class="nt">&lt;Grid</span><span class="w"> </span><span class="na">Width=</span><span class="s">"200"</span><span class="w"> </span><span class="na">Height=</span><span class="s">"200"</span><span class="w"> </span><span class="na">Background=</span><span class="s">"PowderBlue"</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Grid.RowDefinitions&gt;</span>
<span class="w">        </span><span class="nt">&lt;RowDefinition</span><span class="w"> </span><span class="na">Height=</span><span class="s">"Auto"</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;RowDefinition</span><span class="w"> </span><span class="na">Height=</span><span class="s">"*"</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/Grid.RowDefinitions&gt;</span>
<span class="w">    </span><span class="nt">&lt;StackPanel</span><span class="w"> </span><span class="na">Grid.Row=</span><span class="s">"0"</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;TextBlock&gt;</span>Something<span class="nt">&lt;/TextBlock&gt;</span>
<span class="w">        </span><span class="nt">&lt;TextBlock&gt;</span>Something<span class="w"> </span>else<span class="nt">&lt;/TextBlock&gt;</span>
<span class="w">    </span><span class="nt">&lt;/StackPanel&gt;</span>
<span class="w">    </span><span class="nt">&lt;Grid</span><span class="w"> </span><span class="na">Height=</span><span class="s">"Auto"</span><span class="w"> </span><span class="na">Grid.Row=</span><span class="s">"1"</span><span class="w"> </span><span class="na">Margin=</span><span class="s">"10"</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;Grid.ColumnDefinitions&gt;</span>
<span class="w">            </span><span class="nt">&lt;ColumnDefinition</span><span class="w"> </span><span class="na">Width=</span><span class="s">"*"</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;ColumnDefinition</span><span class="w"> </span><span class="na">Width=</span><span class="s">"100"</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;/Grid.ColumnDefinitions&gt;</span>
<span class="w">        </span><span class="nt">&lt;GroupBox</span>
<span class="w">            </span><span class="na">Width=</span><span class="s">"100"</span>
<span class="w">            </span><span class="na">Height=</span><span class="s">"Auto"</span>
<span class="w">            </span><span class="na">Grid.Column=</span><span class="s">"1"</span>
<span class="w">            </span><span class="na">Background=</span><span class="s">"Beige"</span>
<span class="w">            </span><span class="na">Header=</span><span class="s">"Help"</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;TextBlock</span><span class="w"> </span><span class="na">Text=</span><span class="s">"This is the help that is available on the news screen."</span><span class="w"> </span>
<span class="w">              </span><span class="na">TextWrapping=</span><span class="s">"Wrap"</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;/GroupBox&gt;</span>
<span class="w">        </span><span class="nt">&lt;StackPanel</span><span class="w"> </span><span class="na">Width=</span><span class="s">"Auto"</span><span class="w"> </span><span class="na">Margin=</span><span class="s">"10"</span><span class="w"> </span><span class="na">DockPanel.Dock=</span><span class="s">"Left"</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;TextBlock</span><span class="w"> </span><span class="na">Text=</span><span class="s">"Here is the news that should wrap around."</span><span class="w"> </span>
<span class="w">              </span><span class="na">TextWrapping=</span><span class="s">"Wrap"</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;/StackPanel&gt;</span>
<span class="w">    </span><span class="nt">&lt;/Grid&gt;</span>
<span class="nt">&lt;/Grid&gt;</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>The reason that this is happening is because the stack panel measures every
child element with positive infinity as the constraint for the axis that it is
stacking elements along. The child controls have to return how big they want
to be (positive infinity is not a valid return from the MeasureOverride in
either axis) so they return the smallest size where everything will fit. They
have no way of knowing how much space they really have to fill.</p>
<p>If your view doesn’t need to have a scrolling feature and the answer above
doesn't suit your needs, I would suggest implement your own panel. You can
probably derive straight from StackPanel and then all you will need to do is
change the ArrangeOverride method so that it divides the remaining space up
between its child elements (giving them each the same amount of extra space).
Elements should render fine if they are given more space than they wanted, but
if you give them less you will start to see glitches.</p>
<p>If you want to be able to scroll the whole thing then I am afraid things will
be quite a bit more difficult, because the ScrollViewer gives you an infinite
amount of space to work with which will put you in the same position as the
child elements were originally. In this situation you might want to create a
new property on your new panel which lets you specify the viewport size, you
should be able to bind this to the ScrollViewer’s size. Ideally you would
implement IScrollInfo, but that starts to get complicated if you are going to
implement all of it properly.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/what-s-wrong-with-overridable-method-calls-in-constructors/" class="u-url">What's wrong with overridable method calls in constructors?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/what-s-wrong-with-overridable-method-calls-in-constructors/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T23:21:25+08:00" itemprop="datePublished" title="2023-03-03 23:21">2023-03-03 23:21</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I have a Wicket page class that sets the page title depending on the result of
an abstract method.</p>
<div class="code"><pre class="code literal-block"><span class="n">public</span><span class="w"> </span><span class="n">abstract</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">BasicPage</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="n">WebPage</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="n">public</span><span class="w"> </span><span class="n">BasicPage</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">add</span><span class="p">(</span><span class="n">new</span><span class="w"> </span><span class="n">Label</span><span class="p">(</span><span class="s2">"title"</span><span class="p">,</span><span class="w"> </span><span class="n">getTitle</span><span class="p">()));</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">protected</span><span class="w"> </span><span class="n">abstract</span><span class="w"> </span><span class="nb nb-Type">String</span><span class="w"> </span><span class="n">getTitle</span><span class="p">();</span>

<span class="p">}</span>
</pre></div>

<p>NetBeans warns me with the message "Overridable method call in constructor",
but what should be wrong with it? The only alternative I can imagine is to
pass the results of otherwise abstract methods to the super constructor in
subclasses. But that could be hard to read with many parameters.</p>
<p><br><br></p>
<h2>Answer</h2>
<h4>On invoking overridable method from constructors</h4>
<p>Simply put, this is wrong because it unnecessarily opens up possibilities to
<em>MANY</em> bugs. When the <code>@Override</code> is invoked, the state of the object may be
inconsistent and/or incomplete.</p>
<p>A quote from <em>Effective Java 2nd Edition, Item 17: Design and document for
inheritance, or else prohibit it</em> :</p>
<blockquote>
<p>There are a few more restrictions that a class must obey to allow
inheritance. <strong>Constructors must not invoke overridable methods</strong> , directly
or indirectly. If you violate this rule, program failure will result. The
superclass constructor runs before the subclass constructor, so the
overriding method in the subclass will be invoked before the subclass
constructor has run. If the overriding method depends on any initialization
performed by the subclass constructor, the method will not behave as
expected.</p>
</blockquote>
<p>Here's an example to illustrate:</p>
<div class="code"><pre class="code literal-block"><span class="n">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">ConstructorCallsOverride</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="w"> </span><span class="n">main</span><span class="p">(</span><span class="nb nb-Type">String</span><span class="p">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="n">abstract</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">Base</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Base</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">overrideMe</span><span class="p">();</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="n">abstract</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="w"> </span><span class="n">overrideMe</span><span class="p">();</span><span class="w"> </span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">class</span><span class="w"> </span><span class="n">Child</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="n">Base</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="n">final</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>

<span class="w">            </span><span class="n">Child</span><span class="p">(</span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">this</span><span class="o">.</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="err">@</span><span class="n">Override</span>
<span class="w">            </span><span class="nb nb-Type">void</span><span class="w"> </span><span class="n">overrideMe</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">System</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">println</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">new</span><span class="w"> </span><span class="n">Child</span><span class="p">(</span><span class="mi">42</span><span class="p">);</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">prints</span><span class="w"> </span><span class="s2">"0"</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p>Here, when <code>Base</code> constructor calls <code>overrideMe</code>, <code>Child</code> has not finished
initializing the <code>final int x</code>, and the method gets the wrong value. This will
almost certainly lead to bugs and errors.</p>
<h4>Related questions</h4>
<ul>
<li>Calling an Overridden Method from a Parent-Class Constructor</li>
<li>State of Derived class object when Base class constructor calls overridden method in Java</li>
<li>Using abstract init() function in abstract class’s constructor</li>
</ul>
<h4>See also</h4>
<ul>
<li>FindBugs - Uninitialized read of field method called from constructor of superclass </li>
</ul>
<hr>
<h4>On object construction with many parameters</h4>
<p>Constructors with many parameters can lead to poor readability, and better
alternatives exist.</p>
<p>Here's a quote from <em>Effective Java 2nd Edition, Item 2: Consider a builder
pattern when faced with many constructor parameters</em> :</p>
<blockquote>
<p>Traditionally, programmers have used the <em>telescoping constructor</em> pattern,
in which you provide a constructor with only the required parameters,
another with a single optional parameters, a third with two optional
parameters, and so on...</p>
</blockquote>
<p>The telescoping constructor pattern is essentially something like this:</p>
<div class="code"><pre class="code literal-block">public class Telescope {
    final String name;
    final int levels;
    final boolean isAdjustable;

    public Telescope(String name) {
        this(name, 5);
    }
    public Telescope(String name, int levels) {
        this(name, levels, false);
    }
    public Telescope(String name, int levels, boolean isAdjustable) {       
        this.name = name;
        this.levels = levels;
        this.isAdjustable = isAdjustable;
    }
}
</pre></div>

<p>And now you can do any of the following:</p>
<div class="code"><pre class="code literal-block">new Telescope("X/1999");
new Telescope("X/1999", 13);
new Telescope("X/1999", 13, true);
</pre></div>

<p>You can't, however, currently set only the <code>name</code> and <code>isAdjustable</code>, and
leaving <code>levels</code> at default. You can provide more constructor overloads, but
obviously the number would explode as the number of parameters grow, and you
may even have multiple <code>boolean</code> and <code>int</code> arguments, which would really make
a mess out of things.</p>
<p>As you can see, this isn't a pleasant pattern to write, and even less pleasant
to use (What does "true" mean here? What's 13?).</p>
<p>Bloch recommends using a builder pattern, which would allow you to write
something like this instead:</p>
<div class="code"><pre class="code literal-block">Telescope telly = new Telescope.Builder("X/1999").setAdjustable(true).build();
</pre></div>

<p>Note that now the parameters are named, and you can set them in any order you
want, and you can skip the ones that you want to keep at default values. This
is certainly much better than telescoping constructors, especially when
there's a huge number of parameters that belong to many of the same types.</p>
<h4>See also</h4>
<ul>
<li>Wikipedia/Builder pattern</li>
<li>
<em>Effective Java 2nd Edition, Item 2: Consider a builder pattern when faced with many constructor parameters</em> (excerpt online)</li>
</ul>
<h4>Related questions</h4>
<ul>
<li>When would you use the Builder Pattern?</li>
<li>Is this a well known design pattern? What is its name?</li>
</ul>
<p><br></p>
<h3>Suggest</h3>
<p>Here's an example which helps to understand this:</p>
<div class="code"><pre class="code literal-block"><span class="n">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">Main</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="n">abstract</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">abstract</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="w"> </span><span class="n">foo</span><span class="p">();</span>
<span class="w">        </span><span class="n">A</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">System</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">println</span><span class="p">(</span><span class="s2">"Constructing A"</span><span class="p">);</span>
<span class="w">            </span><span class="n">foo</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">C</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="w">            </span><span class="n">System</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">println</span><span class="p">(</span><span class="s2">"Constructing C"</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="nb nb-Type">void</span><span class="w"> </span><span class="n">foo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="w">            </span><span class="n">System</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">println</span><span class="p">(</span><span class="s2">"Using C"</span><span class="p">);</span><span class="w"> </span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="w"> </span><span class="n">main</span><span class="p">(</span><span class="nb nb-Type">String</span><span class="p">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">C</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">C</span><span class="p">();</span><span class="w"> </span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p>If you run this code, you get the following output:</p>
<div class="code"><pre class="code literal-block">Constructing A
Using C
Constructing C
</pre></div>

<p>You see? <code>foo()</code> makes use of C before C's constructor has been run. If
<code>foo()</code> requires C to have a defined state (i.e. the constructor <em>has
finished</em> ), then it will encounter an undefined state in C and things might
break. And since you can't know in A what the overwritten <code>foo()</code> expects, you
get a warning.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/why-should-one-use-objects-requirenonnull/" class="u-url">Why should one use Objects.requireNonNull()?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/why-should-one-use-objects-requirenonnull/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T23:20:04+08:00" itemprop="datePublished" title="2023-03-03 23:20">2023-03-03 23:20</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I have noted that many Java 8 methods in Oracle JDK use
<code>Objects.requireNonNull()</code>, which internally throws <code>NullPointerException</code> if
the given object (argument) is <code>null</code>.</p>
<div class="code"><pre class="code literal-block"><span class="nv">public</span><span class="w"> </span><span class="nv">static</span><span class="w"> </span><span class="o">&lt;</span><span class="nv">T</span><span class="o">&gt;</span><span class="w"> </span><span class="nv">T</span><span class="w"> </span><span class="nv">requireNonNull</span><span class="ss">(</span><span class="nv">T</span><span class="w"> </span><span class="nv">obj</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">obj</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nv">null</span><span class="ss">)</span>
<span class="w">        </span><span class="nv">throw</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">NullPointerException</span><span class="ss">()</span><span class="c1">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nv">obj</span><span class="c1">;</span>
}
</pre></div>

<p>But <code>NullPointerException</code> will be thrown anyway if a <code>null</code> object is
dereferenced. So, why should one do this extra null check and throw
<code>NullPointerException</code>?</p>
<p>One obvious answer (or benefit) is that it makes code more readable and I
agree. I'm keen to know any other reasons for using <code>Objects.requireNonNull()</code>
in the beginning of the method.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Because you can make things <strong>explicit</strong> by doing so. Like:</p>
<div class="code"><pre class="code literal-block">public class Foo {
  private final Bar bar;

  public Foo(Bar bar) {
    Objects.requireNonNull(bar, "bar must not be null");
    this.bar = bar;
  }
</pre></div>

<p>Or shorter:</p>
<div class="code"><pre class="code literal-block">  this.bar = Objects.requireNonNull(bar, "bar must not be null");
</pre></div>

<p>Now you <strong>know</strong> :</p>
<ul>
<li>
<em>when</em> a Foo object was successfully created using <code>new()</code>
</li>
<li>
<em>then</em> its <em>bar</em> field is <strong>guaranteed</strong> be non-null.</li>
</ul>
<p>Compare that to: you create a Foo object today, and <strong>tomorrow</strong> you invoke a
method that uses that field and throws. Most likely, you will not know
tomorrow why that reference was null <em>yesterday</em> when it got passed to the
constructor!</p>
<p>In other words: by explicitly using this method to check <em>incoming</em> references
you can <strong>control</strong> the point in time when the exception will be thrown. And
most of the time, you want to <em>fail as fast as possible</em>!</p>
<p>The major advantages are:</p>
<ul>
<li>as said, <em>controlled</em> behavior</li>
<li>easier debugging - because you throw up in the context of the object creation. At a point in time where you have a certain chance that your logs/traces tell you what went wrong!</li>
<li>and as shown above: the true power of this idea unfolds in conjunction with <em>final</em> fields. Because now <em>any other code</em> in your class can safely assume that <code>bar</code> isn't null - and thus you do not need any <code>if (bar == null)</code> checks in other places!</li>
</ul>
<p><br></p>
<h3>Suggest</h3>
<h2>Fail-fast</h2>
<p>The code should crash as soon as possible. It should <strong>not</strong> do half of the
work, dereference the null and only then crash, leaving half of some work done
causing the system to be in an invalid state.</p>
<p>This is commonly called "fail early" or "fail-fast".</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-2215.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-2213.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
