<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 547) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-547.html">
<link rel="prev" href="index-548.html" type="text/html">
<link rel="next" href="index-546.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/difference-between-text-and-varchar-character-varying/" class="u-url">Difference between text and varchar (character varying)</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/difference-between-text-and-varchar-character-varying/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T09:39:00+08:00" itemprop="datePublished" title="2023-02-17 09:39">2023-02-17 09:39</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>What's the difference between the <code>text</code> data type and the <code>character varying</code>
(<code>varchar</code>) data types?</p>
<p>According to the documentation</p>
<blockquote>
<p>If character varying is used without length specifier, the type accepts
strings of any size. The latter is a PostgreSQL extension.</p>
</blockquote>
<p>and</p>
<blockquote>
<p>In addition, PostgreSQL provides the text type, which stores strings of any
length. Although the type text is not in the SQL standard, several other SQL
database management systems have it as well.</p>
</blockquote>
<p>So what's the difference?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>There is no difference, under the hood it's all <code>varlena</code> (variable length
array).</p>
<p>Check this article from Depesz:
http://www.depesz.com/index.php/2010/03/02/charx-vs-varcharx-vs-varchar-vs-
text/</p>
<p>A couple of highlights:</p>
<blockquote>
<p>To sum it all up:</p>
<ul>
<li>char(n) – takes too much space when dealing with values shorter than <code>n</code>
(pads them to <code>n</code>), and can lead to subtle errors because of adding trailing
spaces, plus it is problematic to change the limit</li>
<li>varchar(n) – it's problematic to change the limit in live environment
(requires exclusive lock while altering table)</li>
<li>varchar – just like text</li>
<li>
<strong>text – for me a winner</strong> – over (n) data types because it lacks their
problems, and over varchar – because it has distinct name
</li>
</ul>
</blockquote>
<p>The article does detailed testing to show that the performance of inserts and
selects for all 4 data types are similar. It also takes a detailed look at
alternate ways on constraining the length when needed. Function based
constraints or domains provide the advantage of instant increase of the length
constraint, and on the basis that decreasing a string length constraint is
rare, depesz concludes that one of them is usually the best choice for a
length limit.</p>
<p><br></p>
<h3>Suggest</h3>
<p>As "Character Types" in the documentation points out, <code>varchar(n)</code>, <code>char(n)</code>,
and <code>text</code> are all stored the same way. The only difference is extra cycles
are needed to check the length, if one is given, and the extra space and time
required if padding is needed for <code>char(n)</code>.</p>
<p>However, when you only need to store a single character, there is a slight
performance advantage to using the special type <code>"char"</code> (keep the double-
quotes — they're part of the type name). You get faster access to the field,
and there is no overhead to store the length.</p>
<p>I just made a table of 1,000,000 random <code>"char"</code> chosen from the lower-case
alphabet. A query to get a frequency distribution (<code>select count(*), field ...
group by field</code>) takes about 650 milliseconds, vs about 760 on the same data
using a <code>text</code> field.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/convert-date-to-datetime-in-python/" class="u-url">Convert date to datetime in Python</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/convert-date-to-datetime-in-python/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T09:38:34+08:00" itemprop="datePublished" title="2023-02-17 09:38">2023-02-17 09:38</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Is there a built-in method for converting a <code>date</code> to a <code>datetime</code> in Python,
for example getting the <code>datetime</code> for the midnight of the given date? The
opposite conversion is easy: <code>datetime</code> has a <code>.date()</code> method.</p>
<p>Do I really have to manually call <code>datetime(d.year, d.month, d.day)</code>?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>You can use <code>datetime.combine(date, time)</code>; for the time, you create a
<code>datetime.time</code> object initialized to midnight.</p>
<div class="code"><pre class="code literal-block"><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="n">dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">(),</span> <span class="n">datetime</span><span class="o">.</span><span class="n">min</span><span class="o">.</span><span class="n">time</span><span class="p">())</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>There are several ways, although I do believe the one you mention (and
dislike) is the most readable one.</p>
<div class="code"><pre class="code literal-block"><span class="s s-Atom">&gt;&gt;&gt;</span> <span class="s s-Atom">import</span> <span class="s s-Atom">datetime</span>
<span class="s s-Atom">&gt;&gt;&gt;</span> <span class="s s-Atom">t</span><span class="o">=</span><span class="s s-Atom">datetime</span><span class="p">.</span><span class="s s-Atom">date</span><span class="p">.</span><span class="nf">today</span><span class="p">()</span>
<span class="s s-Atom">&gt;&gt;&gt;</span> <span class="s s-Atom">datetime</span><span class="p">.</span><span class="s s-Atom">datetime</span><span class="p">.</span><span class="nf">fromordinal</span><span class="p">(</span><span class="s s-Atom">t</span><span class="p">.</span><span class="nf">toordinal</span><span class="p">())</span>
<span class="s s-Atom">datetime</span><span class="p">.</span><span class="nf">datetime</span><span class="p">(</span><span class="mi">2009</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="s s-Atom">&gt;&gt;&gt;</span> <span class="s s-Atom">datetime</span><span class="p">.</span><span class="nf">datetime</span><span class="p">(</span><span class="s s-Atom">t</span><span class="p">.</span><span class="s s-Atom">year</span><span class="p">,</span> <span class="s s-Atom">t</span><span class="p">.</span><span class="s s-Atom">month</span><span class="p">,</span> <span class="s s-Atom">t</span><span class="p">.</span><span class="s s-Atom">day</span><span class="p">)</span>
<span class="s s-Atom">datetime</span><span class="p">.</span><span class="nf">datetime</span><span class="p">(</span><span class="mi">2009</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="s s-Atom">&gt;&gt;&gt;</span> <span class="s s-Atom">datetime</span><span class="p">.</span><span class="nf">datetime</span><span class="p">(</span><span class="o">*</span><span class="s s-Atom">t</span><span class="p">.</span><span class="nf">timetuple</span><span class="p">()[</span><span class="o">:-</span><span class="mi">4</span><span class="p">])</span>
<span class="s s-Atom">datetime</span><span class="p">.</span><span class="nf">datetime</span><span class="p">(</span><span class="mi">2009</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>

<p>and so forth -- but basically they all hinge on appropriately extracting info
from the <code>date</code> object and ploughing it back into the suitable ctor or
classfunction for <code>datetime</code>.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-properly-ignore-exceptions/" class="u-url">How to properly ignore exceptions</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-properly-ignore-exceptions/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T09:37:51+08:00" itemprop="datePublished" title="2023-02-17 09:37">2023-02-17 09:37</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>When you just want to do a try-except without handling the exception, how do
you do it in Python?</p>
<p>Is the following the right way to do it?</p>
<div class="code"><pre class="code literal-block"><span class="k">try</span><span class="o">:</span>
<span class="w">    </span><span class="n">shutil</span><span class="o">.</span><span class="na">rmtree</span><span class="o">(</span><span class="n">path</span><span class="o">)</span>
<span class="n">except</span><span class="o">:</span>
<span class="w">    </span><span class="n">pass</span>
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<div class="code"><pre class="code literal-block"><span class="k">try</span><span class="o">:</span>
<span class="w">    </span><span class="n">doSomething</span><span class="o">()</span>
<span class="n">except</span><span class="w"> </span><span class="n">Exception</span><span class="o">:</span><span class="w"> </span>
<span class="w">    </span><span class="n">pass</span>
</pre></div>

<p>or</p>
<div class="code"><pre class="code literal-block"><span class="k">try</span><span class="o">:</span>
<span class="w">    </span><span class="n">doSomething</span><span class="o">()</span>
<span class="n">except</span><span class="o">:</span><span class="w"> </span>
<span class="w">    </span><span class="n">pass</span>
</pre></div>

<p>The difference is that the second one will also catch <code>KeyboardInterrupt</code>,
<code>SystemExit</code> and stuff like that, which are derived directly from
<code>BaseException</code>, not <code>Exception</code>.</p>
<p>See documentation for details:</p>
<ul>
<li>
<code>try</code> statement</li>
<li>exceptions</li>
</ul>
<p>However, it is generally bad practice to catch every error - see Why is
"except: pass" a bad programming practice?</p>
<p><br></p>
<h3>Suggest</h3>
<p>It's generally considered best-practice to only catch the errors you are
interested in. In the case of <code>shutil.rmtree</code> it's probably <code>OSError</code>:</p>
<div class="code"><pre class="code literal-block">&gt;&gt;&gt; shutil.rmtree("/fake/dir")
Traceback (most recent call last):
    [...]
OSError: [Errno 2] No such file or directory: '/fake/dir'
</pre></div>

<p>If you want to silently ignore that error, you would do:</p>
<div class="code"><pre class="code literal-block"><span class="k">try</span><span class="o">:</span>
<span class="w">    </span><span class="n">shutil</span><span class="o">.</span><span class="na">rmtree</span><span class="o">(</span><span class="n">path</span><span class="o">)</span>
<span class="n">except</span><span class="w"> </span><span class="n">OSError</span><span class="o">:</span>
<span class="w">    </span><span class="n">pass</span>
</pre></div>

<p>Why? Say you (somehow) accidently pass the function an integer instead of a
string, like:</p>
<div class="code"><pre class="code literal-block">shutil.rmtree(2)
</pre></div>

<p>It will give the error <em>"TypeError: coercing to Unicode: need string or
buffer, int found"</em> - you probably don't want to ignore that, which can be
difficult to debug.</p>
<p>If you <em>definitely</em> want to ignore all errors, catch <code>Exception</code> rather than a
bare <code>except:</code> statement. Again, why?</p>
<p>Not specifying an exception catches <em>every</em> exception, including the
<code>SystemExit</code> exception which for example <code>sys.exit()</code> uses:</p>
<div class="code"><pre class="code literal-block"><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="nv">try</span>:
...<span class="w">     </span><span class="nv">sys</span>.<span class="k">exit</span><span class="ss">(</span><span class="mi">1</span><span class="ss">)</span>
...<span class="w"> </span><span class="nv">except</span>:
...<span class="w">     </span><span class="nv">pass</span>
...<span class="w"> </span>
<span class="o">&gt;&gt;&gt;</span>
</pre></div>

<p>Compare this to the following, which correctly exits:</p>
<div class="code"><pre class="code literal-block"><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="nv">try</span><span class="o">:</span>
<span class="o">...</span><span class="w">     </span><span class="nv">sys</span><span class="o">.</span><span class="nf">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="o">...</span><span class="w"> </span><span class="nv">except</span><span class="w"> </span><span class="nv">Exception</span><span class="o">:</span>
<span class="o">...</span><span class="w">     </span><span class="nv">pass</span>
<span class="o">...</span><span class="w"> </span>
<span class="nv">shell</span><span class="o">:</span>~<span class="p">$</span>
</pre></div>

<p>If you want to write ever better behaving code, the <code>OSError</code> exception can
represent various errors, but in the example above we only want to ignore
<code>Errno 2</code>, so we could be even more specific:</p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="nn">errno</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">errno</span> <span class="o">!=</span> <span class="n">errno</span><span class="o">.</span><span class="n">ENOENT</span><span class="p">:</span>
        <span class="c1"># ignore "No such file or directory", but re-raise other errors</span>
        <span class="k">raise</span>
</pre></div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-548.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-546.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
