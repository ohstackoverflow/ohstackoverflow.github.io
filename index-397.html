<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 397) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-397.html">
<link rel="prev" href="index-398.html" type="text/html">
<link rel="next" href="index-396.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/convert-list-of-dictionaries-to-a-pandas-dataframe/" class="u-url">Convert list of dictionaries to a pandas DataFrame</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/convert-list-of-dictionaries-to-a-pandas-dataframe/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T05:50:00+08:00" itemprop="datePublished" title="2023-02-17 05:50">2023-02-17 05:50</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>How can I convert a list of dictionaries into a <code>DataFrame</code>? Given:</p>
<div class="code"><pre class="code literal-block">[{'points': 50, 'time': '5:00', 'year': 2010}, 
 {'points': 25, 'time': '6:00', 'month': "february"}, 
 {'points':90, 'time': '9:00', 'month': 'january'}, 
 {'points_h1':20, 'month': 'june'}]
</pre></div>

<p>I want to turn the above into a <code>DataFrame</code>:</p>
<div class="code"><pre class="code literal-block">      month  points  points_h1  time  year
0       NaN      50        NaN  5:00  2010
1  february      25        NaN  6:00   NaN
2   january      90        NaN  9:00   NaN
3      june     NaN         20   NaN   NaN
</pre></div>

<p>Note: Order of the columns does not matter.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>If <code>ds</code> is a list of <code>dict</code>s:</p>
<div class="code"><pre class="code literal-block">df = pd.DataFrame(ds)
</pre></div>

<p>Note: this does not work with nested data.</p>
<p><br></p>
<h3>Suggest</h3>
<blockquote>
<h3>How do I convert a list of dictionaries to a pandas DataFrame?</h3>
</blockquote>
<p>The other answers are correct, but not much has been explained in terms of
advantages and limitations of these methods. The aim of this post will be to
show examples of these methods under different situations, discuss when to use
(and when not to use), and suggest alternatives.</p>
<hr>
<h3>
<code>DataFrame()</code>, <code>DataFrame.from_records()</code>, and <code>.from_dict()</code>
</h3>
<p>Depending on the structure and format of your data, there are situations where
either all three methods work, or some work better than others, or some don't
work at all.</p>
<p>Consider a very contrived example.</p>
<div class="code"><pre class="code literal-block"><span class="nv">np</span>.<span class="k">random</span>.<span class="nv">seed</span><span class="ss">(</span><span class="mi">0</span><span class="ss">)</span>
<span class="nv">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">pd</span>.<span class="nv">DataFrame</span><span class="ss">(</span>
<span class="w">    </span><span class="nv">np</span>.<span class="k">random</span>.<span class="nv">choice</span><span class="ss">(</span><span class="mi">10</span>,<span class="w"> </span><span class="ss">(</span><span class="mi">3</span>,<span class="w"> </span><span class="mi">4</span><span class="ss">))</span>,<span class="w"> </span><span class="nv">columns</span><span class="o">=</span><span class="nv">list</span><span class="ss">(</span><span class="s1">'ABCD'</span><span class="ss">))</span>.<span class="nv">to_dict</span><span class="ss">(</span><span class="s1">'r'</span><span class="ss">)</span>

<span class="nv">print</span><span class="ss">(</span><span class="nv">data</span><span class="ss">)</span>
[{<span class="s1">'A'</span>:<span class="w"> </span><span class="mi">5</span>,<span class="w"> </span><span class="s1">'B'</span>:<span class="w"> </span><span class="mi">0</span>,<span class="w"> </span><span class="s1">'C'</span>:<span class="w"> </span><span class="mi">3</span>,<span class="w"> </span><span class="s1">'D'</span>:<span class="w"> </span><span class="mi">3</span>},
<span class="w"> </span>{<span class="s1">'A'</span>:<span class="w"> </span><span class="mi">7</span>,<span class="w"> </span><span class="s1">'B'</span>:<span class="w"> </span><span class="mi">9</span>,<span class="w"> </span><span class="s1">'C'</span>:<span class="w"> </span><span class="mi">3</span>,<span class="w"> </span><span class="s1">'D'</span>:<span class="w"> </span><span class="mi">5</span>},
<span class="w"> </span>{<span class="s1">'A'</span>:<span class="w"> </span><span class="mi">2</span>,<span class="w"> </span><span class="s1">'B'</span>:<span class="w"> </span><span class="mi">4</span>,<span class="w"> </span><span class="s1">'C'</span>:<span class="w"> </span><span class="mi">7</span>,<span class="w"> </span><span class="s1">'D'</span>:<span class="w"> </span><span class="mi">6</span>}]
</pre></div>

<p>This list consists of "records" with every keys present. This is the simplest
case you could encounter.</p>
<div class="code"><pre class="code literal-block"># The following methods all produce the same output.
pd.DataFrame(data)
pd.DataFrame.from_dict(data)
pd.DataFrame.from_records(data)

   A  B  C  D
0  5  0  3  3
1  7  9  3  5
2  2  4  7  6
</pre></div>

<h4><strong>Word on Dictionary Orientations:<code>orient='index'</code>/<code>'columns'</code></strong></h4>
<p>Before continuing, it is important to make the distinction between the
different types of dictionary orientations, and support with pandas. There are
two primary types: "columns", and "index".</p>
<p><code>orient='columns'</code><br>
Dictionaries with the "columns" orientation will have their keys correspond to
columns in the equivalent DataFrame.</p>
<p>For example, <code>data</code> above is in the "columns" orient.</p>
<div class="code"><pre class="code literal-block">data_c = [
 {'A': 5, 'B': 0, 'C': 3, 'D': 3},
 {'A': 7, 'B': 9, 'C': 3, 'D': 5},
 {'A': 2, 'B': 4, 'C': 7, 'D': 6}]



pd.DataFrame.from_dict(data_c, orient='columns')

   A  B  C  D
0  5  0  3  3
1  7  9  3  5
2  2  4  7  6
</pre></div>

<p>Note: If you are using <code>pd.DataFrame.from_records</code>, the orientation is assumed
to be "columns" (you cannot specify otherwise), and the dictionaries will be
loaded accordingly.</p>
<p><code>orient='index'</code><br>
With this orient, keys are assumed to correspond to index values. This kind of
data is best suited for <code>pd.DataFrame.from_dict</code>.</p>
<div class="code"><pre class="code literal-block">data_i ={
 0: {'A': 5, 'B': 0, 'C': 3, 'D': 3},
 1: {'A': 7, 'B': 9, 'C': 3, 'D': 5},
 2: {'A': 2, 'B': 4, 'C': 7, 'D': 6}}



pd.DataFrame.from_dict(data_i, orient='index')

   A  B  C  D
0  5  0  3  3
1  7  9  3  5
2  2  4  7  6
</pre></div>

<p>This case is not considered in the OP, but is still useful to know.</p>
<h4><strong>Setting Custom Index</strong></h4>
<p>If you need a custom index on the resultant DataFrame, you can set it using
the <code>index=...</code> argument.</p>
<div class="code"><pre class="code literal-block">pd.DataFrame(data, index=['a', 'b', 'c'])
# pd.DataFrame.from_records(data, index=['a', 'b', 'c'])

   A  B  C  D
a  5  0  3  3
b  7  9  3  5
c  2  4  7  6
</pre></div>

<p>This is not supported by <code>pd.DataFrame.from_dict</code>.</p>
<h4><strong>Dealing with Missing Keys/Columns</strong></h4>
<p>All methods work out-of-the-box when handling dictionaries with missing
keys/column values. For example,</p>
<div class="code"><pre class="code literal-block">data2 = [
     {'A': 5, 'C': 3, 'D': 3},
     {'A': 7, 'B': 9, 'F': 5},
     {'B': 4, 'C': 7, 'E': 6}]



# The methods below all produce the same output.
pd.DataFrame(data2)
pd.DataFrame.from_dict(data2)
pd.DataFrame.from_records(data2)

     A    B    C    D    E    F
0  5.0  NaN  3.0  3.0  NaN  NaN
1  7.0  9.0  NaN  NaN  NaN  5.0
2  NaN  4.0  7.0  NaN  6.0  NaN
</pre></div>

<h4><strong>Reading Subset of Columns</strong></h4>
<p>"What if I don't want to read in every single column"? You can easily specify
this using the <code>columns=...</code> parameter.</p>
<p>For example, from the example dictionary of <code>data2</code> above, if you wanted to
read only columns "A', 'D', and 'F', you can do so by passing a list:</p>
<div class="code"><pre class="code literal-block">pd.DataFrame(data2, columns=['A', 'D', 'F'])
# pd.DataFrame.from_records(data2, columns=['A', 'D', 'F'])

     A    D    F
0  5.0  3.0  NaN
1  7.0  NaN  5.0
2  NaN  NaN  NaN
</pre></div>

<p>This is not supported by <code>pd.DataFrame.from_dict</code> with the default orient
"columns".</p>
<div class="code"><pre class="code literal-block">pd.DataFrame.from_dict(data2, orient='columns', columns=['A', 'B'])



ValueError: cannot use columns parameter with orient='columns'
</pre></div>

<h4><strong>Reading Subset of Rows</strong></h4>
<p>Not supported by any of these methods <em>directly</em>. You will have to iterate
over your data and perform a reverse delete in-place as you iterate. For
example, to extract only the 0th and 2nd rows from <code>data2</code> above, you can use:</p>
<div class="code"><pre class="code literal-block"><span class="n">rows_to_select</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="err">}</span>
<span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">reversed</span><span class="p">(</span><span class="k">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">data2</span><span class="p">)))</span><span class="err">:</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">rows_to_select</span><span class="p">:</span>
<span class="w">        </span><span class="n">del</span><span class="w"> </span><span class="n">data2</span><span class="o">[</span><span class="n">i</span><span class="o">]</span>

<span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data2</span><span class="p">)</span>
<span class="err">#</span><span class="w"> </span><span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">data2</span><span class="p">)</span>
<span class="err">#</span><span class="w"> </span><span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">.</span><span class="n">from_records</span><span class="p">(</span><span class="n">data2</span><span class="p">)</span>

<span class="w">     </span><span class="n">A</span><span class="w">    </span><span class="n">B</span><span class="w">  </span><span class="n">C</span><span class="w">    </span><span class="n">D</span><span class="w">    </span><span class="n">E</span>
<span class="mi">0</span><span class="w">  </span><span class="mf">5.0</span><span class="w">  </span><span class="n">NaN</span><span class="w">  </span><span class="mi">3</span><span class="w">  </span><span class="mf">3.0</span><span class="w">  </span><span class="n">NaN</span>
<span class="mi">1</span><span class="w">  </span><span class="n">NaN</span><span class="w">  </span><span class="mf">4.0</span><span class="w">  </span><span class="mi">7</span><span class="w">  </span><span class="n">NaN</span><span class="w">  </span><span class="mf">6.0</span>
</pre></div>

<hr>
<h3>The Panacea: <code>json_normalize</code> for Nested Data</h3>
<p>A strong, robust alternative to the methods outlined above is the
<code>json_normalize</code> function which works with lists of dictionaries (records),
and in addition can also handle nested dictionaries.</p>
<div class="code"><pre class="code literal-block">pd.json_normalize(data)

   A  B  C  D
0  5  0  3  3
1  7  9  3  5
2  2  4  7  6



pd.json_normalize(data2)

     A    B  C    D    E
0  5.0  NaN  3  3.0  NaN
1  NaN  4.0  7  NaN  6.0
</pre></div>

<p>Again, keep in mind that the data passed to <code>json_normalize</code> needs to be in
the list-of-dictionaries (records) format.</p>
<p>As mentioned, <code>json_normalize</code> can also handle nested dictionaries. Here's an
example taken from the documentation.</p>
<div class="code"><pre class="code literal-block">data_nested = [
  {'counties': [{'name': 'Dade', 'population': 12345},
                {'name': 'Broward', 'population': 40000},
                {'name': 'Palm Beach', 'population': 60000}],
   'info': {'governor': 'Rick Scott'},
   'shortname': 'FL',
   'state': 'Florida'},
  {'counties': [{'name': 'Summit', 'population': 1234},
                {'name': 'Cuyahoga', 'population': 1337}],
   'info': {'governor': 'John Kasich'},
   'shortname': 'OH',
   'state': 'Ohio'}
]



pd.json_normalize(data_nested, 
                          record_path='counties', 
                          meta=['state', 'shortname', ['info', 'governor']])

         name  population    state shortname info.governor
0        Dade       12345  Florida        FL    Rick Scott
1     Broward       40000  Florida        FL    Rick Scott
2  Palm Beach       60000  Florida        FL    Rick Scott
3      Summit        1234     Ohio        OH   John Kasich
4    Cuyahoga        1337     Ohio        OH   John Kasich
</pre></div>

<p>For more information on the <code>meta</code> and <code>record_path</code> arguments, check out the
documentation.</p>
<hr>
<h3><strong>Summarising</strong></h3>
<p>Here's a table of all the methods discussed above, along with supported
features/functionality.</p>
<p><img alt="enter image description here" src="images/SRbw9.png"></p>
<ul>
<li>Use <code>orient='columns'</code> and then transpose to get the same effect as <code>orient='index'</code>.</li>
</ul>
</div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-can-i-get-the-application-s-path-in-a-net-console-application/" class="u-url">How can I get the application's path in a .NET console application?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-can-i-get-the-application-s-path-in-a-net-console-application/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T05:48:52+08:00" itemprop="datePublished" title="2023-02-17 05:48">2023-02-17 05:48</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>How do I find the application's path in a console application?</p>
<p>In Windows Forms, I can use <code>Application.StartupPath</code> to find the current
path, but this doesn't seem to be available in a console application.</p>
<p><br><br></p>
<h2>Answer</h2>
<p><code>System.Reflection.Assembly.GetExecutingAssembly()</code>.<code>Location</code>1</p>
<p>Combine that with <code>System.IO.Path.GetDirectoryName</code> if all you want is the
directory.</p>
<blockquote>
<p>1 <em>As per Mr.Mindor's comment:</em><br><code>System.Reflection.Assembly.GetExecutingAssembly().Location</code> returns where
the executing assembly is currently located, which may or may not be where
the assembly is located when not executing. In the case of shadow copying
assemblies, you will get a path in a temp directory.
<code>System.Reflection.Assembly.GetExecutingAssembly().CodeBase</code> will return the
'permanent' path of the assembly.</p>
</blockquote>
<p><br></p>
<h3>Suggest</h3>
<p>You can use the following code to get the current application directory.</p>
<div class="code"><pre class="code literal-block">AppDomain.CurrentDomain.BaseDirectory
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-is-an-http-post-request-made-in-node-js/" class="u-url">How is an HTTP POST request made in node.js?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-is-an-http-post-request-made-in-node-js/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T05:48:22+08:00" itemprop="datePublished" title="2023-02-17 05:48">2023-02-17 05:48</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>How can I make an outbound HTTP POST request, with data, in node.js?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Here's an example of using node.js to make a POST request to the Google
Compiler API:</p>
<div class="code"><pre class="code literal-block"><span class="o">//</span><span class="w"> </span><span class="n">We</span><span class="w"> </span><span class="n">need</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">build</span><span class="w"> </span><span class="n">our</span><span class="w"> </span><span class="n">post</span><span class="w"> </span><span class="n">string</span>
<span class="k">var</span><span class="w"> </span><span class="n">querystring</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">require</span><span class="p">(</span><span class="s1">'querystring'</span><span class="p">);</span>
<span class="k">var</span><span class="w"> </span><span class="n">http</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">require</span><span class="p">(</span><span class="s1">'http'</span><span class="p">);</span>
<span class="k">var</span><span class="w"> </span><span class="n">fs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">require</span><span class="p">(</span><span class="s1">'fs'</span><span class="p">);</span>

<span class="n">function</span><span class="w"> </span><span class="n">PostCode</span><span class="p">(</span><span class="n">codestring</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Build</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">post</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">object</span>
<span class="w">  </span><span class="k">var</span><span class="w"> </span><span class="n">post_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">querystring</span><span class="o">.</span><span class="n">stringify</span><span class="p">({</span>
<span class="w">      </span><span class="s1">'compilation_level'</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s1">'ADVANCED_OPTIMIZATIONS'</span><span class="p">,</span>
<span class="w">      </span><span class="s1">'output_format'</span><span class="p">:</span><span class="w"> </span><span class="s1">'json'</span><span class="p">,</span>
<span class="w">      </span><span class="s1">'output_info'</span><span class="p">:</span><span class="w"> </span><span class="s1">'compiled_code'</span><span class="p">,</span>
<span class="w">        </span><span class="s1">'warning_level'</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s1">'QUIET'</span><span class="p">,</span>
<span class="w">        </span><span class="s1">'js_code'</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">codestring</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">An</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">indicate</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">post</span><span class="w"> </span><span class="n">to</span>
<span class="w">  </span><span class="k">var</span><span class="w"> </span><span class="n">post_options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">host</span><span class="p">:</span><span class="w"> </span><span class="s1">'closure-compiler.appspot.com'</span><span class="p">,</span>
<span class="w">      </span><span class="n">port</span><span class="p">:</span><span class="w"> </span><span class="s1">'80'</span><span class="p">,</span>
<span class="w">      </span><span class="n">path</span><span class="p">:</span><span class="w"> </span><span class="s1">'/compile'</span><span class="p">,</span>
<span class="w">      </span><span class="n">method</span><span class="p">:</span><span class="w"> </span><span class="s1">'POST'</span><span class="p">,</span>
<span class="w">      </span><span class="n">headers</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="s1">'Content-Type'</span><span class="p">:</span><span class="w"> </span><span class="s1">'application/x-www-form-urlencoded'</span><span class="p">,</span>
<span class="w">          </span><span class="s1">'Content-Length'</span><span class="p">:</span><span class="w"> </span><span class="n">Buffer</span><span class="o">.</span><span class="n">byteLength</span><span class="p">(</span><span class="n">post_data</span><span class="p">)</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Set</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">request</span>
<span class="w">  </span><span class="k">var</span><span class="w"> </span><span class="n">post_req</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">http</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">post_options</span><span class="p">,</span><span class="w"> </span><span class="n">function</span><span class="p">(</span><span class="n">res</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">res</span><span class="o">.</span><span class="n">setEncoding</span><span class="p">(</span><span class="s1">'utf8'</span><span class="p">);</span>
<span class="w">      </span><span class="n">res</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="s1">'data'</span><span class="p">,</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">'Response: '</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">chunk</span><span class="p">);</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">post</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">data</span>
<span class="w">  </span><span class="n">post_req</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">post_data</span><span class="p">);</span>
<span class="w">  </span><span class="n">post_req</span><span class="o">.</span><span class="n">end</span><span class="p">();</span>

<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">async</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">read</span>
<span class="n">fs</span><span class="o">.</span><span class="n">readFile</span><span class="p">(</span><span class="s1">'LinkedList.js'</span><span class="p">,</span><span class="w"> </span><span class="s1">'utf-8'</span><span class="p">,</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="p">(</span><span class="n">err</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">err</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="n">If</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">were</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">small</span><span class="w"> </span><span class="n">part</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">application</span><span class="p">,</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">would</span>
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">handle</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">differently</span><span class="p">,</span><span class="w"> </span><span class="n">maybe</span><span class="w"> </span><span class="n">throwing</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">exception</span>
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">caller</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">handle</span><span class="o">.</span><span class="w"> </span><span class="n">Since</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">absolutely</span><span class="w"> </span><span class="n">essential</span>
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">program</span><span class="s1">'s functionality, we'</span><span class="n">re</span><span class="w"> </span><span class="n">going</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">exit</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">fatal</span>
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">instead</span><span class="o">.</span>
<span class="w">    </span><span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">"FATAL An error occurred trying to read in the file: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">err</span><span class="p">);</span>
<span class="w">    </span><span class="n">process</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Make</span><span class="w"> </span><span class="n">sure</span><span class="w"> </span><span class="n">there</span><span class="s1">'s data before we post it</span>
<span class="w">  </span><span class="k">if</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">PostCode</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">"No data to post"</span><span class="p">);</span>
<span class="w">    </span><span class="n">process</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">});</span>
</pre></div>

<p>I've updated the code to show how to post data from a file, instead of the
hardcoded string. It uses the async <code>fs.readFile</code> command to achieve this,
posting the actual code after a successful read. If there's an error, it is
thrown, and if there's no data the process exits with a negative value to
indicate failure.</p>
<p><br></p>
<h3>Suggest</h3>
<p>Here's an example of using node.js to make a POST request to the Google
Compiler API:</p>
<div class="code"><pre class="code literal-block"><span class="o">//</span><span class="w"> </span><span class="n">We</span><span class="w"> </span><span class="n">need</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">build</span><span class="w"> </span><span class="n">our</span><span class="w"> </span><span class="n">post</span><span class="w"> </span><span class="n">string</span>
<span class="k">var</span><span class="w"> </span><span class="n">querystring</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">require</span><span class="p">(</span><span class="s1">'querystring'</span><span class="p">);</span>
<span class="k">var</span><span class="w"> </span><span class="n">http</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">require</span><span class="p">(</span><span class="s1">'http'</span><span class="p">);</span>
<span class="k">var</span><span class="w"> </span><span class="n">fs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">require</span><span class="p">(</span><span class="s1">'fs'</span><span class="p">);</span>

<span class="n">function</span><span class="w"> </span><span class="n">PostCode</span><span class="p">(</span><span class="n">codestring</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Build</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">post</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">object</span>
<span class="w">  </span><span class="k">var</span><span class="w"> </span><span class="n">post_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">querystring</span><span class="o">.</span><span class="n">stringify</span><span class="p">({</span>
<span class="w">      </span><span class="s1">'compilation_level'</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s1">'ADVANCED_OPTIMIZATIONS'</span><span class="p">,</span>
<span class="w">      </span><span class="s1">'output_format'</span><span class="p">:</span><span class="w"> </span><span class="s1">'json'</span><span class="p">,</span>
<span class="w">      </span><span class="s1">'output_info'</span><span class="p">:</span><span class="w"> </span><span class="s1">'compiled_code'</span><span class="p">,</span>
<span class="w">        </span><span class="s1">'warning_level'</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s1">'QUIET'</span><span class="p">,</span>
<span class="w">        </span><span class="s1">'js_code'</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">codestring</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">An</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">indicate</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">post</span><span class="w"> </span><span class="n">to</span>
<span class="w">  </span><span class="k">var</span><span class="w"> </span><span class="n">post_options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">host</span><span class="p">:</span><span class="w"> </span><span class="s1">'closure-compiler.appspot.com'</span><span class="p">,</span>
<span class="w">      </span><span class="n">port</span><span class="p">:</span><span class="w"> </span><span class="s1">'80'</span><span class="p">,</span>
<span class="w">      </span><span class="n">path</span><span class="p">:</span><span class="w"> </span><span class="s1">'/compile'</span><span class="p">,</span>
<span class="w">      </span><span class="n">method</span><span class="p">:</span><span class="w"> </span><span class="s1">'POST'</span><span class="p">,</span>
<span class="w">      </span><span class="n">headers</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="s1">'Content-Type'</span><span class="p">:</span><span class="w"> </span><span class="s1">'application/x-www-form-urlencoded'</span><span class="p">,</span>
<span class="w">          </span><span class="s1">'Content-Length'</span><span class="p">:</span><span class="w"> </span><span class="n">Buffer</span><span class="o">.</span><span class="n">byteLength</span><span class="p">(</span><span class="n">post_data</span><span class="p">)</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Set</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">request</span>
<span class="w">  </span><span class="k">var</span><span class="w"> </span><span class="n">post_req</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">http</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">post_options</span><span class="p">,</span><span class="w"> </span><span class="n">function</span><span class="p">(</span><span class="n">res</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">res</span><span class="o">.</span><span class="n">setEncoding</span><span class="p">(</span><span class="s1">'utf8'</span><span class="p">);</span>
<span class="w">      </span><span class="n">res</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="s1">'data'</span><span class="p">,</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">'Response: '</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">chunk</span><span class="p">);</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">post</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">data</span>
<span class="w">  </span><span class="n">post_req</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">post_data</span><span class="p">);</span>
<span class="w">  </span><span class="n">post_req</span><span class="o">.</span><span class="n">end</span><span class="p">();</span>

<span class="p">}</span>

<span class="o">//</span><span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">async</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">read</span>
<span class="n">fs</span><span class="o">.</span><span class="n">readFile</span><span class="p">(</span><span class="s1">'LinkedList.js'</span><span class="p">,</span><span class="w"> </span><span class="s1">'utf-8'</span><span class="p">,</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="p">(</span><span class="n">err</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">err</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="n">If</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">were</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">small</span><span class="w"> </span><span class="n">part</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">application</span><span class="p">,</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">would</span>
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">handle</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">differently</span><span class="p">,</span><span class="w"> </span><span class="n">maybe</span><span class="w"> </span><span class="n">throwing</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">exception</span>
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">caller</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">handle</span><span class="o">.</span><span class="w"> </span><span class="n">Since</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">absolutely</span><span class="w"> </span><span class="n">essential</span>
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">program</span><span class="s1">'s functionality, we'</span><span class="n">re</span><span class="w"> </span><span class="n">going</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">exit</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">fatal</span>
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">instead</span><span class="o">.</span>
<span class="w">    </span><span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">"FATAL An error occurred trying to read in the file: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">err</span><span class="p">);</span>
<span class="w">    </span><span class="n">process</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Make</span><span class="w"> </span><span class="n">sure</span><span class="w"> </span><span class="n">there</span><span class="s1">'s data before we post it</span>
<span class="w">  </span><span class="k">if</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">PostCode</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">"No data to post"</span><span class="p">);</span>
<span class="w">    </span><span class="n">process</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">});</span>
</pre></div>

<p>I've updated the code to show how to post data from a file, instead of the
hardcoded string. It uses the async <code>fs.readFile</code> command to achieve this,
posting the actual code after a successful read. If there's an error, it is
thrown, and if there's no data the process exits with a negative value to
indicate failure.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-398.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-396.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
