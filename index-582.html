<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 582) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-582.html">
<link rel="prev" href="index-583.html" type="text/html">
<link rel="next" href="index-581.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/a-monad-is-just-a-monoid-in-the-category-of-endofunctors-what-s-the-problem/" class="u-url">A monad is just a monoid in the category of endofunctors, what's the problem?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/a-monad-is-just-a-monoid-in-the-category-of-endofunctors-what-s-the-problem/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T10:33:54+08:00" itemprop="datePublished" title="2023-02-17 10:33">2023-02-17 10:33</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Who first said the following?</p>
<blockquote>
<p>A monad is just a monoid in the category of endofunctors, what's the
problem?</p>
</blockquote>
<p>And on a less important note, is this true and if so could you give an
explanation (hopefully one that can be understood by someone who doesn't have
much Haskell experience)?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>That particular phrasing is by James Iry, from his highly entertaining <em>Brief,
Incomplete and Mostly Wrong History of Programming Languages</em> , in which he
fictionally attributes it to Philip Wadler.</p>
<p>The original quote is from Saunders Mac Lane in <em>Categories for the Working
Mathematician</em> , one of the foundational texts of Category Theory. Here it is
in context, which is probably the best place to learn exactly what it means.</p>
<p>But, I'll take a stab. The original sentence is this:</p>
<blockquote>
<p>All told, a monad in X is just a monoid in the category of endofunctors of
X, with product × replaced by composition of endofunctors and unit set by
the identity endofunctor.</p>
</blockquote>
<p><em>X</em> here is a category. Endofunctors are functors from a category to itself
(which is usually <em>all</em> <code>Functor</code>s as far as functional programmers are
concerned, since they're mostly dealing with just one category; the category
of types - but I digress). But you could imagine another category which is the
category of "endofunctors on <em>X</em> ". This is a category in which the objects
are endofunctors and the morphisms are natural transformations.</p>
<p>And of those endofunctors, some of them might be monads. Which ones are
monads? Exactly the ones which are <em>monoidal</em> in a particular sense. Instead
of spelling out the exact mapping from monads to monoids (since Mac Lane does
that far better than I could hope to), I'll just put their respective
definitions side by side and let you compare:</p>
<h3>A monoid is...</h3>
<ul>
<li>A set, <em><strong>S</strong></em>
</li>
<li>An operation, <em><strong>• : S × S → S</strong></em>
</li>
<li>An element of <em>S</em> , <em><strong>e : 1 → S</strong></em>
</li>
</ul>
<h4>...satisfying these laws:</h4>
<ul>
<li>
<em>(a • b) • c = a • (b • c)</em> , for all <em>a</em> , <em>b</em> and <em>c</em> in <em>S</em>
</li>
<li>
<em>e • a = a • e = a</em> , for all <em>a</em> in <em>S</em>
</li>
</ul>
<h3>A monad is...</h3>
<ul>
<li>An endofunctor, <em><strong>T : X → X</strong></em> (in Haskell, a type constructor of kind <code>* -&gt; *</code> with a <code>Functor</code> instance)</li>
<li>A natural transformation, <em><strong>μ : T × T → T</strong></em> , where <em>×</em> means functor composition ( <em>μ</em> is known as <em><code>join</code></em> in Haskell)</li>
<li>A natural transformation, <em><strong>η : I → T</strong></em> , where <em>I</em> is the identity endofunctor on <em>X</em> ( <em>η</em> is known as <em><code>return</code></em> in Haskell)</li>
</ul>
<h4>...satisfying these laws:</h4>
<ul>
<li><em>μ ∘ Tμ = μ ∘ μT</em></li>
<li>
<em>μ ∘ Tη = μ ∘ ηT = 1</em> (the identity natural transformation)</li>
</ul>
<p>With a bit of squinting you might be able to see that both of these
definitions are instances of the same abstract concept.</p>
<p><br></p>
<h3>Suggest</h3>
<p>First, the extensions and libraries that we're going to use:</p>
<div class="code"><pre class="code literal-block"><span class="p">{</span><span class="o">-</span><span class="c1"># LANGUAGE RankNTypes, TypeOperators #-}</span>

<span class="kn">import</span> <span class="nn">Control.Monad</span> <span class="p">(</span><span class="n">join</span><span class="p">)</span>
</pre></div>

<p>Of these, <code>RankNTypes</code> is the only one that's absolutely essential to the
below. I once wrote an explanation of <code>RankNTypes</code> that some people seem to
have found useful, so I'll refer to that.</p>
<p>Quoting Tom Crockett's excellent answer, we have:</p>
<blockquote>
<h3>A monad is...</h3>
<ul>
<li>An endofunctor, <em><strong>T : X - &gt; X</strong></em>
</li>
<li>A natural transformation, <em><strong>μ : T × T - &gt; T</strong></em>, where <em>×</em> means functor
composition</li>
<li>A natural transformation, <em><strong>η : I - &gt; T</strong></em>, where <em>I</em> is the identity
endofunctor on <em>X</em>
</li>
</ul>
<h4>...satisfying these laws:</h4>
<ul>
<li><em>μ(μ(T × T) × T)) = μ(T × μ(T × T))</em></li>
<li>
<em>μ(η(T)) = T = μ(T(η))</em>
</li>
</ul>
</blockquote>
<p>How do we translate this to Haskell code? Well, let's start with the notion of
a <strong>natural transformation</strong> :</p>
<div class="code"><pre class="code literal-block"><span class="s s-Atom">--</span> <span class="p">|</span> <span class="nv">A</span> <span class="s s-Atom">natural</span> <span class="s s-Atom">transformations</span> <span class="s s-Atom">between</span> <span class="s s-Atom">two</span> <span class="s s-Atom">'Functor'</span> <span class="s s-Atom">instances</span><span class="p">.</span>  <span class="nv">Law</span><span class="o">:</span>
<span class="s s-Atom">--</span>
<span class="s s-Atom">--</span> <span class="o">&gt;</span> <span class="s s-Atom">fmap</span> <span class="s s-Atom">f</span> <span class="p">.</span> <span class="s s-Atom">eta</span> <span class="s s-Atom">g</span> <span class="o">==</span> <span class="s s-Atom">eta</span> <span class="s s-Atom">g</span> <span class="p">.</span> <span class="s s-Atom">fmap</span> <span class="s s-Atom">f</span>
<span class="s s-Atom">--</span>
<span class="s s-Atom">--</span> <span class="nv">Neat</span> <span class="s s-Atom">fact</span><span class="p">:</span> <span class="s s-Atom">the</span> <span class="s s-Atom">type</span> <span class="s s-Atom">system</span> <span class="s s-Atom">actually</span> <span class="s s-Atom">guarantees</span> <span class="s s-Atom">this</span> <span class="s s-Atom">law</span><span class="p">.</span>
<span class="s s-Atom">--</span>
<span class="s s-Atom">newtype</span> <span class="nf">f</span> <span class="o">:-&gt;</span> <span class="s s-Atom">g</span> <span class="o">=</span>
    <span class="nv">Natural</span> <span class="p">{</span> <span class="s s-Atom">eta</span> <span class="o">::</span> <span class="s s-Atom">forall</span> <span class="s s-Atom">x</span><span class="p">.</span> <span class="s s-Atom">f</span> <span class="s s-Atom">x</span> <span class="s s-Atom">-&gt;</span> <span class="s s-Atom">g</span> <span class="s s-Atom">x</span> <span class="p">}</span>
</pre></div>

<p>A type of the form <code>f :-&gt; g</code> is analogous to a function type, but instead of
thinking of it as a <em>function</em> between two <em>types</em> (of kind <code>*</code>), think of it
as a <strong>morphism</strong> between two <strong>functors</strong> (each of kind <code>* -&gt; *</code>). Examples:</p>
<div class="code"><pre class="code literal-block"><span class="s s-Atom">listToMaybe</span> <span class="o">::</span> <span class="p">[]</span> <span class="o">:-&gt;</span> <span class="nv">Maybe</span>
<span class="s s-Atom">listToMaybe</span> <span class="o">=</span> <span class="nv">Natural</span> <span class="s s-Atom">go</span>
    <span class="s s-Atom">where</span> <span class="s s-Atom">go</span> <span class="p">[]</span> <span class="o">=</span> <span class="nv">Nothing</span>
          <span class="nf">go</span> <span class="p">(</span><span class="s s-Atom">x</span><span class="p">:</span><span class="k">_</span><span class="p">)</span> <span class="o">=</span> <span class="nv">Just</span> <span class="s s-Atom">x</span>

<span class="s s-Atom">maybeToList</span> <span class="o">::</span> <span class="nv">Maybe</span> <span class="o">:-&gt;</span> <span class="p">[]</span>
<span class="s s-Atom">maybeToList</span> <span class="o">=</span> <span class="nv">Natural</span> <span class="s s-Atom">go</span>
    <span class="s s-Atom">where</span> <span class="s s-Atom">go</span> <span class="nv">Nothing</span> <span class="o">=</span> <span class="p">[]</span>
          <span class="nf">go</span> <span class="p">(</span><span class="nv">Just</span> <span class="s s-Atom">x</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span><span class="s s-Atom">x</span><span class="p">]</span>

<span class="s s-Atom">reverse' :: [] :-&gt; []</span>
<span class="s s-Atom">reverse'</span> <span class="o">=</span> <span class="nv">Natural</span> <span class="s s-Atom">reverse</span>
</pre></div>

<p>Basically, in Haskell, natural transformations are functions from some type <code>f
x</code> to another type <code>g x</code> such that the <code>x</code> type variable is "inaccessible" to
the caller. So for example, <code>sort :: Ord a =&gt; [a] -&gt; [a]</code> cannot be made into
a natural transformation, because it's "picky" about which types we may
instantiate for <code>a</code>. One intuitive way I often use to think of this is the
following:</p>
<ul>
<li>A functor is a way of operating on the <em>content</em> of something without touching the <em>structure</em>.</li>
<li>A natural transformation is a way of operating on the <em>structure</em> of something without touching or looking at the <em>content</em>.</li>
</ul>
<p>Now, with that out of the way, let's tackle the clauses of the definition.</p>
<p>The first clause is "an endofunctor, <em><strong>T : X - &gt; X</strong></em>." Well, every <code>Functor</code>
in Haskell is an endofunctor in what people call "the Hask category," whose
objects are Haskell types (of kind <code>*</code>) and whose morphisms are Haskell
functions. This sounds like a complicated statement, but it's actually a very
trivial one. All it means is that that a <code>Functor f :: * -&gt; *</code> gives you the
means of constructing a type <code>f a :: *</code> for any <code>a :: *</code> and a function <code>fmap
f :: f a -&gt; f b</code> out of any <code>f :: a -&gt; b</code>, and that these obey the functor
laws.</p>
<p>Second clause: the <code>Identity</code> functor in Haskell (which comes with the
Platform, so you can just import it) is defined this way:</p>
<div class="code"><pre class="code literal-block">newtype Identity a = Identity { runIdentity :: a }

instance Functor Identity where
    fmap f (Identity a) = Identity (f a)
</pre></div>

<p>So the natural transformation <em><strong>η : I - &gt; T</strong></em> from Tom Crockett's definition
can be written this way for any <code>Monad</code> instance <code>t</code>:</p>
<div class="code"><pre class="code literal-block"><span class="s s-Atom">return' :: Monad t =&gt; Identity :-&gt; t</span>
<span class="s s-Atom">return'</span> <span class="o">=</span> <span class="nv">Natural</span> <span class="p">(</span><span class="s s-Atom">return</span> <span class="p">.</span> <span class="s s-Atom">runIdentity</span><span class="p">)</span>
</pre></div>

<p>Third clause: The composition of two functors in Haskell can be defined this
way (which also comes with the Platform):</p>
<div class="code"><pre class="code literal-block">newtype Compose f g a = Compose { getCompose :: f (g a) }

-- | The composition of two 'Functor's is also a 'Functor'.
instance (Functor f, Functor g) =&gt; Functor (Compose f g) where
    fmap f (Compose fga) = Compose (fmap (fmap f) fga)
</pre></div>

<p>So the natural transformation <em><strong>μ : T × T - &gt; T</strong></em> from Tom Crockett's
definition can be written like this:</p>
<div class="code"><pre class="code literal-block"><span class="s s-Atom">join' :: Monad t =&gt; Compose t t :-&gt; t</span>
<span class="s s-Atom">join'</span> <span class="o">=</span> <span class="nv">Natural</span> <span class="p">(</span><span class="s s-Atom">join</span> <span class="p">.</span> <span class="s s-Atom">getCompose</span><span class="p">)</span>
</pre></div>

<p>The statement that this is a monoid in the category of endofunctors then means
that <code>Compose</code> (partially applied to just its first two parameters) is
associative, and that <code>Identity</code> is its identity element. I.e., that the
following isomorphisms hold:</p>
<ul>
<li><code>Compose f (Compose g h) ~= Compose (Compose f g) h</code></li>
<li><code>Compose f Identity ~= f</code></li>
<li><code>Compose Identity g ~= g</code></li>
</ul>
<p>These are very easy to prove because <code>Compose</code> and <code>Identity</code> are both defined
as <code>newtype</code>, and the Haskell Reports define the semantics of <code>newtype</code> as an
isomorphism between the type being defined and the type of the argument to the
<code>newtype</code>'s data constructor. So for example, let's prove <code>Compose f Identity
~= f</code>:</p>
<div class="code"><pre class="code literal-block">Compose f Identity a
    ~= f (Identity a)                 -- newtype Compose f g a = Compose (f (g a))
    ~= f a                            -- newtype Identity a = Identity a
Q.E.D.
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-can-i-open-multiple-files-using-with-open-in-python/" class="u-url">How can I open multiple files using "with open" in Python?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-can-i-open-multiple-files-using-with-open-in-python/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T10:32:42+08:00" itemprop="datePublished" title="2023-02-17 10:32">2023-02-17 10:32</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I want to change a couple of files at one time, <strong>iff</strong> I can write to all of
them. I'm wondering if I somehow can combine the multiple open calls with the
<code>with</code> statement:</p>
<div class="code"><pre class="code literal-block"><span class="k">try</span><span class="o">:</span>
<span class="w">  </span><span class="k">with</span><span class="w"> </span><span class="n">open</span><span class="o">(</span><span class="s1">'a'</span><span class="o">,</span><span class="w"> </span><span class="s1">'w'</span><span class="o">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">open</span><span class="o">(</span><span class="s1">'b'</span><span class="o">,</span><span class="w"> </span><span class="s1">'w'</span><span class="o">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">b</span><span class="o">:</span>
<span class="w">    </span><span class="n">do_something</span><span class="o">()</span>
<span class="n">except</span><span class="w"> </span><span class="n">IOError</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">e</span><span class="o">:</span>
<span class="w">  </span><span class="n">print</span><span class="w"> </span><span class="s1">'Operation failed: %s'</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">e</span><span class="o">.</span><span class="na">strerror</span>
</pre></div>

<p>If that's not possible, what would an elegant solution to this problem look
like?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>As of Python 2.7 (or 3.1 respectively) you can write</p>
<div class="code"><pre class="code literal-block">with open('a', 'w') as a, open('b', 'w') as b:
    do_something()
</pre></div>

<p>( <em>Historical note</em> : In earlier versions of Python, you can sometimes use
<code>contextlib.nested()</code> to nest context managers. This won't work as expected
for opening multiples files, though -- see the linked documentation for
details.)</p>
<hr>
<p>In the rare case that you want to open a variable number of files all at the
same time, you can use <code>contextlib.ExitStack</code>, starting from Python version
3.3:</p>
<div class="code"><pre class="code literal-block"><span class="nv">with</span><span class="w"> </span><span class="nv">ExitStack</span><span class="ss">()</span><span class="w"> </span><span class="nv">as</span><span class="w"> </span><span class="nv">stack</span>:
<span class="w">    </span><span class="nv">files</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>[<span class="nv">stack</span>.<span class="nv">enter_context</span><span class="ss">(</span><span class="nv">open</span><span class="ss">(</span><span class="nv">fname</span><span class="ss">))</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">fname</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">filenames</span>]
<span class="w">    </span>#<span class="w"> </span><span class="k">Do</span><span class="w"> </span><span class="nv">something</span><span class="w"> </span><span class="nv">with</span><span class="w"> </span><span class="s2">"files"</span>
</pre></div>

<p>Note that more commonly you want to process files sequentially rather than
opening all of them at the same time, in particular if you have a variable
number of files:</p>
<div class="code"><pre class="code literal-block"><span class="k">for</span><span class="w"> </span><span class="nv">fname</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">filenames</span>:
<span class="w">    </span><span class="nv">with</span><span class="w"> </span><span class="nv">open</span><span class="ss">(</span><span class="nv">fname</span><span class="ss">)</span><span class="w"> </span><span class="nv">as</span><span class="w"> </span><span class="nv">f</span>:
<span class="w">        </span>#<span class="w"> </span><span class="nv">Process</span><span class="w"> </span><span class="nv">f</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>Just replace <code>and</code> with <code>,</code> and you're done:</p>
<div class="code"><pre class="code literal-block"><span class="k">try</span><span class="o">:</span>
<span class="w">    </span><span class="k">with</span><span class="w"> </span><span class="n">open</span><span class="o">(</span><span class="s1">'a'</span><span class="o">,</span><span class="w"> </span><span class="s1">'w'</span><span class="o">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">a</span><span class="o">,</span><span class="w"> </span><span class="n">open</span><span class="o">(</span><span class="s1">'b'</span><span class="o">,</span><span class="w"> </span><span class="s1">'w'</span><span class="o">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">b</span><span class="o">:</span>
<span class="w">        </span><span class="n">do_something</span><span class="o">()</span>
<span class="n">except</span><span class="w"> </span><span class="n">IOError</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">e</span><span class="o">:</span>
<span class="w">    </span><span class="n">print</span><span class="w"> </span><span class="s1">'Operation failed: %s'</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">e</span><span class="o">.</span><span class="na">strerror</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/what-methods-of-clearfix-can-i-use/" class="u-url">What methods of ‘clearfix’ can I use?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/what-methods-of-clearfix-can-i-use/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T10:32:05+08:00" itemprop="datePublished" title="2023-02-17 10:32">2023-02-17 10:32</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I have the age-old problem of a <code>div</code> wrapping a two-column layout. My sidebar
is floated, so my container <code>div</code> fails to wrap the content and sidebar.</p>
<div class="code"><pre class="code literal-block"><span class="nt">&lt;div</span><span class="w"> </span><span class="na">id=</span><span class="s">"container"</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;div</span><span class="w"> </span><span class="na">id=</span><span class="s">"content"</span><span class="nt">&gt;&lt;/div&gt;</span>
<span class="w">  </span><span class="nt">&lt;div</span><span class="w"> </span><span class="na">id=</span><span class="s">"sidebar"</span><span class="nt">&gt;&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div>

<p>There seem to be numerous methods of fixing the clear bug in Firefox:</p>
<ul>
<li><code>&lt;br clear="all"/&gt;</code></li>
<li><code>overflow:auto</code></li>
<li><code>overflow:hidden</code></li>
</ul>
<p>In my situation, the only one that seems to work correctly is the <code>&lt;br
clear="all"/&gt;</code> solution, which is a little bit scruffy. <code>overflow:auto</code> gives
me nasty scrollbars, and <code>overflow:hidden</code> must surely have side effects.
Also, IE7 apparently shouldn't suffer from this problem due to its incorrect
behaviour, but in my situation it's suffering the same as Firefox.</p>
<p>Which method currently available to us is the most robust?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Depending upon the design being produced, each of the below clearfix CSS
solutions has its own benefits.</p>
<p>The clearfix does have useful applications but it has also been used as a
hack. Before you use a clearfix perhaps these modern css solutions can be
useful:</p>
<ul>
<li>css flexbox</li>
<li>css grid</li>
</ul>
<hr>
<h2>Modern Clearfix Solutions</h2>
<hr>
<h3>Container with <code>overflow: auto;</code>
</h3>
<p>The simplest way to clear floated elements is using the style <code>overflow: auto</code>
on the containing element. This solution works in every modern browsers.</p>
<div class="code"><pre class="code literal-block"><span class="nt">&lt;div</span><span class="w"> </span><span class="na">style=</span><span class="s">"overflow: auto;"</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;img</span>
<span class="w">    </span><span class="na">style=</span><span class="s">"float: right;"</span>
<span class="w">    </span><span class="na">src=</span><span class="s">"path/to/floated-element.png"</span>
<span class="w">    </span><span class="na">width=</span><span class="s">"500"</span>
<span class="w">    </span><span class="na">height=</span><span class="s">"500"</span>
<span class="w">  </span><span class="nt">&gt;</span><span class="w"> </span>
<span class="w">  </span><span class="nt">&lt;p&gt;</span>Your<span class="w"> </span>content<span class="w"> </span>here…<span class="nt">&lt;/p&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div>

<p>One downside, using certain combinations of margin and padding on the external
element can cause scrollbars to appear but this can be solved by placing the
margin and padding on another parent containing element.</p>
<p>Using ‘overflow: hidden’ is also a clearfix solution, but will not have
scrollbars, however using <code>hidden</code> will crop any content positioned outside of
the containing element.</p>
<p><em>Note:</em> The floated element is an <code>img</code> tag in this example, but could be any
html element.</p>
<hr>
<h3>Clearfix Reloaded</h3>
<p>Thierry Koblentz on CSSMojo wrote: The very latest clearfix reloaded. He noted
that by dropping support for oldIE, the solution can be simplified to one css
statement. Additionally, using <code>display: block</code> (instead of <code>display: table</code>)
allows margins to collapse properly when elements with clearfix are siblings.</p>
<div class="code"><pre class="code literal-block"><span class="nl">.container:</span><span class="err">:</span><span class="nf">after</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nl">content:</span><span class="w"> </span><span class="err">""</span><span class="c1">;</span>
<span class="w">  </span><span class="nl">display:</span><span class="w"> </span><span class="nf">block</span><span class="c1">;</span>
<span class="w">  </span><span class="nl">clear:</span><span class="w"> </span><span class="nf">both</span><span class="c1">;</span>
<span class="err">}</span>
</pre></div>

<p>This is the most modern version of the clearfix.</p>
<hr>
<p>⋮</p>
<p>⋮</p>
<h2>Older Clearfix Solutions</h2>
<p>The below solutions are not necessary for modern browsers, but may be useful
for targeting older browsers.</p>
<p>Note that these solutions rely upon browser bugs and therefore should be used
only if none of the above solutions work for you.</p>
<p>They are listed roughly in chronological order.</p>
<hr>
<h3>"Beat That ClearFix", a clearfix for modern browsers</h3>
<p>Thierry Koblentz' of CSS Mojo has pointed out that when targeting modern
browsers, we can now drop the <code>zoom</code> and <code>::before</code> property/values and simply
use:</p>
<div class="code"><pre class="code literal-block"><span class="nl">.container:</span><span class="err">:</span><span class="nf">after</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nl">content:</span><span class="w"> </span><span class="err">""</span><span class="c1">;</span>
<span class="w">    </span><span class="nl">display:</span><span class="w"> </span><span class="nf">table</span><span class="c1">;</span>
<span class="w">    </span><span class="nl">clear:</span><span class="w"> </span><span class="nf">both</span><span class="c1">;</span>
<span class="err">}</span>
</pre></div>

<p><em>This solution does not support for IE 6/7 …on purpose!</em></p>
<p>Thierry also offers: "A word of caution: if you start a new project from
scratch, go for it, but don’t swap this technique with the one you have now,
because even though you do not support oldIE, your existing rules prevent
collapsing margins."</p>
<hr>
<h3>Micro Clearfix</h3>
<p>The most recent and globally adopted clearfix solution, the Micro Clearfix by
Nicolas Gallagher.</p>
<p><em>Known support: Firefox 3.5+, Safari 4+, Chrome, Opera 9+, IE 6+</em></p>
<div class="code"><pre class="code literal-block"><span class="nl">.container:</span><span class="err">:</span><span class="nf">before</span><span class="p">,</span><span class="w"> </span><span class="no">.container</span><span class="p">::</span><span class="no">after</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nl">content:</span><span class="w"> </span><span class="err">""</span><span class="c1">;</span>
<span class="w">  </span><span class="nl">display:</span><span class="w"> </span><span class="nf">table</span><span class="c1">;</span>
<span class="err">}</span>
<span class="nl">.container:</span><span class="err">:</span><span class="nf">after</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nl">clear:</span><span class="w"> </span><span class="nf">both</span><span class="c1">;</span>
<span class="err">}</span>
<span class="na">.container</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nl">zoom:</span><span class="w"> </span><span class="err">1</span><span class="c1">;</span>
<span class="err">}</span>
</pre></div>

<hr>
<h3>Overflow Property</h3>
<p>This basic method is preferred for the usual case, when positioned content
will not show outside the bounds of the container.</p>
<p>http://www.quirksmode.org/css/clearing.html - <em>explains how to resolve common
issues related to this technique, namely, setting<code>width: 100%</code> on the
container.</em></p>
<div class="code"><pre class="code literal-block"><span class="na">.container</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nl">overflow:</span><span class="w"> </span><span class="nf">hidden</span><span class="c1">;</span>
<span class="w">  </span><span class="nl">display:</span><span class="w"> </span><span class="nf">inline-block</span><span class="c1">;</span>
<span class="w">  </span><span class="nl">display:</span><span class="w"> </span><span class="nf">block</span><span class="c1">;</span>
<span class="err">}</span>
</pre></div>

<p>Rather than using the <code>display</code> property to set "hasLayout" for IE, other
properties can be used for triggering "hasLayout" for an element.</p>
<div class="code"><pre class="code literal-block"><span class="na">.container</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nl">overflow:</span><span class="w"> </span><span class="nf">hidden</span><span class="c1">;</span>
<span class="w">  </span><span class="nl">zoom:</span><span class="w"> </span><span class="err">1</span><span class="c1">;</span>
<span class="w">  </span><span class="nl">display:</span><span class="w"> </span><span class="nf">block</span><span class="c1">;</span>
<span class="err">}</span>
</pre></div>

<p>Another way to clear floats using the <code>overflow</code> property is to use the
underscore hack. IE will apply the values prefixed with the underscore, other
browsers will not. The <code>zoom</code> property triggers hasLayout in IE:</p>
<div class="code"><pre class="code literal-block"><span class="na">.container</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nl">overflow:</span><span class="w"> </span><span class="nf">hidden</span><span class="c1">;</span>
<span class="w">  </span><span class="nl">_overflow:</span><span class="w"> </span><span class="nf">visible</span><span class="c1">; /* for IE */</span>
<span class="w">  </span><span class="nl">_zoom:</span><span class="w"> </span><span class="err">1</span><span class="c1">; /* for IE */</span>
<span class="err">}</span>
</pre></div>

<p>While this works... it is not ideal to use hacks.</p>
<hr>
<h3>PIE: Easy Clearing Method</h3>
<p>This older "Easy Clearing" method has the advantage of allowing positioned
elements to hang outside the bounds of the container, at the expense of more
tricky CSS.</p>
<p>This solution is quite old, but you can learn all about Easy Clearing on
Position Is Everything: http://www.positioniseverything.net/easyclearing.html</p>
<hr>
<h3>Element using "clear" property</h3>
<p>The quick and dirty solution (with some drawbacks) for when you’re quickly
slapping something together:</p>
<div class="code"><pre class="code literal-block"><span class="o">&lt;</span><span class="n">br</span><span class="w"> </span><span class="n">style</span><span class="o">=</span><span class="s">"clear: both"</span><span class="w"> </span><span class="o">/&gt;</span><span class="w"> </span><span class="o">&lt;!--</span><span class="w"> </span><span class="n">So</span><span class="w"> </span><span class="n">dirty</span><span class="o">!</span><span class="w"> </span><span class="o">--&gt;</span>
</pre></div>

<h4>Drawbacks</h4>
<ul>
<li>It's not responsive and thus may not provide the desired effect if layout styles change based upon media queries. A solution in pure CSS is more ideal.</li>
<li>It adds html markup without necessarily adding any semantic value.</li>
<li>It requires a inline definition and solution for each instance rather than a class reference to a single solution of a “clearfix” in the css and class references to it in the html.</li>
<li>It makes code difficult to work with for others as they may have to write more hacks to work around it.</li>
<li>In the future when you need/want to use another clearfix solution, you won't have to go back and remove every <code>&lt;br style="clear: both" /&gt;</code> tag littered around the markup.</li>
</ul>
<p><br></p>
<h3>Suggest</h3>
<h3>What problems are we trying to solve?</h3>
<p>There are two important considerations when floating stuff:</p>
<ol>
<li>
<strong>Containing descendant floats.</strong> This means that the element in question makes itself tall enough to wrap all floating descendants. (They don't hang outside.)</li>
</ol>
<p><img alt="Floating content hanging outside its container" src="images/3AUJp.png"></p>
<ol>
<li>
<strong>Insulating descendants from outside floats.</strong> This means that descendants inside of an element should be able to use <code>clear: both</code> and have it not interact with floats outside the element.</li>
</ol>
<p><img alt="&lt;code&gt;clear: both&lt;/code&gt; interacting with a float elsewhere in the
DOM" src="images/XIMXt.png"></p>
<h3>Block formatting contexts</h3>
<p>There's only one way to do both of these. And that is to establish a new block
formatting context. Elements that establish a block formatting context are an
insulated rectangle in which floats interact with each other. A block
formatting context will always be tall enough to visually wrap its floating
descendants, and no floats outside of a block formatting context may interact
with elements inside. This two-way insulation is exactly what you want. In IE,
this same concept is called hasLayout, which can be set via <code>zoom: 1</code>.</p>
<p>There are several ways to establish a block formatting context, but the
solution I recommend is <code>display: inline-block</code> with <code>width: 100%</code>. (Of
course, there are the usual caveats with using <code>width: 100%</code>, so use <code>box-
sizing: border-box</code> or put <code>padding</code>, <code>margin</code>, and <code>border</code> on a different
element.)</p>
<h3>The most robust solution</h3>
<p>Probably the most common application of floats is the two-column layout. (Can
be extended to three columns.)</p>
<p>First the markup structure.</p>
<div class="code"><pre class="code literal-block"><span class="nt">&lt;div</span><span class="w"> </span><span class="na">class=</span><span class="s">"container"</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;div</span><span class="w"> </span><span class="na">class=</span><span class="s">"sidebar"</span><span class="nt">&gt;</span>
<span class="w">    </span>sidebar<span class="nt">&lt;br/&gt;</span>sidebar<span class="nt">&lt;br/&gt;</span>sidebar
<span class="w">  </span><span class="nt">&lt;/div&gt;</span>
<span class="w">  </span><span class="nt">&lt;div</span><span class="w"> </span><span class="na">class=</span><span class="s">"main"</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;div</span><span class="w"> </span><span class="na">class=</span><span class="s">"main-content"</span><span class="nt">&gt;</span>
<span class="w">      </span>main<span class="w"> </span>content
<span class="w">      </span><span class="nt">&lt;span</span><span class="w"> </span><span class="na">style=</span><span class="s">"clear: both"</span><span class="nt">&gt;</span>
<span class="w">        </span>main<span class="w"> </span>content<span class="w"> </span>that<span class="w"> </span>uses<span class="w"> </span><span class="nt">&lt;code&gt;</span>clear:<span class="w"> </span>both<span class="nt">&lt;/code&gt;</span>
<span class="w">      </span><span class="nt">&lt;/span&gt;</span>
<span class="w">    </span><span class="nt">&lt;/div&gt;</span>
<span class="w">  </span><span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div>

<p>And now the CSS.</p>
<div class="code"><pre class="code literal-block"><span class="cm">/* Should contain all floated and non-floated content, so it needs to</span>
<span class="cm"> * establish a new block formatting context without using overflow: hidden.</span>
<span class="cm"> */</span>
<span class="na">.container</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nl">display:</span><span class="w"> </span><span class="nf">inline-block</span><span class="c1">;</span>
<span class="w">  </span><span class="nl">width:</span><span class="w"> </span><span class="err">100%</span><span class="c1">;</span>
<span class="w">  </span><span class="nl">zoom:</span><span class="w"> </span><span class="err">1</span><span class="c1">; /* new block formatting context via hasLayout for IE 6/7 */</span>
<span class="err">}</span>

<span class="cm">/* Fixed-width floated sidebar. */</span>
<span class="na">.sidebar</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nl">float:</span><span class="w"> </span><span class="nf">left</span><span class="c1">;</span>
<span class="w">  </span><span class="nl">width:</span><span class="w"> </span><span class="err">160</span><span class="nf">px</span><span class="c1">;</span>
<span class="err">}</span>

<span class="cm">/* Needs to make space for the sidebar. */</span>
<span class="na">.main</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nl">margin-left:</span><span class="w"> </span><span class="err">160</span><span class="nf">px</span><span class="c1">;</span>
<span class="err">}</span>

<span class="cm">/* Establishes a new block formatting context to insulate descendants from</span>
<span class="cm"> * the floating sidebar. */</span>
<span class="na">.main-content</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nl">display:</span><span class="w"> </span><span class="nf">inline-block</span><span class="c1">;</span>
<span class="w">  </span><span class="nl">width:</span><span class="w"> </span><span class="err">100%</span><span class="c1">;</span>
<span class="w">  </span><span class="nl">zoom:</span><span class="w"> </span><span class="err">1</span><span class="c1">; /* new block formatting context via hasLayout for IE 6/7 */</span>
<span class="err">}</span>
</pre></div>

<h3>Try it yourself</h3>
<p>Go to JS Bin to play around with the code and see how this solution is built
from the ground up.</p>
<h3>Traditional clearfix methods considered harmful</h3>
<p>The problem with the traditional clearfix solutions is that they use two
different rendering concepts to achieve the same goal for IE and everyone
else. In IE they use hasLayout to establish a new block formatting context,
but for everyone else they use generated boxes (<code>:after</code>) with <code>clear: both</code>,
which does not establish a new block formatting context. This means things
won't behave the same in all situations. For an explanation of why this is
bad, see Everything you Know about Clearfix is Wrong.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-583.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-581.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
