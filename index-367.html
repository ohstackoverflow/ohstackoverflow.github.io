<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 367) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-367.html">
<link rel="prev" href="index-368.html" type="text/html">
<link rel="next" href="index-366.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/create-git-branch-with-current-changes/" class="u-url">Create Git branch with current changes</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/create-git-branch-with-current-changes/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T05:02:50+08:00" itemprop="datePublished" title="2023-02-17 05:02">2023-02-17 05:02</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I started working on my <em>master</em> branch thinking that my task would be easy.
After a while I realized it would take more work and I want to do all this
work in a new branch.</p>
<p>How can I create a new branch and take all these changes with me without
dirtying <em>master</em>?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>If you hadn't made any commit yet, only (1: branch) and (3: checkout) would be
enough.<br>
Or, in one command: <strong><code>git checkout -b newBranch</code></strong></p>
<p>With Git 2.23+ (Q3 2019), the new command <code>git switch</code> would create the branch
in one line (with the same kind of <code>reset --hard</code>, so <strong>beware of its effect</strong>
):</p>
<div class="code"><pre class="code literal-block">#<span class="w"> </span><span class="nv">First</span>,<span class="w"> </span><span class="nv">save</span><span class="w"> </span><span class="nv">your</span><span class="w"> </span><span class="nv">work</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">progress</span><span class="o">!</span>
<span class="nv">git</span><span class="w"> </span><span class="nv">stash</span>

#<span class="w"> </span><span class="k">Then</span>,<span class="w"> </span><span class="nv">one</span><span class="w"> </span><span class="nv">command</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">create</span><span class="w"> </span><span class="o">*</span><span class="nv">and</span><span class="o">*</span><span class="w"> </span><span class="nv">switch</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">branch</span>
<span class="nv">git</span><span class="w"> </span><span class="nv">switch</span><span class="w"> </span><span class="o">-</span><span class="nv">f</span><span class="w"> </span><span class="o">-</span><span class="nv">c</span><span class="w"> </span><span class="nv">topic</span><span class="o">/</span><span class="nv">wip</span><span class="w"> </span><span class="nv">HEAD</span><span class="o">~</span><span class="mi">3</span>
</pre></div>

<hr>
<p>Or, as suggested in Alia's answer, use <code>git switch -m</code>, <em>without</em> <code>git stash</code>:</p>
<div class="code"><pre class="code literal-block">git switch -c topic/wip -m
</pre></div>

<blockquote>
<h3><code>--merge</code></h3>
<p>If you have local modifications to one or more files that are different
between the current branch and the branch to which you are switching, the
command refuses to switch branches in order to preserve your modifications
in context.</p>
<p>However, with this option, <strong>a three-way merge between the current branch,
your working tree contents, and the new branch is done, and you will be on
the new branch</strong>.</p>
<p>When a merge conflict happens, the index entries for conflicting paths are
left unmerged, and you need to resolve the conflicts and mark the resolved
paths with <code>git add</code> (or <code>git rm</code> if the merge should result in deletion of
the path).</p>
</blockquote>
<hr>
<p>As mentioned in the <code>git reset</code> man page:</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span>git<span class="w"> </span>stash<span class="w">                </span><span class="c1"># (0) Save your work in progress</span>
$<span class="w"> </span>git<span class="w"> </span>branch<span class="w"> </span>topic/wip<span class="w">     </span><span class="c1"># (1)</span>
$<span class="w"> </span>git<span class="w"> </span>reset<span class="w"> </span>--hard<span class="w"> </span>HEAD~3<span class="w">  </span><span class="c1"># (2)  NOTE: use $git reset --soft HEAD~3 (explanation below)</span>
$<span class="w"> </span>git<span class="w"> </span>checkout<span class="w"> </span>topic/wip<span class="w">   </span><span class="c1"># (3)</span>
</pre></div>

<ol>
<li>You have made some commits, but realize they were premature to be in the "<code>master</code>" branch. You want to continue polishing them in a topic branch, so create "<code>topic/wip</code>" branch off of the current <code>HEAD</code>.</li>
<li>Rewind the <code>master</code> branch to get rid of those three commits.</li>
<li>Switch to "<code>topic/wip</code>" branch and keep working.</li>
</ol>
<p>Again: new way (since 2019 and Git2.23) to do all that in one command:</p>
<div class="code"><pre class="code literal-block">git switch -f -c topic/wip HEAD~3
</pre></div>

<hr>
<p>Note: due to the "destructive" effect of a <code>git reset --hard</code> command (it does
resets the index and working tree. Any changes to tracked files in the working
tree since <code>&lt;commit&gt;</code> are discarded), I would rather go with:</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span>git<span class="w"> </span>reset<span class="w"> </span>--soft<span class="w"> </span>HEAD~3<span class="w">  </span><span class="c1"># (2)</span>
</pre></div>

<p>This would make sure I'm not losing any private file (not added to the index).<br>
The <code>--soft</code> option won't touch the index file nor the working tree at all
(but resets the head to <code>&lt;commit&gt;</code>, just like all modes do).</p>
<hr>
<p><br></p>
<h3>Suggest</h3>
<p>Like stated in this question: Git: Create a branch from unstagged/uncommited
changes on master: stash is not necessary.</p>
<p>Just use:</p>
<p><code>git checkout -b feature/newbranch</code></p>
<p>Any uncommitted work will be taken along to the new branch.</p>
<p>If you try to push you will get the following message</p>
<blockquote>
<p>fatal: The current branch feature/newbranch has no upstream branch. To push
the current branch and set the remote as upstream, use</p>
<div class="code"><pre class="code literal-block">git push --set-upstream origin feature/newbranch
</pre></div>

</blockquote>
<p>Just do as suggested to create the branch remotely:</p>
<p><code>git push --set-upstream origin feature/newbranch</code></p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-mock-void-methods-with-mockito/" class="u-url">How to mock void methods with Mockito</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-mock-void-methods-with-mockito/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T05:02:25+08:00" itemprop="datePublished" title="2023-02-17 05:02">2023-02-17 05:02</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>How to mock methods with void return type?</p>
<p>I implemented an observer pattern but I can't mock it with Mockito because I
don't know how.</p>
<p>And I tried to find an example on the Internet but didn't succeed.</p>
<p>My class looks like this:</p>
<div class="code"><pre class="code literal-block"><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">World</span><span class="w"> </span><span class="err">{</span>

<span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Listener</span><span class="o">&gt;</span><span class="w"> </span><span class="n">listeners</span><span class="p">;</span>

<span class="w">    </span><span class="n">void</span><span class="w"> </span><span class="n">addListener</span><span class="p">(</span><span class="n">Listener</span><span class="w"> </span><span class="n">item</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="n">listeners</span><span class="p">.</span><span class="k">add</span><span class="p">(</span><span class="n">item</span><span class="p">);</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="n">void</span><span class="w"> </span><span class="n">doAction</span><span class="p">(</span><span class="k">Action</span><span class="w"> </span><span class="n">goal</span><span class="p">,</span><span class="k">Object</span><span class="w"> </span><span class="n">obj</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="n">setState</span><span class="p">(</span><span class="ss">"i received"</span><span class="p">);</span>
<span class="w">        </span><span class="n">goal</span><span class="p">.</span><span class="n">doAction</span><span class="p">(</span><span class="n">obj</span><span class="p">);</span>
<span class="w">        </span><span class="n">setState</span><span class="p">(</span><span class="ss">"i finished"</span><span class="p">);</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="n">private</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="k">state</span><span class="p">;</span>
<span class="w">    </span><span class="o">//</span><span class="n">setter</span><span class="w"> </span><span class="n">getter</span><span class="w"> </span><span class="k">state</span>
<span class="err">}</span>

<span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">WorldTest</span><span class="w"> </span><span class="n">implements</span><span class="w"> </span><span class="n">Listener</span><span class="w"> </span><span class="err">{</span>

<span class="w">    </span><span class="nv">@Test</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="n">word</span><span class="err">{</span>
<span class="w">    </span><span class="n">World</span><span class="w">  </span><span class="n">w</span><span class="o">=</span><span class="w"> </span><span class="n">mock</span><span class="p">(</span><span class="n">World</span><span class="p">.</span><span class="k">class</span><span class="p">);</span>
<span class="w">    </span><span class="n">w</span><span class="p">.</span><span class="n">addListener</span><span class="p">(</span><span class="n">this</span><span class="p">);</span>
<span class="w">    </span><span class="p">...</span>
<span class="w">    </span><span class="p">...</span>

<span class="w">    </span><span class="err">}</span>
<span class="err">}</span>

<span class="n">interface</span><span class="w"> </span><span class="n">Listener</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="n">void</span><span class="w"> </span><span class="n">doAction</span><span class="p">();</span>
<span class="err">}</span>
</pre></div>

<p>The system is not triggered with mock.</p>
<p>I want to show the above-mentioned system state. And make assertions according
to them.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Take a look at the Mockito API docs. As the linked document mentions (Point #
12) you can use any of the <code>doThrow()</code>,<code>doAnswer()</code>,<code>doNothing()</code>,<code>doReturn()</code>
family of methods from Mockito framework to mock void methods.</p>
<p>For example,</p>
<div class="code"><pre class="code literal-block">Mockito.doThrow(new Exception()).when(instance).methodName();
</pre></div>

<p>or if you want to combine it with follow-up behavior,</p>
<div class="code"><pre class="code literal-block">Mockito.doThrow(new Exception()).doNothing().when(instance).methodName();
</pre></div>

<p>Presuming that you are looking at mocking the setter <code>setState(String s)</code> in
the class World below is the code uses <code>doAnswer</code> method to mock the
<code>setState</code>.</p>
<div class="code"><pre class="code literal-block"><span class="nt">World</span><span class="w"> </span><span class="nt">mockWorld</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">mock</span><span class="o">(</span><span class="nt">World</span><span class="p">.</span><span class="nc">class</span><span class="o">);</span><span class="w"> </span>
<span class="nt">doAnswer</span><span class="o">(</span><span class="nt">new</span><span class="w"> </span><span class="nt">Answer</span><span class="o">&lt;</span><span class="nt">Void</span><span class="o">&gt;()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="err">public</span><span class="w"> </span><span class="err">Void</span><span class="w"> </span><span class="err">answer(InvocationOnMock</span><span class="w"> </span><span class="err">invocation)</span><span class="w"> </span><span class="err">{</span>
<span class="w">      </span><span class="err">Object</span><span class="cp">[]</span><span class="w"> </span><span class="err">args</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">invocation.getArguments()</span><span class="p">;</span>
<span class="w">      </span><span class="err">System.out.println("called</span><span class="w"> </span><span class="err">with</span><span class="w"> </span><span class="n">arguments</span><span class="p">:</span><span class="w"> </span><span class="err">"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Arrays</span><span class="o">.</span><span class="nf">toString</span><span class="p">(</span><span class="n">args</span><span class="p">));</span>
<span class="w">      </span><span class="err">return</span><span class="w"> </span><span class="err">null</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="err">}</span><span class="o">)</span><span class="p">.</span><span class="nc">when</span><span class="o">(</span><span class="nt">mockWorld</span><span class="o">)</span><span class="p">.</span><span class="nc">setState</span><span class="o">(</span><span class="nt">anyString</span><span class="o">());</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>I think I've found a simpler answer to that question, to call the real method
for just one method (even if it has a void return) you can do this:</p>
<div class="code"><pre class="code literal-block">Mockito.doCallRealMethod().when(&lt;objectInstance&gt;).&lt;method&gt;();
&lt;objectInstance&gt;.&lt;method&gt;();
</pre></div>

<p>Or, you could call the real method for all methods of that class, doing this:</p>
<div class="code"><pre class="code literal-block">&lt;Object&gt; &lt;objectInstance&gt; = mock(&lt;Object&gt;.class, Mockito.CALLS_REAL_METHODS);
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/maximum-request-length-exceeded/" class="u-url">Maximum request length exceeded.</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/maximum-request-length-exceeded/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T05:01:58+08:00" itemprop="datePublished" title="2023-02-17 05:01">2023-02-17 05:01</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I am getting the error <strong>Maximum request length exceeded</strong> when I am trying to
upload a video in my site.</p>
<p>How do I fix this?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>If you are using IIS for hosting your application, then the default upload
file size is 4MB. To increase it, please use this below section in your
<code>web.config</code> -</p>
<div class="code"><pre class="code literal-block"><span class="nt">&lt;configuration&gt;</span>
<span class="w">    </span><span class="nt">&lt;system.web&gt;</span>
<span class="w">        </span><span class="nt">&lt;httpRuntime</span><span class="w"> </span><span class="na">maxRequestLength=</span><span class="s">"1048576"</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/system.web&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</pre></div>

<p>For IIS7 and above, you also need to add the lines below:</p>
<div class="code"><pre class="code literal-block"><span class="w"> </span><span class="nt">&lt;system.webServer&gt;</span>
<span class="w">   </span><span class="nt">&lt;security&gt;</span>
<span class="w">      </span><span class="nt">&lt;requestFiltering&gt;</span>
<span class="w">         </span><span class="nt">&lt;requestLimits</span><span class="w"> </span><span class="na">maxAllowedContentLength=</span><span class="s">"1073741824"</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;/requestFiltering&gt;</span>
<span class="w">   </span><span class="nt">&lt;/security&gt;</span>
<span class="w"> </span><span class="nt">&lt;/system.webServer&gt;</span>
</pre></div>

<p><strong>Note</strong> :</p>
<ul>
<li>
<strong><code>maxRequestLength</code></strong> is measured in <strong>kilobytes</strong>
</li>
<li>
<strong><code>maxAllowedContentLength</code></strong> is measured in <strong>bytes</strong>
</li>
</ul>
<p>which is why the values differ in this config example. (Both are equivalent to
1 GB.)</p>
<p><br></p>
<h3>Suggest</h3>
<p>I don't think it's been mentioned here, but to get this working, I had to
supply both of these values in the web.config:</p>
<p>In <code>system.web</code></p>
<div class="code"><pre class="code literal-block">&lt;httpRuntime maxRequestLength="1048576" executionTimeout="3600" /&gt;
</pre></div>

<p>And in <code>system.webServer</code></p>
<div class="code"><pre class="code literal-block"><span class="nt">&lt;security&gt;</span>
<span class="w">    </span><span class="nt">&lt;requestFiltering&gt;</span>
<span class="w">        </span><span class="nt">&lt;requestLimits</span><span class="w"> </span><span class="na">maxAllowedContentLength=</span><span class="s">"1073741824"</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/requestFiltering&gt;</span>
<span class="nt">&lt;/security&gt;</span>
</pre></div>

<p><strong>IMPORTANT</strong> : Both of these values must match. In this case, my max upload
is 1024 megabytes.</p>
<p>maxRequestLength has <em>1048576 KILOBYTES</em> , and maxAllowedContentLength has
<em>1073741824 BYTES</em>.</p>
<p>I know it's obvious, but it's easy to overlook.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-368.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-366.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
