<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 1644) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-1644.html">
<link rel="prev" href="index-1645.html" type="text/html">
<link rel="next" href="index-1643.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/handling-file-renames-in-git/" class="u-url">Handling file renames in Git</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/handling-file-renames-in-git/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T05:55:30+08:00" itemprop="datePublished" title="2023-03-03 05:55">2023-03-03 05:55</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I'd read that when renaming files in Git, you should commit any changes,
perform your rename and then stage your renamed file. Git will recognise the
file from the contents, rather than seeing it as a new untracked file, and
keep the change history.</p>
<p>However, doing just this tonight I ended up reverting to <code>git mv</code>.</p>
<div class="code"><pre class="code literal-block">&gt; $ git status
# On branch master
# Changes to be committed:
#   (use "git reset HEAD &lt;file&gt;..." to unstage)
#
#    modified:   index.html
#
</pre></div>

<p>I renamed my stylesheet in Finder from <code>iphone.css</code> to <code>mobile.css</code>:</p>
<div class="code"><pre class="code literal-block"><span class="o">&gt;</span><span class="w"> </span>$<span class="w"> </span><span class="nv">git</span><span class="w"> </span><span class="nv">status</span>
#<span class="w"> </span><span class="nv">On</span><span class="w"> </span><span class="nv">branch</span><span class="w"> </span><span class="nv">master</span>
#<span class="w"> </span><span class="nv">Changes</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">be</span><span class="w"> </span><span class="nv">committed</span>:
#<span class="w">   </span><span class="ss">(</span><span class="nv">use</span><span class="w"> </span><span class="s2">"git reset HEAD &lt;file&gt;..."</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">unstage</span><span class="ss">)</span>
#
#<span class="w">    </span><span class="nv">modified</span>:<span class="w">   </span><span class="nv">index</span>.<span class="nv">html</span>
#
#<span class="w"> </span><span class="nv">Changed</span><span class="w"> </span><span class="nv">but</span><span class="w"> </span><span class="nv">not</span><span class="w"> </span><span class="nv">updated</span>:
#<span class="w">   </span><span class="ss">(</span><span class="nv">use</span><span class="w"> </span><span class="s2">"git add/rm &lt;file&gt;..."</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">update</span><span class="w"> </span><span class="nv">what</span><span class="w"> </span><span class="nv">will</span><span class="w"> </span><span class="nv">be</span><span class="w"> </span><span class="nv">committed</span><span class="ss">)</span>
#<span class="w">   </span><span class="ss">(</span><span class="nv">use</span><span class="w"> </span><span class="s2">"git checkout -- &lt;file&gt;..."</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">discard</span><span class="w"> </span><span class="nv">changes</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">working</span><span class="w"> </span><span class="nv">directory</span><span class="ss">)</span>
#
#<span class="w">    </span><span class="nv">deleted</span>:<span class="w">    </span><span class="nv">css</span><span class="o">/</span><span class="nv">iphone</span>.<span class="nv">css</span>
#
#<span class="w"> </span><span class="nv">Untracked</span><span class="w"> </span><span class="nv">files</span>:
#<span class="w">   </span><span class="ss">(</span><span class="nv">use</span><span class="w"> </span><span class="s2">"git add &lt;file&gt;..."</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="k">include</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">what</span><span class="w"> </span><span class="nv">will</span><span class="w"> </span><span class="nv">be</span><span class="w"> </span><span class="nv">committed</span><span class="ss">)</span>
#
#<span class="w">    </span><span class="nv">css</span><span class="o">/</span><span class="nv">mobile</span>.<span class="nv">css</span>
</pre></div>

<p>So Git now thinks I've deleted one CSS file, and added a new one. It is not
what I want. Let’s undo the rename and let Git do the work.</p>
<div class="code"><pre class="code literal-block">&gt; $ git reset HEAD .
Unstaged changes after reset:
M    css/iphone.css
M    index.html
</pre></div>

<p>I am back to where I began:</p>
<div class="code"><pre class="code literal-block">&gt; $ git status
# On branch master
# Changes to be committed:
#   (use "git reset HEAD &lt;file&gt;..." to unstage)
#
#    modified:   index.html
#
</pre></div>

<p>Let's use <code>git mv</code> instead:</p>
<div class="code"><pre class="code literal-block"><span class="o">&gt;</span><span class="w"> </span><span class="err">$</span><span class="w"> </span><span class="n">git</span><span class="w"> </span><span class="n">mv</span><span class="w"> </span><span class="n">css</span><span class="o">/</span><span class="n">iphone</span><span class="p">.</span><span class="n">css</span><span class="w"> </span><span class="n">css</span><span class="o">/</span><span class="n">mobile</span><span class="p">.</span><span class="n">css</span>
<span class="o">&gt;</span><span class="w"> </span><span class="err">$</span><span class="w"> </span><span class="n">git</span><span class="w"> </span><span class="n">status</span>
<span class="cp"># On branch master</span>
<span class="cp"># Changes to be committed:</span>
<span class="cp">#   (use "git reset HEAD &lt;file&gt;..." to unstage)</span>
<span class="cp">#</span>
<span class="cp">#    renamed:    css/iphone.css -&gt; css/mobile.css</span>
<span class="cp">#</span>
<span class="cp"># Changed but not updated:</span>
<span class="cp">#   (use "git add &lt;file&gt;..." to update what will be committed)</span>
<span class="cp">#   (use "git checkout -- &lt;file&gt;..." to discard changes in working directory)</span>
<span class="cp">#</span>
<span class="cp">#    modified:   index.html</span>
<span class="cp">#</span>
</pre></div>

<p>It looks like we're good. So why didn't Git recognise the rename the first
time around when I used Finder?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>For <code>git mv</code> the manual page says</p>
<blockquote>
<p>The index is updated after successful completion, […]</p>
</blockquote>
<p>So, at first, you have to update the index on your own (by using <code>git add
mobile.css</code>). However <code>git status</code> will still show two different files:</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span>git<span class="w"> </span>status
<span class="c1"># On branch master</span>
warning:<span class="w"> </span>LF<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span>replaced<span class="w"> </span>by<span class="w"> </span>CRLF<span class="w"> </span><span class="k">in</span><span class="w"> </span>index.html
<span class="c1"># Changes to be committed:</span>
<span class="c1">#   (use "git reset HEAD &lt;file&gt;..." to unstage)</span>
<span class="c1">#</span>
<span class="c1">#       modified:   index.html</span>
<span class="c1">#       new file:   mobile.css</span>
<span class="c1">#</span>
<span class="c1"># Changed but not updated:</span>
<span class="c1">#   (use "git add/rm &lt;file&gt;..." to update what will be committed)</span>
<span class="c1">#   (use "git checkout -- &lt;file&gt;..." to discard changes in working directory)</span>
<span class="c1">#</span>
<span class="c1">#       deleted:    iphone.css</span>
<span class="c1">#</span>
</pre></div>

<p>You can get a different output by running <code>git commit --dry-run -a</code>, which
results in what you expect:</p>
<div class="code"><pre class="code literal-block"><span class="n">Tanascius</span><span class="nv">@H181</span><span class="w"> </span><span class="o">/</span><span class="n">d</span><span class="o">/</span><span class="n">temp</span><span class="o">/</span><span class="n">blo</span><span class="w"> </span><span class="p">(</span><span class="n">master</span><span class="p">)</span>
<span class="err">$</span><span class="w"> </span><span class="n">git</span><span class="w"> </span><span class="k">commit</span><span class="w"> </span><span class="o">--</span><span class="n">dry</span><span class="o">-</span><span class="n">run</span><span class="w"> </span><span class="o">-</span><span class="n">a</span>
<span class="err">#</span><span class="w"> </span><span class="k">On</span><span class="w"> </span><span class="n">branch</span><span class="w"> </span><span class="n">master</span>
<span class="nl">warning</span><span class="p">:</span><span class="w"> </span><span class="n">LF</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">replaced</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">CRLF</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">index</span><span class="p">.</span><span class="n">html</span>
<span class="err">#</span><span class="w"> </span><span class="n">Changes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="nl">committed</span><span class="p">:</span>
<span class="err">#</span><span class="w">   </span><span class="p">(</span><span class="k">use</span><span class="w"> </span><span class="ss">"git reset HEAD &lt;file&gt;..."</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">unstage</span><span class="p">)</span>
<span class="err">#</span>
<span class="err">#</span><span class="w">       </span><span class="nl">modified</span><span class="p">:</span><span class="w">   </span><span class="k">index</span><span class="p">.</span><span class="n">html</span>
<span class="err">#</span><span class="w">       </span><span class="nl">renamed</span><span class="p">:</span><span class="w">    </span><span class="n">iphone</span><span class="p">.</span><span class="n">css</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">mobile</span><span class="p">.</span><span class="n">css</span>
<span class="err">#</span>
</pre></div>

<p>I can't tell you exactly why we see these differences between <code>git status</code> and
<code>git commit --dry-run -a</code>, but here is a hint from Linus:</p>
<blockquote>
<p>git really doesn't even <em>care</em> about the whole "rename detection"
internally, and any commits you have done with renames are totally
independent of the heuristics we then use to <em>show</em> the renames.</p>
</blockquote>
<p>A <code>dry-run</code> uses the real renaming mechanisms, while a <code>git status</code> probably
doesn't.</p>
<p><br></p>
<h3>Suggest</h3>
<p>You have to add the two modified files to the index before Git will recognize
it as a move.</p>
<p>The only difference between <code>mv old new</code> and <code>git mv old new</code> is that the <code>git
mv</code> also adds the files to the index.</p>
<p><code>mv old new</code> then <code>git add -A</code> would have worked, too.</p>
<p>Note that you can't just use <code>git add .</code>, because that doesn't add removals to
the index.</p>
<p>See <em>Difference between "git add -A" and "git add ."</em></p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/redirecting-to-a-certain-route-based-on-condition/" class="u-url">Redirecting to a certain route based on condition</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/redirecting-to-a-certain-route-based-on-condition/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T05:55:04+08:00" itemprop="datePublished" title="2023-03-03 05:55">2023-03-03 05:55</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I'm writing a small AngularJS app that has a login view and a main view,
configured like so:</p>
<div class="code"><pre class="code literal-block"><span class="o">$</span><span class="nt">routeProvider</span>
<span class="w"> </span><span class="p">.</span><span class="nc">when</span><span class="o">(</span><span class="s1">'/main'</span><span class="w"> </span><span class="o">,</span><span class="w"> </span><span class="p">{</span><span class="n">templateUrl</span><span class="p">:</span><span class="w"> </span><span class="s1">'partials/main.html'</span><span class="p">,</span><span class="w">  </span><span class="n">controller</span><span class="o">:</span><span class="w"> </span><span class="n">MainController</span><span class="p">}</span><span class="o">)</span>
<span class="w"> </span><span class="p">.</span><span class="nc">when</span><span class="o">(</span><span class="s1">'/login'</span><span class="o">,</span><span class="w"> </span><span class="p">{</span><span class="n">templateUrl</span><span class="p">:</span><span class="w"> </span><span class="s1">'partials/login.html'</span><span class="p">,</span><span class="w"> </span><span class="n">controller</span><span class="o">:</span><span class="w"> </span><span class="n">LoginController</span><span class="p">}</span><span class="o">)</span>
<span class="w"> </span><span class="p">.</span><span class="nc">otherwise</span><span class="o">(</span><span class="p">{</span><span class="n">redirectTo</span><span class="p">:</span><span class="w"> </span><span class="s1">'/login'</span><span class="p">}</span><span class="o">);</span>
</pre></div>

<p>My LoginController checks the user/pass combination and sets a property on the
$rootScope reflecting this:</p>
<div class="code"><pre class="code literal-block"><span class="nv">function</span><span class="w"> </span><span class="nv">LoginController</span><span class="ss">(</span>$<span class="nv">scope</span>,<span class="w"> </span>$<span class="nv">location</span>,<span class="w"> </span>$<span class="nv">rootScope</span><span class="ss">)</span><span class="w"> </span>{
<span class="w"> </span>$<span class="nv">scope</span>.<span class="nv">attemptLogin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">function</span><span class="ss">()</span><span class="w"> </span>{
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="w"> </span>$<span class="nv">scope</span>.<span class="nv">username</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>$<span class="nv">scope</span>.<span class="nv">password</span><span class="w"> </span><span class="ss">)</span><span class="w"> </span>{<span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nv">test</span>
<span class="w">        </span>$<span class="nv">rootScope</span>.<span class="nv">loggedUser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>$<span class="nv">scope</span>.<span class="nv">username</span><span class="c1">;</span>
<span class="w">        </span>$<span class="nv">location</span>.<span class="nv">path</span><span class="ss">(</span><span class="w"> </span><span class="s2">"/main"</span><span class="w"> </span><span class="ss">)</span><span class="c1">;</span>
<span class="w">    </span>}<span class="w"> </span><span class="k">else</span><span class="w"> </span>{
<span class="w">        </span>$<span class="nv">scope</span>.<span class="nv">loginError</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Invalid user/pass."</span><span class="c1">;</span>
<span class="w">    </span>}
}
</pre></div>

<p>Everything works, but if I access <code>http://localhost/#/main</code> I end up bypassing
the login screen. I wanted to write something like "whenever the route
changes, if $rootScope.loggedUser is null then redirect to /login"</p>
<p>...</p>
<p>... wait. Can I listen to route changes somehow? I'll post this question
anyway and keep looking.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>After some diving through some documentation and source code, I think I got it
working. Perhaps this will be useful for someone else?</p>
<p>I added the following to my module configuration:</p>
<div class="code"><pre class="code literal-block"><span class="n">angular</span><span class="p">.</span><span class="k">module</span><span class="p">(...)</span>
<span class="w"> </span><span class="p">.</span><span class="n">config</span><span class="p">(</span><span class="w"> </span><span class="p">['</span><span class="n">$routeProvider</span><span class="p">',</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">$routeProvider</span><span class="p">)</span><span class="w"> </span><span class="p">{...}]</span><span class="w"> </span><span class="p">)</span>
<span class="w"> </span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">$rootScope</span><span class="p">,</span><span class="w"> </span><span class="n">$location</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="c1">// register listener to watch route changes</span>
<span class="w">    </span><span class="n">$rootScope</span><span class="p">.</span><span class="n">$on</span><span class="p">(</span><span class="w"> </span><span class="s">"$routeChangeStart"</span><span class="p">,</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="k">event</span><span class="p">,</span><span class="w"> </span><span class="n">next</span><span class="p">,</span><span class="w"> </span><span class="n">current</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">$rootScope</span><span class="p">.</span><span class="n">loggedUser</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">null</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// no logged user, we should be going to #login</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">next</span><span class="p">.</span><span class="n">templateUrl</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s">"partials/login.html"</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="c1">// not going to #login, we should redirect now</span>
<span class="w">          </span><span class="n">$location</span><span class="p">.</span><span class="n">path</span><span class="p">(</span><span class="w"> </span><span class="s">"/login"</span><span class="w"> </span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span><span class="w">         </span>
<span class="w">    </span><span class="p">});</span>
<span class="w"> </span><span class="p">})</span>
</pre></div>

<p>The one thing that seems odd is that I had to test the partial name
(<code>login.html</code>) because the "next" Route object did not have a url or something
else. Maybe there's a better way?</p>
<p><br></p>
<h3>Suggest</h3>
<p>Here is maybe a more elegant and flexible solution with 'resolve'
configuration property and 'promises' enabling eventual data loading on
routing and routing rules depending on data.</p>
<p>You specify a function in 'resolve' in routing config and in the function load
and check data, do all redirects. If you need to load data, you return a
promise, if you need to do redirect - reject promise before that. All details
can be found on $routerProvider and $q documentation pages.</p>
<div class="code"><pre class="code literal-block"><span class="s1">'use strict'</span><span class="p">;</span>

<span class="k">var</span><span class="w"> </span><span class="n">app</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">angular</span><span class="o">.</span><span class="n">module</span><span class="p">(</span><span class="s1">'app'</span><span class="p">,</span><span class="w"> </span><span class="p">[])</span>
<span class="w">    </span><span class="o">.</span><span class="n">config</span><span class="p">([</span><span class="s1">'$routeProvider'</span><span class="p">,</span><span class="w"> </span><span class="n">function</span><span class="p">(</span><span class="o">$</span><span class="n">routeProvider</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="o">$</span><span class="n">routeProvider</span>
<span class="w">            </span><span class="o">.</span><span class="n">when</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">templateUrl</span><span class="p">:</span><span class="w"> </span><span class="s2">"login.html"</span><span class="p">,</span>
<span class="w">                </span><span class="n">controller</span><span class="p">:</span><span class="w"> </span><span class="n">LoginController</span>
<span class="w">            </span><span class="p">})</span>
<span class="w">            </span><span class="o">.</span><span class="n">when</span><span class="p">(</span><span class="s1">'/private'</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">templateUrl</span><span class="p">:</span><span class="w"> </span><span class="s2">"private.html"</span><span class="p">,</span>
<span class="w">                </span><span class="n">controller</span><span class="p">:</span><span class="w"> </span><span class="n">PrivateController</span><span class="p">,</span>
<span class="w">                </span><span class="n">resolve</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">factory</span><span class="p">:</span><span class="w"> </span><span class="n">checkRouting</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">})</span>
<span class="w">            </span><span class="o">.</span><span class="n">when</span><span class="p">(</span><span class="s1">'/private/anotherpage'</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">templateUrl</span><span class="p">:</span><span class="s2">"another-private.html"</span><span class="p">,</span>
<span class="w">                </span><span class="n">controller</span><span class="p">:</span><span class="w"> </span><span class="n">AnotherPriveController</span><span class="p">,</span>
<span class="w">                </span><span class="n">resolve</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">factory</span><span class="p">:</span><span class="w"> </span><span class="n">checkRouting</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">})</span>
<span class="w">            </span><span class="o">.</span><span class="n">otherwise</span><span class="p">({</span><span class="w"> </span><span class="n">redirectTo</span><span class="p">:</span><span class="w"> </span><span class="s1">'/'</span><span class="w"> </span><span class="p">});</span>
<span class="w">    </span><span class="p">}]);</span>

<span class="k">var</span><span class="w"> </span><span class="n">checkRouting</span><span class="o">=</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="p">(</span><span class="o">$</span><span class="n">q</span><span class="p">,</span><span class="w"> </span><span class="o">$</span><span class="n">rootScope</span><span class="p">,</span><span class="w"> </span><span class="o">$</span><span class="n">location</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">$</span><span class="n">rootScope</span><span class="o">.</span><span class="n">userProfile</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="bp">true</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">var</span><span class="w"> </span><span class="n">deferred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">$</span><span class="n">q</span><span class="o">.</span><span class="n">defer</span><span class="p">();</span>
<span class="w">        </span><span class="o">$</span><span class="n">http</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">"/loadUserProfile"</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">userToken</span><span class="p">:</span><span class="w"> </span><span class="s2">"blah"</span><span class="w"> </span><span class="p">})</span>
<span class="w">            </span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="n">function</span><span class="w"> </span><span class="p">(</span><span class="n">response</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="o">$</span><span class="n">rootScope</span><span class="o">.</span><span class="n">userProfile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">response</span><span class="o">.</span><span class="n">userProfile</span><span class="p">;</span>
<span class="w">                </span><span class="n">deferred</span><span class="o">.</span><span class="n">resolve</span><span class="p">(</span><span class="bp">true</span><span class="p">);</span>
<span class="w">            </span><span class="p">})</span>
<span class="w">            </span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">deferred</span><span class="o">.</span><span class="n">reject</span><span class="p">();</span>
<span class="w">                </span><span class="o">$</span><span class="n">location</span><span class="o">.</span><span class="n">path</span><span class="p">(</span><span class="s2">"/"</span><span class="p">);</span>
<span class="w">             </span><span class="p">});</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">deferred</span><span class="o">.</span><span class="n">promise</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">};</span>
</pre></div>

<p>For russian-speaking folks there is a post on habr "Вариант условного раутинга
в AngularJS."</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-print-a-query-string-with-parameter-values-when-using-hibernate/" class="u-url">How to print a query string with parameter values when using Hibernate</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-print-a-query-string-with-parameter-values-when-using-hibernate/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T05:54:34+08:00" itemprop="datePublished" title="2023-03-03 05:54">2023-03-03 05:54</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Is it possible in Hibernate to print generated SQL queries with real values
instead of question marks?</p>
<p>How would you suggest to print queries with real values if it is not possible
with Hibernate API?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>You need to enable logging for the the following categories:</p>
<ul>
<li>
<code>org.hibernate.SQL</code> - set to <code>debug</code> to log all SQL DML statements as they are executed</li>
<li>
<code>org.hibernate.type</code> - set to <code>trace</code> to log all JDBC parameters</li>
</ul>
<p>So a log4j configuration could look like:</p>
<div class="code"><pre class="code literal-block"># logs the SQL statements
log4j.logger.org.hibernate.SQL=debug

# Logs the JDBC parameters passed to a query
log4j.logger.org.hibernate.type=trace
</pre></div>

<p>The first is equivalent to <code>hibernate.show_sql=true</code> legacy property, the
second <strong>prints the bound parameters among other things.</strong></p>
<p>Another solution (non hibernate based) would be to use a JDBC proxy driver
like P6Spy.</p>
<p><br></p>
<h3>Suggest</h3>
<p>If you are using Spring Boot, just config this:</p>
<p><strong><code>application.yml</code></strong></p>
<div class="code"><pre class="code literal-block"><span class="n">logging</span><span class="o">:</span>
<span class="w">  </span><span class="n">level</span><span class="o">:</span>
<span class="w">    </span><span class="n">org</span><span class="o">.</span><span class="na">hibernate</span><span class="o">.</span><span class="na">SQL</span><span class="o">:</span><span class="w"> </span><span class="n">DEBUG</span>
<span class="w">    </span><span class="n">org</span><span class="o">.</span><span class="na">hibernate</span><span class="o">.</span><span class="na">type</span><span class="o">:</span><span class="w"> </span><span class="n">TRACE</span>
</pre></div>

<p><strong><code>application.properties</code></strong></p>
<div class="code"><pre class="code literal-block">logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type=TRACE
</pre></div>

<p>and nothing more.</p>
<p>Your log will be something like this:</p>
<div class="code"><pre class="code literal-block"><span class="mi">2020-12</span><span class="mo">-07</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">DEBUG</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">o</span><span class="p">.</span><span class="n">h</span><span class="p">.</span><span class="n">SQL</span><span class="o">:</span><span class="mi">127</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">insert</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">Employee</span><span class="w"> </span><span class="p">(</span><span class="kt">id</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">title</span><span class="p">,</span><span class="w"> </span><span class="kt">id</span><span class="p">)</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="p">(</span><span class="o">?</span><span class="p">,</span><span class="w"> </span><span class="o">?</span><span class="p">,</span><span class="w"> </span><span class="o">?</span><span class="p">,</span><span class="w"> </span><span class="o">?</span><span class="p">)</span>
<span class="mi">2020-12</span><span class="mo">-07</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">TRACE</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">o</span><span class="p">.</span><span class="n">h</span><span class="p">.</span><span class="n">t</span><span class="p">.</span><span class="n">d</span><span class="p">.</span><span class="n">s</span><span class="p">.</span><span class="n">BasicBinder</span><span class="o">:</span><span class="mi">64</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">binding</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="p">[</span><span class="n">VARCHAR</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">[</span><span class="mo">001</span><span class="p">]</span>
<span class="mi">2020-12</span><span class="mo">-07</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">TRACE</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">o</span><span class="p">.</span><span class="n">h</span><span class="p">.</span><span class="n">t</span><span class="p">.</span><span class="n">d</span><span class="p">.</span><span class="n">s</span><span class="p">.</span><span class="n">BasicBinder</span><span class="o">:</span><span class="mi">64</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">binding</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="p">[</span><span class="n">VARCHAR</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">[</span><span class="n">John</span><span class="w"> </span><span class="n">Smith</span><span class="p">]</span>
<span class="mi">2020-12</span><span class="mo">-07</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">TRACE</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">o</span><span class="p">.</span><span class="n">h</span><span class="p">.</span><span class="n">t</span><span class="p">.</span><span class="n">d</span><span class="p">.</span><span class="n">s</span><span class="p">.</span><span class="n">BasicBinder</span><span class="o">:</span><span class="mi">52</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">binding</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="p">[</span><span class="n">VARCHAR</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">[</span><span class="n">null</span><span class="p">]</span>
<span class="mi">2020-12</span><span class="mo">-07</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">TRACE</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">o</span><span class="p">.</span><span class="n">h</span><span class="p">.</span><span class="n">t</span><span class="p">.</span><span class="n">d</span><span class="p">.</span><span class="n">s</span><span class="p">.</span><span class="n">BasicBinder</span><span class="o">:</span><span class="mi">64</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">binding</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="p">[</span><span class="n">BIGINT</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-1645.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-1643.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
