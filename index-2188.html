<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 2188) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-2188.html">
<link rel="prev" href="index-2189.html" type="text/html">
<link rel="next" href="index-2187.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/do-zombies-exist-in-net/" class="u-url">Do zombies exist ... in .NET?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/do-zombies-exist-in-net/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T21:30:14+08:00" itemprop="datePublished" title="2023-03-03 21:30">2023-03-03 21:30</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I was having a discussion with a teammate about locking in .NET. He's a really
bright guy with an extensive background in both lower-level and higher-level
programming, but his experience with lower level programming far exceeds mine.
Anyway, He argued that .NET locking should be avoided on critical systems
expected to be under heavy-load if at all possible in order to avoid the
admittedly small possibility of a "zombie thread" crashing a system. I
routinely use locking and I didn't know what a "zombie thread" was, so I
asked. The impression I got from his explanation is that a zombie thread is a
thread that has terminated but somehow still holds onto some resources. An
example he gave of how a zombie thread could break a system was a thread
begins some procedure after locking on some object, and then is at some point
terminated before the lock can be released. This situation has the potential
to crash the system, because eventually, attempts to execute that method will
result in the threads all waiting for access to an object that will never be
returned, because the thread that is using the locked object is dead.</p>
<p>I think I got the gist of this, but if I'm off base, please let me know. The
concept made sense to me. I wasn't completely convinced that this was a real
scenario that could happen in .NET. I've never previously heard of "zombies",
but I do recognize that programmers who have worked in depth at lower levels
tend to have a deeper understanding of computing fundamentals (like
threading). I definitely do see the value in locking, however, and I have seen
many world class programmers leverage locking. I also have limited ability to
evaluate this for myself because I know that the <code>lock(obj)</code> statement is
really just syntactic sugar for:</p>
<div class="code"><pre class="code literal-block"><span class="nb nb-Type">bool</span><span class="w"> </span><span class="n">lockWasTaken</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">false</span><span class="p">;</span>
<span class="k">var</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obj</span><span class="p">;</span>
<span class="n">try</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Monitor</span><span class="o">.</span><span class="n">Enter</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span><span class="w"> </span><span class="n">ref</span><span class="w"> </span><span class="n">lockWasTaken</span><span class="p">);</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">body</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
<span class="n">finally</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">lockWasTaken</span><span class="p">)</span><span class="w"> </span><span class="n">Monitor</span><span class="o">.</span><span class="n">Exit</span><span class="p">(</span><span class="n">temp</span><span class="p">);</span><span class="w"> </span><span class="p">}</span>
</pre></div>

<p>and because <code>Monitor.Enter</code> and <code>Monitor.Exit</code> are marked <code>extern</code>. It seems
conceivable that .NET does some kind of processing that protects threads from
exposure to system components that could have this kind of impact, but that is
purely speculative and probably just based on the fact that I've never heard
of "zombie threads" before. So, I'm hoping I can get some feedback on this
here:</p>
<ol>
<li>Is there a clearer definition of a "zombie thread" than what I've explained here?</li>
<li>Can zombie threads occur on .NET? (Why/Why not?) </li>
<li>If applicable, How could I force the creation of a zombie thread in .NET?</li>
<li>If applicable, How can I leverage locking without risking a zombie thread scenario in .NET?</li>
</ol>
<h2>Update</h2>
<p>I asked this question a little over two years ago. Today this happened:</p>
<p><img alt="Object is in a zombie state." src="images/qd6Wd.png"></p>
<p><br><br></p>
<h2>Answer</h2>
<ul>
<li><strong>Is there a clearer definition of a "zombie thread" than what I've explained here?</strong></li>
</ul>
<p>Seems like a pretty good explanation to me - a thread that has terminated (and
can therefore no longer release any resources), but whose resources (e.g.
handles) are still around and (potentially) causing problems.</p>
<ul>
<li><strong>Can zombie threads occur on .NET? (Why/Why not?)</strong></li>
<li><strong>If applicable, How could I force the creation of a zombie thread in .NET?</strong></li>
</ul>
<p>They sure do, look, I made one!</p>
<div class="code"><pre class="code literal-block"><span class="k">[DllImport("kernel32.dll")]</span>
<span class="na">private static extern void ExitThread(uint dwExitCode);</span>

<span class="na">static void Main(string[] args)</span>
<span class="na">{</span>
<span class="w">    </span><span class="na">new Thread(Target).Start();</span>
<span class="w">    </span><span class="na">Console.ReadLine();</span>
<span class="na">}</span>

<span class="na">private static void Target()</span>
<span class="na">{</span>
<span class="w">    </span><span class="na">using (var file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">File.Open("test.txt", FileMode.OpenOrCreate))</span>
<span class="w">    </span><span class="na">{</span>
<span class="w">        </span><span class="na">ExitThread(0);</span>
<span class="w">    </span><span class="na">}</span>
<span class="na">}</span>
</pre></div>

<p>This program starts a thread <code>Target</code> which opens a file and then immediately
kills itself using <code>ExitThread</code>. <del>The resulting zombie thread will never
release the handle to the "test.txt" file and so the file will remain open
until the program terminates (you can check with process explorer or
similar).</del> The handle to "test.txt" won't be released until <code>GC.Collect</code> is
called - it turns out it is even more difficult than I thought to create a
zombie thread that leaks handles)</p>
<ul>
<li><strong>If applicable, How can I leverage locking without risking a zombie thread scenario in .NET?</strong></li>
</ul>
<p>Don't do what I just did!</p>
<p>As long as your code cleans up after itself correctly (use Safe Handles or
equivalent classes if working with unmanaged resources), and as long as you
don't go out of your way to kill threads in weird and wonderful ways (safest
way is just to never kill threads - let them terminate themselves normally, or
through exceptions if necessary), the only way that you are going to have
something resembling a zombie thread is if something has gone <strong>very</strong> wrong
(e.g. something goes wrong in the CLR).</p>
<p>In fact its actually surprisingly difficult to create a zombie thread (I had
to P/Invoke into a function that esentially tells you in the documentation not
to call it outside of C). For example the following (awful) code actually
doesn't create a zombie thread.</p>
<div class="code"><pre class="code literal-block"><span class="k">static</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="w"> </span><span class="n">Main</span><span class="p">(</span><span class="n">string</span><span class="p">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">thread</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(</span><span class="n">Target</span><span class="p">);</span>
<span class="w">    </span><span class="n">thread</span><span class="o">.</span><span class="n">Start</span><span class="p">();</span>
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="n">Ugh</span><span class="p">,</span><span class="w"> </span><span class="n">never</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="n">Abort</span><span class="o">...</span>
<span class="w">    </span><span class="n">thread</span><span class="o">.</span><span class="n">Abort</span><span class="p">();</span>
<span class="w">    </span><span class="n">Console</span><span class="o">.</span><span class="n">ReadLine</span><span class="p">();</span>
<span class="p">}</span>

<span class="n">private</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="w"> </span><span class="n">Target</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="n">Ouch</span><span class="p">,</span><span class="w"> </span><span class="n">open</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">isn</span><span class="s1">'t closed...</span>
<span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">File</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="s2">"test.txt"</span><span class="p">,</span><span class="w"> </span><span class="n">FileMode</span><span class="o">.</span><span class="n">OpenOrCreate</span><span class="p">);</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="bp">true</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">Thread</span><span class="o">.</span><span class="n">Sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">GC</span><span class="o">.</span><span class="n">KeepAlive</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>

<p>Despite making some pretty awful mistakes, the handle to "test.txt" is still
closed as soon as <code>Abort</code> is called (as part of the finalizer for <code>file</code> which
under the covers uses SafeFileHandle to wrap its file handle)</p>
<p>The locking example in C.Evenhuis answer is probably the easiest way to fail
to release a resource (a lock in this case) when a thread is terminated in a
non-weird way, but thats easily fixed by either using a <code>lock</code> statement
instead, or putting the release in a <code>finally</code> block.</p>
<p>See also</p>
<ul>
<li>Subtleties of C# IL codegen for a <strong>very</strong> subtle case where an exception can prevent a lock from being released even when using the <code>lock</code> keyword (but only in .Net 3.5 and earlier)</li>
<li>Locks and exceptions do not mix</li>
</ul>
<p><br></p>
<h3>Suggest</h3>
<p><em>I've cleaned up my answer a bit, but left the original one below for
reference</em></p>
<p>It’s the first time I've heard of the term zombies so I'll assume its
definition is:</p>
<p><strong>A thread that has terminated without releasing all of its resources</strong></p>
<p>So given that definition, then yes, you can do that in .NET, as with other
languages (C/C++, java).</p>
<p><strong>However</strong> , I do not think this as a good reason not to write threaded,
mission critical code in .NET. There may be other reasons to decide against
.NET but writing off .NET just because you can have zombie threads somehow
doesn't make sense to me. Zombie threads are possible in C/C++ (I'd even argue
that it’s a lot easier to mess up in C) and a lot of critical, threaded apps
are in C/C++ (high volume trading, databases etc).</p>
<p><strong>Conclusion</strong> If you are in the process of deciding on a language to use,
then I suggest you take the big picture into consideration: performance, team
skills, schedule, integration with existing apps etc. Sure, zombie threads are
something that you should think about, but since it’s so difficult to actually
make this mistake in .NET compared to other languages like C, I think this
concern will be overshadowed by other things like the ones mentioned above.
Good luck!</p>
<p><strong>Original Answer</strong> Zombies† can exist if you don't write proper threading
code. The same is true for other languages like C/C++ and Java. But this is
not a reason not to write threaded code in .NET.</p>
<p>And just like with any other language, know the price before using something.
It also helps to know what is happening under the hood so you can foresee any
potential problems.</p>
<p>Reliable code for mission critical systems is not easy to write, whatever
language you're in. But I'm positive it’s not impossible to do correctly in
.NET. Also AFAIK, .NET threading is not that different from threading in
C/C++, it uses (or is built from) the same system calls except for some .net
specific constructs (like the light weight versions of RWL and event classes).</p>
<p>†first time I've heard of the term zombies but based on your description, your
colleague probably meant a thread that terminated without release all
resources. This could potentially cause a deadlock, memory leak or some other
bad side effect. This is obviously not desirable but singling out .NET because
of this <em>possibility</em> is probably not a good idea since it’s possible in other
languages too. I'd even argue that it’s easier to mess up in C/C++ than in
.NET (especially so in C where you don't have RAII) but a lot of critical apps
are written in C/C++ right? So it really depends on your individual
circumstances. If you want to extract every ounce of speed from your
application and want to get as close to bare metal as possible, then .NET
<em>might</em> not be the best solution. If you are on a tight budget and do a lot of
interfacing with web services/existing .net libraries/etc then .NET <em>may be</em> a
good choice.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/what-s-the-difference-between-interface-and-interface-in-java/" class="u-url">What's the difference between interface and @interface in java?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/what-s-the-difference-between-interface-and-interface-in-java/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T21:29:22+08:00" itemprop="datePublished" title="2023-03-03 21:29">2023-03-03 21:29</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I haven't touched Java since using JBuilder in the late 90's while at
University, so I'm a little out of touch - at any rate I've been working on a
small Java project this week, and using Intellij IDEA as my IDE, for a change
of pace from my regular .Net development.</p>
<p>I notice it has support for adding interfaces and @interfaces, what is an
@interface, and how does it differ from a normal interface?</p>
<div class="code"><pre class="code literal-block">public interface Test {
}
</pre></div>

<p>vs.</p>
<div class="code"><pre class="code literal-block"><span class="k">public</span><span class="w"> </span><span class="nv">@interface</span><span class="w"> </span><span class="n">Test</span><span class="w"> </span><span class="err">{</span>
<span class="err">}</span>
</pre></div>

<p>I've done a bit of searching, but couldn't find a great deal of useful info
referring to @interface.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>The <em>@</em> symbol denotes an annotation type definition.</p>
<p>That means it is <strong>not</strong> really an interface, but rather a new annotation type
-- to be used as a function modifier, such as <em>@override</em>.</p>
<p>See this javadocs entry on the subject.</p>
<p><br></p>
<h3>Suggest</h3>
<p>interface:</p>
<p>In general, an interface exposes a contract without exposing the underlying
implementation details. In Object Oriented Programming, interfaces define
abstract types that expose behavior, but contain no logic. Implementation is
defined by the class or type that implements the interface.</p>
<p>@interface : (Annotation type)</p>
<p>Take the below example, which has a lot of comments:</p>
<div class="code"><pre class="code literal-block"><span class="n">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">Generation3List</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="n">Generation2List</span><span class="w"> </span><span class="p">{</span>

<span class="w">   </span><span class="o">//</span><span class="w"> </span><span class="n">Author</span><span class="p">:</span><span class="w"> </span><span class="n">John</span><span class="w"> </span><span class="n">Doe</span>
<span class="w">   </span><span class="o">//</span><span class="w"> </span><span class="n">Date</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="o">/</span><span class="mi">17</span><span class="o">/</span><span class="mi">2002</span>
<span class="w">   </span><span class="o">//</span><span class="w"> </span><span class="n">Current</span><span class="w"> </span><span class="n">revision</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span>
<span class="w">   </span><span class="o">//</span><span class="w"> </span><span class="n">Last</span><span class="w"> </span><span class="n">modified</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="o">/</span><span class="mi">12</span><span class="o">/</span><span class="mi">2004</span>
<span class="w">   </span><span class="o">//</span><span class="w"> </span><span class="n">By</span><span class="p">:</span><span class="w"> </span><span class="n">Jane</span><span class="w"> </span><span class="n">Doe</span>
<span class="w">   </span><span class="o">//</span><span class="w"> </span><span class="n">Reviewers</span><span class="p">:</span><span class="w"> </span><span class="n">Alice</span><span class="p">,</span><span class="w"> </span><span class="n">Bill</span><span class="p">,</span><span class="w"> </span><span class="n">Cindy</span>

<span class="w">   </span><span class="o">//</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">code</span><span class="w"> </span><span class="n">goes</span><span class="w"> </span><span class="n">here</span>

<span class="p">}</span>
</pre></div>

<p>Instead of this, you can declare an annotation type</p>
<div class="code"><pre class="code literal-block"><span class="w"> </span><span class="nv">@interface</span><span class="w"> </span><span class="n">ClassPreamble</span><span class="w"> </span><span class="err">{</span>
<span class="w">   </span><span class="n">String</span><span class="w"> </span><span class="n">author</span><span class="p">();</span>
<span class="w">   </span><span class="n">String</span><span class="w"> </span><span class="nc">date</span><span class="p">();</span>
<span class="w">   </span><span class="nc">int</span><span class="w"> </span><span class="n">currentRevision</span><span class="p">()</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">   </span><span class="n">String</span><span class="w"> </span><span class="n">lastModified</span><span class="p">()</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="ss">"N/A"</span><span class="p">;</span>
<span class="w">   </span><span class="n">String</span><span class="w"> </span><span class="n">lastModifiedBy</span><span class="p">()</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="ss">"N/A"</span><span class="p">;</span>
<span class="w">   </span><span class="o">//</span><span class="w"> </span><span class="n">Note</span><span class="w"> </span><span class="k">use</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">array</span>
<span class="w">   </span><span class="n">String</span><span class="err">[]</span><span class="w"> </span><span class="n">reviewers</span><span class="p">();</span>
<span class="err">}</span>
</pre></div>

<p>which can then annotate a class as follows:</p>
<div class="code"><pre class="code literal-block"><span class="err">@</span><span class="n">ClassPreamble</span><span class="w"> </span><span class="p">(</span>
<span class="w">   </span><span class="n">author</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"John Doe"</span><span class="p">,</span>
<span class="w">   </span><span class="n">date</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"3/17/2002"</span><span class="p">,</span>
<span class="w">   </span><span class="n">currentRevision</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span>
<span class="w">   </span><span class="n">lastModified</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"4/12/2004"</span><span class="p">,</span>
<span class="w">   </span><span class="n">lastModifiedBy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Jane Doe"</span><span class="p">,</span>
<span class="w">   </span><span class="o">//</span><span class="w"> </span><span class="n">Note</span><span class="w"> </span><span class="n">array</span><span class="w"> </span><span class="n">notation</span>
<span class="w">   </span><span class="n">reviewers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="s2">"Alice"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Bob"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Cindy"</span><span class="p">}</span>
<span class="p">)</span>
<span class="n">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">Generation3List</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="n">Generation2List</span><span class="w"> </span><span class="p">{</span>

<span class="o">//</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">code</span><span class="w"> </span><span class="n">goes</span><span class="w"> </span><span class="n">here</span>

<span class="p">}</span>
</pre></div>

<p>PS: <strong>Many annotations replace comments in code.</strong></p>
<p>Reference:
http://docs.oracle.com/javase/tutorial/java/annotations/declaring.html</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/send-email-using-the-gmail-smtp-server-from-a-php-page/" class="u-url">Send email using the GMail SMTP server from a PHP page</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/send-email-using-the-gmail-smtp-server-from-a-php-page/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T21:28:02+08:00" itemprop="datePublished" title="2023-03-03 21:28">2023-03-03 21:28</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I am trying to send an email via GMail's SMTP server from a PHP page, but I
get this error:</p>
<blockquote>
<p>authentication failure [SMTP: SMTP server does no support authentication
(code: 250, response: mx.google.com at your service, [98.117.99.235] SIZE
35651584 8BITMIME STARTTLS ENHANCEDSTATUSCODES PIPELINING)]</p>
</blockquote>
<p>Can anyone help? Here is my code:</p>
<div class="code"><pre class="code literal-block"><span class="cp">&lt;?php</span>
<span class="k">require_once</span> <span class="s2">"Mail.php"</span><span class="p">;</span>

<span class="nv">$from</span> <span class="o">=</span> <span class="s2">"Sandra Sender &lt;sender@example.com&gt;"</span><span class="p">;</span>
<span class="nv">$to</span> <span class="o">=</span> <span class="s2">"Ramona Recipient &lt;ramona@microsoft.com&gt;"</span><span class="p">;</span>
<span class="nv">$subject</span> <span class="o">=</span> <span class="s2">"Hi!"</span><span class="p">;</span>
<span class="nv">$body</span> <span class="o">=</span> <span class="s2">"Hi,</span><span class="se">\n\n</span><span class="s2">How are you?"</span><span class="p">;</span>

<span class="nv">$host</span> <span class="o">=</span> <span class="s2">"smtp.gmail.com"</span><span class="p">;</span>
<span class="nv">$port</span> <span class="o">=</span> <span class="s2">"587"</span><span class="p">;</span>
<span class="nv">$username</span> <span class="o">=</span> <span class="s2">"testtest@gmail.com"</span><span class="p">;</span>
<span class="nv">$password</span> <span class="o">=</span> <span class="s2">"testtest"</span><span class="p">;</span>

<span class="nv">$headers</span> <span class="o">=</span> <span class="k">array</span> <span class="p">(</span><span class="s1">'From'</span> <span class="o">=&gt;</span> <span class="nv">$from</span><span class="p">,</span>
  <span class="s1">'To'</span> <span class="o">=&gt;</span> <span class="nv">$to</span><span class="p">,</span>
  <span class="s1">'Subject'</span> <span class="o">=&gt;</span> <span class="nv">$subject</span><span class="p">);</span>
<span class="nv">$smtp</span> <span class="o">=</span> <span class="nx">Mail</span><span class="o">::</span><span class="na">factory</span><span class="p">(</span><span class="s1">'smtp'</span><span class="p">,</span>
  <span class="k">array</span> <span class="p">(</span><span class="s1">'host'</span> <span class="o">=&gt;</span> <span class="nv">$host</span><span class="p">,</span>
    <span class="s1">'port'</span> <span class="o">=&gt;</span> <span class="nv">$port</span><span class="p">,</span>
    <span class="s1">'auth'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
    <span class="s1">'username'</span> <span class="o">=&gt;</span> <span class="nv">$username</span><span class="p">,</span>
    <span class="s1">'password'</span> <span class="o">=&gt;</span> <span class="nv">$password</span><span class="p">));</span>

<span class="nv">$mail</span> <span class="o">=</span> <span class="nv">$smtp</span><span class="o">-&gt;</span><span class="na">send</span><span class="p">(</span><span class="nv">$to</span><span class="p">,</span> <span class="nv">$headers</span><span class="p">,</span> <span class="nv">$body</span><span class="p">);</span>

<span class="k">if</span> <span class="p">(</span><span class="nx">PEAR</span><span class="o">::</span><span class="na">isError</span><span class="p">(</span><span class="nv">$mail</span><span class="p">))</span> <span class="p">{</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">"&lt;p&gt;"</span> <span class="o">.</span> <span class="nv">$mail</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">()</span> <span class="o">.</span> <span class="s2">"&lt;/p&gt;"</span><span class="p">);</span>
 <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="k">echo</span><span class="p">(</span><span class="s2">"&lt;p&gt;Message successfully sent!&lt;/p&gt;"</span><span class="p">);</span>
 <span class="p">}</span>
<span class="cp">?&gt;</span>
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<div class="code"><pre class="code literal-block">//<span class="w"> </span>Pear<span class="w"> </span>Mail<span class="w"> </span>Library
require_once<span class="w"> </span>"Mail.php";

$from<span class="w"> </span>=<span class="w"> </span>'<span class="nt">&lt;fromaddress</span><span class="err">@gmail.com</span><span class="nt">&gt;</span>';
$to<span class="w"> </span>=<span class="w"> </span>'<span class="nt">&lt;toaddress</span><span class="err">@yahoo.com</span><span class="nt">&gt;</span>';
$subject<span class="w"> </span>=<span class="w"> </span>'Hi!';
$body<span class="w"> </span>=<span class="w"> </span>"Hi,\n\nHow<span class="w"> </span>are<span class="w"> </span>you?";

$headers<span class="w"> </span>=<span class="w"> </span>array(
<span class="w">    </span>'From'<span class="w"> </span>=&gt;<span class="w"> </span>$from,
<span class="w">    </span>'To'<span class="w"> </span>=&gt;<span class="w"> </span>$to,
<span class="w">    </span>'Subject'<span class="w"> </span>=&gt;<span class="w"> </span>$subject
);

$smtp<span class="w"> </span>=<span class="w"> </span>Mail::factory('smtp',<span class="w"> </span>array(
<span class="w">        </span>'host'<span class="w"> </span>=&gt;<span class="w"> </span>'ssl://smtp.gmail.com',
<span class="w">        </span>'port'<span class="w"> </span>=&gt;<span class="w"> </span>'465',
<span class="w">        </span>'auth'<span class="w"> </span>=&gt;<span class="w"> </span>true,
<span class="w">        </span>'username'<span class="w"> </span>=&gt;<span class="w"> </span>'johndoe@gmail.com',
<span class="w">        </span>'password'<span class="w"> </span>=&gt;<span class="w"> </span>'passwordxxx'
<span class="w">    </span>));

$mail<span class="w"> </span>=<span class="w"> </span>$smtp-&gt;send($to,<span class="w"> </span>$headers,<span class="w"> </span>$body);

if<span class="w"> </span>(PEAR::isError($mail))<span class="w"> </span>{
<span class="w">    </span>echo('<span class="nt">&lt;p&gt;</span>'<span class="w"> </span>.<span class="w"> </span>$mail-&gt;getMessage()<span class="w"> </span>.<span class="w"> </span>'<span class="nt">&lt;/p&gt;</span>');
}<span class="w"> </span>else<span class="w"> </span>{
<span class="w">    </span>echo('<span class="nt">&lt;p&gt;</span>Message<span class="w"> </span>successfully<span class="w"> </span>sent!<span class="nt">&lt;/p&gt;</span>');
}
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>Using <strong>Swift mailer</strong> , it is quite easy to send a mail through Gmail
credentials:</p>
<div class="code"><pre class="code literal-block"><span class="cp">&lt;?php</span>
<span class="k">require_once</span> <span class="s1">'swift/lib/swift_required.php'</span><span class="p">;</span>

<span class="nv">$transport</span> <span class="o">=</span> <span class="nx">Swift_SmtpTransport</span><span class="o">::</span><span class="na">newInstance</span><span class="p">(</span><span class="s1">'smtp.gmail.com'</span><span class="p">,</span> <span class="mi">465</span><span class="p">,</span> <span class="s2">"ssl"</span><span class="p">)</span>
  <span class="o">-&gt;</span><span class="na">setUsername</span><span class="p">(</span><span class="s1">'GMAIL_USERNAME'</span><span class="p">)</span>
  <span class="o">-&gt;</span><span class="na">setPassword</span><span class="p">(</span><span class="s1">'GMAIL_PASSWORD'</span><span class="p">);</span>

<span class="nv">$mailer</span> <span class="o">=</span> <span class="nx">Swift_Mailer</span><span class="o">::</span><span class="na">newInstance</span><span class="p">(</span><span class="nv">$transport</span><span class="p">);</span>

<span class="nv">$message</span> <span class="o">=</span> <span class="nx">Swift_Message</span><span class="o">::</span><span class="na">newInstance</span><span class="p">(</span><span class="s1">'Test Subject'</span><span class="p">)</span>
  <span class="o">-&gt;</span><span class="na">setFrom</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">'abc@example.com'</span> <span class="o">=&gt;</span> <span class="s1">'ABC'</span><span class="p">))</span>
  <span class="o">-&gt;</span><span class="na">setTo</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">'xyz@test.com'</span><span class="p">))</span>
  <span class="o">-&gt;</span><span class="na">setBody</span><span class="p">(</span><span class="s1">'This is a test mail.'</span><span class="p">);</span>

<span class="nv">$result</span> <span class="o">=</span> <span class="nv">$mailer</span><span class="o">-&gt;</span><span class="na">send</span><span class="p">(</span><span class="nv">$message</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre></div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-2189.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-2187.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
