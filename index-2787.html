<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 2787) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-2787.html">
<link rel="prev" href="index-2788.html" type="text/html">
<link rel="next" href="index-2786.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/what-s-the-use-of-ob-start-in-php/" class="u-url">What's the use of ob_start() in php?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/what-s-the-use-of-ob-start-in-php/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-05T17:55:04+08:00" itemprop="datePublished" title="2023-03-05 17:55">2023-03-05 17:55</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Is <code>ob_start()</code> used for <code>output buffering</code> so that the headers are buffered
and not sent to the browser? Am I making sense here? If not then why should we
use <code>ob_start()</code>?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Think of <code>ob_start()</code> as saying "Start remembering everything that would
normally be outputted, but don't quite do anything with it yet."</p>
<p>For example:</p>
<div class="code"><pre class="code literal-block">ob_start();
echo("Hello there!"); //would normally get printed to the screen/output to browser
$output = ob_get_contents();
ob_end_clean();
</pre></div>

<p>There are two other functions you typically pair it with: <code>ob_get_contents()</code>,
which basically gives you whatever has been "saved" to the buffer since it was
turned on with <code>ob_start()</code>, and then <code>ob_end_clean()</code> or <code>ob_flush()</code>, which
either stops saving things and discards whatever was saved, or stops saving
and outputs it all at once, respectively.</p>
<p><br></p>
<h3>Suggest</h3>
<p>I use this so I can break out of PHP with a lot of HTML but not render it. It
saves me from storing it as a string which disables IDE color-coding.</p>
<div class="code"><pre class="code literal-block"><span class="cp">&lt;?php</span>
<span class="nb">ob_start</span><span class="p">();</span>
<span class="cp">?&gt;</span>
<span class="nt">&lt;div&gt;</span>
<span class="w">    </span><span class="nt">&lt;span&gt;</span>text<span class="nt">&lt;/span&gt;</span>
<span class="w">    </span><span class="nt">&lt;a</span><span class="w"> </span><span class="na">href=</span><span class="s">"#"</span><span class="nt">&gt;</span>link<span class="nt">&lt;/a&gt;</span>
<span class="nt">&lt;/div&gt;</span>
<span class="cp">&lt;?php</span>
<span class="nv">$content</span> <span class="o">=</span> <span class="nb">ob_get_clean</span><span class="p">();</span>
<span class="cp">?&gt;</span>
</pre></div>

<p>Instead of:</p>
<div class="code"><pre class="code literal-block"><span class="cp">&lt;?php</span>
<span class="nv">$content</span> <span class="o">=</span> <span class="s1">'&lt;div&gt;</span>
<span class="s1">    &lt;span&gt;text&lt;/span&gt;</span>
<span class="s1">    &lt;a href="#"&gt;link&lt;/a&gt;</span>
<span class="s1">&lt;/div&gt;'</span><span class="p">;</span>
<span class="cp">?&gt;</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-convert-file-to-base64-in-javascript/" class="u-url">How to convert file to base64 in JavaScript?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-convert-file-to-base64-in-javascript/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-05T17:53:42+08:00" itemprop="datePublished" title="2023-03-05 17:53">2023-03-05 17:53</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p><strong>UPD</strong> TypeScript version is also available in answers</p>
<p>Now I'm getting File object by this line:</p>
<div class="code"><pre class="code literal-block">file = document.querySelector('#files &gt; input[type="file"]').files[0]
</pre></div>

<p>I need to send this file via json in base 64. What should I do to convert it
to base64 string?</p>
<p><br><br></p>
<h2>Answer</h2>
<p><strong>Modern ES6 way</strong> (async/await)</p>
<div class="code"><pre class="code literal-block"><span class="k">const</span><span class="w"> </span><span class="n">toBase64</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">Promise</span><span class="p">((</span><span class="n">resolve</span><span class="p">,</span><span class="w"> </span><span class="n">reject</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">reader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">FileReader</span><span class="p">();</span>
<span class="w">    </span><span class="n">reader</span><span class="o">.</span><span class="n">readAsDataURL</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
<span class="w">    </span><span class="n">reader</span><span class="o">.</span><span class="n">onload</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">resolve</span><span class="p">(</span><span class="n">reader</span><span class="o">.</span><span class="n">result</span><span class="p">);</span>
<span class="w">    </span><span class="n">reader</span><span class="o">.</span><span class="n">onerror</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">reject</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>
<span class="p">});</span>

<span class="n">async</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">Main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="k">const</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">document</span><span class="o">.</span><span class="n">querySelector</span><span class="p">(</span><span class="s1">'#myfile'</span><span class="p">)</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="w">   </span><span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">await</span><span class="w"> </span><span class="n">toBase64</span><span class="p">(</span><span class="n">file</span><span class="p">));</span>
<span class="p">}</span>

<span class="n">Main</span><span class="p">();</span>
</pre></div>

<p>UPD:</p>
<p>If you want to catch errors</p>
<div class="code"><pre class="code literal-block"><span class="n">async</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">Main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="k">const</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">document</span><span class="o">.</span><span class="n">querySelector</span><span class="p">(</span><span class="s1">'#myfile'</span><span class="p">)</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="w">   </span><span class="n">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">const</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">await</span><span class="w"> </span><span class="n">toBase64</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">result</span>
<span class="w">   </span><span class="p">}</span><span class="w"> </span><span class="n">catch</span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">console</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>
<span class="w">      </span><span class="k">return</span><span class="p">;</span>
<span class="w">   </span><span class="p">}</span>
<span class="w">   </span><span class="o">//...</span>
<span class="p">}</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p><strong>Modern ES6 way</strong> (async/await)</p>
<div class="code"><pre class="code literal-block"><span class="k">const</span><span class="w"> </span><span class="n">toBase64</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">Promise</span><span class="p">((</span><span class="n">resolve</span><span class="p">,</span><span class="w"> </span><span class="n">reject</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">reader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">FileReader</span><span class="p">();</span>
<span class="w">    </span><span class="n">reader</span><span class="o">.</span><span class="n">readAsDataURL</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
<span class="w">    </span><span class="n">reader</span><span class="o">.</span><span class="n">onload</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">resolve</span><span class="p">(</span><span class="n">reader</span><span class="o">.</span><span class="n">result</span><span class="p">);</span>
<span class="w">    </span><span class="n">reader</span><span class="o">.</span><span class="n">onerror</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">reject</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>
<span class="p">});</span>

<span class="n">async</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">Main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="k">const</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">document</span><span class="o">.</span><span class="n">querySelector</span><span class="p">(</span><span class="s1">'#myfile'</span><span class="p">)</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="w">   </span><span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">await</span><span class="w"> </span><span class="n">toBase64</span><span class="p">(</span><span class="n">file</span><span class="p">));</span>
<span class="p">}</span>

<span class="n">Main</span><span class="p">();</span>
</pre></div>

<p>UPD:</p>
<p>If you want to catch errors</p>
<div class="code"><pre class="code literal-block"><span class="n">async</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">Main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="k">const</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">document</span><span class="o">.</span><span class="n">querySelector</span><span class="p">(</span><span class="s1">'#myfile'</span><span class="p">)</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="w">   </span><span class="n">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">const</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">await</span><span class="w"> </span><span class="n">toBase64</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">result</span>
<span class="w">   </span><span class="p">}</span><span class="w"> </span><span class="n">catch</span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">console</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>
<span class="w">      </span><span class="k">return</span><span class="p">;</span>
<span class="w">   </span><span class="p">}</span>
<span class="w">   </span><span class="o">//...</span>
<span class="p">}</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/emulating-aspect-fit-behaviour-using-autolayout-constraints-in-xcode-6/" class="u-url">Emulating aspect-fit behaviour using AutoLayout constraints in Xcode 6</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/emulating-aspect-fit-behaviour-using-autolayout-constraints-in-xcode-6/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-05T17:52:15+08:00" itemprop="datePublished" title="2023-03-05 17:52">2023-03-05 17:52</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I want to use AutoLayout to size and layout a view in a manner that is
reminiscent of UIImageView's aspect-fit content mode.</p>
<p>I have a subview inside a container view in Interface Builder. The subview has
some inherent aspect ratio which I wish to respect. The container view's size
is unknown until runtime.</p>
<p>If the container view's aspect ratio is wider than the subview, then I want
the subview's height to equal the parent view's height.</p>
<p>If the container view's aspect ratio is taller than the subview, then I want
the subview's width to equal the parent view's width.</p>
<p>In either case I wish the subview to be centered horizontally and vertically
within the container view.</p>
<p>Is there a way to achieve this using AutoLayout constraints in Xcode 6 or in
previous version? Ideally using Interface Builder, but if not perhaps it is
possible to define such constraints programmatically.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>You're not describing scale-to-fit; you're describing aspect-fit. (I have
edited your question in this regard.) The subview becomes as large as possible
while maintaining its aspect ratio and fitting entirely inside its parent.</p>
<p>Anyway, you can do this with auto layout. You can do it entirely in IB as of
Xcode 5.1. Let's start with some views:</p>
<p><img alt="some views" src="images/hHDxR.png"></p>
<p>The light green view has an aspect ratio of 4:1. The dark green view has an
aspect ratio of 1:4. I'm going to set up constraints so that the blue view
fills the top half of the screen, the pink view fills the bottom half of the
screen, and each green view expands as much as possible while maintaining its
aspect ratio and fitting in its container.</p>
<p>First, I'll create constraints on all four sides of the blue view. I'll pin it
to its nearest neighbor on each edge, with a distance of 0. I make sure to
turn off margins:</p>
<p><img alt="blue constraints" src="images/Yo2JF.gif"></p>
<p>Note that I <strong>don't</strong> update the frame yet. I find it easier to leave room
between the views when setting up constraints, and just set the constants to 0
(or whatever) by hand.</p>
<p>Next, I pin the left, bottom, and right edges of the pink view to its nearest
neighbor. I don't need to set up a top edge constraint because its top edge is
already constrained to the bottom edge of the blue view.</p>
<p><img alt="pink constraints" src="images/SPiNs.gif"></p>
<p>I also need an equal-heights constraint between the pink and blue views. This
will make them each fill half the screen:</p>
<p><img alt="enter image description here" src="images/oelrv.gif"></p>
<p>If I tell Xcode to update all the frames now, I get this:</p>
<p><img alt="containers laid out" src="images/9fbwL.png"></p>
<p>So the constraints I've set up so far are correct. I undo that and start work
on the light green view.</p>
<p>Aspect-fitting the light green view requires five constraints:</p>
<ul>
<li>A required-priority aspect ratio constraint on the light green view. You can create this constraint in a xib or storyboard with Xcode 5.1 or later.</li>
<li>A required-priority constraint limiting the width of the light green view to be less than or equal to the width of its container.</li>
<li>A high-priority constraint setting the width of the light green view to be equal to the width of its container.</li>
<li>A required-priority constraint limiting the height of the light green view to be less than or equal to the height of its container.</li>
<li>A high-priority constraint setting the height of the light green view to be equal to the height of its container.</li>
</ul>
<p>Let's consider the two width constraints. The less-than-or-equal constraint,
by itself, is not sufficient to determine the width of the light green view;
many widths will fit the constraint. Since there's ambiguity, autolayout will
try to choose a solution that minimizes the error in the other (high-priority
but not required) constraint. Minimizing the error means making the width as
close as possible to the container's width, while not violating the required
less-than-or-equal constraint.</p>
<p>The same thing happens with the height constraint. And since the aspect-ratio
constraint is also required, it can only maximize the size of the subview
along one axis (unless the container happens to have the same aspect ratio as
the subview).</p>
<p>So first I create the aspect ratio constraint:</p>
<p><img alt="top aspect" src="images/4IhOw.gif"></p>
<p>Then I create equal width and height constraints with the container:</p>
<p><img alt="top equal size" src="images/vycag.gif"></p>
<p>I need to edit these constraints to be less-than-or-equal constraints:</p>
<p><img alt="top less than or equal size" src="images/BC7rh.gif"></p>
<p>Next I need to create another set of equal width and height constraints with
the container:</p>
<p><img alt="top equal size again" src="images/U9HkM.gif"></p>
<p>And I need to make these new constraints less than required priority:</p>
<p><img alt="top equal not required" src="images/I7DTE.gif"></p>
<p>Finally, you asked for the subview to be centered in its container, so I'll
set up those constraints:</p>
<p><img alt="top centered" src="images/4DTr1.gif"></p>
<p>Now, to test, I'll select the view controller and ask Xcode to update all the
frames. This is what I get:</p>
<p><img alt="incorrect top layout" src="images/KmtoY.png"></p>
<p>Oops! The subview has expanded to completely fill its container. If I select
it, I can see that in fact it's maintained its aspect ratio, but it's doing an
aspect- <strong>fill</strong> instead of an aspect- <strong>fit</strong>.</p>
<p>The problem is that on a less-than-or-equal constraint, it matters which view
is at each end of the constraint, and Xcode has set up the constraint opposite
from my expectation. I could select each of the two constraints and reverse
its first and second items. Instead, I'll just select the subview and change
the constraints to be greater-than-or-equal:</p>
<p><img alt="fix top constraints" src="images/Mh4XM.gif"></p>
<p>Xcode updates the layout:</p>
<p><img alt="correct top layout" src="images/sRvqg.png"></p>
<p>Now I do all the same things to the dark green view on the bottom. I need to
make sure its aspect ratio is 1:4 (Xcode resized it in a weird way since it
didn't have constraints). I won't show the steps again since they're the same.
Here's the result:</p>
<p><img alt="correct top and bottom layout" src="images/kDj1r.png"></p>
<p>Now I can run it in the iPhone 4S simulator, which has a different screen size
than IB used, and test rotation:</p>
<p><img alt="iphone 4s test" src="images/HpA6w.gif"></p>
<p>And I can test in in the iPhone 6 simulator:</p>
<p><img alt="iphone 6 test" src="images/OtBQ9.gif"></p>
<p>I've uploaded my final storyboard to this gist for your convenience.</p>
<p><br></p>
<h3>Suggest</h3>
<p>Rob, your answer is awesome! I also know that this question is specifically
about achieving this by using auto-layout. However, just as a reference, I'd
like to show how this can be done in code. You set up the top and bottom views
(blue and pink) just like Rob showed. Then you create a custom
<code>AspectFitView</code>:</p>
<p><strong>AspectFitView.h</strong> :</p>
<div class="code"><pre class="code literal-block"><span class="cp">#import &lt;UIKit/UIKit.h&gt;</span>

<span class="k">@interface</span> <span class="nc">AspectFitView</span> : <span class="bp">UIView</span>

<span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">nonatomic</span><span class="p">,</span><span class="w"> </span><span class="k">strong</span><span class="p">)</span><span class="w"> </span><span class="bp">UIView</span><span class="w"> </span><span class="o">*</span><span class="n">childView</span><span class="p">;</span>

<span class="k">@end</span>
</pre></div>

<p><strong>AspectFitView.m</strong> :</p>
<div class="code"><pre class="code literal-block"><span class="cp">#import "AspectFitView.h"</span>

<span class="k">@implementation</span> <span class="nc">AspectFitView</span>

<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">setChildView:</span><span class="p">(</span><span class="bp">UIView</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nv">childView</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">_childView</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">[</span><span class="n">_childView</span><span class="w"> </span><span class="n">removeFromSuperview</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">_childView</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">childView</span><span class="p">;</span>

<span class="w">    </span><span class="p">[</span><span class="nb">self</span><span class="w"> </span><span class="n">addSubview</span><span class="o">:</span><span class="n">childView</span><span class="p">];</span>
<span class="w">    </span><span class="p">[</span><span class="nb">self</span><span class="w"> </span><span class="n">setNeedsLayout</span><span class="p">];</span>
<span class="p">}</span>

<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">layoutSubviews</span>
<span class="p">{</span>
<span class="w">    </span><span class="p">[</span><span class="nb">super</span><span class="w"> </span><span class="n">layoutSubviews</span><span class="p">];</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">_childView</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">CGSize</span><span class="w"> </span><span class="n">childSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_childView</span><span class="p">.</span><span class="n">frame</span><span class="p">.</span><span class="n">size</span><span class="p">;</span>
<span class="w">        </span><span class="n">CGSize</span><span class="w"> </span><span class="n">parentSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">self</span><span class="p">.</span><span class="n">frame</span><span class="p">.</span><span class="n">size</span><span class="p">;</span>
<span class="w">        </span><span class="n">CGFloat</span><span class="w"> </span><span class="n">aspectRatioForHeight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">childSize</span><span class="p">.</span><span class="n">width</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">childSize</span><span class="p">.</span><span class="n">height</span><span class="p">;</span>
<span class="w">        </span><span class="n">CGFloat</span><span class="w"> </span><span class="n">aspectRatioForWidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">childSize</span><span class="p">.</span><span class="n">height</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">childSize</span><span class="p">.</span><span class="n">width</span><span class="p">;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">parentSize</span><span class="p">.</span><span class="n">height</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">aspectRatioForHeight</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">parentSize</span><span class="p">.</span><span class="n">height</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// whole height, adjust width</span>
<span class="w">            </span><span class="n">CGFloat</span><span class="w"> </span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parentSize</span><span class="p">.</span><span class="n">width</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">aspectRatioForWidth</span><span class="p">;</span>
<span class="w">            </span><span class="n">_childView</span><span class="p">.</span><span class="n">frame</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CGRectMake</span><span class="p">((</span><span class="n">parentSize</span><span class="p">.</span><span class="n">width</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">width</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="p">,</span><span class="w"> </span><span class="n">parentSize</span><span class="p">.</span><span class="n">height</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// whole width, adjust height</span>
<span class="w">            </span><span class="n">CGFloat</span><span class="w"> </span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parentSize</span><span class="p">.</span><span class="n">height</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">aspectRatioForHeight</span><span class="p">;</span>
<span class="w">            </span><span class="n">_childView</span><span class="p">.</span><span class="n">frame</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CGRectMake</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">parentSize</span><span class="p">.</span><span class="n">height</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">height</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="n">parentSize</span><span class="p">.</span><span class="n">width</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">@end</span>
</pre></div>

<p>Next, you change the class of the blue and pink views in the storyboard to be
<code>AspectFitView</code>s. Finally you set two outlets to your viewcontroller
<code>topAspectFitView</code> and <code>bottomAspectFitView</code> and set their <code>childView</code>s in
<code>viewDidLoad</code>:</p>
<div class="code"><pre class="code literal-block"><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">viewDidLoad</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="p">[</span><span class="nb">super</span><span class="w"> </span><span class="n">viewDidLoad</span><span class="p">];</span>

<span class="w">    </span><span class="bp">UIView</span><span class="w"> </span><span class="o">*</span><span class="n">top</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="bp">UIView</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">initWithFrame</span><span class="o">:</span><span class="n">CGRectMake</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">500</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">)];</span>
<span class="w">    </span><span class="n">top</span><span class="p">.</span><span class="n">backgroundColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="bp">UIColor</span><span class="w"> </span><span class="n">lightGrayColor</span><span class="p">];</span>

<span class="w">    </span><span class="bp">UIView</span><span class="w"> </span><span class="o">*</span><span class="n">bottom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="bp">UIView</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">initWithFrame</span><span class="o">:</span><span class="n">CGRectMake</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">500</span><span class="p">)];</span>
<span class="w">    </span><span class="n">bottom</span><span class="p">.</span><span class="n">backgroundColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="bp">UIColor</span><span class="w"> </span><span class="n">greenColor</span><span class="p">];</span>

<span class="w">    </span><span class="n">_topAspectFitView</span><span class="p">.</span><span class="n">childView</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">top</span><span class="p">;</span>
<span class="w">    </span><span class="n">_bottomAspectFitView</span><span class="p">.</span><span class="n">childView</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bottom</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<p>So it's not hard to do this in code and it is still very adaptable and works
with variably-sized views and different aspect ratios.</p>
<p><strong>Update July 2015</strong> : Find a demo app here:
https://github.com/jfahrenkrug/SPWKAspectFitView</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-2788.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-2786.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
