<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 2259) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-2259.html">
<link rel="prev" href="index-2260.html" type="text/html">
<link rel="next" href="index-2258.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/timeout-expired-the-timeout-period-elapsed-prior-to-completion-of-the-operation-or-the-server-is-not-responding-the-statement-has-been-terminated/" class="u-url">Timeout expired. The timeout period elapsed prior to completion of the operation or the server is not responding. The statement has been terminated</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/timeout-expired-the-timeout-period-elapsed-prior-to-completion-of-the-operation-or-the-server-is-not-responding-the-statement-has-been-terminated/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T02:53:55+08:00" itemprop="datePublished" title="2023-03-04 02:53">2023-03-04 02:53</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I have many users on my web site (20000-60000 per day), which is a download
site for mobile files. I have remote access to my server (windows server
2008-R2).<br>
I've received <em>"Server is unavailable"</em> errors before, but I am now seeing a
connection timeout error.<br>
I'm not familiar with this - why does it occur and how can I fix it?</p>
<p>The full error is below:</p>
<blockquote>
<p>Server Error in '/' Application. Timeout expired. The timeout period elapsed
prior to completion of the operation or the server is not responding. The
statement has been terminated. Description: An unhandled exception occurred
during the execution of the current web request. Please review the stack
trace for more information about the error and where it originated in the
code.</p>
<p>Exception Details: System.Data.SqlClient.SqlException: Timeout expired. The
timeout period elapsed prior to completion of the operation or the server is
not responding. The statement has been terminated.</p>
<p>Source Error:</p>
<p>An unhandled exception was generated during the execution of the current web
request. Information regarding the origin and location of the exception can
be identified using the exception stack trace below.</p>
<p>Stack Trace:</p>
<p>[SqlException (0x80131904): Timeout expired. The timeout period elapsed
prior to completion of the operation or the server is not responding. The
statement has been terminated.]<br>
 System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean
breakConnection) +404<br>
 System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning() +412<br>
 System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand
cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet
bulkCopyHandler, TdsParserStateObject stateObj) +1363<br>
 System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds,
RunBehavior runBehavior, String resetOptionsString) +6387741<br>
 System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior
cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async)
+6389442<br>
 System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior
cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method,
DbAsyncResult result) +538<br>
 System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(DbAsyncResult
result, String methodName, Boolean sendToPipe) +689<br>
 System.Data.SqlClient.SqlCommand.ExecuteNonQuery() +327<br>
 NovinMedia.Data.DbObject.RunProcedure(String storedProcName,
IDataParameter[] parameters, Int32&amp; rowsAffected) +209<br>
 DataLayer.OnlineUsers.Update_SessionEnd_And_Online(Object Session_End,
Boolean Online) +440<br>
 NiceFileExplorer.Global.Application_Start(Object sender, EventArgs e) +163</p>
<p>[HttpException (0x80004005): Timeout expired. The timeout period elapsed
prior to completion of the operation or the server is not responding. The
statement has been terminated.]  </p>
<p>System.Web.HttpApplicationFactory.EnsureAppStartCalledForIntegratedMode(HttpContext
context, HttpApplication app) +4052053<br>
 System.Web.HttpApplication.RegisterEventSubscriptionsWithIIS(IntPtr
appContext, HttpContext context, MethodInfo[] handlers) +191<br>
 System.Web.HttpApplication.InitSpecial(HttpApplicationState state,
MethodInfo[] handlers, IntPtr appContext, HttpContext context) +352<br>
 System.Web.HttpApplicationFactory.GetSpecialApplicationInstance(IntPtr
appContext, HttpContext context) +407<br>
 System.Web.Hosting.PipelineRuntime.InitializeApplication(IntPtr appContext)
+375</p>
<p>[HttpException (0x80004005): Timeout expired. The timeout period elapsed
prior to completion of the operation or the server is not responding. The
statement has been terminated.]<br>
 System.Web.HttpRuntime.FirstRequestInit(HttpContext context) +11686928
System.Web.HttpRuntime.EnsureFirstRequestInit(HttpContext context) +141
System.Web.HttpRuntime.ProcessRequestNotificationPrivate(IIS7WorkerRequest
wr, HttpContext context) +4863749</p>
</blockquote>
<hr>
<p><strong>EDIT AFTER ANSWERS:</strong><br>
my <code>Application_Start</code> in <code>Global.asax</code> is like below:</p>
<div class="code"><pre class="code literal-block">protected void Application_Start(object sender, EventArgs e)
{
    Application["OnlineUsers"] = 0;

    OnlineUsers.Update_SessionEnd_And_Online(
        DateTime.Now,
        false);

    AddTask("DoStuff", 10);
}
</pre></div>

<p>The stored procedure being called is:</p>
<div class="code"><pre class="code literal-block"><span class="k">ALTER</span><span class="w"> </span><span class="k">Procedure</span><span class="w"> </span><span class="o">[</span><span class="n">dbo</span><span class="o">]</span><span class="p">.</span><span class="o">[</span><span class="n">sp_OnlineUsers_Update_SessionEnd_And_Online</span><span class="o">]</span>
<span class="w">    </span><span class="nv">@Session_End</span><span class="w"> </span><span class="nc">datetime</span><span class="p">,</span>
<span class="w">    </span><span class="nv">@Online</span><span class="w"> </span><span class="nc">bit</span>
<span class="k">As</span>
<span class="k">Begin</span>
<span class="w">    </span><span class="k">Update</span><span class="w"> </span><span class="n">OnlineUsers</span>
<span class="w">    </span><span class="k">SET</span>
<span class="w">        </span><span class="o">[</span><span class="n">Session_End</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">@Session_End</span><span class="p">,</span>
<span class="w">        </span><span class="o">[</span><span class="n">Online</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">@Online</span>

<span class="k">End</span>
</pre></div>

<p>I have two methods for getting online users:</p>
<ol>
<li>using <code>Application["OnlineUsers"] = 0;</code>
</li>
<li>the other one using database</li>
</ol>
<p>So, for method #2 I reset all OnlineUsers at <code>Application_Start</code>. There are
over 482,751 records in that table.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Looks like you have a query that is taking longer than it should. From your
stack trace and your code you should be able to determine exactly what query
that is.</p>
<p>This type of timeout can have three causes;</p>
<ol>
<li>There's a deadlock somewhere</li>
<li>The database's statistics and/or query plan cache are incorrect</li>
<li>The query is too complex and needs to be tuned</li>
</ol>
<p>A deadlock can be difficult to fix, but it's easy to determine whether that is
the case. Connect to your database with Sql Server Management Studio. In the
left pane right-click on the server node and select <em>Activity Monitor</em>. Take a
look at the running processes. Normally most will be idle or running. When the
problem occurs you can identify any blocked process by the process state. If
you right-click on the process and select <em>details</em> it'll show you the last
query executed by the process.</p>
<p>The second issue will cause the database to use a sub-optimal query plan. It
can be resolved by clearing the statistics:</p>
<div class="code"><pre class="code literal-block"><span class="k">exec</span><span class="w"> </span><span class="nv">sp_updatestats</span>
</pre></div>

<p>If that doesn't work you could also try</p>
<div class="code"><pre class="code literal-block">dbcc freeproccache
</pre></div>

<p>You should not do this when your server is under heavy load because it will
temporarily incur a big performace hit as all stored procs and queries are
recompiled when first executed. However, since you state the issue occurs
<em>sometimes</em> , and the stack trace indicates your application is starting up, I
think you're running a query that is only run on occasionally. You may be
better off by forcing SQL Server not to reuse a previous query plan. See this
answer for details on how to do that.</p>
<p>I've already touched on the third issue, but you can easily determine whether
the query needs tuning by executing the query manually, for example using Sql
Server Management Studio. If the query takes too long to complete, even after
resetting the statistics you'll probably need to tune it. For help with that,
you should post the exact query in a new question.</p>
<p><br></p>
<h3>Suggest</h3>
<p>In your code where you run the stored procedure you should have something like
this:</p>
<div class="code"><pre class="code literal-block">SqlCommand c = new SqlCommand(...)
//...
</pre></div>

<p>Add such a line of code:</p>
<div class="code"><pre class="code literal-block">c.CommandTimeout = 0;
</pre></div>

<p>This will wait as much time as needed for the operation to complete.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/dyld-library-not-loaded-reason-image-not-found/" class="u-url">dyld: Library not loaded ... Reason: Image not found</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/dyld-library-not-loaded-reason-image-not-found/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T02:52:16+08:00" itemprop="datePublished" title="2023-03-04 02:52">2023-03-04 02:52</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>When trying to run an executable I've been sent in Mac OS X, I get the
following error</p>
<div class="code"><pre class="code literal-block"><span class="n">dyld</span><span class="p">:</span><span class="w"> </span><span class="n">Library</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">loaded</span><span class="p">:</span><span class="w"> </span><span class="n">libboost_atomic</span><span class="o">.</span><span class="n">dylib</span>
<span class="w">  </span><span class="n">Referenced</span><span class="w"> </span><span class="n">from</span><span class="p">:</span><span class="w"> </span><span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="s2">"Directory my executable is in"</span>
<span class="w">  </span><span class="n">Reason</span><span class="p">:</span><span class="w"> </span><span class="n">image</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">found</span>
<span class="n">Trace</span><span class="o">/</span><span class="n">BPT</span><span class="w"> </span><span class="n">trap</span><span class="p">:</span><span class="mi">5</span>
</pre></div>

<p>I have installed the boost libraries and they are located in <code>/opt/local/lib</code>.
I think the problem has something to do with the executable only looking in
the directory it is in as when I paste the 'libboost_atomic.dylib' in there,
it doesn't mind about it anymore. Unfortunately then it complains it can't
find the next boost library.</p>
<p>Is there an easy way to fix this?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Find all the boost libraries (where <code>exefile</code> is the name of your executable):</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span>otool<span class="w"> </span>-L<span class="w"> </span>exefile
exefile:
<span class="w">        </span>@executable_path/libboost_something.dylib<span class="w"> </span><span class="o">(</span>compatibility<span class="w"> </span>version<span class="w"> </span><span class="m">0</span>.7.0,<span class="w"> </span>current<span class="w"> </span>version<span class="w"> </span><span class="m">0</span>.7.0<span class="o">)</span>
<span class="w">        </span>/usr/lib/libc++.1.dylib<span class="w"> </span><span class="o">(</span>compatibility<span class="w"> </span>version<span class="w"> </span><span class="m">1</span>.0.0,<span class="w"> </span>current<span class="w"> </span>version<span class="w"> </span><span class="m">65</span>.1.0<span class="o">)</span>
<span class="w">        </span>/usr/lib/libSystem.B.dylib<span class="w"> </span><span class="o">(</span>compatibility<span class="w"> </span>version<span class="w"> </span><span class="m">1</span>.0.0,<span class="w"> </span>current<span class="w"> </span>version<span class="w"> </span><span class="m">169</span>.3.0<span class="o">)</span>
</pre></div>

<p>and for each <code>libboost_xxx.dylib</code>, do:</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span>install_name_tool<span class="w"> </span>-change<span class="w"> </span>@executable_path/libboost_something.dylib<span class="w"> </span>/opt/local/lib/libboost_something.dylib<span class="w"> </span>exefile
</pre></div>

<p>and finally verify using <code>otool</code> again:</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span>otool<span class="w"> </span>-L<span class="w"> </span>exefile
exefile:
<span class="w">        </span>/opt/local/lib/libboost_something.dylib<span class="w"> </span><span class="o">(</span>compatibility<span class="w"> </span>version<span class="w"> </span><span class="m">0</span>.7.0,<span class="w"> </span>current<span class="w"> </span>version<span class="w"> </span><span class="m">0</span>.7.0<span class="o">)</span>
<span class="w">        </span>/usr/lib/libc++.1.dylib<span class="w"> </span><span class="o">(</span>compatibility<span class="w"> </span>version<span class="w"> </span><span class="m">1</span>.0.0,<span class="w"> </span>current<span class="w"> </span>version<span class="w"> </span><span class="m">65</span>.1.0<span class="o">)</span>
<span class="w">        </span>/usr/lib/libSystem.B.dylib<span class="w"> </span><span class="o">(</span>compatibility<span class="w"> </span>version<span class="w"> </span><span class="m">1</span>.0.0,<span class="w"> </span>current<span class="w"> </span>version<span class="w"> </span><span class="m">169</span>.3.0<span class="o">)</span>
</pre></div>

<p>Manpages: <code>otool</code> <code>install_name_tool</code></p>
<p><strong>EDIT</strong> A while back I wrote a python script (<code>copy_dylibs.py</code>) to work out
all this stuff automatically when building an app. It will package up all
libraries from <code>/usr/local</code> or <code>/opt/local</code> into the app bundle and fix
references to those libraries to use <code>@rpath</code>. This means you can easily
install third-party library using Homebrew and package them just as easily.</p>
<p>I have now made this script public on github.</p>
<p><br></p>
<h3>Suggest</h3>
<p>This worked for me:</p>
<div class="code"><pre class="code literal-block">brew upgrade node
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/update-a-submodule-to-the-latest-commit/" class="u-url">Update a submodule to the latest commit</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/update-a-submodule-to-the-latest-commit/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T02:50:50+08:00" itemprop="datePublished" title="2023-03-04 02:50">2023-03-04 02:50</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I have a project A which is a library and it is used in a project B.</p>
<p>Both projects A and B have a separate repository on github BUT inside B we
have a submodule of A.</p>
<p>I edited some classes on the library, which is in the repo A, I pushed on the
remote repo, so the library (repo A) is updated.</p>
<p>These updates do not reflect on the "reference" (the submodule) the submodule
refers to a previous commit.... what should I do in order to update the
submodule on git?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Enter the submodule directory:</p>
<div class="code"><pre class="code literal-block">cd projB/projA
</pre></div>

<p>Pull the repo from you project A (will <em>not</em> update the git status of your
parent, project B):</p>
<div class="code"><pre class="code literal-block">git pull origin master
</pre></div>

<p>Go back to the root directory &amp; check update:</p>
<div class="code"><pre class="code literal-block">cd ..
git status
</pre></div>

<p>If the submodule updated before, it will show something like below:</p>
<div class="code"><pre class="code literal-block"># Not currently on any branch.
# Changed but not updated:
#   (use "git add ..." to update what will be committed)
#   (use "git checkout -- ..." to discard changes in working directory)
#
#       modified:   projB/projA (new commits)
#
</pre></div>

<p>Then, commit the update:</p>
<div class="code"><pre class="code literal-block">git add projB/projA
git commit -m "projA submodule updated"
</pre></div>

<hr>
<p><strong>UPDATE</strong></p>
<p>As @paul pointed out, since git 1.8, we can use</p>
<div class="code"><pre class="code literal-block">git submodule update --remote --merge
</pre></div>

<p>to update the submodule to the latest remote commit. It'll be convenient in
most cases.</p>
<p><br></p>
<h3>Suggest</h3>
<p>Since git 1.8 you can do</p>
<div class="code"><pre class="code literal-block">git submodule update --remote --merge
</pre></div>

<p>This will update the submodule to the latest remote commit. You will then need
to add and commit the change so the gitlink in the parent repository is
updated:</p>
<p>First, git add it</p>
<div class="code"><pre class="code literal-block">git add project/submodule_proj_name
</pre></div>

<p>then git commit it</p>
<div class="code"><pre class="code literal-block">git commit -m 'gitlink to submodule_proj_name was updated'
</pre></div>

<p>the git push it</p>
<div class="code"><pre class="code literal-block">git push
</pre></div>

<p>And then push the changes as without this, the SHA-1 identity the pointing to
the submodule won't be updated and so the change won't be visible to anyone
else.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-2260.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-2258.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
