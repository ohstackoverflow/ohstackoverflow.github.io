<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 2270) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-2270.html">
<link rel="prev" href="index-2271.html" type="text/html">
<link rel="next" href="index-2269.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/what-is-the-difference-between-tree-depth-and-height/" class="u-url">What is the difference between tree depth and height?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/what-is-the-difference-between-tree-depth-and-height/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T03:44:09+08:00" itemprop="datePublished" title="2023-03-04 03:44">2023-03-04 03:44</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>This is a simple question from algorithms theory.<br>
The difference between them is that in one case you count number of nodes and
in other number of edges on the shortest path between root and concrete node.<br>
Which is which?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>I learned that depth and height are properties of a <em>node</em> :</p>
<ul>
<li>
<p>The <strong>depth</strong> of a node is the number of edges from the node to the tree's root node.<br>
A root node will have a depth of 0.</p>
</li>
<li>
<p>The <strong>height</strong> of a node is the number of edges on the <em>longest path</em> from the node to a leaf.<br>
A leaf node will have a height of 0.</p>
</li>
</ul>
<p>Properties of a <em>tree</em> :</p>
<ul>
<li>
<p>The <strong>height</strong> of a tree would be the height of its root node,<br>
or equivalently, the depth of its deepest node.</p>
</li>
<li>
<p>The <strong>diameter</strong> (or <strong>width</strong> ) of a tree is the number of <em>nodes</em> on the longest path between any two leaf nodes. The tree below has a diameter of 6 nodes.</p>
</li>
</ul>
<p><img alt="A tree, with height and depth of each node" src="images/8yPi9.png"></p>
<p><br></p>
<h3>Suggest</h3>
<p>height and depth of a tree is equal...</p>
<p>but height and depth of a node is not equal because...</p>
<p>the height is calculated by traversing from the given node to the deepest
possible leaf.</p>
<p>depth is calculated from traversal from root to the given node.....</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/owinstartup-not-firing/" class="u-url">OwinStartup not firing</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/owinstartup-not-firing/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T03:42:32+08:00" itemprop="datePublished" title="2023-03-04 03:42">2023-03-04 03:42</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I had the OwinStartup configuration code working perfectly and then it stopped
working. Unfortunately I'm not sure exactly what I did to get it to stop
working and am having a really hard time figuring it out.</p>
<p>To make sure I have the basics covered, I doubled checked to make sure the I
have the</p>
<div class="code"><pre class="code literal-block">[assembly:OwinStartup(typeof(WebApplication.Startup))]
</pre></div>

<p>attribute assigned properly and made sure that I don't have an appSetting for
owin:AutomaticAppStartup that is set to false so I made one set to true to be
safe as there was nothing there before.</p>
<div class="code"><pre class="code literal-block">&lt;add key="owin:AutomaticAppStartup" value="true" /&gt;
</pre></div>

<p>I also tried specifically calling out the appSetting:</p>
<div class="code"><pre class="code literal-block">&lt;add key="owin:appStartup" value="WebApplication.Startup" /&gt;
</pre></div>

<p>Before it stopped working I upgraded the Microsoft.Owin.Security NuGet
packages to 2.0.2, so I tried reverting them to 2.0.1 (that was a pain) but it
didn't change anything. I have WebActivator installed on the project and am
using that to bootstrap other things but I've tested that on a fresh
WebApplication template and it works there so I don't think that is the
culprit.</p>
<p>I also tried removing my Startup class and using Visual Studio to add a new
one using the OWIN Startup Class type in Add New Item and that isn't getting
called either. Next I tried adding a second Startup class since I know it will
throw an exception if there is more than one OwinStartup attributes defined,
but it isn't throwing any exception there.</p>
<p>Not sure what else to try. Any thoughts?</p>
<p><strong>Update</strong></p>
<p>Turns out that Resharper removed the reference to
Microsoft.Owin.Host.SystemWeb when I used it to remove unused references.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Make sure you have installed <code>Microsoft.Owin.Host.SystemWeb</code> package in the
project. This package is needed for startup detection in IIS hosted
applications. For more information you can refer to this article.</p>
<p><br></p>
<h3>Suggest</h3>
<p>If you've upgraded from an older MVC version make sure you don't have</p>
<div class="code"><pre class="code literal-block">  &lt;add key="owin:AutomaticAppStartup" value="false" /&gt;
</pre></div>

<p>in your <code>web.config</code>. It will suppress calling the startup logic.</p>
<p>Instead change it to <code>true</code></p>
<div class="code"><pre class="code literal-block">  &lt;add key="owin:AutomaticAppStartup" value="true" /&gt;
</pre></div>

<p>I realize you already mentioned this but sometimes people (like me) don't read
the whole question and just jump to the answers...</p>
<p>Somewhere along the line - when I upgraded to MVC 5 this got added and I never
saw it until today.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/express-js-how-to-get-remote-client-address/" class="u-url">Express.js: how to get remote client address</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/express-js-how-to-get-remote-client-address/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-04T03:40:46+08:00" itemprop="datePublished" title="2023-03-04 03:40">2023-03-04 03:40</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I don't completely understand how I should get a remote user IP address.</p>
<p>Let's say I have a simple request route such as:</p>
<div class="code"><pre class="code literal-block"><span class="n">app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="o">/</span><span class="p">,</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="p">(</span><span class="n">req</span><span class="p">,</span><span class="w"> </span><span class="n">res</span><span class="p">){</span>
<span class="w">   </span><span class="k">var</span><span class="w"> </span><span class="n">forwardedIpsStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">req</span><span class="o">.</span><span class="n">header</span><span class="p">(</span><span class="s1">'x-forwarded-for'</span><span class="p">);</span>
<span class="w">   </span><span class="k">var</span><span class="w"> </span><span class="n">IP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">''</span><span class="p">;</span>

<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">forwardedIpsStr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">IP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">forwardedIps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">forwardedIpsStr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">','</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span><span class="w">  </span>
<span class="w">   </span><span class="p">}</span>
<span class="p">});</span>
</pre></div>

<p>Is the above approach correct to get the real user IP address or is there a
better way? And what about proxies?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>If you are running behind a proxy like NGiNX or what have you, only then you
should check for <code>'x-forwarded-for'</code>:</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">ip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">req</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">'x-forwarded-for'</span><span class="p">]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">req</span><span class="o">.</span><span class="n">socket</span><span class="o">.</span><span class="n">remoteAddress</span>
</pre></div>

<p>If the proxy isn't 'yours', I wouldn't trust the <code>'x-forwarded-for'</code> header,
because it can be spoofed.</p>
<p><br></p>
<h3>Suggest</h3>
<p>While the answer from @alessioalex works, there's another way as stated in the
<em>Express behind proxies</em> section of Express - guide.</p>
<ol>
<li>Add <code>app.set('trust proxy', true)</code> to your express initialization code.</li>
<li>When you want to get the ip of the remote client, use <code>req.ip</code> or <code>req.ips</code> in the usual way (as if there isn't a reverse proxy)</li>
</ol>
<p>Optional reading:</p>
<ul>
<li>Use <code>req.ip</code> or <code>req.ips</code>. <code>req.connection.remoteAddress</code> does't work with this solution.</li>
<li>More options for <code>'trust proxy'</code> are available if you need something more sophisticated than trusting everything passed through in <code>x-forwarded-for</code> header (for example, when your proxy doesn't remove preexisting x-forwarded-for header from untrusted sources). See the linked guide for more details.</li>
<li>If your proxy server does not populated <code>x-forwarded-for</code> header, there are two possibilities. <ol>
<li>The proxy server does not relay the information on where the request was originally. In this case, there would be no way to find out where the request was originally from. You need to modify configuration of the proxy server first. </li>
<li>For example, if you use nginx as your reverse proxy, you may need to add <code>proxy_set_header X-Forwarded-For $remote_addr;</code> to your configuration.</li>
<li>The proxy server relays the information on where the request was originally from in a proprietary fashion (for example, custom http header). In such case, this answer would not work. There may be a custom way to get that information out, but you need to first understand the mechanism.</li>
</ol>
</li>
</ul>
</div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-2271.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-2269.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
