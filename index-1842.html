<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 1842) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-1842.html">
<link rel="prev" href="index-1843.html" type="text/html">
<link rel="next" href="index-1841.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/laravel-add-a-new-column-to-existing-table-in-a-migration/" class="u-url">Laravel Add a new column to existing table in a migration</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/laravel-add-a-new-column-to-existing-table-in-a-migration/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T10:38:13+08:00" itemprop="datePublished" title="2023-03-03 10:38">2023-03-03 10:38</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I can't figure out how to add a new column to my existing database table using
the Laravel framework.</p>
<p>I tried to edit the migration file using...</p>
<div class="code"><pre class="code literal-block"><span class="cp">&lt;?php</span>

<span class="k">public</span> <span class="k">function</span> <span class="nf">up</span><span class="p">()</span>
<span class="p">{</span>
    <span class="nx">Schema</span><span class="o">::</span><span class="na">create</span><span class="p">(</span><span class="s1">'users'</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$table</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$table</span><span class="o">-&gt;</span><span class="na">integer</span><span class="p">(</span><span class="s2">"paid"</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">}</span>
</pre></div>

<p>In terminal, I execute <code>php artisan migrate:install</code> and <code>migrate</code>.</p>
<p>How do I add new columns?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>To create a migration, you may use the migrate:make command on the Artisan
CLI. Use a specific name to avoid clashing with existing models</p>
<p>for Laravel 5+:</p>
<div class="code"><pre class="code literal-block">php artisan make:migration add_paid_to_users_table --table=users
</pre></div>

<p>for Laravel 3:</p>
<div class="code"><pre class="code literal-block">php artisan migrate:make add_paid_to_users
</pre></div>

<p>You then need to use the <code>Schema::table()</code> method (as you're accessing an
existing table, not creating a new one). And you can add a column like this:</p>
<div class="code"><pre class="code literal-block"><span class="nt">public</span><span class="w"> </span><span class="nt">function</span><span class="w"> </span><span class="nt">up</span><span class="o">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">Schema</span><span class="p">:</span><span class="o">:</span><span class="nf">table</span><span class="p">(</span><span class="s1">'users'</span><span class="p">,</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="err">$</span><span class="kc">table</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="err">$</span><span class="kc">table</span><span class="o">-</span><span class="err">&gt;</span><span class="nf">integer</span><span class="p">(</span><span class="s1">'paid'</span><span class="p">)</span><span class="err">;</span>
<span class="w">    </span><span class="err">}</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>

<p>and don't forget to add the rollback option:</p>
<div class="code"><pre class="code literal-block"><span class="nt">public</span><span class="w"> </span><span class="nt">function</span><span class="w"> </span><span class="nt">down</span><span class="o">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">Schema</span><span class="p">:</span><span class="o">:</span><span class="nf">table</span><span class="p">(</span><span class="s1">'users'</span><span class="p">,</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="err">$</span><span class="kc">table</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="err">$</span><span class="kc">table</span><span class="o">-</span><span class="err">&gt;</span><span class="nf">dropColumn</span><span class="p">(</span><span class="s1">'paid'</span><span class="p">)</span><span class="err">;</span>
<span class="w">    </span><span class="err">}</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>

<p>Then you can run your migrations:</p>
<div class="code"><pre class="code literal-block">php artisan migrate
</pre></div>

<p>This is all well covered in the documentation for both Laravel 4 / Laravel 5:</p>
<ul>
<li>Schema Builder</li>
<li>Migrations</li>
</ul>
<p>And for Laravel 3:</p>
<ul>
<li>Schema Builder</li>
<li>Migrations</li>
</ul>
<p>Edit:</p>
<p>use <code>$table-&gt;integer('paid')-&gt;after('whichever_column');</code> to add this field
after specific column.</p>
<p><br></p>
<h3>Suggest</h3>
<p>I'll add on to mike3875's answer for future readers using Laravel 5.1 and
onward.</p>
<p>To make things quicker, you can use the flag "--table" like this:</p>
<div class="code"><pre class="code literal-block">php artisan make:migration add_paid_to_users --table="users"
</pre></div>

<p>This will add the <code>up</code> and <code>down</code> method content automatically:</p>
<div class="code"><pre class="code literal-block"><span class="o">/**</span>
<span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Run</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">migrations</span><span class="p">.</span>
<span class="w"> </span><span class="o">*</span>
<span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">@</span><span class="k">return</span><span class="w"> </span><span class="n">void</span>
<span class="w"> </span><span class="o">*/</span>
<span class="n">public</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">up</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">Schema</span><span class="p">::</span><span class="n">table</span><span class="p">(</span><span class="s">'users'</span><span class="p">,</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="p">(</span><span class="n">Blueprint</span><span class="w"> </span><span class="no">$</span><span class="n">table</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">//</span>
<span class="w">    </span><span class="p">});</span>
<span class="p">}</span>
</pre></div>

<p>Similarily, you can use the <code>--create["table_name"]</code> option when creating new
migrations which will add more boilerplate to your migrations. Small point,
but helpful when doing loads of them!</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/cors-cannot-use-wildcard-in-access-control-allow-origin-when-credentials-flag-is-true/" class="u-url">CORS: Cannot use wildcard in Access-Control-Allow-Origin when credentials flag is true</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/cors-cannot-use-wildcard-in-access-control-allow-origin-when-credentials-flag-is-true/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T10:37:49+08:00" itemprop="datePublished" title="2023-03-03 10:37">2023-03-03 10:37</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I have a setup involving</p>
<p>Frontend server (Node.js, domain: localhost:3000) &lt;---&gt; Backend (Django,
Ajax, domain: localhost:8000)</p>
<p>Browser &lt;-- webapp &lt;-- Node.js (Serve the app)</p>
<p>Browser (webapp) --&gt; Ajax --&gt; Django(Serve ajax POST requests)</p>
<p>Now, my problem here is with CORS setup which the webapp uses to make Ajax
calls to the backend server. In chrome, I keep getting</p>
<blockquote>
<p>Cannot use wildcard in Access-Control-Allow-Origin when credentials flag is
true.</p>
</blockquote>
<p>doesn't work on firefox either.</p>
<p>My Node.js setup is:</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">allowCrossDomain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">function</span><span class="p">(</span><span class="n">req</span><span class="p">,</span><span class="w"> </span><span class="n">res</span><span class="p">,</span><span class="w"> </span><span class="n">next</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">res</span><span class="o">.</span><span class="n">header</span><span class="p">(</span><span class="s1">'Access-Control-Allow-Origin'</span><span class="p">,</span><span class="w"> </span><span class="s1">'http://localhost:8000/'</span><span class="p">);</span>
<span class="w">    </span><span class="n">res</span><span class="o">.</span><span class="n">header</span><span class="p">(</span><span class="s1">'Access-Control-Allow-Credentials'</span><span class="p">,</span><span class="w"> </span><span class="bp">true</span><span class="p">);</span>
<span class="w">    </span><span class="n">res</span><span class="o">.</span><span class="n">header</span><span class="p">(</span><span class="s1">'Access-Control-Allow-Methods'</span><span class="p">,</span><span class="w"> </span><span class="s1">'GET,PUT,POST,DELETE'</span><span class="p">);</span>
<span class="w">    </span><span class="n">res</span><span class="o">.</span><span class="n">header</span><span class="p">(</span><span class="s2">"Access-Control-Allow-Headers"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Origin, X-Requested-With, Content-Type, Accept"</span><span class="p">);</span>
<span class="w">    </span><span class="n">next</span><span class="p">();</span>
<span class="p">};</span>
</pre></div>

<p>And in Django I'm using this middleware along with this</p>
<p>The webapp makes requests as such:</p>
<div class="code"><pre class="code literal-block"><span class="o">$</span><span class="p">.</span><span class="nc">ajax</span><span class="o">(</span><span class="p">{</span>
<span class="w">    </span><span class="n">type</span><span class="p">:</span><span class="w"> </span><span class="s2">"POST"</span><span class="p">,</span>
<span class="w">    </span><span class="n">url</span><span class="o">:</span><span class="w"> </span><span class="s1">'http://localhost:8000/blah'</span><span class="p">,</span>
<span class="w">    </span><span class="n">data</span><span class="o">:</span><span class="w"> </span><span class="err">{</span><span class="p">}</span><span class="o">,</span>
<span class="w">    </span><span class="nt">xhrFields</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">withCredentials</span><span class="p">:</span><span class="w"> </span><span class="n">true</span>
<span class="w">    </span><span class="p">}</span><span class="o">,</span>
<span class="w">    </span><span class="nt">crossDomain</span><span class="o">:</span><span class="w"> </span><span class="nt">true</span><span class="o">,</span>
<span class="w">    </span><span class="nt">dataType</span><span class="o">:</span><span class="w"> </span><span class="s1">'json'</span><span class="o">,</span>
<span class="w">    </span><span class="nt">success</span><span class="o">:</span><span class="w"> </span><span class="nt">successHandler</span>
<span class="err">}</span><span class="o">);</span>
</pre></div>

<p>So, the request headers that the webapp sends looks like:</p>
<div class="code"><pre class="code literal-block"><span class="nt">Access-Control-Allow-Credentials</span><span class="o">:</span><span class="w"> </span><span class="nt">true</span>
<span class="nt">Access-Control-Allow-Headers</span><span class="o">:</span><span class="w"> </span><span class="s2">"Origin, X-Requested-With, Content-Type, Accept"</span>
<span class="nt">Access-Control-Allow-Methods</span><span class="o">:</span><span class="w"> </span><span class="s1">'GET,PUT,POST,DELETE'</span>
<span class="nt">Content-Type</span><span class="o">:</span><span class="w"> </span><span class="nt">application</span><span class="o">/</span><span class="nt">json</span><span class="w"> </span>
<span class="nt">Accept</span><span class="o">:</span><span class="w"> </span><span class="o">*/*</span>
<span class="nt">Accept-Encoding</span><span class="o">:</span><span class="w"> </span><span class="nt">gzip</span><span class="o">,</span><span class="nt">deflate</span><span class="o">,</span><span class="nt">sdch</span>
<span class="nt">Accept-Language</span><span class="o">:</span><span class="w"> </span><span class="nt">en-US</span><span class="o">,</span><span class="nt">en</span><span class="o">;</span><span class="nt">q</span><span class="o">=</span><span class="nt">0</span><span class="p">.</span><span class="nc">8</span>
<span class="nt">Cookie</span><span class="o">:</span><span class="w"> </span><span class="nt">csrftoken</span><span class="o">=***;</span><span class="w"> </span><span class="nt">sessionid</span><span class="o">=</span><span class="s2">"***"</span>
</pre></div>

<p>And here's the response header:</p>
<div class="code"><pre class="code literal-block">Access-Control-Allow-Headers: Content-Type,*
Access-Control-Allow-Credentials: true
Access-Control-Allow-Origin: *
Access-Control-Allow-Methods: POST,GET,OPTIONS,PUT,DELETE
Content-Type: application/json
</pre></div>

<p>Where am I going wrong?!</p>
<p>Edit 1: I've been using <code>chrome --disable-web-security</code>, but now want things
to actually work.</p>
<p>Edit 2: Answer:</p>
<p>So, solution for me <code>django-cors-headers</code> config:</p>
<div class="code"><pre class="code literal-block">CORS_ORIGIN_ALLOW_ALL = False
CORS_ALLOW_CREDENTIALS = True
CORS_ORIGIN_WHITELIST = (
    'http://localhost:3000' # Here was the problem indeed and it has to be http://localhost:3000, not http://localhost:3000/
)
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<p>This is a part of security, you cannot do that. If you want to allow
credentials then your <code>Access-Control-Allow-Origin</code> must not use <code>*</code>. You will
have to specify the exact protocol + domain + port. For reference see these
questions :</p>
<ol>
<li>Access-Control-Allow-Origin wildcard subdomains, ports and protocols</li>
<li>Cross Origin Resource Sharing with Credentials</li>
</ol>
<p>Besides <code>*</code> is too permissive and would defeat use of credentials. So set
<code>http://localhost:3000</code> or <code>http://localhost:8000</code> as the allow origin header.</p>
<p><br></p>
<h3>Suggest</h3>
<p>If you are using CORS middleware and you want to send <code>withCredential</code> boolean
true, you can configure CORS like this:</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">cors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">require</span><span class="p">(</span><span class="s1">'cors'</span><span class="p">);</span><span class="w">    </span>
<span class="n">app</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">cors</span><span class="p">({</span><span class="n">credentials</span><span class="p">:</span><span class="w"> </span><span class="bp">true</span><span class="p">,</span><span class="w"> </span><span class="n">origin</span><span class="p">:</span><span class="w"> </span><span class="s1">'http://localhost:3000'</span><span class="p">}));</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/difference-between-map-and-collect-in-ruby/" class="u-url">Difference between map and collect in Ruby?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/difference-between-map-and-collect-in-ruby/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T10:37:27+08:00" itemprop="datePublished" title="2023-03-03 10:37">2023-03-03 10:37</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I have Googled this and got patchy / contradictory opinions - is there
actually any difference between doing a <code>map</code> and doing a <code>collect</code> on an
array in Ruby/Rails?</p>
<p>The docs don't seem to suggest any, but are there perhaps differences in
method or performance?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>There's no difference, in fact <code>map</code> is implemented in C as <code>rb_ary_collect</code>
and <code>enum_collect</code> (eg. there is a difference between <code>map</code> on an array and on
any other enum, but no difference between <code>map</code> and <code>collect</code>).</p>
<hr>
<p><strong>Why do both<code>map</code> and <code>collect</code> exist in Ruby?</strong> The <code>map</code> function has many
naming conventions in different languages. Wikipedia provides an overview:</p>
<blockquote>
<p>The map function originated in functional programming languages but is today
supported (or may be defined) in many procedural, object oriented, and
multi-paradigm languages as well: In C++'s Standard Template Library, it is
called <code>transform</code>, in C# (3.0)'s LINQ library, it is provided as an
extension method called <code>Select</code>. Map is also a frequently used operation in
high level languages such as Perl, Python and Ruby; the operation is called
<code>map</code> in all three of these languages. <em>A<code>collect</code> alias for map is also
provided in Ruby (from Smalltalk)</em> [emphasis mine]. Common Lisp provides a
family of map-like functions; the one corresponding to the behavior
described here is called <code>mapcar</code> (-car indicating access using the CAR
operation).</p>
</blockquote>
<p>Ruby provides an alias for programmers from the Smalltalk world to feel more
at home.</p>
<hr>
<p><strong>Why is there a different implementation for arrays and enums?</strong> An enum is a
generalized iteration structure, which means that there is no way in which
Ruby can predict what the next element can be (you can define infinite enums,
see Prime for an example). Therefore it must call a function to get each
successive element (typically this will be the <code>each</code> method).</p>
<p>Arrays are the most common collection so it is reasonable to optimize their
performance. Since Ruby knows a lot about how arrays work it doesn't have to
call <code>each</code> but can only use simple pointer manipulation which is
significantly faster.</p>
<p>Similar optimizations exist for a number of Array methods like <code>zip</code> or
<code>count</code>.</p>
<p><br></p>
<h3>Suggest</h3>
<p><del>I've been told</del> they are the same.</p>
<p>Actually they are documented in the same place under ruby-doc.org:</p>
<p>http://www.ruby-doc.org/core/classes/Array.html#M000249</p>
<blockquote>
<ul>
<li>ary.collect {|item| block } → new_ary</li>
<li>ary.map {|item| block } → new_ary</li>
<li>ary.collect → an_enumerator</li>
<li>ary.map → an_enumerator
</li>
</ul>
<p>Invokes block once for each element of self. Creates a new array containing
the values returned by the block. See also Enumerable#collect.<br>
 If no block is given, an enumerator is returned instead.</p>
<div class="code"><pre class="code literal-block">a = [ "a", "b", "c", "d" ]
a.collect {|x| x + "!" }   #=&gt; ["a!", "b!", "c!", "d!"]
a                          #=&gt; ["a", "b", "c", "d"]
</pre></div>

</blockquote>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-1843.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-1841.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
