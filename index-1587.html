<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 1587) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-1587.html">
<link rel="prev" href="index-1588.html" type="text/html">
<link rel="next" href="index-1586.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/c-11-rvalues-and-move-semantics-confusion-return-statement/" class="u-url">C++11 rvalues and move semantics confusion (return statement)</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/c-11-rvalues-and-move-semantics-confusion-return-statement/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T04:34:42+08:00" itemprop="datePublished" title="2023-03-03 04:34">2023-03-03 04:34</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I'm trying to understand rvalue references and move semantics of C++11.</p>
<p>What is the difference between these examples, and which of them is going to
do no vector copy?</p>
<h3>First example</h3>
<div class="code"><pre class="code literal-block"><span class="nt">std</span><span class="p">::</span><span class="nd">vector</span><span class="o">&lt;</span><span class="nt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="nt">return_vector</span><span class="o">(</span><span class="nt">void</span><span class="o">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">std</span><span class="p">:</span><span class="o">:</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">tmp</span><span class="w"> </span><span class="err">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">}</span><span class="o">;</span>
<span class="w">    </span><span class="nt">return</span><span class="w"> </span><span class="nt">tmp</span><span class="o">;</span>
<span class="err">}</span>

<span class="nt">std</span><span class="p">::</span><span class="nd">vector</span><span class="o">&lt;</span><span class="nt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="nt">rval_ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">return_vector</span><span class="o">();</span>
</pre></div>

<h3>Second example</h3>
<div class="code"><pre class="code literal-block"><span class="nt">std</span><span class="p">::</span><span class="nd">vector</span><span class="o">&lt;</span><span class="nt">int</span><span class="o">&gt;&amp;&amp;</span><span class="w"> </span><span class="nt">return_vector</span><span class="o">(</span><span class="nt">void</span><span class="o">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">std</span><span class="p">:</span><span class="o">:</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">tmp</span><span class="w"> </span><span class="err">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">}</span><span class="o">;</span>
<span class="w">    </span><span class="nt">return</span><span class="w"> </span><span class="nt">std</span><span class="p">::</span><span class="nd">move</span><span class="o">(</span><span class="nt">tmp</span><span class="o">);</span>
<span class="err">}</span>

<span class="nt">std</span><span class="p">::</span><span class="nd">vector</span><span class="o">&lt;</span><span class="nt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="nt">rval_ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">return_vector</span><span class="o">();</span>
</pre></div>

<h3>Third example</h3>
<div class="code"><pre class="code literal-block"><span class="nt">std</span><span class="p">::</span><span class="nd">vector</span><span class="o">&lt;</span><span class="nt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="nt">return_vector</span><span class="o">(</span><span class="nt">void</span><span class="o">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">std</span><span class="p">:</span><span class="o">:</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">tmp</span><span class="w"> </span><span class="err">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">}</span><span class="o">;</span>
<span class="w">    </span><span class="nt">return</span><span class="w"> </span><span class="nt">std</span><span class="p">::</span><span class="nd">move</span><span class="o">(</span><span class="nt">tmp</span><span class="o">);</span>
<span class="err">}</span>

<span class="nt">std</span><span class="p">::</span><span class="nd">vector</span><span class="o">&lt;</span><span class="nt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="nt">rval_ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">return_vector</span><span class="o">();</span>
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<h3>First example</h3>
<div class="code"><pre class="code literal-block"><span class="nt">std</span><span class="p">::</span><span class="nd">vector</span><span class="o">&lt;</span><span class="nt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="nt">return_vector</span><span class="o">(</span><span class="nt">void</span><span class="o">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">std</span><span class="p">:</span><span class="o">:</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">tmp</span><span class="w"> </span><span class="err">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">}</span><span class="o">;</span>
<span class="w">    </span><span class="nt">return</span><span class="w"> </span><span class="nt">tmp</span><span class="o">;</span>
<span class="err">}</span>

<span class="nt">std</span><span class="p">::</span><span class="nd">vector</span><span class="o">&lt;</span><span class="nt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="nt">rval_ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">return_vector</span><span class="o">();</span>
</pre></div>

<p>The first example returns a temporary which is caught by <code>rval_ref</code>. That
temporary will have its life extended beyond the <code>rval_ref</code> definition and you
can use it as if you had caught it by value. This is very similar to the
following:</p>
<div class="code"><pre class="code literal-block"><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="p">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="nb nb-Type">int</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">rval_ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">return_vector</span><span class="p">();</span>
</pre></div>

<p>except that in my rewrite you obviously can't use <code>rval_ref</code> in a non-const
manner.</p>
<h3>Second example</h3>
<div class="code"><pre class="code literal-block"><span class="nt">std</span><span class="p">::</span><span class="nd">vector</span><span class="o">&lt;</span><span class="nt">int</span><span class="o">&gt;&amp;&amp;</span><span class="w"> </span><span class="nt">return_vector</span><span class="o">(</span><span class="nt">void</span><span class="o">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">std</span><span class="p">:</span><span class="o">:</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">tmp</span><span class="w"> </span><span class="err">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">}</span><span class="o">;</span>
<span class="w">    </span><span class="nt">return</span><span class="w"> </span><span class="nt">std</span><span class="p">::</span><span class="nd">move</span><span class="o">(</span><span class="nt">tmp</span><span class="o">);</span>
<span class="err">}</span>

<span class="nt">std</span><span class="p">::</span><span class="nd">vector</span><span class="o">&lt;</span><span class="nt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="nt">rval_ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">return_vector</span><span class="o">();</span>
</pre></div>

<p>In the second example you have created a run time error. <code>rval_ref</code> now holds
a reference to the destructed <code>tmp</code> inside the function. With any luck, this
code would immediately crash.</p>
<h3>Third example</h3>
<div class="code"><pre class="code literal-block"><span class="nt">std</span><span class="p">::</span><span class="nd">vector</span><span class="o">&lt;</span><span class="nt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="nt">return_vector</span><span class="o">(</span><span class="nt">void</span><span class="o">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">std</span><span class="p">:</span><span class="o">:</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">tmp</span><span class="w"> </span><span class="err">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">}</span><span class="o">;</span>
<span class="w">    </span><span class="nt">return</span><span class="w"> </span><span class="nt">std</span><span class="p">::</span><span class="nd">move</span><span class="o">(</span><span class="nt">tmp</span><span class="o">);</span>
<span class="err">}</span>

<span class="nt">std</span><span class="p">::</span><span class="nd">vector</span><span class="o">&lt;</span><span class="nt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="nt">rval_ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">return_vector</span><span class="o">();</span>
</pre></div>

<p>Your third example is roughly equivalent to your first. The <code>std::move</code> on
<code>tmp</code> is unnecessary and can actually be a performance pessimization as it
will inhibit return value optimization.</p>
<p>The best way to code what you're doing is:</p>
<h3>Best practice</h3>
<div class="code"><pre class="code literal-block"><span class="nt">std</span><span class="p">::</span><span class="nd">vector</span><span class="o">&lt;</span><span class="nt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="nt">return_vector</span><span class="o">(</span><span class="nt">void</span><span class="o">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">std</span><span class="p">:</span><span class="o">:</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">tmp</span><span class="w"> </span><span class="err">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">}</span><span class="o">;</span>
<span class="w">    </span><span class="nt">return</span><span class="w"> </span><span class="nt">tmp</span><span class="o">;</span>
<span class="err">}</span>

<span class="nt">std</span><span class="p">::</span><span class="nd">vector</span><span class="o">&lt;</span><span class="nt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="nt">rval_ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">return_vector</span><span class="o">();</span>
</pre></div>

<p>I.e. just as you would in C++03. <code>tmp</code> is implicitly treated as an rvalue in
the return statement. It will either be returned via return-value-optimization
(no copy, no move), or if the compiler decides it can not perform RVO, then it
will use vector's move constructor to do the return. Only if RVO is not
performed, and if the returned type did not have a move constructor would the
copy constructor be used for the return.</p>
<p><br></p>
<h3>Suggest</h3>
<p>None of them will copy, but the second will refer to a destroyed vector. Named
rvalue references almost never exist in regular code. You write it just how
you would have written a copy in C++03.</p>
<div class="code"><pre class="code literal-block"><span class="nt">std</span><span class="p">::</span><span class="nd">vector</span><span class="o">&lt;</span><span class="nt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="nt">return_vector</span><span class="o">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">std</span><span class="p">:</span><span class="o">:</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">tmp</span><span class="w"> </span><span class="err">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">}</span><span class="o">;</span>
<span class="w">    </span><span class="nt">return</span><span class="w"> </span><span class="nt">tmp</span><span class="o">;</span>
<span class="err">}</span>

<span class="nt">std</span><span class="p">::</span><span class="nd">vector</span><span class="o">&lt;</span><span class="nt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="nt">rval_ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">return_vector</span><span class="o">();</span>
</pre></div>

<p>Except now, the vector is moved. The <em>user</em> of a class doesn't deal with it's
rvalue references in the vast majority of cases.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-convert-java-util-date-to-java-sql-date/" class="u-url">How to convert java.util.Date to java.sql.Date?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-convert-java-util-date-to-java-sql-date/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T04:34:16+08:00" itemprop="datePublished" title="2023-03-03 04:34">2023-03-03 04:34</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I am trying to use a <code>java.util.Date</code> as input and then creating a query with
it - so I need a <code>java.sql.Date</code>.</p>
<p>I was surprised to find that it couldn't do the conversion implicitly or
explicitly - but I don't even know how I would do this, as the Java API is
still fairly new to me.</p>
<p><br><br></p>
<h2>Answer</h2>
<h2>tl;dr</h2>
<blockquote>
<p>How to convert java.util.Date to java.sql.Date?</p>
</blockquote>
<p><strong>Don’t.</strong></p>
<p>Both <code>Date</code> classes are outmoded. Sun, Oracle, and the JCP community gave up
on those legacy date-time classes years ago with the unanimous adoption of JSR
310 defining the <em>java.time</em> classes.</p>
<ul>
<li>Use <em>java.time</em> classes instead of legacy <code>java.util.Date</code> &amp; <code>java.sql.Date</code> with JDBC 4.2 or later.</li>
<li>Convert to/from java.time if inter-operating with code not yet updated to java.time.</li>
</ul>
<table>
<thead><tr>
<th>Legacy</th>
<th>Modern</th>
<th>Conversion</th>
</tr></thead>
<tbody>
<tr>
<td><code>java.util.Date</code></td>
<td><code>java.time.Instant</code></td>
<td><code>java.util.Date.toInstant()</code></td>
</tr>
<tr>
<td><code>java.util.Date.from( Instant )</code></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>java.sql.Date</code></td>
<td><code>java.time.LocalDate</code></td>
<td><code>java.sql.Date.toLocalDate()</code></td>
</tr>
<tr>
<td><code>java.sql.Date.valueOf( LocalDate )</code></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Example query with <code>PreparedStatement</code>.</p>
<div class="code"><pre class="code literal-block"><span class="n">myPreparedStatement</span><span class="p">.</span><span class="k">set</span><span class="n">Object</span><span class="p">(</span><span class="w"> </span>
<span class="w">    </span><span class="n">…</span><span class="w"> </span><span class="p">,</span><span class="w">                                         </span><span class="o">//</span><span class="w"> </span><span class="n">Specify</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ordinal</span><span class="w"> </span><span class="k">number</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">argument</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">SQL</span><span class="w"> </span><span class="n">statement</span><span class="p">.</span>
<span class="w">    </span><span class="n">myJavaUtilDate</span><span class="p">.</span><span class="n">toInstant</span><span class="p">()</span><span class="w">                  </span><span class="o">//</span><span class="w"> </span><span class="k">Convert</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">legacy</span><span class="w"> </span><span class="n">class</span><span class="w"> </span><span class="n n-Quoted">`java.util.Date`</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="n">moment</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">UTC</span><span class="p">)</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">modern</span><span class="w"> </span><span class="n n-Quoted">`java.time.Instant`</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="n">moment</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">UTC</span><span class="p">).</span>
<span class="w">        </span><span class="p">.</span><span class="n">atZone</span><span class="p">(</span><span class="w"> </span><span class="n">ZoneId</span><span class="p">.</span><span class="k">of</span><span class="p">(</span><span class="w"> </span><span class="s2">"Africa/Tunis"</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Adjust</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">UTC</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">particular</span><span class="w"> </span><span class="kt">time</span><span class="w"> </span><span class="k">zone</span><span class="p">,</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">determine</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="kt">date</span><span class="p">.</span><span class="w"> </span><span class="n">Instantiating</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n n-Quoted">`ZonedDateTime`</span><span class="p">.</span>
<span class="w">        </span><span class="p">.</span><span class="n">toLocalDate</span><span class="p">()</span><span class="w">                          </span><span class="o">//</span><span class="w"> </span><span class="n">Extract</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="kt">date</span><span class="o">-</span><span class="k">only</span><span class="w"> </span><span class="n n-Quoted">`java.time.LocalDate`</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="kt">date</span><span class="o">-</span><span class="kt">time</span><span class="w"> </span><span class="n n-Quoted">`ZonedDateTime`</span><span class="w"> </span><span class="n">object</span><span class="p">.</span>
<span class="p">)</span>
</pre></div>

<p>Replacements:</p>
<ul>
<li>
<p><code>Instant</code> instead of <code>java.util.Date</code><br>
Both represent a moment in UTC. but now with nanoseconds instead of
milliseconds.</p>
</li>
<li>
<p><code>LocalDate</code> instead of <code>java.sql.Date</code><br>
Both represent a date-only value without a time of day and without a time
zone.</p>
</li>
</ul>
<h2>Details</h2>
<p>If you are trying to work with date-only values (no time-of-day, no time
zone), use the <code>LocalDate</code> class rather than <code>java.util.Date</code>.</p>
<p><img alt="Table of date-time types in Java (both legacy and modern) and in the SQL
standard." src="images/bXtIS.png"></p>
<h2>java.time</h2>
<p>In Java 8 and later, the troublesome old date-time classes bundled with early
versions of Java have been supplanted by the new java.time package. See Oracle
Tutorial. Much of the functionality has been back-ported to Java 6 &amp; 7 in
ThreeTen-Backport and further adapted to Android in ThreeTenABP.</p>
<p>A SQL data type <code>DATE</code> is meant to be date-only, with no time-of-day and no
time zone. Java never had precisely such a class† until <code>java.time.LocalDate</code>
in Java 8. Let's create such a value by getting today's date according to a
particular time zone (time zone is important in determining a date as a new
day dawns earlier in Paris than in Montréal, for example).</p>
<div class="code"><pre class="code literal-block"><span class="n">LocalDate</span><span class="w"> </span><span class="n">todayLocalDate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LocalDate</span><span class="p">.</span><span class="n">now</span><span class="p">(</span><span class="w"> </span><span class="n">ZoneId</span><span class="p">.</span><span class="n">of</span><span class="p">(</span><span class="w"> </span><span class="s">"America/Montreal"</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w">  </span><span class="c1">// Use proper "continent/region" time zone names; never use 3-4 letter codes like "EST" or "IST".</span>
</pre></div>

<p>At this point, we may be done. If your JDBC driver complies with JDBC 4.2
spec, you should be able to pass a <code>LocalDate</code> via <code>setObject</code> on a
<code>PreparedStatement</code> to store into a SQL DATE field.</p>
<div class="code"><pre class="code literal-block">myPreparedStatement.setObject( 1 , localDate );
</pre></div>

<p>Likewise, use <code>ResultSet::getObject</code> to fetch from a SQL DATE column to a Java
<code>LocalDate</code> object. Specifying the class in the second argument makes your
code type-safe.</p>
<div class="code"><pre class="code literal-block">LocalDate localDate = ResultSet.getObject( 1 , LocalDate.class );
</pre></div>

<p>In other words, <strong>this entire Question is irrelevant under JDBC 4.2</strong> or
later.</p>
<p>If your JDBC driver does not perform in this manner, you need to fall back to
converting to the java.sql types.</p>
<h2>Convert to java.sql.Date</h2>
<p>To convert, use new methods added to the old date-time classes. We can call
<code>java.sql.Date.valueOf(…)</code> to convert a <code>LocalDate</code>.</p>
<div class="code"><pre class="code literal-block">java.sql.Date sqlDate = java.sql.Date.valueOf( todayLocalDate );
</pre></div>

<p>And going the other direction.</p>
<div class="code"><pre class="code literal-block">LocalDate localDate = sqlDate.toLocalDate();
</pre></div>

<h2>Converting from <code>java.util.Date</code>
</h2>
<p>While you should avoid using the old date-time classes, you may be forced to
when working with existing code. If so, you can convert to/from java.time.</p>
<p>Go through the <code>Instant</code> class, which represents a moment on the timeline in
UTC. An <code>Instant</code> is similar in idea to a <code>java.util.Date</code>. But note that
<code>Instant</code> has a resolution up to nanoseconds while <code>java.util.Date</code> has only
milliseconds resolution.</p>
<p>To convert, use new methods added to the old classes. For example,
<code>java.util.Date.from( Instant )</code> and <code>java.util.Date::toInstant</code>.</p>
<div class="code"><pre class="code literal-block">Instant instant = myUtilDate.toInstant();
</pre></div>

<p>To determine a date, we need the context of a time zone. For any given moment,
the date varies around the globe by time zone. Apply a <code>ZoneId</code> to get a
<code>ZonedDateTime</code>.</p>
<div class="code"><pre class="code literal-block">ZoneId zoneId = ZoneId.of ( "America/Montreal" );
ZonedDateTime zdt = ZonedDateTime.ofInstant ( instant , zoneId );
LocalDate localDate = zdt.toLocalDate();
</pre></div>

<hr>
<p>† The java.sql.Date class pretends to be date-only without a time-of-day but
actually <em>does</em> a time-of-day, adjusted to a midnight time. Confusing? Yes,
the old date-time classes are a mess.</p>
<hr>
<h2>About <em>java.time</em>
</h2>
<p>The <em>java.time</em> framework is built into Java 8 and later. These classes
supplant the troublesome old legacy date-time classes such as
<code>java.util.Date</code>, <code>Calendar</code>, &amp; <code>SimpleDateFormat</code>.</p>
<p>To learn more, see the <em>Oracle Tutorial</em>. And search Stack Overflow for many
examples and explanations. Specification is JSR 310.</p>
<p>The <em>Joda-Time</em> project, now in maintenance mode, advises migration to the
java.time classes.</p>
<p>You may exchange <em>java.time</em> objects directly with your database. Use a JDBC
driver compliant with JDBC 4.2 or later. No need for strings, no need for
<code>java.sql.*</code> classes. Hibernate 5 &amp; JPA 2.2 support <em>java.time</em>.</p>
<p>Where to obtain the java.time classes?</p>
<ul>
<li>
<strong>Java SE 8</strong> , <strong>Java SE 9</strong> , <strong>Java SE 10</strong> , <strong>Java SE 11</strong> , and later - Part of the standard Java API with a bundled implementation. <ul>
<li>
<strong>Java 9</strong> brought some minor features and fixes.</li>
</ul>
</li>
<li>
<strong>Java SE 6</strong> and <strong>Java SE 7</strong><ul>
<li>Most of the <em>java.time</em> functionality is back-ported to Java 6 &amp; 7 in <em><strong>ThreeTen-Backport</strong></em>.</li>
</ul>
</li>
<li>
<strong>Android</strong><ul>
<li>Later versions of Android (26+) bundle implementations of the <em>java.time</em> classes.</li>
<li>For earlier Android (&lt;26), a process known as <em>API desugaring</em> brings a subset of the <em>java.time</em> functionality not originally built into Android. </li>
<li>If the desugaring does not offer what you need, the <em><strong>ThreeTenABP</strong></em> project adapts <em><strong>ThreeTen-Backport</strong></em> (mentioned above) to Android. See <em>How to use ThreeTenABP…</em>.</li>
</ul>
</li>
</ul>
<p><img alt="Table of which java.time library to use with which version of Java or
Android" src="images/Sksw9.png"></p>
<p>The <strong>ThreeTen-Extra</strong> project extends java.time with additional classes. This
project is a proving ground for possible future additions to java.time. You
may find some useful classes here such as <code>Interval</code>, <code>YearWeek</code>,
<code>YearQuarter</code>, and more.</p>
<p><br></p>
<h3>Suggest</h3>
<h2>tl;dr</h2>
<blockquote>
<p>How to convert java.util.Date to java.sql.Date?</p>
</blockquote>
<p><strong>Don’t.</strong></p>
<p>Both <code>Date</code> classes are outmoded. Sun, Oracle, and the JCP community gave up
on those legacy date-time classes years ago with the unanimous adoption of JSR
310 defining the <em>java.time</em> classes.</p>
<ul>
<li>Use <em>java.time</em> classes instead of legacy <code>java.util.Date</code> &amp; <code>java.sql.Date</code> with JDBC 4.2 or later.</li>
<li>Convert to/from java.time if inter-operating with code not yet updated to java.time.</li>
</ul>
<table>
<thead><tr>
<th>Legacy</th>
<th>Modern</th>
<th>Conversion</th>
</tr></thead>
<tbody>
<tr>
<td><code>java.util.Date</code></td>
<td><code>java.time.Instant</code></td>
<td><code>java.util.Date.toInstant()</code></td>
</tr>
<tr>
<td><code>java.util.Date.from( Instant )</code></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>java.sql.Date</code></td>
<td><code>java.time.LocalDate</code></td>
<td><code>java.sql.Date.toLocalDate()</code></td>
</tr>
<tr>
<td><code>java.sql.Date.valueOf( LocalDate )</code></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Example query with <code>PreparedStatement</code>.</p>
<div class="code"><pre class="code literal-block"><span class="n">myPreparedStatement</span><span class="p">.</span><span class="k">set</span><span class="n">Object</span><span class="p">(</span><span class="w"> </span>
<span class="w">    </span><span class="n">…</span><span class="w"> </span><span class="p">,</span><span class="w">                                         </span><span class="o">//</span><span class="w"> </span><span class="n">Specify</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ordinal</span><span class="w"> </span><span class="k">number</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">argument</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">SQL</span><span class="w"> </span><span class="n">statement</span><span class="p">.</span>
<span class="w">    </span><span class="n">myJavaUtilDate</span><span class="p">.</span><span class="n">toInstant</span><span class="p">()</span><span class="w">                  </span><span class="o">//</span><span class="w"> </span><span class="k">Convert</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">legacy</span><span class="w"> </span><span class="n">class</span><span class="w"> </span><span class="n n-Quoted">`java.util.Date`</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="n">moment</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">UTC</span><span class="p">)</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">modern</span><span class="w"> </span><span class="n n-Quoted">`java.time.Instant`</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="n">moment</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">UTC</span><span class="p">).</span>
<span class="w">        </span><span class="p">.</span><span class="n">atZone</span><span class="p">(</span><span class="w"> </span><span class="n">ZoneId</span><span class="p">.</span><span class="k">of</span><span class="p">(</span><span class="w"> </span><span class="s2">"Africa/Tunis"</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Adjust</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">UTC</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">particular</span><span class="w"> </span><span class="kt">time</span><span class="w"> </span><span class="k">zone</span><span class="p">,</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">determine</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="kt">date</span><span class="p">.</span><span class="w"> </span><span class="n">Instantiating</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n n-Quoted">`ZonedDateTime`</span><span class="p">.</span>
<span class="w">        </span><span class="p">.</span><span class="n">toLocalDate</span><span class="p">()</span><span class="w">                          </span><span class="o">//</span><span class="w"> </span><span class="n">Extract</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="kt">date</span><span class="o">-</span><span class="k">only</span><span class="w"> </span><span class="n n-Quoted">`java.time.LocalDate`</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="kt">date</span><span class="o">-</span><span class="kt">time</span><span class="w"> </span><span class="n n-Quoted">`ZonedDateTime`</span><span class="w"> </span><span class="n">object</span><span class="p">.</span>
<span class="p">)</span>
</pre></div>

<p>Replacements:</p>
<ul>
<li>
<p><code>Instant</code> instead of <code>java.util.Date</code><br>
Both represent a moment in UTC. but now with nanoseconds instead of
milliseconds.</p>
</li>
<li>
<p><code>LocalDate</code> instead of <code>java.sql.Date</code><br>
Both represent a date-only value without a time of day and without a time
zone.</p>
</li>
</ul>
<h2>Details</h2>
<p>If you are trying to work with date-only values (no time-of-day, no time
zone), use the <code>LocalDate</code> class rather than <code>java.util.Date</code>.</p>
<p><img alt="Table of date-time types in Java (both legacy and modern) and in the SQL
standard." src="images/bXtIS.png"></p>
<h2>java.time</h2>
<p>In Java 8 and later, the troublesome old date-time classes bundled with early
versions of Java have been supplanted by the new java.time package. See Oracle
Tutorial. Much of the functionality has been back-ported to Java 6 &amp; 7 in
ThreeTen-Backport and further adapted to Android in ThreeTenABP.</p>
<p>A SQL data type <code>DATE</code> is meant to be date-only, with no time-of-day and no
time zone. Java never had precisely such a class† until <code>java.time.LocalDate</code>
in Java 8. Let's create such a value by getting today's date according to a
particular time zone (time zone is important in determining a date as a new
day dawns earlier in Paris than in Montréal, for example).</p>
<div class="code"><pre class="code literal-block"><span class="n">LocalDate</span><span class="w"> </span><span class="n">todayLocalDate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LocalDate</span><span class="p">.</span><span class="n">now</span><span class="p">(</span><span class="w"> </span><span class="n">ZoneId</span><span class="p">.</span><span class="n">of</span><span class="p">(</span><span class="w"> </span><span class="s">"America/Montreal"</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w">  </span><span class="c1">// Use proper "continent/region" time zone names; never use 3-4 letter codes like "EST" or "IST".</span>
</pre></div>

<p>At this point, we may be done. If your JDBC driver complies with JDBC 4.2
spec, you should be able to pass a <code>LocalDate</code> via <code>setObject</code> on a
<code>PreparedStatement</code> to store into a SQL DATE field.</p>
<div class="code"><pre class="code literal-block">myPreparedStatement.setObject( 1 , localDate );
</pre></div>

<p>Likewise, use <code>ResultSet::getObject</code> to fetch from a SQL DATE column to a Java
<code>LocalDate</code> object. Specifying the class in the second argument makes your
code type-safe.</p>
<div class="code"><pre class="code literal-block">LocalDate localDate = ResultSet.getObject( 1 , LocalDate.class );
</pre></div>

<p>In other words, <strong>this entire Question is irrelevant under JDBC 4.2</strong> or
later.</p>
<p>If your JDBC driver does not perform in this manner, you need to fall back to
converting to the java.sql types.</p>
<h2>Convert to java.sql.Date</h2>
<p>To convert, use new methods added to the old date-time classes. We can call
<code>java.sql.Date.valueOf(…)</code> to convert a <code>LocalDate</code>.</p>
<div class="code"><pre class="code literal-block">java.sql.Date sqlDate = java.sql.Date.valueOf( todayLocalDate );
</pre></div>

<p>And going the other direction.</p>
<div class="code"><pre class="code literal-block">LocalDate localDate = sqlDate.toLocalDate();
</pre></div>

<h2>Converting from <code>java.util.Date</code>
</h2>
<p>While you should avoid using the old date-time classes, you may be forced to
when working with existing code. If so, you can convert to/from java.time.</p>
<p>Go through the <code>Instant</code> class, which represents a moment on the timeline in
UTC. An <code>Instant</code> is similar in idea to a <code>java.util.Date</code>. But note that
<code>Instant</code> has a resolution up to nanoseconds while <code>java.util.Date</code> has only
milliseconds resolution.</p>
<p>To convert, use new methods added to the old classes. For example,
<code>java.util.Date.from( Instant )</code> and <code>java.util.Date::toInstant</code>.</p>
<div class="code"><pre class="code literal-block">Instant instant = myUtilDate.toInstant();
</pre></div>

<p>To determine a date, we need the context of a time zone. For any given moment,
the date varies around the globe by time zone. Apply a <code>ZoneId</code> to get a
<code>ZonedDateTime</code>.</p>
<div class="code"><pre class="code literal-block">ZoneId zoneId = ZoneId.of ( "America/Montreal" );
ZonedDateTime zdt = ZonedDateTime.ofInstant ( instant , zoneId );
LocalDate localDate = zdt.toLocalDate();
</pre></div>

<hr>
<p>† The java.sql.Date class pretends to be date-only without a time-of-day but
actually <em>does</em> a time-of-day, adjusted to a midnight time. Confusing? Yes,
the old date-time classes are a mess.</p>
<hr>
<h2>About <em>java.time</em>
</h2>
<p>The <em>java.time</em> framework is built into Java 8 and later. These classes
supplant the troublesome old legacy date-time classes such as
<code>java.util.Date</code>, <code>Calendar</code>, &amp; <code>SimpleDateFormat</code>.</p>
<p>To learn more, see the <em>Oracle Tutorial</em>. And search Stack Overflow for many
examples and explanations. Specification is JSR 310.</p>
<p>The <em>Joda-Time</em> project, now in maintenance mode, advises migration to the
java.time classes.</p>
<p>You may exchange <em>java.time</em> objects directly with your database. Use a JDBC
driver compliant with JDBC 4.2 or later. No need for strings, no need for
<code>java.sql.*</code> classes. Hibernate 5 &amp; JPA 2.2 support <em>java.time</em>.</p>
<p>Where to obtain the java.time classes?</p>
<ul>
<li>
<strong>Java SE 8</strong> , <strong>Java SE 9</strong> , <strong>Java SE 10</strong> , <strong>Java SE 11</strong> , and later - Part of the standard Java API with a bundled implementation. <ul>
<li>
<strong>Java 9</strong> brought some minor features and fixes.</li>
</ul>
</li>
<li>
<strong>Java SE 6</strong> and <strong>Java SE 7</strong><ul>
<li>Most of the <em>java.time</em> functionality is back-ported to Java 6 &amp; 7 in <em><strong>ThreeTen-Backport</strong></em>.</li>
</ul>
</li>
<li>
<strong>Android</strong><ul>
<li>Later versions of Android (26+) bundle implementations of the <em>java.time</em> classes.</li>
<li>For earlier Android (&lt;26), a process known as <em>API desugaring</em> brings a subset of the <em>java.time</em> functionality not originally built into Android. </li>
<li>If the desugaring does not offer what you need, the <em><strong>ThreeTenABP</strong></em> project adapts <em><strong>ThreeTen-Backport</strong></em> (mentioned above) to Android. See <em>How to use ThreeTenABP…</em>.</li>
</ul>
</li>
</ul>
<p><img alt="Table of which java.time library to use with which version of Java or
Android" src="images/Sksw9.png"></p>
<p>The <strong>ThreeTen-Extra</strong> project extends java.time with additional classes. This
project is a proving ground for possible future additions to java.time. You
may find some useful classes here such as <code>Interval</code>, <code>YearWeek</code>,
<code>YearQuarter</code>, and more.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-does-the-compilation-linking-process-work/" class="u-url">How does the compilation/linking process work?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-does-the-compilation-linking-process-work/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T04:33:50+08:00" itemprop="datePublished" title="2023-03-03 04:33">2023-03-03 04:33</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>How does the compilation and linking process work?</p>
<p><em>(Note: This is meant to be an entry to Stack Overflow's C++ FAQ. If you want
to critique the idea of providing an FAQ in this form, then the posting on
meta that started all this would be the place to do that. Answers to that
question are monitored in the C++ chatroom, where the FAQ idea started out in
the first place, so your answer is very likely to get read by those who came
up with the idea.)</em></p>
<p><br><br></p>
<h2>Answer</h2>
<p>The compilation of a C++ program involves three steps:</p>
<ol>
<li>
<p>Preprocessing: the preprocessor takes a C++ source code file and deals with the <code>#include</code>s, <code>#define</code>s and other preprocessor directives. The output of this step is a "pure" C++ file without pre-processor directives.</p>
</li>
<li>
<p>Compilation: the compiler takes the pre-processor's output and produces an object file from it.</p>
</li>
<li>
<p>Linking: the linker takes the object files produced by the compiler and produces either a library or an executable file.</p>
</li>
</ol>
<h2>Preprocessing</h2>
<p>The preprocessor handles the <em>preprocessor directives</em> , like <code>#include</code> and
<code>#define</code>. It is agnostic of the syntax of C++, which is why it must be used
with care.</p>
<p>It works on one C++ source file at a time by replacing <code>#include</code> directives
with the content of the respective files (which is usually just declarations),
doing replacement of macros (<code>#define</code>), and selecting different portions of
text depending of <code>#if</code>, <code>#ifdef</code> and <code>#ifndef</code> directives.</p>
<p>The preprocessor works on a stream of preprocessing tokens. Macro substitution
is defined as replacing tokens with other tokens (the operator <code>##</code> enables
merging two tokens when it makes sense).</p>
<p>After all this, the preprocessor produces a single output that is a stream of
tokens resulting from the transformations described above. It also adds some
special markers that tell the compiler where each line came from so that it
can use those to produce sensible error messages.</p>
<p>Some errors can be produced at this stage with clever use of the <code>#if</code> and
<code>#error</code> directives.</p>
<h2>Compilation</h2>
<p>The compilation step is performed on each output of the preprocessor. The
compiler parses the pure C++ source code (now without any preprocessor
directives) and converts it into assembly code. Then invokes underlying back-
end(assembler in toolchain) that assembles that code into machine code
producing actual binary file in some format(ELF, COFF, a.out, ...). This
object file contains the compiled code (in binary form) of the symbols defined
in the input. Symbols in object files are referred to by name.</p>
<p>Object files can refer to symbols that are not defined. This is the case when
you use a declaration, and don't provide a definition for it. The compiler
doesn't mind this, and will happily produce the object file as long as the
source code is well-formed.</p>
<p>Compilers usually let you stop compilation at this point. This is very useful
because with it you can compile each source code file separately. The
advantage this provides is that you don't need to recompile <em>everything</em> if
you only change a single file.</p>
<p>The produced object files can be put in special archives called static
libraries, for easier reusing later on.</p>
<p>It's at this stage that "regular" compiler errors, like syntax errors or
failed overload resolution errors, are reported.</p>
<h2>Linking</h2>
<p>The linker is what produces the final compilation output from the object files
the compiler produced. This output can be either a shared (or dynamic) library
(and while the name is similar, they haven't got much in common with static
libraries mentioned earlier) or an executable.</p>
<p>It links all the object files by replacing the references to undefined symbols
with the correct addresses. Each of these symbols can be defined in other
object files or in libraries. If they are defined in libraries other than the
standard library, you need to tell the linker about them.</p>
<p>At this stage the most common errors are missing definitions or duplicate
definitions. The former means that either the definitions don't exist (i.e.
they are not written), or that the object files or libraries where they reside
were not given to the linker. The latter is obvious: the same symbol was
defined in two different object files or libraries.</p>
<p><br></p>
<h3>Suggest</h3>
<p>This topic is discussed at CProgramming.com:<br>
https://www.cprogramming.com/compilingandlinking.html</p>
<p>Here is what the author there wrote:</p>
<blockquote>
<p>Compiling isn't quite the same as creating an executable file! Instead,
creating an executable is a multistage process divided into two components:
compilation and linking. In reality, even if a program "compiles fine" it
might not actually work because of errors during the linking phase. The
total process of going from source code files to an executable might better
be referred to as a build.</p>
<h2>Compilation</h2>
<p>Compilation refers to the processing of source code files (.c, .cc, or .cpp)
and the creation of an 'object' file. This step doesn't create anything the
user can actually run. Instead, the compiler merely produces the machine
language instructions that correspond to the source code file that was
compiled. For instance, if you compile (but don't link) three separate
files, you will have three object files created as output, each with the
name .o or .obj (the extension will depend on your compiler). Each of these
files contains a translation of your source code file into a machine
language file -- but you can't run them yet! You need to turn them into
executables your operating system can use. That's where the linker comes in.</p>
<h2>Linking</h2>
<p>Linking refers to the creation of a single executable file from multiple
object files. In this step, it is common that the linker will complain about
undefined functions (commonly, main itself). During compilation, if the
compiler could not find the definition for a particular function, it would
just assume that the function was defined in another file. If this isn't the
case, there's no way the compiler would know -- it doesn't look at the
contents of more than one file at a time. The linker, on the other hand, may
look at multiple files and try to find references for the functions that
weren't mentioned.</p>
<p>You might ask why there are separate compilation and linking steps. First,
it's probably easier to implement things that way. The compiler does its
thing, and the linker does its thing -- by keeping the functions separate,
the complexity of the program is reduced. Another (more obvious) advantage
is that this allows the creation of large programs without having to redo
the compilation step every time a file is changed. Instead, using so called
"conditional compilation", it is necessary to compile only those source
files that have changed; for the rest, the object files are sufficient input
for the linker. Finally, this makes it simple to implement libraries of pre-
compiled code: just create object files and link them just like any other
object file. (The fact that each file is compiled separately from
information contained in other files, incidentally, is called the "separate
compilation model".)</p>
<p>To get the full benefits of condition compilation, it's probably easier to
get a program to help you than to try and remember which files you've
changed since you last compiled. (You could, of course, just recompile every
file that has a timestamp greater than the timestamp of the corresponding
object file.) If you're working with an integrated development environment
(IDE) it may already take care of this for you. If you're using command line
tools, there's a nifty utility called make that comes with most *nix
distributions. Along with conditional compilation, it has several other nice
features for programming, such as allowing different compilations of your
program -- for instance, if you have a version producing verbose output for
debugging.</p>
<p>Knowing the difference between the compilation phase and the link phase can
make it easier to hunt for bugs. Compiler errors are usually syntactic in
nature -- a missing semicolon, an extra parenthesis. Linking errors usually
have to do with missing or multiple definitions. If you get an error that a
function or variable is defined multiple times from the linker, that's a
good indication that the error is that two of your source code files have
the same function or variable.</p>
</blockquote>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-1588.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-1586.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
