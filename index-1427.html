<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 1427) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-1427.html">
<link rel="prev" href="index-1428.html" type="text/html">
<link rel="next" href="index-1426.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/what-s-the-utility-theory-in-artificial-intelligence/" class="u-url">What's the utility theory in artificial intelligence?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/what-s-the-utility-theory-in-artificial-intelligence/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-28T03:38:22+08:00" itemprop="datePublished" title="2023-02-28 03:38">2023-02-28 03:38</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I have the book <em>Artificial Intelligence: A Modern Approach</em> (by Stuart
Rusell). I am reading chapter 16, "Making simple decisions", but I do not get
the main idea of the <code>utility theory</code>, can you provide a detailed example?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>The main idea of utility theory is really simple: an agent's preferences over
possible outcomes can be captured by a function that maps these outcomes to a
real number; the higher the number the more that agent likes that outcome. The
function is called a <em>utility function</em>.</p>
<p>For example, we could say that my utility for owning various items is:</p>
<div class="code"><pre class="code literal-block">u(apple) = 10
u(orange) = 12
u(basketball) = 4
u(macbookpro) = 45
</pre></div>

<p>Economists (usually) consider humans as utility-maximizing agents. That is, we
are always trying to maximize our internal utility function.</p>
<p>Once you have these numbers, then you can mix them in with probabilities and
talk about expected utilities, optimal strategies, discounted future rewards,
and many other fun things.</p>
<p>If you want to learn more, pick up a textbook on game theory, or read the
first chapter of this agents book.</p>
<p><br></p>
<h3>Suggest</h3>
<p>Dave Mark has written a whole book on utility theory for game ai:
http://www.amazon.com/Behavioral-Mathematics-Game-Dave-
Mark/dp/1584506849/ref=sr_1_1?ie=UTF8&amp;qid=1415095272&amp;sr=8-1&amp;keywords=dave+mark</p>
<p>He also has some public lectures up, along with Kevin Dill:
http://intrinsicalgorithm.com/IAonAI/2013/02/both-my-gdc-lectures-on-utility-
theory-free-on-gdc-vault/</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/the-best-way-to-calculate-the-best-threshold-with-p-viola-m-jones-framework/" class="u-url">The best way to calculate the best threshold with P. Viola, M. Jones Framework</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/the-best-way-to-calculate-the-best-threshold-with-p-viola-m-jones-framework/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-28T03:38:05+08:00" itemprop="datePublished" title="2023-02-28 03:38">2023-02-28 03:38</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I'm trying to implement P. Viola and M. Jones detection framework in C++ (at
the beginning, simply sequence classifier - not cascaded version). I think I
have designed all required class and modules (e.g Integral images, Haar
features), despite one - the most important: the AdaBoost core algorithm.</p>
<p>I have read the P. Viola and M. Jones original paper and many other
publications. Unfortunately I still don't understand how I should find the
best threshold for the one weak classifier? I have found only small references
to "weighted median" and "gaussian distribution" algorithms and many pieces of
mathematics formulas...</p>
<p>I have tried to use OpenCV Train Cascade module sources as a template, but it
is so comprehensive that doing a reverse engineering of code is very time-
consuming. I also coded my own simple code to understand the idea of Adaptive
Boosting.</p>
<p>The question is: could you explain me the best way to calculate the best
threshold for the one weak classifier?</p>
<p>Below I'm presenting the AdaBoost pseudo code, rewritten from sample found in
Google, but I'm not convinced if it's correctly approach. Calculating of one
weak classifier is very slow (few hours) and I have doubts about method of
calculating the best threshold especially.</p>
<div class="code"><pre class="code literal-block"><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">AdaBoost</span><span class="p">::</span><span class="n">FindNewWeakClassifier</span>
<span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="n">AdaBoost</span><span class="p">::</span><span class="n">CalculateFeatures</span>
<span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">AdaBoost</span><span class="p">::</span><span class="n">FindBestThreshold</span>
<span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="n">AdaBoost</span><span class="p">::</span><span class="n">FindFeatureError</span>
<span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="n">AdaBoost</span><span class="p">::</span><span class="n">NormalizeWeights</span>
<span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="n">AdaBoost</span><span class="p">::</span><span class="n">FindLowestError</span>
<span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="n">AdaBoost</span><span class="p">::</span><span class="n">ClassifyExamples</span>
<span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="n">AdaBoost</span><span class="p">::</span><span class="n">UpdateWeights</span>

<span class="n">DESCRIPTION</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="o">-</span><span class="n">Generates</span> <span class="n">all</span> <span class="n">possible</span> <span class="n">arrangement</span> <span class="n">of</span> <span class="n">features</span> <span class="n">in</span> <span class="n">detection</span> <span class="n">window</span> <span class="n">and</span> <span class="n">put</span> <span class="n">to</span> <span class="n">the</span> <span class="n">vector</span>
<span class="kr">DO</span> <span class="kr">IN</span> <span class="kr">LOOP</span>
    <span class="o">-</span><span class="n">Runs</span> <span class="n">main</span> <span class="n">calculating</span> <span class="n">function</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="kr">END</span>

<span class="n">DESCRIPTION</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="o">-</span><span class="n">Normalizes</span> <span class="n">weights</span> <span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="kr">DO</span> <span class="kr">FOR</span> <span class="mh">EACH</span> <span class="n">HAAR</span> <span class="n">FEATURE</span>
    <span class="o">-</span><span class="n">Puts</span> <span class="n">sequentially</span> <span class="n">next</span> <span class="n">feature</span> <span class="n">from</span> <span class="n">list</span> <span class="n">on</span> <span class="n">all</span> <span class="n">integral</span> <span class="n">images</span>
    <span class="o">-</span><span class="n">Finds</span> <span class="n">the</span> <span class="n">best</span> <span class="n">threshold</span> <span class="n">for</span> <span class="n">each</span> <span class="n">feature</span> <span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="o">-</span><span class="n">Finds</span> <span class="n">the</span> <span class="n">error</span> <span class="n">for</span> <span class="n">each</span> <span class="n">the</span> <span class="n">best</span> <span class="n">feature</span> <span class="n">in</span> <span class="n">current</span> <span class="n">iteration</span> <span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="o">-</span><span class="n">Saves</span> <span class="n">errors</span> <span class="n">for</span> <span class="n">each</span> <span class="n">the</span> <span class="n">best</span> <span class="n">feature</span> <span class="n">in</span> <span class="n">current</span> <span class="n">iteration</span> <span class="n">in</span> <span class="n">array</span>
    <span class="o">-</span><span class="n">Saves</span> <span class="n">threshold</span> <span class="n">for</span> <span class="n">each</span> <span class="n">the</span> <span class="n">best</span> <span class="n">feature</span> <span class="n">in</span> <span class="n">current</span> <span class="n">iteration</span> <span class="n">in</span> <span class="n">array</span>
    <span class="o">-</span><span class="n">Saves</span> <span class="n">the</span> <span class="n">threshold</span> <span class="n">sign</span> <span class="n">for</span> <span class="n">each</span> <span class="n">the</span> <span class="n">best</span> <span class="n">feature</span> <span class="n">in</span> <span class="n">current</span> <span class="n">iteration</span> <span class="n">in</span> <span class="n">array</span>
<span class="kr">END</span> <span class="kr">LOOP</span>
<span class="o">-</span><span class="n">Finds</span> <span class="n">for</span> <span class="n">classifier</span> <span class="n">index</span> <span class="n">with</span> <span class="n">the</span> <span class="n">lowest</span> <span class="n">error</span> <span class="n">selected</span> <span class="n">by</span> <span class="n">above</span> <span class="n">loop</span> <span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="o">-</span><span class="n">Gets</span> <span class="n">the</span> <span class="n">value</span> <span class="n">of</span> <span class="n">error</span> <span class="n">from</span> <span class="n">the</span> <span class="n">best</span> <span class="n">feature</span>
<span class="o">-</span><span class="n">Calculates</span> <span class="n">the</span> <span class="n">value</span> <span class="n">of</span> <span class="n">the</span> <span class="n">best</span> <span class="n">feature</span> <span class="n">in</span> <span class="n">the</span> <span class="n">all</span> <span class="n">integral</span> <span class="n">images</span> <span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="o">-</span><span class="n">Updates</span> <span class="n">weights</span> <span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="o">-</span><span class="n">Adds</span> <span class="n">new</span><span class="p">,</span> <span class="n">weak</span> <span class="n">classifier</span> <span class="n">to</span> <span class="n">vector</span>

<span class="n">DESCRIPTION</span> <span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="o">-</span><span class="n">Calculates</span> <span class="n">an</span> <span class="n">error</span> <span class="n">for</span> <span class="n">each</span> <span class="n">feature</span> <span class="n">threshold</span> <span class="n">on</span> <span class="n">positives</span> <span class="n">integral</span> <span class="n">images</span> <span class="o">-</span> <span class="n">seperate</span> <span class="n">for</span> <span class="s">"+"</span> <span class="n">and</span> <span class="s">"-"</span> <span class="n">sign</span> <span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="o">-</span><span class="n">Returns</span> <span class="n">threshold</span> <span class="n">and</span> <span class="n">sign</span> <span class="n">of</span> <span class="n">the</span> <span class="n">feature</span> <span class="n">with</span> <span class="n">the</span> <span class="n">lowest</span> <span class="n">error</span>

<span class="n">DESCRIPTION</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="o">-</span> <span class="n">Returns</span> <span class="n">feature</span> <span class="n">error</span> <span class="n">for</span> <span class="n">all</span> <span class="n">samples</span><span class="p">,</span> <span class="n">by</span> <span class="n">calculating</span> <span class="n">inequality</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">sign</span> <span class="o">&lt;</span> <span class="n">sign</span> <span class="o">*</span> <span class="n">threshold</span>

<span class="n">DESCRIPTION</span> <span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="o">-</span><span class="n">Ensures</span> <span class="n">that</span> <span class="n">samples</span> <span class="n">weights</span> <span class="n">are</span> <span class="n">probability</span> <span class="n">distribution</span>

<span class="n">DESCRIPTION</span> <span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="o">-</span><span class="n">Finds</span> <span class="n">the</span> <span class="n">classifier</span> <span class="n">with</span> <span class="n">the</span> <span class="n">lowest</span> <span class="n">error</span>

<span class="n">DESCRIPTION</span> <span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="o">-</span><span class="n">Calculates</span> <span class="n">a</span> <span class="n">value</span> <span class="n">of</span> <span class="n">the</span> <span class="n">best</span> <span class="n">features</span> <span class="n">at</span> <span class="n">all</span> <span class="n">integral</span> <span class="n">images</span>
<span class="o">-</span><span class="n">Counts</span> <span class="n">false</span> <span class="n">positives</span> <span class="n">number</span> <span class="n">and</span> <span class="n">false</span> <span class="n">negatives</span> <span class="n">number</span>

<span class="n">DESCRIPTION</span> <span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="o">-</span><span class="n">Corrects</span> <span class="n">weights</span><span class="p">,</span> <span class="n">depending</span> <span class="n">on</span> <span class="n">classification</span> <span class="n">results</span>
</pre></div>

<p>Thank you for any help</p>
<p><br><br></p>
<h2>Answer</h2>
<p>In the original viola-Jones paper here, section 3.1 Learning Discussion (para
4, to be precise) you will find out the procedure to find optimal threshold.</p>
<p>I'll sum up the method quickly below.</p>
<hr>
<p>Optimal threshold for each feature is sample-weight dependent and therefore
calculated in very iteration of adaboost. The best weak classifier's threshold
is saved as mentioned in the pseudo code.</p>
<p>In every round, for each weak classifier, you have to arrange the N training
samples according to the feature value. Putting a threshold will separate this
sequence in 2 parts. Both parts will have either positive or negative samples
in majority along with a few samples of other type.</p>
<ul>
<li>
<code>T+</code> : total sum of positive sample weights </li>
<li>
<code>T-</code> : total sum of negative sample weights </li>
<li>
<code>S+</code> : sum of positive sample weights below the threshold </li>
<li>
<code>S-</code> : sum of negative sample weights below the threshold </li>
</ul>
<p>Error for this particular threshold is -</p>
<div class="code"><pre class="code literal-block">e = MIN((S+) + (T-) - (S-), (S-) + (T+) - (S+))
</pre></div>

<p>Why the minimum? here's an example:<br>
If the samples and threshold is like this -</p>
<div class="code"><pre class="code literal-block">+ + + + + - - | + + - - - - -
</pre></div>

<p>In the first round, if all weights are equal(=w), taking the minimum will give
you the error of <code>4*w</code>, instead of <code>10*w</code>.</p>
<p>You calculate this error for all N possible ways of separating the samples.<br>
The minimum error will give you the range of threshold values. The actual
threshold is probably the average of the adjacent feature values (I'm not sure
though, do some research on this).<br>
This was the second step in your <code>DO FOR EACH HAAR FEATURE</code> loop.<br>
The cascades given along with OpenCV were created by Rainer Lienhart and I
don't know what method he used. You could closely follow the OpenCV source
codes to get any further improvements on this procedure.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/intuition-behind-u-net-vs-fcn-for-semantic-segmentation/" class="u-url">Intuition behind U-net vs FCN for semantic segmentation</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/intuition-behind-u-net-vs-fcn-for-semantic-segmentation/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-28T03:37:44+08:00" itemprop="datePublished" title="2023-02-28 03:37">2023-02-28 03:37</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I don't quite understand the following:</p>
<p>In the proposed FCN for Semantic Segmentation by Shelhamer et al, they propose
a pixel-to-pixel prediction to construct masks/exact locations of objects in
an image.</p>
<p>In the slightly modified version of the FCN for biomedical image segmentation,
the U-net, the main difference seems to be "a concatenation with the
correspondingly cropped feature map from the contracting path."</p>
<p>Now, why does this feature make a difference particularly for biomedical
segmentation? The main differences I can point out for biomedical images vs
other data sets is that in biomedical images there are not as rich set of
features defining an object as for common every day objects. Also the size of
the data set is limited. But is this extra feature inspired by these two facts
or some other reason?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>FCN vs U-Net:</p>
<p>FCN</p>
<ol>
<li>It upsamples only once. i.e. it has only one layer in the decoder</li>
<li>The original implementation github repo uses bilinear interpolation for upsampling the convoloved image. That is there is no learnable filter here</li>
<li>variants of FCN-[FCN 16s and FCN 8s] add the skip connections from lower layers to make the output robust to scale changes</li>
</ol>
<hr>
<p>U-Net</p>
<ol>
<li>multiple upsampling layers</li>
<li>uses skip connections and concatenates instead of adding up</li>
<li>uses learnable weight filters instead of fixed interpolation technique </li>
</ol>
</div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-1428.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-1426.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
