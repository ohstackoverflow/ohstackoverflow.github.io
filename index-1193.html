<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 1193) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-1193.html">
<link rel="prev" href="index-1194.html" type="text/html">
<link rel="next" href="index-1192.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/where-does-postgresql-store-configuration-conf-files/" class="u-url">Where does PostgreSQL store configuration/conf files?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/where-does-postgresql-store-configuration-conf-files/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T03:27:21+08:00" itemprop="datePublished" title="2023-02-18 03:27">2023-02-18 03:27</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I have recently installed PostgreSQL on Ubuntu with the EnterpriseDB package.
I can connect to the database locally, but I can't configure it because I
can't find config files. I searched through entire hard drive and found only
samples like <code>pg_hba.conf.sample</code></p>
<p>Where are the PostgreSQL <code>.conf</code> files?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Or ask your database:</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span>psql<span class="w"> </span>-U<span class="w"> </span>postgres<span class="w"> </span>-c<span class="w"> </span><span class="s1">'SHOW config_file'</span>
</pre></div>

<p>or, if logged in as the <code>ubuntu</code> user:</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span>sudo<span class="w"> </span>-u<span class="w"> </span>postgres<span class="w"> </span>psql<span class="w"> </span>-c<span class="w"> </span><span class="s1">'SHOW config_file'</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p><code>Ubuntu 13.04</code> installed using software centre :</p>
<p>The location for mine is:</p>
<div class="code"><pre class="code literal-block">/etc/postgresql/9.1/main/postgresql.conf
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-do-i-use-hexadecimal-color-strings-in-flutter/" class="u-url">How do I use hexadecimal color strings in Flutter?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-do-i-use-hexadecimal-color-strings-in-flutter/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T03:26:52+08:00" itemprop="datePublished" title="2023-02-18 03:26">2023-02-18 03:26</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>How do I convert a <em>hexadecimal color string</em> like <strong><code>#b74093</code></strong> to a <code>Color</code>
in Flutter?</p>
<p>I want to use a HEX color code in Dart.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>In Flutter, the <strong><code>Color</code> class</strong> only accepts <em><strong>integers</strong> as parameters</em>,
or there is the possibility to use the named constructors <code>fromARGB</code> and
<code>fromRGBO</code>.</p>
<p>So we only need to convert the string <code>#b74093</code> to an integer value. Also we
need to respect that <strong>opacity</strong> always needs to be specified.<br><code>255</code> (full) opacity is represented by the hexadecimal value <code>FF</code>. This
already leaves us with <strong><code>0xFF</code></strong>. Now, we just need to append our color
string like this:</p>
<div class="code"><pre class="code literal-block"><span class="n">const</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="mh">0xffb74093</span><span class="p">);</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="k">Second</span><span class="w"> </span><span class="n n-Quoted">`const`</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">optional</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">assignments</span><span class="p">.</span>
</pre></div>

<p>The letters can by choice be capitalized or not:</p>
<div class="code"><pre class="code literal-block"><span class="k">const</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="nb nb-Type">Color</span><span class="p">(</span><span class="mh">0xFFB74093</span><span class="p">);</span>
</pre></div>

<hr>
<p>If you want to use <em>percentage opacity values</em> , you can replace the first
<code>FF</code> with the values from this table (also works for the other color
channels).</p>
<h3>Extension class</h3>
<p>Starting with Dart <code>2.6.0</code>, you can create an <code>extension</code> for the <code>Color</code>
class that lets you use hexadecimal color strings to create a <code>Color</code> object:</p>
<div class="code"><pre class="code literal-block"><span class="n">extension</span><span class="w"> </span><span class="n">HexColor</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">Color</span><span class="w"> </span><span class="err">{</span>
<span class="w">  </span><span class="o">///</span><span class="w"> </span><span class="k">String</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">format</span><span class="w"> </span><span class="s2">"aabbcc"</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="s2">"ffaabbcc"</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="k">optional</span><span class="w"> </span><span class="k">leading</span><span class="w"> </span><span class="s2">"#"</span><span class="p">.</span>
<span class="w">  </span><span class="n">static</span><span class="w"> </span><span class="n">Color</span><span class="w"> </span><span class="n">fromHex</span><span class="p">(</span><span class="k">String</span><span class="w"> </span><span class="n">hexString</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="n">final</span><span class="w"> </span><span class="n">buffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">StringBuffer</span><span class="p">();</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">hexString</span><span class="p">.</span><span class="n">length</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">hexString</span><span class="p">.</span><span class="n">length</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">7</span><span class="p">)</span><span class="w"> </span><span class="n">buffer</span><span class="p">.</span><span class="k">write</span><span class="p">(</span><span class="s1">'ff'</span><span class="p">);</span>
<span class="w">    </span><span class="n">buffer</span><span class="p">.</span><span class="k">write</span><span class="p">(</span><span class="n">hexString</span><span class="p">.</span><span class="n">replaceFirst</span><span class="p">(</span><span class="s1">'#'</span><span class="p">,</span><span class="w"> </span><span class="s1">''</span><span class="p">));</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Color</span><span class="p">(</span><span class="kt">int</span><span class="p">.</span><span class="n">parse</span><span class="p">(</span><span class="n">buffer</span><span class="p">.</span><span class="n">toString</span><span class="p">(),</span><span class="w"> </span><span class="n">radix</span><span class="o">:</span><span class="w"> </span><span class="mi">16</span><span class="p">));</span>
<span class="w">  </span><span class="err">}</span>

<span class="w">  </span><span class="o">///</span><span class="w"> </span><span class="n">Prefixes</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">hash</span><span class="w"> </span><span class="n">sign</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="err">[</span><span class="n">leadingHashSign</span><span class="err">]</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n n-Quoted">`true`</span><span class="w"> </span><span class="p">(</span><span class="k">default</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n n-Quoted">`true`</span><span class="p">).</span>
<span class="w">  </span><span class="k">String</span><span class="w"> </span><span class="n">toHex</span><span class="p">(</span><span class="err">{</span><span class="kt">bool</span><span class="w"> </span><span class="n">leadingHashSign</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">true</span><span class="err">}</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">'${leadingHashSign ? '</span><span class="c1">#' : ''}'</span>
<span class="w">      </span><span class="s1">'${alpha.toRadixString(16).padLeft(2, '</span><span class="mi">0</span><span class="s1">')}'</span>
<span class="w">      </span><span class="s1">'${red.toRadixString(16).padLeft(2, '</span><span class="mi">0</span><span class="s1">')}'</span>
<span class="w">      </span><span class="s1">'${green.toRadixString(16).padLeft(2, '</span><span class="mi">0</span><span class="s1">')}'</span>
<span class="w">      </span><span class="s1">'${blue.toRadixString(16).padLeft(2, '</span><span class="mi">0</span><span class="s1">')}'</span><span class="p">;</span>
<span class="err">}</span>
</pre></div>

<p>The <code>fromHex</code> method could also be declared in a <code>mixin</code> or <code>class</code> because
the <code>HexColor</code> name needs to be explicitly specified in order to use it, but
the extension is useful for the <code>toHex</code> method, which can be used implicitly.
Here is an example:</p>
<div class="code"><pre class="code literal-block"><span class="nb nb-Type">void</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">final</span><span class="w"> </span><span class="nb nb-Type">Color</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HexColor</span><span class="o">.</span><span class="n">fromHex</span><span class="p">(</span><span class="s1">'#aabbcc'</span><span class="p">);</span>

<span class="w">  </span><span class="nb">print</span><span class="p">(</span><span class="n">color</span><span class="o">.</span><span class="n">toHex</span><span class="p">());</span>
<span class="w">  </span><span class="nb">print</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="nb nb-Type">Color</span><span class="p">(</span><span class="mh">0xffaabbcc</span><span class="p">)</span><span class="o">.</span><span class="n">toHex</span><span class="p">());</span>
<span class="p">}</span>
</pre></div>

<h4>Disadvantage of using hex strings</h4>
<p>Many of the other answers here show how you can dynamically create a <code>Color</code>
from a hex string, like I did above. However, doing this means that the color
cannot be a <code>const</code>.<br>
Ideally, you would assign your colors the way I explained in the first part of
this answer, which is more efficient when instantiating colors a lot, which is
usually the case for Flutter widgets.</p>
<p><br></p>
<h3>Suggest</h3>
<p>The <code>Color</code> class expects an ARGB integer. Since you try to use it with an
<em>RGB</em> value, represent it as <em>int</em> and prefix it with <code>0xff</code>.</p>
<div class="code"><pre class="code literal-block">Color mainColor = Color(0xffb74093);
</pre></div>

<hr>
<p>If you get annoyed by this and still wish to use strings, you can extend
<code>Color</code> and add a string constructor</p>
<div class="code"><pre class="code literal-block"><span class="k">class</span><span class="w"> </span><span class="n">HexColor</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="nb nb-Type">Color</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">static</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">_getColorFromHex</span><span class="p">(</span><span class="nb nb-Type">String</span><span class="w"> </span><span class="n">hexColor</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">hexColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hexColor</span><span class="o">.</span><span class="n">toUpperCase</span><span class="p">()</span><span class="o">.</span><span class="n">replaceAll</span><span class="p">(</span><span class="s2">"#"</span><span class="p">,</span><span class="w"> </span><span class="s2">""</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">hexColor</span><span class="o">.</span><span class="n">length</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">hexColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"FF"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">hexColor</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">hexColor</span><span class="p">,</span><span class="w"> </span><span class="n">radix</span><span class="p">:</span><span class="w"> </span><span class="mi">16</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">HexColor</span><span class="p">(</span><span class="n">final</span><span class="w"> </span><span class="nb nb-Type">String</span><span class="w"> </span><span class="n">hexColor</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">super</span><span class="p">(</span><span class="n">_getColorFromHex</span><span class="p">(</span><span class="n">hexColor</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>

<p>Usage</p>
<div class="code"><pre class="code literal-block"><span class="nv">Color</span><span class="w"> </span><span class="nv">color1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">HexColor</span><span class="ss">(</span><span class="s2">"b74093"</span><span class="ss">)</span><span class="c1">;</span>
<span class="nv">Color</span><span class="w"> </span><span class="nv">color2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">HexColor</span><span class="ss">(</span><span class="s2">"#b74093"</span><span class="ss">)</span><span class="c1">;</span>
<span class="nv">Color</span><span class="w"> </span><span class="nv">color3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">HexColor</span><span class="ss">(</span><span class="s2">"#88b74093"</span><span class="ss">)</span><span class="c1">; // If you wish to use ARGB format</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-get-elmah-to-work-with-asp-net-mvc-handleerror-attribute/" class="u-url">How to get ELMAH to work with ASP.NET MVC [HandleError] attribute?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-get-elmah-to-work-with-asp-net-mvc-handleerror-attribute/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T03:26:24+08:00" itemprop="datePublished" title="2023-02-18 03:26">2023-02-18 03:26</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I am trying to use ELMAH to log errors in my ASP.NET MVC application, however
when I use the [HandleError] attribute on my controllers ELMAH doesn't log any
errors when they occur.</p>
<p>As I am guessing its because ELMAH only logs unhandled errors and the
[HandleError] attribute is handling the error so thus no need to log it.</p>
<p>How do I modify or how would I go about modifying the attribute so ELMAH can
know that there was an error and log it..</p>
<p><strong>Edit:</strong> Let me make sure everyone understands, I know I can modify the
attribute thats not the question I'm asking... ELMAH gets bypassed when using
the handleerror attribute meaning it won't see that there was an error because
it was handled already by the attribute... What I am asking is there a way to
make ELMAH see the error and log it even though the attribute handled it...I
searched around and don't see any methods to call to force it to log the
error....</p>
<p><br><br></p>
<h2>Answer</h2>
<p>You can subclass <code>HandleErrorAttribute</code> and override its <code>OnException</code> member
(no need to copy) so that it logs the exception with ELMAH and only if the
base implementation handles it. The minimal amount of code you need is as
follows:</p>
<div class="code"><pre class="code literal-block"><span class="n">using</span><span class="w"> </span><span class="n">System</span><span class="o">.</span><span class="n">Web</span><span class="o">.</span><span class="n">Mvc</span><span class="p">;</span>
<span class="n">using</span><span class="w"> </span><span class="n">Elmah</span><span class="p">;</span>

<span class="n">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">HandleErrorAttribute</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">System</span><span class="o">.</span><span class="n">Web</span><span class="o">.</span><span class="n">Mvc</span><span class="o">.</span><span class="n">HandleErrorAttribute</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">public</span><span class="w"> </span><span class="n">override</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="w"> </span><span class="n">OnException</span><span class="p">(</span><span class="n">ExceptionContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">base</span><span class="o">.</span><span class="n">OnException</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">context</span><span class="o">.</span><span class="n">ExceptionHandled</span><span class="p">)</span><span class="w"> </span>
<span class="w">            </span><span class="k">return</span><span class="p">;</span>
<span class="w">        </span><span class="k">var</span><span class="w"> </span><span class="n">httpContext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">context</span><span class="o">.</span><span class="n">HttpContext</span><span class="o">.</span><span class="n">ApplicationInstance</span><span class="o">.</span><span class="n">Context</span><span class="p">;</span>
<span class="w">        </span><span class="k">var</span><span class="w"> </span><span class="k">signal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ErrorSignal</span><span class="o">.</span><span class="n">FromContext</span><span class="p">(</span><span class="n">httpContext</span><span class="p">);</span>
<span class="w">        </span><span class="k">signal</span><span class="o">.</span><span class="n">Raise</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">Exception</span><span class="p">,</span><span class="w"> </span><span class="n">httpContext</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p>The base implementation is invoked first, giving it a chance to mark the
exception as being handled. Only then is the exception signaled. The above
code is simple and may cause issues if used in an environment where the
<code>HttpContext</code> may not be available, such as testing. As a result, you will
want code that is that is more defensive (at the cost of being slightly
longer):</p>
<div class="code"><pre class="code literal-block"><span class="n">using</span><span class="w"> </span><span class="n">System</span><span class="o">.</span><span class="n">Web</span><span class="p">;</span>
<span class="n">using</span><span class="w"> </span><span class="n">System</span><span class="o">.</span><span class="n">Web</span><span class="o">.</span><span class="n">Mvc</span><span class="p">;</span>
<span class="n">using</span><span class="w"> </span><span class="n">Elmah</span><span class="p">;</span>

<span class="n">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">HandleErrorAttribute</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">System</span><span class="o">.</span><span class="n">Web</span><span class="o">.</span><span class="n">Mvc</span><span class="o">.</span><span class="n">HandleErrorAttribute</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">public</span><span class="w"> </span><span class="n">override</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="w"> </span><span class="n">OnException</span><span class="p">(</span><span class="n">ExceptionContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">base</span><span class="o">.</span><span class="n">OnException</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">context</span><span class="o">.</span><span class="n">ExceptionHandled</span><span class="w">       </span><span class="o">//</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">unhandled</span><span class="p">,</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">logged</span><span class="w"> </span><span class="n">anyhow</span>
<span class="w">            </span><span class="o">||</span><span class="w"> </span><span class="n">TryRaiseErrorSignal</span><span class="p">(</span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">prefer</span><span class="w"> </span><span class="n">signaling</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">possible</span>
<span class="w">            </span><span class="o">||</span><span class="w"> </span><span class="n">IsFiltered</span><span class="p">(</span><span class="n">context</span><span class="p">))</span><span class="w">         </span><span class="o">//</span><span class="w"> </span><span class="n">filtered</span><span class="err">?</span>
<span class="w">            </span><span class="k">return</span><span class="p">;</span>

<span class="w">        </span><span class="n">LogException</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">private</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="nb nb-Type">bool</span><span class="w"> </span><span class="n">TryRaiseErrorSignal</span><span class="p">(</span><span class="n">ExceptionContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">var</span><span class="w"> </span><span class="n">httpContext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetHttpContextImpl</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">HttpContext</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">httpContext</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb nb-Type">null</span><span class="p">)</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="bp">false</span><span class="p">;</span>
<span class="w">        </span><span class="k">var</span><span class="w"> </span><span class="k">signal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ErrorSignal</span><span class="o">.</span><span class="n">FromContext</span><span class="p">(</span><span class="n">httpContext</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">signal</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb nb-Type">null</span><span class="p">)</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="bp">false</span><span class="p">;</span>
<span class="w">        </span><span class="k">signal</span><span class="o">.</span><span class="n">Raise</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">Exception</span><span class="p">,</span><span class="w"> </span><span class="n">httpContext</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="bp">true</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">private</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="nb nb-Type">bool</span><span class="w"> </span><span class="n">IsFiltered</span><span class="p">(</span><span class="n">ExceptionContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">var</span><span class="w"> </span><span class="n">config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">context</span><span class="o">.</span><span class="n">HttpContext</span><span class="o">.</span><span class="n">GetSection</span><span class="p">(</span><span class="s2">"elmah/errorFilter"</span><span class="p">)</span>
<span class="w">                        </span><span class="k">as</span><span class="w"> </span><span class="n">ErrorFilterConfiguration</span><span class="p">;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">config</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb nb-Type">null</span><span class="p">)</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="bp">false</span><span class="p">;</span>

<span class="w">        </span><span class="k">var</span><span class="w"> </span><span class="n">testContext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">ErrorFilterModule</span><span class="o">.</span><span class="n">AssertionHelperContext</span><span class="p">(</span>
<span class="w">                              </span><span class="n">context</span><span class="o">.</span><span class="n">Exception</span><span class="p">,</span><span class="w"> </span>
<span class="w">                              </span><span class="n">GetHttpContextImpl</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">HttpContext</span><span class="p">));</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">config</span><span class="o">.</span><span class="n">Assertion</span><span class="o">.</span><span class="n">Test</span><span class="p">(</span><span class="n">testContext</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">private</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="w"> </span><span class="n">LogException</span><span class="p">(</span><span class="n">ExceptionContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">var</span><span class="w"> </span><span class="n">httpContext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetHttpContextImpl</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">HttpContext</span><span class="p">);</span>
<span class="w">        </span><span class="k">var</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">Error</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">Exception</span><span class="p">,</span><span class="w"> </span><span class="n">httpContext</span><span class="p">);</span>
<span class="w">        </span><span class="n">ErrorLog</span><span class="o">.</span><span class="n">GetDefault</span><span class="p">(</span><span class="n">httpContext</span><span class="p">)</span><span class="o">.</span><span class="n">Log</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">private</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">HttpContext</span><span class="w"> </span><span class="n">GetHttpContextImpl</span><span class="p">(</span><span class="n">HttpContextBase</span><span class="w"> </span><span class="n">context</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">context</span><span class="o">.</span><span class="n">ApplicationInstance</span><span class="o">.</span><span class="n">Context</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p>This second version will try to use error signaling from ELMAH first, which
involves the fully configured pipeline like logging, mailing, filtering and
what have you. Failing that, it attempts to see whether the error should be
filtered. If not, the error is simply logged. This implementation does not
handle mail notifications. If the exception can be signaled then a mail will
be sent if configured to do so.</p>
<p>You may also have to take care that if multiple <code>HandleErrorAttribute</code>
instances are in effect then duplicate logging does not occur, but the above
two examples should get your started.</p>
<p><br></p>
<h3>Suggest</h3>
<p>Sorry, but I think the accepted answer is an overkill. All you need to do is
this:</p>
<div class="code"><pre class="code literal-block"><span class="nv">public</span><span class="w"> </span><span class="nv">class</span><span class="w"> </span><span class="nv">ElmahHandledErrorLoggerFilter</span><span class="w"> </span>:<span class="w"> </span><span class="nv">IExceptionFilter</span>
{
<span class="w">    </span><span class="nv">public</span><span class="w"> </span><span class="nv">void</span><span class="w"> </span><span class="nv">OnException</span><span class="w"> </span><span class="ss">(</span><span class="nv">ExceptionContext</span><span class="w"> </span><span class="nv">context</span><span class="ss">)</span>
<span class="w">    </span>{
<span class="w">        </span><span class="o">//</span><span class="w"> </span><span class="nv">Log</span><span class="w"> </span><span class="nv">only</span><span class="w"> </span><span class="nv">handled</span><span class="w"> </span><span class="nv">exceptions</span>,<span class="w"> </span><span class="nv">because</span><span class="w"> </span><span class="nv">all</span><span class="w"> </span><span class="nv">other</span><span class="w"> </span><span class="nv">will</span><span class="w"> </span><span class="nv">be</span><span class="w"> </span><span class="nv">caught</span><span class="w"> </span><span class="nv">by</span><span class="w"> </span><span class="nv">ELMAH</span><span class="w"> </span><span class="nv">anyway</span>.
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">context</span>.<span class="nv">ExceptionHandled</span><span class="ss">)</span>
<span class="w">            </span><span class="nv">ErrorSignal</span>.<span class="nv">FromCurrentContext</span><span class="ss">()</span>.<span class="nv">Raise</span><span class="ss">(</span><span class="nv">context</span>.<span class="nv">Exception</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">    </span>}
}
</pre></div>

<p>and then register it (order is important) in Global.asax.cs:</p>
<div class="code"><pre class="code literal-block">public static void RegisterGlobalFilters (GlobalFilterCollection filters)
{
    filters.Add(new ElmahHandledErrorLoggerFilter());
    filters.Add(new HandleErrorAttribute());
}
</pre></div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-1194.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-1192.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
