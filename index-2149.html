<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 2149) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-2149.html">
<link rel="prev" href="index-2150.html" type="text/html">
<link rel="next" href="index-2148.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-execute-a-function-when-page-has-fully-loaded/" class="u-url">How to execute a function when page has fully loaded?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-execute-a-function-when-page-has-fully-loaded/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T18:37:42+08:00" itemprop="datePublished" title="2023-03-03 18:37">2023-03-03 18:37</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I need to execute some JavaScript code when the page has fully loaded. This
includes things like images.</p>
<p>I know you can check if the DOM is ready, but I don’t know if this is the same
as when the page is fully loaded.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>That's called <code>load</code>. It came waaaaay before DOM ready was around, and DOM
ready was actually created for the exact reason that <code>load</code> waited on images.</p>
<div class="code"><pre class="code literal-block"><span class="n">window</span><span class="o">.</span><span class="n">addEventListener</span><span class="p">(</span><span class="s1">'load'</span><span class="p">,</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">alert</span><span class="p">(</span><span class="s2">"It's loaded!"</span><span class="p">)</span>
<span class="p">})</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>For completeness sake, you might also want to bind it to DOMContentLoaded,
which is now widely supported</p>
<div class="code"><pre class="code literal-block">document.addEventListener("DOMContentLoaded", function(event){
  // your code here
});
</pre></div>

<p>More info: https://developer.mozilla.org/en-
US/docs/Web/Events/DOMContentLoaded</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/javascript-hashmap-equivalent/" class="u-url">JavaScript hashmap equivalent</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/javascript-hashmap-equivalent/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T18:35:28+08:00" itemprop="datePublished" title="2023-03-03 18:35">2023-03-03 18:35</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>As made clear in update 3 on this answer, this notation:</p>
<div class="code"><pre class="code literal-block"><span class="nf">var</span><span class="w"> </span><span class="n">hash</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{}</span><span class="p">;</span>
<span class="n">hash</span><span class="o">[</span><span class="n">X</span><span class="o">]</span>
</pre></div>

<p>does not actually hash the object <code>X</code>; it actually just converts <code>X</code> to a
string (via <code>.toString()</code> if it's an object, or some other built-in
conversions for various primitive types) and then looks that string up,
without hashing it, in "<code>hash</code>". Object equality is also not checked - if two
different objects have the same string conversion, they will just overwrite
each other.</p>
<p>Given this - are there any efficient implementations of hashmaps in
JavaScript?</p>
<p>(For example, the second Google result of <code>javascript hashmap</code> yields an
implementation which is O(n) for any operation. Various other results ignore
the fact that different objects with equivalent string representations
overwrite each other.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Hash your objects yourself manually, and use the resulting strings as keys for
a regular JavaScript dictionary. After all, you are in the best position to
know what makes your objects unique. That's what I do.</p>
<p>Example:</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">function</span><span class="p">(</span><span class="n">obj</span><span class="p">){</span>
<span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Some</span><span class="w"> </span><span class="n">unique</span><span class="w"> </span><span class="n">object</span><span class="o">-</span><span class="n">dependent</span><span class="w"> </span><span class="n">key</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">obj</span><span class="o">.</span><span class="n">totallyUniqueEmployeeIdKey</span><span class="p">;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">Just</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">example</span>
<span class="p">};</span>

<span class="k">var</span><span class="w"> </span><span class="n">dict</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{};</span>

<span class="n">dict</span><span class="p">[</span><span class="n">key</span><span class="p">(</span><span class="n">obj1</span><span class="p">)]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obj1</span><span class="p">;</span>
<span class="n">dict</span><span class="p">[</span><span class="n">key</span><span class="p">(</span><span class="n">obj2</span><span class="p">)]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obj2</span><span class="p">;</span>
</pre></div>

<p>This way you can control indexing done by JavaScript without heavy lifting of
memory allocation, and overflow handling.</p>
<p>Of course, if you truly want the "industrial-grade solution", you can build a
class parameterized by the key function, and with all the necessary API of the
container, but … we use JavaScript, and trying to be simple and lightweight,
so this functional solution is simple and fast.</p>
<p>The key function can be as simple as selecting right attributes of the object,
e.g., a key, or a set of keys, which are already unique, a combination of
keys, which are unique together, or as complex as using some cryptographic
hashes like in DojoX encoding, or DojoX UUID. While the latter solutions may
produce unique keys, personally I try to avoid them at all costs, especially,
if I know what makes my objects unique.</p>
<p><strong>Update in 2014:</strong> Answered back in 2008 this simple solution still requires
more explanations. Let me clarify the idea in a Q&amp;A form.</p>
<p><em>Your solution doesn't have a real hash. Where is it???</em></p>
<p>JavaScript is a high-level language. Its basic primitive (Object) includes a
hash table to keep properties. This hash table is usually written in a low-
level language for efficiency. Using a simple object with string keys we use
an efficiently implemented hash table without any efforts on our part.</p>
<p><em>How do you know they use a hash?</em></p>
<p>There are three major ways to keep a collection of objects addressable by a
key:</p>
<ul>
<li>Unordered. In this case to retrieve an object by its key we have to go over all keys stopping when we find it. On average it will take n/2 comparisons.</li>
<li>Ordered. <ul>
<li>Example #1: a sorted array — doing a binary search we will find our key after ~log2(n) comparisons on average. Much better.</li>
<li>Example #2: a tree. Again it'll be ~log(n) attempts.</li>
</ul>
</li>
<li>Hash table. On average, it requires a constant time. Compare: O(n) vs. O(log n) vs. O(1). Boom.</li>
</ul>
<p>Obviously JavaScript objects use hash tables in some form to handle general
cases.</p>
<p><em>Do browser vendors really use hash tables???</em></p>
<p>Really.</p>
<ul>
<li>Chrome/node.js/V8: JSObject. Look for NameDictionary and NameDictionaryShape with pertinent details in objects.cc and objects-inl.h.</li>
<li>Firefox/Gecko: JSObject, NativeObject, and PlainObject with pertinent details in jsobj.cpp and vm/NativeObject.cpp.</li>
</ul>
<p><em>Do they handle collisions?</em></p>
<p>Yes. See above. If you found a collision on unequal strings, please do not
hesitate to file a bug with a vendor.</p>
<p><em>So what is your idea?</em></p>
<p>If you want to hash an object, find what makes it unique and use it as a key.
Do not try to calculate a real hash or emulate hash tables — it is already
efficiently handled by the underlying JavaScript object.</p>
<p>Use this key with JavaScript's <code>Object</code> to leverage its built-in hash table
while steering clear of possible clashes with default properties.</p>
<p>Examples to get you started:</p>
<ul>
<li>If your objects include a unique user name — use it as a key.</li>
<li>If it includes a unique customer number — use it as a key. <ul>
<li>If it includes unique government-issued numbers like US SSNs, or a passport number, and your system doesn't allow duplicates — use it as a key.</li>
</ul>
</li>
<li>If a combination of fields is unique — use it as a key. <ul>
<li>US state abbreviation + driver license number makes an excellent key.</li>
<li>Country abbreviation + passport number is an excellent key too.</li>
</ul>
</li>
<li>Some function on fields, or a whole object, can return a unique value — use it as a key.</li>
</ul>
<p><em>I used your suggestion and cached all objects using a user name. But some
wise guy is named "toString", which is a built-in property! What should I do
now?</em></p>
<p>Obviously, if it is even remotely possible that the resulting key will
exclusively consists of Latin characters, you should do something about it.
For example, add any non-Latin Unicode character you like at the beginning or
at the end to un-clash with default properties: "#toString", "#MarySmith". If
a composite key is used, separate key components using some kind of non-Latin
delimiter: "name,city,state".</p>
<p>In general, this is the place where we have to be creative and select the
easiest keys with given limitations (uniqueness, potential clashes with
default properties).</p>
<p>Note: unique keys do not clash by definition, while potential hash clashes
will be handled by the underlying <code>Object</code>.</p>
<p><em>Why don't you like industrial solutions?</em></p>
<p>IMHO, the best code is no code at all: it has no errors, requires no
maintenance, easy to understand, and executes instantaneously. All "hash
tables in JavaScript" I saw were &gt;100 lines of code, and involved multiple
objects. Compare it with: <code>dict[key] = value</code>.</p>
<p>Another point: is it even possible to beat a performance of a primordial
object written in a low-level language, using JavaScript and the very same
primordial objects to implement what is already implemented?</p>
<p><em>I still want to hash my objects without any keys!</em></p>
<p>We are in luck: ECMAScript 6 (released in June 2015) defines map and set.</p>
<p>Judging by the definition, they can use an object's address as a key, which
makes objects instantly distinct without artificial keys. OTOH, two different,
yet identical objects, will be mapped as distinct.</p>
<p>Comparison breakdown from MDN:</p>
<blockquote>
<p>Objects are similar to Maps in that both let you set keys to values,
retrieve those values, delete keys, and detect whether something is stored
at a key. Because of this (and because there were no built-in alternatives),
Objects have been used as Maps historically; however, there are important
differences that make using a Map preferable in certain cases:</p>
<ul>
<li>The keys of an Object are Strings and Symbols, whereas they can be any
value for a Map, including functions, objects, and any primitive.</li>
<li>The keys in Map are ordered while keys added to object are not. Thus,
when iterating over it, a Map object returns keys in order of insertion.</li>
<li>You can get the size of a Map easily with the size property, while the
number of properties in an Object must be determined manually.</li>
<li>A Map is an iterable and can thus be directly iterated, whereas
iterating over an Object requires obtaining its keys in some fashion and
iterating over them.</li>
<li>An Object has a prototype, so there are default keys in the map that
could collide with your keys if you're not careful. As of ES5 this can be
bypassed by using map = Object.create(null), but this is seldom done.</li>
<li>A Map may perform better in scenarios involving frequent addition and
removal of key pairs.
</li>
</ul>
</blockquote>
<p><br></p>
<h3>Suggest</h3>
<h2>Problem description</h2>
<p>JavaScript has no built-in general <em>map</em> type (sometimes called <em>associative
array</em> or <em>dictionary</em> ) which allows to access arbitrary values by arbitrary
keys. JavaScript's fundamental data structure is the <em>object</em> , a special type
of map which only accepts strings as keys and has special semantics like
prototypical inheritance, getters and setters and some further voodoo.</p>
<p>When using objects as maps, you have to remember that the key will be
converted to a string value via <code>toString()</code>, which results in mapping <code>5</code> and
<code>'5'</code> to the same value and all objects which don't overwrite the <code>toString()</code>
method to the value indexed by <code>'[object Object]'</code>. You might also
involuntarily access its inherited properties if you don't check
<code>hasOwnProperty()</code>.</p>
<p>JavaScript's built-in <em>array</em> type does not help one bit: JavaScript arrays
are not associative arrays, but just objects with a few more special
properties. If you want to know why they can't be used as maps, look here.</p>
<h2>Eugene's Solution</h2>
<p>Eugene Lazutkin already described the basic idea of using a custom hash
function to generate unique strings which can be used to look up the
associated values as properties of a dictionary object. This will most likely
be the fastest solution, because objects are internally implemented as <em>hash
tables</em>.</p>
<ul>
<li>
<strong>Note:</strong> Hash tables (sometimes called <em>hash maps</em> ) are a particular implementation of the map concept using a backing array and lookup via numeric hash values. The runtime environment might use other structures (such as <em>search trees</em> or <em>skip lists</em> ) to implement JavaScript objects, but as objects are the fundamental data structure, they should be sufficiently optimised.</li>
</ul>
<p>In order to get a unique hash value for arbitrary objects, one possibility is
to use a global counter and cache the hash value in the object itself (for
example, in a property named <code>__hash</code>).</p>
<p>A hash function which does this is and works for both primitive values and
objects is:</p>
<div class="code"><pre class="code literal-block"><span class="nv">function</span><span class="w"> </span><span class="nv">hash</span><span class="ss">(</span><span class="nv">value</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="ss">(</span><span class="nv">typeof</span><span class="w"> </span><span class="nv">value</span><span class="ss">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">' '</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="ss">(</span><span class="nv">value</span><span class="w"> </span><span class="nv">instanceof</span><span class="w"> </span><span class="nv">Object</span><span class="w"> </span>?
<span class="w">        </span><span class="ss">(</span><span class="nv">value</span>.<span class="nv">__hash</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="ss">(</span><span class="nv">value</span>.<span class="nv">__hash</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">++</span><span class="nv">arguments</span>.<span class="nv">callee</span>.<span class="nv">current</span><span class="ss">))</span><span class="w"> </span>:
<span class="w">        </span><span class="nv">value</span>.<span class="nv">toString</span><span class="ss">())</span><span class="c1">;</span>
}

<span class="nv">hash</span>.<span class="nv">current</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="c1">;</span>
</pre></div>

<p>This function can be used as described by Eugene. For convenience, we will
further wrap it in a <code>Map</code> class.</p>
<h2>My <code>Map</code> implementation</h2>
<p>The following implementation will additionally store the key-value-pairs in a
doubly linked list in order to allow fast iteration over both keys and values.
To supply your own hash function, you can overwrite the instance's <code>hash()</code>
method after creation.</p>
<div class="code"><pre class="code literal-block"><span class="o">//</span><span class="w"> </span><span class="n">Linking</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">key</span><span class="o">-</span><span class="k">value</span><span class="o">-</span><span class="n">pairs</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">optional</span><span class="p">.</span>
<span class="o">//</span><span class="w"> </span><span class="k">If</span><span class="w"> </span><span class="k">no</span><span class="w"> </span><span class="n">argument</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">provided</span><span class="p">,</span><span class="w"> </span><span class="n">linkItems</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="n">undefined</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">.</span><span class="n">e</span><span class="p">.</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="k">false</span>
<span class="o">//</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">linking</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">enabled</span>
<span class="k">function</span><span class="w"> </span><span class="k">Map</span><span class="p">(</span><span class="n">linkItems</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="n">this</span><span class="p">.</span><span class="k">current</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">undefined</span><span class="p">;</span>
<span class="w">    </span><span class="n">this</span><span class="p">.</span><span class="k">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">linkItems</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="k">false</span><span class="p">)</span>
<span class="w">        </span><span class="n">this</span><span class="p">.</span><span class="n">disableLinking</span><span class="p">();</span>
<span class="err">}</span>

<span class="k">Map</span><span class="p">.</span><span class="n">noop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">function</span><span class="p">()</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this</span><span class="p">;</span>
<span class="err">}</span><span class="p">;</span>

<span class="k">Map</span><span class="p">.</span><span class="n">illegal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">function</span><span class="p">()</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Error</span><span class="p">(</span><span class="ss">"illegal operation for maps without linking"</span><span class="p">);</span>
<span class="err">}</span><span class="p">;</span>

<span class="o">//</span><span class="w"> </span><span class="k">Map</span><span class="w"> </span><span class="n">initialisation</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">existing</span><span class="w"> </span><span class="k">object</span>
<span class="o">//</span><span class="w"> </span><span class="n">doesn</span><span class="s1">'t add inherited properties if not explicitly instructed to:</span>
<span class="s1">// omitting foreignKeys means foreignKeys === undefined, i.e. == false</span>
<span class="s1">// --&gt; inherited properties won'</span><span class="n">t</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">added</span>
<span class="k">Map</span><span class="p">.</span><span class="k">from</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="w"> </span><span class="n">foreignKeys</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="nf">var</span><span class="w"> </span><span class="k">map</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="k">Map</span><span class="p">;</span>

<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="nf">var</span><span class="w"> </span><span class="n">prop</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">obj</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">foreignKeys</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">obj</span><span class="p">.</span><span class="n">hasOwnProperty</span><span class="p">(</span><span class="n">prop</span><span class="p">))</span>
<span class="w">            </span><span class="k">map</span><span class="p">.</span><span class="n">put</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span><span class="w"> </span><span class="n">obj</span><span class="o">[</span><span class="n">prop</span><span class="o">]</span><span class="p">);</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">map</span><span class="p">;</span>
<span class="err">}</span><span class="p">;</span>

<span class="k">Map</span><span class="p">.</span><span class="n">prototype</span><span class="p">.</span><span class="n">disableLinking</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">function</span><span class="p">()</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="n">this</span><span class="p">.</span><span class="n">link</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">Map</span><span class="p">.</span><span class="n">noop</span><span class="p">;</span>
<span class="w">    </span><span class="n">this</span><span class="p">.</span><span class="n">unlink</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">Map</span><span class="p">.</span><span class="n">noop</span><span class="p">;</span>
<span class="w">    </span><span class="n">this</span><span class="p">.</span><span class="n">disableLinking</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">Map</span><span class="p">.</span><span class="n">noop</span><span class="p">;</span>
<span class="w">    </span><span class="n">this</span><span class="p">.</span><span class="k">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">Map</span><span class="p">.</span><span class="n">illegal</span><span class="p">;</span>
<span class="w">    </span><span class="n">this</span><span class="p">.</span><span class="k">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">Map</span><span class="p">.</span><span class="n">illegal</span><span class="p">;</span>
<span class="w">    </span><span class="n">this</span><span class="p">.</span><span class="k">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">Map</span><span class="p">.</span><span class="n">illegal</span><span class="p">;</span>
<span class="w">    </span><span class="n">this</span><span class="p">.</span><span class="n">removeAll</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">Map</span><span class="p">.</span><span class="n">illegal</span><span class="p">;</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this</span><span class="p">;</span>
<span class="err">}</span><span class="p">;</span>

<span class="o">//</span><span class="w"> </span><span class="n">Overwrite</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">Map</span><span class="w"> </span><span class="n">instance</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">necessary</span>
<span class="k">Map</span><span class="p">.</span><span class="n">prototype</span><span class="p">.</span><span class="n">hash</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="k">value</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">typeof</span><span class="w"> </span><span class="k">value</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">' '</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="k">value</span><span class="w"> </span><span class="n">instanceof</span><span class="w"> </span><span class="k">Object</span><span class="w"> </span><span class="vm">?</span>
<span class="w">        </span><span class="p">(</span><span class="k">value</span><span class="p">.</span><span class="n">__hash</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span><span class="k">value</span><span class="p">.</span><span class="n">__hash</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">++</span><span class="n">arguments</span><span class="p">.</span><span class="n">callee</span><span class="p">.</span><span class="k">current</span><span class="p">))</span><span class="w"> </span><span class="err">:</span>
<span class="w">        </span><span class="k">value</span><span class="p">.</span><span class="n">toString</span><span class="p">());</span>
<span class="err">}</span><span class="p">;</span>

<span class="k">Map</span><span class="p">.</span><span class="n">prototype</span><span class="p">.</span><span class="n">hash</span><span class="p">.</span><span class="k">current</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="o">//</span><span class="w"> </span><span class="o">---</span><span class="w"> </span><span class="n">Mapping</span><span class="w"> </span><span class="n">functions</span>

<span class="k">Map</span><span class="p">.</span><span class="n">prototype</span><span class="p">.</span><span class="k">get</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="k">key</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="nf">var</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">this</span><span class="o">[</span><span class="n">this.hash(key)</span><span class="o">]</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="n">undefined</span><span class="w"> </span><span class="vm">?</span><span class="w"> </span><span class="n">undefined</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">item</span><span class="p">.</span><span class="k">value</span><span class="p">;</span>
<span class="err">}</span><span class="p">;</span>

<span class="k">Map</span><span class="p">.</span><span class="n">prototype</span><span class="p">.</span><span class="n">put</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="k">key</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="nf">var</span><span class="w"> </span><span class="n">hash</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">this</span><span class="p">.</span><span class="n">hash</span><span class="p">(</span><span class="k">key</span><span class="p">);</span>

<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">this</span><span class="o">[</span><span class="n">hash</span><span class="o">]</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="n">undefined</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="nf">var</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="k">key</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="k">value</span><span class="w"> </span><span class="err">}</span><span class="p">;</span>
<span class="w">        </span><span class="n">this</span><span class="o">[</span><span class="n">hash</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">item</span><span class="p">;</span>

<span class="w">        </span><span class="n">this</span><span class="p">.</span><span class="n">link</span><span class="p">(</span><span class="n">item</span><span class="p">);</span>
<span class="w">        </span><span class="o">++</span><span class="n">this</span><span class="p">.</span><span class="k">size</span><span class="p">;</span>
<span class="w">    </span><span class="err">}</span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="n">this</span><span class="o">[</span><span class="n">hash</span><span class="o">]</span><span class="p">.</span><span class="k">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">value</span><span class="p">;</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this</span><span class="p">;</span>
<span class="err">}</span><span class="p">;</span>

<span class="k">Map</span><span class="p">.</span><span class="n">prototype</span><span class="p">.</span><span class="n">remove</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="k">key</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="nf">var</span><span class="w"> </span><span class="n">hash</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">this</span><span class="p">.</span><span class="n">hash</span><span class="p">(</span><span class="k">key</span><span class="p">);</span>
<span class="w">    </span><span class="nf">var</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">this</span><span class="o">[</span><span class="n">hash</span><span class="o">]</span><span class="p">;</span>

<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="n">undefined</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="o">--</span><span class="n">this</span><span class="p">.</span><span class="k">size</span><span class="p">;</span>
<span class="w">        </span><span class="n">this</span><span class="p">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">item</span><span class="p">);</span>

<span class="w">        </span><span class="k">delete</span><span class="w"> </span><span class="n">this</span><span class="o">[</span><span class="n">hash</span><span class="o">]</span><span class="p">;</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this</span><span class="p">;</span>
<span class="err">}</span><span class="p">;</span>

<span class="o">//</span><span class="w"> </span><span class="k">Only</span><span class="w"> </span><span class="n">works</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">linked</span>
<span class="k">Map</span><span class="p">.</span><span class="n">prototype</span><span class="p">.</span><span class="n">removeAll</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">function</span><span class="p">()</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="k">while</span><span class="p">(</span><span class="n">this</span><span class="p">.</span><span class="k">size</span><span class="p">)</span>
<span class="w">        </span><span class="n">this</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="n">this</span><span class="p">.</span><span class="k">key</span><span class="p">());</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this</span><span class="p">;</span>
<span class="err">}</span><span class="p">;</span>

<span class="o">//</span><span class="w"> </span><span class="o">---</span><span class="w"> </span><span class="n">Linked</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">helper</span><span class="w"> </span><span class="n">functions</span>

<span class="k">Map</span><span class="p">.</span><span class="n">prototype</span><span class="p">.</span><span class="n">link</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">this</span><span class="p">.</span><span class="k">size</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="n">item</span><span class="p">.</span><span class="n">prev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">item</span><span class="p">;</span>
<span class="w">        </span><span class="n">item</span><span class="p">.</span><span class="k">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">item</span><span class="p">;</span>
<span class="w">        </span><span class="n">this</span><span class="p">.</span><span class="k">current</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">item</span><span class="p">;</span>
<span class="w">    </span><span class="err">}</span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="n">item</span><span class="p">.</span><span class="n">prev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">this</span><span class="p">.</span><span class="k">current</span><span class="p">.</span><span class="n">prev</span><span class="p">;</span>
<span class="w">        </span><span class="n">item</span><span class="p">.</span><span class="n">prev</span><span class="p">.</span><span class="k">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">item</span><span class="p">;</span>
<span class="w">        </span><span class="n">item</span><span class="p">.</span><span class="k">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">this</span><span class="p">.</span><span class="k">current</span><span class="p">;</span>
<span class="w">        </span><span class="n">this</span><span class="p">.</span><span class="k">current</span><span class="p">.</span><span class="n">prev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">item</span><span class="p">;</span>
<span class="w">    </span><span class="err">}</span>
<span class="err">}</span><span class="p">;</span>

<span class="k">Map</span><span class="p">.</span><span class="n">prototype</span><span class="p">.</span><span class="n">unlink</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">this</span><span class="p">.</span><span class="k">size</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">        </span><span class="n">this</span><span class="p">.</span><span class="k">current</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">undefined</span><span class="p">;</span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="n">item</span><span class="p">.</span><span class="n">prev</span><span class="p">.</span><span class="k">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">item</span><span class="p">.</span><span class="k">next</span><span class="p">;</span>
<span class="w">        </span><span class="n">item</span><span class="p">.</span><span class="k">next</span><span class="p">.</span><span class="n">prev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">item</span><span class="p">.</span><span class="n">prev</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="n">this</span><span class="p">.</span><span class="k">current</span><span class="p">)</span>
<span class="w">            </span><span class="n">this</span><span class="p">.</span><span class="k">current</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">item</span><span class="p">.</span><span class="k">next</span><span class="p">;</span>
<span class="w">    </span><span class="err">}</span>
<span class="err">}</span><span class="p">;</span>

<span class="o">//</span><span class="w"> </span><span class="o">---</span><span class="w"> </span><span class="n">Iterator</span><span class="w"> </span><span class="n">functions</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">only</span><span class="w"> </span><span class="k">work</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="k">map</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">linked</span>

<span class="k">Map</span><span class="p">.</span><span class="n">prototype</span><span class="p">.</span><span class="k">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">function</span><span class="p">()</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="n">this</span><span class="p">.</span><span class="k">current</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">this</span><span class="p">.</span><span class="k">current</span><span class="p">.</span><span class="k">next</span><span class="p">;</span>
<span class="err">}</span><span class="p">;</span>

<span class="k">Map</span><span class="p">.</span><span class="n">prototype</span><span class="p">.</span><span class="k">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">function</span><span class="p">()</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this</span><span class="p">.</span><span class="k">current</span><span class="p">.</span><span class="k">key</span><span class="p">;</span>
<span class="err">}</span><span class="p">;</span>

<span class="k">Map</span><span class="p">.</span><span class="n">prototype</span><span class="p">.</span><span class="k">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">function</span><span class="p">()</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this</span><span class="p">.</span><span class="k">current</span><span class="p">.</span><span class="k">value</span><span class="p">;</span>
<span class="err">}</span><span class="p">;</span>
</pre></div>

<h2>Example</h2>
<p>The following script,</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">map</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">Map</span><span class="p">;</span>

<span class="n">map</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s1">'spam'</span><span class="p">,</span><span class="w"> </span><span class="s1">'eggs'</span><span class="p">)</span><span class="o">.</span>
<span class="w">    </span><span class="n">put</span><span class="p">(</span><span class="s1">'foo'</span><span class="p">,</span><span class="w"> </span><span class="s1">'bar'</span><span class="p">)</span><span class="o">.</span>
<span class="w">    </span><span class="n">put</span><span class="p">(</span><span class="s1">'foo'</span><span class="p">,</span><span class="w"> </span><span class="s1">'baz'</span><span class="p">)</span><span class="o">.</span>
<span class="w">    </span><span class="n">put</span><span class="p">({},</span><span class="w"> </span><span class="s1">'an object'</span><span class="p">)</span><span class="o">.</span>
<span class="w">    </span><span class="n">put</span><span class="p">({},</span><span class="w"> </span><span class="s1">'another object'</span><span class="p">)</span><span class="o">.</span>
<span class="w">    </span><span class="n">put</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="s1">'five'</span><span class="p">)</span><span class="o">.</span>
<span class="w">    </span><span class="n">put</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="s1">'five again'</span><span class="p">)</span><span class="o">.</span>
<span class="w">    </span><span class="n">put</span><span class="p">(</span><span class="s1">'5'</span><span class="p">,</span><span class="w"> </span><span class="s1">'another five'</span><span class="p">);</span>

<span class="k">for</span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">map</span><span class="o">.</span><span class="n">size</span><span class="p">;</span><span class="w"> </span><span class="n">map</span><span class="o">.</span><span class="n">next</span><span class="p">())</span>
<span class="w">    </span><span class="n">document</span><span class="o">.</span><span class="n">writeln</span><span class="p">(</span><span class="n">map</span><span class="o">.</span><span class="n">hash</span><span class="p">(</span><span class="n">map</span><span class="o">.</span><span class="n">key</span><span class="p">())</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">' : '</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">map</span><span class="o">.</span><span class="n">value</span><span class="p">());</span>
</pre></div>

<p>generates this output:</p>
<div class="code"><pre class="code literal-block">string spam : eggs
string foo : baz
object 1 : an object
object 2 : another object
number 5 : five again
string 5 : another five
</pre></div>

<h2>Further considerations</h2>
<p>PEZ suggested to overwrite the <code>toString()</code> method, presumably with our hash
function. This is not feasible, because it doesn't work for primitive values
(changing <code>toString()</code> for primitives is a <em>very</em> bad idea). If we want
<code>toString()</code> to return meaningful values for arbitrary objects, we would have
to modify <code>Object.prototype</code>, which some people (myself not included) consider
<em>verboten</em>.</p>
<hr>
<p>The current version of my <code>Map</code> implementation as well as other JavaScript
goodies can be obtained from here.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/can-you-call-directory-getfiles-with-multiple-filters/" class="u-url">Can you call Directory.GetFiles() with multiple filters?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/can-you-call-directory-getfiles-with-multiple-filters/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T18:33:41+08:00" itemprop="datePublished" title="2023-03-03 18:33">2023-03-03 18:33</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I am trying to use the <code>Directory.GetFiles()</code> method to retrieve a list of
files of multiple types, such as <code>mp3</code>'s and <code>jpg</code>'s. I have tried both of the
following with no luck:</p>
<div class="code"><pre class="code literal-block"><span class="nt">Directory</span><span class="p">.</span><span class="nc">GetFiles</span><span class="o">(</span><span class="s2">"C:\\path"</span><span class="o">,</span><span class="w"> </span><span class="s2">"*.mp3|*.jpg"</span><span class="o">,</span><span class="w"> </span><span class="nt">SearchOption</span><span class="p">.</span><span class="nc">AllDirectories</span><span class="o">);</span>
<span class="nt">Directory</span><span class="p">.</span><span class="nc">GetFiles</span><span class="o">(</span><span class="s2">"C:\\path"</span><span class="o">,</span><span class="w"> </span><span class="s2">"*.mp3;*.jpg"</span><span class="o">,</span><span class="w"> </span><span class="nt">SearchOption</span><span class="p">.</span><span class="nc">AllDirectories</span><span class="o">);</span>
</pre></div>

<p>Is there a way to do this in one call?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>For .NET 4.0 and later,</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Directory</span><span class="o">.</span><span class="n">EnumerateFiles</span><span class="p">(</span><span class="s2">"C:</span><span class="se">\\</span><span class="s2">path"</span><span class="p">,</span><span class="w"> </span><span class="s2">"*.*"</span><span class="p">,</span><span class="w"> </span><span class="n">SearchOption</span><span class="o">.</span><span class="n">AllDirectories</span><span class="p">)</span>
<span class="w">            </span><span class="o">.</span><span class="n">Where</span><span class="p">(</span><span class="n">s</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">s</span><span class="o">.</span><span class="n">EndsWith</span><span class="p">(</span><span class="s2">".mp3"</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">s</span><span class="o">.</span><span class="n">EndsWith</span><span class="p">(</span><span class="s2">".jpg"</span><span class="p">));</span>
</pre></div>

<p>For earlier versions of .NET,</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Directory</span><span class="o">.</span><span class="n">GetFiles</span><span class="p">(</span><span class="s2">"C:</span><span class="se">\\</span><span class="s2">path"</span><span class="p">,</span><span class="w"> </span><span class="s2">"*.*"</span><span class="p">,</span><span class="w"> </span><span class="n">SearchOption</span><span class="o">.</span><span class="n">AllDirectories</span><span class="p">)</span>
<span class="w">            </span><span class="o">.</span><span class="n">Where</span><span class="p">(</span><span class="n">s</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">s</span><span class="o">.</span><span class="n">EndsWith</span><span class="p">(</span><span class="s2">".mp3"</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">s</span><span class="o">.</span><span class="n">EndsWith</span><span class="p">(</span><span class="s2">".jpg"</span><span class="p">));</span>
</pre></div>

<p><strong>edit:</strong> <em>Please read the comments. The improvement that Paul Farry suggests,
and the memory/performance issue that Christian.K points out are both very
important.</em></p>
<p><br></p>
<h3>Suggest</h3>
<p>How about this:</p>
<div class="code"><pre class="code literal-block"><span class="nv">private</span><span class="w"> </span><span class="nv">static</span><span class="w"> </span><span class="nv">string</span>[]<span class="w"> </span><span class="nv">GetFiles</span><span class="ss">(</span><span class="nv">string</span><span class="w"> </span><span class="nv">sourceFolder</span>,<span class="w"> </span><span class="nv">string</span><span class="w"> </span><span class="nv">filters</span>,<span class="w"> </span><span class="nv">System</span>.<span class="nv">IO</span>.<span class="nv">SearchOption</span><span class="w"> </span><span class="nv">searchOption</span><span class="ss">)</span>
{
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nv">filters</span>.<span class="nv">Split</span><span class="ss">(</span><span class="s1">'|'</span><span class="ss">)</span>.<span class="nv">SelectMany</span><span class="ss">(</span><span class="nv">filter</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nv">System</span>.<span class="nv">IO</span>.<span class="nv">Directory</span>.<span class="nv">GetFiles</span><span class="ss">(</span><span class="nv">sourceFolder</span>,<span class="w"> </span><span class="nv">filter</span>,<span class="w"> </span><span class="nv">searchOption</span><span class="ss">))</span>.<span class="nv">ToArray</span><span class="ss">()</span><span class="c1">;</span>
}
</pre></div>

<p>I found it here (in the comments): http://msdn.microsoft.com/en-
us/library/wz42302f.aspx</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-2150.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-2148.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
