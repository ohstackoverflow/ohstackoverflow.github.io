<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 260) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-260.html">
<link rel="prev" href="index-261.html" type="text/html">
<link rel="next" href="index-259.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/what-does-the-exclamation-mark-do-before-the-function/" class="u-url">What does the exclamation mark do before the function?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/what-does-the-exclamation-mark-do-before-the-function/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T02:22:03+08:00" itemprop="datePublished" title="2023-02-17 02:22">2023-02-17 02:22</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div class="code"><pre class="code literal-block"><span class="sx">!function () {}();</span>
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<p>JavaScript syntax 101: here is a <strong>function declaration</strong> :</p>
<div class="code"><pre class="code literal-block">function foo() {}
</pre></div>

<p>Note that there’s no semicolon; this is just a function <strong>declaration</strong>. You
would need an invocation, <code>foo()</code>, to actually run the function.</p>
<p>Now, when we add the seemingly innocuous exclamation mark: <code>!function foo()
{}</code> it turns it into an <strong>expression</strong>. It is now a <strong>function expression</strong>.</p>
<p>The <code>!</code> alone doesn’t invoke the function, of course, but we can now put <code>()</code>
at the end: <code>!function foo() {}()</code>, which has higher precedence than <code>!</code> and
instantly calls the function.</p>
<p><code>function foo() {}()</code> would be a syntax error because you can’t put arguments
(<code>()</code>) right after a function declaration.</p>
<p>So what the author is doing is saving a byte per function expression; a more
readable way of writing it would be this:</p>
<div class="code"><pre class="code literal-block">(function(){})();
</pre></div>

<p>Lastly, <code>!</code> makes the expression return a boolean based on the return value of
the function. Usually, an immediately invoked function expression (IIFE)
doesn’t explicitly return anything, so its return value will be <code>undefined</code>,
which leaves us with <code>!undefined</code> which is <code>true</code>. This boolean isn’t used.</p>
<p><br></p>
<h3>Suggest</h3>
<p>The function:</p>
<div class="code"><pre class="code literal-block">function () {}
</pre></div>

<p>returns nothing (or undefined).</p>
<p>Sometimes we want to call a function right as we create it. You might be
tempted to try this:</p>
<div class="code"><pre class="code literal-block">function () {}()
</pre></div>

<p>but it results in a <code>SyntaxError</code>.</p>
<p>Using the <code>!</code> operator before the function causes it to be treated as an
expression, so we can call it:</p>
<div class="code"><pre class="code literal-block"><span class="sx">!function () {}()</span>
</pre></div>

<p>This will also return the boolean opposite of the return value of the
function, in this case <code>true</code>, because <code>!undefined</code> is <code>true</code>. If you want the
actual return value to be the result of the call, then try doing it this way:</p>
<div class="code"><pre class="code literal-block">(function () {})()
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-force-docker-for-a-clean-build-of-an-image/" class="u-url">How to force Docker for a clean build of an image</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-force-docker-for-a-clean-build-of-an-image/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T02:21:34+08:00" itemprop="datePublished" title="2023-02-17 02:21">2023-02-17 02:21</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I have build a Docker image from a Docker file using the below command.</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span>docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>u12_core<span class="w"> </span>-f<span class="w"> </span>u12_core<span class="w"> </span>.
</pre></div>

<p>When I am trying to rebuild it with the same command, it's using the build
cache like:</p>
<div class="code"><pre class="code literal-block"><span class="n">Step</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">FROM</span><span class="w"> </span><span class="n">ubuntu</span><span class="p">:</span><span class="mf">12.04</span>
<span class="w"> </span><span class="o">---&gt;</span><span class="w"> </span><span class="n">eb965dfb09d2</span>
<span class="n">Step</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">MAINTAINER</span><span class="w"> </span><span class="n">Pavan</span><span class="w"> </span><span class="n">Gupta</span><span class="w"> </span><span class="o">&lt;</span><span class="n">pavan</span><span class="o">.</span><span class="n">gupta</span><span class="err">@</span><span class="n">gmail</span><span class="o">.</span><span class="n">com</span><span class="o">&gt;</span>
<span class="w"> </span><span class="o">---&gt;</span><span class="w"> </span><span class="n">Using</span><span class="w"> </span><span class="n">cache</span>
<span class="w"> </span><span class="o">---&gt;</span><span class="w"> </span><span class="mi">4354</span><span class="n">ccf9dcd8</span>
<span class="n">Step</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">RUN</span><span class="w"> </span><span class="n">apt</span><span class="o">-</span><span class="n">get</span><span class="w"> </span><span class="n">update</span>
<span class="w"> </span><span class="o">---&gt;</span><span class="w"> </span><span class="n">Using</span><span class="w"> </span><span class="n">cache</span>
<span class="w"> </span><span class="o">---&gt;</span><span class="w"> </span><span class="n">bcbca2fcf204</span>
<span class="n">Step</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">RUN</span><span class="w"> </span><span class="n">apt</span><span class="o">-</span><span class="n">get</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="o">-</span><span class="n">y</span><span class="w"> </span><span class="n">openjdk</span><span class="o">-</span><span class="mi">7</span><span class="o">-</span><span class="n">jdk</span>
<span class="w"> </span><span class="o">---&gt;</span><span class="w"> </span><span class="n">Using</span><span class="w"> </span><span class="n">cache</span>
<span class="w"> </span><span class="o">---&gt;</span><span class="w"> </span><span class="mi">103</span><span class="n">f1a261d44</span>
<span class="n">Step</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">RUN</span><span class="w"> </span><span class="n">apt</span><span class="o">-</span><span class="n">get</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="o">-</span><span class="n">y</span><span class="w"> </span><span class="n">openssh</span><span class="o">-</span><span class="n">server</span>
<span class="w"> </span><span class="o">---&gt;</span><span class="w"> </span><span class="n">Using</span><span class="w"> </span><span class="n">cache</span>
<span class="w"> </span><span class="o">---&gt;</span><span class="w"> </span><span class="n">dde41f8d0904</span>
<span class="n">Step</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">RUN</span><span class="w"> </span><span class="n">apt</span><span class="o">-</span><span class="n">get</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="o">-</span><span class="n">y</span><span class="w"> </span><span class="n">git</span><span class="o">-</span><span class="n">core</span>
<span class="w"> </span><span class="o">---&gt;</span><span class="w"> </span><span class="n">Using</span><span class="w"> </span><span class="n">cache</span>
<span class="w"> </span><span class="o">---&gt;</span><span class="w"> </span><span class="mi">9</span><span class="n">be002f08b6a</span>
<span class="n">Step</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">RUN</span><span class="w"> </span><span class="n">apt</span><span class="o">-</span><span class="n">get</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="o">-</span><span class="n">y</span><span class="w"> </span><span class="n">build</span><span class="o">-</span><span class="n">essential</span>
<span class="w"> </span><span class="o">---&gt;</span><span class="w"> </span><span class="n">Using</span><span class="w"> </span><span class="n">cache</span>
<span class="w"> </span><span class="o">---&gt;</span><span class="w"> </span><span class="n">a752fd73a698</span>
<span class="n">Step</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">RUN</span><span class="w"> </span><span class="n">apt</span><span class="o">-</span><span class="n">get</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="o">-</span><span class="n">y</span><span class="w"> </span><span class="n">logrotate</span>
<span class="w"> </span><span class="o">---&gt;</span><span class="w"> </span><span class="n">Using</span><span class="w"> </span><span class="n">cache</span>
<span class="w"> </span><span class="o">---&gt;</span><span class="w"> </span><span class="mi">93</span><span class="n">bca09b509d</span>
<span class="n">Step</span><span class="w"> </span><span class="mi">9</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">RUN</span><span class="w"> </span><span class="n">apt</span><span class="o">-</span><span class="n">get</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="o">-</span><span class="n">y</span><span class="w"> </span><span class="n">lsb</span><span class="o">-</span><span class="n">release</span>
<span class="w"> </span><span class="o">---&gt;</span><span class="w"> </span><span class="n">Using</span><span class="w"> </span><span class="n">cache</span>
<span class="w"> </span><span class="o">---&gt;</span><span class="w"> </span><span class="n">fd4d10cf18bc</span>
<span class="n">Step</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">RUN</span><span class="w"> </span><span class="n">mkdir</span><span class="w"> </span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">sshd</span>
<span class="w"> </span><span class="o">---&gt;</span><span class="w"> </span><span class="n">Using</span><span class="w"> </span><span class="n">cache</span>
<span class="w"> </span><span class="o">---&gt;</span><span class="w"> </span><span class="mi">63</span><span class="n">b4ecc39ff0</span>
<span class="n">Step</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">RUN</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="s1">'root:root'</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">chpasswd</span>
<span class="w"> </span><span class="o">---&gt;</span><span class="w"> </span><span class="n">Using</span><span class="w"> </span><span class="n">cache</span>
<span class="w"> </span><span class="o">---&gt;</span><span class="w"> </span><span class="mf">9532e31518</span><span class="n">a6</span>
<span class="n">Step</span><span class="w"> </span><span class="mi">12</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">RUN</span><span class="w"> </span><span class="n">sed</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="s1">'s/PermitRootLogin without-password/PermitRootLogin yes/'</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">ssh</span><span class="o">/</span><span class="n">sshd_config</span>
<span class="w"> </span><span class="o">---&gt;</span><span class="w"> </span><span class="n">Using</span><span class="w"> </span><span class="n">cache</span>
<span class="w"> </span><span class="o">---&gt;</span><span class="w"> </span><span class="mi">47</span><span class="n">d1660bd544</span>
<span class="n">Step</span><span class="w"> </span><span class="mi">13</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">RUN</span><span class="w"> </span><span class="n">sed</span><span class="w"> </span><span class="s1">'s@session\s*required\s*pam_loginuid.so@session optional pam_loginuid.so@g'</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">pam</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">sshd</span>
<span class="w"> </span><span class="o">---&gt;</span><span class="w"> </span><span class="n">Using</span><span class="w"> </span><span class="n">cache</span>
<span class="w"> </span><span class="o">---&gt;</span><span class="w"> </span><span class="n">d1f97f1c52f7</span>
<span class="n">Step</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">RUN</span><span class="w"> </span><span class="n">wget</span><span class="w"> </span><span class="o">-</span><span class="n">O</span><span class="w"> </span><span class="n">aerospike</span><span class="o">.</span><span class="n">tgz</span><span class="w"> </span><span class="s1">'http://aerospike.com/download/server/latest/artifact/ubuntu12'</span>
<span class="w"> </span><span class="o">---&gt;</span><span class="w"> </span><span class="n">Using</span><span class="w"> </span><span class="n">cache</span>
<span class="w"> </span><span class="o">---&gt;</span><span class="w"> </span><span class="n">bd7dde7a98b9</span>
<span class="n">Step</span><span class="w"> </span><span class="mi">15</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">RUN</span><span class="w"> </span><span class="n">tar</span><span class="w"> </span><span class="o">-</span><span class="n">xvf</span><span class="w"> </span><span class="n">aerospike</span><span class="o">.</span><span class="n">tgz</span>
<span class="w"> </span><span class="o">---&gt;</span><span class="w"> </span><span class="n">Using</span><span class="w"> </span><span class="n">cache</span>
<span class="w"> </span><span class="o">---&gt;</span><span class="w"> </span><span class="mi">54</span><span class="n">adaa09921f</span>
<span class="n">Step</span><span class="w"> </span><span class="mi">16</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">RUN</span><span class="w"> </span><span class="n">dpkg</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="n">aerospike</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">community</span><span class="o">-*/*.</span><span class="n">deb</span>
<span class="w"> </span><span class="o">---&gt;</span><span class="w"> </span><span class="n">Using</span><span class="w"> </span><span class="n">cache</span>
<span class="w"> </span><span class="o">---&gt;</span><span class="w"> </span><span class="mi">11</span><span class="n">aba013eea5</span>
<span class="n">Step</span><span class="w"> </span><span class="mi">17</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">EXPOSE</span><span class="w"> </span><span class="mi">22</span><span class="w"> </span><span class="mi">3000</span><span class="w"> </span><span class="mi">3001</span><span class="w"> </span><span class="mi">3002</span><span class="w"> </span><span class="mi">3003</span>
<span class="w"> </span><span class="o">---&gt;</span><span class="w"> </span><span class="n">Using</span><span class="w"> </span><span class="n">cache</span>
<span class="w"> </span><span class="o">---&gt;</span><span class="w"> </span><span class="n">e33aaa78a931</span>
<span class="n">Step</span><span class="w"> </span><span class="mi">18</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">CMD</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">sshd</span><span class="w"> </span><span class="o">-</span><span class="n">D</span>
<span class="w"> </span><span class="o">---&gt;</span><span class="w"> </span><span class="n">Using</span><span class="w"> </span><span class="n">cache</span>
<span class="w"> </span><span class="o">---&gt;</span><span class="w"> </span><span class="mi">25</span><span class="n">f5fe70fa84</span>
<span class="n">Successfully</span><span class="w"> </span><span class="n">built</span><span class="w"> </span><span class="mi">25</span><span class="n">f5fe70fa84</span>
</pre></div>

<p>The cache shows that aerospike is installed. However, I don't find it inside
containers spawn from this image, so I want to rebuild this image without
using the cache. How can I force Docker to rebuild a clean image without the
cache?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>There's a <code>--no-cache</code> option:</p>
<div class="code"><pre class="code literal-block">docker build --no-cache -t u12_core -f u12_core .
</pre></div>

<p>In older versions of Docker you needed to pass <code>--no-cache=true</code>, but this is
no longer the case.</p>
<p><br></p>
<h3>Suggest</h3>
<p>In some extreme cases, your only way around recurring build failures is by
running:</p>
<div class="code"><pre class="code literal-block">docker system prune
</pre></div>

<p>The command will ask you for your confirmation:</p>
<div class="code"><pre class="code literal-block"><span class="nv">WARNING</span><span class="o">!</span><span class="w"> </span><span class="nv">This</span><span class="w"> </span><span class="nv">will</span><span class="w"> </span><span class="nv">remove</span>:
<span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nv">all</span><span class="w"> </span><span class="nv">stopped</span><span class="w"> </span><span class="nv">containers</span>
<span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nv">all</span><span class="w"> </span><span class="nv">volumes</span><span class="w"> </span><span class="nv">not</span><span class="w"> </span><span class="nv">used</span><span class="w"> </span><span class="nv">by</span><span class="w"> </span><span class="nv">at</span><span class="w"> </span><span class="nv">least</span><span class="w"> </span><span class="nv">one</span><span class="w"> </span><span class="nv">container</span>
<span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nv">all</span><span class="w"> </span><span class="nv">networks</span><span class="w"> </span><span class="nv">not</span><span class="w"> </span><span class="nv">used</span><span class="w"> </span><span class="nv">by</span><span class="w"> </span><span class="nv">at</span><span class="w"> </span><span class="nv">least</span><span class="w"> </span><span class="nv">one</span><span class="w"> </span><span class="nv">container</span>
<span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nv">all</span><span class="w"> </span><span class="nv">images</span><span class="w"> </span><span class="nv">without</span><span class="w"> </span><span class="nv">at</span><span class="w"> </span><span class="nv">least</span><span class="w"> </span><span class="nv">one</span><span class="w"> </span><span class="nv">container</span><span class="w"> </span><span class="nv">associated</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">them</span>
<span class="nv">Are</span><span class="w"> </span><span class="nv">you</span><span class="w"> </span><span class="nv">sure</span><span class="w"> </span><span class="nv">you</span><span class="w"> </span><span class="nv">want</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="k">continue</span>?<span class="w"> </span>[<span class="nv">y</span><span class="o">/</span><span class="nv">N</span>]
</pre></div>

<p>This is of course not a direct answer to the question, but might save some
lives... It did save mine.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/string-formatting-vs-format-vs-f-string-literal/" class="u-url">String formatting: % vs. .format vs. f-string literal</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/string-formatting-vs-format-vs-f-string-literal/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T02:20:33+08:00" itemprop="datePublished" title="2023-02-17 02:20">2023-02-17 02:20</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>There are various string formatting methods:</p>
<ul>
<li>Python &lt;2.6: <code>"Hello %s" % name</code>
</li>
<li>Python 2.6+: <code>"Hello {}".format(name)</code> (uses <code>str.format</code>)</li>
<li>Python 3.6+: <code>f"{name}"</code> (uses f-strings)</li>
</ul>
<p>Which is better, and for what situations?</p>
<hr>
<ol>
<li>
<p>The following methods have the same outcome, so what is the difference?</p>
<div class="code"><pre class="code literal-block">name = "Alice"
</pre></div>

<p>"Hello %s" % name
"Hello {0}".format(name)
f"Hello {name}"</p>
<h2>Using named arguments:</h2>
<p>"Hello %(kwarg)s" % {'kwarg': name}
"Hello {kwarg}".format(kwarg=name)
f"Hello {name}"</p>
</li>
<li>
<p>When does string formatting run, and how do I avoid a runtime performance penalty?</p>
</li>
</ol>
<hr>
<p>If you are trying to close a duplicate question that is just looking for a way
to format a string, please use How do I put a variable’s value inside a
string?.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>To answer your first question... <code>.format</code> just seems more sophisticated in
many ways. An annoying thing about <code>%</code> is also how it can either take a
variable or a tuple. You'd think the following would always work:</p>
<div class="code"><pre class="code literal-block">"Hello %s" % name
</pre></div>

<p>yet, if <code>name</code> happens to be <code>(1, 2, 3)</code>, it will throw a <code>TypeError</code>. To
guarantee that it always prints, you'd need to do</p>
<div class="code"><pre class="code literal-block">"Hello %s" % (name,)   # supply the single argument as a single-item tuple
</pre></div>

<p>which is just ugly. <code>.format</code> doesn't have those issues. Also in the second
example you gave, the <code>.format</code> example is much cleaner looking.</p>
<p>Only use it for backwards compatibility with Python 2.5.</p>
<hr>
<p>To answer your second question, string formatting happens at the same time as
any other operation - when the string formatting expression is evaluated. And
Python, not being a lazy language, evaluates expressions before calling
functions, so the expression <code>log.debug("some debug info: %s" % some_info)</code>
will first evaluate the string to, e.g. <code>"some debug info: roflcopters are
active"</code>, then that string will be passed to <code>log.debug()</code>.</p>
<p><br></p>
<h3>Suggest</h3>
<p>Something that the modulo operator ( % ) can't do, afaik:</p>
<div class="code"><pre class="code literal-block">tu = (12,45,22222,103,6)
print '{0} {2} {1} {2} {3} {2} {4} {2}'.format(*tu)
</pre></div>

<p>result</p>
<div class="code"><pre class="code literal-block"><span class="mf">12</span><span class="w"> </span><span class="mf">22222</span><span class="w"> </span><span class="mf">45</span><span class="w"> </span><span class="mf">22222</span><span class="w"> </span><span class="mf">103</span><span class="w"> </span><span class="mf">22222</span><span class="w"> </span><span class="mf">6</span><span class="w"> </span><span class="mf">22222</span>
</pre></div>

<p>Very useful.</p>
<p>Another point: <code>format()</code>, being a function, can be used as an argument in
other functions:</p>
<div class="code"><pre class="code literal-block"><span class="n">li</span> <span class="o">=</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">78</span><span class="p">,</span><span class="mi">784</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">69</span><span class="p">,</span><span class="mi">1254</span><span class="p">,</span><span class="mi">4785</span><span class="p">,</span><span class="mi">984</span><span class="p">]</span>
<span class="nb">print</span> <span class="nb">map</span><span class="p">(</span><span class="s1">'the number is </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">,</span><span class="n">li</span><span class="p">)</span>

<span class="nb">print</span>

<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span><span class="n">timedelta</span>

<span class="n">once_upon_a_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2010</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">delta</span> <span class="o">=</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">hours</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>  <span class="n">minutes</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="n">gen</span> <span class="o">=</span><span class="p">(</span><span class="n">once_upon_a_time</span> <span class="o">+</span><span class="n">x</span><span class="o">*</span><span class="n">delta</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>

<span class="nb">print</span> <span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="s1">'{:%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S}'</span><span class="o">.</span><span class="n">format</span><span class="p">,</span> <span class="n">gen</span><span class="p">))</span>
</pre></div>

<p>Results in:</p>
<div class="code"><pre class="code literal-block"><span class="k">['the number is 12', 'the number is 45', 'the number is 78', 'the number is 784', 'the number is 2', 'the number is 69', 'the number is 1254', 'the number is 4785', 'the number is 984']</span>

<span class="na">2010-07-01 12</span><span class="o">:</span><span class="s">00:00</span>
<span class="na">2010-07-14 20</span><span class="o">:</span><span class="s">20:00</span>
<span class="na">2010-07-28 04</span><span class="o">:</span><span class="s">40:00</span>
<span class="na">2010-08-10 13</span><span class="o">:</span><span class="s">00:00</span>
<span class="na">2010-08-23 21</span><span class="o">:</span><span class="s">20:00</span>
<span class="na">2010-09-06 05</span><span class="o">:</span><span class="s">40:00</span>
<span class="na">2010-09-19 14</span><span class="o">:</span><span class="s">00:00</span>
<span class="na">2010-10-02 22</span><span class="o">:</span><span class="s">20:00</span>
<span class="na">2010-10-16 06</span><span class="o">:</span><span class="s">40:00</span>
<span class="na">2010-10-29 15</span><span class="o">:</span><span class="s">00:00</span>
<span class="na">2010-11-11 23</span><span class="o">:</span><span class="s">20:00</span>
<span class="na">2010-11-25 07</span><span class="o">:</span><span class="s">40:00</span>
<span class="na">2010-12-08 16</span><span class="o">:</span><span class="s">00:00</span>
<span class="na">2010-12-22 00</span><span class="o">:</span><span class="s">20:00</span>
<span class="na">2011-01-04 08</span><span class="o">:</span><span class="s">40:00</span>
<span class="na">2011-01-17 17</span><span class="o">:</span><span class="s">00:00</span>
<span class="na">2011-01-31 01</span><span class="o">:</span><span class="s">20:00</span>
<span class="na">2011-02-13 09</span><span class="o">:</span><span class="s">40:00</span>
<span class="na">2011-02-26 18</span><span class="o">:</span><span class="s">00:00</span>
<span class="na">2011-03-12 02</span><span class="o">:</span><span class="s">20:00</span>
</pre></div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-261.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-259.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
