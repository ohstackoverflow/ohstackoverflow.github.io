<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 2715) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-2715.html">
<link rel="prev" href="index-2716.html" type="text/html">
<link rel="next" href="index-2714.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/check-if-a-class-is-derived-from-a-generic-class/" class="u-url">Check if a class is derived from a generic class</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/check-if-a-class-is-derived-from-a-generic-class/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-05T12:33:20+08:00" itemprop="datePublished" title="2023-03-05 12:33">2023-03-05 12:33</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I have a generic class in my project with derived classes.</p>
<div class="code"><pre class="code literal-block">public class GenericClass&lt;T&gt; : GenericInterface&lt;T&gt;
{
}

public class Test : GenericClass&lt;SomeType&gt;
{
}
</pre></div>

<p>Is there any way to find out if a <code>Type</code> object is derived from
<code>GenericClass</code>?</p>
<div class="code"><pre class="code literal-block">t.IsSubclassOf(typeof(GenericClass&lt;&gt;))
</pre></div>

<p>does not work.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Try this code</p>
<div class="code"><pre class="code literal-block"><span class="k">static</span><span class="w"> </span><span class="nb nb-Type">bool</span><span class="w"> </span><span class="n">IsSubclassOfRawGeneric</span><span class="p">(</span><span class="n">Type</span><span class="w"> </span><span class="n">generic</span><span class="p">,</span><span class="w"> </span><span class="n">Type</span><span class="w"> </span><span class="n">toCheck</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">toCheck</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb nb-Type">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">toCheck</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">typeof</span><span class="p">(</span><span class="n">object</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">var</span><span class="w"> </span><span class="n">cur</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">toCheck</span><span class="o">.</span><span class="n">IsGenericType</span><span class="w"> </span><span class="err">?</span><span class="w"> </span><span class="n">toCheck</span><span class="o">.</span><span class="n">GetGenericTypeDefinition</span><span class="p">()</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">toCheck</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">generic</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">cur</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="bp">true</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">toCheck</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">toCheck</span><span class="o">.</span><span class="n">BaseType</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="bp">false</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>(Reposted due to a massive rewrite)</p>
<p>JaredPar's code answer is fantastic, but I have a tip that would make it
unnecessary if your generic types are not based on value type parameters. I
was hung up on why the "is" operator would not work, so I have also documented
the results of my experimentation for future reference. Please enhance this
answer to further enhance its clarity.</p>
<h3>TIP:</h3>
<p>If you make certain that your GenericClass implementation inherits from an
abstract non-generic base class such as GenericClassBase, you could ask the
same question without any trouble at all like this:</p>
<div class="code"><pre class="code literal-block">typeof(Test).IsSubclassOf(typeof(GenericClassBase))
</pre></div>

<hr>
<h3>IsSubclassOf()</h3>
<p>My testing indicates that IsSubclassOf() does not work on parameterless
generic types such as</p>
<div class="code"><pre class="code literal-block">typeof(GenericClass&lt;&gt;)
</pre></div>

<p>whereas it will work with</p>
<div class="code"><pre class="code literal-block">typeof(GenericClass&lt;SomeType&gt;)
</pre></div>

<p>Therefore the following code will work for any derivation of GenericClass&lt;&gt;,
assuming you are willing to test based on SomeType:</p>
<div class="code"><pre class="code literal-block">typeof(Test).IsSubclassOf(typeof(GenericClass&lt;SomeType&gt;))
</pre></div>

<p>The only time I can imagine that you would want to test by GenericClass&lt;&gt; is
in a plug-in framework scenario.</p>
<hr>
<h3>Thoughts on the "is" operator</h3>
<p>At design-time C# does not allow the use of parameterless generics because
they are essentially not a complete CLR type at that point. Therefore, you
must declare generic variables with parameters, and that is why the "is"
operator is so powerful for working with objects. Incidentally, the "is"
operator also can not evaluate parameterless generic types.  </p>
<p>The "is" operator will test the entire inheritance chain, including
interfaces.</p>
<p>So, given an instance of any object, the following method will do the trick:</p>
<div class="code"><pre class="code literal-block"><span class="nv">bool</span><span class="w"> </span><span class="nv">IsTypeof</span><span class="o">&lt;</span><span class="nv">T</span><span class="o">&gt;</span><span class="ss">(</span><span class="nv">object</span><span class="w"> </span><span class="nv">t</span><span class="ss">)</span>
{
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="ss">(</span><span class="nv">t</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">T</span><span class="ss">)</span><span class="c1">;</span>
}
</pre></div>

<p>This is sort of redundant, but I figured I would go ahead and visualize it for
everybody.</p>
<p>Given</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">Test</span><span class="p">();</span>
</pre></div>

<p>The following lines of code would return true:</p>
<div class="code"><pre class="code literal-block">bool test1 = IsTypeof&lt;GenericInterface&lt;SomeType&gt;&gt;(t);

bool test2 = IsTypeof&lt;GenericClass&lt;SomeType&gt;&gt;(t);

bool test3 = IsTypeof&lt;Test&gt;(t);
</pre></div>

<p>On the other hand, if you want something specific to GenericClass, you could
make it more specific, I suppose, like this:</p>
<div class="code"><pre class="code literal-block"><span class="nv">bool</span><span class="w"> </span><span class="nv">IsTypeofGenericClass</span><span class="o">&lt;</span><span class="nv">SomeType</span><span class="o">&gt;</span><span class="ss">(</span><span class="nv">object</span><span class="w"> </span><span class="nv">t</span><span class="ss">)</span>
{
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="ss">(</span><span class="nv">t</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">GenericClass</span><span class="o">&lt;</span><span class="nv">SomeType</span><span class="o">&gt;</span><span class="ss">)</span><span class="c1">;</span>
}
</pre></div>

<p>Then you would test like this:</p>
<div class="code"><pre class="code literal-block">bool test1 = IsTypeofGenericClass&lt;SomeType&gt;(t);
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-add-new-elements-to-an-array/" class="u-url">How to add new elements to an array?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-add-new-elements-to-an-array/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-05T12:31:50+08:00" itemprop="datePublished" title="2023-03-05 12:31">2023-03-05 12:31</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I have the following code:</p>
<div class="code"><pre class="code literal-block">String[] where;
where.append(ContactsContract.Contacts.HAS_PHONE_NUMBER + "=1");
where.append(ContactsContract.Contacts.IN_VISIBLE_GROUP + "=1");
</pre></div>

<p>Those two appends are not compiling. How would that work correctly?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>The size of an array can't be modified. If you want a bigger array you have to
instantiate a new one.</p>
<p>A better solution would be to use an <code>ArrayList</code> which can grow as you need
it. The method <code>ArrayList.toArray( T[] a )</code> gives you back your array if you
need it in this form.</p>
<div class="code"><pre class="code literal-block">List&lt;String&gt; where = new ArrayList&lt;String&gt;();
where.add( ContactsContract.Contacts.HAS_PHONE_NUMBER+"=1" );
where.add( ContactsContract.Contacts.IN_VISIBLE_GROUP+"=1" );
</pre></div>

<p>If you need to convert it to a simple array...</p>
<div class="code"><pre class="code literal-block">String[] simpleArray = new String[ where.size() ];
where.toArray( simpleArray );
</pre></div>

<p>But most things you do with an array you can do with this ArrayList, too:</p>
<div class="code"><pre class="code literal-block"><span class="c1">// iterate over the array</span>
<span class="k">for</span><span class="p">(</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">oneItem</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="nb">where</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="p">...</span>
<span class="p">}</span>

<span class="c1">// get specific items</span>
<span class="nb">where</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">);</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>Use a <code>List&lt;String&gt;</code>, such as an <code>ArrayList&lt;String&gt;</code>. It's dynamically
growable, unlike arrays (see: <em>Effective Java 2nd Edition, Item 25: Prefer
lists to arrays</em> ).</p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="nn">java.util.</span><span class="o">*</span><span class="p">;</span>
<span class="o">//....</span>

<span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="nb">list</span> <span class="o">=</span> <span class="n">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="p">();</span>
<span class="nb">list</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">"1"</span><span class="p">);</span>
<span class="nb">list</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">"2"</span><span class="p">);</span>
<span class="nb">list</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">"3"</span><span class="p">);</span>
<span class="n">System</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">println</span><span class="p">(</span><span class="nb">list</span><span class="p">);</span> <span class="o">//</span> <span class="n">prints</span> <span class="s2">"[1, 2, 3]"</span>
</pre></div>

<p>If you insist on using arrays, you can use <code>java.util.Arrays.copyOf</code> to
allocate a bigger array to accomodate the additional element. This is really
not the best solution, though.</p>
<div class="code"><pre class="code literal-block"><span class="k">static</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">T</span><span class="err">[]</span><span class="w"> </span><span class="n">append</span><span class="p">(</span><span class="n">T</span><span class="err">[]</span><span class="w"> </span><span class="n">arr</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="k">element</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="n">final</span><span class="w"> </span><span class="nc">int</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">arr</span><span class="p">.</span><span class="n">length</span><span class="p">;</span>
<span class="w">    </span><span class="n">arr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrays</span><span class="p">.</span><span class="n">copyOf</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="n">arr</span><span class="o">[</span><span class="n">N</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">element</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">arr</span><span class="p">;</span>
<span class="err">}</span>

<span class="n">String</span><span class="err">[]</span><span class="w"> </span><span class="n">arr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="ss">"1"</span><span class="p">,</span><span class="w"> </span><span class="ss">"2"</span><span class="p">,</span><span class="w"> </span><span class="ss">"3"</span><span class="w"> </span><span class="err">}</span><span class="p">;</span>
<span class="k">System</span><span class="p">.</span><span class="k">out</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">Arrays</span><span class="p">.</span><span class="n">toString</span><span class="p">(</span><span class="n">arr</span><span class="p">));</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">prints</span><span class="w"> </span><span class="ss">"[1, 2, 3]"</span>
<span class="n">arr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">append</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span><span class="w"> </span><span class="ss">"4"</span><span class="p">);</span>
<span class="k">System</span><span class="p">.</span><span class="k">out</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">Arrays</span><span class="p">.</span><span class="n">toString</span><span class="p">(</span><span class="n">arr</span><span class="p">));</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">prints</span><span class="w"> </span><span class="ss">"[1, 2, 3, 4]"</span>
</pre></div>

<p>This is <code>O(N)</code> per <code>append</code>. <code>ArrayList</code>, on the other hand, has <code>O(1)</code>
amortized cost per operation.</p>
<h4>See also</h4>
<ul>
<li>Java Tutorials/Arrays <ul>
<li>An array is a container object that holds a fixed number of values of a single type. The length of an array is established when the array is created. After creation, its length is fixed.</li>
</ul>
</li>
<li>Java Tutorials/The List interface</li>
</ul>
</div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-read-a-file-in-groovy-into-a-string/" class="u-url">How to read a file in Groovy into a string?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-read-a-file-in-groovy-into-a-string/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-05T12:30:26+08:00" itemprop="datePublished" title="2023-03-05 12:30">2023-03-05 12:30</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I need to read a file from the file system and load the entire contents into a
string in a groovy controller, what's the easiest way to do that?</p>
<p><br><br></p>
<h2>Answer</h2>
<div class="code"><pre class="code literal-block">String fileContents = new File('/path/to/file').text
</pre></div>

<p>If you need to specify the character encoding, use the following instead:</p>
<div class="code"><pre class="code literal-block">String fileContents = new File('/path/to/file').getText('UTF-8')
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>The shortest way is indeed just</p>
<div class="code"><pre class="code literal-block">String fileContents = new File('/path/to/file').text
</pre></div>

<p>but in this case you have no control on how the bytes in the file are
interpreted as characters. AFAIK groovy tries to guess the encoding here by
looking at the file content.</p>
<p>If you want a specific character encoding you can specify a charset name with</p>
<div class="code"><pre class="code literal-block">String fileContents = new File('/path/to/file').getText('UTF-8')
</pre></div>

<p>See API docs on <code>File.getText(String)</code> for further reference.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-2716.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-2714.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
