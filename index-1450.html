<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 1450) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-1450.html">
<link rel="prev" href="index-1451.html" type="text/html">
<link rel="next" href="index-1449.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/valueerror-unknown-activation-function-my-custom-activation-function/" class="u-url">ValueError: Unknown activation function: my_custom_activation_function</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/valueerror-unknown-activation-function-my-custom-activation-function/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-28T04:02:01+08:00" itemprop="datePublished" title="2023-02-28 04:02">2023-02-28 04:02</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I have used an activation function that I have created on my own (not usually)
and I used for my LSTM. Everything went well, I trained my model and saved it
as <code>.h5</code> file.</p>
<p>Here is my customized activation function:</p>
<div class="code"><pre class="code literal-block"><span class="kn">from</span> <span class="nn">keras</span> <span class="kn">import</span> <span class="n">backend</span> <span class="k">as</span> <span class="n">k</span>

<span class="k">def</span> <span class="nf">activate</span><span class="p">(</span><span class="n">ab</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">ab</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">softplus</span><span class="p">(</span><span class="n">ab</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">a</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">b</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">k</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">weibull_loglik_discrete</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">ab_pred</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">y_</span> <span class="o">=</span> <span class="n">y_true</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">u_</span> <span class="o">=</span> <span class="n">y_true</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">a_</span> <span class="o">=</span> <span class="n">ab_pred</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">b_</span> <span class="o">=</span> <span class="n">ab_pred</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>

    <span class="n">hazard0</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">pow</span><span class="p">((</span><span class="n">y_</span> <span class="o">+</span> <span class="mf">1e-35</span><span class="p">)</span> <span class="o">/</span> <span class="n">a_</span><span class="p">,</span> <span class="n">b_</span><span class="p">)</span>
    <span class="n">hazard1</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">pow</span><span class="p">((</span><span class="n">y_</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">a_</span><span class="p">,</span> <span class="n">b_</span><span class="p">)</span>

    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">k</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">u_</span> <span class="o">*</span> <span class="n">k</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">hazard1</span> <span class="o">-</span> <span class="n">hazard0</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">-</span> <span class="n">hazard1</span><span class="p">)</span>



<span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Masking</span><span class="p">(</span><span class="n">mask_value</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="n">max_time</span><span class="p">,</span> <span class="mi">39</span><span class="p">)))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">LSTM</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="n">input_dim</span><span class="o">=</span><span class="mi">11</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="c1"># Apply the custom activation function mentioned above</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Activation</span><span class="p">(</span><span class="n">activate</span><span class="p">))</span>
<span class="c1"># discrete log-likelihood for Weibull survival data as my loss function</span>
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="n">weibull_loglik_discrete</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="n">RMSprop</span><span class="p">(</span><span class="n">lr</span><span class="o">=</span><span class="mf">.001</span><span class="p">))</span> 
<span class="c1"># Fit!</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_x</span><span class="p">,</span> <span class="n">train_y</span><span class="p">,</span> <span class="n">nb_epoch</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">test_x</span><span class="p">,</span> <span class="n">test_y</span><span class="p">))</span>
</pre></div>

<p>After training, I save my model as follow:</p>
<div class="code"><pre class="code literal-block"><span class="kn">from</span> <span class="nn">keras.models</span> <span class="kn">import</span> <span class="n">load_model</span>
<span class="n">model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">"model_baseline_lstm.h5"</span><span class="p">)</span>
</pre></div>

<p>Later, when I try to load the model, I run this :</p>
<div class="code"><pre class="code literal-block"><span class="kn">from</span> <span class="nn">keras.models</span> <span class="kn">import</span> <span class="n">load_model</span>
<span class="n">model</span><span class="o">=</span> <span class="n">load_model</span><span class="p">(</span><span class="s2">"model_baseline_lstm.h5"</span><span class="p">)</span>
</pre></div>

<p>BUT, I get this error:</p>
<div class="code"><pre class="code literal-block"><span class="o">---------------------------------------------------------------------------</span> <span class="ne">ValueError</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span> <span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="n">d3f9f7415b5c</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
     <span class="mi">13</span> <span class="c1"># model.save("model_baseline_lsm.h5")</span>
     <span class="mi">14</span> <span class="kn">from</span> <span class="nn">keras.models</span> <span class="kn">import</span> <span class="n">load_model</span>
<span class="o">---&gt;</span> <span class="mi">15</span> <span class="n">model</span><span class="o">=</span> <span class="n">load_model</span><span class="p">(</span><span class="s2">"model_baseline_lsm.h5"</span><span class="p">)</span>

<span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">keras</span><span class="o">/</span><span class="n">models</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">load_model</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">custom_objects</span><span class="p">,</span> <span class="nb">compile</span><span class="p">)</span>
    <span class="mi">238</span>             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'No model found in config file.'</span><span class="p">)</span>
    <span class="mi">239</span>         <span class="n">model_config</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">model_config</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">'utf-8'</span><span class="p">))</span>
<span class="o">--&gt;</span> <span class="mi">240</span>         <span class="n">model</span> <span class="o">=</span> <span class="n">model_from_config</span><span class="p">(</span><span class="n">model_config</span><span class="p">,</span> <span class="n">custom_objects</span><span class="o">=</span><span class="n">custom_objects</span><span class="p">)</span>
    <span class="mi">241</span> 
    <span class="mi">242</span>         <span class="c1"># set weights</span>

<span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">keras</span><span class="o">/</span><span class="n">models</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">model_from_config</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">custom_objects</span><span class="p">)</span>
    <span class="mi">312</span>                         <span class="s1">'Maybe you meant to use '</span>
    <span class="mi">313</span>                         <span class="s1">'`Sequential.from_config(config)`?'</span><span class="p">)</span>
<span class="o">--&gt;</span> <span class="mi">314</span>     <span class="k">return</span> <span class="n">layer_module</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">custom_objects</span><span class="o">=</span><span class="n">custom_objects</span><span class="p">)</span>
    <span class="mi">315</span> 
    <span class="mi">316</span>

<span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">keras</span><span class="o">/</span><span class="n">layers</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">deserialize</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">custom_objects</span><span class="p">)</span>
     <span class="mi">53</span>                                     <span class="n">module_objects</span><span class="o">=</span><span class="n">globs</span><span class="p">,</span>
     <span class="mi">54</span>                                     <span class="n">custom_objects</span><span class="o">=</span><span class="n">custom_objects</span><span class="p">,</span>
<span class="o">---&gt;</span> <span class="mi">55</span>                                     <span class="n">printable_module_name</span><span class="o">=</span><span class="s1">'layer'</span><span class="p">)</span>

<span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">keras</span><span class="o">/</span><span class="n">utils</span><span class="o">/</span><span class="n">generic_utils</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">deserialize_keras_object</span><span class="p">(</span><span class="n">identifier</span><span class="p">,</span> <span class="n">module_objects</span><span class="p">,</span> <span class="n">custom_objects</span><span class="p">,</span> <span class="n">printable_module_name</span><span class="p">)</span>
    <span class="mi">138</span>                 <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_config</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">'config'</span><span class="p">],</span>
    <span class="mi">139</span>                                        <span class="n">custom_objects</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">_GLOBAL_CUSTOM_OBJECTS</span><span class="o">.</span><span class="n">items</span><span class="p">())</span> <span class="o">+</span>
<span class="o">--&gt;</span> <span class="mi">140</span>                                                            <span class="nb">list</span><span class="p">(</span><span class="n">custom_objects</span><span class="o">.</span><span class="n">items</span><span class="p">())))</span>
    <span class="mi">141</span>             <span class="k">with</span> <span class="n">CustomObjectScope</span><span class="p">(</span><span class="n">custom_objects</span><span class="p">):</span>
    <span class="mi">142</span>                 <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_config</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">'config'</span><span class="p">])</span>

<span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">keras</span><span class="o">/</span><span class="n">models</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">from_config</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">custom_objects</span><span class="p">)</span>    
   <span class="mi">1321</span>         <span class="n">model</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">()</span> 
   <span class="mi">1322</span>         <span class="k">for</span> <span class="n">conf</span> <span class="ow">in</span> <span class="n">config</span><span class="p">:</span>
<span class="o">-&gt;</span> <span class="mi">1323</span>             <span class="n">layer</span> <span class="o">=</span> <span class="n">layer_module</span><span class="o">.</span><span class="n">deserialize</span><span class="p">(</span><span class="n">conf</span><span class="p">,</span> <span class="n">custom_objects</span><span class="o">=</span><span class="n">custom_objects</span><span class="p">)</span>    
   <span class="mi">1324</span>             <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>    
   <span class="mi">1325</span>         <span class="k">return</span> <span class="n">model</span>

<span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">keras</span><span class="o">/</span><span class="n">layers</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">deserialize</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">custom_objects</span><span class="p">)</span>
     <span class="mi">53</span>                                     <span class="n">module_objects</span><span class="o">=</span><span class="n">globs</span><span class="p">,</span>
     <span class="mi">54</span>                                     <span class="n">custom_objects</span><span class="o">=</span><span class="n">custom_objects</span><span class="p">,</span>
<span class="o">---&gt;</span> <span class="mi">55</span>                                     <span class="n">printable_module_name</span><span class="o">=</span><span class="s1">'layer'</span><span class="p">)</span>

<span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">keras</span><span class="o">/</span><span class="n">utils</span><span class="o">/</span><span class="n">generic_utils</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">deserialize_keras_object</span><span class="p">(</span><span class="n">identifier</span><span class="p">,</span> <span class="n">module_objects</span><span class="p">,</span> <span class="n">custom_objects</span><span class="p">,</span> <span class="n">printable_module_name</span><span class="p">)</span>
    <span class="mi">140</span>                                                            <span class="nb">list</span><span class="p">(</span><span class="n">custom_objects</span><span class="o">.</span><span class="n">items</span><span class="p">())))</span>
    <span class="mi">141</span>             <span class="k">with</span> <span class="n">CustomObjectScope</span><span class="p">(</span><span class="n">custom_objects</span><span class="p">):</span>
<span class="o">--&gt;</span> <span class="mi">142</span>                 <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_config</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">'config'</span><span class="p">])</span>
    <span class="mi">143</span>         <span class="k">else</span><span class="p">:</span>
    <span class="mi">144</span>             <span class="c1"># Then `cls` may be a function returning a class.</span>

<span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">keras</span><span class="o">/</span><span class="n">engine</span><span class="o">/</span><span class="n">topology</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">from_config</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>    
   <span class="mi">1251</span>             <span class="n">A</span> <span class="n">layer</span> <span class="n">instance</span><span class="o">.</span>    
   <span class="mi">1252</span> <span class="s2">"""</span>
<span class="s2">-&gt; 1253         return cls(**config)    </span>
<span class="s2">   1254     </span>
<span class="s2">   1255     def count_params(self):</span>

<span class="s2">/anaconda3/lib/python3.6/site-packages/keras/layers/core.py in</span>
<span class="s2">__init__(self, activation, **kwargs)</span>
<span class="s2">    289         super(Activation, self).__init__(**kwargs)</span>
<span class="s2">    290         self.supports_masking = True</span>
<span class="s2">--&gt; 291         self.activation = activations.get(activation)</span>
<span class="s2">    292 </span>
<span class="s2">    293     def call(self, inputs):</span>

<span class="s2">/anaconda3/lib/python3.6/site-packages/keras/activations.py in get(identifier)</span>
<span class="s2">     93     if isinstance(identifier, six.string_types):</span>
<span class="s2">     94         identifier = str(identifier)</span>
<span class="s2">---&gt; 95         return deserialize(identifier)</span>
<span class="s2">     96     elif callable(identifier):</span>
<span class="s2">     97         if isinstance(identifier, Layer):</span>

<span class="s2">/anaconda3/lib/python3.6/site-packages/keras/activations.py in deserialize(name, custom_objects)</span>
<span class="s2">     85                                     module_objects=globals(),</span>
<span class="s2">     86                                     custom_objects=custom_objects,</span>
<span class="s2">---&gt; 87                                     printable_module_name='activation function')</span>
<span class="s2">     88 </span>
<span class="s2">     89</span>

<span class="s2">/anaconda3/lib/python3.6/site-packages/keras/utils/generic_utils.py in deserialize_keras_object(identifier, module_objects, custom_objects, printable_module_name)</span>
<span class="s2">    158             if fn is None:</span>
<span class="s2">    159                 raise ValueError('Unknown ' + printable_module_name +</span>
<span class="s2">--&gt; 160                                  ':' + function_name)</span>
<span class="s2">    161         return fn</span>
<span class="s2">    162     else:</span>

<span class="s2">ValueError: Unknown activation function:activate</span>
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<p>I want to share, how I solved this :</p>
<div class="code"><pre class="code literal-block"><span class="n">model</span><span class="o">=</span><span class="w"> </span><span class="n">load_model</span><span class="p">(</span><span class="s2">"model_baseline_lsm.h5"</span><span class="p">,</span>
<span class="w">                  </span><span class="n">custom_objects</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="s2">"weibull_loglik_discrete"</span><span class="p">:</span><span class="w"> </span><span class="n">weibull_loglik_discrete</span><span class="p">,</span><span class="s2">"activate"</span><span class="p">:</span><span class="n">activate</span><span class="p">})</span>
</pre></div>

<p>The pattern is as follow:</p>
<div class="code"><pre class="code literal-block"><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">load_model</span><span class="p">(</span><span class="n">f</span><span class="s2">"{SAVED_MODELS_DIR}/model_{model_idx}_epoch_{global_epoch}"</span><span class="p">,</span><span class="w"> </span>
<span class="w">                   </span><span class="n">custom_objects</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="s2">"custom_loss"</span><span class="p">:</span><span class="w"> </span><span class="n">custom_loss</span><span class="p">})</span>
</pre></div>

<p>I hope this help :)</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/measuring-the-performance-of-classification-algorithm/" class="u-url">Measuring the performance of classification algorithm</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/measuring-the-performance-of-classification-algorithm/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-28T04:01:41+08:00" itemprop="datePublished" title="2023-02-28 04:01">2023-02-28 04:01</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I've got a classification problem in my hand, which I'd like to address with a
machine learning algorithm ( Bayes, or Markovian probably, the question is
independent on the classifier to be used). Given a number of training
instances, I'm looking for a way to measure the performance of an implemented
classificator, with taking data overfitting problem into account.</p>
<p>That is: given N[1..100] training samples, if I run the training algorithm on
every one of the samples, and use this very same samples to measure fitness,
it might stuck into a data overfitting problem -the classifier will know the
exact answers for the training instances, without having much predictive
power, rendering the fitness results useless.</p>
<p>An obvious solution would be seperating the hand-tagged samples into training,
and test samples; and I'd like to learn about methods selecting the
statistically significant samples for training.</p>
<p>White papers, book pointers, and PDFs much appreciated!</p>
<p><br><br></p>
<h2>Answer</h2>
<p>You could use 10-fold Cross-validation for this. I believe it's pretty
standard approach for classification algorithm performance evaluation.</p>
<p>The basic idea is to divide your learning samples into 10 subsets. Then use
one subset for test data and others for train data. Repeat this for each
subset and calculate average performance at the end.</p>
<p><br></p>
<h3>Suggest</h3>
<p>As Mr. Brownstone said 10-fold Cross-Validation is probably the best way to
go. I recently had to evaluate the performance of a number of different
classifiers for this I used Weka. Which has an API and a load of tools that
allow you to easily test the performance of lots of different classifiers.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-reuse-saved-classifier-created-from-explorer-in-weka-in-eclipse-java/" class="u-url">How to reuse saved classifier created from explorer(in weka) in eclipse java</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-reuse-saved-classifier-created-from-explorer-in-weka-in-eclipse-java/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-28T04:01:24+08:00" itemprop="datePublished" title="2023-02-28 04:01">2023-02-28 04:01</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I have created a classifier in WEKA, i saved it on my hard-disk, now I want to
use that classifier in eclipse using weka api.</p>
<p>How can i do this? please guide me to this... thank you</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Here is an example of loading a model to predict the value of instances. The
example model is a J48 decision tree created and saved in the Weka Explorer.
It was built from the nominal weather data provided with Weka. It is called
"tree.model".</p>
<div class="code"><pre class="code literal-block"><span class="w"> </span><span class="o">//</span><span class="nb">load</span><span class="w"> </span><span class="n">model</span>
<span class="nb nb-Type">String</span><span class="w"> </span><span class="n">rootPath</span><span class="o">=</span><span class="s2">"/some/where/"</span><span class="p">;</span><span class="w"> </span>
<span class="n">Classifier</span><span class="w"> </span><span class="n">cls</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Classifier</span><span class="p">)</span><span class="w"> </span><span class="n">weka</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">SerializationHelper</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">rootPath</span><span class="o">+</span><span class="s2">"tree.model"</span><span class="p">);</span>

<span class="o">//</span><span class="n">predict</span><span class="w"> </span><span class="n">instance</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">values</span>
<span class="n">Instances</span><span class="w"> </span><span class="n">originalTrain</span><span class="o">=</span><span class="w"> </span><span class="o">//</span><span class="nb">load</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">create</span><span class="w"> </span><span class="n">Instances</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">predict</span>

<span class="o">//</span><span class="n">which</span><span class="w"> </span><span class="n">instance</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">predict</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">value</span>
<span class="nb nb-Type">int</span><span class="w"> </span><span class="n">s1</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>

<span class="o">//</span><span class="n">perform</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">prediction</span>
<span class="n">double</span><span class="w"> </span><span class="n">value</span><span class="o">=</span><span class="n">cls</span><span class="o">.</span><span class="n">classifyInstance</span><span class="p">(</span><span class="n">originalTrain</span><span class="o">.</span><span class="n">instance</span><span class="p">(</span><span class="n">s1</span><span class="p">));</span>

<span class="o">//</span><span class="n">get</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">value</span>
<span class="nb nb-Type">String</span><span class="w"> </span><span class="n">prediction</span><span class="o">=</span><span class="n">originalTrain</span><span class="o">.</span><span class="n">classAttribute</span><span class="p">()</span><span class="o">.</span><span class="n">value</span><span class="p">((</span><span class="nb nb-Type">int</span><span class="p">)</span><span class="n">value</span><span class="p">);</span>

<span class="n">System</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">println</span><span class="p">(</span><span class="s2">"The predicted value of instance "</span><span class="o">+</span>
<span class="w">                    </span><span class="n">Integer</span><span class="o">.</span><span class="n">toString</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span><span class="o">+</span>
<span class="w">                    </span><span class="s2">": "</span><span class="o">+</span><span class="n">prediction</span><span class="p">);</span>
</pre></div>

<p>The output from this is:</p>
<div class="code"><pre class="code literal-block">The predicted value of instance 0: no
</pre></div>

<p>A great beginers resource for the Weka api and Serialization is here!</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-1451.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-1449.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
