<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 46) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-46.html">
<link rel="prev" href="index-47.html" type="text/html">
<link rel="next" href="index-45.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/what-does-the-explicit-keyword-mean/" class="u-url">What does the explicit keyword mean?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/what-does-the-explicit-keyword-mean/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-16T19:32:44+08:00" itemprop="datePublished" title="2023-02-16 19:32">2023-02-16 19:32</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>What does the <code>explicit</code> keyword mean in C++?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>The compiler is allowed to make one implicit conversion to resolve the
parameters to a function. What this means is that the compiler can use
constructors callable with a <strong>single parameter</strong> to convert from one type to
another in order to get the right type for a parameter.</p>
<p>Here's an example class with a constructor that can be used for implicit
conversions:</p>
<div class="code"><pre class="code literal-block"><span class="k">class</span><span class="w"> </span><span class="n">Foo</span>
<span class="p">{</span>
<span class="n">private</span><span class="p">:</span>
<span class="w">  </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">m_foo</span><span class="p">;</span>

<span class="n">public</span><span class="p">:</span>
<span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="n">constructor</span><span class="p">,</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">implicit</span><span class="w"> </span><span class="n">conversion</span>
<span class="w">  </span><span class="n">Foo</span><span class="w"> </span><span class="p">(</span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">foo</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">m_foo</span><span class="w"> </span><span class="p">(</span><span class="n">foo</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span>

<span class="w">  </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">GetFoo</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">m_foo</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="p">};</span>
</pre></div>

<p>Here's a simple function that takes a <code>Foo</code> object:</p>
<div class="code"><pre class="code literal-block">void DoBar (Foo foo)
{
  int i = foo.GetFoo ();
}
</pre></div>

<p>and here's where the <code>DoBar</code> function is called:</p>
<div class="code"><pre class="code literal-block">int main ()
{
  DoBar (42);
}
</pre></div>

<p>The argument is not a <code>Foo</code> object, but an <code>int</code>. However, there exists a
constructor for <code>Foo</code> that takes an <code>int</code> so this constructor can be used to
convert the parameter to the correct type.</p>
<p>The compiler is allowed to do this once for each parameter.</p>
<p>Prefixing the <code>explicit</code> keyword to the constructor prevents the compiler from
using that constructor for implicit conversions. Adding it to the above class
will create a compiler error at the function call <code>DoBar (42)</code>. It is now
necessary to call for conversion explicitly with <code>DoBar (Foo (42))</code></p>
<p>The reason you might want to do this is to avoid accidental construction that
can hide bugs.<br>
Contrived example:</p>
<ul>
<li>You have a <code>MyString</code> class with a constructor that constructs a string of the given size. You have a function <code>print(const MyString&amp;)</code> (as well as an overload <code>print (char *string)</code>), and you call <code>print(3)</code> (when you <em>actually</em> intended to call <code>print("3")</code>). You expect it to print "3", but it prints an empty string of length 3 instead.</li>
</ul>
<p><br></p>
<h3>Suggest</h3>
<p>Suppose, you have a class <code>String</code>:</p>
<div class="code"><pre class="code literal-block"><span class="k">class</span><span class="w"> </span><span class="nb nb-Type">String</span><span class="w"> </span><span class="p">{</span>
<span class="n">public</span><span class="p">:</span>
<span class="w">    </span><span class="nb nb-Type">String</span><span class="p">(</span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">n</span><span class="p">);</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">allocate</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nb nb-Type">String</span><span class="w"> </span><span class="n">object</span>
<span class="w">    </span><span class="nb nb-Type">String</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="nb">char</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">);</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">initializes</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="nb">char</span><span class="w"> </span><span class="o">*</span><span class="n">p</span>
<span class="p">};</span>
</pre></div>

<p>Now, if you try:</p>
<div class="code"><pre class="code literal-block">String mystring = 'x';
</pre></div>

<p>The character <code>'x'</code> will be implicitly converted to <code>int</code> and then the
<code>String(int)</code> constructor will be called. But, this is not what the user might
have intended. So, to prevent such conditions, we shall define the constructor
as <code>explicit</code>:</p>
<div class="code"><pre class="code literal-block"><span class="k">class</span><span class="w"> </span><span class="nb nb-Type">String</span><span class="w"> </span><span class="p">{</span>
<span class="n">public</span><span class="p">:</span>
<span class="w">    </span><span class="n">explicit</span><span class="w"> </span><span class="nb nb-Type">String</span><span class="w"> </span><span class="p">(</span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">n</span><span class="p">);</span><span class="w"> </span><span class="o">//</span><span class="n">allocate</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="n">bytes</span>
<span class="w">    </span><span class="nb nb-Type">String</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="nb">char</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">);</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">initialize</span><span class="w"> </span><span class="n">sobject</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">p</span>
<span class="p">};</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-copy-files/" class="u-url">How to copy files</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-copy-files/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-16T19:31:14+08:00" itemprop="datePublished" title="2023-02-16 19:31">2023-02-16 19:31</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>How do I copy a file in Python?</p>
<p><br><br></p>
<h2>Answer</h2>
<p><code>shutil</code> has many methods you can use. One of which is:</p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="nn">shutil</span>

<span class="n">shutil</span><span class="o">.</span><span class="n">copyfile</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">)</span>

<span class="c1"># 2nd option</span>
<span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">)</span>  <span class="c1"># dst can be a folder; use shutil.copy2() to preserve timestamp</span>
</pre></div>

<ul>
<li>Copy the contents of the file named <code>src</code> to a file named <code>dst</code>. Both <code>src</code> and <code>dst</code> need to be the entire filename of the files, including path.</li>
<li>The destination location must be writable; otherwise, an <code>IOError</code> exception will be raised.</li>
<li>If <code>dst</code> already exists, it will be replaced.</li>
<li>Special files such as character or block devices and pipes cannot be copied with this function.</li>
<li>With <code>copy</code>, <code>src</code> and <code>dst</code> are path names given as <code>str</code>s.</li>
</ul>
<p>Another <code>shutil</code> method to look at is <code>shutil.copy2()</code>. It's similar but
preserves more metadata (e.g. time stamps).</p>
<p>If you use <code>os.path</code> operations, use <code>copy</code> rather than <code>copyfile</code>. <code>copyfile</code>
will only accept strings.</p>
<p><br></p>
<h3>Suggest</h3>
<p>Function | Copies<br>
metadata | Copies<br>
permissions | Uses file object | Destination<br>
may be directory<br>
---|---|---|---|---<br>
shutil.copy | No | Yes | No | Yes<br>
shutil.copyfile | No | No | No | No<br>
shutil.copy2 | Yes | Yes | No | Yes<br>
shutil.copyfileobj | No | No | Yes | No</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/what-is-the-difference-between-str-and-repr/" class="u-url">What is the difference between __str__ and __repr__?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/what-is-the-difference-between-str-and-repr/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-16T19:30:46+08:00" itemprop="datePublished" title="2023-02-16 19:30">2023-02-16 19:30</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>What is the difference between <code>__str__</code> and <code>__repr__</code> in Python?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Alex summarized well but, surprisingly, was too succinct.</p>
<p>First, let me reiterate the main points in Alex’s post:</p>
<ul>
<li>The default implementation is useless (it’s hard to think of one which wouldn’t be, but yeah)</li>
<li>
<code>__repr__</code> goal is to be unambiguous</li>
<li>
<code>__str__</code> goal is to be readable</li>
<li>Container’s <code>__str__</code> uses contained objects’ <code>__repr__</code>
</li>
</ul>
<p><strong>Default implementation is useless</strong></p>
<p>This is mostly a surprise because Python’s defaults tend to be fairly useful.
However, in this case, having a default for <code>__repr__</code> which would act like:</p>
<div class="code"><pre class="code literal-block"><span class="k">return</span><span class="w"> </span><span class="s2">"%s(%r)"</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="ss">(</span><span class="nv">self</span>.<span class="nv">__class__</span>,<span class="w"> </span><span class="nv">self</span>.<span class="nv">__dict__</span><span class="ss">)</span>
</pre></div>

<p>would have been too dangerous (for example, too easy to get into infinite
recursion if objects reference each other). So Python cops out. Note that
there is one default which is true: if <code>__repr__</code> is defined, and <code>__str__</code> is
not, the object will behave as though <code>__str__=__repr__</code>.</p>
<p>This means, in simple terms: almost every object you implement should have a
functional <code>__repr__</code> that’s usable for understanding the object. Implementing
<code>__str__</code> is optional: do that if you need a “pretty print” functionality (for
example, used by a report generator).</p>
<p><strong>The goal of<code>__repr__</code> is to be unambiguous</strong></p>
<p>Let me come right out and say it — I do not believe in debuggers. I don’t
really know how to use any debugger, and have never used one seriously.
Furthermore, I believe that the big fault in debuggers is their basic nature —
most failures I debug happened a long long time ago, in a galaxy far far away.
This means that I do believe, with religious fervor, in logging. Logging is
the lifeblood of any decent fire-and-forget server system. Python makes it
easy to log: with maybe some project specific wrappers, all you need is a</p>
<div class="code"><pre class="code literal-block">log(INFO, "I am in the weird function and a is", a, "and b is", b, "but I got a null C — using default", default_c)
</pre></div>

<p>But you have to do the last step — make sure every object you implement has a
useful repr, so code like that can just work. This is why the “eval” thing
comes up: if you have enough information so <code>eval(repr(c))==c</code>, that means you
know everything there is to know about <code>c</code>. If that’s easy enough, at least in
a fuzzy way, do it. If not, make sure you have enough information about <code>c</code>
anyway. I usually use an eval-like format: <code>"MyClass(this=%r,that=%r)" %
(self.this,self.that)</code>. It does not mean that you can actually construct
MyClass, or that those are the right constructor arguments — but it is a
useful form to express “this is everything you need to know about this
instance”.</p>
<p>Note: I used <code>%r</code> above, not <code>%s</code>. You always want to use <code>repr()</code> [or <code>%r</code>
formatting character, equivalently] inside <code>__repr__</code> implementation, or
you’re defeating the goal of repr. You want to be able to differentiate
<code>MyClass(3)</code> and <code>MyClass("3")</code>.</p>
<p><strong>The goal of<code>__str__</code> is to be readable</strong></p>
<p>Specifically, it is not intended to be unambiguous — notice that
<code>str(3)==str("3")</code>. Likewise, if you implement an IP abstraction, having the
str of it look like 192.168.1.1 is just fine. When implementing a date/time
abstraction, the str can be "2010/4/12 15:35:22", etc. The goal is to
represent it in a way that a user, not a programmer, would want to read it.
Chop off useless digits, pretend to be some other class — as long is it
supports readability, it is an improvement.</p>
<p><strong>Container’s<code>__str__</code> uses contained objects’ <code>__repr__</code></strong></p>
<p>This seems surprising, doesn’t it? It is a little, but how readable would it
be if it used their <code>__str__</code>?</p>
<div class="code"><pre class="code literal-block">[moshe is, 3, hello
world, this is a list, oh I don't know, containing just 4 elements]
</pre></div>

<p>Not very. Specifically, the strings in a container would find it way too easy
to disturb its string representation. In the face of ambiguity, remember,
Python resists the temptation to guess. If you want the above behavior when
you’re printing a list, just</p>
<div class="code"><pre class="code literal-block">print("[" + ", ".join(l) + "]")
</pre></div>

<p>(you can probably also figure out what to do about dictionaries.</p>
<p><strong>Summary</strong></p>
<p>Implement <code>__repr__</code> for any class you implement. This should be second
nature. Implement <code>__str__</code> if you think it would be useful to have a string
version which errs on the side of readability.</p>
<p><br></p>
<h3>Suggest</h3>
<p>My rule of thumb: <code>__repr__</code> is for developers, <code>__str__</code> is for customers.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-47.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-45.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
