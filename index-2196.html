<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 2196) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-2196.html">
<link rel="prev" href="index-2197.html" type="text/html">
<link rel="next" href="index-2195.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/ssl-certificate-rejected-trying-to-access-github-over-https-behind-firewall/" class="u-url">SSL certificate rejected trying to access GitHub over HTTPS behind firewall</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/ssl-certificate-rejected-trying-to-access-github-over-https-behind-firewall/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T22:07:16+08:00" itemprop="datePublished" title="2023-03-03 22:07">2023-03-03 22:07</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I'm stuck behind a firewall so have to use HTTPS to access my GitHub
repository. I'm using cygwin 1.7.7 on Windows XP.</p>
<p>I've tried setting the remote to
<code>https://username@github.com/username/ExcelANT.git</code>, but pushing prompts for a
password, but doesn't do anything once I've entered it.
<code>https://username:&lt;password&gt;github.com/username/ExcelANT.git</code> and cloning the
empty repo from scratch but each time it gives me the same error</p>
<blockquote>
<p>error: SSL certificate problem, verify that the CA cert is OK. Details:<br>
 error:14090086:SSL routines:SSL3_GET_SERVER_CERTIFICATE:certificate verify
failed while accessing https://github.com/username/ExcelANT.git/info/refs</p>
</blockquote>
<p>Turning on <code>GIT_CURL_VERBOSE=1</code> gives me</p>
<blockquote>
<ul>
<li>About to connect() to github.com port 443 (#0)  </li>
<li>Trying 207.97.227.239... * successfully set certificate verify locations:  </li>
<li>CAfile: none<br>
 CApath: /usr/ssl/certs  </li>
<li>SSL certificate problem, verify that the CA cert is OK. Details:<br>
 error:14090086:SSL routines:SSL3_GET_SERVER_CERTIFICATE:certificate verify
failed  </li>
<li>Expire cleared  </li>
<li>Closing connection #0  </li>
<li>About to connect() to github.com port 443 (#0)  </li>
<li>Trying 207.97.227.239... * successfully set certificate verify locations:  </li>
<li>CAfile: none<br>
 CApath: /usr/ssl/certs  </li>
<li>SSL certificate problem, verify that the CA cert is OK. Details:<br>
 error:14090086:SSL routines:SSL3_GET_SERVER_CERTIFICATE:certificate verify
failed  </li>
<li>Expire cleared  </li>
<li>Closing connection #0<br>
 error: SSL certificate problem, verify that the CA cert is OK. Details:<br>
 error:14090086:SSL routines:SSL3_GET_SERVER_CERTIFICATE:certificate verify
failed while accessing https://github.com/username/ExcelANT.git/info/refs</li>
</ul>
</blockquote>
<div class="code"><pre class="code literal-block"><span class="n">fatal</span><span class="o">:</span><span class="w"> </span><span class="n">HTTP</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="n">failed</span>
</pre></div>

<p>Is this a problem with my firewall, cygwin or what?</p>
<p>I hadn't set the HTTP proxy in the Git config, however it's an ISA server that
needs NTLM authentication, not basic, so unless anyone knows how to force git
to use NTLM, I'm scuppered.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Feel free to skip past this answer if you want to fix the certificates issue.
This answer deals with tunneling ssh through the firewall which is IMHO a
better solution to dealing with firewall/proxy thingies.</p>
<p>There is a better way than using http access and that is to use the ssh
service offered by github on port 443 of the ssh.github.com server.</p>
<p>We use a tool called corkscrew. This is available for both CygWin (through
setup from the cygwin homepage) and Linux using your favorite packaging tool.
For MacOSX it is available from macports and brew at least.</p>
<p>The commandline is as follows :</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span>corkscrew<span class="w"> </span>&lt;proxyhost&gt;<span class="w"> </span>&lt;proxyport&gt;<span class="w"> </span>&lt;targethost&gt;<span class="w"> </span>&lt;targetport&gt;<span class="w"> </span>&lt;authfile&gt;
</pre></div>

<p>The proxyhost and proxyport are the coordinates of the https proxy. The
targethost and targetport is the location of the host to tunnel to. The
authfile is a textfile with 1 line containing your proxy server
username/password separated by a colon</p>
<p>e.g:</p>
<div class="code"><pre class="code literal-block"><span class="n">abc</span><span class="o">:</span><span class="n">very_secret</span>
</pre></div>

<p>Installation for using "normal" ssh protocol for git communication</p>
<p>By adding this to the <code>~/.ssh/config</code> this trick can be used for normal ssh
connections.</p>
<div class="code"><pre class="code literal-block">Host github.com
  HostName ssh.github.com
  Port 443
  User git
  ProxyCommand corkscrew &lt;proxyhost&gt; &lt;proxyport&gt; %h %p ~/.ssh/proxy_auth
</pre></div>

<p>now you can test it works by ssh-ing to gitproxy</p>
<div class="code"><pre class="code literal-block"><span class="n">pti</span><span class="nv">@pti</span><span class="o">-</span><span class="nl">laptop</span><span class="p">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">ssh</span><span class="w"> </span><span class="n">github</span><span class="p">.</span><span class="n">com</span>
<span class="n">PTY</span><span class="w"> </span><span class="n">allocation</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="n">failed</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="mi">0</span>
<span class="n">Hi</span><span class="w"> </span><span class="n">ptillemans</span><span class="err">!</span><span class="w"> </span><span class="n">You</span><span class="err">'</span><span class="n">ve</span><span class="w"> </span><span class="n">successfully</span><span class="w"> </span><span class="n">authenticated</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">GitHub</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">provide</span><span class="w"> </span><span class="n">shell</span><span class="w"> </span><span class="n">access</span><span class="p">.</span>
<span class="w">       </span><span class="k">Connection</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="w"> </span><span class="n">closed</span><span class="p">.</span>
<span class="n">pti</span><span class="nv">@pti</span><span class="o">-</span><span class="nl">laptop</span><span class="p">:</span><span class="o">~</span><span class="err">$</span>
</pre></div>

<p>(Note: if you never logged in to github before, ssh will be asking to add the
server key to the known hosts file. If you are paranoid, it is recommended to
verify the RSA fingerprint to the one shown on the github site where you
uploaded your key).</p>
<p>A slight variant on this method is the case when you need to access a
repository with another key, e.g. to separate your private account from your
professional account.</p>
<div class="code"><pre class="code literal-block">#<span class="w"> </span>
#<span class="w"> </span><span class="nv">account</span><span class="w"> </span><span class="nv">dedicated</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">ACME</span><span class="w"> </span><span class="nv">private</span><span class="w"> </span><span class="nv">github</span><span class="w"> </span><span class="nv">account</span><span class="w"> </span>
#
<span class="nv">Host</span><span class="w"> </span><span class="nv">acme</span>.<span class="nv">github</span>.<span class="nv">com</span>
<span class="w">  </span><span class="nv">User</span><span class="w"> </span><span class="nv">git</span>
<span class="w">  </span><span class="nv">HostName</span><span class="w"> </span><span class="nv">ssh</span>.<span class="nv">github</span>.<span class="nv">com</span>
<span class="w">  </span><span class="nv">Port</span><span class="w"> </span><span class="mi">443</span>
<span class="w">  </span><span class="nv">ProxyCommand</span><span class="w"> </span><span class="nv">corkscrew</span><span class="w"> </span><span class="o">&lt;</span><span class="nv">proxyhost</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&lt;</span><span class="mi">3128</span><span class="o">&gt;</span><span class="w"> </span><span class="o">%</span><span class="nv">h</span><span class="w"> </span><span class="o">%</span><span class="nv">p</span><span class="w"> </span><span class="o">~/</span>.<span class="nv">ssh</span><span class="o">/</span><span class="nv">proxy_auth</span>
<span class="w">  </span><span class="nv">IdentityFile</span><span class="w"> </span><span class="o">~/</span>.<span class="nv">ssh</span><span class="o">/</span><span class="nv">id_dsa_acme</span>
</pre></div>

<p>enjoy!</p>
<p>We've been using this for years now on both Linux, Macs and Windows.</p>
<p>If you want you can read more about it in this blog post</p>
<p><br></p>
<h3>Suggest</h3>
<p>Note: <strong>disabling SSL verification has security implications</strong>. It allows Man
in the Middle attacks when you use Git to transfer data over a network. Be
sure you fully understand the security implications before using this as a
solution. Or better yet, install the root certificates.</p>
<p>One way is to disable the SSL CERT verification:</p>
<div class="code"><pre class="code literal-block">git config --global http.sslVerify false
</pre></div>

<p>This will prevent CURL to verity the HTTPS certification.</p>
<p>For one repository only:</p>
<div class="code"><pre class="code literal-block">git config http.sslVerify false
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/in-python-if-i-return-inside-a-with-block-will-the-file-still-close/" class="u-url">In Python, if I return inside a "with" block, will the file still close?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/in-python-if-i-return-inside-a-with-block-will-the-file-still-close/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T22:05:43+08:00" itemprop="datePublished" title="2023-03-03 22:05">2023-03-03 22:05</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Consider the following:</p>
<div class="code"><pre class="code literal-block"><span class="nv">with</span><span class="w"> </span><span class="nv">open</span><span class="ss">(</span><span class="nv">path</span>,<span class="w"> </span><span class="nv">mode</span><span class="ss">)</span><span class="w"> </span><span class="nv">as</span><span class="w"> </span><span class="nv">f</span>:
<span class="w">    </span><span class="k">return</span><span class="w"> </span>[<span class="nv">line</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">line</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">f</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nv">condition</span>]
</pre></div>

<p>Will the file be closed properly, or does using <code>return</code> somehow bypass the
context manager?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Yes, it acts like the <code>finally</code> block after a <code>try</code> block, i.e. it always
executes (unless the python process terminates in an unusual way of course).</p>
<p>It is also mentioned in one of the examples of PEP-343 which is the
specification for the <code>with</code> statement:</p>
<div class="code"><pre class="code literal-block"><span class="nv">with</span><span class="w"> </span><span class="nv">locked</span><span class="ss">(</span><span class="nv">myLock</span><span class="ss">)</span>:
<span class="w">    </span>#<span class="w"> </span><span class="nv">Code</span><span class="w"> </span><span class="nv">here</span><span class="w"> </span><span class="nv">executes</span><span class="w"> </span><span class="nv">with</span><span class="w"> </span><span class="nv">myLock</span><span class="w"> </span><span class="nv">held</span>.<span class="w">  </span><span class="nv">The</span><span class="w"> </span><span class="nv">lock</span><span class="w"> </span><span class="nv">is</span>
<span class="w">    </span>#<span class="w"> </span><span class="nv">guaranteed</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">be</span><span class="w"> </span><span class="nv">released</span><span class="w"> </span><span class="nv">when</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">block</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">left</span><span class="w"> </span><span class="ss">(</span><span class="nv">even</span>
<span class="w">    </span>#<span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nv">via</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nv">or</span><span class="w"> </span><span class="nv">by</span><span class="w"> </span><span class="nv">an</span><span class="w"> </span><span class="nv">uncaught</span><span class="w"> </span><span class="nv">exception</span><span class="ss">)</span>.
</pre></div>

<p>Something worth mentioning is however, that you cannot easily catch exceptions
thrown by the <code>open()</code> call without putting the whole <code>with</code> block inside a
<code>try..except</code> block which is usually not what one wants.</p>
<p><br></p>
<h3>Suggest</h3>
<p>Yes.</p>
<div class="code"><pre class="code literal-block"><span class="nv">def</span><span class="w"> </span><span class="nv">example</span><span class="ss">(</span><span class="nv">path</span>,<span class="w"> </span><span class="nv">mode</span><span class="ss">)</span>:
<span class="w">    </span><span class="nv">with</span><span class="w"> </span><span class="nv">open</span><span class="ss">(</span><span class="nv">path</span>,<span class="w"> </span><span class="nv">mode</span><span class="ss">)</span><span class="w"> </span><span class="nv">as</span><span class="w"> </span><span class="nv">f</span>:
<span class="w">        </span><span class="k">return</span><span class="w"> </span>[<span class="nv">line</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">line</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">f</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nv">condition</span>]
</pre></div>

<p>..is pretty much equivalent to:</p>
<div class="code"><pre class="code literal-block"><span class="nv">def</span><span class="w"> </span><span class="nv">example</span><span class="ss">(</span><span class="nv">path</span>,<span class="w"> </span><span class="nv">mode</span><span class="ss">)</span>:
<span class="w">    </span><span class="nv">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">open</span><span class="ss">(</span><span class="nv">path</span>,<span class="w"> </span><span class="nv">mode</span><span class="ss">)</span>

<span class="w">    </span><span class="nv">try</span>:
<span class="w">        </span><span class="k">return</span><span class="w"> </span>[<span class="nv">line</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">line</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">f</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nv">condition</span>]
<span class="w">    </span><span class="nv">finally</span>:
<span class="w">        </span><span class="nv">f</span>.<span class="nv">close</span><span class="ss">()</span>
</pre></div>

<p>More accurately, the <code>__exit__</code> method in a context manager is always called
when exiting the block (regardless of exceptions, returns etc). The file
object's <code>__exit__</code> method just calls <code>f.close()</code> (e.g here in CPython)</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-do-i-debug-error-econnreset-in-node-js/" class="u-url">How do I debug error ECONNRESET in Node.js?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-do-i-debug-error-econnreset-in-node-js/" rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T22:04:25+08:00" itemprop="datePublished" title="2023-03-03 22:04">2023-03-03 22:04</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I'm running an Express.js application using Socket.io for a chat webapp and I
get the following error randomly around 5 times during 24h. The node process
is wrapped in forever and it restarts itself immediately.</p>
<p>The problem is that restarting Express kicks my users out of their rooms and
nobody wants that.</p>
<p>The web server is proxied by HAProxy. There are no socket stability issues,
just using websockets and flashsockets transports. I cannot reproduce this on
purpose.</p>
<p>This is the error with Node <code>v0.10.11</code>:</p>
<div class="code"><pre class="code literal-block"><span class="w">    </span><span class="nt">events</span><span class="p">.</span><span class="nc">js</span><span class="p">:</span><span class="nd">72</span>
<span class="w">            </span><span class="nt">throw</span><span class="w"> </span><span class="nt">er</span><span class="o">;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nt">Unhandled</span><span class="w"> </span><span class="s1">'error'</span><span class="w"> </span><span class="nt">event</span>
<span class="w">                  </span><span class="o">^</span>
<span class="w">    </span><span class="nt">Error</span><span class="o">:</span><span class="w"> </span><span class="nt">read</span><span class="w"> </span><span class="nt">ECONNRESET</span><span class="w">     </span><span class="o">//</span><span class="nt">alternatively</span><span class="w"> </span><span class="nt">it</span><span class="w"> </span><span class="nt">s</span><span class="w"> </span><span class="nt">a</span><span class="w"> </span><span class="s1">'write'</span>
<span class="w">        </span><span class="nt">at</span><span class="w"> </span><span class="nt">errnoException</span><span class="w"> </span><span class="o">(</span><span class="nt">net</span><span class="p">.</span><span class="nc">js</span><span class="p">:</span><span class="nd">900</span><span class="p">:</span><span class="nd">11</span><span class="o">)</span>
<span class="w">        </span><span class="nt">at</span><span class="w"> </span><span class="nt">TCP</span><span class="p">.</span><span class="nc">onread</span><span class="w"> </span><span class="o">(</span><span class="nt">net</span><span class="p">.</span><span class="nc">js</span><span class="p">:</span><span class="nd">555</span><span class="p">:</span><span class="nd">19</span><span class="o">)</span>
<span class="w">    </span><span class="nt">error</span><span class="o">:</span><span class="w"> </span><span class="nt">Forever</span><span class="w"> </span><span class="nt">detected</span><span class="w"> </span><span class="nt">script</span><span class="w"> </span><span class="nt">exited</span><span class="w"> </span><span class="nt">with</span><span class="w"> </span><span class="nt">code</span><span class="o">:</span><span class="w"> </span><span class="nt">8</span>
<span class="w">    </span><span class="nt">error</span><span class="o">:</span><span class="w"> </span><span class="nt">Forever</span><span class="w"> </span><span class="nt">restarting</span><span class="w"> </span><span class="nt">script</span><span class="w"> </span><span class="nt">for</span><span class="w"> </span><span class="nt">2</span><span class="w"> </span><span class="nt">time</span>
</pre></div>

<p><strong>EDIT (2013-07-22)</strong></p>
<p>Added both socket.io client error handler and the uncaught exception handler.
Seems that this one catches the error:</p>
<div class="code"><pre class="code literal-block">    process.on('uncaughtException', function (err) {
      console.error(err.stack);
      console.log("Node NOT Exiting...");
    });
</pre></div>

<p>So I suspect it's not a Socket.io issue but an HTTP request to another server
that I do or a MySQL/Redis connection. The problem is that the error stack
doesn't help me identify my code issue. Here is the log output:</p>
<div class="code"><pre class="code literal-block">    Error: read ECONNRESET
        at errnoException (net.js:900:11)
        at TCP.onread (net.js:555:19)
</pre></div>

<p>How do I know what causes this? How do I get more out of the error?</p>
<p>Ok, not very verbose but here's the stacktrace with Longjohn:</p>
<div class="code"><pre class="code literal-block"><span class="w">    </span><span class="k">Exception</span><span class="w"> </span><span class="nl">caught</span><span class="p">:</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="n">ECONNRESET</span>
<span class="w">    </span><span class="err">{</span><span class="w"> </span><span class="o">[</span><span class="n">Error: read ECONNRESET</span><span class="o">]</span>
<span class="w">      </span><span class="nl">code</span><span class="p">:</span><span class="w"> </span><span class="s1">'ECONNRESET'</span><span class="p">,</span>
<span class="w">      </span><span class="nl">errno</span><span class="p">:</span><span class="w"> </span><span class="s1">'ECONNRESET'</span><span class="p">,</span>
<span class="w">      </span><span class="nl">syscall</span><span class="p">:</span><span class="w"> </span><span class="s1">'read'</span><span class="p">,</span>
<span class="w">      </span><span class="nl">__cached_trace__</span><span class="p">:</span>
<span class="w">       </span><span class="o">[</span><span class="n"> { receiver: [Object</span><span class="o">]</span><span class="p">,</span>
<span class="w">           </span><span class="nl">fun</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="n">Function: errnoException</span><span class="o">]</span><span class="p">,</span>
<span class="w">           </span><span class="nl">pos</span><span class="p">:</span><span class="w"> </span><span class="mi">22930</span><span class="w"> </span><span class="err">}</span><span class="p">,</span>
<span class="w">         </span><span class="err">{</span><span class="w"> </span><span class="nl">receiver</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="n">Object</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="nl">fun</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="n">Function: onread</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="nl">pos</span><span class="p">:</span><span class="w"> </span><span class="mi">14545</span><span class="w"> </span><span class="err">}</span><span class="p">,</span>
<span class="w">         </span><span class="err">{}</span><span class="p">,</span>
<span class="w">         </span><span class="err">{</span><span class="w"> </span><span class="nl">receiver</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="n">Object</span><span class="o">]</span><span class="p">,</span>
<span class="w">           </span><span class="nl">fun</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="n">Function: fireErrorCallbacks</span><span class="o">]</span><span class="p">,</span>
<span class="w">           </span><span class="nl">pos</span><span class="p">:</span><span class="w"> </span><span class="mi">11672</span><span class="w"> </span><span class="err">}</span><span class="p">,</span>
<span class="w">         </span><span class="err">{</span><span class="w"> </span><span class="nl">receiver</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="n">Object</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="nl">fun</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="n">Function</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="nl">pos</span><span class="p">:</span><span class="w"> </span><span class="mi">12329</span><span class="w"> </span><span class="err">}</span><span class="p">,</span>
<span class="w">         </span><span class="err">{</span><span class="w"> </span><span class="nl">receiver</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="n">Object</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="nl">fun</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="n">Function: onread</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="nl">pos</span><span class="p">:</span><span class="w"> </span><span class="mi">14536</span><span class="w"> </span><span class="err">}</span><span class="w"> </span><span class="err">]</span><span class="p">,</span>
<span class="w">      </span><span class="nl">__previous__</span><span class="p">:</span>
<span class="w">       </span><span class="err">{</span><span class="w"> </span><span class="o">[</span><span class="n">Error</span><span class="o">]</span>
<span class="w">         </span><span class="nl">id</span><span class="p">:</span><span class="w"> </span><span class="mi">1061835</span><span class="p">,</span>
<span class="w">         </span><span class="nl">location</span><span class="p">:</span><span class="w"> </span><span class="s1">'fireErrorCallbacks (net.js:439)'</span><span class="p">,</span>
<span class="w">         </span><span class="nl">__location__</span><span class="p">:</span><span class="w"> </span><span class="s1">'process.nextTick'</span><span class="p">,</span>
<span class="w">         </span><span class="nl">__previous__</span><span class="p">:</span><span class="w"> </span><span class="k">null</span><span class="p">,</span>
<span class="w">         </span><span class="nl">__trace_count__</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">         </span><span class="nl">__cached_trace__</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="n"> [Object</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="o">[</span><span class="n">Object</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="o">[</span><span class="n">Object</span><span class="o">]</span><span class="w"> </span><span class="err">]</span><span class="w"> </span><span class="err">}</span><span class="w"> </span><span class="err">}</span>
</pre></div>

<p>Here I serve the flash socket policy file:</p>
<div class="code"><pre class="code literal-block"><span class="w">    </span>net<span class="w"> </span>=<span class="w"> </span>require("net")
<span class="w">    </span>net.createServer(<span class="w"> </span>(socket)<span class="w"> </span>=&gt;
<span class="w">      </span>socket.write("<span class="cp">&lt;?xml version=\"1.0\"?&gt;</span>\n")
<span class="w">      </span>socket.write("<span class="cp">&lt;!DOCTYPE cross-domain-policy SYSTEM \"http://www.macromedia.com/xml/dtds/cross-domain-policy.dtd\"&gt;</span>\n")
<span class="w">      </span>socket.write("<span class="nt">&lt;cross-domain-policy&gt;</span>\n")
<span class="w">      </span>socket.write("<span class="nt">&lt;allow-access-from</span><span class="w"> </span><span class="na">domain=</span><span class="s">\"*\"</span><span class="w"> </span><span class="na">to-ports=</span><span class="s">\"*\"/</span><span class="nt">&gt;</span>\n")
<span class="w">      </span>socket.write("<span class="nt">&lt;/cross-domain-policy&gt;</span>\n")
<span class="w">      </span>socket.end()
<span class="w">    </span>).listen(843)
</pre></div>

<p>Can this be the cause?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>A simple tcp server I had for serving the flash policy file was causing this.
I can now catch the error using a handler:</p>
<div class="code"><pre class="code literal-block">#<span class="w"> </span>serving<span class="w"> </span>the<span class="w"> </span>flash<span class="w"> </span>policy<span class="w"> </span>file
net<span class="w"> </span>=<span class="w"> </span>require("net")

net.createServer((socket)<span class="w"> </span>=&gt;
<span class="w">  </span>//just<span class="w"> </span>added
<span class="w">  </span>socket.on("error",<span class="w"> </span>(err)<span class="w"> </span>=&gt;
<span class="w">    </span>console.log("Caught<span class="w"> </span>flash<span class="w"> </span>policy<span class="w"> </span>server<span class="w"> </span>socket<span class="w"> </span>error:<span class="w"> </span>")
<span class="w">    </span>console.log(err.stack)
<span class="w">  </span>)

<span class="w">  </span>socket.write("<span class="cp">&lt;?xml version=\"1.0\"?&gt;</span>\n")
<span class="w">  </span>socket.write("<span class="cp">&lt;!DOCTYPE cross-domain-policy SYSTEM \"http://www.macromedia.com/xml/dtds/cross-domain-policy.dtd\"&gt;</span>\n")
<span class="w">  </span>socket.write("<span class="nt">&lt;cross-domain-policy&gt;</span>\n")
<span class="w">  </span>socket.write("<span class="nt">&lt;allow-access-from</span><span class="w"> </span><span class="na">domain=</span><span class="s">\"*\"</span><span class="w"> </span><span class="na">to-ports=</span><span class="s">\"*\"/</span><span class="nt">&gt;</span>\n")
<span class="w">  </span>socket.write("<span class="nt">&lt;/cross-domain-policy&gt;</span>\n")
<span class="w">  </span>socket.end()
).listen(843)
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>A simple tcp server I had for serving the flash policy file was causing this.
I can now catch the error using a handler:</p>
<div class="code"><pre class="code literal-block">#<span class="w"> </span>serving<span class="w"> </span>the<span class="w"> </span>flash<span class="w"> </span>policy<span class="w"> </span>file
net<span class="w"> </span>=<span class="w"> </span>require("net")

net.createServer((socket)<span class="w"> </span>=&gt;
<span class="w">  </span>//just<span class="w"> </span>added
<span class="w">  </span>socket.on("error",<span class="w"> </span>(err)<span class="w"> </span>=&gt;
<span class="w">    </span>console.log("Caught<span class="w"> </span>flash<span class="w"> </span>policy<span class="w"> </span>server<span class="w"> </span>socket<span class="w"> </span>error:<span class="w"> </span>")
<span class="w">    </span>console.log(err.stack)
<span class="w">  </span>)

<span class="w">  </span>socket.write("<span class="cp">&lt;?xml version=\"1.0\"?&gt;</span>\n")
<span class="w">  </span>socket.write("<span class="cp">&lt;!DOCTYPE cross-domain-policy SYSTEM \"http://www.macromedia.com/xml/dtds/cross-domain-policy.dtd\"&gt;</span>\n")
<span class="w">  </span>socket.write("<span class="nt">&lt;cross-domain-policy&gt;</span>\n")
<span class="w">  </span>socket.write("<span class="nt">&lt;allow-access-from</span><span class="w"> </span><span class="na">domain=</span><span class="s">\"*\"</span><span class="w"> </span><span class="na">to-ports=</span><span class="s">\"*\"/</span><span class="nt">&gt;</span>\n")
<span class="w">  </span>socket.write("<span class="nt">&lt;/cross-domain-policy&gt;</span>\n")
<span class="w">  </span>socket.end()
).listen(843)
</pre></div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-2197.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-2195.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
