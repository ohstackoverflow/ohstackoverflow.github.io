<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 1135) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-1135.html">
<link rel="prev" href="index-1136.html" type="text/html">
<link rel="next" href="index-1134.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/programmatic-equivalent-of-default-type/" class="u-url">Programmatic equivalent of default(Type)</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/programmatic-equivalent-of-default-type/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T02:05:06+08:00" itemprop="datePublished" title="2023-02-18 02:05">2023-02-18 02:05</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I'm using reflection to loop through a <code>Type</code>'s properties and set certain
types to their default. Now, I could do a switch on the type and set the
<code>default(Type)</code> explicitly, but I'd rather do it in one line. Is there a
programmatic equivalent of default?</p>
<p><br><br></p>
<h2>Answer</h2>
<ul>
<li>In case of a value type use Activator.CreateInstance and it should work fine.</li>
<li>
<p>When using reference type just return null</p>
<p>public static object GetDefault(Type type)
{
   if(type.IsValueType)
   {
      return Activator.CreateInstance(type);
   }
   return null;
}</p>
</li>
</ul>
<p>In the newer version of .net such as .net standard, <code>type.IsValueType</code> needs
to be written as <code>type.GetTypeInfo().IsValueType</code></p>
<p><br></p>
<h3>Suggest</h3>
<p>Why not call the method that returns default(T) with reflection ? You can use
GetDefault of any type with:</p>
<div class="code"><pre class="code literal-block"><span class="w">    </span><span class="nv">public</span><span class="w"> </span><span class="nv">object</span><span class="w"> </span><span class="nv">GetDefault</span><span class="ss">(</span><span class="nv">Type</span><span class="w"> </span><span class="nv">t</span><span class="ss">)</span>
<span class="w">    </span>{
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nv">this</span>.<span class="nv">GetType</span><span class="ss">()</span>.<span class="nv">GetMethod</span><span class="ss">(</span><span class="s2">"GetDefaultGeneric"</span><span class="ss">)</span>.<span class="nv">MakeGenericMethod</span><span class="ss">(</span><span class="nv">t</span><span class="ss">)</span>.<span class="nv">Invoke</span><span class="ss">(</span><span class="nv">this</span>,<span class="w"> </span><span class="nv">null</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">    </span>}

<span class="w">    </span><span class="nv">public</span><span class="w"> </span><span class="nv">T</span><span class="w"> </span><span class="nv">GetDefaultGeneric</span><span class="o">&lt;</span><span class="nv">T</span><span class="o">&gt;</span><span class="ss">()</span>
<span class="w">    </span>{
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nv">default</span><span class="ss">(</span><span class="nv">T</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">    </span>}
</pre></div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-to-request-a-random-row-in-sql/" class="u-url">How to request a random row in SQL?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-to-request-a-random-row-in-sql/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T02:04:33+08:00" itemprop="datePublished" title="2023-02-18 02:04">2023-02-18 02:04</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>How can I request a random row (or as close to truly random as is possible) in
pure SQL?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>See this post: SQL to Select a random row from a database table. It goes
through methods for doing this in MySQL, PostgreSQL, Microsoft SQL Server, IBM
DB2 and Oracle (the following is copied from that link):</p>
<p>Select a random row with MySQL:</p>
<div class="code"><pre class="code literal-block">SELECT column FROM table
ORDER BY RAND()
LIMIT 1
</pre></div>

<p>Select a random row with PostgreSQL:</p>
<div class="code"><pre class="code literal-block"><span class="nv">SELECT</span><span class="w"> </span><span class="nv">column</span><span class="w"> </span><span class="nv">FROM</span><span class="w"> </span><span class="nv">table</span>
<span class="nv">ORDER</span><span class="w"> </span><span class="nv">BY</span><span class="w"> </span><span class="k">RANDOM</span><span class="ss">()</span>
<span class="nv">LIMIT</span><span class="w"> </span><span class="mi">1</span>
</pre></div>

<p>Select a random row with Microsoft SQL Server:</p>
<div class="code"><pre class="code literal-block">SELECT TOP 1 column FROM table
ORDER BY NEWID()
</pre></div>

<p>Select a random row with IBM DB2</p>
<div class="code"><pre class="code literal-block">SELECT column, RAND() as IDX 
FROM table 
ORDER BY IDX FETCH FIRST 1 ROWS ONLY
</pre></div>

<p>Select a random record with Oracle:</p>
<div class="code"><pre class="code literal-block">SELECT column FROM
( SELECT column FROM table
ORDER BY dbms_random.value )
WHERE rownum = 1
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>Solutions like Jeremies:</p>
<div class="code"><pre class="code literal-block">SELECT * FROM table ORDER BY RAND() LIMIT 1
</pre></div>

<p>work, but they need a sequential scan of all the table (because the random
value associated with each row needs to be calculated - so that the smallest
one can be determined), which can be quite slow for even medium sized tables.
My recommendation would be to use some kind of indexed numeric column (many
tables have these as their primary keys), and then write something like:</p>
<div class="code"><pre class="code literal-block">SELECT * FROM table WHERE num_value &gt;= RAND() * 
    ( SELECT MAX (num_value ) FROM table ) 
ORDER BY num_value LIMIT 1
</pre></div>

<p>This works in logarithmic time, regardless of the table size, if <code>num_value</code>
is indexed. One caveat: this assumes that <code>num_value</code> is equally distributed
in the range <code>0..MAX(num_value)</code>. If your dataset strongly deviates from this
assumption, you will get skewed results (some rows will appear more often than
others).</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/how-do-i-find-the-location-of-python-module-sources/" class="u-url">How do I find the location of Python module sources?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/how-do-i-find-the-location-of-python-module-sources/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T02:04:05+08:00" itemprop="datePublished" title="2023-02-18 02:04">2023-02-18 02:04</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>How do I learn where the source file for a given Python module is installed?
Is the method different on Windows than on Linux?</p>
<p>I'm trying to look for the source of the <code>datetime</code> module in particular, but
I'm interested in a more general answer as well.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>For a pure python module you can find the source by looking at
<code>themodule.__file__</code>. The datetime module, however, is written in C, and
therefore <code>datetime.__file__</code> points to a .so file (there is no
<code>datetime.__file__</code> on Windows), and therefore, you can't see the source.</p>
<p>If you download a python source tarball and extract it, the modules' code can
be found in the <strong>Modules</strong> subdirectory.</p>
<p>For example, if you want to find the datetime code for python 2.6, you can
look at</p>
<div class="code"><pre class="code literal-block">Python-2.6/Modules/datetimemodule.c
</pre></div>

<p>You can also find the latest version of this file on github on the web at
https://github.com/python/cpython/blob/main/Modules/_datetimemodule.c</p>
<p><br></p>
<h3>Suggest</h3>
<p>Running <code>python -v</code> from the command line should tell you what is being
imported and from where. This works for me on Windows and Mac OS X.</p>
<div class="code"><pre class="code literal-block"><span class="n">C</span><span class="p">:</span>\<span class="o">&gt;</span><span class="n">python</span> <span class="o">-</span><span class="n">v</span>
<span class="c1"># installing zipimport hook</span>
<span class="kn">import</span> <span class="nn">zipimport</span> <span class="c1"># builtin</span>
<span class="c1"># installed zipimport hook</span>
<span class="c1"># C:\Python24\lib\site.pyc has bad mtime</span>
<span class="kn">import</span> <span class="nn">site</span> <span class="c1"># from C:\Python24\lib\site.py</span>
<span class="c1"># wrote C:\Python24\lib\site.pyc</span>
<span class="c1"># C:\Python24\lib\os.pyc has bad mtime</span>
<span class="kn">import</span> <span class="nn">os</span> <span class="c1"># from C:\Python24\lib\os.py</span>
<span class="c1"># wrote C:\Python24\lib\os.pyc</span>
<span class="kn">import</span> <span class="nn">nt</span> <span class="c1"># builtin</span>
<span class="c1"># C:\Python24\lib\ntpath.pyc has bad mtime</span>
<span class="o">...</span>
</pre></div>

<p>I'm not sure what those bad mtime's are on my install!</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-1136.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-1134.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
