<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a snapshot site for StackOverflow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>StackOverflow Snapshot (old posts, page 577) | StackOverflow Snapshot</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/index-577.html">
<link rel="prev" href="index-578.html" type="text/html">
<link rel="next" href="index-576.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/moment-js-transform-to-date-object/" class="u-url">Moment.js transform to date object</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/moment-js-transform-to-date-object/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T10:26:08+08:00" itemprop="datePublished" title="2023-02-17 10:26">2023-02-17 10:26</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>Using Moment.js I can't transform a correct moment object to a date object
with timezones. I can't get the correct date.</p>
<p><strong>Example:</strong></p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">oldDate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">Date</span><span class="p">(),</span>
<span class="w">    </span><span class="n">momentObj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">moment</span><span class="p">(</span><span class="n">oldDate</span><span class="p">)</span><span class="o">.</span><span class="n">tz</span><span class="p">(</span><span class="s2">"MST7MDT"</span><span class="p">),</span>
<span class="w">    </span><span class="n">newDate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">momentObj</span><span class="o">.</span><span class="n">toDate</span><span class="p">();</span>
<span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">"start date "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">oldDate</span><span class="p">)</span>
<span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">"Format from moment with offset "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">momentObj</span><span class="o">.</span><span class="n">format</span><span class="p">())</span>
<span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">"Format from moment without offset "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">momentObj</span><span class="o">.</span><span class="n">utc</span><span class="p">()</span><span class="o">.</span><span class="n">format</span><span class="p">())</span>
<span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">"(Date object) Time with offset "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">newDate</span><span class="p">)</span>
<span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">"(Date object) Time without offset "</span><span class="o">+</span><span class="w"> </span><span class="n">moment</span><span class="o">.</span><span class="n">utc</span><span class="p">(</span><span class="n">newDate</span><span class="p">)</span><span class="o">.</span><span class="n">toDate</span><span class="p">())</span>
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<p>Use this to transform a moment object into a date object:</p>
<p>From http://momentjs.com/docs/#/displaying/as-javascript-date/</p>
<div class="code"><pre class="code literal-block">moment().toDate();
</pre></div>

<p>Yields:</p>
<div class="code"><pre class="code literal-block">Tue Nov 04 2014 14:04:01 GMT-0600 (CST)
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>As long as you have initialized moment-timezone with the data for the zones
you want, your code works as expected.</p>
<p>You are correctly converting the moment to the time zone, which is reflected
in the second line of output from <code>momentObj.format()</code>.</p>
<p>Switching to UTC doesn't just drop the offset, it changes back to the UTC time
zone. If you're going to do that, you don't need the original <code>.tz()</code> call at
all. You could just do <code>moment.utc()</code>.</p>
<p>Perhaps you are just trying to change the output format string? If so, just
specify the parameters you want to the <code>format</code> method:</p>
<div class="code"><pre class="code literal-block">momentObj.format("YYYY-MM-DD HH:mm:ss")
</pre></div>

<p>Regarding the last to lines of your code - when you go back to a <code>Date</code> object
using <code>toDate()</code>, you are giving up the behavior of moment.js and going back
to JavaScript's behavior. A JavaScript <code>Date</code> object will always be printed in
the local time zone of the computer it's running on. There's nothing moment.js
can do about that.</p>
<p>A couple of other little things:</p>
<ul>
<li>
<p>While the moment constructor <em>can</em> take a <code>Date</code>, it is usually best to not use one. For "now", don't use <code>moment(new Date())</code>. Instead, just use <code>moment()</code>. Both will work but it's unnecessarily redundant. If you are parsing from a string, pass that string directly into moment. Don't try to parse it to a <code>Date</code> first. You will find moment's parser to be much more reliable.</p>
</li>
<li>
<p>Time Zones like <code>MST7MDT</code> are there for backwards compatibility reasons. They stem from POSIX style time zones, and only a few of them are in the TZDB data. Unless absolutely necessary, you should use a key such as <code>America/Denver</code>.</p>
</li>
</ul>
</div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/entity-framework-5-updating-a-record/" class="u-url">Entity Framework 5 Updating a Record</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/entity-framework-5-updating-a-record/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T10:25:35+08:00" itemprop="datePublished" title="2023-02-17 10:25">2023-02-17 10:25</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>I have been exploring different methods of editing/updating a record within
Entity Framework 5 in an ASP.NET MVC3 environment, but so far none of them
tick all of the boxes I need. I'll explain why.</p>
<p>I have found three methods to which I'll mention the pros and cons:</p>
<p><strong>Method 1 - Load original record, update each property</strong></p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">original</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">db</span><span class="o">.</span><span class="n">Users</span><span class="o">.</span><span class="n">Find</span><span class="p">(</span><span class="n">updatedUser</span><span class="o">.</span><span class="n">UserId</span><span class="p">);</span>

<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">original</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb nb-Type">null</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">original</span><span class="o">.</span><span class="n">BusinessEntityId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">updatedUser</span><span class="o">.</span><span class="n">BusinessEntityId</span><span class="p">;</span>
<span class="w">    </span><span class="n">original</span><span class="o">.</span><span class="n">Email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">updatedUser</span><span class="o">.</span><span class="n">Email</span><span class="p">;</span>
<span class="w">    </span><span class="n">original</span><span class="o">.</span><span class="n">EmployeeId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">updatedUser</span><span class="o">.</span><span class="n">EmployeeId</span><span class="p">;</span>
<span class="w">    </span><span class="n">original</span><span class="o">.</span><span class="n">Forename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">updatedUser</span><span class="o">.</span><span class="n">Forename</span><span class="p">;</span>
<span class="w">    </span><span class="n">original</span><span class="o">.</span><span class="n">Surname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">updatedUser</span><span class="o">.</span><span class="n">Surname</span><span class="p">;</span>
<span class="w">    </span><span class="n">original</span><span class="o">.</span><span class="n">Telephone</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">updatedUser</span><span class="o">.</span><span class="n">Telephone</span><span class="p">;</span>
<span class="w">    </span><span class="n">original</span><span class="o">.</span><span class="n">Title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">updatedUser</span><span class="o">.</span><span class="n">Title</span><span class="p">;</span>
<span class="w">    </span><span class="n">original</span><span class="o">.</span><span class="n">Fax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">updatedUser</span><span class="o">.</span><span class="n">Fax</span><span class="p">;</span>
<span class="w">    </span><span class="n">original</span><span class="o">.</span><span class="n">ASPNetUserId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">updatedUser</span><span class="o">.</span><span class="n">ASPNetUserId</span><span class="p">;</span>
<span class="w">    </span><span class="n">db</span><span class="o">.</span><span class="n">SaveChanges</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>

<p><em>Pros</em></p>
<ul>
<li>Can specify which properties change</li>
<li>Views don't need to contain every property</li>
</ul>
<p><em>Cons</em></p>
<ul>
<li>2 x queries on database to load original then update it</li>
</ul>
<p><strong>Method 2 - Load original record, set changed values</strong></p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">original</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">db</span><span class="o">.</span><span class="n">Users</span><span class="o">.</span><span class="n">Find</span><span class="p">(</span><span class="n">updatedUser</span><span class="o">.</span><span class="n">UserId</span><span class="p">);</span>

<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">original</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb nb-Type">null</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">db</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">original</span><span class="p">)</span><span class="o">.</span><span class="n">CurrentValues</span><span class="o">.</span><span class="n">SetValues</span><span class="p">(</span><span class="n">updatedUser</span><span class="p">);</span>
<span class="w">    </span><span class="n">db</span><span class="o">.</span><span class="n">SaveChanges</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>

<p><em>Pros</em></p>
<ul>
<li>Only modified properties are sent to database</li>
</ul>
<p><em>Cons</em></p>
<ul>
<li>Views need to contain every property</li>
<li>2 x queries on database to load original then update it</li>
</ul>
<p><strong>Method 3 - Attach updated record and set state to EntityState.Modified</strong></p>
<div class="code"><pre class="code literal-block">db.Users.Attach(updatedUser);
db.Entry(updatedUser).State = EntityState.Modified;
db.SaveChanges();
</pre></div>

<p><em>Pros</em></p>
<ul>
<li>1 x query on database to update</li>
</ul>
<p><em>Cons</em></p>
<ul>
<li>Can't specify which properties change</li>
<li>Views must contain every property</li>
</ul>
<p><strong>Question</strong></p>
<p>My question to you guys; is there a clean way that I can achieve this set of
goals?</p>
<ul>
<li>Can specify which properties change</li>
<li>Views don't need to contain every property (such as password!)</li>
<li>1 x query on database to update</li>
</ul>
<p>I understand this is quite a minor thing to point out but I may be missing a
simple solution to this. If not method one will prevail ;-)</p>
<p><br><br></p>
<h2>Answer</h2>
<p>You are looking for:</p>
<div class="code"><pre class="code literal-block"><span class="n">db</span><span class="o">.</span><span class="n">Users</span><span class="o">.</span><span class="n">Attach</span><span class="p">(</span><span class="n">updatedUser</span><span class="p">);</span>
<span class="k">var</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">db</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">updatedUser</span><span class="p">);</span>
<span class="n">entry</span><span class="o">.</span><span class="n">Property</span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">e</span><span class="o">.</span><span class="n">Email</span><span class="p">)</span><span class="o">.</span><span class="n">IsModified</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">true</span><span class="p">;</span>
<span class="o">//</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">changed</span><span class="w"> </span><span class="n">properties</span>
<span class="n">db</span><span class="o">.</span><span class="n">SaveChanges</span><span class="p">();</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>I really like the accepted answer. I believe there is yet another way to
approach this as well. Let's say you have a very short list of properties that
you wouldn't want to ever include in a View, so when updating the entity,
those would be omitted. Let's say that those two fields are Password and SSN.</p>
<div class="code"><pre class="code literal-block"><span class="n">db</span><span class="o">.</span><span class="n">Users</span><span class="o">.</span><span class="n">Attach</span><span class="p">(</span><span class="n">updatedUser</span><span class="p">);</span>

<span class="k">var</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">db</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">updatedUser</span><span class="p">);</span>
<span class="n">entry</span><span class="o">.</span><span class="n">State</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EntityState</span><span class="o">.</span><span class="n">Modified</span><span class="p">;</span>

<span class="n">entry</span><span class="o">.</span><span class="n">Property</span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">e</span><span class="o">.</span><span class="n">Password</span><span class="p">)</span><span class="o">.</span><span class="n">IsModified</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">false</span><span class="p">;</span>
<span class="n">entry</span><span class="o">.</span><span class="n">Property</span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">e</span><span class="o">.</span><span class="n">SSN</span><span class="p">)</span><span class="o">.</span><span class="n">IsModified</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">false</span><span class="p">;</span>

<span class="n">db</span><span class="o">.</span><span class="n">SaveChanges</span><span class="p">();</span>
</pre></div>

<p>This example allows you to essentially leave your business logic alone after
adding a new field to your Users table and to your View.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/url-encoding-the-space-character-or-20/" class="u-url">URL encoding the space character: + or %20?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="posts/url-encoding-the-space-character-or-20/" rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T10:25:10+08:00" itemprop="datePublished" title="2023-02-17 10:25">2023-02-17 10:25</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <p>When is a space in a URL encoded to <code>+</code>, and when is it encoded to <code>%20</code>?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>From Wikipedia (emphasis and link added):</p>
<blockquote>
<p>When data that has been entered into HTML forms is submitted, the form field
names and values are encoded and sent to the server in an HTTP request
message using method GET or POST, or, historically, via email. <strong>The
encoding used by default is based on a very early version of the general URI
percent-encoding rules, with a number of modifications such as newline
normalization and replacing spaces with "+" instead of "%20".</strong> The MIME
type of data encoded this way is application/x-www-form-urlencoded, and it
is currently defined (still in a very outdated manner) in the HTML and
XForms specifications.</p>
</blockquote>
<p>So, the <em>real</em> percent encoding uses <code>%20</code> while form data in URLs is in a
modified form that uses <code>+</code>. So you're most likely to only see <code>+</code> in URLs in
the query string after an <code>?</code>.</p>
<p><br></p>
<h3>Suggest</h3>
<p>This confusion is because URLs are still 'broken' to this day.</p>
<p>From a blog post:</p>
<blockquote>
<p>Take "http://www.google.com" for instance. This is a URL. A URL is a Uniform
Resource Locator and is really a pointer to a web page (in most cases). URLs
actually have a very well-defined structure since the first specification in
1994.</p>
<p>We can extract detailed information about the "http://www.google.com" URL:</p>
<div class="code"><pre class="code literal-block"><span class="nb">+---------------+-------------------+</span>
<span class="c">|      Part     |      Data         |</span>
<span class="nb">+---------------+-------------------+</span>
<span class="c">|  Scheme       | http              |</span>
<span class="c">|  Host         | www</span><span class="nt">.</span><span class="c">google</span><span class="nt">.</span><span class="c">com    |</span>
<span class="nb">+---------------+-------------------+</span>
</pre></div>

<p>If we look at a more complex URL such as:</p>
<p>"https://bob:bobby@www.lunatech.com:8080/file;p=1?q=2#third"</p>
<p>we can extract the following information:</p>
<div class="code"><pre class="code literal-block"><span class="o">+-------------------+---------------------+</span>
<span class="o">|</span><span class="w">        </span><span class="n">Part</span><span class="w">       </span><span class="o">|</span><span class="w">       </span><span class="k">Data</span><span class="w">          </span><span class="o">|</span>
<span class="o">+-------------------+---------------------+</span>
<span class="o">|</span><span class="w">  </span><span class="n">Scheme</span><span class="w">           </span><span class="o">|</span><span class="w"> </span><span class="n">https</span><span class="w">               </span><span class="o">|</span>
<span class="o">|</span><span class="w">  </span><span class="k">User</span><span class="w">             </span><span class="o">|</span><span class="w"> </span><span class="n">bob</span><span class="w">                 </span><span class="o">|</span>
<span class="o">|</span><span class="w">  </span><span class="n">Password</span><span class="w">         </span><span class="o">|</span><span class="w"> </span><span class="n">bobby</span><span class="w">               </span><span class="o">|</span>
<span class="o">|</span><span class="w">  </span><span class="k">Host</span><span class="w">             </span><span class="o">|</span><span class="w"> </span><span class="n">www</span><span class="p">.</span><span class="n">lunatech</span><span class="p">.</span><span class="n">com</span><span class="w">    </span><span class="o">|</span>
<span class="o">|</span><span class="w">  </span><span class="n">Port</span><span class="w">             </span><span class="o">|</span><span class="w"> </span><span class="mi">8080</span><span class="w">                </span><span class="o">|</span>
<span class="o">|</span><span class="w">  </span><span class="k">Path</span><span class="w">             </span><span class="o">|</span><span class="w"> </span><span class="o">/</span><span class="k">file</span><span class="p">;</span><span class="n">p</span><span class="o">=</span><span class="mi">1</span><span class="w">           </span><span class="o">|</span>
<span class="o">|</span><span class="w">  </span><span class="k">Path</span><span class="w"> </span><span class="k">parameter</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="n">p</span><span class="o">=</span><span class="mi">1</span><span class="w">                 </span><span class="o">|</span>
<span class="o">|</span><span class="w">  </span><span class="n">Query</span><span class="w">            </span><span class="o">|</span><span class="w"> </span><span class="n">q</span><span class="o">=</span><span class="mi">2</span><span class="w">                 </span><span class="o">|</span>
<span class="o">|</span><span class="w">  </span><span class="n">Fragment</span><span class="w">         </span><span class="o">|</span><span class="w"> </span><span class="n">third</span><span class="w">               </span><span class="o">|</span>
<span class="o">+-------------------+---------------------+</span>

<span class="nl">https</span><span class="p">:</span><span class="o">//</span><span class="nl">bob</span><span class="p">:</span><span class="n">bobby</span><span class="nv">@www</span><span class="p">.</span><span class="n">lunatech</span><span class="p">.</span><span class="nl">com</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="k">file</span><span class="p">;</span><span class="n">p</span><span class="o">=</span><span class="mi">1</span><span class="vm">?</span><span class="n">q</span><span class="o">=</span><span class="mi">2</span><span class="n">#third</span>
<span class="err">\</span><span class="n">___</span><span class="o">/</span><span class="w">   </span><span class="err">\</span><span class="n">_</span><span class="o">/</span><span class="w"> </span><span class="err">\</span><span class="n">___</span><span class="o">/</span><span class="w"> </span><span class="err">\</span><span class="n">______________</span><span class="o">/</span><span class="w"> </span><span class="err">\</span><span class="n">__</span><span class="o">/</span><span class="err">\</span><span class="n">_______</span><span class="o">/</span><span class="w"> </span><span class="err">\</span><span class="n">_</span><span class="o">/</span><span class="w"> </span><span class="err">\</span><span class="n">___</span><span class="o">/</span>
<span class="w">  </span><span class="o">|</span><span class="w">      </span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">          </span><span class="o">|</span><span class="w">          </span><span class="o">|</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="err">\</span><span class="n">_</span><span class="o">/</span><span class="w">  </span><span class="o">|</span><span class="w">    </span><span class="o">|</span>
<span class="n">Scheme</span><span class="w"> </span><span class="k">User</span><span class="w"> </span><span class="n">Password</span><span class="w">    </span><span class="k">Host</span><span class="w">       </span><span class="n">Port</span><span class="w">  </span><span class="k">Path</span><span class="w"> </span><span class="o">|</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="n">Fragment</span>
<span class="w">        </span><span class="err">\</span><span class="n">_____________________________</span><span class="o">/</span><span class="w">       </span><span class="o">|</span><span class="w"> </span><span class="n">Query</span>
<span class="w">                       </span><span class="o">|</span><span class="w">               </span><span class="k">Path</span><span class="w"> </span><span class="k">parameter</span>
<span class="w">                   </span><span class="n">Authority</span>
</pre></div>

<p>The reserved characters are different for each part.</p>
<p>For HTTP URLs, a space in a path fragment part has to be encoded to "%20"
(not, absolutely not "+"), while the "+" character in the path fragment part
can be left unencoded.</p>
<p>Now in the query part, spaces may be encoded to either "+" (for backwards
compatibility: do not try to search for it in the URI standard) or "%20"
while the "+" character (as a result of this ambiguity) has to be escaped to
"%2B".</p>
<p>This means that the "blue+light blue" string has to be encoded differently
in the path and query parts:</p>
<p>"http://example.com/blue+light%20blue?blue%2Blight+blue".</p>
<p>From there you can deduce that encoding a fully constructed URL is
impossible without a syntactical awareness of the URL structure.</p>
</blockquote>
<p>This boils down to:</p>
<p><strong>You should have<code>%20</code> before the <code>?</code> and <code>+</code> after.</strong></p>
<p>Source</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-578.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-576.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="assets/js/search.js"></script>
</body>
</html>
