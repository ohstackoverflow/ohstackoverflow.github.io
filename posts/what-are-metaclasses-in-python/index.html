<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>What are metaclasses in Python? | StackOverflow Snapshot</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/posts/what-are-metaclasses-in-python/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Arya">
<link rel="prev" href="../how-do-i-remove-a-property-from-a-javascript-object/" title="How do I remove a property from a JavaScript object?" type="text/html">
<link rel="next" href="../how-to-find-all-files-containing-specific-text-string-on-linux/" title="How to find all files containing specific text (string) on Linux?" type="text/html">
<meta property="og:site_name" content="StackOverflow Snapshot">
<meta property="og:title" content="What are metaclasses in Python?">
<meta property="og:url" content="https://ohstackoverflow.netlify.app/posts/what-are-metaclasses-in-python/">
<meta property="og:description" content="What are metaclasses? What are they used for?

Answer
A metaclass is the class of a class. A class defines how an instance of the
class (i.e. an object) behaves while a metaclass defines how a class b">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-02-16T18:28:02+08:00">
<meta property="article:tag" content="metaclass">
<meta property="article:tag" content="oop">
<meta property="article:tag" content="python">
<meta property="article:tag" content="python-class">
<meta property="article:tag" content="python-datamodel">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">What are metaclasses in Python?</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2023-02-16T18:28:02+08:00" itemprop="datePublished" title="2023-02-16 18:28">2023-02-16 18:28</time></a>
            </p>
            

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>What are metaclasses? What are they used for?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>A metaclass is the class of a class. A class defines how an instance of the
class (i.e. an object) behaves while a metaclass defines how a class behaves.
A class is an instance of a metaclass.</p>
<p>While in Python you can use arbitrary callables for metaclasses (like Jerub
shows), the better approach is to make it an actual class itself. <code>type</code> is
the usual metaclass in Python. <code>type</code> is itself a class, and it is its own
type. You won't be able to recreate something like <code>type</code> purely in Python,
but Python cheats a little. To create your own metaclass in Python you really
just want to subclass <code>type</code>.</p>
<p>A metaclass is most commonly used as a class-factory. When you create an
object by calling the class, Python creates a new class (when it executes the
'class' statement) by calling the metaclass. Combined with the normal
<code>__init__</code> and <code>__new__</code> methods, metaclasses therefore allow you to do 'extra
things' when creating a class, like registering the new class with some
registry or replace the class with something else entirely.</p>
<p>When the <code>class</code> statement is executed, Python first executes the body of the
<code>class</code> statement as a normal block of code. The resulting namespace (a dict)
holds the attributes of the class-to-be. The metaclass is determined by
looking at the baseclasses of the class-to-be (metaclasses are inherited), at
the <code>__metaclass__</code> attribute of the class-to-be (if any) or the
<code>__metaclass__</code> global variable. The metaclass is then called with the name,
bases and attributes of the class to instantiate it.</p>
<p>However, metaclasses actually define the <em>type</em> of a class, not just a factory
for it, so you can do much more with them. You can, for instance, define
normal methods on the metaclass. These metaclass-methods are like classmethods
in that they can be called on the class without an instance, but they are also
not like classmethods in that they cannot be called on an instance of the
class. <code>type.__subclasses__()</code> is an example of a method on the <code>type</code>
metaclass. You can also define the normal 'magic' methods, like <code>__add__</code>,
<code>__iter__</code> and <code>__getattr__</code>, to implement or change how the class behaves.</p>
<p>Here's an aggregated example of the bits and pieces:</p>
<div class="code"><pre class="code literal-block"><span class="n">def</span><span class="w"> </span><span class="n">make_hook</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="err">:</span>
<span class="w">    </span><span class="ss">"""Decorator to turn 'foo' method into '__foo__'"""</span>
<span class="w">    </span><span class="n">f</span><span class="p">.</span><span class="n">is_hook</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">f</span>

<span class="k">class</span><span class="w"> </span><span class="n">MyType</span><span class="p">(</span><span class="n">type</span><span class="p">)</span><span class="err">:</span>
<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__new__</span><span class="p">(</span><span class="n">mcls</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">bases</span><span class="p">,</span><span class="w"> </span><span class="n">attrs</span><span class="p">)</span><span class="err">:</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="p">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">'None'</span><span class="p">)</span><span class="err">:</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">None</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="k">Go</span><span class="w"> </span><span class="k">over</span><span class="w"> </span><span class="n">attributes</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">renamed</span><span class="p">.</span>
<span class="w">        </span><span class="n">newattrs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{}</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">attrname</span><span class="p">,</span><span class="w"> </span><span class="n">attrvalue</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">attrs</span><span class="p">.</span><span class="n">iteritems</span><span class="p">()</span><span class="err">:</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">getattr</span><span class="p">(</span><span class="n">attrvalue</span><span class="p">,</span><span class="w"> </span><span class="s1">'is_hook'</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="err">:</span>
<span class="w">                </span><span class="n">newattrs</span><span class="o">[</span><span class="n">'__%s__' % attrname</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">attrvalue</span>
<span class="w">            </span><span class="k">else</span><span class="err">:</span>
<span class="w">                </span><span class="n">newattrs</span><span class="o">[</span><span class="n">attrname</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">attrvalue</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">super</span><span class="p">(</span><span class="n">MyType</span><span class="p">,</span><span class="w"> </span><span class="n">mcls</span><span class="p">).</span><span class="n">__new__</span><span class="p">(</span><span class="n">mcls</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">bases</span><span class="p">,</span><span class="w"> </span><span class="n">newattrs</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">bases</span><span class="p">,</span><span class="w"> </span><span class="n">attrs</span><span class="p">)</span><span class="err">:</span>
<span class="w">        </span><span class="n">super</span><span class="p">(</span><span class="n">MyType</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">).</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">bases</span><span class="p">,</span><span class="w"> </span><span class="n">attrs</span><span class="p">)</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">classregistry</span><span class="p">.</span><span class="n">register</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">interfaces</span><span class="p">)</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="ss">"Would register class %s now."</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">self</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__add__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">other</span><span class="p">)</span><span class="err">:</span>
<span class="w">        </span><span class="k">class</span><span class="w"> </span><span class="n">AutoClass</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">other</span><span class="p">)</span><span class="err">:</span>
<span class="w">            </span><span class="n">pass</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">AutoClass</span>
<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">Alternatively</span><span class="p">,</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">autogenerate</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">classname</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">well</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">class</span><span class="err">:</span>
<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">type</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">__name__</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">other</span><span class="p">.</span><span class="n">__name__</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">other</span><span class="p">),</span><span class="w"> </span><span class="err">{}</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">unregister</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="err">:</span>
<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">classregistry</span><span class="p">.</span><span class="n">unregister</span><span class="p">(</span><span class="n">self</span><span class="p">)</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="ss">"Would unregister class %s now."</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">self</span>

<span class="k">class</span><span class="w"> </span><span class="nl">MyObject</span><span class="p">:</span>
<span class="w">    </span><span class="n">__metaclass__</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MyType</span>


<span class="k">class</span><span class="w"> </span><span class="n">NoneSample</span><span class="p">(</span><span class="n">MyObject</span><span class="p">)</span><span class="err">:</span>
<span class="w">    </span><span class="n">pass</span>

<span class="err">#</span><span class="w"> </span><span class="n">Will</span><span class="w"> </span><span class="k">print</span><span class="w"> </span><span class="ss">"NoneType None"</span>
<span class="k">print</span><span class="w"> </span><span class="n">type</span><span class="p">(</span><span class="n">NoneSample</span><span class="p">),</span><span class="w"> </span><span class="n">repr</span><span class="p">(</span><span class="n">NoneSample</span><span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="n">Example</span><span class="p">(</span><span class="n">MyObject</span><span class="p">)</span><span class="err">:</span>
<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="p">)</span><span class="err">:</span>
<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="k">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">value</span>
<span class="w">    </span><span class="nv">@make_hook</span>
<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="k">add</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">other</span><span class="p">)</span><span class="err">:</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__class__</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="k">value</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">other</span><span class="p">.</span><span class="k">value</span><span class="p">)</span>

<span class="err">#</span><span class="w"> </span><span class="n">Will</span><span class="w"> </span><span class="n">unregister</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">class</span>
<span class="n">Example</span><span class="p">.</span><span class="n">unregister</span><span class="p">()</span>

<span class="n">inst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Example</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="err">#</span><span class="w"> </span><span class="n">Will</span><span class="w"> </span><span class="n">fail</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">AttributeError</span>
<span class="n">#inst</span><span class="p">.</span><span class="n">unregister</span><span class="p">()</span>

<span class="k">print</span><span class="w"> </span><span class="n">inst</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">inst</span>
<span class="k">class</span><span class="w"> </span><span class="n">Sibling</span><span class="p">(</span><span class="n">MyObject</span><span class="p">)</span><span class="err">:</span>
<span class="w">    </span><span class="n">pass</span>

<span class="n">ExampleSibling</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Example</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Sibling</span>
<span class="err">#</span><span class="w"> </span><span class="n">ExampleSibling</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">now</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">subclass</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">both</span><span class="w"> </span><span class="n">Example</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">Sibling</span><span class="w"> </span><span class="p">(</span><span class="k">with</span><span class="w"> </span><span class="k">no</span>
<span class="err">#</span><span class="w"> </span><span class="n">content</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">own</span><span class="p">)</span><span class="w"> </span><span class="n">although</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">believe</span><span class="w"> </span><span class="n">it</span><span class="s1">'s called '</span><span class="n">AutoClass</span><span class="err">'</span>
<span class="k">print</span><span class="w"> </span><span class="n">ExampleSibling</span>
<span class="k">print</span><span class="w"> </span><span class="n">ExampleSibling</span><span class="p">.</span><span class="n">__mro__</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>A metaclass is the class of a class. A class defines how an instance of the
class (i.e. an object) behaves while a metaclass defines how a class behaves.
A class is an instance of a metaclass.</p>
<p>While in Python you can use arbitrary callables for metaclasses (like Jerub
shows), the better approach is to make it an actual class itself. <code>type</code> is
the usual metaclass in Python. <code>type</code> is itself a class, and it is its own
type. You won't be able to recreate something like <code>type</code> purely in Python,
but Python cheats a little. To create your own metaclass in Python you really
just want to subclass <code>type</code>.</p>
<p>A metaclass is most commonly used as a class-factory. When you create an
object by calling the class, Python creates a new class (when it executes the
'class' statement) by calling the metaclass. Combined with the normal
<code>__init__</code> and <code>__new__</code> methods, metaclasses therefore allow you to do 'extra
things' when creating a class, like registering the new class with some
registry or replace the class with something else entirely.</p>
<p>When the <code>class</code> statement is executed, Python first executes the body of the
<code>class</code> statement as a normal block of code. The resulting namespace (a dict)
holds the attributes of the class-to-be. The metaclass is determined by
looking at the baseclasses of the class-to-be (metaclasses are inherited), at
the <code>__metaclass__</code> attribute of the class-to-be (if any) or the
<code>__metaclass__</code> global variable. The metaclass is then called with the name,
bases and attributes of the class to instantiate it.</p>
<p>However, metaclasses actually define the <em>type</em> of a class, not just a factory
for it, so you can do much more with them. You can, for instance, define
normal methods on the metaclass. These metaclass-methods are like classmethods
in that they can be called on the class without an instance, but they are also
not like classmethods in that they cannot be called on an instance of the
class. <code>type.__subclasses__()</code> is an example of a method on the <code>type</code>
metaclass. You can also define the normal 'magic' methods, like <code>__add__</code>,
<code>__iter__</code> and <code>__getattr__</code>, to implement or change how the class behaves.</p>
<p>Here's an aggregated example of the bits and pieces:</p>
<div class="code"><pre class="code literal-block"><span class="n">def</span><span class="w"> </span><span class="n">make_hook</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="err">:</span>
<span class="w">    </span><span class="ss">"""Decorator to turn 'foo' method into '__foo__'"""</span>
<span class="w">    </span><span class="n">f</span><span class="p">.</span><span class="n">is_hook</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">f</span>

<span class="k">class</span><span class="w"> </span><span class="n">MyType</span><span class="p">(</span><span class="n">type</span><span class="p">)</span><span class="err">:</span>
<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__new__</span><span class="p">(</span><span class="n">mcls</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">bases</span><span class="p">,</span><span class="w"> </span><span class="n">attrs</span><span class="p">)</span><span class="err">:</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="p">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">'None'</span><span class="p">)</span><span class="err">:</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">None</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="k">Go</span><span class="w"> </span><span class="k">over</span><span class="w"> </span><span class="n">attributes</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">renamed</span><span class="p">.</span>
<span class="w">        </span><span class="n">newattrs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{}</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">attrname</span><span class="p">,</span><span class="w"> </span><span class="n">attrvalue</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">attrs</span><span class="p">.</span><span class="n">iteritems</span><span class="p">()</span><span class="err">:</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">getattr</span><span class="p">(</span><span class="n">attrvalue</span><span class="p">,</span><span class="w"> </span><span class="s1">'is_hook'</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="err">:</span>
<span class="w">                </span><span class="n">newattrs</span><span class="o">[</span><span class="n">'__%s__' % attrname</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">attrvalue</span>
<span class="w">            </span><span class="k">else</span><span class="err">:</span>
<span class="w">                </span><span class="n">newattrs</span><span class="o">[</span><span class="n">attrname</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">attrvalue</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">super</span><span class="p">(</span><span class="n">MyType</span><span class="p">,</span><span class="w"> </span><span class="n">mcls</span><span class="p">).</span><span class="n">__new__</span><span class="p">(</span><span class="n">mcls</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">bases</span><span class="p">,</span><span class="w"> </span><span class="n">newattrs</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">bases</span><span class="p">,</span><span class="w"> </span><span class="n">attrs</span><span class="p">)</span><span class="err">:</span>
<span class="w">        </span><span class="n">super</span><span class="p">(</span><span class="n">MyType</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">).</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">bases</span><span class="p">,</span><span class="w"> </span><span class="n">attrs</span><span class="p">)</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">classregistry</span><span class="p">.</span><span class="n">register</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">interfaces</span><span class="p">)</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="ss">"Would register class %s now."</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">self</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__add__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">other</span><span class="p">)</span><span class="err">:</span>
<span class="w">        </span><span class="k">class</span><span class="w"> </span><span class="n">AutoClass</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">other</span><span class="p">)</span><span class="err">:</span>
<span class="w">            </span><span class="n">pass</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">AutoClass</span>
<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">Alternatively</span><span class="p">,</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">autogenerate</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">classname</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">well</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">class</span><span class="err">:</span>
<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">type</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">__name__</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">other</span><span class="p">.</span><span class="n">__name__</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">other</span><span class="p">),</span><span class="w"> </span><span class="err">{}</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">unregister</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="err">:</span>
<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">classregistry</span><span class="p">.</span><span class="n">unregister</span><span class="p">(</span><span class="n">self</span><span class="p">)</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="ss">"Would unregister class %s now."</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">self</span>

<span class="k">class</span><span class="w"> </span><span class="nl">MyObject</span><span class="p">:</span>
<span class="w">    </span><span class="n">__metaclass__</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MyType</span>


<span class="k">class</span><span class="w"> </span><span class="n">NoneSample</span><span class="p">(</span><span class="n">MyObject</span><span class="p">)</span><span class="err">:</span>
<span class="w">    </span><span class="n">pass</span>

<span class="err">#</span><span class="w"> </span><span class="n">Will</span><span class="w"> </span><span class="k">print</span><span class="w"> </span><span class="ss">"NoneType None"</span>
<span class="k">print</span><span class="w"> </span><span class="n">type</span><span class="p">(</span><span class="n">NoneSample</span><span class="p">),</span><span class="w"> </span><span class="n">repr</span><span class="p">(</span><span class="n">NoneSample</span><span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="n">Example</span><span class="p">(</span><span class="n">MyObject</span><span class="p">)</span><span class="err">:</span>
<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="p">)</span><span class="err">:</span>
<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="k">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">value</span>
<span class="w">    </span><span class="nv">@make_hook</span>
<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="k">add</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">other</span><span class="p">)</span><span class="err">:</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__class__</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="k">value</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">other</span><span class="p">.</span><span class="k">value</span><span class="p">)</span>

<span class="err">#</span><span class="w"> </span><span class="n">Will</span><span class="w"> </span><span class="n">unregister</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">class</span>
<span class="n">Example</span><span class="p">.</span><span class="n">unregister</span><span class="p">()</span>

<span class="n">inst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Example</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="err">#</span><span class="w"> </span><span class="n">Will</span><span class="w"> </span><span class="n">fail</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">AttributeError</span>
<span class="n">#inst</span><span class="p">.</span><span class="n">unregister</span><span class="p">()</span>

<span class="k">print</span><span class="w"> </span><span class="n">inst</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">inst</span>
<span class="k">class</span><span class="w"> </span><span class="n">Sibling</span><span class="p">(</span><span class="n">MyObject</span><span class="p">)</span><span class="err">:</span>
<span class="w">    </span><span class="n">pass</span>

<span class="n">ExampleSibling</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Example</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Sibling</span>
<span class="err">#</span><span class="w"> </span><span class="n">ExampleSibling</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">now</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">subclass</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">both</span><span class="w"> </span><span class="n">Example</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">Sibling</span><span class="w"> </span><span class="p">(</span><span class="k">with</span><span class="w"> </span><span class="k">no</span>
<span class="err">#</span><span class="w"> </span><span class="n">content</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">own</span><span class="p">)</span><span class="w"> </span><span class="n">although</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">believe</span><span class="w"> </span><span class="n">it</span><span class="s1">'s called '</span><span class="n">AutoClass</span><span class="err">'</span>
<span class="k">print</span><span class="w"> </span><span class="n">ExampleSibling</span>
<span class="k">print</span><span class="w"> </span><span class="n">ExampleSibling</span><span class="p">.</span><span class="n">__mro__</span>
</pre></div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/metaclass/" rel="tag">metaclass</a></li>
            <li><a class="tag p-category" href="../../categories/oop/" rel="tag">oop</a></li>
            <li><a class="tag p-category" href="../../categories/python/" rel="tag">python</a></li>
            <li><a class="tag p-category" href="../../categories/python-class/" rel="tag">python-class</a></li>
            <li><a class="tag p-category" href="../../categories/python-datamodel/" rel="tag">python-datamodel</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../how-do-i-remove-a-property-from-a-javascript-object/" rel="prev" title="How do I remove a property from a JavaScript object?">Previous post</a>
            </li>
            <li class="next">
                <a href="../how-to-find-all-files-containing-specific-text-string-on-linux/" rel="next" title="How to find all files containing specific text (string) on Linux?">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="../../assets/js/search.js"></script>
</body>
</html>
