<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>For loop for HTMLCollection elements | StackOverflow Snapshot</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/posts/for-loop-for-htmlcollection-elements/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Arya">
<link rel="prev" href="../what-does-the-ns-prefix-mean/" title="What does the NS prefix mean?" type="text/html">
<link rel="next" href="../how-do-i-use-raw-input-in-python-3/" title="How do I use raw_input in Python 3?" type="text/html">
<meta property="og:site_name" content="StackOverflow Snapshot">
<meta property="og:title" content="For loop for HTMLCollection elements">
<meta property="og:url" content="https://ohstackoverflow.netlify.app/posts/for-loop-for-htmlcollection-elements/">
<meta property="og:description" content="I'm trying to set get id of all elements in an HTMLCollectionOf. I wrote the
following code:
var list = document.getElementsByClassName(&quot;events&quot;);
console.log(list[0].id);
for (key in list) {
    cons">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-02-17T21:10:41+08:00">
<meta property="article:tag" content="dom">
<meta property="article:tag" content="javascript">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">For loop for HTMLCollection elements</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T21:10:41+08:00" itemprop="datePublished" title="2023-02-17 21:10">2023-02-17 21:10</time></a>
            </p>
            

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>I'm trying to set get id of all elements in an <code>HTMLCollectionOf</code>. I wrote the
following code:</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">document</span><span class="o">.</span><span class="n">getElementsByClassName</span><span class="p">(</span><span class="s2">"events"</span><span class="p">);</span>
<span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">id</span><span class="p">);</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">list</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">id</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>

<p>But I got the following output in console:</p>
<div class="code"><pre class="code literal-block">event1
undefined
</pre></div>

<p>which is not what I expected. Why is the second console output <code>undefined</code> but
the first console output is <code>event1</code>?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>In response to the original question, you are using <code>for/in</code> incorrectly. In
your code, <code>key</code> is the index. So, to get the value from the pseudo-array,
you'd have to do <code>list[key]</code> and to get the id, you'd do <code>list[key].id</code>. But,
you should not be doing this with <code>for/in</code> in the first place.</p>
<p><strong>Summary (added in Dec 2018)</strong></p>
<p>Do not ever use <code>for/in</code> to iterate a nodeList or an HTMLCollection. The
reasons to avoid it are described below.</p>
<p>All recent versions of modern browsers (Safari, Firefox, Chrome, Edge) all
support <code>for/of</code> iteration on DOM lists such <code>nodeList</code> or <code>HTMLCollection</code>.</p>
<p>Here's an example:</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">document</span><span class="o">.</span><span class="n">getElementsByClassName</span><span class="p">(</span><span class="s2">"events"</span><span class="p">);</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">let</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">list</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">id</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>

<p>To include older browsers (including things like IE), this will work
everywhere:</p>
<div class="code"><pre class="code literal-block"><span class="nf">var</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">document</span><span class="p">.</span><span class="n">getElementsByClassName</span><span class="p">(</span><span class="ss">"events"</span><span class="p">);</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nf">var</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">list</span><span class="p">.</span><span class="n">length</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="n">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="n">list</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">id</span><span class="p">);</span><span class="w"> </span><span class="o">//</span><span class="k">second</span><span class="w"> </span><span class="n">console</span><span class="w"> </span><span class="k">output</span>
<span class="err">}</span>
</pre></div>

<hr>
<p><strong>Explanation For Why You Should Not Use<code>for/in</code></strong></p>
<p><code>for/in</code> is meant for iterating the properties of an object. That means it
will return all iterable properties of an object. While it may appear to work
for an array (returning array elements or pseudo-array elements), it can also
return other properties of the object that are not what you are expecting from
the array-like elements. And, guess what, an <code>HTMLCollection</code> or <code>nodeList</code>
object can both have other properties that will be returned with a <code>for/in</code>
iteration. I just tried this in Chrome and iterating it the way you were
iterating it will retrieve the items in the list (indexes 0, 1, 2, etc...),
but also will retrieve the <code>length</code> and <code>item</code> properties. The <code>for/in</code>
iteration simply won't work for an HTMLCollection.</p>
<hr>
<p>See http://jsfiddle.net/jfriend00/FzZ2H/ for why you can't iterate an
HTMLCollection with <code>for/in</code>.</p>
<p>In Firefox, your <code>for/in</code> iteration would return these items (all the iterable
properties of the object):</p>
<div class="code"><pre class="code literal-block"><span class="mf">0</span>
<span class="mf">1</span>
<span class="mf">2</span>
<span class="n">item</span>
<span class="n">namedItem</span>
<span class="err">@@</span><span class="n">iterator</span>
<span class="nb">len</span><span class="n">gth</span>
</pre></div>

<p>Hopefully, now you can see why you want to use <code>for (var i = 0; i &lt;
list.length; i++)</code> instead so you just get <code>0</code>, <code>1</code> and <code>2</code> in your iteration.</p>
<hr>
<p><strong>Evolution of Browser Support for NodeList and HTMLCollection iteration</strong></p>
<p>Following below is an evolution of how browsers have evolved through the time
period 2015-2018 giving you additional ways to iterate. None of these are now
needed in modern browsers since you can use the options described above.</p>
<p><strong>Update for ES6 in 2015</strong></p>
<p>Added to ES6 is <code>Array.from()</code> that will convert an array-like structure to an
actual array. That allows one to enumerate a list directly like this:</p>
<div class="code"><pre class="code literal-block">"use strict";

Array.from(document.getElementsByClassName("events")).forEach(function(item) {
   console.log(item.id);
});
</pre></div>

<p>Working demo (in Firefox, Chrome, and Edge as of April 2016):
https://jsfiddle.net/jfriend00/8ar4xn2s/</p>
<hr>
<p><strong>Update for ES6 in 2016</strong></p>
<p>You can now use the ES6 for/of construct with a <code>NodeList</code> and an
<code>HTMLCollection</code> by just adding this to your code:</p>
<div class="code"><pre class="code literal-block">NodeList.prototype[Symbol.iterator] = Array.prototype[Symbol.iterator];
HTMLCollection.prototype[Symbol.iterator] = Array.prototype[Symbol.iterator];
</pre></div>

<p>Then, you can do:</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">document</span><span class="o">.</span><span class="n">getElementsByClassName</span><span class="p">(</span><span class="s2">"events"</span><span class="p">);</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">list</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">id</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>

<p>This works in the current version of Chrome, Firefox, and Edge. This works
because it attaches the Array iterator to both the NodeList and HTMLCollection
prototypes so that when for/of iterates them, it uses the Array iterator to
iterate them.</p>
<p>Working demo: http://jsfiddle.net/jfriend00/joy06u4e/.</p>
<hr>
<p><strong>Second Update for ES6 in Dec 2016</strong></p>
<p>As of Dec 2016, <code>Symbol.iterator</code> support has been built-in to Chrome v54 and
Firefox v50 so the code below works by itself. It is not yet built-in for
Edge.</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">document</span><span class="o">.</span><span class="n">getElementsByClassName</span><span class="p">(</span><span class="s2">"events"</span><span class="p">);</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">let</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">list</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">id</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>

<p>Working demo (in Chrome and Firefox): http://jsfiddle.net/jfriend00/3ddpz8sp/</p>
<p><strong>Third Update for ES6 in Dec 2017</strong></p>
<p>As of Dec. 2017, this capability works in Edge 41.16299.15.0 for a <code>nodeList</code>
as in <code>document.querySelectorAll()</code>, but not an <code>HTMLCollection</code> as in
<code>document.getElementsByClassName()</code> so you have to manually assign the
iterator to use it in Edge for an <code>HTMLCollection</code>. It is a total mystery why
they'd fix one collection type, but not the other. But, you can at least use
the result of <code>document.querySelectorAll()</code> with ES6 <code>for/of</code> syntax in
current versions of Edge now.</p>
<p>I've also updated the above jsFiddle so it tests both <code>HTMLCollection</code> and
<code>nodeList</code> separately and captures the output in the jsFiddle itself.</p>
<p><strong>Fourth Update for ES6 in Mar 2018</strong></p>
<p>Per mesqueeeb, <code>Symbol.iterator</code> support has been built-in to Safari too, so
you can use <code>for (let item of list)</code> for either
<code>document.getElementsByClassName()</code> or <code>document.querySelectorAll()</code>.</p>
<p><strong>Fifth Update for ES6 in Apr 2018</strong></p>
<p>Apparently, support for iterating an <code>HTMLCollection</code> with <code>for/of</code> will be
coming to Edge 18 in Fall 2018.</p>
<p><strong>Sixth Update for ES6 in Nov 2018</strong></p>
<p>I can confirm that with Microsoft Edge v18 (that is included in the Fall 2018
Windows Update), you can now iterate both an HTMLCollection and a NodeList
with for/of in Edge.</p>
<p>So, now all modern browsers contain native support for <code>for/of</code> iteration of
both the HTMLCollection and NodeList objects.</p>
<p><br></p>
<h3>Suggest</h3>
<p>You can't use <code>for</code>/<code>in</code> on <code>NodeList</code>s or <code>HTMLCollection</code>s. However, you can
use some <code>Array.prototype</code> methods, as long as you <code>.call()</code> them and pass in
the <code>NodeList</code> or <code>HTMLCollection</code> as <code>this</code>.</p>
<p>So consider the following as an alternative to jfriend00's <code>for</code> loop:</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">list</span><span class="o">=</span><span class="w"> </span><span class="n">document</span><span class="o">.</span><span class="n">getElementsByClassName</span><span class="p">(</span><span class="s2">"events"</span><span class="p">);</span>
<span class="p">[]</span><span class="o">.</span><span class="n">forEach</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">list</span><span class="p">,</span><span class="w"> </span><span class="n">function</span><span class="p">(</span><span class="n">el</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">el</span><span class="o">.</span><span class="n">id</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>

<p>There's a good article on MDN that covers this technique. Note their warning
about browser compatibility though:</p>
<blockquote>
<p>[...] passing a host object (like a <code>NodeList</code>) as <code>this</code> to a native method
(such as <code>forEach</code>) is not guaranteed to work in all browsers and is known
to fail in some.</p>
</blockquote>
<p>So while this approach is convenient, a <code>for</code> loop may be the most browser-
compatible solution.</p>
<p><strong>Update (Aug 30, 2014):</strong> Eventually you'll be able to use ES6 <code>for</code>/<code>of</code>!</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">document</span><span class="o">.</span><span class="n">getElementsByClassName</span><span class="p">(</span><span class="s2">"events"</span><span class="p">);</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">el</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">list</span><span class="p">)</span>
<span class="w">  </span><span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">el</span><span class="o">.</span><span class="n">id</span><span class="p">);</span>
</pre></div>

<p>It's already supported in recent versions of Chrome and Firefox.</p>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/dom/" rel="tag">dom</a></li>
            <li><a class="tag p-category" href="../../categories/javascript/" rel="tag">javascript</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../what-does-the-ns-prefix-mean/" rel="prev" title="What does the NS prefix mean?">Previous post</a>
            </li>
            <li class="next">
                <a href="../how-do-i-use-raw-input-in-python-3/" rel="next" title="How do I use raw_input in Python 3?">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="../../assets/js/search.js"></script>
</body>
</html>
