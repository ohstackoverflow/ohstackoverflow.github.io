<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ä¸ºä»€ä¹ˆç°ä»£ Perl é»˜è®¤é¿å…ä½¿ç”¨ UTF-8ï¼Ÿ | StackOverflow Snapshot</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/posts/wei-shi-yao-xian-dai-perl-mo-ren-bi-mian-shi-yong-utf-8/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Arya">
<link rel="prev" href="../c-ru-he-chuang-jian-yi-ge-guidzhi/" title="C#å¦‚ä½•åˆ›å»ºä¸€ä¸ªGuidå€¼ï¼Ÿ" type="text/html">
<link rel="next" href="../ru-he-zai-powershell-zhong-chu-li-ming-ling-xing-can-shu/" title="å¦‚ä½•åœ¨ PowerShell ä¸­å¤„ç†å‘½ä»¤è¡Œå‚æ•°" type="text/html">
<meta property="og:site_name" content="StackOverflow Snapshot">
<meta property="og:title" content="ä¸ºä»€ä¹ˆç°ä»£ Perl é»˜è®¤é¿å…ä½¿ç”¨ UTF-8ï¼Ÿ">
<meta property="og:url" content="https://ohstackoverflow.netlify.app/posts/wei-shi-yao-xian-dai-perl-mo-ren-bi-mian-shi-yong-utf-8/">
<meta property="og:description" content="æˆ‘æƒ³çŸ¥é“ä¸ºä»€ä¹ˆå¤§å¤šæ•°ä½¿ç”¨ Perl æ„å»ºçš„ç°ä»£è§£å†³æ–¹æ¡ˆé»˜è®¤æƒ…å†µä¸‹ä¸å¯ç”¨UTF-8ã€‚
æˆ‘çŸ¥é“æ ¸å¿ƒ Perl è„šæœ¬æœ‰å¾ˆå¤šé—ç•™é—®é¢˜ï¼Œå¯èƒ½ä¼šç ´åæŸäº›ä¸œè¥¿ã€‚ä½†æ˜¯ï¼Œä»æˆ‘çš„è§’åº¦æ¥çœ‹ï¼Œåœ¨ 21ä¸–çºªï¼Œå¤§å‹æ–°é¡¹ç›®ï¼ˆæˆ–å…·æœ‰å¹¿é˜”å‰æ™¯çš„é¡¹ç›®ï¼‰åº”è¯¥ä»å¤´å¼€å§‹å¯¹å…¶è½¯ä»¶è¿›è¡Œ
UTF-8 è¯æ˜ã€‚æˆ‘ä»ç„¶æ²¡æœ‰çœ‹åˆ°å®ƒå‘ç”Ÿã€‚ä¾‹å¦‚ï¼ŒMooseå¯ç”¨ strict å’Œ
warningsï¼Œä½†ä¸å¯ç”¨Unicodeã€‚Modern::Perlä¹Ÿå‡å°‘äº†æ ·æ¿">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-02-18T01:43:51+08:00">
<meta property="article:tag" content="perl">
<meta property="article:tag" content="unicode">
<meta property="article:tag" content="utf-8">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- æ¨¡æ€æ¡†ï¼ˆModalï¼‰ --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—
				</button>
				<h4 class="modal-title" id="myModalLabel">
					æŸ¥æ‰¾ç»“æœ
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				æŸ¥æ‰¾ä¸­ï¼Œè¯·ç¨å...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					å…³é—­
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">ä¸ºä»€ä¹ˆç°ä»£ Perl é»˜è®¤é¿å…ä½¿ç”¨ UTF-8ï¼Ÿ</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T01:43:51+08:00" itemprop="datePublished" title="2023-02-18 01:43">2023-02-18 01:43</time></a>
            </p>
            

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>æˆ‘æƒ³çŸ¥é“ä¸ºä»€ä¹ˆå¤§å¤šæ•°ä½¿ç”¨ Perl æ„å»ºçš„ç°ä»£è§£å†³æ–¹æ¡ˆé»˜è®¤æƒ…å†µä¸‹ä¸å¯ç”¨UTF-8ã€‚</p>
<p>æˆ‘çŸ¥é“æ ¸å¿ƒ Perl è„šæœ¬æœ‰å¾ˆå¤šé—ç•™é—®é¢˜ï¼Œå¯èƒ½ä¼šç ´åæŸäº›ä¸œè¥¿ã€‚ä½†æ˜¯ï¼Œä»æˆ‘çš„è§’åº¦æ¥çœ‹ï¼Œåœ¨ 21ä¸–çºªï¼Œå¤§å‹æ–°é¡¹ç›®ï¼ˆæˆ–å…·æœ‰å¹¿é˜”å‰æ™¯çš„é¡¹ç›®ï¼‰åº”è¯¥ä»å¤´å¼€å§‹å¯¹å…¶è½¯ä»¶è¿›è¡Œ
UTF-8 è¯æ˜ã€‚æˆ‘ä»ç„¶æ²¡æœ‰çœ‹åˆ°å®ƒå‘ç”Ÿã€‚ä¾‹å¦‚ï¼ŒMooseå¯ç”¨ strict å’Œ
warningsï¼Œä½†ä¸å¯ç”¨Unicodeã€‚Modern::Perlä¹Ÿå‡å°‘äº†æ ·æ¿æ–‡ä»¶ï¼Œä½†æ²¡æœ‰ UTF-8 å¤„ç†ã€‚</p>
<p>ä¸ºä»€ä¹ˆï¼Ÿåœ¨ 2011 å¹´çš„ç°ä»£ Perl é¡¹ç›®ä¸­æ˜¯å¦æœ‰ä¸€äº›ç†ç”±é¿å…ä½¿ç”¨ UTF-8ï¼Ÿ</p>
<hr>
<p>è¯„è®º@tchrist å¤ªé•¿äº†ï¼Œæ‰€ä»¥æˆ‘åœ¨è¿™é‡Œæ·»åŠ å®ƒã€‚</p>
<p>çœ‹æ¥æˆ‘æ²¡æœ‰è¯´æ¸…æ¥šã€‚è®©æˆ‘å°è¯•æ·»åŠ ä¸€äº›å†…å®¹ã€‚</p>
<p><strong>tchrist</strong> å’Œæˆ‘å¯¹æƒ…å†µçš„çœ‹æ³•éå¸¸ç›¸ä¼¼ï¼Œä½†æˆ‘ä»¬çš„ç»“è®ºå´å®Œå…¨ç›¸åã€‚æˆ‘åŒæ„ï¼ŒUnicode çš„æƒ…å†µå¾ˆå¤æ‚ï¼Œä½†è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬ï¼ˆPerl
ç”¨æˆ·å’Œç¼–ç äººå‘˜ï¼‰éœ€è¦ä¸€äº›å±‚ï¼ˆæˆ– pragmaï¼‰æ¥ä½¿ UTF-8 å¤„ç†åƒç°åœ¨ä¸€æ ·å®¹æ˜“ã€‚</p>
<p><strong>tchrist</strong> æŒ‡å‡ºè¦æ¶µç›–çš„è®¸å¤šæ–¹é¢ï¼Œæˆ‘ä¼šé˜…è¯»å¹¶æ€è€ƒå‡ å¤©ç”šè‡³å‡ å‘¨ã€‚ä¸è¿‡ï¼Œè¿™ä¸æ˜¯æˆ‘çš„æ„æ€ã€‚ <strong>tchrist</strong> è¯•å›¾è¯æ˜æ²¡æœ‰ä¸€ç§æ–¹æ³•å¯ä»¥â€œå¯ç”¨
UTF-8â€ã€‚æˆ‘æ²¡æœ‰å¤ªå¤šçš„çŸ¥è¯†å¯ä»¥ä¸ä¹‹äº‰è®ºã€‚æ‰€ä»¥ï¼Œæˆ‘åšæŒä½¿ç”¨å®ä¾‹ã€‚</p>
<p>æˆ‘ç©è¿‡Rakudoï¼ŒUTF-8 å°±åœ¨ <strong>æˆ‘éœ€è¦çš„æ—¶å€™</strong>
ã€‚æˆ‘æ²¡æœ‰ä»»ä½•é—®é¢˜ï¼Œå®ƒåªæ˜¯å·¥ä½œã€‚ä¹Ÿè®¸åœ¨æ›´æ·±çš„åœ°æ–¹å­˜åœ¨ä¸€äº›é™åˆ¶ï¼Œä½†ä¸€å¼€å§‹ï¼Œæˆ‘æµ‹è¯•çš„æ‰€æœ‰å†…å®¹éƒ½æŒ‰é¢„æœŸå·¥ä½œã€‚</p>
<p>è¿™ä¸åº”è¯¥ä¹Ÿæ˜¯ç°ä»£ Perl 5 çš„ç›®æ ‡å—ï¼Ÿæˆ‘æ›´å¼ºè°ƒä¸€ç‚¹ï¼šæˆ‘å¹¶ä¸æ˜¯å»ºè®®å°† UTF-8 ä½œä¸ºæ ¸å¿ƒ Perl çš„é»˜è®¤å­—ç¬¦é›†ï¼Œæˆ‘å»ºè®®å¼€å‘ <strong>æ–°</strong> é¡¹ç›®çš„äººå¯ä»¥
<strong>é€šè¿‡ snap</strong> è§¦å‘å®ƒã€‚ ****</p>
<p>å¦ä¸€ä¸ªä¾‹å­ï¼Œä½†è¯­æ°”æ›´æ¶ˆæã€‚æ¡†æ¶åº”è¯¥ä½¿å¼€å‘æ›´å®¹æ˜“ã€‚å‡ å¹´å‰ï¼Œæˆ‘å°è¯•è¿‡ Web æ¡†æ¶ï¼Œä½†å› ä¸ºâ€œå¯ç”¨
UTF-8â€å¤ªæ™¦æ¶©éš¾æ‡‚è€Œæ”¾å¼ƒäº†å®ƒä»¬ã€‚æˆ‘æ²¡æœ‰æ‰¾åˆ°å¦‚ä½•ä»¥åŠåœ¨ä½•å¤„æŒ‚æ¥ Unicode
æ”¯æŒã€‚å¤ªè´¹æ—¶é—´äº†ï¼Œæˆ‘å‘ç°èµ°è€è·¯æ›´å®¹æ˜“ã€‚ç°åœ¨æˆ‘çœ‹åˆ°è¿™é‡Œæœ‰ä¸€ä¸ªèµé‡‘æ¥å¤„ç†ä¸Mason 2 ç›¸åŒçš„é—®é¢˜ï¼š <em>How to make Mason2 UTF-8
clean?</em>. å› æ­¤ï¼Œå®ƒæ˜¯ä¸€ä¸ªéå¸¸æ–°çš„æ¡†æ¶ï¼Œä½†æ˜¯å°†å®ƒä¸ UTF-8 ä¸€èµ·ä½¿ç”¨éœ€è¦æ·±å…¥äº†è§£å…¶å†…éƒ¨ç»“æ„ã€‚å®ƒå°±åƒä¸€ä¸ªå¤§å¤§çš„çº¢è‰²æ ‡å¿—ï¼šåœæ­¢ï¼Œä¸è¦ä½¿ç”¨æˆ‘ï¼</p>
<p>æˆ‘çœŸçš„å¾ˆå–œæ¬¢ Perlã€‚ä½†æ˜¯å¤„ç† Unicode æ˜¯å¾ˆç—›è‹¦çš„ã€‚æˆ‘ä»ç„¶å‘ç°è‡ªå·±åœ¨æ’å¢™ã€‚æŸç§ç¨‹åº¦ä¸Š <strong>tchrist</strong> æ˜¯å¯¹çš„å¹¶å›ç­”äº†æˆ‘çš„é—®é¢˜ï¼šæ–°é¡¹ç›®ä¸å¸å¼•
UTF-8 å› ä¸ºå®ƒåœ¨ Perl 5 ä¸­å¤ªå¤æ‚äº†ã€‚</p>
<p><br><br></p>
<h2>è§£ç­”</h2>
<h2>ğ™ğ™ğ™¢ğ™¥ğ™¡ğ™šğ™¨ğ™©â„ : ___</h2>
<ol>
<li>
<p>å°†æ‚¨çš„<code>PERL_UNICODE</code>å˜é‡è®¾ç½®ä¸º<code>AS</code>. è¿™ä½¿å¾—æ‰€æœ‰ Perl è„šæœ¬éƒ½è§£ç <code>@ARGV</code>ä¸º UTF-8 å­—ç¬¦ä¸²ï¼Œå¹¶å°† stdinã€stdout å’Œ stderr è¿™ä¸‰ä¸ªçš„ç¼–ç è®¾ç½®ä¸º UTF-8ã€‚è¿™ä¸¤è€…éƒ½æ˜¯å…¨å±€æ•ˆåº”ï¼Œè€Œä¸æ˜¯è¯æ±‡æ•ˆåº”ã€‚</p>
</li>
<li>
<p>åœ¨ä½ çš„æºæ–‡ä»¶ï¼ˆç¨‹åºã€æ¨¡å—ã€åº“ã€hickeyï¼‰çš„é¡¶éƒ¨<code>do</code>ï¼Œé€šè¿‡ä»¥ä¸‹æ–¹å¼çªå‡ºå£°æ˜ä½ æ­£åœ¨è¿è¡Œ perl 5.12 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼š</p>
<div class="code"><pre class="code literal-block"><span class="nv">use</span><span class="w"> </span><span class="nv">v5</span>.<span class="mi">12</span><span class="c1">;  # minimal for unicode string feature</span>
</pre></div>

<p>use v5.14;  # optimal for unicode string feature</p>
</li>
<li>
<p>å¯ç”¨è­¦å‘Šï¼Œå› ä¸ºä¹‹å‰çš„å£°æ˜ä»…å¯ç”¨é™åˆ¶å’ŒåŠŸèƒ½ï¼Œè€Œä¸å¯ç”¨è­¦å‘Šã€‚æˆ‘è¿˜å»ºè®®å°† Unicode è­¦å‘Šæå‡ä¸ºå¼‚å¸¸ï¼Œå› æ­¤è¯·åŒæ—¶ä½¿ç”¨è¿™ä¸¤è¡Œï¼Œè€Œä¸ä»…ä»…æ˜¯å…¶ä¸­ä¹‹ä¸€ã€‚ä½†æ˜¯è¯·æ³¨æ„ï¼Œåœ¨ v5.14 ä¸‹ï¼Œ<code>utf8</code>è­¦å‘Šç±»åŒ…å«ä¸‰ä¸ªå…¶ä»–å­è­¦å‘Šï¼Œå®ƒä»¬éƒ½å¯ä»¥å•ç‹¬å¯ç”¨ï¼š<code>nonchar</code>ã€<code>surrogate</code>å’Œ<code>non_unicode</code>ã€‚æ‚¨å¯èƒ½å¸Œæœ›å¯¹è¿™äº›æ–½åŠ æ›´å¤§çš„æ§åˆ¶ã€‚</p>
<div class="code"><pre class="code literal-block">use warnings;
</pre></div>

<p>use warnings qw( FATAL utf8 );</p>
</li>
<li>
<p>å£°æ˜æ­¤æºå•å…ƒç¼–ç ä¸º UTF-8ã€‚å°½ç®¡æ›¾å‡ ä½•æ—¶ï¼Œè¿™ä¸ª pragma åšäº†å…¶ä»–äº‹æƒ…ï¼Œä½†ç°åœ¨å®ƒåªæœåŠ¡äºè¿™ä¸ªå•ä¸€çš„ç›®çš„ï¼Œæ²¡æœ‰å…¶ä»–ï¼š</p>
<div class="code"><pre class="code literal-block">use utf8;
</pre></div>

</li>
<li>
<p>å£°æ˜ <em>åœ¨è¿™ä¸ªè¯æ³•èŒƒå›´å†…è€Œä¸æ˜¯åœ¨å…¶ä»–åœ°æ–¹</em> æ‰“å¼€æ–‡ä»¶å¥æŸ„çš„ä»»ä½•ä¸œè¥¿éƒ½å‡å®šè¯¥æµæ˜¯ç”¨ UTF-8 ç¼–ç çš„ï¼Œé™¤éä½ å¦æœ‰è¯´æ˜ã€‚è¿™æ ·ä½ å°±ä¸ä¼šå½±å“å…¶ä»–æ¨¡å—æˆ–å…¶ä»–ç¨‹åºçš„ä»£ç ã€‚</p>
<div class="code"><pre class="code literal-block">use open qw( :encoding(UTF-8) :std );
</pre></div>

</li>
<li>
<p>é€šè¿‡å¯ç”¨å‘½åå­—ç¬¦<code>\N{CHARNAME}</code>ã€‚</p>
<div class="code"><pre class="code literal-block">use charnames qw( :full :short );
</pre></div>

</li>
<li>
<p>å¦‚æœæ‚¨æœ‰<code>DATA</code>å¥æŸ„ï¼Œåˆ™å¿…é¡»æ˜¾å¼è®¾ç½®å…¶ç¼–ç ã€‚å¦‚æœä½ å¸Œæœ›å®ƒæ˜¯ UTF-8ï¼Œé‚£ä¹ˆè¯´ï¼š</p>
<div class="code"><pre class="code literal-block">binmode(DATA, ":encoding(UTF-8)");
</pre></div>

</li>
</ol>
<p>å½“ç„¶ï¼Œæ‚¨æœ€ç»ˆå¯èƒ½ä¼šå‘ç°è‡ªå·±å…³å¿ƒçš„å…¶ä»–äº‹æƒ…æ²¡æœ‰å°½å¤´ï¼Œä½†è¿™äº›è¶³ä»¥æ¥è¿‘å›½å®¶ç›®æ ‡â€œè®©ä¸€åˆ‡éƒ½åªä½¿ç”¨ UTF-8â€ï¼Œå°½ç®¡è¿™äº›æœ¯è¯­çš„æ„ä¹‰æœ‰æ‰€å‡å¼±ã€‚</p>
<p>å¦ä¸€ä¸ªç¼–è¯‘æŒ‡ç¤ºè™½ç„¶ä¸ Unicode æ— å…³ï¼Œä½†å´æ˜¯ï¼š</p>
<div class="code"><pre class="code literal-block">      use autodie;
</pre></div>

<p>å¼ºçƒˆæ¨èã€‚</p>
<p>ğŸŒ´ğŸªğŸ«ğŸªğŸŒğ•²ğ–”ğ•¿ğ–ğ–”ğ–šğ–†ğ–“ğ–‰ğ•¯ğ–”ğ•·ğ–ğ–ğ–Šğ–œğ–ğ–˜ğ–ŠğŸŒğŸªğŸ«ğŸªğŸ ___ _</p>
<hr>
<h3>ğŸğŸªğ–‹ğ–”ğ–—ğ–€ğ–“ğ–ğ–ˆğ–”ğ–‰ğ–Šâ¸—ğ•¬ğ–œğ–†ğ–—ğ–Šğ•®ğ–”ğ–‰ğ–ŠğŸğŸ</h3>
<hr>
<p>è¿™äº›å¤©æˆ‘è‡ªå·±çš„æ ·æ¿çœ‹èµ·æ¥åƒè¿™æ ·ï¼š</p>
<div class="code"><pre class="code literal-block"><span class="k">use</span><span class="w"> </span><span class="mf">5.014</span><span class="p">;</span>

<span class="k">use</span><span class="w"> </span><span class="n">utf8</span><span class="p">;</span>
<span class="k">use</span><span class="w"> </span><span class="n">strict</span><span class="p">;</span>
<span class="k">use</span><span class="w"> </span><span class="n">autodie</span><span class="p">;</span>
<span class="k">use</span><span class="w"> </span><span class="n">warnings</span><span class="p">;</span><span class="w"> </span>
<span class="k">use</span><span class="w"> </span><span class="n">warnings</span><span class="w">    </span><span class="n">qw</span><span class="o">&lt;</span><span class="w"> </span><span class="n">FATAL</span><span class="w">  </span><span class="n">utf8</span><span class="w">     </span><span class="o">&gt;</span><span class="p">;</span>
<span class="k">use</span><span class="w"> </span><span class="k">open</span><span class="w">        </span><span class="n">qw</span><span class="o">&lt;</span><span class="w"> </span><span class="err">:</span><span class="n">std</span><span class="w">  </span><span class="err">:</span><span class="n">utf8</span><span class="w">     </span><span class="o">&gt;</span><span class="p">;</span>
<span class="k">use</span><span class="w"> </span><span class="n">charnames</span><span class="w">   </span><span class="n">qw</span><span class="o">&lt;</span><span class="w"> </span><span class="err">:</span><span class="k">full</span><span class="w"> </span><span class="o">&gt;</span><span class="p">;</span>
<span class="k">use</span><span class="w"> </span><span class="n">feature</span><span class="w">     </span><span class="n">qw</span><span class="o">&lt;</span><span class="w"> </span><span class="n">unicode_strings</span><span class="w"> </span><span class="o">&gt;</span><span class="p">;</span>

<span class="k">use</span><span class="w"> </span><span class="k">File</span><span class="o">::</span><span class="n">Basename</span><span class="w">      </span><span class="n">qw</span><span class="o">&lt;</span><span class="w"> </span><span class="n">basename</span><span class="w"> </span><span class="o">&gt;</span><span class="p">;</span>
<span class="k">use</span><span class="w"> </span><span class="n">Carp</span><span class="w">                </span><span class="n">qw</span><span class="o">&lt;</span><span class="w"> </span><span class="n">carp</span><span class="w"> </span><span class="n">croak</span><span class="w"> </span><span class="n">confess</span><span class="w"> </span><span class="n">cluck</span><span class="w"> </span><span class="o">&gt;</span><span class="p">;</span>
<span class="k">use</span><span class="w"> </span><span class="n">Encode</span><span class="w">              </span><span class="n">qw</span><span class="o">&lt;</span><span class="w"> </span><span class="n">encode</span><span class="w"> </span><span class="n">decode</span><span class="w"> </span><span class="o">&gt;</span><span class="p">;</span>
<span class="k">use</span><span class="w"> </span><span class="nf">Unicode</span><span class="o">::</span><span class="k">Normalize</span><span class="w">  </span><span class="n">qw</span><span class="o">&lt;</span><span class="w"> </span><span class="n">NFD</span><span class="w"> </span><span class="n">NFC</span><span class="w"> </span><span class="o">&gt;</span><span class="p">;</span>

<span class="k">END</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="k">close</span><span class="w"> </span><span class="n">STDOUT</span><span class="w"> </span><span class="err">}</span>

<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">grep</span><span class="w"> </span><span class="o">/</span><span class="err">\</span><span class="n">P</span><span class="err">{</span><span class="nf">ASCII</span><span class="err">}</span><span class="o">/</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nv">@ARGV</span><span class="p">)</span><span class="w"> </span><span class="err">{</span><span class="w"> </span>
<span class="w">   </span><span class="nv">@ARGV</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">map</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="n">decode</span><span class="p">(</span><span class="ss">"UTF-8"</span><span class="p">,</span><span class="w"> </span><span class="err">$</span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="err">}</span><span class="w"> </span><span class="nv">@ARGV</span><span class="p">;</span>
<span class="err">}</span>

<span class="err">$</span><span class="mi">0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">basename</span><span class="p">(</span><span class="err">$</span><span class="mi">0</span><span class="p">);</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="n">shorter</span><span class="w"> </span><span class="n">messages</span>
<span class="err">$</span><span class="o">|</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>

<span class="n">binmode</span><span class="p">(</span><span class="k">DATA</span><span class="p">,</span><span class="w"> </span><span class="ss">":utf8"</span><span class="p">);</span>

<span class="err">#</span><span class="w"> </span><span class="n">give</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">full</span><span class="w"> </span><span class="n">stack</span><span class="w"> </span><span class="k">dump</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="ow">any</span><span class="w"> </span><span class="n">untrapped</span><span class="w"> </span><span class="n">exceptions</span>
<span class="k">local</span><span class="w"> </span><span class="err">$</span><span class="n">SIG</span><span class="err">{</span><span class="n">__DIE__</span><span class="err">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sub</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="n">confess</span><span class="w"> </span><span class="ss">"Uncaught exception: @_"</span><span class="w"> </span><span class="n">unless</span><span class="w"> </span><span class="err">$</span><span class="o">^</span><span class="n">S</span><span class="p">;</span>
<span class="err">}</span><span class="p">;</span>

<span class="err">#</span><span class="w"> </span><span class="n">now</span><span class="w"> </span><span class="n">promote</span><span class="w"> </span><span class="n">run</span><span class="o">-</span><span class="nc">time</span><span class="w"> </span><span class="n">warnings</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">stack</span><span class="o">-</span><span class="n">dumped</span>
<span class="err">#</span><span class="w">   </span><span class="n">exceptions</span><span class="w"> </span><span class="o">*</span><span class="n">unless</span><span class="o">*</span><span class="w"> </span><span class="n">we</span><span class="err">'</span><span class="n">re</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">block</span><span class="p">,</span><span class="w"> </span><span class="ow">in</span>
<span class="err">#</span><span class="w">   </span><span class="n">which</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="n">cluck</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">stack</span><span class="w"> </span><span class="k">dump</span><span class="w"> </span><span class="n">instead</span>
<span class="k">local</span><span class="w"> </span><span class="err">$</span><span class="n">SIG</span><span class="err">{</span><span class="n">__WARN__</span><span class="err">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sub</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="err">$</span><span class="o">^</span><span class="n">S</span><span class="p">)</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="n">cluck</span><span class="w">   </span><span class="ss">"Trapped warning: @_"</span><span class="w"> </span><span class="err">}</span><span class="w"> </span>
<span class="w">    </span><span class="k">else</span><span class="w">     </span><span class="err">{</span><span class="w"> </span><span class="n">confess</span><span class="w"> </span><span class="ss">"Deadly warning: @_"</span><span class="w">  </span><span class="err">}</span>
<span class="err">}</span><span class="p">;</span>

<span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">&lt;&gt;</span><span class="p">)</span><span class="w">  </span><span class="err">{</span>
<span class="w">    </span><span class="n">chomp</span><span class="p">;</span>
<span class="w">    </span><span class="err">$</span><span class="n">_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NFD</span><span class="p">(</span><span class="err">$</span><span class="n">_</span><span class="p">);</span>
<span class="w">    </span><span class="p">...</span>
<span class="err">}</span><span class="w"> </span><span class="k">continue</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="n">say</span><span class="w"> </span><span class="n">NFC</span><span class="p">(</span><span class="err">$</span><span class="n">_</span><span class="p">);</span>
<span class="err">}</span>

<span class="n">__END__</span>
</pre></div>

<hr>
<h2>ğŸ…ğ•¹ğ–”ğ•¸ğ–†ğ–Œğ–ğ–ˆğ•­ğ–šğ–‘ğ–‘ğ–Šğ–™ğŸ…</h2>
<hr>
<p>è¯´â€œPerl åº”è¯¥ [ <strong>ä¸çŸ¥ä½•æ•…ï¼</strong> ] é»˜è®¤å¯ç”¨ Unicodeâ€ ç”šè‡³æ²¡æœ‰å¼€å§‹è€ƒè™‘åœ¨æŸç§ç½•è§å’Œå­¤ç«‹çš„æƒ…å†µä¸‹è¯´å‡ºè¶³å¤Ÿå¤šçš„ç”¨å¤„ã€‚Unicode
ä¸ä»…ä»…æ˜¯ä¸€ä¸ªæ›´å¤§çš„å­—ç¬¦é›†ï¼›è¿™ä¹Ÿæ˜¯è¿™äº›è§’è‰²å¦‚ä½•ä»¥å¤šç§æ–¹å¼äº’åŠ¨çš„æ–¹å¼ã€‚</p>
<p>å³ä½¿æ˜¯ï¼ˆæŸäº›ï¼‰äººä»¬ä¼¼ä¹è®¤ä¸ºä»–ä»¬æƒ³è¦çš„å¤´è„‘ç®€å•çš„æœ€å°æªæ–½ä¹Ÿè‚¯å®šä¼šæ‚²æƒ¨åœ°ç ´åæ•°ç™¾ä¸‡è¡Œä»£ç ï¼Œè¿™äº›ä»£ç æ²¡æœ‰æœºä¼šâ€œå‡çº§â€åˆ°ä½ æ¼‚äº®çš„æ–°ç¾ä¸½æ–°ä¸–ç•Œç°ä»£ <em>æ€§</em> ã€‚</p>
<p>è¿™æ¯”äººä»¬æƒ³è±¡çš„è¦å¤æ‚å¾—å¤šã€‚åœ¨è¿‡å»çš„å‡ å¹´é‡Œï¼Œæˆ‘æƒ³äº†å¾ˆå¤šå¾ˆå¤šã€‚æˆ‘å¾ˆæƒ³è¯æ˜æˆ‘é”™äº†ã€‚ä½†æˆ‘ä¸è®¤ä¸ºæˆ‘æ˜¯ã€‚Unicode
ä»æ ¹æœ¬ä¸Šè¯´æ¯”æ‚¨æƒ³è¦å¼ºåŠ äºå®ƒçš„æ¨¡å‹æ›´å¤æ‚ï¼Œè¿™é‡Œæœ‰æ‚¨æ°¸è¿œæ— æ³•æ©ç›–çš„å¤æ‚æ€§ã€‚å¦‚æœä½ å°è¯•ï¼Œä½ è¦ä¹ˆä¼šç ´åä½ è‡ªå·±çš„ä»£ç ï¼Œè¦ä¹ˆä¼šç ´åå…¶ä»–äººçš„ä»£ç ã€‚åœ¨æŸäº›æ—¶å€™ï¼Œæ‚¨åªéœ€è¦åˆ†è§£å¹¶äº†è§£
Unicode æ˜¯ä»€ä¹ˆã€‚ä½ ä¸èƒ½å‡è£…å®ƒä¸æ˜¯ã€‚</p>
<p>ğŸª ç«­å°½å…¨åŠ›ä½¿ Unicode
å˜å¾—ç®€å•ï¼Œè¿œè¿œè¶…è¿‡æˆ‘ç”¨è¿‡çš„ä»»ä½•å…¶ä»–ä¸œè¥¿ã€‚å¦‚æœæ‚¨è®¤ä¸ºè¿™ä¸å¥½ï¼Œè¯·æš‚æ—¶å°è¯•å…¶ä»–æ–¹æ³•ã€‚ç„¶åå›åˆ°ğŸªï¼šè¦ä¹ˆä½ ä¼šå›åˆ°ä¸€ä¸ªæ›´ç¾å¥½çš„ä¸–ç•Œï¼Œè¦ä¹ˆä½ ä¼šå¸¦æ¥åŒæ ·çš„çŸ¥è¯†ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨ä½ çš„æ–°çŸ¥è¯†ä½¿ğŸªåœ¨è¿™äº›äº‹æƒ…ä¸Šåšå¾—æ›´å¥½ã€‚</p>
<hr>
<h3>ğŸ’¡ğ•´ğ–‰ğ–Šğ–†ğ–˜ğ–†â¸—ğ•¬ğ–œğ–†ğ–—ğ–ŠğŸªğ•·ğ–†ğ–šğ–“ğ–‰ğ–—ğ–ğŸ’¡ğŸ’¡</h3>
<hr>
<p>è‡³å°‘ï¼Œè¿™é‡Œæœ‰ä¸€äº›ä¼¼ä¹æ˜¯ ğŸª â€œé»˜è®¤å¯ç”¨ Unicodeâ€æ‰€éœ€çš„ä¸œè¥¿ï¼Œæ­£å¦‚æ‚¨æ‰€è¯´ï¼š</p>
<ol>
<li>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰ğŸªæºä»£ç éƒ½åº”è¯¥æ˜¯UTF-8ã€‚ä½ å¯ä»¥ç”¨<code>use utf8</code>orå¾—åˆ°å®ƒ<code>export PERL5OPTS=-Mutf8</code>ã€‚</p>
</li>
<li>
<p>ğŸª<code>DATA</code>å¥æŸ„åº”ä¸º UTF-8ã€‚æ‚¨å¿…é¡»åœ¨æ¯ä¸ªåŒ…çš„åŸºç¡€ä¸Šæ‰§è¡Œæ­¤æ“ä½œï¼Œå¦‚<code>binmode(DATA, ":encoding(UTF-8)")</code>.</p>
</li>
<li>
<p>ğŸª è„šæœ¬çš„ç¨‹åºå‚æ•°é»˜è®¤åº”è¯¥ç†è§£ä¸º UTF-8ã€‚<code>export PERL_UNICODE=A</code>, æˆ–<code>perl -CA</code>, æˆ–<code>export PERL5OPTS=-CA</code>ã€‚</p>
</li>
<li>
<p>æ ‡å‡†è¾“å…¥ã€è¾“å‡ºå’Œé”™è¯¯æµåº”é»˜è®¤ä¸º UTF-8ã€‚<code>export PERL_UNICODE=S</code>å¯¹äºæ‰€æœ‰è¿™äº›ï¼Œæˆ–è€…<code>I</code>, <code>O</code>, å’Œ/æˆ–<code>E</code>åªæ˜¯å…¶ä¸­çš„ä¸€äº›ã€‚è¿™å°±åƒ<code>perl -CS</code>ã€‚</p>
</li>
<li>
<p>ğŸª æ‰“å¼€çš„ä»»ä½•å…¶ä»–å¥æŸ„åº”è¢«è§†ä¸º UTF-8ï¼Œé™¤éå¦æœ‰å£°æ˜ï¼›<code>export PERL_UNICODE=D</code>æˆ–ä¸<code>i</code>å…¶ä¸­<code>o</code>çš„ç‰¹å®šéƒ¨åˆ†ä¸€èµ·ä½¿ç”¨ï¼›<code>export PERL5OPTS=-CD</code>ä¼šå·¥ä½œã€‚è¿™<code>-CSAD</code>å¯¹ä»–ä»¬æ‰€æœ‰äººéƒ½æ˜¯å¦‚æ­¤ã€‚</p>
</li>
<li>
<p>è¦†ç›–ä¸¤ä¸ªåŸºåœ°ä»¥åŠæ‚¨æ‰“å¼€çš„æ‰€æœ‰æµ<code>export PERL5OPTS=-Mopen=:utf8,:std</code>ã€‚è¯·å‚è§ <em>å•å¼•å·</em> ã€‚</p>
</li>
<li>
<p>æ‚¨ä¸æƒ³é”™è¿‡ UTF-8 ç¼–ç é”™è¯¯ã€‚å°è¯•<code>export PERL5OPTS=-Mwarnings=FATAL,utf8</code>ã€‚å¹¶ç¡®ä¿æ‚¨çš„è¾“å…¥æµå§‹ç»ˆ<code>binmode</code>æŒ‡å‘<code>:encoding(UTF-8)</code>ï¼Œè€Œä¸ä»…ä»…æ˜¯æŒ‡å‘<code>:utf8</code>ã€‚</p>
</li>
<li>
<p>ğŸª åº”è¯¥å°† 128â€“255 ä¹‹é—´çš„ä»£ç ç‚¹ç†è§£ä¸ºç›¸åº”çš„ Unicode ä»£ç ç‚¹ï¼Œè€Œä¸ä»…ä»…æ˜¯æ— å±æ€§çš„äºŒè¿›åˆ¶å€¼ã€‚<code>use feature "unicode_strings"</code>æˆ–<code>export PERL5OPTS=-Mfeature=unicode_strings</code>ã€‚è¿™å°†ä½¿<code>uc("\xDF") eq "SS"</code>å’Œ<code>"\xE9" =~ /\w/</code>ã€‚ä¸€ä¸ªç®€å•çš„<code>export PERL5OPTS=-Mv5.12</code>æˆ–æ›´å¥½çš„ä¹Ÿä¼šå¾—åˆ°å®ƒã€‚</p>
</li>
<li>
<p>å‘½åçš„ Unicode å­—ç¬¦åœ¨é»˜è®¤æƒ…å†µä¸‹ä¸å¯ç”¨ï¼Œæ‰€ä»¥æ·»åŠ <code>export PERL5OPTS=-Mcharnames=:full,:short,latin,greek</code>æˆ–ä¸€äº›è¿™æ ·çš„ã€‚è¯·å‚è§ <em>uninames</em> å’Œtcgrepã€‚</p>
</li>
<li>
<p>æ‚¨å‡ ä¹æ€»æ˜¯éœ€è¦è®¿é—®æ¥è‡ªæ ‡å‡†<code>Unicode::Normalize</code>æ¨¡å—å„ç§ç±»å‹åˆ†è§£çš„åŠŸèƒ½ã€‚<code>export PERL5OPTS=-MUnicode::Normalize=NFD,NFKD,NFC,NFKD</code>ï¼Œç„¶åæ€»æ˜¯é€šè¿‡ NFD è¿è¡Œä¼ å…¥çš„ä¸œè¥¿ï¼Œä» NFC è¿è¡Œå‡ºç«™çš„ä¸œè¥¿ã€‚æ®æˆ‘æ‰€çŸ¥ï¼Œè¿™äº›è¿˜æ²¡æœ‰ I/O å±‚ï¼Œä½†è¯·å‚é˜… <em>nfc</em> ã€ <em>nfd</em> ã€ <em>nfkd</em> å’Œ <em>nfkc</em> ã€‚</p>
</li>
<li>
<p>ğŸª ä¸­ä½¿ç”¨<code>eq</code>, <code>ne</code>, <code>lc</code>, <code>cmp</code>, <code>sort</code>, &amp;c&amp;cc çš„å­—ç¬¦ä¸²æ¯”è¾ƒæ€»æ˜¯é”™è¯¯çš„ã€‚å› æ­¤<code>@a = sort @b</code>ï¼Œæ‚¨éœ€è¦<code>@a = Unicode::Collate-&gt;new-&gt;sort(@b)</code>. ä¸å¦¨å°†å…¶æ·»åŠ åˆ°æ‚¨çš„<code>export PERL5OPTS=-MUnicode::Collate</code>. æ‚¨å¯ä»¥ç¼“å­˜ç”¨äºäºŒè¿›åˆ¶æ¯”è¾ƒçš„å¯†é’¥ã€‚</p>
</li>
<li>
<p>ğŸª å†…ç½®å‡½æ•°å–œæ¬¢<code>printf</code>å¹¶<code>write</code>ä½¿ç”¨ Unicode æ•°æ®åšé”™äº‹ã€‚æ‚¨éœ€è¦ä¸ºå‰è€…ä½¿ç”¨æ¨¡å—ï¼ŒåŒæ—¶ä¸º<code>Unicode::GCString</code>åè€…ä½¿ç”¨æ¨¡å—ã€‚<code>Unicode::LineBreak</code>è¯·å‚é˜… <em>uwc</em> å’Œ <em>unifmt</em> ã€‚</p>
</li>
<li>
<p>å¦‚æœä½ æƒ³è®©å®ƒä»¬è®¡æ•°ä¸ºæ•´æ•°ï¼Œé‚£ä¹ˆä½ å°†ä¸å¾—ä¸é€šè¿‡å‡½æ•°è¿è¡Œä½ çš„æ•è·<code>\d+</code>ï¼Œå› ä¸º ğŸª çš„å†…ç½® <em>atoi (3) ç›®å‰</em> è¿˜ä¸å¤Ÿèªæ˜ã€‚<code>Unicode::UCD::num</code> __</p>
</li>
<li>
<p>æ‚¨å°†åœ¨ ğŸ‘½ æ–‡ä»¶ç³»ç»Ÿä¸Šé‡åˆ°æ–‡ä»¶ç³»ç»Ÿé—®é¢˜ã€‚ä¸€äº›æ–‡ä»¶ç³»ç»Ÿé»˜é»˜åœ°å¼ºåˆ¶è½¬æ¢ä¸º NFCï¼›å…¶ä»–äººé»˜é»˜åœ°å¼ºåˆ¶è½¬æ¢ä¸º NFDã€‚è€Œå…¶ä»–äººè¿˜åœ¨åšå…¶ä»–äº‹æƒ…ã€‚æœ‰äº›äººç”šè‡³å®Œå…¨ä¸ç†ä¼šè¿™ä»¶äº‹ï¼Œè¿™ä¼šå¯¼è‡´æ›´å¤§çš„é—®é¢˜ã€‚æ‰€ä»¥ä½ å¿…é¡»è‡ªå·±å¤„ç† NFC/NFD ä»¥ä¿æŒç†æ™ºã€‚</p>
</li>
<li>
<p>æ‚¨æ‰€æœ‰æ¶‰åŠ<code>a-z</code>or<code>A-Z</code>å’Œæ­¤ç±»çš„ğŸª ä»£ç éƒ½ <strong>å¿…é¡»æ›´æ”¹</strong> ï¼ŒåŒ…æ‹¬<code>m//</code>ã€<code>s///</code>å’Œ<code>tr///</code>ã€‚å®ƒåº”è¯¥ä½œä¸ºä¸€ä¸ªå°–å«çš„çº¢æ——è„±é¢–è€Œå‡ºï¼Œè¡¨æ˜æ‚¨çš„ä»£ç å·²æŸåã€‚ä½†å°šä¸æ¸…æ¥šå®ƒå¿…é¡»å¦‚ä½•æ”¹å˜ã€‚è·å¾—æ­£ç¡®çš„å±æ€§å¹¶äº†è§£å®ƒä»¬çš„æ¡ˆä¾‹ï¼Œæ¯”æ‚¨æƒ³è±¡çš„è¦éš¾ã€‚æˆ‘æ¯å¤©éƒ½ä½¿ç”¨ <em>unichars</em> å’Œ <em>uniprops ã€‚</em></p>
</li>
<li>
<p>ä½¿ç”¨çš„ä»£ç <code>\p{Lu}</code>å‡ ä¹å’Œä½¿ç”¨<code>[A-Za-z]</code>. æ‚¨éœ€è¦<code>\p{Upper}</code>æ”¹ä¸ºä½¿ç”¨ï¼Œå¹¶çŸ¥é“åŸå› ã€‚æ˜¯çš„ï¼Œ<code>\p{Lowercase}</code>and<code>\p{Lower}</code>ä¸åŒäº<code>\p{Ll}</code>and <code>\p{Lowercase_Letter}</code>ã€‚</p>
</li>
<li>
<p>ä½¿ç”¨çš„ä»£ç <code>[a-zA-Z]</code>æ›´ç³Ÿã€‚å®ƒä¸èƒ½ä½¿ç”¨<code>\pL</code>or <code>\p{Letter}</code>ï¼›å®ƒéœ€è¦ä½¿ç”¨<code>\p{Alphabetic}</code>. ä¸æ˜¯æ‰€æœ‰çš„å­—æ¯éƒ½æ˜¯å­—æ¯ï¼Œä½ çŸ¥é“çš„ï¼</p>
</li>
<li>
<p>å¦‚æœä½ æ­£åœ¨å¯»æ‰¾ ğŸª å˜é‡<code>/[\$\@\%]\w+/</code>ï¼Œé‚£ä¹ˆä½ å°±æœ‰é—®é¢˜äº†ã€‚æ‚¨éœ€è¦å¯»æ‰¾<code>/[\$\@\%]\p{IDS}\p{IDC}*/</code>ï¼Œç”šè‡³æ²¡æœ‰è€ƒè™‘æ ‡ç‚¹ç¬¦å·å˜é‡æˆ–åŒ…å˜é‡ã€‚</p>
</li>
<li>
<p>å¦‚æœæ‚¨æ­£åœ¨æ£€æŸ¥ç©ºæ ¼ï¼Œé‚£ä¹ˆæ‚¨åº”è¯¥åœ¨<code>\h</code>å’Œä¹‹é—´è¿›è¡Œé€‰æ‹©<code>\v</code>ï¼Œå…·ä½“å–å†³äºã€‚è€Œä¸”ä½ æ°¸è¿œä¸åº”è¯¥ä½¿ç”¨<code>\s</code>ï¼Œå› ä¸ºå®ƒ <strong>å¹¶ä¸æ„å‘³ç€</strong> <code>[\h\v]</code>ï¼Œè¿™ä¸æ™®éçš„çœ‹æ³•ç›¸åã€‚</p>
</li>
<li>
<p>å¦‚æœæ‚¨ä½¿ç”¨çš„<code>\n</code>æ˜¯çº¿è¾¹ç•Œï¼Œç”šè‡³æ˜¯<code>\r\n</code>ï¼Œé‚£ä¹ˆæ‚¨åšé”™äº†ã€‚ä½ å¿…é¡»ä½¿ç”¨<code>\R</code>ï¼Œè¿™æ˜¯ä¸ä¸€æ ·çš„ï¼</p>
</li>
<li>
<p>å¦‚æœæ‚¨ä¸çŸ¥é“ä½•æ—¶ä»¥åŠæ˜¯å¦è°ƒç”¨Unicode::Stringprepï¼Œé‚£ä¹ˆæ‚¨æœ€å¥½å­¦ä¹ ä¸€ä¸‹ã€‚</p>
</li>
<li>
<p>ä¸åŒºåˆ†å¤§å°å†™çš„æ¯”è¾ƒéœ€è¦æ£€æŸ¥ä¸¤ä¸ªä¸œè¥¿æ˜¯å¦æ˜¯ç›¸åŒçš„å­—æ¯ï¼Œè€Œä¸ç®¡å®ƒä»¬çš„å˜éŸ³ç¬¦å·ç­‰ç­‰ã€‚æœ€ç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨æ ‡å‡†çš„ Unicode::Collatâ€‹â€‹eæ¨¡å—ã€‚<code>Unicode::Collate-&gt;new(level =&gt; 1)-&gt;cmp($a, $b)</code>. è¿˜æœ‰<code>eq</code>æ–¹æ³•ç­‰ç­‰ï¼Œæ‚¨å¯èƒ½ä¹Ÿåº”è¯¥äº†è§£<code>match</code>å’Œ<code>substr</code>æ–¹æ³•ã€‚è¿™äº›ä¸ ğŸª å†…ç½®å‡½æ•°ç›¸æ¯”å…·æœ‰æ˜æ˜¾çš„ä¼˜åŠ¿ã€‚</p>
</li>
<li>
<p>æœ‰æ—¶è¿™ä»ç„¶ä¸å¤Ÿï¼Œæ‚¨éœ€è¦Unicode::Collatâ€‹â€‹e::Localeæ¨¡å—ï¼Œå¦‚ in <code>Unicode::Collate::Locale-&gt;new(locale =&gt; "de__phonebook", level =&gt; 1)-&gt;cmp($a, $b)</code>insteadã€‚è®¤ä¸ºé‚£<code>Unicode::Collate::-&gt;new(level =&gt; 1)-&gt;eq("d", "Ã°")</code>æ˜¯çœŸçš„ï¼Œä½†å´<code>Unicode::Collate::Locale-&gt;new(locale=&gt;"is",level =&gt; 1)-&gt;eq("d", " Ã°")</code>æ˜¯å‡çš„ã€‚åŒæ ·ï¼Œâ€œaeâ€å’Œâ€œÃ¦â€è¡¨ç¤º<code>eq</code>æ‚¨ä¸ä½¿ç”¨è¯­è¨€ç¯å¢ƒï¼Œæˆ–è€…å¦‚æœæ‚¨ä½¿ç”¨è‹±è¯­è¯­è¨€ç¯å¢ƒï¼Œä½†å®ƒä»¬åœ¨å†°å²›è¯­è¨€ç¯å¢ƒä¸­æ˜¯ä¸åŒçš„ã€‚æ€ä¹ˆåŠï¼Ÿè¿™å¾ˆéš¾ï¼Œæˆ‘å‘Šè¯‰ä½ ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ <em>ucsort</em> æ¥æµ‹è¯•å…¶ä¸­çš„ä¸€äº›ä¸œè¥¿ã€‚</p>
</li>
<li>
<p>è€ƒè™‘å¦‚ä½•åŒ¹é…å­—ç¬¦ä¸²â€œ <em>niÃ±o</em> â€ä¸­çš„æ¨¡å¼ CVCVï¼ˆè¾…éŸ³ã€å…ƒéŸ³ã€è¾…éŸ³ã€å…ƒéŸ³ï¼‰ã€‚å®ƒçš„ NFD å½¢å¼â€”â€”ä½ æœ€å¥½è®°å¾—æŠŠå®ƒæ”¾è¿›å»â€”â€”å˜æˆäº†â€œnin\x{303}oâ€ã€‚ç°åœ¨ä½ æ‰“ç®—æ€ä¹ˆåŠï¼Ÿå³ä½¿å‡è£…å…ƒéŸ³æ˜¯<code>[aeiou]</code>ï¼ˆé¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œè¿™æ˜¯é”™è¯¯çš„ï¼‰ï¼Œä½ ä¹Ÿä¸èƒ½åšä»»ä½•ç±»ä¼¼çš„äº‹æƒ…<code>(?=[aeiou])\X)</code>ï¼Œå› ä¸ºå³ä½¿åœ¨ NFD ä¸­ï¼Œåƒ 'Ã¸' è¿™æ ·çš„ä»£ç ç‚¹ <strong>ä¹Ÿä¸ä¼šåˆ†è§£</strong> ï¼ä½†æ˜¯ï¼Œä½¿ç”¨æˆ‘åˆšåˆšå‘æ‚¨å±•ç¤ºçš„ UCA æ¯”è¾ƒï¼Œå®ƒå°†æµ‹è¯•ç­‰äºâ€œoâ€ã€‚ä¸èƒ½é NFDï¼Œå¾—é UCAã€‚</p>
</li>
</ol>
<hr>
<h3>ğŸ’©ğ”¸ğ•¤ğ•¤ğ•¦ğ•ğ•–ğ”¹ğ•£ğ• ğ•œğ•–ğ•Ÿğ•Ÿğ•–ğ•¤ğ•¤ğŸ’©</h3>
<hr>
<p>è¿™è¿˜ä¸æ˜¯å…¨éƒ¨ã€‚äººä»¬å¯¹ Unicode åšå‡ºäº†ä¸€ç™¾ä¸‡ä¸ªé”™è¯¯çš„å‡è®¾ã€‚åœ¨ä»–ä»¬ç†è§£è¿™äº›ä¸œè¥¿ä¹‹å‰ï¼Œä»–ä»¬çš„ğŸªä»£ç å°†è¢«ç ´è§£ã€‚</p>
<ol>
<li>
<p>å‡è®¾å®ƒå¯ä»¥åœ¨ä¸æŒ‡å®šç¼–ç çš„æƒ…å†µä¸‹æ‰“å¼€æ–‡æœ¬æ–‡ä»¶çš„ä»£ç å·²æŸåã€‚</p>
</li>
<li>
<p>å‡å®šé»˜è®¤ç¼–ç æ˜¯æŸç§æœ¬æœºå¹³å°ç¼–ç çš„ä»£ç å·²æŸåã€‚</p>
</li>
<li>
<p>å‡å®šæ—¥æ–‡æˆ–ä¸­æ–‡ç½‘é¡µåœ¨ UTF-16 ä¸­æ¯”åœ¨ UTF-8 ä¸­å ç”¨æ›´å°‘ç©ºé—´çš„ä»£ç æ˜¯é”™è¯¯çš„ã€‚</p>
</li>
<li>
<p>å‡å®š Perl å†…éƒ¨ä½¿ç”¨ UTF-8 çš„ä»£ç æ˜¯é”™è¯¯çš„ã€‚</p>
</li>
<li>
<p>å‡è®¾ç¼–ç é”™è¯¯æ€»æ˜¯å¼•å‘å¼‚å¸¸çš„ä»£ç æ˜¯é”™è¯¯çš„ã€‚</p>
</li>
<li>
<p>å‡å®š Perl ä»£ç ç‚¹é™åˆ¶ä¸º 0x10_FFFF çš„ä»£ç æ˜¯é”™è¯¯çš„ã€‚</p>
</li>
<li>
<p>å‡å®šæ‚¨å¯ä»¥è®¾ç½®<code>$/</code>ä¸ºé€‚ç”¨äºä»»ä½•æœ‰æ•ˆè¡Œåˆ†éš”ç¬¦çš„å†…å®¹çš„ä»£ç æ˜¯é”™è¯¯çš„ã€‚</p>
</li>
<li>
<p>å‡è®¾ casefolding çš„å¾€è¿”ç›¸ç­‰çš„ä»£ç ï¼Œå¦‚<code>lc(uc($s)) eq $s</code>or <code>uc(lc($s)) eq $s</code>ï¼Œæ˜¯å®Œå…¨é”™è¯¯çš„ã€‚è€ƒè™‘åˆ°<code>uc("Ïƒ")</code>å’Œ<code>uc("Ï‚")</code>éƒ½æ˜¯<code>"Î£"</code>ï¼Œä½†<code>lc("Î£")</code>ä¸å¯èƒ½åŒæ—¶è¿”å›è¿™ä¸¤ä¸ªã€‚</p>
</li>
<li>
<p>Code that assumes every lowercase code point has a distinct uppercase one, or vice versa, is broken. For example, <code>"Âª"</code> is a lowercase letter with no uppercase; whereas both <code>"áµƒ"</code> and <code>"á´¬"</code> are letters, but they are not lowercase letters; however, they are both lowercase code points without corresponding uppercase versions. Got that? They are <strong>not</strong> <code>\p{Lowercase_Letter}</code>, despite being both <code>\p{Letter}</code> and <code>\p{Lowercase}</code>.</p>
</li>
<li>
<p>Code that assumes changing the case doesnâ€™t change the length of the string is broken.</p>
</li>
<li>
<p>Code that assumes there are only two cases is broken. Thereâ€™s also titlecase.</p>
</li>
<li>
<p>Code that assumes only letters have case is broken. Beyond just letters, it turns out that numbers, symbols, and even marks have case. In fact, changing the case can even make something change its main general category, like a <code>\p{Mark}</code> turning into a <code>\p{Letter}</code>. It can also make it switch from one script to another.</p>
</li>
<li>
<p>Code that assumes that case is never locale-dependent is broken.</p>
</li>
<li>
<p>Code that assumes Unicode gives a fig about POSIX locales is broken.</p>
</li>
<li>
<p>Code that assumes you can remove diacritics to get at base ASCII letters is evil, still, broken, brain-damaged, wrong, and justification for capital punishment.</p>
</li>
<li>
<p>Code that assumes that diacritics <code>\p{Diacritic}</code> and marks <code>\p{Mark}</code> are the same thing is broken.</p>
</li>
<li>
<p>Code that assumes <code>\p{GC=Dash_Punctuation}</code> covers as much as <code>\p{Dash}</code> is broken.</p>
</li>
<li>
<p>Code that assumes dash, hyphens, and minuses are the same thing as each other, or that there is only one of each, is broken and wrong.</p>
</li>
<li>
<p>Code that assumes every code point takes up no more than one print column is broken.</p>
</li>
<li>
<p>Code that assumes that all <code>\p{Mark}</code> characters take up zero print columns is broken.</p>
</li>
<li>
<p>Code that assumes that characters which look alike <em>are</em> alike is broken.</p>
</li>
<li>
<p>Code that assumes that characters which do <em>not</em> look alike are <em>not</em> alike is broken.</p>
</li>
<li>
<p>Code that assumes there is a limit to the number of code points in a row that just one <code>\X</code> can match is wrong.</p>
</li>
<li>
<p>Code that assumes <code>\X</code> can never start with a <code>\p{Mark}</code> character is wrong.</p>
</li>
<li>
<p>Code that assumes that <code>\X</code> can never hold two non-<code>\p{Mark}</code> characters is wrong.</p>
</li>
<li>
<p>Code that assumes that it cannot use <code>"\x{FFFF}"</code> is wrong.</p>
</li>
<li>
<p>Code that assumes a non-BMP code point that requires two UTF-16 (surrogate) code units will encode to two separate UTF-8 characters, one per code unit, is wrong. It doesnâ€™t: it encodes to single code point.</p>
</li>
<li>
<p>Code that transcodes from UTFâ€16 or UTFâ€32 with leading BOMs into UTFâ€8 is broken if it puts a BOM at the start of the resulting UTF-8. This is so stupid the engineer should have their eyelids removed.</p>
</li>
<li>
<p>Code that assumes the CESU-8 is a valid UTF encoding is wrong. Likewise, code that thinks encoding U+0000 as <code>"\xC0\x80"</code> is UTF-8 is broken and wrong. These guys also deserve the eyelid treatment.</p>
</li>
<li>
<p>Code that assumes characters like <code>&gt;</code> always points to the right and <code>&lt;</code> always points to the left are wrong â€” because they in fact do not.</p>
</li>
<li>
<p>Code that assumes if you first output character <code>X</code> and then character <code>Y</code>, that those will show up as <code>XY</code> is wrong. Sometimes they donâ€™t.</p>
</li>
<li>
<p><strong>Code that assumes that ASCII is good enough for writing English properly is stupid, shortsighted, illiterate, broken, evil, and wrong.</strong> Off with their heads! If that seems too extreme, we can compromise: henceforth they may type only with their big toe from one foot. (The rest will be duct taped.)</p>
</li>
<li>
<p>Code that assumes that all <code>\p{Math}</code> code points are visible characters is wrong.</p>
</li>
<li>
<p>Code that assumes <code>\w</code> contains only letters, digits, and underscores is wrong.</p>
</li>
<li>
<p>Code that assumes that <code>^</code> and <code>~</code> are punctuation marks is wrong.</p>
</li>
<li>
<p>Code that assumes that <code>Ã¼</code> has an umlaut is wrong.</p>
</li>
<li>
<p>Code that believes things like <code>â‚¨</code> contain any letters in them is wrong.</p>
</li>
<li>
<p>Code that believes <code>\p{InLatin}</code> is the same as <code>\p{Latin}</code> is heinously broken. </p>
</li>
<li>
<p>Code that believe that <code>\p{InLatin}</code> is almost ever useful is almost certainly wrong.</p>
</li>
<li>
<p>Code that believes that given <code>$FIRST_LETTER</code> as the first letter in some alphabet and <code>$LAST_LETTER</code> as the last letter in that same alphabet, that <code>[${FIRST_LETTER}-${LAST_LETTER}]</code> has any meaning whatsoever is almost always complete broken and wrong and meaningless.</p>
</li>
<li>
<p>Code that believes someoneâ€™s name can only contain certain characters is stupid, offensive, and wrong.</p>
</li>
<li>
<p>Code that tries to reduce Unicode to ASCII is not merely wrong, its perpetrator should never be allowed to work in programming again. Period. Iâ€™m not even positive they should even be allowed to see again, since it obviously hasnâ€™t done them much good so far.</p>
</li>
<li>
<p>Code that believes thereâ€™s some way to pretend textfile encodings donâ€™t exist is broken and dangerous. Might as well poke the other eye out, too.</p>
</li>
<li>
<p>Code that converts unknown characters to <code>?</code> is broken, stupid, braindead, and runs contrary to the standard recommendation, which says <strong>NOT TO DO THAT!</strong> RTFM for why not.</p>
</li>
<li>
<p>Code that believes it can reliably guess the encoding of an unmarked textfile is guilty of a fatal mÃ©lange of hubris and naÃ¯vetÃ© that only a lightning bolt from Zeus will fix.</p>
</li>
<li>
<p>Code that believes you can use ğŸª <code>printf</code> widths to pad and justify Unicode data is broken and wrong.</p>
</li>
<li>
<p>Code that believes once you successfully create a file by a given name, that when you run <code>ls</code> or <code>readdir</code> on its enclosing directory, youâ€™ll actually find that file with the name you created it under is buggy, broken, and wrong. Stop being surprised by this!</p>
</li>
<li>
<p>Code that believes UTF-16 is a fixed-width encoding is stupid, broken, and wrong. Revoke their programming licence.</p>
</li>
<li>
<p>Code that treats code points from one plane one whit differently than those from any other plane is <em>ipso facto</em> broken and wrong. Go back to school.</p>
</li>
<li>
<p>Code that believes that stuff like <code>/s/i</code> can only match <code>"S"</code> or <code>"s"</code> is broken and wrong. Youâ€™d be surprised.</p>
</li>
<li>
<p>Code that uses <code>\PM\pM*</code> to find grapheme clusters instead of using <code>\X</code> is broken and wrong.</p>
</li>
<li>
<p>People who want to go back to the ASCII world should be whole-heartedly encouraged to do so, and in honor of their glorious upgrade they should be provided <em>gratis</em> with a pre-electric manual typewriter for all their data-entry needs. Messages sent to them should be sent via an á´€ÊŸÊŸá´„á´€á´˜s telegraph at 40 characters per line and hand-delivered by a courier. STOP.</p>
</li>
</ol>
<hr>
<h2>ğŸ˜± ğ•¾ ğ–€ ğ•¸ ğ•¸ ğ•¬ ğ•½ ğ–„ ğŸ˜±</h2>
<hr>
<p>I donâ€™t know how much more â€œdefault Unicode in ğŸªâ€ you can get than what Iâ€™ve
written. Well, yes I do: you should be using <code>Unicode::Collate</code> and
<code>Unicode::LineBreak</code>, too. And probably more.</p>
<p>As you see, there are far too many Unicode things that you really <em>do</em> have to
worry about for there to <em>ever</em> exist any such thing as â€œdefault to Unicodeâ€.</p>
<p>What youâ€™re going to discover, just as we did back in ğŸª 5.8, that it is simply
impossible to impose all these things on code that hasnâ€™t been designed right
from the beginning to account for them. Your well-meaning selfishness just
broke the entire world.</p>
<p>And even once you do, there are still critical issues that require a great
deal of thought to get right. There is no switch you can flip. Nothing but
brain, and I mean <em>real brain</em> , will suffice here. Thereâ€™s a heck of a lot of
stuff you have to learn. Modulo the retreat to the manual typewriter, you
simply cannot hope to sneak by in ignorance. This is the 21Ë¢áµ— century, and you
cannot wish Unicode away by willful ignorance.</p>
<p>You have to learn it. Period. It will never be so easy that â€œeverything just
works,â€ because that will guarantee that a lot of things <strong>donâ€™t</strong> work â€”
which invalidates the assumption that there can ever be a way to â€œmake it all
work.â€</p>
<p>You may be able to get a few reasonable defaults for a very few and very
limited operations, but not without thinking about things a whole lot more
than I think you have.</p>
<p>As just one example, canonical ordering is going to cause some real headaches.
ğŸ˜­<code>"\x{F5}"</code> <strong>â€˜Ãµâ€™</strong> , <code>"o\x{303}"</code> <strong>â€˜Ãµâ€™</strong> , <code>"o\x{303}\x{304}"</code> <strong>â€˜È­â€™</strong> , and
<code>"o\x{304}\x{303}"</code> <strong>â€˜ÅÌƒâ€™</strong> should all match <strong>â€˜Ãµâ€™</strong> , but how in the world
are you going to do that? This is harder than it looks, but itâ€™s something you
need to account for. ğŸ’£</p>
<p>If thereâ€™s one thing I know about Perl, it is what its Unicode bits do and do
not do, and this thing I promise you: <strong>â€œ Ì²á´›Ì²ÊœÌ²á´‡Ì²Ê€Ì²á´‡Ì² Ì²ÉªÌ²sÌ² Ì²É´Ì²á´Ì²
Ì²UÌ²É´Ì²ÉªÌ²á´„Ì²á´Ì²á´…Ì²á´‡Ì² Ì²á´Ì²á´€Ì²É¢Ì²ÉªÌ²á´„Ì² Ì²Ê™Ì²á´œÌ²ÊŸÌ²ÊŸÌ²á´‡Ì²á´›Ì² Ì² â€</strong> ğŸ˜</p>
<p>You cannot just change some defaults and get smooth sailing. Itâ€™s true that I
run ğŸª with <code>PERL_UNICODE</code> set to <code>"SA"</code>, but thatâ€™s all, and even that is
mostly for command-line stuff. For real work, I go through all the many steps
outlined above, and I do it very, <strong> very</strong> carefully.</p>
<hr>
<h2>ğŸ˜ˆ Â¡Æ¨dlÉ™É¥ Æ¨á´‰É¥Ê‡ É™doÉ¥ puÉ Ê»Î»Ép É™É”á´‰u É É™ÊŒÉÉ¥ Ê»ÊÉ”nl pooâ… ğŸ˜ˆ</h2>
<p><br></p>
<h3>æ›´å¤šå»ºè®®</h3>
<p>å¤„ç† Unicode æ–‡æœ¬æœ‰ä¸¤ä¸ªé˜¶æ®µã€‚ç¬¬ä¸€ä¸ªæ˜¯â€œå¦‚ä½•åœ¨ä¸ä¸¢å¤±ä¿¡æ¯çš„æƒ…å†µä¸‹è¾“å…¥å’Œè¾“å‡ºâ€ã€‚ç¬¬äºŒä¸ªæ˜¯â€œæˆ‘å¦‚ä½•æ ¹æ®å½“åœ°è¯­è¨€æƒ¯ä¾‹å¤„ç†æ–‡æœ¬â€ã€‚</p>
<p>tchrist çš„å¸–å­æ¶µç›–äº†ä¸¤è€…ï¼Œä½†ç¬¬äºŒéƒ¨åˆ†æ˜¯ä»–å¸–å­ä¸­ 99% çš„æ–‡æœ¬çš„æ¥æºã€‚å¤§å¤šæ•°ç¨‹åºç”šè‡³ä¸èƒ½æ­£ç¡®å¤„ç†
I/Oï¼Œå› æ­¤åœ¨æ‚¨å¼€å§‹æ‹…å¿ƒè§„èŒƒåŒ–å’Œæ•´ç†ä¹‹å‰äº†è§£è¿™ä¸€ç‚¹å¾ˆé‡è¦ã€‚</p>
<p>è¿™ç¯‡æ–‡ç« æ—¨åœ¨è§£å†³ç¬¬ä¸€ä¸ªé—®é¢˜</p>
<p>å½“æ‚¨å°†æ•°æ®è¯»å…¥ Perl æ—¶ï¼Œå®ƒå¹¶ä¸å…³å¿ƒå®ƒæ˜¯ä»€ä¹ˆç¼–ç ã€‚å®ƒåˆ†é…ä¸€äº›å†…å­˜å¹¶å°†å­—èŠ‚å­˜å‚¨åœ¨é‚£é‡Œã€‚å¦‚æœä½ è¯´<code>print
$str</code>ï¼Œå®ƒåªæ˜¯å°†è¿™äº›å­—èŠ‚è¾“å‡ºåˆ°ä½ çš„ç»ˆç«¯ï¼Œè¿™å¯èƒ½è¢«è®¾ç½®ä¸ºå‡è®¾å†™å…¥å®ƒçš„æ‰€æœ‰å†…å®¹éƒ½æ˜¯ UTF-8ï¼Œå¹¶ä¸”ä½ çš„æ–‡æœ¬æ˜¾ç¤ºå‡ºæ¥ã€‚</p>
<p>å¥‡å¦™ã€‚</p>
<p>é™¤äº†ï¼Œå®ƒä¸æ˜¯ã€‚å¦‚æœæ‚¨å°è¯•å°†æ•°æ®è§†ä¸ºæ–‡æœ¬ï¼Œæ‚¨ä¼šå‘ç°å‘ç”Ÿäº†ä¸€äº›ä¸å¥½çš„äº‹æƒ…ã€‚æ‚¨åªéœ€çœ‹çœ‹<code>length</code>Perl
å¯¹æ‚¨çš„å­—ç¬¦ä¸²çš„çœ‹æ³•ä¸æ‚¨å¯¹æ‚¨çš„å­—ç¬¦ä¸²çš„çœ‹æ³•æ˜¯å¦ä¸ä¸€è‡´ã€‚å†™ä¸€è¡Œè¿™æ ·çš„ï¼š<code>perl -E 'while(&lt;&gt;){ chomp; say length
}'</code>ç„¶åè¾“å…¥<code>æ–‡å­—åŒ–ã‘</code>ï¼Œä½ ä¼šå¾—åˆ° 12... ä¸æ˜¯æ­£ç¡®ç­”æ¡ˆï¼Œ4ã€‚</p>
<p>é‚£æ˜¯å› ä¸º Perl å‡å®šæ‚¨çš„å­—ç¬¦ä¸²ä¸æ˜¯æ–‡æœ¬ã€‚ä½ å¿…é¡»å‘Šè¯‰å®ƒè¿™æ˜¯æ–‡æœ¬ï¼Œç„¶åå®ƒæ‰ä¼šç»™ä½ æ­£ç¡®çš„ç­”æ¡ˆã€‚</p>
<p>è¿™å¾ˆå®¹æ˜“ï¼›Encode æ¨¡å—å…·æœ‰æ‰§è¡Œæ­¤æ“ä½œçš„åŠŸèƒ½ã€‚é€šç”¨å…¥å£ç‚¹æ˜¯<code>Encode::decode</code>ï¼ˆæˆ–è€…<code>use Encode
qw(decode)</code>ï¼Œå½“ç„¶ï¼‰ã€‚è¯¥å‡½æ•°ä»å¤–éƒ¨ä¸–ç•Œè·å–ä¸€äº›å­—ç¬¦ä¸²ï¼ˆæˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œå…«ä½å­—èŠ‚â€ï¼Œä¸€ç§â€œ8 ä½å­—èŠ‚â€çš„å¥‡ç‰¹è¯´æ³•ï¼‰ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸º Perl
å¯ä»¥ç†è§£çš„æ–‡æœ¬ã€‚ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å­—ç¬¦ç¼–ç åç§°ï¼Œå¦‚â€œUTF-8â€æˆ–â€œASCIIâ€æˆ–â€œEUC-JPâ€ã€‚ç¬¬äºŒä¸ªå‚æ•°æ˜¯å­—ç¬¦ä¸²ã€‚è¿”å›å€¼æ˜¯åŒ…å«æ–‡æœ¬çš„ Perl æ ‡é‡ã€‚</p>
<p>ï¼ˆè¿˜æœ‰<code>Encode::decode_utf8</code>ï¼Œå®ƒå‡å®šç¼–ç ä¸º UTF-8ã€‚ï¼‰</p>
<p>å¦‚æœæˆ‘ä»¬é‡å†™æˆ‘ä»¬çš„ä¸€è¡Œä»£ç ï¼š</p>
<div class="code"><pre class="code literal-block"><span class="nv">perl</span><span class="w"> </span><span class="o">-</span><span class="nv">MEncode</span><span class="o">=</span><span class="nv">decode</span><span class="w"> </span><span class="o">-</span><span class="nv">E</span><span class="w"> </span><span class="s1">'while(&lt;&gt;){ chomp; say length decode("UTF-8", $_) }'</span>
</pre></div>

<p>æˆ‘ä»¬è¾“å…¥æ–‡å­—åŒ–ã‘ï¼Œç»“æœæ˜¯â€œ4â€ã€‚æˆåŠŸã€‚</p>
<p>é‚£å°±æ˜¯ Perl ä¸­ 99% çš„ Unicode é—®é¢˜çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<p>å…³é”®æ˜¯ï¼Œæ— è®ºä½•æ—¶ä»»ä½•æ–‡æœ¬è¿›å…¥æ‚¨çš„ç¨‹åºï¼Œæ‚¨éƒ½å¿…é¡»å¯¹å…¶è¿›è¡Œè§£ç ã€‚äº’è”ç½‘æ— æ³•ä¼ è¾“å­—ç¬¦ã€‚æ–‡ä»¶ä¸èƒ½å­˜å‚¨å­—ç¬¦ã€‚æ‚¨çš„æ•°æ®åº“ä¸­æ²¡æœ‰å­—ç¬¦ã€‚åªæœ‰å…«ä½å­—èŠ‚ï¼Œæ‚¨ä¸èƒ½å°†å…«ä½å­—èŠ‚è§†ä¸º
Perl ä¸­çš„å­—ç¬¦ã€‚æ‚¨å¿…é¡»ä½¿ç”¨ç¼–ç æ¨¡å—å°†ç¼–ç çš„å…«ä½å­—èŠ‚è§£ç ä¸º Perl å­—ç¬¦ã€‚</p>
<p>é—®é¢˜çš„å¦ä¸€åŠæ˜¯ä»ç¨‹åºä¸­è·å–æ•°æ®ã€‚è¿™å¾ˆå®¹æ˜“ï¼›ä½ åªæ˜¯è¯´<code>use Encode qw(encode)</code>ï¼Œå†³å®šä½ çš„æ•°æ®å°†é‡‡ç”¨ä»€ä¹ˆç¼–ç ï¼ˆUTF-8 åˆ°ç†è§£ UTF-8
çš„ç»ˆç«¯ï¼ŒUTF-16 ç”¨äº Windows ä¸Šçš„æ–‡ä»¶ç­‰ï¼‰ï¼Œç„¶åè¾“å‡ºç»“æœè€Œä¸æ˜¯ä»…ä»…<code>encode($encoding, $data)</code>è¾“å‡º<code>$data</code>.</p>
<p>æ­¤æ“ä½œå°† Perl çš„å­—ç¬¦ï¼ˆæ‚¨çš„ç¨‹åºæ‰€æ“ä½œçš„å­—ç¬¦ï¼‰è½¬æ¢ä¸ºå¤–éƒ¨ä¸–ç•Œå¯ä»¥ä½¿ç”¨çš„å…«ä½å­—èŠ‚ã€‚å¦‚æœæˆ‘ä»¬å¯ä»¥é€šè¿‡ Internet
æˆ–å°†å­—ç¬¦å‘é€åˆ°æˆ‘ä»¬çš„ç»ˆç«¯ï¼Œé‚£ä¼šå®¹æ˜“å¾—å¤šï¼Œä½†æˆ‘ä»¬ä¸èƒ½ï¼šä»…å…«ä½å­—èŠ‚ã€‚æ‰€ä»¥æˆ‘ä»¬å¿…é¡»å°†å­—ç¬¦è½¬æ¢ä¸ºå…«ä½å­—èŠ‚ï¼Œå¦åˆ™ç»“æœæ˜¯ä¸ç¡®å®šçš„ã€‚</p>
<p>æ€»ç»“ä¸€ä¸‹ï¼šç¼–ç æ‰€æœ‰è¾“å‡ºå¹¶è§£ç æ‰€æœ‰è¾“å…¥ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬è®¨è®ºä¸‰ä¸ªé—®é¢˜ï¼Œè¿™ä¸‰ä¸ªé—®é¢˜ä¼šè®©è¿™ä»¶äº‹å˜å¾—æœ‰ç‚¹æŒ‘æˆ˜ã€‚é¦–å…ˆæ˜¯å›¾ä¹¦é¦†ã€‚ä»–ä»¬æ˜¯å¦æ­£ç¡®å¤„ç†æ–‡æœ¬ï¼Ÿç­”æ¡ˆæ˜¯â€¦â€¦ä»–ä»¬å°è¯•ã€‚å¦‚æœæ‚¨ä¸‹è½½ç½‘é¡µï¼ŒLWP
å°†ä»¥æ–‡æœ¬å½¢å¼è¿”å›ç»“æœã€‚å¦‚æœæ‚¨å¯¹ç»“æœè°ƒç”¨æ­£ç¡®çš„æ–¹æ³•ï¼Œé‚£å°±æ˜¯ï¼ˆæ°å¥½æ˜¯<code>decoded_content</code>ï¼Œè€Œä¸æ˜¯<code>content</code>ï¼Œè¿™åªæ˜¯å®ƒä»æœåŠ¡å™¨è·å¾—çš„å…«ä½å­—èŠ‚æµã€‚ï¼‰æ•°æ®åº“é©±åŠ¨ç¨‹åºå¯èƒ½ä¸ç¨³å®šï¼›å¦‚æœæ‚¨ä»…å°†
DBD::SQLite ä¸ Perl ä¸€èµ·ä½¿ç”¨ï¼Œå®ƒä¼šæˆåŠŸï¼Œä½†æ˜¯å¦‚æœå…¶ä»–ä¸€äº›å·¥å…·å°†æ–‡æœ¬å­˜å‚¨ä¸ºæ•°æ®åº“ä¸­ UTF-8
ä»¥å¤–çš„æŸç§ç¼–ç ......é‚£ä¹ˆ......å®ƒä¸ä¼šè¢«æ­£ç¡®å¤„ç†ç›´åˆ°ä½ ç¼–å†™ä»£ç æ¥æ­£ç¡®å¤„ç†å®ƒã€‚</p>
<p>è¾“å‡ºæ•°æ®é€šå¸¸æ›´å®¹æ˜“ï¼Œä½†æ˜¯å¦‚æœæ‚¨çœ‹åˆ°â€œæ‰“å°çš„å®½å­—ç¬¦â€ï¼Œé‚£ä¹ˆæ‚¨å°±çŸ¥é“æ‚¨åœ¨æŸå¤„å¼„ä¹±äº†ç¼–ç ã€‚è¯¥è­¦å‘Šçš„æ„æ€æ˜¯â€œå˜¿ï¼Œæ‚¨æ­£è¯•å›¾å‘å¤–ç•Œæ³„éœ² Perl
å­—ç¬¦ï¼Œè¿™æ²¡æœ‰ä»»ä½•æ„ä¹‰â€ã€‚æ‚¨çš„ç¨‹åºä¼¼ä¹å¯ä»¥å·¥ä½œï¼ˆå› ä¸ºå¦ä¸€ç«¯é€šå¸¸å¯ä»¥æ­£ç¡®å¤„ç†åŸå§‹ Perl
å­—ç¬¦ï¼‰ï¼Œä½†å®ƒéå¸¸æŸåå¹¶ä¸”å¯èƒ½éšæ—¶åœæ­¢å·¥ä½œã€‚ç”¨æ˜¾å¼ä¿®å¤å®ƒ<code>Encode::encode</code>ï¼</p>
<p>ç¬¬äºŒä¸ªé—®é¢˜æ˜¯ UTF-8 ç¼–ç çš„æºä»£ç ã€‚é™¤éä½ <code>use utf8</code>åœ¨æ¯ä¸ªæ–‡ä»¶çš„é¡¶éƒ¨å£°æ˜ï¼Œå¦åˆ™ Perl ä¸ä¼šå‡å®šä½ çš„æºä»£ç æ˜¯
UTF-8ã€‚è¿™æ„å‘³ç€æ¯æ¬¡ä½ è¯´ç±»ä¼¼çš„ä¸œè¥¿æ—¶<code>my $var = 'ã»ã’'</code>ï¼Œä½ éƒ½åœ¨å‘ä½ çš„ç¨‹åºä¸­æ³¨å…¥åƒåœ¾ï¼Œè¿™å°†å½»åº•ç ´åä¸€åˆ‡ã€‚æ‚¨ä¸å¿…â€œä½¿ç”¨
utf8â€ï¼Œä½†å¦‚æœæ‚¨ä¸è¿™æ ·åšï¼Œåˆ™ <em>ä¸å¾—</em> åœ¨æ‚¨çš„ç¨‹åºä¸­ä½¿ç”¨ä»»ä½•é ASCII å­—ç¬¦ã€‚</p>
<p>ç¬¬ä¸‰ä¸ªé—®é¢˜æ˜¯ Perl å¦‚ä½•å¤„ç† The Pastã€‚å¾ˆä¹…ä»¥å‰ï¼Œè¿˜æ²¡æœ‰ Unicode è¿™æ ·çš„ä¸œè¥¿ï¼ŒPerl å‡å®šä¸€åˆ‡éƒ½æ˜¯ Latin-1
æ–‡æœ¬æˆ–äºŒè¿›åˆ¶ã€‚å› æ­¤ï¼Œå½“æ•°æ®è¿›å…¥æ‚¨çš„ç¨‹åºå¹¶ä¸”æ‚¨å¼€å§‹å°†å…¶è§†ä¸ºæ–‡æœ¬æ—¶ï¼ŒPerl å°†æ¯ä¸ªå…«ä½å­—èŠ‚è§†ä¸º Latin-1
å­—ç¬¦ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå½“æˆ‘ä»¬è¯¢é—®â€œæ–‡å­—åŒ–ã‘â€çš„é•¿åº¦æ—¶ï¼Œå¾—åˆ°çš„æ˜¯ 12ã€‚Perl å‡è®¾æˆ‘ä»¬æ­£åœ¨æ“ä½œ Latin-1 å­—ç¬¦ä¸²â€œÃ¦Ã¥Ã¥Ã£â€ï¼ˆå®ƒæœ‰ 12
ä¸ªå­—ç¬¦ï¼Œå…¶ä¸­ä¸€äº›æ˜¯éæ‰“å°å­—ç¬¦ï¼‰ã€‚</p>
<p>è¿™ç§°ä¸ºâ€œéšå¼å‡çº§â€ï¼Œè¿™æ˜¯ä¸€ä»¶éå¸¸åˆç†çš„äº‹æƒ…ï¼Œä½†å¦‚æœæ‚¨çš„æ–‡æœ¬ä¸æ˜¯ Latin-1ï¼Œåˆ™è¿™ä¸æ˜¯æ‚¨æƒ³è¦çš„ã€‚è¿™å°±æ˜¯æ˜¾å¼è§£ç è¾“å…¥è‡³å…³é‡è¦çš„åŸå› ï¼šå¦‚æœä½ ä¸è¿™æ ·åšï¼ŒPerl
ä¼šè¿™æ ·åšï¼Œè€Œä¸”å®ƒå¯èƒ½ä¼šåšé”™ã€‚</p>
<p>äººä»¬ä¼šé‡åˆ°éº»çƒ¦ï¼Œå› ä¸ºä»–ä»¬çš„æ•°æ®ä¸€åŠæ˜¯æ­£ç¡®çš„å­—ç¬¦ä¸²ï¼Œè€Œæœ‰äº›ä»ç„¶æ˜¯äºŒè¿›åˆ¶çš„ã€‚Perl ä¼šå°†ä»ç„¶æ˜¯äºŒè¿›åˆ¶çš„éƒ¨åˆ†è§£é‡Šä¸º Latin-1
æ–‡æœ¬ï¼Œç„¶åå°†å…¶ä¸æ­£ç¡®çš„å­—ç¬¦æ•°æ®ç»„åˆèµ·æ¥ã€‚è¿™å°†ä½¿å®ƒçœ‹èµ·æ¥åƒæ­£ç¡®å¤„ç†ä½ çš„è§’è‰²ç ´åäº†ä½ çš„ç¨‹åºï¼Œä½†å®é™…ä¸Šï¼Œä½ åªæ˜¯æ²¡æœ‰è¶³å¤Ÿåœ°ä¿®å¤å®ƒã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼šæ‚¨æœ‰ä¸€ä¸ªè¯»å– UTF-8 ç¼–ç æ–‡æœ¬æ–‡ä»¶çš„ç¨‹åºï¼Œæ‚¨å°† Unicode æ·»åŠ <code>PILE OF POO</code>åˆ°æ¯ä¸€è¡Œï¼Œç„¶åå°†å…¶æ‰“å°å‡ºæ¥ã€‚ä½ è¿™æ ·å†™ï¼š</p>
<div class="code"><pre class="code literal-block"><span class="k">while</span><span class="ss">(</span><span class="o">&lt;&gt;</span><span class="ss">)</span>{
<span class="w">    </span><span class="nv">chomp</span><span class="c1">;</span>
<span class="w">    </span><span class="nv">say</span><span class="w"> </span><span class="s2">"$_ ğŸ’©"</span><span class="c1">;</span>
}
</pre></div>

<p>ç„¶ååœ¨ä¸€äº› UTF-8 ç¼–ç çš„æ•°æ®ä¸Šè¿è¡Œï¼Œæ¯”å¦‚ï¼š</p>
<div class="code"><pre class="code literal-block">perl poo.pl input-data.txt
</pre></div>

<p>å®ƒæ‰“å° UTF-8 æ•°æ®ï¼Œæ¯è¡Œæœ«å°¾éƒ½æœ‰ä¸€ä¸ª pooã€‚å®Œç¾ï¼Œæˆ‘çš„ç¨‹åºæœ‰æ•ˆï¼</p>
<p>ä½†æ˜¯ä¸ï¼Œä½ åªæ˜¯åœ¨åšäºŒè¿›åˆ¶è¿æ¥ã€‚æ‚¨æ­£åœ¨ä»æ–‡ä»¶ä¸­è¯»å–å…«ä½å­—èŠ‚ï¼Œåˆ é™¤<code>\n</code>å¸¦æœ‰ chomp çš„å­—ç¬¦ï¼Œç„¶åæ·»åŠ å­—ç¬¦çš„ UTF-8 è¡¨ç¤ºä¸­çš„å­—èŠ‚<code>PILE OF
POO</code>ã€‚å½“ä½ ä¿®æ”¹ä½ çš„ç¨‹åºæ¥è§£ç æ–‡ä»¶ä¸­çš„æ•°æ®å¹¶å¯¹è¾“å‡ºè¿›è¡Œç¼–ç æ—¶ï¼Œä½ ä¼šæ³¨æ„åˆ°ä½ å¾—åˆ°çš„æ˜¯åƒåœ¾ï¼ˆâ€œÃ°Â©â€ï¼‰è€Œä¸æ˜¯ä¾¿ä¾¿ã€‚è¿™ä¼šè®©æ‚¨ç›¸ä¿¡è§£ç è¾“å…¥æ–‡ä»¶æ˜¯é”™è¯¯çš„åšæ³•ã€‚å®ƒä¸æ˜¯ã€‚</p>
<p>é—®é¢˜æ˜¯ poo è¢«éšå¼å‡çº§ä¸º latin-1ã€‚å¦‚æœæ‚¨<code>use utf8</code>åˆ¶ä½œæ–‡å­—æ–‡æœ¬è€Œä¸æ˜¯äºŒè¿›åˆ¶æ–‡æœ¬ï¼Œé‚£ä¹ˆå®ƒå°†å†æ¬¡èµ·ä½œç”¨ï¼</p>
<p>ï¼ˆè¿™æ˜¯æˆ‘åœ¨ç”¨ Unicode
å¸®åŠ©äººä»¬æ—¶é‡åˆ°çš„ç¬¬ä¸€ä¸ªé—®é¢˜ã€‚ä»–ä»¬åšå¯¹äº†ä¸€éƒ¨åˆ†ï¼Œä½†é‚£ç ´åäº†ä»–ä»¬çš„ç¨‹åºã€‚è¿™å°±æ˜¯æœªå®šä¹‰ç»“æœçš„å¯æ‚²ä¹‹å¤„ï¼šä½ å¯ä»¥æœ‰ä¸€ä¸ªå¯ä»¥å·¥ä½œå¾ˆé•¿æ—¶é—´çš„ç¨‹åºï¼Œä½†æ˜¯å½“ä½ å¼€å§‹ä¿®å¤å®ƒæ—¶ï¼Œå®ƒä¸­æ–­äº†ã€‚åˆ«æ‹…å¿ƒï¼›å¦‚æœæ‚¨æ­£åœ¨å‘ç¨‹åºæ·»åŠ ç¼–ç /è§£ç è¯­å¥å¹¶ä¸”å®ƒä¸­æ–­äº†ï¼Œè¿™ä»…æ„å‘³ç€æ‚¨è¿˜æœ‰æ›´å¤šå·¥ä½œè¦åšã€‚ä¸‹æ¬¡ï¼Œå½“æ‚¨ä»ä¸€å¼€å§‹å°±è€ƒè™‘åˆ°
Unicode è¿›è¡Œè®¾è®¡æ—¶ï¼Œå®ƒå°†æ˜¯å®¹æ˜“å¤šäº†ï¼ï¼‰</p>
<p>è¿™å°±æ˜¯æ‚¨çœŸæ­£éœ€è¦äº†è§£çš„å…³äº Perl å’Œ Unicode çš„å…¨éƒ¨å†…å®¹ã€‚å¦‚æœä½ å‘Šè¯‰ Perl ä½ çš„æ•°æ®æ˜¯ä»€ä¹ˆï¼Œå®ƒåœ¨æ‰€æœ‰æµè¡Œçš„ç¼–ç¨‹è¯­è¨€ä¸­æ‹¥æœ‰æœ€å¥½çš„
Unicode æ”¯æŒã€‚ä½†æ˜¯ï¼Œå¦‚æœæ‚¨å‡è®¾å®ƒä¼šç¥å¥‡åœ°çŸ¥é“æ‚¨è¾“å…¥çš„æ˜¯å“ªç§æ–‡æœ¬ï¼Œé‚£ä¹ˆæ‚¨å°†æ— æ³•æŒ½å›åœ°ä¸¢å¼ƒæ‚¨çš„æ•°æ®ã€‚ä»…ä»…å› ä¸ºä½ çš„ç¨‹åºä»Šå¤©åœ¨ä½ çš„ UTF-8
ç»ˆç«¯ä¸Šè¿è¡Œå¹¶ä¸æ„å‘³ç€å®ƒæ˜å¤©å°±èƒ½åœ¨ UTF-16 ç¼–ç çš„æ–‡ä»¶ä¸Šè¿è¡Œã€‚å› æ­¤ï¼Œç°åœ¨å°±ç¡®ä¿å®ƒçš„å®‰å…¨ï¼Œè®©æ‚¨å…äºå› ç ´åç”¨æˆ·æ•°æ®è€Œå¤´ç–¼ï¼</p>
<p>å¤„ç† Unicode æœ€ç®€å•çš„éƒ¨åˆ†æ˜¯ç¼–ç è¾“å‡ºå’Œè§£ç è¾“å…¥ã€‚å›°éš¾çš„éƒ¨åˆ†æ˜¯æ‰¾åˆ°æ‰€æœ‰çš„è¾“å…¥å’Œè¾“å‡ºï¼Œå¹¶ç¡®å®šå®ƒæ˜¯å“ªç§ç¼–ç ã€‚ä½†è¿™å°±æ˜¯ä½ èµšå¤§é’±çš„åŸå› :)</p>
<p><br><br><a href="../why-does-modern-perl-avoid-utf-8-by-default/">æŸ¥çœ‹åŸæ–‡</a></p>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/perl/" rel="tag">perl</a></li>
            <li><a class="tag p-category" href="../../categories/unicode/" rel="tag">unicode</a></li>
            <li><a class="tag p-category" href="../../categories/utf-8/" rel="tag">utf-8</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../c-ru-he-chuang-jian-yi-ge-guidzhi/" rel="prev" title="C#å¦‚ä½•åˆ›å»ºä¸€ä¸ªGuidå€¼ï¼Ÿ">Previous post</a>
            </li>
            <li class="next">
                <a href="../ru-he-zai-powershell-zhong-chu-li-ming-ling-xing-can-shu/" rel="next" title="å¦‚ä½•åœ¨ PowerShell ä¸­å¤„ç†å‘½ä»¤è¡Œå‚æ•°">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents Â© 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="../../assets/js/search.js"></script>
</body>
</html>
