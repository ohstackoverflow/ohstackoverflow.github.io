<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>How can I merge two commits into one if I already started rebase? | StackOverflow Snapshot</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/posts/how-can-i-merge-two-commits-into-one-if-i-already-started-rebase/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Arya">
<link rel="prev" href="../running-shell-command-and-capturing-the-output/" title="Running shell command and capturing the output" type="text/html">
<link rel="next" href="../github-relative-link-in-markdown-file/" title="GitHub relative link in Markdown file" type="text/html">
<meta property="og:site_name" content="StackOverflow Snapshot">
<meta property="og:title" content="How can I merge two commits into one if I already started rebase?">
<meta property="og:url" content="https://ohstackoverflow.netlify.app/posts/how-can-i-merge-two-commits-into-one-if-i-already-started-rebase/">
<meta property="og:description" content="I am trying to merge 2 commits into 1, so I followed “squashing commits with
rebase” from git ready.
I ran
git rebase --interactive HEAD~2


In the resulting editor, I change pick to squash and then s">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-02-17T03:18:38+08:00">
<meta property="article:tag" content="git">
<meta property="article:tag" content="git-merge">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">How can I merge two commits into one if I already started rebase?</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T03:18:38+08:00" itemprop="datePublished" title="2023-02-17 03:18">2023-02-17 03:18</time></a>
            </p>
            

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>I am trying to merge 2 commits into 1, so I followed “squashing commits with
rebase” from git ready.</p>
<p>I ran</p>
<div class="code"><pre class="code literal-block">git rebase --interactive HEAD~2
</pre></div>

<p>In the resulting editor, I change <code>pick</code> to <code>squash</code> and then save-quit, but
the rebase fails with the error</p>
<blockquote>
<p>Cannot 'squash' without a previous commit</p>
</blockquote>
<p>Now that my work tree has reached this state, I’m having trouble recovering.</p>
<p>The command <code>git rebase --interactive HEAD~2</code> fails with:</p>
<blockquote>
<p>Interactive rebase already started</p>
</blockquote>
<p>and <code>git rebase --continue</code> fails with</p>
<blockquote>
<p>Cannot 'squash' without a previous commit</p>
</blockquote>
<p><br><br></p>
<h2>Answer</h2>
<h4>Summary</h4>
<p>The error message</p>
<blockquote>
<p>Cannot 'squash' without a previous commit</p>
</blockquote>
<p>means you likely attempted to “squash downward.” <strong>Git always squashes a newer
commit into an older commit</strong> or “upward” as viewed on the interactive rebase
todo list, that is into a commit on a previous line. Changing the command on
your todo list’s very first line to <code>squash</code> will always produce this error as
there is nothing for the first commit to squash into.</p>
<h4>The Fix</h4>
<p>First get back to where you started with</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span>git<span class="w"> </span>rebase<span class="w"> </span>--abort
</pre></div>

<p>Say your history is</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span>git<span class="w"> </span>log<span class="w"> </span>--pretty<span class="o">=</span>oneline
a931ac7c808e2471b22b5bd20f0cad046b1c5d0d<span class="w"> </span>c
b76d157d507e819d7511132bdb5a80dd421d854f<span class="w"> </span>b
df239176e1a2ffac927d8b496ea00d5488481db5<span class="w"> </span>a
</pre></div>

<p>That is, a was the first commit, then b, and finally c. After committing c we
decide to squash b and c together:</p>
<p><em>(Note: Running<code>git log</code> pipes its output into a pager, <code>less</code> by default on
most platforms. To quit the pager and return to your command prompt, press the
<code>q</code> key.)</em></p>
<p>Running <code>git rebase --interactive HEAD~2</code> gives you an editor with</p>
<div class="code"><pre class="code literal-block"><span class="nv">pick</span><span class="w"> </span><span class="nv">b76d157</span><span class="w"> </span><span class="nv">b</span>
<span class="nv">pick</span><span class="w"> </span><span class="nv">a931ac7</span><span class="w"> </span><span class="nv">c</span>

#<span class="w"> </span><span class="nv">Rebase</span><span class="w"> </span><span class="nv">df23917</span>..<span class="nv">a931ac7</span><span class="w"> </span><span class="nv">onto</span><span class="w"> </span><span class="nv">df23917</span>
#
#<span class="w"> </span><span class="nv">Commands</span>:
#<span class="w">  </span><span class="nv">p</span>,<span class="w"> </span><span class="nv">pick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">use</span><span class="w"> </span><span class="nv">commit</span>
#<span class="w">  </span><span class="nv">r</span>,<span class="w"> </span><span class="nv">reword</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">use</span><span class="w"> </span><span class="nv">commit</span>,<span class="w"> </span><span class="nv">but</span><span class="w"> </span><span class="nv">edit</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">commit</span><span class="w"> </span><span class="nv">message</span>
#<span class="w">  </span><span class="nv">e</span>,<span class="w"> </span><span class="nv">edit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">use</span><span class="w"> </span><span class="nv">commit</span>,<span class="w"> </span><span class="nv">but</span><span class="w"> </span><span class="nv">stop</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">amending</span>
#<span class="w">  </span><span class="nv">s</span>,<span class="w"> </span><span class="nv">squash</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">use</span><span class="w"> </span><span class="nv">commit</span>,<span class="w"> </span><span class="nv">but</span><span class="w"> </span><span class="nv">meld</span><span class="w"> </span><span class="nv">into</span><span class="w"> </span><span class="nv">previous</span><span class="w"> </span><span class="nv">commit</span>
#<span class="w">  </span><span class="nv">f</span>,<span class="w"> </span><span class="nv">fixup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">like</span><span class="w"> </span><span class="s2">"squash"</span>,<span class="w"> </span><span class="nv">but</span><span class="w"> </span><span class="nv">discard</span><span class="w"> </span><span class="nv">this</span><span class="w"> </span><span class="nv">commit</span><span class="err">'s log message</span>
<span class="err">#</span>
<span class="err"># If you remove a line here THAT COMMIT WILL BE LOST.</span>
<span class="err"># However, if you remove everything, the rebase will be aborted.</span>
<span class="err">#</span>
</pre></div>

<p>(Notice that this todo list is in the reverse order as compared with the
output of <code>git log</code>.)</p>
<p>Changing b’s <code>pick</code> to <code>squash</code> will result in the error you saw, but if
instead you squash c into b (newer commit into the older or “squashing
upward”) by changing the todo list to</p>
<div class="code"><pre class="code literal-block">pick   b76d157 b
squash a931ac7 c
</pre></div>

<p>and save-quitting your editor, you'll get another editor whose contents are</p>
<div class="code"><pre class="code literal-block"># This is a combination of 2 commits.
# The first commit's message is:

b

# This is the 2nd commit message:

c
</pre></div>

<p>When you save and quit, the contents of the edited file become commit message
of the new combined commit:</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span>git<span class="w"> </span>log<span class="w"> </span>--pretty<span class="o">=</span>oneline
18fd73d3ce748f2a58d1b566c03dd9dafe0b6b4f<span class="w"> </span>b<span class="w"> </span>and<span class="w"> </span>c
df239176e1a2ffac927d8b496ea00d5488481db5<span class="w"> </span>a
</pre></div>

<h4>Note About Rewriting History</h4>
<p>Interactive rebase rewrites history. Attempting to push to a remote that
contains the old history will fail because it is not a fast-forward.</p>
<p>If the branch you rebased is a topic or feature branch <em>in which you are
working by yourself</em> , no big deal. Pushing to another repository will require
the <code>--force</code> option, or alternatively you may be able, depending on the
remote repository’s permissions, to first delete the old branch and then push
the rebased version. Examples of those commands that will potentially destroy
work is outside the scope of this answer.</p>
<p>Rewriting already-published history on a branch in which you are working with
other people without <em>very</em> good reason such as leaking a password or other
sensitive details forces work onto your collaborators and is antisocial and
will annoy other developers. The “Recovering From an Upstream Rebase” section
in the <code>git rebase</code> documentation explains, with added emphasis.</p>
<blockquote>
<p>Rebasing (or any other form of rewriting) a branch that others have based
work on is a bad idea: anyone downstream of it is forced to manually fix
their history. This section explains how to do the fix from the downstream’s
point of view. <strong>The real fix, however, would be to avoid rebasing the
upstream in the first place.</strong> …</p>
</blockquote>
<p><br></p>
<h3>Suggest</h3>
<p>If there are multiple commits, you can use <code>git rebase -i</code> to squash two
commits into one.</p>
<p>If there are only two commits you want to merge, and they are the "most recent
two", the following commands can be used to combine the two commits into one:</p>
<div class="code"><pre class="code literal-block">git reset --soft "HEAD^"
git commit --amend
</pre></div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/git/" rel="tag">git</a></li>
            <li><a class="tag p-category" href="../../categories/git-merge/" rel="tag">git-merge</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../running-shell-command-and-capturing-the-output/" rel="prev" title="Running shell command and capturing the output">Previous post</a>
            </li>
            <li class="next">
                <a href="../github-relative-link-in-markdown-file/" rel="next" title="GitHub relative link in Markdown file">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="../../assets/js/search.js"></script>
</body>
</html>
