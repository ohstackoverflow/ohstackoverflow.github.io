<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Access Control Request Headers, is added to header in AJAX request with jQuery | StackOverflow Snapshot</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/posts/access-control-request-headers-is-added-to-header-in-ajax-request-with-jquery/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Arya">
<link rel="prev" href="../add-new-field-to-every-document-in-a-mongodb-collection/" title="Add new field to every document in a MongoDB collection" type="text/html">
<link rel="next" href="../how-to-override-trait-function-and-call-it-from-the-overridden-function/" title="How to override trait function and call it from the overridden function?" type="text/html">
<meta property="og:site_name" content="StackOverflow Snapshot">
<meta property="og:title" content="Access Control Request Headers, is added to header in AJAX request wit">
<meta property="og:url" content="https://ohstackoverflow.netlify.app/posts/access-control-request-headers-is-added-to-header-in-ajax-request-with-jquery/">
<meta property="og:description" content="I would like to add a custom header to an AJAX POST request from jQuery.
I have tried this:
$.ajax({
    type: 'POST',
    url: url,
    headers: {
        &quot;My-First-Header&quot;:&quot;first value&quot;,
        &quot;My">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-03-03T11:35:34+08:00">
<meta property="article:tag" content="ajax">
<meta property="article:tag" content="http-headers">
<meta property="article:tag" content="javascript">
<meta property="article:tag" content="jquery">
<meta property="article:tag" content="post">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Access Control Request Headers, is added to header in AJAX request with jQuery</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T11:35:34+08:00" itemprop="datePublished" title="2023-03-03 11:35">2023-03-03 11:35</time></a>
            </p>
            

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>I would like to add a custom header to an AJAX POST request from jQuery.</p>
<p>I have tried this:</p>
<div class="code"><pre class="code literal-block"><span class="o">$</span><span class="p">.</span><span class="nc">ajax</span><span class="o">(</span><span class="p">{</span>
<span class="w">    </span><span class="n">type</span><span class="p">:</span><span class="w"> </span><span class="s1">'POST'</span><span class="p">,</span>
<span class="w">    </span><span class="n">url</span><span class="o">:</span><span class="w"> </span><span class="n">url</span><span class="p">,</span>
<span class="w">    </span><span class="n">headers</span><span class="o">:</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="s2">"My-First-Header"</span><span class="o">:</span><span class="s2">"first value"</span><span class="p">,</span>
<span class="w">        </span><span class="s2">"My-Second-Header"</span><span class="o">:</span><span class="s2">"second value"</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="o">//</span><span class="nt">OR</span>
<span class="w">    </span><span class="o">//</span><span class="nt">beforeSend</span><span class="o">:</span><span class="w"> </span><span class="nt">function</span><span class="o">(</span><span class="nt">xhr</span><span class="o">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="w">    </span><span class="err">//</span><span class="w">  </span><span class="err">xhr.setRequestHeader("My-First-Header",</span><span class="w"> </span><span class="err">"first</span><span class="w"> </span><span class="err">value")</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="err">//</span><span class="w">  </span><span class="err">xhr.setRequestHeader("My-Second-Header",</span><span class="w"> </span><span class="err">"second</span><span class="w"> </span><span class="err">value")</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="err">//</span><span class="p">}</span>
<span class="err">}</span><span class="o">)</span><span class="p">.</span><span class="nc">done</span><span class="o">(</span><span class="nt">function</span><span class="o">(</span><span class="nt">data</span><span class="o">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="w">    </span><span class="err">alert(data)</span><span class="p">;</span>
<span class="p">}</span><span class="o">);</span>
</pre></div>

<p>When I send this request and I watch with FireBug, I see this header:</p>
<blockquote>
<p>OPTIONS xxxx/yyyy HTTP/1.1<br>
 Host: 127.0.0.1:6666<br>
 User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:11.0) Gecko/20100101
Firefox/11.0<br>
 Accept: text/html,application/xhtml+xml,application/xml;q=0.9, <em>/</em> ;q=0.8<br>
 Accept-Language: fr,fr-fr;q=0.8,en-us;q=0.5,en;q=0.3<br>
 Accept-Encoding: gzip, deflate<br>
 Connection: keep-alive<br>
 Origin: null<br>
 Access-Control-Request-Method: POST<br><strong>Access-Control-Request-Headers: my-first-header,my-second-header</strong><br>
 Pragma: no-cache<br>
 Cache-Control: no-cache<br></p>
</blockquote>
<p>Why do my custom headers go to <code>Access-Control-Request-Headers</code>:</p>
<blockquote>
<p>Access-Control-Request-Headers: my-first-header,my-second-header</p>
</blockquote>
<p>I was expecting a header values like this:</p>
<blockquote>
<p>My-First-Header: first value<br>
 My-Second-Header: second value</p>
</blockquote>
<p>Is it possible?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>What you saw in Firefox was not the actual request; note that the HTTP method
is OPTIONS, not POST. It was actually the 'pre-flight' request that the
browser makes to determine whether a cross-domain AJAX request should be
allowed:</p>
<p>http://www.w3.org/TR/cors/</p>
<p>The Access-Control-Request-Headers header in the pre-flight request includes
the list of headers in the actual request. The server is then expected to
report back whether these headers are supported in this context or not, before
the browser submits the actual request.</p>
<p><br></p>
<h3>Suggest</h3>
<p>This code below works for me. I always use only single quotes, and it works
fine. I suggest you should use only single quotes <em>or</em> only double quotes, but
not mixed up.</p>
<div class="code"><pre class="code literal-block"><span class="o">$</span><span class="p">.</span><span class="nc">ajax</span><span class="o">(</span><span class="p">{</span>
<span class="w">    </span><span class="n">url</span><span class="p">:</span><span class="w"> </span><span class="s1">'YourRestEndPoint'</span><span class="p">,</span>
<span class="w">    </span><span class="n">headers</span><span class="o">:</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="s1">'Authorization'</span><span class="o">:</span><span class="s1">'Basic xxxxxxxxxxxxx'</span><span class="p">,</span>
<span class="w">        </span><span class="s1">'X-CSRF-TOKEN'</span><span class="o">:</span><span class="s1">'xxxxxxxxxxxxxxxxxxxx'</span><span class="p">,</span>
<span class="w">        </span><span class="s1">'Content-Type'</span><span class="o">:</span><span class="s1">'application/json'</span>
<span class="w">    </span><span class="p">}</span><span class="o">,</span>
<span class="w">    </span><span class="nt">method</span><span class="o">:</span><span class="w"> </span><span class="s1">'POST'</span><span class="o">,</span>
<span class="w">    </span><span class="nt">dataType</span><span class="o">:</span><span class="w"> </span><span class="s1">'json'</span><span class="o">,</span>
<span class="w">    </span><span class="nt">data</span><span class="o">:</span><span class="w"> </span><span class="nt">YourData</span><span class="o">,</span>
<span class="w">    </span><span class="nt">success</span><span class="o">:</span><span class="w"> </span><span class="nt">function</span><span class="o">(</span><span class="nt">data</span><span class="o">)</span><span class="p">{</span>
<span class="w">      </span><span class="err">console.log('</span><span class="n">succes</span><span class="p">:</span><span class="w"> </span><span class="err">'</span><span class="o">+</span><span class="n">data</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="err">}</span><span class="o">);</span>
</pre></div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/ajax/" rel="tag">ajax</a></li>
            <li><a class="tag p-category" href="../../categories/http-headers/" rel="tag">http-headers</a></li>
            <li><a class="tag p-category" href="../../categories/javascript/" rel="tag">javascript</a></li>
            <li><a class="tag p-category" href="../../categories/jquery/" rel="tag">jquery</a></li>
            <li><a class="tag p-category" href="../../categories/post/" rel="tag">post</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../add-new-field-to-every-document-in-a-mongodb-collection/" rel="prev" title="Add new field to every document in a MongoDB collection">Previous post</a>
            </li>
            <li class="next">
                <a href="../how-to-override-trait-function-and-call-it-from-the-overridden-function/" rel="next" title="How to override trait function and call it from the overridden function?">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="../../assets/js/search.js"></script>
</body>
</html>
