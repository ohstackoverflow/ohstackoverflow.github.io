<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>我如何在 AngularJS 中使用 $scope.$watch 和 $scope.$apply？ | StackOverflow Snapshot</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/posts/wo-ru-he-zai-angularjs-zhong-shi-yong-scope-watch-he-scope-apply/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Arya">
<link rel="prev" href="../can-shu-hua-sql-in-zi-ju/" title="参数化 SQL IN 子句" type="text/html">
<link rel="next" href="../java-zhong-de-jing-tai-lei/" title="Java 中的静态类" type="text/html">
<meta property="og:site_name" content="StackOverflow Snapshot">
<meta property="og:title" content="我如何在 AngularJS 中使用 $scope.$watch 和 $scope.$apply？">
<meta property="og:url" content="https://ohstackoverflow.netlify.app/posts/wo-ru-he-zai-angularjs-zhong-shi-yong-scope-watch-he-scope-apply/">
<meta property="og:description" content="我不明白如何使用$scope.$watchand $scope.$apply。官方文档没有帮助。
我不明白的具体内容：

它们是否连接到 DOM？
如何更新模型的 DOM 更改？
它们之间的连接点是什么？

我试过这个教程，但它需要理解$watch和$apply理所当然。
做什么$apply和$watch做什么，我如何适当地使用它们？

解答
您需要了解 AngularJS 的工作原理才能理解它。">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-02-17T05:34:07+08:00">
<meta property="article:tag" content="angularjs">
<meta property="article:tag" content="angularjs-scope">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">我如何在 AngularJS 中使用 $scope.$watch 和 $scope.$apply？</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T05:34:07+08:00" itemprop="datePublished" title="2023-02-17 05:34">2023-02-17 05:34</time></a>
            </p>
            

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>我不明白如何使用<code>$scope.$watch</code>and <code>$scope.$apply</code>。官方文档没有帮助。</p>
<p>我不明白的具体内容：</p>
<ul>
<li>它们是否连接到 DOM？</li>
<li>如何更新模型的 DOM 更改？</li>
<li>它们之间的连接点是什么？</li>
</ul>
<p>我试过这个教程，但它需要理解<code>$watch</code>和<code>$apply</code>理所当然。</p>
<p>做什么<code>$apply</code>和<code>$watch</code>做什么，我如何适当地使用它们？</p>
<p><br><br></p>
<h2>解答</h2>
<p>您需要了解 AngularJS 的工作原理才能理解它。</p>
<h3>摘要循环和 $scope</h3>
<p>首先，AngularJS 定义了所谓的 <strong>摘要循环</strong> 的概念。这个循环可以被认为是一个循环，在此期间 AngularJS 检查所有s <strong>监视</strong>
的所有变量是否有任何变化<code>$scope</code>。所以如果你已经<code>$scope.myVar</code>在你的控制器中定义并且这个变量被
<strong>标记为被监视</strong><code>myVar</code>，那么你就隐式地告诉 AngularJS 监视循环的每次迭代中的变化。</p>
<p>一个自然而然的后续问题是：是否一切都与<code>$scope</code>被观看有关？幸运的是，没有。如果您要观察
中每个对象的变化<code>$scope</code>，那么摘要循环很快就会花费很长时间来评估，您很快就会遇到性能问题。这就是为什么 AngularJS
团队给了我们两种方法来声明一些<code>$scope</code>变量被监视（见下文）。</p>
<h3>$watch 有助于监听 $scope 变化</h3>
<p>有两种方法可以将<code>$scope</code>变量声明为被监视。</p>
<ol>
<li>通过表达式在模板中使用它<code>&lt;span&gt;{{myVar}}&lt;/span&gt;</code>
</li>
<li>
<code>$watch</code>通过服务手动添加</li>
</ol>
<p>广告 1) 这是最常见的场景，我相信你以前见过它，但你不知道这在后台创建了一个手表。是的，它有！使用 AngularJS 指令（例如<code>ng-
repeat</code>）也可以创建隐式监视。</p>
<p>Ad 2) 这就是您制作自己的 <strong>手表的</strong> 方式。<code>$watch</code>service 可以帮助您在附加到
的某些值发生变化时运行某些代码<code>$scope</code>。它很少使用，但有时很有用。例如，如果您想在每次“myVar”更改时运行一些代码，您可以执行以下操作：</p>
<div class="code"><pre class="code literal-block">function MyController($scope) {

    $scope.myVar = 1;

    $scope.$watch('myVar', function() {
        alert('hey, myVar has changed!');
    });

    $scope.buttonClicked = function() {
        $scope.myVar = 2; // This will trigger $watch expression to kick in
    };
}
</pre></div>

<h3>$apply 能够将更改与摘要周期集成</h3>
<p>您可以将此 <strong><code>$apply</code> 功能视为一种集成机制</strong>。你看，每次你改变一些直接 <strong>附加到<code>$scope</code></strong>对象的观察变量时，AngularJS
就会知道改变已经发生。这是因为 AngularJS 已经知道要监视这些更改。因此，如果它发生在框架管理的代码中，摘要循环将继续进行。</p>
<p>然而，有时你想 <strong>在 AngularJS 世界之外更改一些值</strong> 并看到更改正常传播。考虑一下——您有一个<code>$scope.myVar</code>值将在 jQuery
的<code>$.ajax()</code>处理程序中被修改。这将在未来的某个时候发生。AngularJS 不能等待这种情况发生，因为它没有被指示等待 jQuery。</p>
<p>为了解决这个问题，<code>$apply</code>已经引入。它可以让你明确地开始消化周期。但是，您应该只使用它来将一些数据迁移到
AngularJS（与其他框架集成），而不要将此方法与常规 AngularJS 代码结合使用，因为那样 AngularJS 会抛出错误。</p>
<h3>所有这些与 DOM 有什么关系？</h3>
<p>好吧，既然您已经了解了所有这些，那么您真的应该再次按照本教程进行操作。摘要循环将确保 UI 和 JavaScript
代码保持同步，<code>$scope</code>只要没有任何变化，它就会评估附加到所有 s 的每个观察者。如果摘要循环中不再发生更改，则认为它已完成。</p>
<p>您可以<code>$scope</code>在控制器中显式地将对象附加到对象，也可以<code>{{expression}}</code>直接在视图中通过在表单中​​声明它们来附加对象。</p>
<p>扩展阅读：</p>
<ul>
<li><em>制作你自己的 AngularJS，第 1 部分：作用域和摘要</em></li>
</ul>
<p><br></p>
<h3>更多建议</h3>
<p>在 AngularJS 中，我们更新我们的模型，我们的视图/模板“自动”更新 DOM（通过内置或自定义指令）。</p>
<p>$apply 和 $watch 都是 Scope 方法，与 DOM 无关。</p>
<p>概念页面（“运行时”部分）对 $digest 循环、 $apply、$evalAsync 队列和 $watch 列表有很好的解释。这是文字附带的图片：</p>
<p><img alt="$摘要循环" src="../../images/O1iSG.png"></p>
<p>无论什么代码可以访问范围——通常是控制器和指令（它们的链接函数和/或它们的控制器）——都可以设置一个“ watchExpression
”，AngularJS 将根据该范围进行评估。只要 AngularJS 进入它的 $digest 循环（特别是“$watch
list”循环），就会发生这种评估。您可以查看单个范围属性，可以定义一个函数来同时查看两个属性，可以查看数组的长度等。</p>
<p>当事情发生在“AngularJS 内部”——例如，你输入一个启用了 AngularJS 双向数据绑定的文本框（即，使用 ng-model），$http
回调触发，等等——$apply 已经被调用，所以我们在上图中的“AngularJS”矩形内。所有 watchExpressions
都将被评估（可能不止一次——直到没有检测到进一步的变化）。</p>
<p>当事情发生在“AngularJS 之外”——例如，你在一个指令中使用了 bind() 然后那个事件触发，导致你的回调被调用，或者一些 jQuery
注册的回调触发——我们仍然在“本机”矩形中。如果回调代码修改了任何 $watch 正在监视的任何内容，调用 $apply 进入 AngularJS
矩形，导致 $digest 循环运行，因此 AngularJS 将注意到更改并发挥其魔力。</p>
<p><br><br><a href="../how-do-i-use-scope-watch-and-scope-apply-in-angularjs/">查看原文</a></p>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/angularjs/" rel="tag">angularjs</a></li>
            <li><a class="tag p-category" href="../../categories/angularjs-scope/" rel="tag">angularjs-scope</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../can-shu-hua-sql-in-zi-ju/" rel="prev" title="参数化 SQL IN 子句">Previous post</a>
            </li>
            <li class="next">
                <a href="../java-zhong-de-jing-tai-lei/" rel="next" title="Java 中的静态类">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="../../assets/js/search.js"></script>
</body>
</html>
