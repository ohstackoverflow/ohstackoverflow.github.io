<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>What is the difference between Promises and Observables? | StackOverflow Snapshot</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/posts/what-is-the-difference-between-promises-and-observables/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Arya">
<link rel="prev" href="../can-i-delete-a-git-commit-but-keep-the-changes/" title="Can I delete a git commit but keep the changes?" type="text/html">
<link rel="next" href="../open-files-always-in-a-new-tab/" title="Open files always in a new tab" type="text/html">
<meta property="og:site_name" content="StackOverflow Snapshot">
<meta property="og:title" content="What is the difference between Promises and Observables?">
<meta property="og:url" content="https://ohstackoverflow.netlify.app/posts/what-is-the-difference-between-promises-and-observables/">
<meta property="og:description" content="What is the difference between Promise and Observable in Angular?
An example on each would be helpful in understanding both the cases. In what
scenario can we use each case?

Answer
Promise
A Promise ">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-02-17T00:07:09+08:00">
<meta property="article:tag" content="angular">
<meta property="article:tag" content="angular-observable">
<meta property="article:tag" content="angular-promise">
<meta property="article:tag" content="promise">
<meta property="article:tag" content="rxjs">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">What is the difference between Promises and Observables?</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T00:07:09+08:00" itemprop="datePublished" title="2023-02-17 00:07">2023-02-17 00:07</time></a>
            </p>
            

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>What is the difference between <code>Promise</code> and <code>Observable</code> in Angular?</p>
<p>An example on each would be helpful in understanding both the cases. In what
scenario can we use each case?</p>
<p><br><br></p>
<h2>Answer</h2>
<p><strong>Promise</strong></p>
<p>A <code>Promise</code> handles a <strong>single event</strong> when an async operation completes or
fails.</p>
<p>Note: There are <code>Promise</code> libraries out there that support cancellation, but
ES6 <code>Promise</code> doesn't so far.</p>
<p><strong>Observable</strong></p>
<p>An <code>Observable</code> is like a <strong><code>Stream</code></strong> (in many languages) and allows to pass
zero or more events where the callback is called for each event.</p>
<p>Often <code>Observable</code> is preferred over <code>Promise</code> because it provides the
features of <code>Promise</code> and more. With <code>Observable</code> it doesn't matter if you
want to handle 0, 1, or multiple events. You can utilize the same API in each
case.</p>
<p><code>Observable</code> also has the advantage over <code>Promise</code> to be <strong>cancellable</strong>. If
the result of an HTTP request to a server or some other expensive async
operation isn't needed anymore, the <code>Subscription</code> of an <code>Observable</code> allows
to cancel the subscription, while a <code>Promise</code> will eventually call the success
or failed callback even when you don't need the notification or the result it
provides anymore.</p>
<p>While a <code>Promise</code> starts immediately, an <code>Observable</code> only starts if you
subscribe to it. This is why Observables are called lazy.</p>
<p>Observable provides <strong>operators</strong> like <code>map</code>, <code>forEach</code>, <code>reduce</code>, ... similar
to an array</p>
<p>There are also powerful operators like <code>retry()</code>, or <code>replay()</code>, ... that are
often quite handy. A list of operators shipped with rxjs</p>
<p>Lazy execution allows to build up a chain of operators before the observable
is executed by subscribing, to do a more declarative kind of programming.</p>
<p><br></p>
<h3>Suggest</h3>
<p>Both <code>Promises</code> and <code>Observables</code> provide us with abstractions that help us
deal with the <strong>asynchronous</strong> nature of our applications. The difference
between them was pointed out clearly by Günter and @Relu.</p>
<p>Since a code snippet is worth a thousand words, let’s go through the below
example to understand them easier.</p>
<blockquote>
<p>Thanks @Christoph Burgdorf for the awesome article</p>
</blockquote>
<hr>
<p>Angular uses Rx.js Observables instead of promises for dealing with HTTP.</p>
<p>Suppose that you are building a <strong>search function</strong> that should instantly show
you results as you type. It sounds familiar, but there are a lot of challenges
that come with that task.</p>
<ul>
<li>We don't want to hit the server endpoint every time user presses a key. It should flood them with a storm of HTTP requests. Basically, we only want to hit it once the user has stopped typing instead of with every keystroke.</li>
<li>Don’t hit the search endpoint with the <strong>same query parameters</strong> for subsequent requests.</li>
<li>Deal with out-of-order responses. When we have multiple requests in-flight at the same time we must account for cases where they come back in unexpected order. Imagine we first type <strong>computer</strong> , stop, a request goes out, we type <strong>car</strong> , stop, a request goes out. Now we have two requests in-flight. Unfortunately, the request that carries the results for <strong>computer</strong> comes back after the request that carries the results for <strong>car</strong>.</li>
</ul>
<p>The demo will simply consist of two files: <code>app.ts</code> and <code>wikipedia-
service.ts</code>. In a real world scenario, we would most likely split things
further up, though.</p>
<hr>
<p>Below is a <strong>Promise-based</strong> implementation that doesn’t handle any of the
described edge cases.</p>
<p><code>wikipedia-service.ts</code></p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="p">{</span> <span class="n">Injectable</span> <span class="p">}</span> <span class="kn">from</span> <span class="s1">'@angular/core'</span><span class="p">;</span>
<span class="kn">import</span> <span class="p">{</span> <span class="n">URLSearchParams</span><span class="p">,</span> <span class="n">Jsonp</span> <span class="p">}</span> <span class="kn">from</span> <span class="s1">'@angular/http'</span><span class="p">;</span>

<span class="nd">@Injectable</span><span class="p">()</span>
<span class="n">export</span> <span class="k">class</span> <span class="nc">WikipediaService</span> <span class="p">{</span>
  <span class="n">constructor</span><span class="p">(</span><span class="n">private</span> <span class="n">jsonp</span><span class="p">:</span> <span class="n">Jsonp</span><span class="p">)</span> <span class="p">{}</span>

  <span class="n">search</span> <span class="p">(</span><span class="n">term</span><span class="p">:</span> <span class="n">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">var</span> <span class="n">search</span> <span class="o">=</span> <span class="n">new</span> <span class="n">URLSearchParams</span><span class="p">()</span>
    <span class="n">search</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">'action'</span><span class="p">,</span> <span class="s1">'opensearch'</span><span class="p">);</span>
    <span class="n">search</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">'search'</span><span class="p">,</span> <span class="n">term</span><span class="p">);</span>
    <span class="n">search</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">'format'</span><span class="p">,</span> <span class="s1">'json'</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">this</span><span class="o">.</span><span class="n">jsonp</span>
                <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'http://en.wikipedia.org/w/api.php?callback=JSONP_CALLBACK'</span><span class="p">,</span> <span class="p">{</span> <span class="n">search</span> <span class="p">})</span>
                <span class="o">.</span><span class="n">toPromise</span><span class="p">()</span>
                <span class="o">.</span><span class="n">then</span><span class="p">((</span><span class="n">response</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="mi">1</span><span class="p">]);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p>We are injecting the <code>Jsonp</code> service to make a GET request against the
<strong>Wikipedia API</strong> with a given search term. Notice that we call <code>toPromise</code> in
order to get from an <code>Observable&lt;Response&gt;</code> to a <code>Promise&lt;Response&gt;</code>.
Eventually end up with a <code>Promise&lt;Array&lt;string&gt;&gt;</code> as the return type of our
search method.</p>
<p><code>app.ts</code></p>
<div class="code"><pre class="code literal-block"><span class="o">//</span> <span class="n">check</span> <span class="n">the</span> <span class="n">plnkr</span> <span class="k">for</span> <span class="n">the</span> <span class="n">full</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">imports</span>
<span class="kn">import</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span> <span class="kn">from</span> <span class="s1">'...'</span><span class="p">;</span>

<span class="nd">@Component</span><span class="p">({</span>
  <span class="n">selector</span><span class="p">:</span> <span class="s1">'my-app'</span><span class="p">,</span>
  <span class="n">template</span><span class="p">:</span> <span class="err">`</span>
    <span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">h2</span><span class="o">&gt;</span><span class="n">Wikipedia</span> <span class="n">Search</span><span class="o">&lt;/</span><span class="n">h2</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="nb">input</span> <span class="c1">#term type="text" (keyup)="search(term.value)"&gt;</span>
      <span class="o">&lt;</span><span class="n">ul</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">li</span> <span class="o">*</span><span class="n">ngFor</span><span class="o">=</span><span class="s2">"let item of items"</span><span class="o">&gt;</span><span class="p">{{</span><span class="n">item</span><span class="p">}}</span><span class="o">&lt;/</span><span class="n">li</span><span class="o">&gt;</span>
      <span class="o">&lt;/</span><span class="n">ul</span><span class="o">&gt;</span>
    <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
  <span class="err">`</span>
<span class="p">})</span>
<span class="n">export</span> <span class="k">class</span> <span class="nc">AppComponent</span> <span class="p">{</span>
  <span class="n">items</span><span class="p">:</span> <span class="n">Array</span><span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span><span class="p">;</span>

  <span class="n">constructor</span><span class="p">(</span><span class="n">private</span> <span class="n">wikipediaService</span><span class="p">:</span> <span class="n">WikipediaService</span><span class="p">)</span> <span class="p">{}</span>

  <span class="n">search</span><span class="p">(</span><span class="n">term</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">this</span><span class="o">.</span><span class="n">wikipediaService</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">term</span><span class="p">)</span>
                         <span class="o">.</span><span class="n">then</span><span class="p">(</span><span class="n">items</span> <span class="o">=&gt;</span> <span class="n">this</span><span class="o">.</span><span class="n">items</span> <span class="o">=</span> <span class="n">items</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p>There is not much of a surprise here either. We inject our <code>WikipediaService</code>
and expose its functionality via a search method to the template. The template
simply binds to <strong>keyup</strong> and calls <code>search(term.value)</code>.</p>
<p>We unwrap the result of the <strong>Promise</strong> that the search method of the
WikipediaService returns and expose it as a simple array of strings to the
template so that we can have <code>*ngFor</code> loop through it and build up a list for
us.</p>
<p>See the example of <strong>Promise-based</strong> implementation on Plunker</p>
<hr>
<p>Where <strong>Observables</strong> really shine</p>
<p>Let’s change our code to not hammer the endpoint with every keystroke, but
instead only send a request when the user stopped typing for <strong>400 ms</strong></p>
<p>To unveil such super powers, we first need to get an <code>Observable&lt;string&gt;</code> that
carries the search term that the user types in. Instead of manually binding to
the keyup event, we can take advantage of Angular’s <code>formControl</code> directive.
To use this directive, we first need to import the <code>ReactiveFormsModule</code> into
our application module.</p>
<p><code>app.ts</code></p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="p">{</span> <span class="n">NgModule</span> <span class="p">}</span> <span class="kn">from</span> <span class="s1">'@angular/core'</span><span class="p">;</span>
<span class="kn">import</span> <span class="p">{</span> <span class="n">BrowserModule</span> <span class="p">}</span> <span class="kn">from</span> <span class="s1">'@angular/platform-browser'</span><span class="p">;</span>
<span class="kn">import</span> <span class="p">{</span> <span class="n">JsonpModule</span> <span class="p">}</span> <span class="kn">from</span> <span class="s1">'@angular/http'</span><span class="p">;</span>
<span class="kn">import</span> <span class="p">{</span> <span class="n">ReactiveFormsModule</span> <span class="p">}</span> <span class="kn">from</span> <span class="s1">'@angular/forms'</span><span class="p">;</span>

<span class="nd">@NgModule</span><span class="p">({</span>
  <span class="n">imports</span><span class="p">:</span> <span class="p">[</span><span class="n">BrowserModule</span><span class="p">,</span> <span class="n">JsonpModule</span><span class="p">,</span> <span class="n">ReactiveFormsModule</span><span class="p">]</span>
  <span class="n">declarations</span><span class="p">:</span> <span class="p">[</span><span class="n">AppComponent</span><span class="p">],</span>
  <span class="n">bootstrap</span><span class="p">:</span> <span class="p">[</span><span class="n">AppComponent</span><span class="p">]</span>
<span class="p">})</span>
<span class="n">export</span> <span class="k">class</span> <span class="nc">AppModule</span> <span class="p">{}</span>
</pre></div>

<p>Once imported, we can use formControl from within our template and set it to
the name "term".</p>
<div class="code"><pre class="code literal-block"><span class="o">&lt;</span><span class="k">input</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="ss">"text"</span><span class="w"> </span><span class="o">[</span><span class="n">formControl</span><span class="o">]=</span><span class="ss">"term"</span><span class="o">/&gt;</span>
</pre></div>

<p>In our component, we create an instance of <code>FormControl</code> from <code>@angular/form</code>
and expose it as a field under the name term on our component.</p>
<p>Behind the scenes, <strong>term</strong> automatically exposes an <code>Observable&lt;string&gt;</code> as
property <code>valueChanges</code> that we can subscribe to. Now that we have an
<code>Observable&lt;string&gt;</code>, overcoming the user input is as easy as calling
<code>debounceTime(400)</code> on our <code>Observable</code>. This will return a new
<code>Observable&lt;string&gt;</code> that will only emit a new value when there haven’t been
coming new values for 400 ms.</p>
<div class="code"><pre class="code literal-block"><span class="k">export</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">App</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">items</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">Array</span><span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span><span class="p">;</span>
<span class="w">  </span><span class="n">term</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">FormControl</span><span class="p">();</span>
<span class="w">  </span><span class="n">constructor</span><span class="p">(</span><span class="n">private</span><span class="w"> </span><span class="n">wikipediaService</span><span class="p">:</span><span class="w"> </span><span class="n">WikipediaService</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">this</span><span class="o">.</span><span class="n">term</span><span class="o">.</span><span class="n">valueChanges</span>
<span class="w">              </span><span class="o">.</span><span class="n">debounceTime</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span><span class="w">        </span><span class="o">//</span><span class="w"> </span><span class="n">wait</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="mi">400</span><span class="w"> </span><span class="n">ms</span><span class="w"> </span><span class="n">pause</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">events</span>
<span class="w">              </span><span class="o">.</span><span class="n">distinctUntilChanged</span><span class="p">()</span><span class="w">   </span><span class="o">//</span><span class="w"> </span><span class="n">ignore</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">next</span><span class="w"> </span><span class="n">search</span><span class="w"> </span><span class="n">term</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">previous</span>
<span class="w">              </span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">term</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">this</span><span class="o">.</span><span class="n">wikipediaService</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">term</span><span class="p">)</span><span class="o">.</span><span class="n">then</span><span class="p">(</span><span class="n">items</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">this</span><span class="o">.</span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">items</span><span class="p">));</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p>It would be a waste of resources to send out another request for a search term
that our application already shows the results for. All we have to do to
achieve the desired behavior is to call the <code>distinctUntilChanged</code> operator
right after we called <code>debounceTime(400)</code></p>
<p>See the example of <strong>Observable</strong> implementation on Plunker</p>
<blockquote>
<p>For dealing with out-of-order responses, please check the full article
http://blog.thoughtram.io/angular/2016/01/06/taking-advantage-of-
observables-in-angular2.html</p>
</blockquote>
<p>As far as I am using HTTP in Angular, I agree that in the normal use cases
there is not much difference when using Observable over Promise. None of the
advantages are really relevant here in practice. I hope I can see some
advanced use case in the future :)</p>
<hr>
<blockquote>
<p>Learn more</p>
<ul>
<li>https://angular-2-training-book.rangle.io/handout/observables/</li>
<li>https://angular.io/tutorial/toh-pt6#observables
</li>
</ul>
</blockquote>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/angular/" rel="tag">angular</a></li>
            <li><a class="tag p-category" href="../../categories/angular-observable/" rel="tag">angular-observable</a></li>
            <li><a class="tag p-category" href="../../categories/angular-promise/" rel="tag">angular-promise</a></li>
            <li><a class="tag p-category" href="../../categories/promise/" rel="tag">promise</a></li>
            <li><a class="tag p-category" href="../../categories/rxjs/" rel="tag">rxjs</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../can-i-delete-a-git-commit-but-keep-the-changes/" rel="prev" title="Can I delete a git commit but keep the changes?">Previous post</a>
            </li>
            <li class="next">
                <a href="../open-files-always-in-a-new-tab/" rel="next" title="Open files always in a new tab">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="../../assets/js/search.js"></script>
</body>
</html>
