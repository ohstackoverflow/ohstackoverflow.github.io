<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>An ASP.NET setting has been detected that does not apply in Integrated managed pipeline mode | StackOverflow Snapshot</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/posts/an-asp-net-setting-has-been-detected-that-does-not-apply-in-integrated-managed-pipeline-mode/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Arya">
<link rel="prev" href="../the-property-value-does-not-exist-on-value-of-type-htmlelement/" title="The property 'value' does not exist on value of type 'HTMLElement'" type="text/html">
<link rel="next" href="../how-to-convert-int-to-qstring/" title="How to convert int to QString?" type="text/html">
<meta property="og:site_name" content="StackOverflow Snapshot">
<meta property="og:title" content="An ASP.NET setting has been detected that does not apply in Integrated">
<meta property="og:url" content="https://ohstackoverflow.netlify.app/posts/an-asp-net-setting-has-been-detected-that-does-not-apply-in-integrated-managed-pipeline-mode/">
<meta property="og:description" content="I installed DotNetOpenAuth SDK-3.4.5.10201.vsix, and I can't get it working.
It works locally (when I run as localhost), but when I try to publish it
doesn't work.
The IIS error message I get is:

Err">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-03-03T14:25:43+08:00">
<meta property="article:tag" content=".net-4.0">
<meta property="article:tag" content=".net-c#">
<meta property="article:tag" content="asp.net">
<meta property="article:tag" content="iis">
<meta property="article:tag" content="iis-7.5">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">An ASP.NET setting has been detected that does not apply in Integrated managed pipeline mode</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T14:25:43+08:00" itemprop="datePublished" title="2023-03-03 14:25">2023-03-03 14:25</time></a>
            </p>
            

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>I installed DotNetOpenAuth SDK-3.4.5.10201.vsix, and I can't get it working.
It works locally (when I run as localhost), but when I try to publish it
doesn't work.</p>
<p>The IIS error message I get is:</p>
<blockquote>
<p>Error Summary<br>
 HTTP Error 500.22 - Internal Server Error<br>
 An ASP.NET setting has been detected that does not apply in Integrated
managed pipeline mode.</p>
</blockquote>
<p>and:</p>
<blockquote>
<div class="code"><pre class="code literal-block"><span class="k">Module</span><span class="w">       </span><span class="nn">ConfigurationValidationModule</span><span class="w">  </span>
<span class="n">Notification</span><span class="w"> </span><span class="n">BeginRequest</span><span class="w">  </span>
<span class="n">Handler</span><span class="w">      </span><span class="n">StaticFile</span><span class="w">  </span>
<span class="k">Error</span><span class="w"> </span><span class="n">Code</span><span class="w">   </span><span class="mi">0</span><span class="n">x80070032</span>
</pre></div>

</blockquote>
<p>Then there are some suggestions on how to solve the problem:</p>
<blockquote>
<p>Things you can try:</p>
<ul>
<li>
<p>Migrate the configuration to the <code>system.webServer/modules</code> section. You
can do so manually or by using AppCmd from the command line - for example,
<code>%SystemRoot%\system32\inetsrv\appcmd migrate config "Default Web Site/"</code>.
Using <code>AppCmd</code> to migrate your application will enable it to work in
Integrated mode, and continue to work in Classic mode and on previous
versions of IIS.</p>
</li>
<li>
<p>If you are certain that it is OK to ignore this error, it can be
disabled by setting
<code>system.webServer/validation@validateIntegratedModeConfiguration</code> to false.</p>
</li>
<li>
<p>Alternatively, switch the application to a Classic mode application pool</p>
</li>
<li>for example, <code>%SystemRoot%\system32\inetsrv\appcmd set app "Default Web
Site/" /applicationPool:"Classic .NET AppPool"</code>. Only do this if you are
unable to migrate your application.<br>
 (Set "Default Web Site" and "Classic .NET AppPool" to your application path
and application pool name)</li>
</ul>
</blockquote>
<p>The problem is that I don't have access to the ISS server, as I am not the
owner of it. Is there any way to solve this?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>The 2nd option is the one you want.</p>
<p>In your <code>web.config</code>, make sure these keys exist:</p>
<div class="code"><pre class="code literal-block"><span class="nt">&lt;configuration&gt;</span>
<span class="w">    </span><span class="nt">&lt;system.webServer&gt;</span>
<span class="w">        </span><span class="nt">&lt;validation</span><span class="w"> </span><span class="na">validateIntegratedModeConfiguration=</span><span class="s">"false"</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/system.webServer&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>Adding <code>&lt;validation validateIntegratedModeConfiguration="false"/&gt;</code> addresses
the symptom, but is not appropriate for all circumstances. Having ran around
this issue a few times, I hope to help others not only overcome the problem
but understand it. (Which becomes more and more important as IIS 6 fades into
myth and rumor.)</p>
<p>Background:</p>
<p>This issue and the confusion surrounding it started with the introduction of
ASP.NET 2.0 and IIS 7. IIS 6 had and continues to have only one pipeline mode,
and it is equivalent to what IIS 7+ calls "Classic" mode. The second, newer,
and recommended pipeline mode for all applications running on IIS 7+ is called
"Integrated" mode.</p>
<p>So, what's the difference? The key difference is how ASP.NET interacts with
IIS.</p>
<ul>
<li>
<p><strong>Classic mode</strong> is limited to an ASP.NET pipeline that cannot interact with the IIS pipeline. Essentially a request comes in and if IIS 6/Classic has been told, through server configuration, that ASP.NET can handle it then IIS hands off the request to ASP.NET and moves on. The significance of this can be gleaned from an example. If I were to authorize access to static image files, I would not be able to do it with an ASP.NET module because the IIS 6 pipeline will handle those requests itself and ASP.NET will never see those requests because they were never handed off.* On the other hand, authorizing which users can access a .ASPX page such as a request for Foo.aspx is trivial even in IIS 6/Classic because IIS always hands those requests off to the ASP.NET pipeline. In Classic mode ASP.NET does not know what it hasn't been told and there is a lot that IIS 6/Classic may not be telling it.</p>
</li>
<li>
<p><strong>Integrated mode</strong> is recommended because ASP.NET handlers and modules can interact directly with the IIS pipeline. No longer does the IIS pipeline simply hand off the request to the ASP.NET pipeline, now it allows ASP.NET code to hook directly into the IIS pipeline and all the requests that hit it. This means that an ASP.NET module can not only observe requests to static image files, but can intercept those requests and take action by denying access, logging the request, etc.</p>
</li>
</ul>
<p>Overcoming the error:</p>
<ol>
<li>If you are running an older application that was originally built for IIS 6, perhaps you moved it to a new server, there may be absolutely nothing wrong with running the application pool of that application in Classic mode. Go ahead you don't have to feel bad.</li>
<li>
<p>Then again maybe you are giving your application a face-lift or it was chugging along just fine until you installed a 3rd party library via NuGet, manually, or by some other means. In that case it is entirely possible <code>httpHandlers</code> or <code>httpModules</code> have been added to <code>system.web</code>. The outcome is the error that you are seeing because <code>validateIntegratedModeConfiguration</code> defaults <code>true</code>. Now you have two choices:</p>
<ol>
<li>Remove the <code>httpHandlers</code> and <code>httpModules</code> elements from <code>system.web</code>. There are a couple possible outcomes from this: </li>
<li>Everything works fine, a common outcome;</li>
<li>Your application continues to complain, there may be a web.config in a parent folder you are inheriting from, consider cleaning up that web.config too;</li>
<li>You grow tired of removing the <code>httpHandlers</code> and <code>httpModules</code> that NuGet packages keep adding to <code>system.web</code>, hey do what you need to.</li>
<li>If those options do not work or are more trouble than it is worth then I'm not going to tell you that you can't set <code>validateIntegratedModeConfiguration</code> to <code>false</code>, but at least you know what you're doing and why it matters.</li>
</ol>
</li>
</ol>
<p>Good reads:</p>
<ul>
<li>ASP.NET 2.0 Breaking Changes on IIS 7.0</li>
<li>ASP.NET Integration with IIS 7</li>
<li>HTTP Handlers and HTTP Modules Overview</li>
</ul>
<p>*Of course there are ways to get all kind of strange things into the ASP.NET pipeline from IIS 6/Classic via incantations like wildcard mappings, if you like that sort of thing.</p>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/net-40/" rel="tag">.net-4.0</a></li>
            <li><a class="tag p-category" href="../../categories/net-c/" rel="tag">.net-c#</a></li>
            <li><a class="tag p-category" href="../../categories/aspnet/" rel="tag">asp.net</a></li>
            <li><a class="tag p-category" href="../../categories/iis/" rel="tag">iis</a></li>
            <li><a class="tag p-category" href="../../categories/iis-75/" rel="tag">iis-7.5</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../the-property-value-does-not-exist-on-value-of-type-htmlelement/" rel="prev" title="The property 'value' does not exist on value of type 'HTMLElement'">Previous post</a>
            </li>
            <li class="next">
                <a href="../how-to-convert-int-to-qstring/" rel="next" title="How to convert int to QString?">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="../../assets/js/search.js"></script>
</body>
</html>
