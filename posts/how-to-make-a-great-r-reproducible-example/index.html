<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>How to make a great R reproducible example | StackOverflow Snapshot</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/posts/how-to-make-a-great-r-reproducible-example/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Arya">
<link rel="prev" href="../prop-vs-attr/" title=".prop() vs .attr()" type="text/html">
<link rel="next" href="../what-is-the-rule-of-three/" title="What is The Rule of Three?" type="text/html">
<meta property="og:site_name" content="StackOverflow Snapshot">
<meta property="og:title" content="How to make a great R reproducible example">
<meta property="og:url" content="https://ohstackoverflow.netlify.app/posts/how-to-make-a-great-r-reproducible-example/">
<meta property="og:description" content="This question's answers are a community effort. Edit existing answers to
improve this post. It is not currently accepting new answers or interactions.
When discussing performance with colleagues, teac">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-02-16T21:22:26+08:00">
<meta property="article:tag" content="r">
<meta property="article:tag" content="r-faq">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">How to make a great R reproducible example</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2023-02-16T21:22:26+08:00" itemprop="datePublished" title="2023-02-16 21:22">2023-02-16 21:22</time></a>
            </p>
            

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p><strong>This question's answers are a community effort</strong>. Edit existing answers to
improve this post. It is not currently accepting new answers or interactions.</p>
<p>When discussing performance with colleagues, teaching, sending a bug report or
searching for guidance on mailing lists and here on Stack Overflow, a
reproducible example is often asked and always helpful.</p>
<p>What are your tips for creating an excellent example? How do you paste data
structures from r in a text format? What other information should you include?</p>
<p>Are there other tricks in addition to using <code>dput()</code>, <code>dump()</code> or
<code>structure()</code>? When should you include <code>library()</code> or <code>require()</code> statements?
Which reserved words should one avoid, in addition to <code>c</code>, <code>df</code>, <code>data</code>, etc.?</p>
<p>How does one make a great r reproducible example?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Basically, a <strong>minimal reproducible example (MRE)</strong> should enable others to
<em>exactly</em> reproduce your issue on their machines.</p>
<p><strong>Please do not post images of your data, code, or console output!</strong></p>
<h2>tl;dr</h2>
<p>A MRE consists of the following items:</p>
<ul>
<li>a <strong>minimal dataset</strong> , necessary to demonstrate the problem</li>
<li>the <strong>minimal <em>runnable</em> code</strong> necessary to reproduce the issue, which can be run on the given dataset</li>
<li>all <strong>necessary information</strong> on the used <code>library</code>s, the R version, and the OS it is run on, perhaps a <code>sessionInfo()</code>
</li>
<li>in the case of random processes, a <strong>seed</strong> (set by <code>set.seed()</code>) to enable others to replicate exactly the same results as you do</li>
</ul>
<p>For examples of good MREs, see section "Examples" at the bottom of help pages
on the function you are using. Simply type e.g. <code>help(mean)</code>, or short <code>?mean</code>
into your R console.</p>
<h2>Providing a minimal dataset</h2>
<p>Usually, sharing huge data sets is not necessary and may rather discourage
others from reading your question. Therefore, it is better to use built-in
datasets or create a small "toy" example that resembles your original data,
which is actually what is meant by <em>minimal</em>. If for some reason you really
need to share your original data, you should use a method, such as <code>dput()</code>,
that allows others to get an exact copy of your data.</p>
<h4>Built-in datasets</h4>
<p>You can use one of the built-in datasets. A comprehensive list of built-in
datasets can be seen with <code>data()</code>. There is a short description of every data
set, and more information can be obtained, e.g. with <code>?iris</code>, for the 'iris'
data set that comes with R. Installed packages might contain additional
datasets.</p>
<h4>Creating example data sets</h4>
<p><em>Preliminary note:</em> Sometimes you may need special formats (i.e. classes),
such as factors, dates, or time series. For these, make use of functions like:
<code>as.factor</code>, <code>as.Date</code>, <code>as.xts</code>, ... <em>Example:</em></p>
<div class="code"><pre class="code literal-block"><span class="n">d</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.Date</span><span class="p">(</span><span class="s">"2020-12-30"</span><span class="p">)</span>
</pre></div>

<p>where</p>
<div class="code"><pre class="code literal-block"><span class="k">class</span>(<span class="nb">d</span>)
<span class="c1"># [1] "Date"</span>
</pre></div>

<p><strong>Vectors</strong></p>
<div class="code"><pre class="code literal-block"><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rnorm</span><span class="p">(</span><span class="m">10</span><span class="p">)</span><span class="w">  </span><span class="c1">## random vector normal distributed</span>
<span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">runif</span><span class="p">(</span><span class="m">10</span><span class="p">)</span><span class="w">  </span><span class="c1">## random vector uniformly distributed    </span>
<span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">)</span><span class="w">  </span><span class="c1">## 10 random draws out of 1, 2, ..., 100    </span>
<span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span><span class="kc">LETTERS</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">)</span><span class="w">  </span><span class="c1">## 10 random draws out of built-in latin alphabet</span>
</pre></div>

<p><strong>Matrices</strong></p>
<div class="code"><pre class="code literal-block"><span class="n">m</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">matrix</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">12</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="n">dimnames</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="kc">LETTERS</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">],</span><span class="w"> </span><span class="kc">LETTERS</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">]))</span>
<span class="n">m</span>
<span class="c1">#   A B C  D</span>
<span class="c1"># A 1 4 7 10</span>
<span class="c1"># B 2 5 8 11</span>
<span class="c1"># C 3 6 9 12</span>
</pre></div>

<p><strong>Data frames</strong></p>
<div class="code"><pre class="code literal-block"><span class="nf">set.seed</span><span class="p">(</span><span class="m">42</span><span class="p">)</span><span class="w">  </span><span class="c1">## for sake of reproducibility</span>
<span class="n">n</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">6</span>
<span class="n">dat</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="n">id</span><span class="o">=</span><span class="m">1</span><span class="o">:</span><span class="n">n</span><span class="p">,</span><span class="w"> </span>
<span class="w">                  </span><span class="n">date</span><span class="o">=</span><span class="nf">seq.Date</span><span class="p">(</span><span class="nf">as.Date</span><span class="p">(</span><span class="s">"2020-12-26"</span><span class="p">),</span><span class="w"> </span><span class="nf">as.Date</span><span class="p">(</span><span class="s">"2020-12-31"</span><span class="p">),</span><span class="w"> </span><span class="s">"day"</span><span class="p">),</span>
<span class="w">                  </span><span class="n">group</span><span class="o">=</span><span class="nf">rep</span><span class="p">(</span><span class="kc">LETTERS</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">],</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="m">2</span><span class="p">),</span>
<span class="w">                  </span><span class="n">age</span><span class="o">=</span><span class="nf">sample</span><span class="p">(</span><span class="m">18</span><span class="o">:</span><span class="m">30</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">replace</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">),</span>
<span class="w">                  </span><span class="n">type</span><span class="o">=</span><span class="nf">factor</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="s">"type"</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">n</span><span class="p">)),</span>
<span class="w">                  </span><span class="n">x</span><span class="o">=</span><span class="nf">rnorm</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
<span class="n">dat</span>
<span class="c1">#   id       date group age   type         x</span>
<span class="c1"># 1  1 2020-12-26     A  27 type 1 0.0356312</span>
<span class="c1"># 2  2 2020-12-27     B  19 type 2 1.3149588</span>
<span class="c1"># 3  3 2020-12-28     A  20 type 3 0.9781675</span>
<span class="c1"># 4  4 2020-12-29     B  26 type 4 0.8817912</span>
<span class="c1"># 5  5 2020-12-30     A  26 type 5 0.4822047</span>
<span class="c1"># 6  6 2020-12-31     B  28 type 6 0.9657529</span>
</pre></div>

<p><strong>Note:</strong> Although it is widely used, better do not name your data frame <code>df</code>,
because <code>df()</code> is an R function for the density (i.e. height of the curve at
point <code>x</code>) of the F distribution and you might get a clash with it.</p>
<h4>Copying original data</h4>
<p>If you have a specific reason, or data that would be too difficult to
construct an example from, you could provide a small subset of your original
data, best by using <code>dput</code>.</p>
<p><strong>Why use<code>dput()</code>?</strong></p>
<p><code>dput</code> throws all information needed to exactly reproduce your data on your
console. You may simply copy the output and paste it into your question.</p>
<p>Calling <code>dat</code> (from above) produces output that still lacks information about
variable classes and other features if you share it in your question.
Furthermore, the spaces in the <code>type</code> column make it difficult to do anything
with it. Even when we set out to use the data, we won't manage to get
important features of your data right.</p>
<div class="code"><pre class="code literal-block">  id       date group age   type         x
1  1 2020-12-26     A  27 type 1 0.0356312
2  2 2020-12-27     B  19 type 2 1.3149588
3  3 2020-12-28     A  20 type 3 0.9781675
</pre></div>

<p><strong>Subset your data</strong></p>
<p>To share a subset, use <code>head()</code>, <code>subset()</code> or the indices <code>iris[1:4, ]</code>. Then
wrap it into <code>dput()</code> to give others something that can be put in R
immediately. <em>Example</em></p>
<div class="code"><pre class="code literal-block">dput(iris[1:4, ]) # first four rows of the iris data set
</pre></div>

<p><em>Console output to share in your question:</em></p>
<div class="code"><pre class="code literal-block">structure(list(Sepal.Length = c(5.1, 4.9, 4.7, 4.6), Sepal.Width = c(3.5, 
3, 3.2, 3.1), Petal.Length = c(1.4, 1.4, 1.3, 1.5), Petal.Width = c(0.2, 
0.2, 0.2, 0.2), Species = structure(c(1L, 1L, 1L, 1L), .Label = c("setosa", 
"versicolor", "virginica"), class = "factor")), row.names = c(NA, 
4L), class = "data.frame")
</pre></div>

<p>When using <code>dput</code>, you may also want to include only relevant columns, e.g.
dput(mtcars[1:3, c(2, 5, 6)])</p>
<p><strong>Note:</strong> If your data frame has a factor with many levels, the <code>dput</code> output
can be unwieldy because it will still list all the possible factor levels even
if they aren't present in the subset of your data. To solve this issue, you
can use the <code>droplevels()</code> function. Notice below how species is a factor with
only one level, e.g. <code>dput(droplevels(iris[1:4, ]))</code>. One other caveat for
<code>dput</code> is that it will not work for keyed <code>data.table</code> objects or for grouped
<code>tbl_df</code> (class <code>grouped_df</code>) from the <code>tidyverse</code>. In these cases you can
convert back to a regular data frame before sharing,
<code>dput(as.data.frame(my_data))</code>.</p>
<h2>Producing minimal code</h2>
<p>Combined with the minimal data (see above), your code should exactly reproduce
the problem on another machine by simply copying and pasting it.</p>
<p>This should be the easy part but often isn't. What you should not do:</p>
<ul>
<li>showing all kinds of data conversions; make sure the provided data is already in the correct format (unless that is the problem, of course)</li>
<li>copy-paste a whole script that gives an error somewhere. Try to locate which lines exactly result in the error. More often than not, you'll find out what the problem is yourself.</li>
</ul>
<p>What you should do:</p>
<ul>
<li>add which packages you use if you use any (using <code>library()</code>)</li>
<li>test run your code in a fresh R session to ensure the code is runnable. People should be able to copy-paste your data and your code in the console and get the same as you have.</li>
<li>if you open connections or create files, add some code to close them or delete the files (using <code>unlink()</code>)</li>
<li>if you change options, make sure the code contains a statement to revert them back to the original ones. (eg <code>op &lt;- par(mfrow=c(1,2)) ...some code... par(op)</code> )</li>
</ul>
<h2>Providing necessary information</h2>
<p>In most cases, just the R version and the operating system will suffice. When
conflicts arise with packages, giving the output of <code>sessionInfo()</code> can really
help. When talking about connections to other applications (be it through ODBC
or anything else), one should also provide version numbers for those, and if
possible, also the necessary information on the setup.</p>
<p>If you are running R in <em>R Studio</em> , using <code>rstudioapi::versionInfo()</code> can
help report your RStudio version.</p>
<p>If you have a problem with a specific package, you may want to provide the
package version by giving the output of <code>packageVersion("name of the
package")</code>.</p>
<h2>Seed</h2>
<p>Using <code>set.seed()</code> you may specify a seed1, i.e. the specific state, R's
random number generator is fixed. This makes it possible for random functions,
such as <code>sample()</code>, <code>rnorm()</code>, <code>runif()</code> and lots of others, to always return
the same result, <em>Example:</em></p>
<div class="code"><pre class="code literal-block">set.seed(42)
rnorm(3)
# [1]  1.3709584 -0.5646982  0.3631284

set.seed(42)
rnorm(3)
# [1]  1.3709584 -0.5646982  0.3631284
</pre></div>

<p>1 <strong>Note:</strong> The output of <code>set.seed()</code> differs between R &gt;3.6.0 and previous
versions. Specify which R version you used for the random process, and don't
be surprised if you get slightly different results when following old
questions. To get the same result in such cases, you can use the
<code>RNGversion()</code>-function before <code>set.seed()</code> (e.g.: <code>RNGversion("3.5.2")</code>).</p>
<p><br></p>
<h3>Suggest</h3>
<p>(Here's my advice from How to write a reproducible example. I've tried to make
it short but sweet).</p>
<h2>How to write a reproducible example</h2>
<p>You are most likely to get good help with your R problem if you provide a
reproducible example. A reproducible example allows someone else to recreate
your problem by just copying and pasting R code.</p>
<p>You need to include four things to make your example reproducible: required
packages, data, code, and a description of your R environment.</p>
<ul>
<li>
<p><strong>Packages</strong> should be loaded at the top of the script, so it's easy to see which ones the example needs.</p>
</li>
<li>
<p>The easiest way to include <strong>data</strong> in an email or Stack Overflow question is to use <code>dput()</code> to generate the R code to recreate it. For example, to recreate the <code>mtcars</code> dataset in R, I'd perform the following steps:</p>
<ol>
<li>Run <code>dput(mtcars)</code> in R</li>
<li>Copy the output</li>
<li>In my reproducible script, type <code>mtcars &lt;-</code> then paste.</li>
<li>
<p>Spend a little bit of time ensuring that your <strong>code</strong> is easy for others to read:</p>
</li>
<li>
<p>Make sure you've used spaces and your variable names are concise, but informative</p>
</li>
<li>
<p>Use comments to indicate where your problem lies</p>
</li>
<li>
<p>Do your best to remove everything that is not related to the problem.<br>
The shorter your code is, the easier it is to understand.</p>
</li>
</ol>
</li>
<li>
<p>Include the output of <code>sessionInfo()</code> in a comment in your code. This summarises your <strong>R environment</strong> and makes it easy to check if you're using an out-of-date package.</p>
</li>
</ul>
<p>You can check you have actually made a reproducible example by starting up a
fresh R session and pasting your script in.</p>
<p>Before putting all of your code in an email, consider putting it on Gist
github. It will give your code nice syntax highlighting, and you don't have to
worry about anything getting mangled by the email system.</p>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/r/" rel="tag">r</a></li>
            <li><a class="tag p-category" href="../../categories/r-faq/" rel="tag">r-faq</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../prop-vs-attr/" rel="prev" title=".prop() vs .attr()">Previous post</a>
            </li>
            <li class="next">
                <a href="../what-is-the-rule-of-three/" rel="next" title="What is The Rule of Three?">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="../../assets/js/search.js"></script>
</body>
</html>
