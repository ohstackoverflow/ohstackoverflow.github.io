<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>How can I force clients to refresh JavaScript files? | StackOverflow Snapshot</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/posts/how-can-i-force-clients-to-refresh-javascript-files/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Arya">
<link rel="prev" href="../what-s-the-significance-of-the-no-newline-at-end-of-file-log/" title="What's the significance of the &quot;No newline at end of file&quot; log?" type="text/html">
<link rel="next" href="../does-python-have-an-ordered-set/" title="Does Python have an ordered set?" type="text/html">
<meta property="og:site_name" content="StackOverflow Snapshot">
<meta property="og:title" content="How can I force clients to refresh JavaScript files?">
<meta property="og:url" content="https://ohstackoverflow.netlify.app/posts/how-can-i-force-clients-to-refresh-javascript-files/">
<meta property="og:description" content="We are currently working in a private beta and so are still in the process of
making fairly rapid changes, although obviously as usage is starting to ramp
up, we will be slowing down this process. Tha">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-02-17T18:02:29+08:00">
<meta property="article:tag" content="caching">
<meta property="article:tag" content="javascript">
<meta property="article:tag" content="versioning">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">How can I force clients to refresh JavaScript files?</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T18:02:29+08:00" itemprop="datePublished" title="2023-02-17 18:02">2023-02-17 18:02</time></a>
            </p>
            

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>We are currently working in a private beta and so are still in the process of
making fairly rapid changes, although obviously as usage is starting to ramp
up, we will be slowing down this process. That being said, one issue we are
running into is that after we push out an update with new JavaScript files,
the client browsers still use the cached version of the file and they do not
see the update. Obviously, on a support call, we can simply inform them to do
a <code>ctrl``F5</code> refresh to ensure that they get the up-to-date files from the
server, but it would be preferable to handle this before that time.</p>
<p>Our current thought is to simply attach a version number onto the name of the
JavaScript files and then when changes are made, increment the version on the
script and update all references. This definitely gets the job done, but
updating the references on each release could get cumbersome.</p>
<p>As I'm sure we're not the first ones to deal with this, I figured I would
throw it out to the community. How are you ensuring clients update their cache
when you update your code? If you're using the method described above, are you
using a process that simplifies the change?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>As far as I know a common solution is to add a <code>?&lt;version&gt;</code> to the script's
src link.</p>
<p>For instance:</p>
<div class="code"><pre class="code literal-block"><span class="nt">&lt;script</span><span class="w"> </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="w"> </span><span class="na">src=</span><span class="s">"myfile.js?1500"</span><span class="nt">&gt;&lt;/script&gt;</span>
</pre></div>

<hr>
<blockquote>
<p>I assume at this point that there isn't a better way than find-replace to
increment these "version numbers" in all of the script tags?</p>
</blockquote>
<p>You might have a version control system do that for you? Most version control
systems have a way to automatically inject the revision number on check-in for
instance.</p>
<p>It would look something like this:</p>
<div class="code"><pre class="code literal-block"><span class="nt">&lt;script</span><span class="w"> </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="w"> </span><span class="na">src=</span><span class="s">"myfile.js?$$REVISION$$"</span><span class="nt">&gt;&lt;/script&gt;</span>
</pre></div>

<hr>
<p>Of course, there are always better solutions like this one.</p>
<p><br></p>
<h3>Suggest</h3>
<p>Appending the current time to the URL is indeed a common solution. However,
you can also manage this at the web server level, if you want to. The server
can be configured to send different HTTP headers for javascript files.</p>
<p>For example, to force the file to be cached for no longer than 1 day, you
would send:</p>
<div class="code"><pre class="code literal-block">Cache-Control: max-age=86400, must-revalidate
</pre></div>

<p>For beta, if you want to force the user to always get the latest, you would
use:</p>
<div class="code"><pre class="code literal-block">Cache-Control: no-cache, must-revalidate
</pre></div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/caching/" rel="tag">caching</a></li>
            <li><a class="tag p-category" href="../../categories/javascript/" rel="tag">javascript</a></li>
            <li><a class="tag p-category" href="../../categories/versioning/" rel="tag">versioning</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../what-s-the-significance-of-the-no-newline-at-end-of-file-log/" rel="prev" title="What's the significance of the &quot;No newline at end of file&quot; log?">Previous post</a>
            </li>
            <li class="next">
                <a href="../does-python-have-an-ordered-set/" rel="next" title="Does Python have an ordered set?">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="../../assets/js/search.js"></script>
</body>
</html>
