<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>How to pass "Null" (a real surname!) to a SOAP web service in ActionScript 3 | StackOverflow Snapshot</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/posts/how-to-pass-null-a-real-surname-to-a-soap-web-service-in-actionscript-3/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Arya">
<link rel="prev" href="../how-do-i-check-if-an-array-includes-a-value-in-javascript/" title="How do I check if an array includes a value in JavaScript?" type="text/html">
<link rel="next" href="../undo-a-git-merge-that-hasn-t-been-pushed-yet/" title="Undo a Git merge that hasn't been pushed yet" type="text/html">
<meta property="og:site_name" content="StackOverflow Snapshot">
<meta property="og:title" content='How to pass "Null" (a real surname!) to a SOAP web service in ActionSc'>
<meta property="og:url" content="https://ohstackoverflow.netlify.app/posts/how-to-pass-null-a-real-surname-to-a-soap-web-service-in-actionscript-3/">
<meta property="og:description" content="We have an employee whose surname is Null. Our employee lookup application is
killed when that last name is used as the search term (which happens to be
quite often now). The error received (thanks Fi">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-02-16T18:54:08+08:00">
<meta property="article:tag" content="actionscript">
<meta property="article:tag" content="apache-flex">
<meta property="article:tag" content="coldfusion">
<meta property="article:tag" content="soap">
<meta property="article:tag" content="wsdl">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">How to pass "Null" (a real surname!) to a SOAP web service in ActionScript 3</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2023-02-16T18:54:08+08:00" itemprop="datePublished" title="2023-02-16 18:54">2023-02-16 18:54</time></a>
            </p>
            

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>We have an employee whose surname is Null. Our employee lookup application is
killed when that last name is used as the search term (which happens to be
quite often now). The error received (thanks Fiddler!) is:</p>
<div class="code"><pre class="code literal-block"><span class="nt">&lt;soapenv:Fault&gt;</span>
<span class="w">   </span><span class="nt">&lt;faultcode&gt;</span>soapenv:Server.userException<span class="nt">&lt;/faultcode&gt;</span>
<span class="w">   </span><span class="nt">&lt;faultstring&gt;</span>coldfusion.xml.rpc.CFCInvocationException:<span class="w"> </span>[coldfusion.runtime.MissingArgumentException<span class="w"> </span>:<span class="w"> </span>The<span class="w"> </span>SEARCHSTRING<span class="w"> </span>parameter<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>getFacultyNames<span class="w"> </span>function<span class="w"> </span>is<span class="w"> </span>required<span class="w"> </span>but<span class="w"> </span>was<span class="w"> </span>not<span class="w"> </span>passed<span class="w"> </span>in.]<span class="nt">&lt;/faultstring&gt;</span>
</pre></div>

<p>Cute, huh?</p>
<p>The parameter type is <code>string</code>.</p>
<p>I am using:</p>
<ul>
<li>WSDL (SOAP)</li>
<li>Flex 3.5</li>
<li>ActionScript 3</li>
<li>ColdFusion 8</li>
</ul>
<p>Note that the error <strong>does not</strong> occur when calling the webservice as an
object from a ColdFusion page.</p>
<p><br><br></p>
<h2>Answer</h2>
<h2>Tracking it down</h2>
<p>At first I thought this was a coercion bug where <code>null</code> was getting coerced to
<code>"null"</code> and a test of <code>"null" == null</code> was passing. It's not. <strong>I was close,
but so very, very wrong. Sorry about that!</strong></p>
<p>I've since done lots of fiddling on wonderfl.net and tracing through the code
in <code>mx.rpc.xml.*</code>. At line 1795 of <code>XMLEncoder</code> (in the 3.5 source), in
<code>setValue</code>, all of the XMLEncoding boils down to</p>
<div class="code"><pre class="code literal-block">currentChild.appendChild(xmlSpecialCharsFilter(Object(value)));
</pre></div>

<p>which is essentially the same as:</p>
<div class="code"><pre class="code literal-block">currentChild.appendChild("null");
</pre></div>

<p>This code, according to my original fiddle, returns an empty XML element. But
why?</p>
<h2>Cause</h2>
<p>According to commenter Justin Mclean on bug report FLEX-33664, the following
is the culprit (see last two tests in my fiddle which verify this):</p>
<div class="code"><pre class="code literal-block">var<span class="w"> </span>thisIsNotNull:XML<span class="w"> </span>=<span class="w"> </span><span class="nt">&lt;root&gt;</span>null<span class="nt">&lt;/root&gt;</span>;
if(thisIsNotNull<span class="w"> </span>==<span class="w"> </span>null){
<span class="w">    </span>//<span class="w"> </span>always<span class="w"> </span>branches<span class="w"> </span>here,<span class="w"> </span>as<span class="w"> </span>(thisIsNotNull<span class="w"> </span>==<span class="w"> </span>null)<span class="w"> </span>strangely<span class="w"> </span>returns<span class="w"> </span>true
<span class="w">    </span>//<span class="w"> </span>despite<span class="w"> </span>the<span class="w"> </span>fact<span class="w"> </span>that<span class="w"> </span>thisIsNotNull<span class="w"> </span>is<span class="w"> </span>a<span class="w"> </span>valid<span class="w"> </span>instance<span class="w"> </span>of<span class="w"> </span>type<span class="w"> </span>XML
}
</pre></div>

<p>When <code>currentChild.appendChild</code> is passed the string <code>"null"</code>, it first
converts it to a root XML element with text <code>null</code>, and then tests that
element against the null literal. This is a weak equality test, so either the
XML containing null is coerced to the null type, or the null type is coerced
to a root xml element containing the string "null", and the test passes where
it arguably should fail. One fix might be to always use strict equality tests
when checking XML (or anything, really) for "nullness."</p>
<h2>Solution</h2>
<p>The only reasonable workaround I can think of, short of fixing this bug in
every damn version of ActionScript, is to test fields for "null" and <strong>escape
them as CDATA values.</strong></p>
<p><strong>CDATA values are the most appropriate way to mutate an entire text value
that would otherwise cause encoding/decoding problems.</strong> Hex encoding, for
instance, is meant for individual characters. CDATA values are preferred when
you're escaping the entire text of an element. The biggest reason for this is
that it maintains human readability.</p>
<p><br></p>
<h3>Suggest</h3>
<p>On the xkcd note, the Bobby Tables website has good advice for avoiding the
improper interpretation of user data (in this case, the string "Null") in SQL
queries in various languages, including ColdFusion.</p>
<p>It is not clear from the question that this is the source of the problem, and
given the solution noted in a comment to the first answer (embedding the
parameters in a structure) it seems likely that it was something else.</p>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/actionscript/" rel="tag">actionscript</a></li>
            <li><a class="tag p-category" href="../../categories/apache-flex/" rel="tag">apache-flex</a></li>
            <li><a class="tag p-category" href="../../categories/coldfusion/" rel="tag">coldfusion</a></li>
            <li><a class="tag p-category" href="../../categories/soap/" rel="tag">soap</a></li>
            <li><a class="tag p-category" href="../../categories/wsdl/" rel="tag">wsdl</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../how-do-i-check-if-an-array-includes-a-value-in-javascript/" rel="prev" title="How do I check if an array includes a value in JavaScript?">Previous post</a>
            </li>
            <li class="next">
                <a href="../undo-a-git-merge-that-hasn-t-been-pushed-yet/" rel="next" title="Undo a Git merge that hasn't been pushed yet">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="../../assets/js/search.js"></script>
</body>
</html>
