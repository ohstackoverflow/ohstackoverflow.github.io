<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>React "after render" code? | StackOverflow Snapshot</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/posts/react-after-render-code/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Arya">
<link rel="prev" href="../how-to-declare-and-add-items-to-an-array-in-python/" title="How to declare and add items to an array in Python?" type="text/html">
<link rel="next" href="../disable-file-preview-in-vs2012/" title="Disable file preview in VS2012" type="text/html">
<meta property="og:site_name" content="StackOverflow Snapshot">
<meta property="og:title" content='React "after render" code?'>
<meta property="og:url" content="https://ohstackoverflow.netlify.app/posts/react-after-render-code/">
<meta property="og:description" content='I have an app where I need to set the height of an element (lets say "app-
content") dynamically. It takes the height of the "chrome" of the app and
subtracts it and then sets the height of the "app-c'>
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-03-03T09:23:30+08:00">
<meta property="article:tag" content="javascript">
<meta property="article:tag" content="reactjs">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">React "after render" code?</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T09:23:30+08:00" itemprop="datePublished" title="2023-03-03 09:23">2023-03-03 09:23</time></a>
            </p>
            

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>I have an app where I need to set the height of an element (lets say "app-
content") dynamically. It takes the height of the "chrome" of the app and
subtracts it and then sets the height of the "app-content" to fit 100% within
those constraints. This is super simple with vanilla JS, jQuery, or Backbone
views, but I'm struggling to figure out what the right process would be for
doing this in React?</p>
<p>Below is an example component. I want to be able to set <code>app-content</code>'s height
to be 100% of the window minus the size of the <code>ActionBar</code> and <code>BalanceBar</code>,
but how do I know when everything is rendered and where would I put the
calculation stuff in this React Class?</p>
<div class="code"><pre class="code literal-block">/**<span class="w"> </span>@jsx<span class="w"> </span>React.DOM<span class="w"> </span>*/
var<span class="w"> </span>List<span class="w"> </span>=<span class="w"> </span>require('../list');
var<span class="w"> </span>ActionBar<span class="w"> </span>=<span class="w"> </span>require('../action-bar');
var<span class="w"> </span>BalanceBar<span class="w"> </span>=<span class="w"> </span>require('../balance-bar');
var<span class="w"> </span>Sidebar<span class="w"> </span>=<span class="w"> </span>require('../sidebar');
var<span class="w"> </span>AppBase<span class="w"> </span>=<span class="w"> </span>React.createClass({
<span class="w">  </span>render:<span class="w"> </span>function<span class="w"> </span>()<span class="w"> </span>{
<span class="w">    </span>return<span class="w"> </span>(
<span class="w">      </span><span class="nt">&lt;div</span><span class="w"> </span><span class="na">className=</span><span class="s">"wrapper"</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;Sidebar</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;div</span><span class="w"> </span><span class="na">className=</span><span class="s">"inner-wrapper"</span><span class="nt">&gt;</span>
<span class="w">          </span><span class="nt">&lt;ActionBar</span><span class="w"> </span><span class="na">title=</span><span class="s">"Title Here"</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">          </span><span class="nt">&lt;BalanceBar</span><span class="w"> </span><span class="na">balance=</span><span class="s">{balance}</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">          </span><span class="nt">&lt;div</span><span class="w"> </span><span class="na">className=</span><span class="s">"app-content"</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;List</span><span class="w"> </span><span class="na">items=</span><span class="s">{items}</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">          </span><span class="nt">&lt;/div&gt;</span>
<span class="w">        </span><span class="nt">&lt;/div&gt;</span>
<span class="w">      </span><span class="nt">&lt;/div&gt;</span>
<span class="w">    </span>);
<span class="w">  </span>}
});

module.exports<span class="w"> </span>=<span class="w"> </span>AppBase;
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<p>componentDidMount()</p>
<p>This method is called once after your component is rendered. So your code
would look like so.</p>
<div class="code"><pre class="code literal-block">var<span class="w"> </span>AppBase<span class="w"> </span>=<span class="w"> </span>React.createClass({
<span class="w">  </span>componentDidMount:<span class="w"> </span>function()<span class="w"> </span>{
<span class="w">    </span>var<span class="w"> </span>$this<span class="w"> </span>=<span class="w"> </span>$(ReactDOM.findDOMNode(this));
<span class="w">    </span>//<span class="w"> </span>set<span class="w"> </span>el<span class="w"> </span>height<span class="w"> </span>and<span class="w"> </span>width<span class="w"> </span>etc.
<span class="w">  </span>},

<span class="w">  </span>render:<span class="w"> </span>function<span class="w"> </span>()<span class="w"> </span>{
<span class="w">    </span>return<span class="w"> </span>(
<span class="w">      </span><span class="nt">&lt;div</span><span class="w"> </span><span class="na">className=</span><span class="s">"wrapper"</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;Sidebar</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">          </span><span class="nt">&lt;div</span><span class="w"> </span><span class="na">className=</span><span class="s">"inner-wrapper"</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;ActionBar</span><span class="w"> </span><span class="na">title=</span><span class="s">"Title Here"</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;BalanceBar</span><span class="w"> </span><span class="na">balance=</span><span class="s">{balance}</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;div</span><span class="w"> </span><span class="na">className=</span><span class="s">"app-content"</span><span class="nt">&gt;</span>
<span class="w">              </span><span class="nt">&lt;List</span><span class="w"> </span><span class="na">items=</span><span class="s">{items}</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">          </span><span class="nt">&lt;/div&gt;</span>
<span class="w">        </span><span class="nt">&lt;/div&gt;</span>
<span class="w">      </span><span class="nt">&lt;/div&gt;</span>
<span class="w">    </span>);
<span class="w">  </span>}
});
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>One drawback of using <code>componentDidUpdate</code>, or <code>componentDidMount</code> is that
they are actually executed before the dom elements are done being drawn, but
after they've been passed from React to the browser's DOM.</p>
<p>Say for example if you needed set node.scrollHeight to the rendered
node.scrollTop, then React's DOM elements may not be enough. You need to wait
until the elements are done being painted to get their height.</p>
<p>Solution:</p>
<p>Use <code>requestAnimationFrame</code> to ensure that your code is run after the painting
of your newly rendered object</p>
<div class="code"><pre class="code literal-block"><span class="n">scrollElement</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="c1">// Store a 'this' ref, and</span>
<span class="w">  </span><span class="n">var</span><span class="w"> </span><span class="n">_this</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="o">;</span>
<span class="w">  </span><span class="c1">// wait for a paint before running scrollHeight dependent code.</span>
<span class="w">  </span><span class="n">window</span><span class="o">.</span><span class="na">requestAnimationFrame</span><span class="o">(</span><span class="kd">function</span><span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="n">var</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_this</span><span class="o">.</span><span class="na">getDOMNode</span><span class="o">();</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">(</span><span class="n">node</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="kc">undefined</span><span class="o">)</span><span class="w"> </span><span class="o">{</span>
<span class="w">      </span><span class="n">node</span><span class="o">.</span><span class="na">scrollTop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">.</span><span class="na">scrollHeight</span><span class="o">;</span>
<span class="w">    </span><span class="o">}</span>
<span class="w">  </span><span class="o">});</span>
<span class="o">},</span>
<span class="n">componentDidMount</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="k">this</span><span class="o">.</span><span class="na">scrollElement</span><span class="o">();</span>
<span class="o">},</span>
<span class="c1">// and or</span>
<span class="n">componentDidUpdate</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="k">this</span><span class="o">.</span><span class="na">scrollElement</span><span class="o">();</span>
<span class="o">},</span>
<span class="c1">// and or</span>
<span class="n">render</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="k">this</span><span class="o">.</span><span class="na">scrollElement</span><span class="o">()</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="o">[...]</span>
</pre></div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/javascript/" rel="tag">javascript</a></li>
            <li><a class="tag p-category" href="../../categories/reactjs/" rel="tag">reactjs</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../how-to-declare-and-add-items-to-an-array-in-python/" rel="prev" title="How to declare and add items to an array in Python?">Previous post</a>
            </li>
            <li class="next">
                <a href="../disable-file-preview-in-vs2012/" rel="next" title="Disable file preview in VS2012">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="../../assets/js/search.js"></script>
</body>
</html>
