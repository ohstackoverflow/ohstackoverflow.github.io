<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>How can I revert multiple Git commits? | StackOverflow Snapshot</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/posts/how-can-i-revert-multiple-git-commits/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Arya">
<link rel="prev" href="../how-does-the-access-control-allow-origin-header-work/" title="How does the 'Access-Control-Allow-Origin' header work?" type="text/html">
<link rel="next" href="../how-to-join-merge-data-frames-inner-outer-left-right/" title="How to join (merge) data frames (inner, outer, left, right)" type="text/html">
<meta property="og:site_name" content="StackOverflow Snapshot">
<meta property="og:title" content="How can I revert multiple Git commits?">
<meta property="og:url" content="https://ohstackoverflow.netlify.app/posts/how-can-i-revert-multiple-git-commits/">
<meta property="og:description" content="I have a Git repository that looks like this:
A &lt;- B &lt;- C &lt;- D &lt;- HEAD


I want the head of the branch to point to A, i.e., I want B, C, D, and HEAD to
disappear and I want head to be synonymous with ">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-02-17T01:48:56+08:00">
<meta property="article:tag" content="commit">
<meta property="article:tag" content="git">
<meta property="article:tag" content="git-revert">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">How can I revert multiple Git commits?</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T01:48:56+08:00" itemprop="datePublished" title="2023-02-17 01:48">2023-02-17 01:48</time></a>
            </p>
            

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>I have a Git repository that looks like this:</p>
<div class="code"><pre class="code literal-block"><span class="n">A</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">D</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">HEAD</span>
</pre></div>

<p>I want the head of the branch to point to A, i.e., I want B, C, D, and HEAD to
disappear and I want head to be synonymous with A.</p>
<p>It sounds like I can either try to rebase (doesn't apply, since I've pushed
changes in between), or revert. But how do I revert multiple commits? Do I
revert one at a time? Is the order important?</p>
<p><br><br></p>
<h2>Answer</h2>
<p><em>Expanding what I wrote in a comment</em></p>
<p>The general rule is that you should not rewrite (change) history that you have
published, because somebody might have based their work on it. If you rewrite
(change) history, you would make problems with merging their changes and with
updating for them.</p>
<p>So the solution is to create a <em>new commit</em> which <strong>reverts changes</strong> that you
want to get rid of. You can do this using git revert command.</p>
<p>You have the following situation:</p>
<div class="code"><pre class="code literal-block">A &lt;-- B  &lt;-- C &lt;-- D                                  &lt;-- master &lt;-- HEAD
</pre></div>

<p>(arrows here refers to the direction of the pointer: the "parent" reference in
the case of commits, the top commit in the case of branch head (branch ref),
and the name of branch in the case of HEAD reference).</p>
<p>What you need to create is the following:</p>
<div class="code"><pre class="code literal-block">A &lt;-- B  &lt;-- C &lt;-- D &lt;-- [(BCD)-1]                   &lt;-- master &lt;-- HEAD
</pre></div>

<p>where <code>[(BCD)^-1]</code> means the commit that reverts changes in commits B, C, D.
Mathematics tells us that (BCD)-1 = D-1 C-1 B-1, so you can get the required
situation using the following commands:</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span>git<span class="w"> </span>revert<span class="w"> </span>--no-commit<span class="w"> </span>D
$<span class="w"> </span>git<span class="w"> </span>revert<span class="w"> </span>--no-commit<span class="w"> </span>C
$<span class="w"> </span>git<span class="w"> </span>revert<span class="w"> </span>--no-commit<span class="w"> </span>B
$<span class="w"> </span>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"the commit message for all of them"</span>
</pre></div>

<p>Works for everything except merge commits.</p>
<hr>
<p>Alternate solution would be to checkout <em>contents</em> of commit A, and commit
this state. Also works with merge commits. Added files will not be deleted,
however. If you have any local changes <code>git stash</code> them first:</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span>git<span class="w"> </span>checkout<span class="w"> </span>-f<span class="w"> </span>A<span class="w"> </span>--<span class="w"> </span>.<span class="w"> </span><span class="c1"># checkout that revision over the top of local files</span>
$<span class="w"> </span>git<span class="w"> </span>commit<span class="w"> </span>-a
</pre></div>

<p>Then you would have the following situation:</p>
<div class="code"><pre class="code literal-block">A &lt;-- B  &lt;-- C &lt;-- D &lt;-- A'                       &lt;-- master &lt;-- HEAD
</pre></div>

<p>The commit A' has the same contents as commit A, but is a different commit
(commit message, parents, commit date).</p>
<hr>
<p>Alternate solution by Jeff Ferland, modified by Charles Bailey builds upon the
same idea, but uses git reset. Here it is slightly modified, this way WORKS
FOR EVERYTHING:</p>
<div class="code"><pre class="code literal-block">$<span class="w"> </span>git<span class="w"> </span>reset<span class="w"> </span>--hard<span class="w"> </span>A
$<span class="w"> </span>git<span class="w"> </span>reset<span class="w"> </span>--soft<span class="w"> </span>D<span class="w"> </span><span class="c1"># (or ORIG_HEAD or @{1} [previous location of HEAD]), all of which are D</span>
$<span class="w"> </span>git<span class="w"> </span>commit
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>Clean way which I found useful</p>
<div class="code"><pre class="code literal-block"><span class="n">git</span><span class="w"> </span><span class="n">revert</span><span class="w"> </span><span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">commit</span><span class="w"> </span><span class="n">HEAD</span><span class="o">~</span><span class="mf">3.</span><span class="p">.</span>
<span class="n">git</span><span class="w"> </span><span class="n">commit</span><span class="w"> </span><span class="o">-</span><span class="n">m</span><span class="w"> </span><span class="s">"your message regarding reverting the multiple commits"</span>
</pre></div>

<p>This command reverts last 3 commits with only one commit.</p>
<p>Also doesn't rewrite history, so doesn't require a force push.</p>
<p>The <code>..</code> helps create a range. Meaning <code>HEAD~3..</code> is the same as
<code>HEAD~3..HEAD</code></p>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/commit/" rel="tag">commit</a></li>
            <li><a class="tag p-category" href="../../categories/git/" rel="tag">git</a></li>
            <li><a class="tag p-category" href="../../categories/git-revert/" rel="tag">git-revert</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../how-does-the-access-control-allow-origin-header-work/" rel="prev" title="How does the 'Access-Control-Allow-Origin' header work?">Previous post</a>
            </li>
            <li class="next">
                <a href="../how-to-join-merge-data-frames-inner-outer-left-right/" rel="next" title="How to join (merge) data frames (inner, outer, left, right)">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="../../assets/js/search.js"></script>
</body>
</html>
