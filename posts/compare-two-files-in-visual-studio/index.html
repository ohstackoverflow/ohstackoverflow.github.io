<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Compare two files in Visual Studio | StackOverflow Snapshot</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/posts/compare-two-files-in-visual-studio/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Arya">
<link rel="prev" href="../how-to-join-multiple-lines-of-filenames-into-one-with-custom-delimiter/" title="How to join multiple lines of filenames into one with custom delimiter" type="text/html">
<link rel="next" href="../how-do-you-reinstall-an-app-s-dependencies-using-npm/" title="How do you reinstall an app's dependencies using npm?" type="text/html">
<meta property="og:site_name" content="StackOverflow Snapshot">
<meta property="og:title" content="Compare two files in Visual Studio">
<meta property="og:url" content="https://ohstackoverflow.netlify.app/posts/compare-two-files-in-visual-studio/">
<meta property="og:description" content="I saw the new comparison tool in Visual Studio 2012 for comparing two files or
two versions of a file. I like it. But when I tried to find it I couldn't it,
because I don't use TFS.
Is there a way how">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-02-18T06:36:05+08:00">
<meta property="article:tag" content="compare">
<meta property="article:tag" content="comparison">
<meta property="article:tag" content="diff">
<meta property="article:tag" content="file">
<meta property="article:tag" content="visual-studio">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Compare two files in Visual Studio</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T06:36:05+08:00" itemprop="datePublished" title="2023-02-18 06:36">2023-02-18 06:36</time></a>
            </p>
            

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>I saw the new comparison tool in Visual Studio 2012 for comparing two files or
two versions of a file. I like it. But when I tried to find it I couldn't it,
because I don't use TFS.</p>
<p>Is there a way how I can just compare two files with the built-in feature in
Visual Studio (but without TFS)?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>You can invoke <code>devenv.exe /diff list1.txt list2.txt</code> from the Visual Studio
Developer Command Prompt or, if a Visual Studio instance is already running,
you can type <code>Tools.DiffFiles</code> in the <em>Command window</em> , with a handy file
name completion:</p>
<p><img alt="Using Tools.DiffFiles from the Visual Studio Command
window" src="../../images/cQF8D.png"></p>
<p><br></p>
<h3>Suggest</h3>
<p>Inspired by Vladimir Reshetnikov's answer above, I found a very comfortable
way how you can instantly compare two files with Visual Studio by using <strong>drag
and drop</strong> or via the <strong>"Send To"</strong> context menu. It only requires a little
preparation which you need to do once and then it is useful like a Swiss army
knife.</p>
<p><strong>Visual Studio</strong> already has everything you need, and there are only some
configuration steps required to make this working:</p>
<h3>File compare using drag &amp; drop</h3>
<p><strong>Preparation:</strong></p>
<ol>
<li>Create a new <strong>batch file</strong> using your favorite text editor. Type the following:<div class="code"><pre class="code literal-block"><span class="nv">@echo</span><span class="w"> </span><span class="k">off</span>
</pre></div>

<p>setlocal
set vspath=C:\Program Files (x86)\Microsoft Visual Studio\2017\Enterprise\Common7\IDE
start "Compare files" /B /MIN "%vspath%\devenv.exe" /diff %2 %1 First:'%2' Second:'%1'</p>
</li>
</ol>
<p>You might notice that I have reversed the <code>%1</code> and <code>%2</code> parameters in the
batch. This is because I noticed that the file explorer passes the <strong>second
file</strong> as the first parameter, and then the <strong>first file</strong> as the second
parameter.</p>
<ol>
<li>
<p>Save this code as <strong><code>VS_FileCompare.cmd</code></strong> to use it, and modify <code>vspath</code> if required to match the location of <code>devenv.exe</code> (depending on the <strong>Visual Studio version</strong> you're currently using, see <strong>footnote</strong> *) )</p>
</li>
<li>
<p>Either create a <strong>shortcut</strong> named <strong>"File Compare"</strong> for <code>VS_FileCompare.cmd</code> and place it on the <strong>desktop</strong> (as used in the animation below), so it is always available to drag &amp; drop files onto it or directly place the batch file on the desktop. That's all!</p>
</li>
</ol>
<p><strong>Usage:</strong></p>
<ol>
<li>
<p>Open the <strong>Windows explorer</strong> via <code>Win</code> + <code>E</code></p>
</li>
<li>
<p>Select two files to compare in the explorer</p>
</li>
<li>
<p>Drag and drop them as shown in the animation below:</p>
</li>
</ol>
<p><img alt="DragDropDemo" src="../../images/GknSf.gif"></p>
<ol>
<li>After a few seconds (depending on the launch time of Visual Studio), the results will be shown in Visual Studio:</li>
</ol>
<p><img alt="Visual Studio View" src="../../images/8z0KJ.png"></p>
<p><strong>Note:</strong> It does not harm if Visual Studio is already open. In this case it
will just open up a new window within the running instance of Visual Studio.
So you can compare multiple file pairs, but please ensure you have selected
only two files at a time.</p>
<hr>
<h3>Alternative way: SendTo context menu</h3>
<p>Here's an alternative how you can use the batch file <strong><code>VS_FileCompare.cmd</code></strong>
mentioned in the section above. It allows to use the context menu's <em>Send To
folder</em> to compare the files.</p>
<p><strong>Preparation:</strong></p>
<ol>
<li>Create a shortcut <strong>"Compare2Files VS"</strong> for the batch file <strong><code>VS_FileCompare.cmd</code></strong> and copy it into the <strong>SendTo</strong> folder. Open the <strong>Windows explorer</strong> via <code>Win</code> + <code>E</code>
</li>
<li>Open the <strong>SendTo</strong> folder by entering <strong><code>shell:sendto</code></strong> into the file explorer's address bar (as described here). Then, put the prepared shortcut into this folder.</li>
</ol>
<p><strong>Usage:</strong></p>
<ol>
<li>
<p>Open the <strong>Windows explorer</strong> via <code>Win</code> + <code>E</code></p>
</li>
<li>
<p>Select two files to compare in the explorer</p>
</li>
<li>
<p>Assuming the shortcut for the batch file <strong><code>VS_FileCompare.cmd</code></strong> is named <strong>"Compare2Files VS"</strong> , you can select the two files, right-click and select <strong>Send To → Compare2Files VS</strong> to invoke the compare as shown below:</p>
</li>
</ol>
<p><img alt="SendTo" src="../../images/7hNFi.jpg"></p>
<ol>
<li>After a few seconds (depending on the launch time of Visual Studio), the results will be shown in Visual Studio:</li>
</ol>
<p><img alt="Visual Studio View" src="../../images/8z0KJ.png"></p>
<p><strong>HINT:</strong> If you like the SendTo folder approach, there is more you can do -
for example you can open a command shell directly via SendTo and it starts
with the right path (the path where the selected file resides). Look here to
find out how to do that. You can even combine it with the script to gain
elevated rights, with only a little extra effort.</p>
<hr>
<p><strong>MSDN References:</strong></p>
<ul>
<li>Usage of the diff window</li>
<li>Visual Studio's Diff parameter</li>
</ul>
<hr>
<p><em>) </em><em>Footnote:</em>* Because <code>vsPath</code> (the path to <code>DEVENV.exe</code>) differs depending on your version of Visual Studio, I am describing how you can find it out (Windows 10):</p>
<ol>
<li>
<p>In the <strong>Windows start menu</strong> <img alt="Windows Icon Small" src="../../images/GCpev.png">, locate the <strong>Visual Studio icon</strong> <img alt="Visual Studio Icon Small" src="../../images/HxqaR.png"></p>
</li>
<li>
<p>Right-click to bring up the context menu. Select <em>More</em> → <em>Open File Location</em>. <br>
Windows Explorer opens with the Visual Studio shortcut highlighted.</p>
</li>
<li>
<p>Right-Click on the Visual Studio and select <strong>Properties</strong></p>
</li>
<li>
<p>In the properties dialog, you can find the path in <strong>"Target:"</strong></p>
</li>
</ol>
<p><img alt="VSProperties" src="../../images/WUaSC.png"></p>
<hr>
<p>Animations created with Screen to gif</p>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/compare/" rel="tag">compare</a></li>
            <li><a class="tag p-category" href="../../categories/comparison/" rel="tag">comparison</a></li>
            <li><a class="tag p-category" href="../../categories/diff/" rel="tag">diff</a></li>
            <li><a class="tag p-category" href="../../categories/file/" rel="tag">file</a></li>
            <li><a class="tag p-category" href="../../categories/visual-studio/" rel="tag">visual-studio</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../how-to-join-multiple-lines-of-filenames-into-one-with-custom-delimiter/" rel="prev" title="How to join multiple lines of filenames into one with custom delimiter">Previous post</a>
            </li>
            <li class="next">
                <a href="../how-do-you-reinstall-an-app-s-dependencies-using-npm/" rel="next" title="How do you reinstall an app's dependencies using npm?">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="../../assets/js/search.js"></script>
</body>
</html>
