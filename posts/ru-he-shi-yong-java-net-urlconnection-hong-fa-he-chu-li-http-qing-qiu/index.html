<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>如何使用 java.net.URLConnection 触发和处理 HTTP 请求 | StackOverflow Snapshot</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/posts/ru-he-shi-yong-java-net-urlconnection-hong-fa-he-chu-li-http-qing-qiu/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Arya">
<link rel="prev" href="../fang-fa-he-han-shu-you-shi-yao-qu-bie/" title="方法和函数有什么区别？" type="text/html">
<link rel="next" href="../ru-he-chuang-jian-bao-han-1-n-de-shu-zu/" title="如何创建包含 1...N 的数组" type="text/html">
<meta property="og:site_name" content="StackOverflow Snapshot">
<meta property="og:title" content="如何使用 java.net.URLConnection 触发和处理 HTTP 请求">
<meta property="og:url" content="https://ohstackoverflow.netlify.app/posts/ru-he-shi-yong-java-net-urlconnection-hong-fa-he-chu-li-http-qing-qiu/">
<meta property="og:description" content="使用 ofjava.net.URLConnection在这里经常被问到，而且Oracle 教程对此过于 简洁。
该教程基本上只展示了如何触发GET请求和读取响应。它没有在任何地方解释如何使用它来执行POST请求、设置请求标头、读取响应标头、处理 cookie、提交
HTML 表单、上传文件等。
那么，我如何使用它java.net.URLConnection来触发和处理“高级”HTTP 请求呢？

">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-02-16T22:39:18+08:00">
<meta property="article:tag" content="http">
<meta property="article:tag" content="httprequest">
<meta property="article:tag" content="httpurlconnection">
<meta property="article:tag" content="java">
<meta property="article:tag" content="urlconnection">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">如何使用 java.net.URLConnection 触发和处理 HTTP 请求</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2023-02-16T22:39:18+08:00" itemprop="datePublished" title="2023-02-16 22:39">2023-02-16 22:39</time></a>
            </p>
            

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>使用 of<code>java.net.URLConnection</code>在这里经常被问到，而且Oracle 教程对此过于 <em>简洁。</em></p>
<p>该教程基本上只展示了如何触发GET请求和读取响应。它没有在任何地方解释如何使用它来执行POST请求、设置请求标头、读取响应标头、处理 cookie、提交
HTML 表单、上传文件等。</p>
<p>那么，我如何使用它<code>java.net.URLConnection</code>来触发和处理“高级”HTTP 请求呢？</p>
<p><br><br></p>
<h2>解答</h2>
<p><em>首先事先声明：发布的代码片段都是基本示例。 您需要处理琐碎的<code>IOException</code>s 和<code>RuntimeException</code>s
之类的事情<code>NullPointerException</code>，<code>ArrayIndexOutOfBoundsException</code>并与自己相处。</em></p>
<p><em>如果您正在为 Android 而不是 Java 进行开发，还请注意，自从引入 API 级别 28 以来， 默认情况下禁用明文 HTTP
请求。我们鼓励您使用<code>HttpsURLConnection</code>，但如果确实有必要，可以在应用程序清单中启用明文。</em></p>
<hr>
<h4>准备中</h4>
<p>我们首先需要至少知道 URL 和字符集。参数是可选的，取决于功能要求。</p>
<div class="code"><pre class="code literal-block"><span class="nb nb-Type">String</span><span class="w"> </span><span class="n">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"http://example.com"</span><span class="p">;</span>
<span class="nb nb-Type">String</span><span class="w"> </span><span class="n">charset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"UTF-8"</span><span class="p">;</span><span class="w">  </span><span class="o">//</span><span class="w"> </span><span class="n">Or</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">Java</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">later</span><span class="p">,</span><span class="w"> </span><span class="n">use</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">constant</span><span class="p">:</span><span class="w"> </span><span class="n">java</span><span class="o">.</span><span class="n">nio</span><span class="o">.</span><span class="n">charset</span><span class="o">.</span><span class="n">StandardCharsets</span><span class="o">.</span><span class="n">UTF_8</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
<span class="nb nb-Type">String</span><span class="w"> </span><span class="n">param1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"value1"</span><span class="p">;</span>
<span class="nb nb-Type">String</span><span class="w"> </span><span class="n">param2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"value2"</span><span class="p">;</span>
<span class="o">//</span><span class="w"> </span><span class="o">...</span>

<span class="nb nb-Type">String</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb nb-Type">String</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"param1=</span><span class="si">%s</span><span class="s2">&amp;param2=</span><span class="si">%s</span><span class="s2">"</span><span class="p">,</span>
<span class="w">    </span><span class="n">URLEncoder</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">param1</span><span class="p">,</span><span class="w"> </span><span class="n">charset</span><span class="p">),</span>
<span class="w">    </span><span class="n">URLEncoder</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">param2</span><span class="p">,</span><span class="w"> </span><span class="n">charset</span><span class="p">));</span>
</pre></div>

<p>查询参数必须采用<code>name=value</code>格式并由<code>&amp;</code>. 您通常还会使用指定的字符集对查询参数进行 URL 编码<code>URLEncoder#encode()</code>。</p>
<p>只是<code>String#format()</code>为了方便。当我需要<code>+</code>两次以上的字符串连接运算符时，我更喜欢它。</p>
<hr>
<h4>使用（可选）查询参数触发HTTP GET请求</h4>
<p>这是一项微不足道的任务。这是默认的请求方法。</p>
<div class="code"><pre class="code literal-block">URLConnection connection = new URL(url + "?" + query).openConnection();
connection.setRequestProperty("Accept-Charset", charset);
InputStream response = connection.getInputStream();
// ...
</pre></div>

<p>任何查询字符串都应该使用<code>?</code>. 标<code>Accept-
Charset</code>头可能会提示服务器参数的编码方式。如果您不发送任何查询字符串，则可以离开标头<code>Accept-
Charset</code>。如果您不需要设置任何标题，那么您甚至可以使用<code>URL#openStream()</code>快捷方式。</p>
<div class="code"><pre class="code literal-block">InputStream response = new URL(url).openStream();
// ...
</pre></div>

<p>无论哪种方式，如果另一方是<code>HttpServlet</code>，则将<code>doGet()</code>调用其方法并且参数将由<code>HttpServletRequest#getParameter()</code>.</p>
<p>出于测试目的，您可以将响应正文打印到标准输出，如下所示：</p>
<div class="code"><pre class="code literal-block"><span class="nv">try</span><span class="w"> </span><span class="ss">(</span><span class="nv">Scanner</span><span class="w"> </span><span class="nv">scanner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">Scanner</span><span class="ss">(</span><span class="nv">response</span><span class="ss">))</span><span class="w"> </span>{
<span class="w">    </span><span class="nv">String</span><span class="w"> </span><span class="nv">responseBody</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">scanner</span>.<span class="nv">useDelimiter</span><span class="ss">(</span><span class="s2">"\\A"</span><span class="ss">)</span>.<span class="k">next</span><span class="ss">()</span><span class="c1">;</span>
<span class="w">    </span><span class="nv">System</span>.<span class="nv">out</span>.<span class="nv">println</span><span class="ss">(</span><span class="nv">responseBody</span><span class="ss">)</span><span class="c1">;</span>
}
</pre></div>

<hr>
<h4>使用查询参数触发HTTP POST请求</h4>
<p>将 设置<code>URLConnection#setDoOutput()</code>为<code>true</code>隐式将请求方法设置为 POST。Web 表单所做的标准 HTTP POST
属于将<code>application/x-www-form-urlencoded</code>查询字符串写入请求正文的类型。</p>
<div class="code"><pre class="code literal-block">URLConnection connection = new URL(url).openConnection();
connection.setDoOutput(true); // Triggers POST.
connection.setRequestProperty("Accept-Charset", charset);
connection.setRequestProperty("Content-Type", "application/x-www-form-urlencoded;charset=" + charset);

try (OutputStream output = connection.getOutputStream()) {
    output.write(query.getBytes(charset));
}

InputStream response = connection.getInputStream();
// ...
</pre></div>

<p>注意：每当你想以编程方式提交 HTML 表单时，不要忘记将<code>name=value</code>任何<code>&lt;input
type="hidden"&gt;</code>元素对放入查询字符串中，当然还有你想以编程方式“按下”<code>name=value</code>的元素对（因为<code>&lt;input
type="submit"&gt;</code>通常在服务器端使用它来区分按钮是否被按下，如果是，是哪个按钮）。</p>
<p>您也可以将获得的转换<code>URLConnection</code>为<code>HttpURLConnection</code>并使用它<code>HttpURLConnection#setRequestMethod()</code>来代替。但是，如果您尝试使用连接进行输出，您仍然需要设置<code>URLConnection#setDoOutput()</code>为<code>true</code>.</p>
<div class="code"><pre class="code literal-block">HttpURLConnection httpConnection = (HttpURLConnection) new URL(url).openConnection();
httpConnection.setRequestMethod("POST");
// ...
</pre></div>

<p>无论哪种方式，如果另一方是<code>HttpServlet</code>，则将<code>doPost()</code>调用其方法并且参数将由<code>HttpServletRequest#getParameter()</code>.</p>
<hr>
<h4>实际触发 HTTP 请求</h4>
<p>您可以使用 显式触发 HTTP 请求，但是当您想要获取有关 HTTP
响应的任何信息（例如响应正文使用等）<code>URLConnection#connect()</code>时，请求将按需自动触发。<code>URLConnection#getInputStream()</code>上面的例子正是这样做的，所以这个<code>connect()</code>调用实际上是多余的。</p>
<hr>
<h4>收集 HTTP 响应信息</h4>
<ol>
<li>HTTP 响应状态：</li>
</ol>
<p>你需要一个<code>HttpURLConnection</code>这里。如有必要，请先施放它。</p>
<div class="code"><pre class="code literal-block">    int status = httpConnection.getResponseCode();
</pre></div>

<ol>
<li>
<p>HTTP 响应标头：</p>
<div class="code"><pre class="code literal-block"><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="ss">(</span><span class="nv">Entry</span><span class="o">&lt;</span><span class="nv">String</span>,<span class="w"> </span><span class="nv">List</span><span class="o">&lt;</span><span class="nv">String</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="nv">header</span><span class="w"> </span>:<span class="w"> </span><span class="nv">connection</span>.<span class="nv">getHeaderFields</span><span class="ss">()</span>.<span class="nv">entrySet</span><span class="ss">())</span><span class="w"> </span>{
<span class="w"> </span><span class="nv">System</span>.<span class="nv">out</span>.<span class="nv">println</span><span class="ss">(</span><span class="nv">header</span>.<span class="nv">getKey</span><span class="ss">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">"="</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nv">header</span>.<span class="nv">getValue</span><span class="ss">())</span><span class="c1">;</span>
</pre></div>

<p>}</p>
</li>
<li>
<p>HTTP 响应编码：</p>
</li>
</ol>
<p>当<code>Content-Type</code>包含<code>charset</code>参数时，响应主体可能是基于文本的，然后我们希望使用服务器端指定的字符编码来处理响应主体。</p>
<div class="code"><pre class="code literal-block"><span class="w">    </span><span class="nv">String</span><span class="w"> </span><span class="nv">contentType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">connection</span>.<span class="nv">getHeaderField</span><span class="ss">(</span><span class="s2">"Content-Type"</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">    </span><span class="nv">String</span><span class="w"> </span><span class="nv">charset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">null</span><span class="c1">;</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="ss">(</span><span class="nv">String</span><span class="w"> </span><span class="nv">param</span><span class="w"> </span>:<span class="w"> </span><span class="nv">contentType</span>.<span class="nv">replace</span><span class="ss">(</span><span class="s2">" "</span>,<span class="w"> </span><span class="s2">""</span><span class="ss">)</span>.<span class="nv">split</span><span class="ss">(</span><span class="s2">";"</span><span class="ss">))</span><span class="w"> </span>{
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">param</span>.<span class="nv">startsWith</span><span class="ss">(</span><span class="s2">"charset="</span><span class="ss">))</span><span class="w"> </span>{
<span class="w">            </span><span class="nv">charset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">param</span>.<span class="nv">split</span><span class="ss">(</span><span class="s2">"="</span>,<span class="w"> </span><span class="mi">2</span><span class="ss">)</span>[<span class="mi">1</span>]<span class="c1">;</span>
<span class="w">            </span><span class="k">break</span><span class="c1">;</span>
<span class="w">        </span>}
<span class="w">    </span>}

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">charset</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nv">null</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">        </span><span class="nv">try</span><span class="w"> </span><span class="ss">(</span><span class="nv">BufferedReader</span><span class="w"> </span><span class="nv">reader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">BufferedReader</span><span class="ss">(</span><span class="nv">new</span><span class="w"> </span><span class="nv">InputStreamReader</span><span class="ss">(</span><span class="nv">response</span>,<span class="w"> </span><span class="nv">charset</span><span class="ss">)))</span><span class="w"> </span>{
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="ss">(</span><span class="nv">String</span><span class="w"> </span><span class="nv">line</span><span class="c1">; (line = reader.readLine()) != null;) {</span>
<span class="w">                </span><span class="o">//</span><span class="w"> </span>...<span class="w"> </span><span class="nv">System</span>.<span class="nv">out</span>.<span class="nv">println</span><span class="ss">(</span><span class="nv">line</span><span class="ss">)</span>?
<span class="w">            </span>}
<span class="w">        </span>}
<span class="w">    </span>}<span class="w"> </span><span class="k">else</span><span class="w"> </span>{
<span class="w">        </span><span class="o">//</span><span class="w"> </span><span class="nv">It</span><span class="err">'s likely binary content, use InputStream/OutputStream.</span>
<span class="err">    }</span>
</pre></div>

<hr>
<h4>维护会话</h4>
<p>服务器端会话通常由 cookie 支持。某些 Web 表单要求您登录和/或被会话跟踪。您可以使用<code>CookieHandler</code>API 来维护
cookie。在发送所有 HTTP 请求之前，您需要准备一个<code>CookieManager</code>和<code>CookiePolicy</code>一个<code>ACCEPT_ALL</code>。</p>
<div class="code"><pre class="code literal-block"><span class="c1">// First set the default cookie manager.</span>
<span class="n">CookieHandler</span><span class="p">.</span><span class="n">setDefault</span><span class="p">(</span><span class="n">new</span><span class="w"> </span><span class="n">CookieManager</span><span class="p">(</span><span class="nb">null</span><span class="p">,</span><span class="w"> </span><span class="n">CookiePolicy</span><span class="p">.</span><span class="n">ACCEPT_ALL</span><span class="p">));</span>

<span class="c1">// All the following subsequent URLConnections will use the same cookie manager.</span>
<span class="n">URLConnection</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">URL</span><span class="p">(</span><span class="n">url</span><span class="p">).</span><span class="n">openConnection</span><span class="p">();</span>
<span class="c1">// ...</span>

<span class="n">connection</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">URL</span><span class="p">(</span><span class="n">url</span><span class="p">).</span><span class="n">openConnection</span><span class="p">();</span>
<span class="c1">// ...</span>

<span class="n">connection</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">URL</span><span class="p">(</span><span class="n">url</span><span class="p">).</span><span class="n">openConnection</span><span class="p">();</span>
<span class="c1">// ...</span>
</pre></div>

<p>请注意，众所周知，这并不总是在所有情况下都能正常工作。如果它对您来说失败了，那么最好是手动收集和设置 cookie 标头。您基本上需要<code>Set-
Cookie</code>从登录响应或第一个<code>GET</code>请求中获取所有标头，然后将其传递给后续请求。</p>
<div class="code"><pre class="code literal-block"><span class="c1">// Gather all cookies on the first request.</span>
<span class="n">URLConnection</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">URL</span><span class="p">(</span><span class="n">url</span><span class="p">).</span><span class="n">openConnection</span><span class="p">();</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">cookies</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">connection</span><span class="p">.</span><span class="n">getHeaderFields</span><span class="p">().</span><span class="k">get</span><span class="p">(</span><span class="s">"Set-Cookie"</span><span class="p">);</span>
<span class="c1">// ...</span>

<span class="c1">// Then use the same cookies on all subsequent requests.</span>
<span class="n">connection</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">URL</span><span class="p">(</span><span class="n">url</span><span class="p">).</span><span class="n">openConnection</span><span class="p">();</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">cookie</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">cookies</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">connection</span><span class="p">.</span><span class="n">addRequestProperty</span><span class="p">(</span><span class="s">"Cookie"</span><span class="p">,</span><span class="w"> </span><span class="n">cookie</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">";"</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]);</span>
<span class="p">}</span>
<span class="c1">// ...</span>
</pre></div>

<p>那里<code>split(";", 2)[0]</code>是为了摆脱与服务器端无关的 cookie
属性，例如<code>expires</code>、<code>path</code>等。或者，您也可以使用<code>cookie.substring(0,
cookie.indexOf(';'))</code>instead of <code>split()</code>。</p>
<hr>
<h4>串流模式</h4>
<p><code>HttpURLConnection</code>默认情况下，将在实际发送之前缓冲整个 <em>请求</em>
主体，无论您是否使用<code>connection.setRequestProperty("Content-Length", contentLength);</code>.
<code>OutOfMemoryException</code>每当您并发发送大型 POST
请求（例如上传文件）时，这可能会导致s。为避免这种情况，您需要设置<code>HttpURLConnection#setFixedLengthStreamingMode()</code>.</p>
<div class="code"><pre class="code literal-block">httpConnection.setFixedLengthStreamingMode(contentLength);
</pre></div>

<p>但是如果事先确实不知道内容长度，那么您可以通过相应地设置来使用分块流模式<code>HttpURLConnection#setChunkedStreamingMode()</code>。这将设置
HTTP<code>Transfer-Encoding</code>标头<code>chunked</code>，强制请求正文以块的形式发送。下面的示例将以 1 KB 的块发送正文。</p>
<div class="code"><pre class="code literal-block">httpConnection.setChunkedStreamingMode(1024);
</pre></div>

<hr>
<h4>用户代理</h4>
<p>It can happen that a request returns an unexpected response, while it works
fine with a real web browser. The server side is probably blocking requests
based on the <code>User-Agent</code> request header. The <code>URLConnection</code> will by default
set it to <code>Java/1.6.0_19</code> where the last part is obviously the JRE version.
You can override this as follows:</p>
<div class="code"><pre class="code literal-block"><span class="nv">connection</span>.<span class="nv">setRequestProperty</span><span class="ss">(</span><span class="s2">"User-Agent"</span>,<span class="w"> </span><span class="s2">"Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.36"</span><span class="ss">)</span><span class="c1">; // Do as if you're using Chrome 41 on Windows 7.</span>
</pre></div>

<p>Use the User-Agent string from a recent browser.</p>
<hr>
<h4>Error handling</h4>
<p>If the HTTP response code is <code>4nn</code> (Client Error) or <code>5nn</code> (Server Error),
then you may want to read the <code>HttpURLConnection#getErrorStream()</code> to see if
the server has sent any useful error information.</p>
<div class="code"><pre class="code literal-block">InputStream error = ((HttpURLConnection) connection).getErrorStream();
</pre></div>

<p>If the HTTP response code is -1, then something went wrong with connection and
response handling. The <code>HttpURLConnection</code> implementation is in older JREs
somewhat buggy with keeping connections alive. You may want to turn it off by
setting the <code>http.keepAlive</code> system property to <code>false</code>. You can do this
programmatically in the beginning of your application by:</p>
<div class="code"><pre class="code literal-block">System.setProperty("http.keepAlive", "false");
</pre></div>

<hr>
<h4>Uploading files</h4>
<p>You'd normally use <code>multipart/form-data</code> encoding for mixed POST content
(binary and character data). The encoding is in more detail described in
RFC2388.</p>
<div class="code"><pre class="code literal-block"><span class="nt">String</span><span class="w"> </span><span class="nt">param</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"value"</span><span class="o">;</span>
<span class="nt">File</span><span class="w"> </span><span class="nt">textFile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">new</span><span class="w"> </span><span class="nt">File</span><span class="o">(</span><span class="s2">"/path/to/file.txt"</span><span class="o">);</span>
<span class="nt">File</span><span class="w"> </span><span class="nt">binaryFile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">new</span><span class="w"> </span><span class="nt">File</span><span class="o">(</span><span class="s2">"/path/to/file.bin"</span><span class="o">);</span>
<span class="nt">String</span><span class="w"> </span><span class="nt">boundary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">Long</span><span class="p">.</span><span class="nc">toHexString</span><span class="o">(</span><span class="nt">System</span><span class="p">.</span><span class="nc">currentTimeMillis</span><span class="o">());</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nt">Just</span><span class="w"> </span><span class="nt">generate</span><span class="w"> </span><span class="nt">some</span><span class="w"> </span><span class="nt">unique</span><span class="w"> </span><span class="nt">random</span><span class="w"> </span><span class="nt">value</span><span class="o">.</span>
<span class="nt">String</span><span class="w"> </span><span class="nt">CRLF</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"\r\n"</span><span class="o">;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nt">Line</span><span class="w"> </span><span class="nt">separator</span><span class="w"> </span><span class="nt">required</span><span class="w"> </span><span class="nt">by</span><span class="w"> </span><span class="nt">multipart</span><span class="o">/</span><span class="nt">form-data</span><span class="o">.</span>
<span class="nt">URLConnection</span><span class="w"> </span><span class="nt">connection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">new</span><span class="w"> </span><span class="nt">URL</span><span class="o">(</span><span class="nt">url</span><span class="o">)</span><span class="p">.</span><span class="nc">openConnection</span><span class="o">();</span>
<span class="nt">connection</span><span class="p">.</span><span class="nc">setDoOutput</span><span class="o">(</span><span class="nt">true</span><span class="o">);</span>
<span class="nt">connection</span><span class="p">.</span><span class="nc">setRequestProperty</span><span class="o">(</span><span class="s2">"Content-Type"</span><span class="o">,</span><span class="w"> </span><span class="s2">"multipart/form-data; boundary="</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nt">boundary</span><span class="o">);</span>

<span class="nt">try</span><span class="w"> </span><span class="o">(</span>
<span class="w">    </span><span class="nt">OutputStream</span><span class="w"> </span><span class="nt">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">connection</span><span class="p">.</span><span class="nc">getOutputStream</span><span class="o">();</span>
<span class="w">    </span><span class="nt">PrintWriter</span><span class="w"> </span><span class="nt">writer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">new</span><span class="w"> </span><span class="nt">PrintWriter</span><span class="o">(</span><span class="nt">new</span><span class="w"> </span><span class="nt">OutputStreamWriter</span><span class="o">(</span><span class="nt">output</span><span class="o">,</span><span class="w"> </span><span class="nt">charset</span><span class="o">),</span><span class="w"> </span><span class="nt">true</span><span class="o">);</span>
<span class="o">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="err">//</span><span class="w"> </span><span class="err">Send</span><span class="w"> </span><span class="err">normal</span><span class="w"> </span><span class="err">param.</span>
<span class="w">    </span><span class="err">writer.append("--"</span><span class="w"> </span><span class="err">+</span><span class="w"> </span><span class="err">boundary).append(CRLF)</span><span class="p">;</span>
<span class="w">    </span><span class="err">writer.append("</span><span class="n">Content-Disposition</span><span class="p">:</span><span class="w"> </span><span class="n">form-data</span><span class="p">;</span><span class="w"> </span><span class="err">name=\"param\"").append(CRLF)</span><span class="p">;</span>
<span class="w">    </span><span class="err">writer.append("</span><span class="n">Content-Type</span><span class="p">:</span><span class="w"> </span><span class="kc">text</span><span class="o">/</span><span class="n">plain</span><span class="p">;</span><span class="w"> </span><span class="err">charset="</span><span class="w"> </span><span class="err">+</span><span class="w"> </span><span class="err">charset).append(CRLF)</span><span class="p">;</span>
<span class="w">    </span><span class="err">writer.append(CRLF).append(param).append(CRLF).flush()</span><span class="p">;</span>

<span class="w">    </span><span class="err">//</span><span class="w"> </span><span class="err">Send</span><span class="w"> </span><span class="err">text</span><span class="w"> </span><span class="err">file.</span>
<span class="w">    </span><span class="err">writer.append("--"</span><span class="w"> </span><span class="err">+</span><span class="w"> </span><span class="err">boundary).append(CRLF)</span><span class="p">;</span>
<span class="w">    </span><span class="err">writer.append("</span><span class="n">Content-Disposition</span><span class="p">:</span><span class="w"> </span><span class="n">form-data</span><span class="p">;</span><span class="w"> </span><span class="err">name=\"textFile\"</span><span class="p">;</span><span class="w"> </span><span class="err">filename=\""</span><span class="w"> </span><span class="err">+</span><span class="w"> </span><span class="err">textFile.getName()</span><span class="w"> </span><span class="err">+</span><span class="w"> </span><span class="err">"\"").append(CRLF)</span><span class="p">;</span>
<span class="w">    </span><span class="err">writer.append("</span><span class="n">Content-Type</span><span class="p">:</span><span class="w"> </span><span class="kc">text</span><span class="o">/</span><span class="n">plain</span><span class="p">;</span><span class="w"> </span><span class="err">charset="</span><span class="w"> </span><span class="err">+</span><span class="w"> </span><span class="err">charset).append(CRLF)</span><span class="p">;</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Text</span><span class="w"> </span><span class="err">file</span><span class="w"> </span><span class="err">itself</span><span class="w"> </span><span class="err">must</span><span class="w"> </span><span class="err">be</span><span class="w"> </span><span class="err">saved</span><span class="w"> </span><span class="err">in</span><span class="w"> </span><span class="err">this</span><span class="w"> </span><span class="err">charset!</span>
<span class="w">    </span><span class="err">writer.append(CRLF).flush()</span><span class="p">;</span>
<span class="w">    </span><span class="err">Files.copy(textFile.toPath(),</span><span class="w"> </span><span class="err">output)</span><span class="p">;</span>
<span class="w">    </span><span class="err">output.flush()</span><span class="p">;</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Important</span><span class="w"> </span><span class="err">before</span><span class="w"> </span><span class="err">continuing</span><span class="w"> </span><span class="err">with</span><span class="w"> </span><span class="err">writer!</span>
<span class="w">    </span><span class="err">writer.append(CRLF).flush()</span><span class="p">;</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">CRLF</span><span class="w"> </span><span class="err">is</span><span class="w"> </span><span class="err">important!</span><span class="w"> </span><span class="err">It</span><span class="w"> </span><span class="err">indicates</span><span class="w"> </span><span class="err">end</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">boundary.</span>

<span class="w">    </span><span class="err">//</span><span class="w"> </span><span class="err">Send</span><span class="w"> </span><span class="err">binary</span><span class="w"> </span><span class="err">file.</span>
<span class="w">    </span><span class="err">writer.append("--"</span><span class="w"> </span><span class="err">+</span><span class="w"> </span><span class="err">boundary).append(CRLF)</span><span class="p">;</span>
<span class="w">    </span><span class="err">writer.append("</span><span class="n">Content-Disposition</span><span class="p">:</span><span class="w"> </span><span class="n">form-data</span><span class="p">;</span><span class="w"> </span><span class="err">name=\"binaryFile\"</span><span class="p">;</span><span class="w"> </span><span class="err">filename=\""</span><span class="w"> </span><span class="err">+</span><span class="w"> </span><span class="err">binaryFile.getName()</span><span class="w"> </span><span class="err">+</span><span class="w"> </span><span class="err">"\"").append(CRLF)</span><span class="p">;</span>
<span class="w">    </span><span class="err">writer.append("</span><span class="n">Content-Type</span><span class="p">:</span><span class="w"> </span><span class="s2">" + URLConnection.guessContentTypeFromName(binaryFile.getName())).append(CRLF);</span>
<span class="s2">    writer.append("</span><span class="n">Content-Transfer-Encoding</span><span class="o">:</span><span class="w"> </span><span class="n">binary</span><span class="s2">").append(CRLF);</span>
<span class="s2">    writer.append(CRLF).flush();</span>
<span class="s2">    Files.copy(binaryFile.toPath(), output);</span>
<span class="s2">    output.flush(); // Important before continuing with writer!</span>
<span class="s2">    writer.append(CRLF).flush(); // CRLF is important! It indicates end of boundary.</span>

<span class="s2">    // End of multipart/form-data.</span>
<span class="s2">    writer.append("</span><span class="o">--</span><span class="s2">" + boundary + "</span><span class="o">--</span><span class="err">"</span><span class="p">)</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="n">CRLF</span><span class="p">)</span><span class="o">.</span><span class="nf">flush</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>

<p>If the other side is an <code>HttpServlet</code>, then its <code>doPost()</code> method will be
called and the parts will be available by <code>HttpServletRequest#getPart()</code>
(note, thus <strong>not</strong> <code>getParameter()</code> and so on!). The <code>getPart()</code> method is
however relatively new, it's introduced in Servlet 3.0 (Glassfish 3, Tomcat 7,
etc.). Prior to Servlet 3.0, your best choice is using Apache Commons
FileUpload to parse a <code>multipart/form-data</code> request. Also see this answer for
examples of both the FileUpload and the Servelt 3.0 approaches.</p>
<hr>
<h4>Dealing with untrusted or misconfigured HTTPS sites</h4>
<p><em>In case you're developing for Android instead of Java, <strong>be careful</strong> : the
workaround below may save your day if you don't have correct certificates
deployed during development. But you should not use it for production. These
days (April 2021) Google will not allow your app be distributed on Play Store
if they detect insecure hostname verifier, see
https://support.google.com/faqs/answer/7188426.</em></p>
<p>Sometimes you need to connect an HTTPS URL, perhaps because you're writing a
web scraper. In that case, you may likely face a <code>javax.net.ssl.SSLException:
Not trusted server certificate</code> on some HTTPS sites who doesn't keep their SSL
certificates up to date, or a <code>java.security.cert.CertificateException: No
subject alternative DNS name matching [hostname] found</code> or
<code>javax.net.ssl.SSLProtocolException: handshake alert: unrecognized_name</code> on
some misconfigured HTTPS sites.</p>
<p>The following one-time-run <code>static</code> initializer in your web scraper class
should make <code>HttpsURLConnection</code> more lenient as to those HTTPS sites and thus
not throw those exceptions anymore.</p>
<div class="code"><pre class="code literal-block"><span class="k">static</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="n">TrustManager</span><span class="err">[]</span><span class="w"> </span><span class="n">trustAllCertificates</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">TrustManager</span><span class="err">[]</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">X509TrustManager</span><span class="p">()</span><span class="w"> </span><span class="err">{</span>
<span class="w">            </span><span class="nv">@Override</span>
<span class="w">            </span><span class="k">public</span><span class="w"> </span><span class="n">X509Certificate</span><span class="err">[]</span><span class="w"> </span><span class="n">getAcceptedIssuers</span><span class="p">()</span><span class="w"> </span><span class="err">{</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="k">null</span><span class="p">;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="ow">Not</span><span class="w"> </span><span class="n">relevant</span><span class="p">.</span>
<span class="w">            </span><span class="err">}</span>
<span class="w">            </span><span class="nv">@Override</span>
<span class="w">            </span><span class="k">public</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="n">checkClientTrusted</span><span class="p">(</span><span class="n">X509Certificate</span><span class="err">[]</span><span class="w"> </span><span class="n">certs</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">authType</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">                </span><span class="o">//</span><span class="w"> </span><span class="n">Do</span><span class="w"> </span><span class="n">nothing</span><span class="p">.</span><span class="w"> </span><span class="n">Just</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">them</span><span class="w"> </span><span class="ow">all</span><span class="p">.</span>
<span class="w">            </span><span class="err">}</span>
<span class="w">            </span><span class="nv">@Override</span>
<span class="w">            </span><span class="k">public</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="n">checkServerTrusted</span><span class="p">(</span><span class="n">X509Certificate</span><span class="err">[]</span><span class="w"> </span><span class="n">certs</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">authType</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">                </span><span class="o">//</span><span class="w"> </span><span class="n">Do</span><span class="w"> </span><span class="n">nothing</span><span class="p">.</span><span class="w"> </span><span class="n">Just</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">them</span><span class="w"> </span><span class="ow">all</span><span class="p">.</span>
<span class="w">            </span><span class="err">}</span>
<span class="w">        </span><span class="err">}</span>
<span class="w">    </span><span class="err">}</span><span class="p">;</span>

<span class="w">    </span><span class="n">HostnameVerifier</span><span class="w"> </span><span class="n">trustAllHostnames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HostnameVerifier</span><span class="p">()</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="nv">@Override</span>
<span class="w">        </span><span class="k">public</span><span class="w"> </span><span class="k">boolean</span><span class="w"> </span><span class="n">verify</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">hostname</span><span class="p">,</span><span class="w"> </span><span class="n">SSLSession</span><span class="w"> </span><span class="k">session</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">true</span><span class="p">;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">Just</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">them</span><span class="w"> </span><span class="ow">all</span><span class="p">.</span>
<span class="w">        </span><span class="err">}</span>
<span class="w">    </span><span class="err">}</span><span class="p">;</span>

<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="k">System</span><span class="p">.</span><span class="n">setProperty</span><span class="p">(</span><span class="ss">"jsse.enableSNIExtension"</span><span class="p">,</span><span class="w"> </span><span class="ss">"false"</span><span class="p">);</span>
<span class="w">        </span><span class="n">SSLContext</span><span class="w"> </span><span class="n">sc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SSLContext</span><span class="p">.</span><span class="n">getInstance</span><span class="p">(</span><span class="ss">"SSL"</span><span class="p">);</span>
<span class="w">        </span><span class="n">sc</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="k">null</span><span class="p">,</span><span class="w"> </span><span class="n">trustAllCertificates</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SecureRandom</span><span class="p">());</span>
<span class="w">        </span><span class="n">HttpsURLConnection</span><span class="p">.</span><span class="n">setDefaultSSLSocketFactory</span><span class="p">(</span><span class="n">sc</span><span class="p">.</span><span class="n">getSocketFactory</span><span class="p">());</span>
<span class="w">        </span><span class="n">HttpsURLConnection</span><span class="p">.</span><span class="n">setDefaultHostnameVerifier</span><span class="p">(</span><span class="n">trustAllHostnames</span><span class="p">);</span>
<span class="w">    </span><span class="err">}</span>
<span class="w">    </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">GeneralSecurityException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ExceptionInInitializerError</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
<span class="w">    </span><span class="err">}</span>
<span class="err">}</span>
</pre></div>

<hr>
<h4>Last words</h4>
<p>The Apache HttpComponents HttpClient is <em>much</em> more convenient in this all :)</p>
<ul>
<li>HttpClient Tutorial</li>
<li>HttpClient Examples</li>
</ul>
<hr>
<h4>Parsing and extracting HTML</h4>
<p>If all you want is parsing and extracting data from HTML, then better use a
HTML parser like Jsoup.</p>
<ul>
<li>What are the pros/cons of leading HTML parsers in Java</li>
<li>How to scan and extract a webpage in Java</li>
</ul>
<p><br></p>
<h3>更多建议</h3>
<p>当使用 HTTP
时，引用它几乎总是<code>HttpURLConnection</code>比引用基类更有用<code>URLConnection</code>（因为<code>URLConnection</code>当您在 HTTP
URL 上请求时它是一个抽象类<code>URLConnection.openConnection()</code>，无论如何您都会得到）。</p>
<p>然后，您可以不依赖于<code>URLConnection#setDoOutput(true)</code>将请求方法隐式设置为 <em>POST</em>
，而是执行<code>httpURLConnection.setRequestMethod("POST")</code>某些人可能会觉得更自然的方法（并且还允许您指定其他请求方法，例如
<em>PUT</em> 、 <em>DELETE</em> ……）。</p>
<p>它还提供了有用的 HTTP 常量，因此您可以：</p>
<div class="code"><pre class="code literal-block"><span class="nv">int</span><span class="w"> </span><span class="nv">responseCode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">httpURLConnection</span>.<span class="nv">getResponseCode</span><span class="ss">()</span><span class="c1">;</span>

<span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">responseCode</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nv">HttpURLConnection</span>.<span class="nv">HTTP_OK</span><span class="ss">)</span><span class="w"> </span>{
</pre></div>

<p><br><br><a href="../how-to-use-java-net-urlconnection-to-fire-and-handle-http-requests/">查看原文</a></p>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/http/" rel="tag">http</a></li>
            <li><a class="tag p-category" href="../../categories/httprequest/" rel="tag">httprequest</a></li>
            <li><a class="tag p-category" href="../../categories/httpurlconnection/" rel="tag">httpurlconnection</a></li>
            <li><a class="tag p-category" href="../../categories/java/" rel="tag">java</a></li>
            <li><a class="tag p-category" href="../../categories/urlconnection/" rel="tag">urlconnection</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../fang-fa-he-han-shu-you-shi-yao-qu-bie/" rel="prev" title="方法和函数有什么区别？">Previous post</a>
            </li>
            <li class="next">
                <a href="../ru-he-chuang-jian-bao-han-1-n-de-shu-zu/" rel="next" title="如何创建包含 1...N 的数组">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="../../assets/js/search.js"></script>
</body>
</html>
