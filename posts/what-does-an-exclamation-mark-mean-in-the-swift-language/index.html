<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>What does an exclamation mark mean in the Swift language? | StackOverflow Snapshot</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/posts/what-does-an-exclamation-mark-mean-in-the-swift-language/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Arya">
<link rel="prev" href="../read-mat-files-in-python/" title="Read .mat files in Python" type="text/html">
<link rel="next" href="../how-to-verify-that-method-was-not-called-in-moq/" title="How to verify that method was NOT called in Moq?" type="text/html">
<meta property="og:site_name" content="StackOverflow Snapshot">
<meta property="og:title" content="What does an exclamation mark mean in the Swift language?">
<meta property="og:url" content="https://ohstackoverflow.netlify.app/posts/what-does-an-exclamation-mark-mean-in-the-swift-language/">
<meta property="og:description" content='The Swift Programming Language guide has the following example:
class Person {
    let name: String
    init(name: String) { self.name = name }
    var apartment: Apartment?
    deinit { println("\(na'>
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-02-18T06:07:22+08:00">
<meta property="article:tag" content="forced-unwrapping">
<meta property="article:tag" content="option-type">
<meta property="article:tag" content="swift">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">What does an exclamation mark mean in the Swift language?</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T06:07:22+08:00" itemprop="datePublished" title="2023-02-18 06:07">2023-02-18 06:07</time></a>
            </p>
            

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>The Swift Programming Language guide has the following example:</p>
<div class="code"><pre class="code literal-block"><span class="k">class</span><span class="w"> </span><span class="n">Person</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">String</span>
<span class="w">    </span><span class="n">init</span><span class="p">(</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">String</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">apartment</span><span class="p">:</span><span class="w"> </span><span class="n">Apartment</span><span class="err">?</span>
<span class="w">    </span><span class="n">deinit</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">println</span><span class="p">(</span><span class="s2">"\(name) is being deinitialized"</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">class</span><span class="w"> </span><span class="n">Apartment</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">number</span><span class="p">:</span><span class="w"> </span><span class="n">Int</span>
<span class="w">    </span><span class="n">init</span><span class="p">(</span><span class="n">number</span><span class="p">:</span><span class="w"> </span><span class="n">Int</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">tenant</span><span class="p">:</span><span class="w"> </span><span class="n">Person</span><span class="err">?</span>
<span class="w">    </span><span class="n">deinit</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">println</span><span class="p">(</span><span class="s2">"Apartment #\(number) is being deinitialized"</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">var</span><span class="w"> </span><span class="n">john</span><span class="p">:</span><span class="w"> </span><span class="n">Person</span><span class="err">?</span>
<span class="k">var</span><span class="w"> </span><span class="n">number73</span><span class="p">:</span><span class="w"> </span><span class="n">Apartment</span><span class="err">?</span>

<span class="n">john</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Person</span><span class="p">(</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s2">"John Appleseed"</span><span class="p">)</span>
<span class="n">number73</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Apartment</span><span class="p">(</span><span class="n">number</span><span class="p">:</span><span class="w"> </span><span class="mi">73</span><span class="p">)</span>

<span class="o">//</span><span class="n">From</span><span class="w"> </span><span class="n">Apple</span><span class="s1">'s “The Swift Programming Language” guide (https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/AutomaticReferenceCounting.html)</span>
</pre></div>

<p>Then when assigning the apartment to the person, they use an exclamation point
to "unwrap the instance":</p>
<div class="code"><pre class="code literal-block">john!.apartment = number73
</pre></div>

<p>What does it mean to "unwrap the instance"? Why is it necessary? How is it
different from just doing the following:</p>
<div class="code"><pre class="code literal-block">john.apartment = number73
</pre></div>

<p>I'm very new to the Swift language. Just trying to get the basics down.</p>
<p><strong><em>UPDATE:</em></strong><br>
The big piece of the puzzle that I was missing (not directly stated in the
answers - at least not at the time of writing this) is that when you do the
following:</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">john</span><span class="p">:</span><span class="w"> </span><span class="n">Person</span><span class="err">?</span>
</pre></div>

<p>that does NOT mean that "<code>john</code> is of type <code>Person</code> and it might be nil", as I
originally thought. I was simply misunderstanding that <code>Person</code> and <code>Person?</code>
are completely separate types. Once I grasped that, all of the other <code>?</code>, <code>!</code>
madness, and the great answers below, made a lot more sense.</p>
<p><br><br></p>
<h2>Answer</h2>
<blockquote>
<p>What does it mean to "unwrap the instance"? Why is it necessary?</p>
</blockquote>
<p>As far as I can work out (this is very new to me, too)...</p>
<p>The term "wrapped" implies we should <strong>think of an Optional variable as a
present, wrapped in shiny paper, which might (sadly!) be empty</strong>.</p>
<p>When "wrapped", the value of an Optional variable is an enum with two possible
values (a little like a Boolean). This enum describes whether the variable
holds a value (<code>Some(T)</code>), or not (<code>None</code>).</p>
<p>If there is a value, this can be obtained by "unwrapping" the variable
(obtaining the <code>T</code> from <code>Some(T)</code>).</p>
<blockquote>
<p>How is <code>john!.apartment = number73</code> different from <code>john.apartment =
number73</code>? (Paraphrased)</p>
</blockquote>
<p>If you write the name of an Optional variable (eg text <code>john</code>, without the
<code>!</code>), this refers to the "wrapped" enum (Some/None), not the value itself (T).
So <code>john</code> isn't an instance of <code>Person</code>, and it doesn't have an <code>apartment</code>
member:</p>
<div class="code"><pre class="code literal-block">john.apartment
// 'Person?' does not have a member named 'apartment'
</pre></div>

<p>The actual <code>Person</code> value can be unwrapped in various ways:</p>
<ul>
<li>"forced unwrapping": <code>john!</code> (gives the <code>Person</code> value if it exists, runtime error if it is nil)</li>
<li>"optional binding": <code>if let p = john { println(p) }</code> (executes the <code>println</code> if the value exists)</li>
<li>"optional chaining": <code>john?.learnAboutSwift()</code> (executes this made-up method if the value exists)</li>
</ul>
<p>I guess you choose one of these ways to unwrap, depending upon what should
happen in the nil case, and how likely that is. This language design forces
the nil case to be handled explicitly, which I suppose improves safety over
Obj-C (where it is easy to forget to handle the nil case).</p>
<p><strong>Update</strong> :</p>
<p>The exclamation mark is also used in the syntax for declaring "Implicitly
Unwrapped Optionals".</p>
<p>In the examples so far, the <code>john</code> variable has been declared as <code>var
john:Person?</code>, and it is an Optional. If you want the actual value of that
variable, you must unwrap it, using one of the three methods above.</p>
<p>If it were declared as <code>var john:Person!</code> instead, the variable would be an
Implicitly Unwrapped Optional (see the section with this heading in Apple's
book). There is no need to unwrap this kind of variable when accessing the
value, and <code>john</code> can be used without additional syntax. But Apple's book
says:</p>
<blockquote>
<p>Implicitly unwrapped optionals should not be used when there is a
possibility of a variable becoming nil at a later point. Always use a normal
optional type if you need to check for a nil value during the lifetime of a
variable.</p>
</blockquote>
<p><strong>Update 2</strong> :</p>
<p>The article "Interesting Swift Features" by Mike Ash gives some motivation for
optional types. I think it is great, clear writing.</p>
<p><strong>Update 3</strong> :</p>
<p>Another useful article about the <em>implicitly unwrapped optional</em> use for the
exclamation mark: "Swift and the Last Mile" by Chris Adamson. The article
explains that this is a pragmatic measure by Apple used to declare the types
used by their Objective-C frameworks which might contain nil. Declaring a type
as optional (using <code>?</code>) or implicitly unwrapped (using <code>!</code>) is "a tradeoff
between safety and convenience". In the examples given in the article, Apple
have chosen to declare the types as implicitly unwrapped, making the calling
code more convenient, but less safe.</p>
<p>Perhaps Apple might comb through their frameworks in the future, removing the
uncertainty of implicitly unwrapped ("probably never nil") parameters and
replacing them with optional ("certainly could be nil in particular
[hopefully, documented!] circumstances") or standard non-optional ("is never
nil") declarations, based on the exact behaviour of their Objective-C code.</p>
<p><br></p>
<h3>Suggest</h3>
<p>Here is what I think is the difference:</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">john</span><span class="p">:</span><span class="w"> </span><span class="n">Person</span><span class="err">?</span>
</pre></div>

<p>Means john can be nil</p>
<div class="code"><pre class="code literal-block">john?.apartment = number73
</pre></div>

<p>The compiler will interpret this line as:</p>
<div class="code"><pre class="code literal-block"><span class="k">if</span><span class="w"> </span><span class="nv">john</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nv">nil</span><span class="w"> </span>{
<span class="w">    </span><span class="nv">john</span>.<span class="nv">apartment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">number73</span>
}
</pre></div>

<p>While</p>
<div class="code"><pre class="code literal-block">john!.apartment = number73
</pre></div>

<p>The compiler will interpret this line as simply:</p>
<div class="code"><pre class="code literal-block">john.apartment = number73
</pre></div>

<p>Hence, using <code>!</code> will unwrap the if statement, and make it run faster, but if
john is nil, then a runtime error will happen.</p>
<p>So wrap here doesn't mean it is memory wrapped, but it means it is code
wrapped, in this case it is wrapped with an if statement, and because Apple
pay close attention to performance in runtime, they want to give you a way to
make your app run with the best possible performance.</p>
<p><strong>Update:</strong></p>
<p>Getting back to this answer after 4 years, as I got the highest reputations
from it in Stackoverflow :) I misunderstood a little the meaning of unwrapping
at that time. Now after 4 years I believe the meaning of unwrapping here is to
expand the code from its original compact form. Also it means removing the
vagueness around that object, as we are not sure by definition if it is nil or
not. Just like the answer of Ashley above, think about it as a present which
could contain nothing in it. But I still think that the unwrapping is code
unwrapping and not memory based unwrapping as using enum.</p>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/forced-unwrapping/" rel="tag">forced-unwrapping</a></li>
            <li><a class="tag p-category" href="../../categories/option-type/" rel="tag">option-type</a></li>
            <li><a class="tag p-category" href="../../categories/swift/" rel="tag">swift</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../read-mat-files-in-python/" rel="prev" title="Read .mat files in Python">Previous post</a>
            </li>
            <li class="next">
                <a href="../how-to-verify-that-method-was-not-called-in-moq/" rel="next" title="How to verify that method was NOT called in Moq?">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="../../assets/js/search.js"></script>
</body>
</html>
