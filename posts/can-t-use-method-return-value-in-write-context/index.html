<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Can't use method return value in write context | StackOverflow Snapshot</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/posts/can-t-use-method-return-value-in-write-context/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Arya">
<link rel="prev" href="../how-to-do-a-deep-comparison-between-2-objects-with-lodash/" title="How to do a deep comparison between 2 objects with lodash?" type="text/html">
<link rel="next" href="../how-to-abort-a-stash-pop/" title="How to abort a stash pop?" type="text/html">
<meta property="og:site_name" content="StackOverflow Snapshot">
<meta property="og:title" content="Can't use method return value in write context">
<meta property="og:url" content="https://ohstackoverflow.netlify.app/posts/can-t-use-method-return-value-in-write-context/">
<meta property="og:description" content="I would think the following piece of code should work, but it doesn't
(Edited: Now works in PHP 5.5+) :
if (!empty($r-&gt;getError()))


Where getError() is simply:
public function getError()
{
    retur">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-03-03T08:34:32+08:00">
<meta property="article:tag" content="php">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Can't use method return value in write context</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T08:34:32+08:00" itemprop="datePublished" title="2023-03-03 08:34">2023-03-03 08:34</time></a>
            </p>
            

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>I would think the following piece of code should work, but it doesn't
<strong>(Edited: Now works in PHP 5.5+)</strong> :</p>
<div class="code"><pre class="code literal-block"><span class="nf">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">empty</span><span class="p">(</span><span class="err">$</span><span class="n">r</span><span class="o">-&gt;</span><span class="n">getError</span><span class="p">()))</span>
</pre></div>

<p>Where <code>getError()</code> is simply:</p>
<div class="code"><pre class="code literal-block"><span class="n">public</span><span class="w"> </span><span class="kr">function</span><span class="w"> </span><span class="n">getError</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="err">$</span><span class="n">this</span><span class="o">-&gt;</span><span class="nf">error</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<p>Yet I end up with this error:</p>
<blockquote>
<p>can't use method return value in write context</p>
</blockquote>
<p>What does this mean? Isn't this just a read?</p>
<p><br><br></p>
<h2>Answer</h2>
<p><code>empty()</code> needs to access the value by reference (in order to check whether
that reference points to something that exists), and PHP before 5.5 didn't
support references to temporary values returned from functions.</p>
<p>However, the real problem you have is that you use <code>empty()</code> at all,
mistakenly believing that "empty" value is any different from "false".</p>
<p>Empty is just an alias for <code>!isset($thing) || !$thing</code>. When the thing you're
checking always exists (in PHP results of function calls always exist), the
<code>empty()</code> function is <em>nothing but a negation operator</em>.</p>
<p>PHP <strong>doesn't have concept of emptyness</strong>. Values that evaluate to false are
empty, values that evaluate to true are non-empty. It's the same thing. This
code:</p>
<div class="code"><pre class="code literal-block">$<span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">something</span><span class="ss">()</span><span class="c1">;</span>
<span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="nv">empty</span><span class="ss">(</span>$<span class="nv">x</span><span class="ss">))</span><span class="w"> </span>…
</pre></div>

<p>and this:</p>
<div class="code"><pre class="code literal-block">$<span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">something</span><span class="ss">()</span><span class="c1">;</span>
<span class="k">if</span><span class="w"> </span><span class="ss">(</span><span class="o">!</span>$<span class="nv">x</span><span class="ss">)</span><span class="w"> </span>…
</pre></div>

<p>has <strong>always the same result, in all cases, for all datatypes</strong> (because <code>$x</code>
is defined <code>empty()</code> is redundant).</p>
<p>Return value from the method always exists (even if you don't have <code>return</code>
statement, return value exists and contains <code>null</code>). Therefore:</p>
<div class="code"><pre class="code literal-block"><span class="nf">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">empty</span><span class="p">(</span><span class="err">$</span><span class="n">r</span><span class="o">-&gt;</span><span class="n">getError</span><span class="p">()))</span>
</pre></div>

<p>is logically equivalent to:</p>
<div class="code"><pre class="code literal-block"><span class="nf">if</span><span class="w"> </span><span class="p">(</span><span class="err">$</span><span class="n">r</span><span class="o">-&gt;</span><span class="n">getError</span><span class="p">())</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<blockquote>
<p><strong>Note:</strong> This is a very high voted answer with a high visibility, but
please note that it promotes bad, unnecessary coding practices! See
@Kornel's answer for the correct way.</p>
<p><strong>Note #2:</strong> I endorse the suggestions to use @Kornel's answer. When I wrote
this answer three years ago, I merely meant to explain the nature of the
error, not necessarily endorse the alternative. The code snippet below is
not recommended.</p>
</blockquote>
<hr>
<p>It's a limitation of empty() in PHP versions below 5.5.</p>
<blockquote>
<p>Note: empty() only checks variables as anything else will result in a parse
error. In other words, the following will not work: empty(trim($name)).</p>
</blockquote>
<p>You'd have to change to this</p>
<div class="code"><pre class="code literal-block"><span class="c1">// Not recommended, just illustrates the issue</span>
<span class="no">$</span><span class="n">err</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="no">$</span><span class="n">r</span><span class="o">-&gt;</span><span class="n">getError</span><span class="p">();</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span>!<span class="n">empty</span><span class="p">(</span><span class="no">$</span><span class="n">err</span><span class="p">))</span>
</pre></div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/php/" rel="tag">php</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../how-to-do-a-deep-comparison-between-2-objects-with-lodash/" rel="prev" title="How to do a deep comparison between 2 objects with lodash?">Previous post</a>
            </li>
            <li class="next">
                <a href="../how-to-abort-a-stash-pop/" rel="next" title="How to abort a stash pop?">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="../../assets/js/search.js"></script>
</body>
</html>
