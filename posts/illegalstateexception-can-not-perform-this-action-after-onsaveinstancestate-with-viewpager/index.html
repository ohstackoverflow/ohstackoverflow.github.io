<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>IllegalStateException: Can not perform this action after onSaveInstanceState with ViewPager | StackOverflow Snapshot</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/posts/illegalstateexception-can-not-perform-this-action-after-onsaveinstancestate-with-viewpager/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Arya">
<link rel="prev" href="../getting-attributes-of-enum-s-value/" title="Getting attributes of Enum's value" type="text/html">
<link rel="next" href="../difference-between-jar-and-war-in-java/" title="Difference between jar and war in Java" type="text/html">
<meta property="og:site_name" content="StackOverflow Snapshot">
<meta property="og:title" content="IllegalStateException: Can not perform this action after onSaveInstanc">
<meta property="og:url" content="https://ohstackoverflow.netlify.app/posts/illegalstateexception-can-not-perform-this-action-after-onsaveinstancestate-with-viewpager/">
<meta property="og:description" content="I'm getting user reports from my app in the market, delivering the following
exception:
java.lang.IllegalStateException: Can not perform this action after onSaveInstanceState
at android.app.FragmentMa">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-02-18T04:21:35+08:00">
<meta property="article:tag" content="android">
<meta property="article:tag" content="android-fragments">
<meta property="article:tag" content="android-viewpager">
<meta property="article:tag" content="fragmenttransaction">
<meta property="article:tag" content="illegalstateexception">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">IllegalStateException: Can not perform this action after onSaveInstanceState with ViewPager</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T04:21:35+08:00" itemprop="datePublished" title="2023-02-18 04:21">2023-02-18 04:21</time></a>
            </p>
            

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>I'm getting user reports from my app in the market, delivering the following
exception:</p>
<div class="code"><pre class="code literal-block"><span class="nv">java</span>.<span class="nv">lang</span>.<span class="nv">IllegalStateException</span>:<span class="w"> </span><span class="nv">Can</span><span class="w"> </span><span class="nv">not</span><span class="w"> </span><span class="nv">perform</span><span class="w"> </span><span class="nv">this</span><span class="w"> </span><span class="nv">action</span><span class="w"> </span><span class="nv">after</span><span class="w"> </span><span class="nv">onSaveInstanceState</span>
<span class="nv">at</span><span class="w"> </span><span class="nv">android</span>.<span class="nv">app</span>.<span class="nv">FragmentManagerImpl</span>.<span class="nv">checkStateLoss</span><span class="ss">(</span><span class="nv">FragmentManager</span>.<span class="nv">java</span>:<span class="mi">1109</span><span class="ss">)</span>
<span class="nv">at</span><span class="w"> </span><span class="nv">android</span>.<span class="nv">app</span>.<span class="nv">FragmentManagerImpl</span>.<span class="nv">popBackStackImmediate</span><span class="ss">(</span><span class="nv">FragmentManager</span>.<span class="nv">java</span>:<span class="mi">399</span><span class="ss">)</span>
<span class="nv">at</span><span class="w"> </span><span class="nv">android</span>.<span class="nv">app</span>.<span class="nv">Activity</span>.<span class="nv">onBackPressed</span><span class="ss">(</span><span class="nv">Activity</span>.<span class="nv">java</span>:<span class="mi">2066</span><span class="ss">)</span>
<span class="nv">at</span><span class="w"> </span><span class="nv">android</span>.<span class="nv">app</span>.<span class="nv">Activity</span>.<span class="nv">onKeyUp</span><span class="ss">(</span><span class="nv">Activity</span>.<span class="nv">java</span>:<span class="mi">2044</span><span class="ss">)</span>
<span class="nv">at</span><span class="w"> </span><span class="nv">android</span>.<span class="nv">view</span>.<span class="nv">KeyEvent</span>.<span class="nv">dispatch</span><span class="ss">(</span><span class="nv">KeyEvent</span>.<span class="nv">java</span>:<span class="mi">2529</span><span class="ss">)</span>
<span class="nv">at</span><span class="w"> </span><span class="nv">android</span>.<span class="nv">app</span>.<span class="nv">Activity</span>.<span class="nv">dispatchKeyEvent</span><span class="ss">(</span><span class="nv">Activity</span>.<span class="nv">java</span>:<span class="mi">2274</span><span class="ss">)</span>
<span class="nv">at</span><span class="w"> </span><span class="nv">com</span>.<span class="nv">android</span>.<span class="nv">internal</span>.<span class="nv">policy</span>.<span class="nv">impl</span>.<span class="nv">PhoneWindow</span><span class="mh">$Dec</span><span class="nv">orView</span>.<span class="nv">dispatchKeyEvent</span><span class="ss">(</span><span class="nv">PhoneWindow</span>.<span class="nv">java</span>:<span class="mi">1803</span><span class="ss">)</span>
<span class="nv">at</span><span class="w"> </span><span class="nv">android</span>.<span class="nv">view</span>.<span class="nv">ViewGroup</span>.<span class="nv">dispatchKeyEvent</span><span class="ss">(</span><span class="nv">ViewGroup</span>.<span class="nv">java</span>:<span class="mi">1112</span><span class="ss">)</span>
<span class="nv">at</span><span class="w"> </span><span class="nv">android</span>.<span class="nv">view</span>.<span class="nv">ViewGroup</span>.<span class="nv">dispatchKeyEvent</span><span class="ss">(</span><span class="nv">ViewGroup</span>.<span class="nv">java</span>:<span class="mi">1112</span><span class="ss">)</span>
<span class="nv">at</span><span class="w"> </span><span class="nv">android</span>.<span class="nv">view</span>.<span class="nv">ViewGroup</span>.<span class="nv">dispatchKeyEvent</span><span class="ss">(</span><span class="nv">ViewGroup</span>.<span class="nv">java</span>:<span class="mi">1112</span><span class="ss">)</span>
<span class="nv">at</span><span class="w"> </span><span class="nv">com</span>.<span class="nv">android</span>.<span class="nv">internal</span>.<span class="nv">policy</span>.<span class="nv">impl</span>.<span class="nv">PhoneWindow</span><span class="mh">$Dec</span><span class="nv">orView</span>.<span class="nv">superDispatchKeyEvent</span><span class="ss">(</span><span class="nv">PhoneWindow</span>.<span class="nv">java</span>:<span class="mi">1855</span><span class="ss">)</span>
<span class="nv">at</span><span class="w"> </span><span class="nv">com</span>.<span class="nv">android</span>.<span class="nv">internal</span>.<span class="nv">policy</span>.<span class="nv">impl</span>.<span class="nv">PhoneWindow</span>.<span class="nv">superDispatchKeyEvent</span><span class="ss">(</span><span class="nv">PhoneWindow</span>.<span class="nv">java</span>:<span class="mi">1277</span><span class="ss">)</span>
<span class="nv">at</span><span class="w"> </span><span class="nv">android</span>.<span class="nv">app</span>.<span class="nv">Activity</span>.<span class="nv">dispatchKeyEvent</span><span class="ss">(</span><span class="nv">Activity</span>.<span class="nv">java</span>:<span class="mi">2269</span><span class="ss">)</span>
<span class="nv">at</span><span class="w"> </span><span class="nv">com</span>.<span class="nv">android</span>.<span class="nv">internal</span>.<span class="nv">policy</span>.<span class="nv">impl</span>.<span class="nv">PhoneWindow</span><span class="mh">$Dec</span><span class="nv">orView</span>.<span class="nv">dispatchKeyEvent</span><span class="ss">(</span><span class="nv">PhoneWindow</span>.<span class="nv">java</span>:<span class="mi">1803</span><span class="ss">)</span>
<span class="nv">at</span><span class="w"> </span><span class="nv">android</span>.<span class="nv">view</span>.<span class="nv">ViewGroup</span>.<span class="nv">dispatchKeyEvent</span><span class="ss">(</span><span class="nv">ViewGroup</span>.<span class="nv">java</span>:<span class="mi">1112</span><span class="ss">)</span>
<span class="nv">at</span><span class="w"> </span><span class="nv">android</span>.<span class="nv">view</span>.<span class="nv">ViewGroup</span>.<span class="nv">dispatchKeyEvent</span><span class="ss">(</span><span class="nv">ViewGroup</span>.<span class="nv">java</span>:<span class="mi">1112</span><span class="ss">)</span>
<span class="nv">at</span><span class="w"> </span><span class="nv">android</span>.<span class="nv">view</span>.<span class="nv">ViewGroup</span>.<span class="nv">dispatchKeyEvent</span><span class="ss">(</span><span class="nv">ViewGroup</span>.<span class="nv">java</span>:<span class="mi">1112</span><span class="ss">)</span>
<span class="nv">at</span><span class="w"> </span><span class="nv">android</span>.<span class="nv">view</span>.<span class="nv">ViewGroup</span>.<span class="nv">dispatchKeyEvent</span><span class="ss">(</span><span class="nv">ViewGroup</span>.<span class="nv">java</span>:<span class="mi">1112</span><span class="ss">)</span>
<span class="nv">at</span><span class="w"> </span><span class="nv">android</span>.<span class="nv">widget</span>.<span class="nv">TabHost</span>.<span class="nv">dispatchKeyEvent</span><span class="ss">(</span><span class="nv">TabHost</span>.<span class="nv">java</span>:<span class="mi">297</span><span class="ss">)</span>
<span class="nv">at</span><span class="w"> </span><span class="nv">android</span>.<span class="nv">view</span>.<span class="nv">ViewGroup</span>.<span class="nv">dispatchKeyEvent</span><span class="ss">(</span><span class="nv">ViewGroup</span>.<span class="nv">java</span>:<span class="mi">1112</span><span class="ss">)</span>
<span class="nv">at</span><span class="w"> </span><span class="nv">android</span>.<span class="nv">view</span>.<span class="nv">ViewGroup</span>.<span class="nv">dispatchKeyEvent</span><span class="ss">(</span><span class="nv">ViewGroup</span>.<span class="nv">java</span>:<span class="mi">1112</span><span class="ss">)</span>
<span class="nv">at</span><span class="w"> </span><span class="nv">android</span>.<span class="nv">view</span>.<span class="nv">ViewGroup</span>.<span class="nv">dispatchKeyEvent</span><span class="ss">(</span><span class="nv">ViewGroup</span>.<span class="nv">java</span>:<span class="mi">1112</span><span class="ss">)</span>
<span class="nv">at</span><span class="w"> </span><span class="nv">com</span>.<span class="nv">android</span>.<span class="nv">internal</span>.<span class="nv">policy</span>.<span class="nv">impl</span>.<span class="nv">PhoneWindow</span><span class="mh">$Dec</span><span class="nv">orView</span>.<span class="nv">superDispatchKeyEvent</span><span class="ss">(</span><span class="nv">PhoneWindow</span>.<span class="nv">java</span>:<span class="mi">1855</span><span class="ss">)</span>
<span class="nv">at</span><span class="w"> </span><span class="nv">com</span>.<span class="nv">android</span>.<span class="nv">internal</span>.<span class="nv">policy</span>.<span class="nv">impl</span>.<span class="nv">PhoneWindow</span>.<span class="nv">superDispatchKeyEvent</span><span class="ss">(</span><span class="nv">PhoneWindow</span>.<span class="nv">java</span>:<span class="mi">1277</span><span class="ss">)</span>
<span class="nv">at</span><span class="w"> </span><span class="nv">android</span>.<span class="nv">app</span>.<span class="nv">Activity</span>.<span class="nv">dispatchKeyEvent</span><span class="ss">(</span><span class="nv">Activity</span>.<span class="nv">java</span>:<span class="mi">2269</span><span class="ss">)</span>
<span class="nv">at</span><span class="w"> </span><span class="nv">com</span>.<span class="nv">android</span>.<span class="nv">internal</span>.<span class="nv">policy</span>.<span class="nv">impl</span>.<span class="nv">PhoneWindow</span><span class="mh">$Dec</span><span class="nv">orView</span>.<span class="nv">dispatchKeyEvent</span><span class="ss">(</span><span class="nv">PhoneWindow</span>.<span class="nv">java</span>:<span class="mi">1803</span><span class="ss">)</span>
<span class="nv">at</span><span class="w"> </span><span class="nv">android</span>.<span class="nv">view</span>.<span class="nv">ViewRoot</span>.<span class="nv">deliverKeyEventPostIme</span><span class="ss">(</span><span class="nv">ViewRoot</span>.<span class="nv">java</span>:<span class="mi">2880</span><span class="ss">)</span>
<span class="nv">at</span><span class="w"> </span><span class="nv">android</span>.<span class="nv">view</span>.<span class="nv">ViewRoot</span>.<span class="nv">handleFinishedEvent</span><span class="ss">(</span><span class="nv">ViewRoot</span>.<span class="nv">java</span>:<span class="mi">2853</span><span class="ss">)</span>
<span class="nv">at</span><span class="w"> </span><span class="nv">android</span>.<span class="nv">view</span>.<span class="nv">ViewRoot</span>.<span class="nv">handleMessage</span><span class="ss">(</span><span class="nv">ViewRoot</span>.<span class="nv">java</span>:<span class="mi">2028</span><span class="ss">)</span>
<span class="nv">at</span><span class="w"> </span><span class="nv">android</span>.<span class="nv">os</span>.<span class="nv">Handler</span>.<span class="nv">dispatchMessage</span><span class="ss">(</span><span class="nv">Handler</span>.<span class="nv">java</span>:<span class="mi">99</span><span class="ss">)</span>
<span class="nv">at</span><span class="w"> </span><span class="nv">android</span>.<span class="nv">os</span>.<span class="nv">Looper</span>.<span class="k">loop</span><span class="ss">(</span><span class="nv">Looper</span>.<span class="nv">java</span>:<span class="mi">132</span><span class="ss">)</span>
<span class="nv">at</span><span class="w"> </span><span class="nv">android</span>.<span class="nv">app</span>.<span class="nv">ActivityThread</span>.<span class="nv">main</span><span class="ss">(</span><span class="nv">ActivityThread</span>.<span class="nv">java</span>:<span class="mi">4028</span><span class="ss">)</span>
<span class="nv">at</span><span class="w"> </span><span class="nv">java</span>.<span class="nv">lang</span>.<span class="nv">reflect</span>.<span class="nv">Method</span>.<span class="nv">invokeNative</span><span class="ss">(</span><span class="nv">Native</span><span class="w"> </span><span class="nv">Method</span><span class="ss">)</span>
<span class="nv">at</span><span class="w"> </span><span class="nv">java</span>.<span class="nv">lang</span>.<span class="nv">reflect</span>.<span class="nv">Method</span>.<span class="nv">invoke</span><span class="ss">(</span><span class="nv">Method</span>.<span class="nv">java</span>:<span class="mi">491</span><span class="ss">)</span>
<span class="nv">at</span><span class="w"> </span><span class="nv">com</span>.<span class="nv">android</span>.<span class="nv">internal</span>.<span class="nv">os</span>.<span class="nv">ZygoteInit</span>$<span class="nv">MethodAndArgsCaller</span>.<span class="nv">run</span><span class="ss">(</span><span class="nv">ZygoteInit</span>.<span class="nv">java</span>:<span class="mi">844</span><span class="ss">)</span>
<span class="nv">at</span><span class="w"> </span><span class="nv">com</span>.<span class="nv">android</span>.<span class="nv">internal</span>.<span class="nv">os</span>.<span class="nv">ZygoteInit</span>.<span class="nv">main</span><span class="ss">(</span><span class="nv">ZygoteInit</span>.<span class="nv">java</span>:<span class="mi">602</span><span class="ss">)</span>
<span class="nv">at</span><span class="w"> </span><span class="nv">dalvik</span>.<span class="nv">system</span>.<span class="nv">NativeStart</span>.<span class="nv">main</span><span class="ss">(</span><span class="nv">Native</span><span class="w"> </span><span class="nv">Method</span><span class="ss">)</span>
</pre></div>

<p>Apparently it has something to do with a FragmentManager, which I don't use.
The stacktrace doesn't show any of my own classes, so I have no idea where
this exception occurs and how to prevent it.</p>
<p>For the record: I have a tabhost, and in each tab there is a ActivityGroup
switching between Activities.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Please check my answer here. Basically I just had to :</p>
<div class="code"><pre class="code literal-block"><span class="nv">@Override</span>
<span class="n">protected</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="n">onSaveInstanceState</span><span class="p">(</span><span class="n">Bundle</span><span class="w"> </span><span class="n">outState</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="o">//</span><span class="k">No</span><span class="w"> </span><span class="k">call</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">super</span><span class="p">().</span><span class="w"> </span><span class="n">Bug</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">API</span><span class="w"> </span><span class="k">Level</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">11.</span>
<span class="err">}</span>
</pre></div>

<p>Don't make the call to <code>super()</code> on the <code>saveInstanceState</code> method. This was
messing things up...</p>
<p>This is a known bug in the support package.</p>
<p>If you need to save the instance and add something to your <code>outState</code> <code>Bundle</code>
you can use the following:</p>
<div class="code"><pre class="code literal-block"><span class="nv">@Override</span>
<span class="n">protected</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="n">onSaveInstanceState</span><span class="p">(</span><span class="n">Bundle</span><span class="w"> </span><span class="n">outState</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="n">outState</span><span class="p">.</span><span class="n">putString</span><span class="p">(</span><span class="ss">"WORKAROUND_FOR_BUG_19917_KEY"</span><span class="p">,</span><span class="w"> </span><span class="ss">"WORKAROUND_FOR_BUG_19917_VALUE"</span><span class="p">);</span>
<span class="w">    </span><span class="n">super</span><span class="p">.</span><span class="n">onSaveInstanceState</span><span class="p">(</span><span class="n">outState</span><span class="p">);</span>
<span class="err">}</span>
</pre></div>

<p>In the end the proper solution was (as seen in the comments) to use :</p>
<div class="code"><pre class="code literal-block">transaction.commitAllowingStateLoss();
</pre></div>

<p>when adding or performing the <code>FragmentTransaction</code> that was causing the
<code>Exception</code>.</p>
<p><br></p>
<h3>Suggest</h3>
<p>There are many related problems with a similar error message. Check the second
line of this particular stack trace. This exception is specifically related to
the call to <code>FragmentManagerImpl.popBackStackImmediate</code>.</p>
<p>This method call, like <code>popBackStack</code>, will <em>always</em> fail with
<code>IllegalStateException</code> if the session state has already been saved. Check the
source. There is nothing you can do to stop this exception being thrown.</p>
<ul>
<li>Removing the call to <code>super.onSaveInstanceState</code> will not help. </li>
<li>Creating the Fragment with <code>commitAllowingStateLoss</code> will not help.</li>
</ul>
<p>Here's how I observed the problem:</p>
<ul>
<li>There's a form with a submit button.</li>
<li>When the button is clicked a dialog is created and an async process starts.</li>
<li>The user clicks the home key before the process is finished - <code>onSaveInstanceState</code> is called.</li>
<li>The process completes, a callback is made and <code>popBackStackImmediate</code> is attempted.</li>
<li>
<code>IllegalStateException</code> is thrown.</li>
</ul>
<p>Here's what I did to solve it:</p>
<p>As it is not possible to avoid the <code>IllegalStateException</code> in the callback,
catch &amp; ignore it.</p>
<div class="code"><pre class="code literal-block"><span class="nv">try</span><span class="w"> </span>{
<span class="w">    </span><span class="nv">activity</span>.<span class="nv">getSupportFragmentManager</span><span class="ss">()</span>.<span class="nv">popBackStackImmediate</span><span class="ss">(</span><span class="nv">name</span><span class="ss">)</span><span class="c1">;</span>
}<span class="w"> </span><span class="nv">catch</span><span class="w"> </span><span class="ss">(</span><span class="nv">IllegalStateException</span><span class="w"> </span><span class="nv">ignored</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="nv">There</span><span class="err">'s no way to avoid getting this if saveInstanceState has already been called.</span>
<span class="err">}</span>
</pre></div>

<p>This is enough to stop the app from crashing. But now the user will restore
the app and see that the button they thought they'd pressed hasn't been
pressed at all (they think). The form fragment is still showing!</p>
<p>To fix this, when the dialog is created, make some state to indicate the
process has started.</p>
<div class="code"><pre class="code literal-block"><span class="nv">progressDialog</span>.<span class="k">show</span><span class="ss">(</span><span class="nv">fragmentManager</span>,<span class="w"> </span><span class="nv">TAG</span><span class="ss">)</span><span class="c1">;</span>
<span class="nv">submitPressed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">true</span><span class="c1">;</span>
</pre></div>

<p>And save this state in the bundle.</p>
<div class="code"><pre class="code literal-block"><span class="nv">@Override</span>
<span class="k">public</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="n">onSaveInstanceState</span><span class="p">(</span><span class="n">Bundle</span><span class="w"> </span><span class="n">outState</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="p">...</span>
<span class="w">    </span><span class="n">outState</span><span class="p">.</span><span class="n">putBoolean</span><span class="p">(</span><span class="n">SUBMIT_PRESSED</span><span class="p">,</span><span class="w"> </span><span class="n">submitPressed</span><span class="p">);</span>
<span class="err">}</span>
</pre></div>

<p>Don't forget to load it back again in <code>onViewCreated</code></p>
<p>Then, when resuming, rollback the fragments if submit was previously
attempted. This prevents the user from coming back to what seems like an un-
submitted form.</p>
<div class="code"><pre class="code literal-block"><span class="nv">@Override</span>
<span class="k">public</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="n">onResume</span><span class="p">()</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="n">super</span><span class="p">.</span><span class="n">onResume</span><span class="p">();</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">submitPressed</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="o">//</span><span class="w"> </span><span class="k">no</span><span class="w"> </span><span class="n">need</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">try</span><span class="o">-</span><span class="k">catch</span><span class="w"> </span><span class="n">this</span><span class="p">,</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="k">are</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">callback</span>
<span class="w">        </span><span class="n">activity</span><span class="p">.</span><span class="n">getSupportFragmentManager</span><span class="p">().</span><span class="n">popBackStackImmediate</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<span class="w">        </span><span class="n">submitPressed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">false</span><span class="p">;</span>
<span class="w">    </span><span class="err">}</span>
<span class="err">}</span>
</pre></div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/android/" rel="tag">android</a></li>
            <li><a class="tag p-category" href="../../categories/android-fragments/" rel="tag">android-fragments</a></li>
            <li><a class="tag p-category" href="../../categories/android-viewpager/" rel="tag">android-viewpager</a></li>
            <li><a class="tag p-category" href="../../categories/fragmenttransaction/" rel="tag">fragmenttransaction</a></li>
            <li><a class="tag p-category" href="../../categories/illegalstateexception/" rel="tag">illegalstateexception</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../getting-attributes-of-enum-s-value/" rel="prev" title="Getting attributes of Enum's value">Previous post</a>
            </li>
            <li class="next">
                <a href="../difference-between-jar-and-war-in-java/" rel="next" title="Difference between jar and war in Java">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="../../assets/js/search.js"></script>
</body>
</html>
