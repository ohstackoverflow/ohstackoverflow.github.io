<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>How do I replace all occurrences of a string in JavaScript? | StackOverflow Snapshot</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/posts/how-do-i-replace-all-occurrences-of-a-string-in-javascript/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Arya">
<link rel="prev" href="../how-do-i-push-a-new-local-branch-to-a-remote-git-repository-and-track-it-too/" title="How do I push a new local branch to a remote Git repository and track it too?" type="text/html">
<link rel="next" href="../reset-local-repository-branch-to-be-just-like-remote-repository-head/" title="Reset local repository branch to be just like remote repository HEAD" type="text/html">
<meta property="og:site_name" content="StackOverflow Snapshot">
<meta property="og:title" content="How do I replace all occurrences of a string in JavaScript?">
<meta property="og:url" content="https://ohstackoverflow.netlify.app/posts/how-do-i-replace-all-occurrences-of-a-string-in-javascript/">
<meta property="og:description" content="Given a string:
s = &quot;Test abc test test abc test test test abc test test abc&quot;;


This seems to only remove the first occurrence of abc in the string above:
s = s.replace('abc', '');


How do I replace">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-02-16T18:41:03+08:00">
<meta property="article:tag" content="javascript">
<meta property="article:tag" content="replace">
<meta property="article:tag" content="string">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">How do I replace all occurrences of a string in JavaScript?</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2023-02-16T18:41:03+08:00" itemprop="datePublished" title="2023-02-16 18:41">2023-02-16 18:41</time></a>
            </p>
            

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>Given a string:</p>
<div class="code"><pre class="code literal-block">s = "Test abc test test abc test test test abc test test abc";
</pre></div>

<p>This seems to only remove the first occurrence of <code>abc</code> in the string above:</p>
<div class="code"><pre class="code literal-block">s = s.replace('abc', '');
</pre></div>

<p>How do I replace <em>all</em> occurrences of it?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>In the latest versions of most popular browsers, you can use <code>replaceAll</code> as
shown here:</p>
<div class="code"><pre class="code literal-block"><span class="n">let</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"1 abc 2 abc 3"</span><span class="p">.</span><span class="n">replaceAll</span><span class="p">(</span><span class="s2">"abc"</span><span class="p">,</span><span class="w"> </span><span class="s2">"xyz"</span><span class="p">);</span>
<span class="o">//</span><span class="w"> </span><span class="n n-Quoted">`result`</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="s2">"1 xyz 2 xyz 3"</span>
</pre></div>

<p>But check Can I use or another compatibility table first to make sure the
browsers you're targeting have added support for it first.</p>
<hr>
<p>For Node.js and compatibility with older/non-current browsers:</p>
<p><strong>Note: Don't use the following solution in performance critical code.</strong></p>
<p>As an alternative to regular expressions for a simple literal string, you
could use</p>
<div class="code"><pre class="code literal-block">str = "Test abc test test abc test...".split("abc").join("");
</pre></div>

<p>The general pattern is</p>
<div class="code"><pre class="code literal-block">str.split(search).join(replacement)
</pre></div>

<p>This used to be faster in some cases than using <code>replaceAll</code> and a regular
expression, but that doesn't seem to be the case anymore in modern browsers.</p>
<p>Benchmark: https://jsben.ch/TZYzj</p>
<h4>Conclusion:</h4>
<p>If you have a performance-critical use case (e.g., processing hundreds of
strings), use the regular expression method. But for most typical use cases,
this is well worth not having to worry about special characters.</p>
<p><br></p>
<h3>Suggest</h3>
<p>For the sake of completeness, I got to thinking about which method I should
use to do this. There are basically two ways to do this as suggested by the
other answers on this page.</p>
<p><strong>Note:</strong> In general, extending the built-in prototypes in JavaScript is
generally not recommended. I am providing as extensions on the String
prototype simply for purposes of illustration, showing different
implementations of a hypothetical standard method on the <code>String</code> built-in
prototype.</p>
<hr>
<h4>Regular Expression Based Implementation</h4>
<div class="code"><pre class="code literal-block"><span class="nb nb-Type">String</span><span class="o">.</span><span class="n">prototype</span><span class="o">.</span><span class="n">replaceAll</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">function</span><span class="p">(</span><span class="n">search</span><span class="p">,</span><span class="w"> </span><span class="n">replacement</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">this</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">target</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">new</span><span class="w"> </span><span class="n">RegExp</span><span class="p">(</span><span class="n">search</span><span class="p">,</span><span class="w"> </span><span class="s1">'g'</span><span class="p">),</span><span class="w"> </span><span class="n">replacement</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

<h4>Split and Join (Functional) Implementation</h4>
<div class="code"><pre class="code literal-block"><span class="nb nb-Type">String</span><span class="o">.</span><span class="n">prototype</span><span class="o">.</span><span class="n">replaceAll</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">function</span><span class="p">(</span><span class="n">search</span><span class="p">,</span><span class="w"> </span><span class="n">replacement</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">this</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">target</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">search</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">replacement</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

<hr>
<p>Not knowing too much about how regular expressions work behind the scenes in
terms of efficiency, I tended to lean toward the split and join implementation
in the past without thinking about performance. When I did wonder which was
more efficient, and by what margin, I used it as an excuse to find out.</p>
<p>On my Chrome Windows 8 machine, <strong>the regular expression based implementation
is the fastest</strong> , with the <strong>split and join implementation being 53%
slower</strong>. Meaning the regular expressions are twice as fast for the lorem
ipsum input I used.</p>
<p>Check out this <strong>benchmark</strong> running these two implementations against each
other.</p>
<hr>
<p>As noted in the comment below by @ThomasLeduc and others, there could be an
issue with the regular expression-based implementation if <code>search</code> contains
certain characters which are reserved as special characters in regular
expressions. The implementation assumes that the caller will escape the string
beforehand or will only pass strings that are without the characters in the
table in <em>Regular Expressions</em> (MDN).</p>
<p>MDN also provides an implementation to escape our strings. It would be nice if
this was also standardized as <code>RegExp.escape(str)</code>, but alas, it does not
exist:</p>
<div class="code"><pre class="code literal-block">function<span class="w"> </span>escapeRegExp(str)<span class="w"> </span>{
<span class="w">  </span>return<span class="w"> </span>str.replace(/[.*+?^<span class="cp">${</span><span class="p">}()</span><span class="o">|</span><span class="p">[</span>\<span class="p">]</span>\\<span class="p">]</span><span class="o">/</span><span class="n">g</span><span class="p">,</span> <span class="s2">"</span><span class="se">\\</span><span class="s2">$&amp;"</span><span class="p">);</span> <span class="o">//</span> <span class="err">$</span><span class="o">&amp;</span> <span class="n">means</span> <span class="n">the</span> <span class="n">whole</span> <span class="n">matched</span> <span class="n">string</span>
<span class="cp">}</span>
</pre></div>

<p>We could call <code>escapeRegExp</code> within our <code>String.prototype.replaceAll</code>
implementation, however, I'm not sure how much this will affect the
performance (potentially even for strings for which the escape is not needed,
like all alphanumeric strings).</p>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/javascript/" rel="tag">javascript</a></li>
            <li><a class="tag p-category" href="../../categories/replace/" rel="tag">replace</a></li>
            <li><a class="tag p-category" href="../../categories/string/" rel="tag">string</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../how-do-i-push-a-new-local-branch-to-a-remote-git-repository-and-track-it-too/" rel="prev" title="How do I push a new local branch to a remote Git repository and track it too?">Previous post</a>
            </li>
            <li class="next">
                <a href="../reset-local-repository-branch-to-be-just-like-remote-repository-head/" rel="next" title="Reset local repository branch to be just like remote repository HEAD">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="../../assets/js/search.js"></script>
</body>
</html>
