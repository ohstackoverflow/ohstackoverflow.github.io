<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>How do I debug "Error: spawn ENOENT" on node.js? | StackOverflow Snapshot</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/posts/how-do-i-debug-error-spawn-enoent-on-node-js/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Arya">
<link rel="prev" href="../what-is-the-best-data-type-to-use-for-money-in-c/" title="What is the best data type to use for money in C#?" type="text/html">
<link rel="next" href="../how-to-mark-up-phone-numbers/" title="How to mark-up phone numbers?" type="text/html">
<meta property="og:site_name" content="StackOverflow Snapshot">
<meta property="og:title" content='How do I debug "Error: spawn ENOENT" on node.js?'>
<meta property="og:url" content="https://ohstackoverflow.netlify.app/posts/how-do-i-debug-error-spawn-enoent-on-node-js/">
<meta property="og:description" content="When I get the following error:
events.js:72
        throw er; // Unhandled 'error' event
              ^
Error: spawn ENOENT
    at errnoException (child_process.js:1000:11)
    at Process.ChildProce">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-03-03T05:39:54+08:00">
<meta property="article:tag" content="child-process">
<meta property="article:tag" content="debugging">
<meta property="article:tag" content="error-handling">
<meta property="article:tag" content="node.js">
<meta property="article:tag" content="spawn">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">How do I debug "Error: spawn ENOENT" on node.js?</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T05:39:54+08:00" itemprop="datePublished" title="2023-03-03 05:39">2023-03-03 05:39</time></a>
            </p>
            

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <h3>When I get the following error:</h3>
<div class="code"><pre class="code literal-block"><span class="nt">events</span><span class="p">.</span><span class="nc">js</span><span class="p">:</span><span class="nd">72</span>
<span class="w">        </span><span class="nt">throw</span><span class="w"> </span><span class="nt">er</span><span class="o">;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nt">Unhandled</span><span class="w"> </span><span class="s1">'error'</span><span class="w"> </span><span class="nt">event</span>
<span class="w">              </span><span class="o">^</span>
<span class="nt">Error</span><span class="o">:</span><span class="w"> </span><span class="nt">spawn</span><span class="w"> </span><span class="nt">ENOENT</span>
<span class="w">    </span><span class="nt">at</span><span class="w"> </span><span class="nt">errnoException</span><span class="w"> </span><span class="o">(</span><span class="nt">child_process</span><span class="p">.</span><span class="nc">js</span><span class="p">:</span><span class="nd">1000</span><span class="p">:</span><span class="nd">11</span><span class="o">)</span>
<span class="w">    </span><span class="nt">at</span><span class="w"> </span><span class="nt">Process</span><span class="p">.</span><span class="nc">ChildProcess</span><span class="p">.</span><span class="nc">_handle</span><span class="p">.</span><span class="nc">onexit</span><span class="w"> </span><span class="o">(</span><span class="nt">child_process</span><span class="p">.</span><span class="nc">js</span><span class="p">:</span><span class="nd">791</span><span class="p">:</span><span class="nd">34</span><span class="o">)</span>
</pre></div>

<h3>What procedure can I follow to fix it?</h3>
<p><strong>Author note</strong> : Lots of issues with this error encouraged me to post this
question for future references.</p>
<p><strong>Related questions:</strong></p>
<ul>
<li>using spawn function with NODE_ENV=production</li>
<li>node.js child_process.spawn ENOENT error - only under supervisord</li>
<li>spawn ENOENT node.js error</li>
<li>https://stackoverflow.com/questions/27603713/nodejs-spawn-enoent-error-on-travis-calling-global-npm-package</li>
<li>Node JS - child_process spawn('npm install') in Grunt task results in ENOENT error</li>
<li>Running "foreman" task Fatal error: spawn ENOENT</li>
<li>unhandled error event in node js Error: spawn ENOENT at errnoException (child_process.js:975:11)</li>
<li>Node.js SpookyJS: error executing hello.js</li>
<li>https://stackoverflow.com/questions/26572214/run-grunt-on-a-directory-nodewebkit</li>
<li>Run exe file with Child Process NodeJS</li>
<li>Node: child_process.spawn not working on Java even though it's in the path (ENOENT)</li>
<li>spawn ENOENT error with NodeJS (PYTHON related)</li>
<li>image resizing is not working in node.js (partial.js) (non-installed dependency)</li>
<li>npm install error ENOENT (build dependency problem)</li>
<li>Cannot install node.js - oracle module on Windows 7 (build dependency problem)</li>
<li>Error installing gulp using nodejs on windows (strange case)</li>
</ul>
<p><br><br></p>
<h2>Answer</h2>
<h2>How to research the spawn call raising the error:</h2>
<ul>
<li>Use NODE_DEBUG=child_process, Credits to @karl-richter. <em>Simple, quick, October 2019</em>
</li>
<li>Use a wrapper to decorate <code>child_process.spawn</code>, Credits to @jiaji-zhou. <em>Simple, quick, January 2015</em>
</li>
<li>Long procedure, credits to @laconbass. <em>Complex, time-cost, December 2014</em>
</li>
</ul>
<h2>Known, usual causes</h2>
<ol>
<li>
<p>Environment issues</p>
<ul>
<li>The command executable does not exist within the system (dependency not being installed). <em>see prominc's answer</em>
</li>
<li>The command executable does not exist within a directory of those specified by <code>PATH</code> environment variable.</li>
<li>The executable binary was compiled with uncompatible libraries. <em>see danilo-ramirez answer</em>
</li>
<li>
<p>Windows-only bugs/quirks</p>
</li>
<li>
<p>'.cmd' extension / shell: true. <em>see li-zheng answer</em></p>
</li>
<li>Administrator permisions. <em>see steve's answer</em>
</li>
<li>
<p>Wrong <code>spawn('command', ['--argument', 'list'], { cwd, env, ...opts })</code> usage</p>
</li>
<li>
<p>Specified working directory (<code>opts.cwd</code>) does not exist · <em>see leeroy-brun's answer</em></p>
</li>
<li>Argument list within command <code>String</code> <del><code>spawn('command --wrong --argument list')</code></del>
</li>
<li>Env vars within command string <del><code>spawn('ENV_VAR=WRONG command')</code></del>
</li>
<li>Argument list <code>Array</code> specified as <code>String</code> <del><code>spawn('cmd', '--argument list')</code></del>
</li>
<li>Unset <code>PATH</code> env variable <del><code>spawn('cmd', [], { env: { variable } }</code></del> =&gt; <code>spawn('cmd', [], { env: { ...process.env, variable } }</code>
</li>
</ul>
</li>
</ol>
<hr>
<blockquote>
<h3>There are 2 posible origins for <code>ENOENT</code>:</h3>
<ol>
<li>Code you are writing</li>
<li>Code you depend on
</li>
</ol>
<p>When origin is code you depend on, usual cause is an <strong>Environment Issue</strong>
(or windows quirk)</p>
</blockquote>
<hr>
<p><br></p>
<h3>Suggest</h3>
<h3>Step 1: Ensure <code>spawn</code> is called the right way</h3>
<p>First, review the docs for child_process.spawn( command, args, options ):</p>
<blockquote>
<p>Launches a new process with the given <code>command</code>, with command line arguments
in <code>args</code>. If omitted, <code>args</code> defaults to an empty Array.</p>
<p>The third argument is used to specify additional options, which defaults to:</p>
<p><code>{ cwd: undefined, env: process.env }</code></p>
<p>Use <code>env</code> to specify environment variables that will be visible to the new
process, the default is <code>process.env</code>.</p>
</blockquote>
<p><strong>Ensure you are not putting any command line arguments in<code>command</code> and the
whole <code>spawn</code> call is valid</strong>. Proceed to next step.</p>
<h3>Step 2: Identify the Event Emitter that emits the error event</h3>
<p>Search on your source code for each call to <code>spawn</code>, or <code>child_process.spawn</code>,
i.e.</p>
<div class="code"><pre class="code literal-block">spawn('some-command', [ '--help' ]);
</pre></div>

<p>and attach there an event listener for the 'error' event, so you get noticed
the exact Event Emitter that is throwing it as 'Unhandled'. After debugging,
that handler can be removed.</p>
<div class="code"><pre class="code literal-block">spawn('some-command', [ '--help' ])
  .on('error', function( err ){ throw err })
;
</pre></div>

<p>Execute and you should get the file path and line number where your 'error'
listener was registered. Something like:</p>
<div class="code"><pre class="code literal-block"><span class="o">/</span><span class="n">file</span><span class="o">/</span><span class="n">that</span><span class="o">/</span><span class="n">registers</span><span class="o">/</span><span class="n">the</span><span class="o">/</span><span class="n">error</span><span class="o">/</span><span class="n">listener</span><span class="p">.</span><span class="nl">js:</span><span class="mh">29</span>
<span class="w">      </span><span class="n">throw</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<span class="w">            </span><span class="o">^</span>
<span class="nl">Error:</span><span class="w"> </span><span class="n">spawn</span><span class="w"> </span><span class="n">ENOENT</span>
<span class="w">    </span><span class="n">at</span><span class="w"> </span><span class="n">errnoException</span><span class="w"> </span><span class="p">(</span><span class="n">child_process</span><span class="p">.</span><span class="nl">js:</span><span class="mh">1000</span><span class="o">:</span><span class="mh">11</span><span class="p">)</span>
<span class="w">    </span><span class="n">at</span><span class="w"> </span><span class="n">Process</span><span class="p">.</span><span class="n">ChildProcess</span><span class="p">.</span><span class="n">_handle</span><span class="p">.</span><span class="n">onexit</span><span class="w"> </span><span class="p">(</span><span class="n">child_process</span><span class="p">.</span><span class="nl">js:</span><span class="mh">791</span><span class="o">:</span><span class="mh">34</span><span class="p">)</span>
</pre></div>

<p>If the first two lines are still</p>
<div class="code"><pre class="code literal-block"><span class="nt">events</span><span class="p">.</span><span class="nc">js</span><span class="p">:</span><span class="nd">72</span>
<span class="w">        </span><span class="nt">throw</span><span class="w"> </span><span class="nt">er</span><span class="o">;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nt">Unhandled</span><span class="w"> </span><span class="s1">'error'</span><span class="w"> </span><span class="nt">event</span>
</pre></div>

<p>do this step again until they are not. <strong>You must identify the listener that
emits the error before going on next step.</strong></p>
<h3>Step 3: Ensure the environment variable <code>$PATH</code> is set</h3>
<p>There are two possible scenarios:</p>
<ol>
<li>You rely on the default <code>spawn</code> behaviour, so child process environment will be the same as <code>process.env</code>.</li>
<li>You are explicity passing an <code>env</code> object to <code>spawn</code> on the <code>options</code> argument.</li>
</ol>
<p><strong>In both scenarios, you must inspect the<code>PATH</code> key on the environment object
that the spawned child process will use.</strong></p>
<p><em>Example for scenario 1</em></p>
<div class="code"><pre class="code literal-block"><span class="c1">// inspect the PATH key on process.env</span>
<span class="n">console</span><span class="p">.</span><span class="nb">log</span><span class="p">(</span><span class="w"> </span><span class="n">process</span><span class="p">.</span><span class="n">env</span><span class="p">.</span><span class="n">PATH</span><span class="w"> </span><span class="p">);</span>
<span class="n">spawn</span><span class="p">(</span><span class="s">'some-command'</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="s">'--help'</span><span class="p">]);</span>
</pre></div>

<p><em>Example for scenario 2</em></p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">env</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getEnvKeyValuePairsSomeHow</span><span class="p">();</span>
<span class="o">//</span><span class="w"> </span><span class="n">inspect</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">PATH</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">env</span><span class="w"> </span><span class="n">object</span>
<span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="w"> </span><span class="n">env</span><span class="o">.</span><span class="n">PATH</span><span class="w"> </span><span class="p">);</span>
<span class="n">spawn</span><span class="p">(</span><span class="s1">'some-command'</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="s1">'--help'</span><span class="p">],</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">env</span><span class="p">:</span><span class="w"> </span><span class="n">env</span><span class="w"> </span><span class="p">});</span>
</pre></div>

<p><strong>The absence of<code>PATH</code> (i.e., it's <code>undefined</code>) will cause <code>spawn</code> to emit the
<code>ENOENT</code> error</strong>, as it will not be possible to locate any <code>command</code> unless
it's an absolute path to the executable file.</p>
<p><strong>When<code>PATH</code> is correctly set, proceed to next step.</strong> It should be a
directory, or a list of directories. Last case is the usual.</p>
<h3>Step 4: Ensure <code>command</code> exists on a directory of those defined in <code>PATH</code>
</h3>
<p><strong>Spawn may emit the<code>ENOENT</code> error if the filename <code>command</code> (i.e, 'some-
command') does not exist in at least one of the directories defined on
<code>PATH</code>.</strong></p>
<p>Locate the exact place of <code>command</code>. On most linux distributions, this can be
done from a terminal with the <code>which</code> command. It will tell you the absolute
path to the executable file (like above), or tell if it's not found.</p>
<p><em>Example usage of which and its output when a command is <strong>found</strong></em></p>
<div class="code"><pre class="code literal-block">&gt; which some-command
some-command is /usr/bin/some-command
</pre></div>

<p><em>Example usage of which and its output when a command is <strong>not found</strong></em></p>
<div class="code"><pre class="code literal-block">&gt; which some-command
bash: type: some-command: not found
</pre></div>

<p><strong>miss-installed programs are the most common cause for a <em>not found</em>
command.</strong> Refer to each command documentation if needed and install it.</p>
<p><strong>When command is a simple script file ensure it's accessible from a directory
on the<code>PATH</code>.</strong> If it's not, either move it to one or make a link to it.</p>
<p>Once you determine <code>PATH</code> is correctly set and <code>command</code> is accessible from
it, you should be able to spawn your child process without <code>spawn ENOENT</code>
being thrown.</p>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/child-process/" rel="tag">child-process</a></li>
            <li><a class="tag p-category" href="../../categories/debugging/" rel="tag">debugging</a></li>
            <li><a class="tag p-category" href="../../categories/error-handling/" rel="tag">error-handling</a></li>
            <li><a class="tag p-category" href="../../categories/nodejs/" rel="tag">node.js</a></li>
            <li><a class="tag p-category" href="../../categories/spawn/" rel="tag">spawn</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../what-is-the-best-data-type-to-use-for-money-in-c/" rel="prev" title="What is the best data type to use for money in C#?">Previous post</a>
            </li>
            <li class="next">
                <a href="../how-to-mark-up-phone-numbers/" rel="next" title="How to mark-up phone numbers?">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="../../assets/js/search.js"></script>
</body>
</html>
