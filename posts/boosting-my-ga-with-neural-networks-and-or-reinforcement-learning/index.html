<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Boosting my GA with Neural Networks and/or Reinforcement Learning | StackOverflow Snapshot</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/posts/boosting-my-ga-with-neural-networks-and-or-reinforcement-learning/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Arya">
<link rel="prev" href="../implementing-a-pathfinding-in-a-2d-array/" title="Implementing A* pathfinding in a 2D array" type="text/html">
<link rel="next" href="../how-to-fix-premature-convergence-in-simple-ga-python/" title="How to fix premature convergence in simple GA (Python)?" type="text/html">
<meta property="og:site_name" content="StackOverflow Snapshot">
<meta property="og:title" content="Boosting my GA with Neural Networks and/or Reinforcement Learning">
<meta property="og:url" content="https://ohstackoverflow.netlify.app/posts/boosting-my-ga-with-neural-networks-and-or-reinforcement-learning/">
<meta property="og:description" content="As I have mentioned in previous questions I am writing a maze solving
application to help me learn about more theoretical CS subjects, after some
trouble I've got a Genetic Algorithm working that can ">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-02-28T03:57:35+08:00">
<meta property="article:tag" content="artificial-intelligence">
<meta property="article:tag" content="computer-science">
<meta property="article:tag" content="java">
<meta property="article:tag" content="neural-network">
<meta property="article:tag" content="theory">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Boosting my GA with Neural Networks and/or Reinforcement Learning</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2023-02-28T03:57:35+08:00" itemprop="datePublished" title="2023-02-28 03:57">2023-02-28 03:57</time></a>
            </p>
            

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>As I have mentioned in previous questions I am writing a maze solving
application to help me learn about more theoretical CS subjects, after some
trouble I've got a Genetic Algorithm working that can evolve a set of rules
(handled by boolean values) in order to find a good solution through a maze.</p>
<p>That being said, the GA alone is okay, but I'd like to beef it up with a
Neural Network, even though I have no real working knowledge of Neural
Networks (no formal theoretical CS education). After doing a bit of reading on
the subject I found that a Neural Network could be used to train a genome in
order to improve results. Let's say I have a genome (group of genes), such as</p>
<div class="code"><pre class="code literal-block"><span class="mf">1</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="mf">0...</span>
</pre></div>

<p>How could I use a Neural Network (I'm assuming MLP?) to train and improve my
genome?</p>
<p>In addition to this as I know nothing about Neural Networks I've been looking
into implementing some form of Reinforcement Learning, using my maze matrix (2
dimensional array), although I'm a bit stuck on what the following algorithm
wants from me:</p>
<p>(from
http://people.revoledu.com/kardi/tutorial/ReinforcementLearning/Q-Learning-
Algorithm.htm)</p>
<div class="code"><pre class="code literal-block"><span class="mf">1.</span><span class="w">  </span><span class="n">Set</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="n">reward</span><span class="w"> </span><span class="n">matrix</span><span class="w"> </span><span class="n">R</span>
<span class="w">   </span><span class="mf">2.</span><span class="w"> </span><span class="n">Initialize</span><span class="w"> </span><span class="n">matrix</span><span class="w"> </span><span class="n">Q</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">zero</span><span class="w"> </span><span class="n">matrix</span>
<span class="w">   </span><span class="mf">3.</span><span class="w"> </span><span class="kr">For</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">episode</span><span class="p">:</span>
<span class="w">          </span><span class="o">*</span><span class="w"> </span><span class="n">Select</span><span class="w"> </span><span class="n">random</span><span class="w"> </span><span class="n">initial</span><span class="w"> </span><span class="n">state</span>
<span class="w">          </span><span class="o">*</span><span class="w"> </span><span class="n">Do</span><span class="w"> </span><span class="n">while</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">reach</span><span class="w"> </span><span class="kr">go</span><span class="n">al</span><span class="w"> </span><span class="n">state</span>
<span class="w">                </span><span class="n">o</span><span class="w"> </span><span class="n">Select</span><span class="w"> </span><span class="kr">on</span><span class="n">e</span><span class="w"> </span><span class="n">among</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="nb">pos</span><span class="n">sible</span><span class="w"> </span><span class="n">actions</span><span class="w"> </span><span class="kr">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="n">state</span>
<span class="w">                </span><span class="n">o</span><span class="w"> </span><span class="n">Using</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="nb">pos</span><span class="n">sible</span><span class="w"> </span><span class="n">action</span><span class="p">,</span><span class="w"> </span><span class="n">consider</span><span class="w"> </span><span class="kr">to</span><span class="w"> </span><span class="kr">go</span><span class="w"> </span><span class="kr">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="kr">next</span><span class="w"> </span><span class="n">state</span>
<span class="w">                </span><span class="n">o</span><span class="w"> </span><span class="kr">Get</span><span class="w"> </span><span class="n">maximum</span><span class="w"> </span><span class="n">Q</span><span class="w"> </span><span class="nb">val</span><span class="n">ue</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="kr">next</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="n">based</span><span class="w"> </span><span class="kr">on</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="nb">pos</span><span class="n">sible</span><span class="w"> </span><span class="n">actions</span>
<span class="w">                </span><span class="n">o</span><span class="w"> </span><span class="n">Compute</span>
<span class="w">                </span><span class="n">o</span><span class="w"> </span><span class="n">Set</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="kr">next</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="n">state</span>

<span class="w">  </span><span class="kr">End</span><span class="w"> </span><span class="n">Do</span>

<span class="w">  </span><span class="kr">End</span><span class="w"> </span><span class="kr">For</span>
</pre></div>

<p>The big problem for me is implementing a reward matrix R and what a Q matrix
exactly is, and getting the Q value. I use a multi-dimensional array for my
maze and enum states for every move. How would this be used in a Q-Learning
algorithm?</p>
<p>If someone could help out by explaining what I would need to do to implement
the following, preferably in Java although C# would be nice too, possibly with
some source code examples it'd be appreciated.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>As noted in some comments, your question indeed involves a large set of
background knowledge and topics that hardly can be eloquently covered on
stackoverflow. However, what we can try here is suggest approaches to get
around your problem.</p>
<p>First of all: what does your GA do? I see a set of binary values; what are
they? I see them as either:</p>
<ul>
<li>
<strong>bad</strong> : a sequence of 'turn right' and 'turn left' instructions. Why is this bad? Because you're basically doing a random, brute-force attempt at solving your problem. You're not evolving a genotype: you're refining random guesses.</li>
<li>
<strong>better</strong> : every gene (location in the genome) represents a feature that will be expressed in the phenotype. There should not be a 1-to-1 mapping between genome and phenotype! </li>
</ul>
<p>Let me give you an example: in our brain there are 10^13ish neurons. But we
have only around 10^9 genes (yes, it's not an exact value, bear with me for a
second). What does this tell us? That our genotype does not encode <em>every</em>
neuron. Our genome encodes the proteins that will then go and make the
components of our body.</p>
<p>Hence, evolution works on the genotype directly by selecting <strong>features</strong> of
the phenotype. If I were to have 6 fingers on each hand and if that would made
me a better programmer, making me have more kids because I'm more successful
in life, well, my genotype would then be selected by evolution because it
contains the <strong>capability</strong> to give me a more fit body (yes, there is a pun
there, given the average geekiness-to-reproducibily ratio of most people
around here).</p>
<p>Now, think about your GA: what is that you are trying to accomplish? Are you
sure that evolving rules would help? In other words -- how would <strong>you</strong>
perform in a maze? What is the most successful thing that can help you: having
a different body, or having a memory of the right path to get out? Perhaps you
might want to reconsider your genotype and have it encode <em>memorization
abilities</em>. Maybe encode in the genotype how much data can be stored, and how
fast can your agents access it -- then measure fitness in terms of how fast
they get out of the maze. Another (weaker) approach could be to encode the
rules that your agent uses to decide where to go. The take-home message is,
encode features that, once expressed, can be selected by fitness.</p>
<hr>
<p>Now, to the neural network issue. One thing to remember is that NNs are
<strong>filters</strong>. They receive an input. perform operations on it, and return an
output. What is this output? Maybe you just need to discriminate a true/false
condition; for example, once you feed a maze map to a NN, it can tell you if
you can get out from the maze or not. How would you do such a thing? You will
need to <em>encode</em> the data properly.</p>
<p>This is the key point about NNs: your input data must be encoded properly.
Usually people normalize it, maybe scale it, perhaps you can apply a sigma
function to it to avoid values that are too large or too small; those are
details that deal with error measures and performance. What you need to
understand now is what a NN is, and what you cannot use it for.</p>
<p>To your problem now. You mentioned you want to use NNs as well: what about,</p>
<ul>
<li>using a neural network to guide the agent, and</li>
<li>using a genetic algorithm to evolve the neural network parameters?</li>
</ul>
<p>Rephrased like so:</p>
<ul>
<li>let's suppose you have a robot: your NN is controlling the left and right wheel, and as input it receives the distance of the next wall and how much it has traveled so far (it's just an example)</li>
<li>you start by generating a random genotype</li>
<li>make the genotype into a phenotype: the first gene is the network sensitivity; the second gene encodes the learning ratio; the third gene.. so on and so forth</li>
<li>now that you have a neural network, run the simulation</li>
<li>see how it performs</li>
<li>generate a second random genotype, evolve second NN</li>
<li>see how this second individual performs</li>
<li>get the best individual, then either mutate its genotype or recombinate it with the loser</li>
<li>repeat</li>
</ul>
<p>there is an <strong>excellent</strong> reading on the matter here: Inman Harvey Microbial
GA.</p>
<p>I hope I did you some insight on such issues. NNs and GA are no silver bullet
to solve all problems. In some they can do very much, in others they are just
the wrong tool. It's (still!) up to us to get the best one, and to do so we
must understand them well.</p>
<p>Have fun in it! It's great to know such things, makes everyday life a bit more
entertaining :)</p>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/artificial-intelligence/" rel="tag">artificial-intelligence</a></li>
            <li><a class="tag p-category" href="../../categories/computer-science/" rel="tag">computer-science</a></li>
            <li><a class="tag p-category" href="../../categories/java/" rel="tag">java</a></li>
            <li><a class="tag p-category" href="../../categories/neural-network/" rel="tag">neural-network</a></li>
            <li><a class="tag p-category" href="../../categories/theory/" rel="tag">theory</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../implementing-a-pathfinding-in-a-2d-array/" rel="prev" title="Implementing A* pathfinding in a 2D array">Previous post</a>
            </li>
            <li class="next">
                <a href="../how-to-fix-premature-convergence-in-simple-ga-python/" rel="next" title="How to fix premature convergence in simple GA (Python)?">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="../../assets/js/search.js"></script>
</body>
</html>
