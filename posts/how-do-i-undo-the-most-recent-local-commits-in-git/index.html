<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>How do I undo the most recent local commits in Git? | StackOverflow Snapshot</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/posts/how-do-i-undo-the-most-recent-local-commits-in-git/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Arya">
<link rel="prev" href="../why-is-processing-a-sorted-array-faster-than-processing-an-unsorted-array/" title="Why is processing a sorted array faster than processing an unsorted array?" type="text/html">
<link rel="next" href="../how-do-i-delete-a-git-branch-locally-and-remotely/" title="How do I delete a Git branch locally and remotely?" type="text/html">
<meta property="og:site_name" content="StackOverflow Snapshot">
<meta property="og:title" content="How do I undo the most recent local commits in Git?">
<meta property="og:url" content="https://ohstackoverflow.netlify.app/posts/how-do-i-undo-the-most-recent-local-commits-in-git/">
<meta property="og:description" content="I accidentally committed the wrong files to Git , but didn't push the
commit to the server yet.

How do I undo those commits from the local repository?


Answer
Undo a commit &amp; redo
$ git commit -m &quot;S">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-02-16T18:11:46+08:00">
<meta property="article:tag" content="git">
<meta property="article:tag" content="git-commit">
<meta property="article:tag" content="undo">
<meta property="article:tag" content="version-control">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">How do I undo the most recent local commits in Git?</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2023-02-16T18:11:46+08:00" itemprop="datePublished" title="2023-02-16 18:11">2023-02-16 18:11</time></a>
            </p>
            

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>I accidentally committed the wrong files to <strong>Git</strong> , but didn't push the
commit to the server yet.</p>
<blockquote>
<p>How do I undo those commits from the <em><strong>local</strong></em> repository?</p>
</blockquote>
<p><br><br></p>
<h2>Answer</h2>
<h2>Undo a commit &amp; redo</h2>
<div class="code"><pre class="code literal-block">$<span class="w"> </span>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"Something terribly misguided"</span><span class="w"> </span><span class="c1"># (0: Your Accident)</span>
$<span class="w"> </span>git<span class="w"> </span>reset<span class="w"> </span>HEAD~<span class="w">                              </span><span class="c1"># (1)</span>
<span class="o">[</span><span class="w"> </span>edit<span class="w"> </span>files<span class="w"> </span>as<span class="w"> </span>necessary<span class="w"> </span><span class="o">]</span><span class="w">                    </span><span class="c1"># (2)</span>
$<span class="w"> </span>git<span class="w"> </span>add<span class="w"> </span>.<span class="w">                                    </span><span class="c1"># (3)</span>
$<span class="w"> </span>git<span class="w"> </span>commit<span class="w"> </span>-c<span class="w"> </span>ORIG_HEAD<span class="w">                      </span><span class="c1"># (4)</span>
</pre></div>

<ol>
<li>
<code>git reset</code> is the command responsible for the <strong>undo</strong>. It will undo your last commit while <strong>leaving your working tree (the state of your files on disk) untouched.</strong> You'll need to add them again before you can commit them again).</li>
<li>Make corrections to working tree files.</li>
<li>
<code>git add</code> anything that you want to include in your new commit.</li>
<li>Commit the changes, reusing the old commit message. <code>reset</code> copied the old head to <code>.git/ORIG_HEAD</code>; <code>commit</code> with <code>-c ORIG_HEAD</code> will open an editor, which initially contains the log message from the old commit and allows you to edit it. If you do not need to edit the message, you could use the <code>-C</code> option.</li>
</ol>
<p><strong>Alternatively, to edit the previous commit (or just its commit message)</strong> ,
<code>commit --amend</code> will add changes within the current index to the previous
commit.</p>
<p><strong>To remove (not revert) a commit that has been pushed to the server</strong> ,
rewriting history with <code>git push origin main --force[-with-lease]</code> is
necessary. It's <em>almost always</em> a bad idea to use <code>--force</code>; prefer <code>--force-
with-lease</code> instead, and as noted in the git manual:</p>
<blockquote>
<p>You should understand the implications of rewriting history if you [rewrite
history] has already been published.</p>
</blockquote>
<hr>
<h3>Further Reading</h3>
<p>You can use <code>git reflog</code> to determine the SHA-1 for the commit to which you
wish to revert. Once you have this value, use the sequence of commands as
explained above.</p>
<hr>
<p><code>HEAD~</code> is the same as <code>HEAD~1</code>. The article What is the HEAD in git? is
helpful if you want to uncommit multiple commits.</p>
<p><br></p>
<h3>Suggest</h3>
<p>Undoing a commit is a little scary if you don't know how it works. But it's
actually amazingly easy if you do understand. I'll show you the 4 different
ways you can undo a commit.</p>
<p>Say you have this, where C is your HEAD and (F) is the state of your files.</p>
<div class="code"><pre class="code literal-block">   (F)
A-B-C
    ↑
  master
</pre></div>

<h4>Option 1: <code>git reset --hard</code>
</h4>
<p>You want to <strong>destroy commit C and also throw away any uncommitted changes</strong>.
You do this:</p>
<div class="code"><pre class="code literal-block">git reset --hard HEAD~1
</pre></div>

<p>The result is:</p>
<div class="code"><pre class="code literal-block"> (F)
A-B
  ↑
master
</pre></div>

<p>Now B is the HEAD. Because you used <code>--hard</code>, your files are reset to their
state at commit B.</p>
<h4>Option 2: <code>git reset</code>
</h4>
<p>Maybe commit C wasn't a disaster, but just a bit off. You want to <strong>undo the
commit but keep your changes</strong> for a bit of editing before you do a better
commit. Starting again from here, with C as your HEAD:</p>
<div class="code"><pre class="code literal-block">   (F)
A-B-C
    ↑
  master
</pre></div>

<p>Do this, leaving off the <code>--hard</code>:</p>
<div class="code"><pre class="code literal-block">git reset HEAD~1
</pre></div>

<p>In this case, the result is:</p>
<div class="code"><pre class="code literal-block">   (F)
A-B-C
  ↑
master
</pre></div>

<p>In both cases, HEAD is just a pointer to the latest commit. When you do a <code>git
reset HEAD~1</code>, you tell Git to move the HEAD pointer back one commit. But
(unless you use <code>--hard</code>) you leave your files as they were. So now <code>git
status</code> shows the changes you had checked into C. You haven't lost a thing!</p>
<h4>Option 3: <code>git reset --soft</code>
</h4>
<p>For the lightest touch, you can even <strong>undo your commit but leave your files
and your index</strong> :</p>
<div class="code"><pre class="code literal-block">git reset --soft HEAD~1
</pre></div>

<p>This not only leaves your files alone, it even leaves your <em>index</em> alone. When
you do <code>git status</code>, you'll see that the same files are in the index as
before. In fact, right after this command, you could do <code>git commit</code> and you'd
be redoing the same commit you just had.</p>
<h4>Option 4: you did <code>git reset --hard</code> and need to get that code back</h4>
<p>One more thing: Suppose you <strong>destroy a commit</strong> as in the first example,
<strong>but then discover you needed it after all</strong>? Tough luck, right?</p>
<p>Nope, there's <em>still</em> a way to get it back. Type this</p>
<div class="code"><pre class="code literal-block">git reflog
</pre></div>

<p>and you'll see a list of (partial) commit shas (that is, hashes) that you've
moved around in. Find the commit you destroyed, and do this:</p>
<div class="code"><pre class="code literal-block">git checkout -b someNewBranchName shaYouDestroyed
</pre></div>

<p>You've now resurrected that commit. Commits don't actually get destroyed in
Git for some 90 days, so you can usually go back and rescue one you didn't
mean to get rid of.</p>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/git/" rel="tag">git</a></li>
            <li><a class="tag p-category" href="../../categories/git-commit/" rel="tag">git-commit</a></li>
            <li><a class="tag p-category" href="../../categories/undo/" rel="tag">undo</a></li>
            <li><a class="tag p-category" href="../../categories/version-control/" rel="tag">version-control</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../why-is-processing-a-sorted-array-faster-than-processing-an-unsorted-array/" rel="prev" title="Why is processing a sorted array faster than processing an unsorted array?">Previous post</a>
            </li>
            <li class="next">
                <a href="../how-do-i-delete-a-git-branch-locally-and-remotely/" rel="next" title="How do I delete a Git branch locally and remotely?">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="../../assets/js/search.js"></script>
</body>
</html>
