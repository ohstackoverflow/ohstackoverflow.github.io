<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>How to copy data to clipboard in C# | StackOverflow Snapshot</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/posts/how-to-copy-data-to-clipboard-in-c/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Arya">
<link rel="prev" href="../flex-box-align-last-row-to-grid/" title="Flex-box: Align last row to grid" type="text/html">
<link rel="next" href="../can-you-nest-html-forms/" title="Can you nest html forms?" type="text/html">
<meta property="og:site_name" content="StackOverflow Snapshot">
<meta property="og:title" content="How to copy data to clipboard in C#">
<meta property="og:url" content="https://ohstackoverflow.netlify.app/posts/how-to-copy-data-to-clipboard-in-c/">
<meta property="og:description" content="How can I copy a string (e.g &quot;hello&quot;) to the System Clipboard in C#, so next
time I press CTRL+V I'll get &quot;hello&quot;?

Answer
There are two classes that lives in different assemblies and different
namesp">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-02-18T05:45:42+08:00">
<meta property="article:tag" content=".net-c#">
<meta property="article:tag" content="clipboard">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">How to copy data to clipboard in C#</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T05:45:42+08:00" itemprop="datePublished" title="2023-02-18 05:45">2023-02-18 05:45</time></a>
            </p>
            

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>How can I copy a string (e.g "hello") to the System Clipboard in C#, so next
time I press <code>CTRL+V</code> I'll get "hello"?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>There are two classes that lives in different assemblies and different
namespaces.</p>
<ul>
<li>
<p>WinForms: use following namespace declaration, make sure <code>Main</code> is marked with <code>[STAThread]</code> attribute:</p>
<div class="code"><pre class="code literal-block">using System.Windows.Forms;
</pre></div>

</li>
<li>
<p>WPF: use following namespace declaration</p>
<div class="code"><pre class="code literal-block">using System.Windows;
</pre></div>

</li>
<li>
<p>console: add reference to <code>System.Windows.Forms</code>, use following namespace declaration, make sure <code>Main</code> is marked with <code>[STAThread]</code> attribute. Step-by-step guide in another answer</p>
<div class="code"><pre class="code literal-block">using System.Windows.Forms;
</pre></div>

</li>
</ul>
<p>To copy an exact string (literal in this case):</p>
<div class="code"><pre class="code literal-block">Clipboard.SetText("Hello, clipboard");
</pre></div>

<p>To copy the contents of a textbox either use TextBox.Copy() or get text first
and then set clipboard value:</p>
<div class="code"><pre class="code literal-block">Clipboard.SetText(txtClipboard.Text);
</pre></div>

<p>See here for an example. Or... Official MSDN documentation or Here for WPF.</p>
<hr>
<p>Remarks:</p>
<ul>
<li>
<p>Clipboard is desktop UI concept, trying to set it in server side code like ASP.Net will only set value on the server and has no impact on what user can see in they browser. While linked answer lets one to run Clipboard access code server side with <code>SetApartmentState</code> it is unlikely what you want to achieve.</p>
</li>
<li>
<p>If after following information in this question code still gets an exception see "Current thread must be set to single thread apartment (STA)" error in copy string to clipboard</p>
</li>
<li>
<p>This question/answer covers regular .NET, for .NET Core see - .Net Core - copy to clipboard?</p>
</li>
</ul>
<p><br></p>
<h3>Suggest</h3>
<p>For <strong>console</strong> projects in a step-by-step fashion, you'll have to first add
the <code>System.Windows.Forms</code> reference. The following steps work in Visual
Studio Community 2013 with .NET 4.5:</p>
<ol>
<li>In <strong>Solution Explorer</strong> , expand your console project.</li>
<li>Right-click <strong>References</strong> , then click <strong>Add Reference...</strong>
</li>
<li>In the <strong>Assemblies</strong> group, under <strong>Framework</strong> , select <code>System.Windows.Forms</code>.</li>
<li>Click <strong>OK</strong>.</li>
</ol>
<p>Then, add the following <code>using</code> statement in with the others at the top of
your code:</p>
<div class="code"><pre class="code literal-block">using System.Windows.Forms;
</pre></div>

<p>Then, add either of the following <code>Clipboard</code>.<code>SetText</code> statements to your
code:</p>
<div class="code"><pre class="code literal-block">Clipboard.SetText("hello");
// OR
Clipboard.SetText(helloString);
</pre></div>

<p>And lastly, add <code>STAThreadAttribute</code> to your <code>Main</code> method as follows, to
avoid a <code>System.Threading.ThreadStateException</code>:</p>
<div class="code"><pre class="code literal-block"><span class="k">[STAThreadAttribute]</span>
<span class="na">static void Main(string[] args)</span>
<span class="na">{</span>
<span class="w">  </span><span class="na">// ...</span>
<span class="na">}</span>
</pre></div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/net-c/" rel="tag">.net-c#</a></li>
            <li><a class="tag p-category" href="../../categories/clipboard/" rel="tag">clipboard</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../flex-box-align-last-row-to-grid/" rel="prev" title="Flex-box: Align last row to grid">Previous post</a>
            </li>
            <li class="next">
                <a href="../can-you-nest-html-forms/" rel="next" title="Can you nest html forms?">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="../../assets/js/search.js"></script>
</body>
</html>
