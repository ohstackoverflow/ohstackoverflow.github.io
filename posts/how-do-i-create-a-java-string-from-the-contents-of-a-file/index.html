<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>How do I create a Java string from the contents of a file? | StackOverflow Snapshot</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/posts/how-do-i-create-a-java-string-from-the-contents-of-a-file/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Arya">
<link rel="prev" href="../what-is-the-meaning-of-single-and-double-underscore-before-an-object-name/" title="What is the meaning of single and double underscore before an object name?" type="text/html">
<link rel="next" href="../what-is-a-lambda-expression-in-c-11/" title="What is a lambda expression in C++11?" type="text/html">
<meta property="og:site_name" content="StackOverflow Snapshot">
<meta property="og:title" content="How do I create a Java string from the contents of a file?">
<meta property="og:url" content="https://ohstackoverflow.netlify.app/posts/how-do-i-create-a-java-string-from-the-contents-of-a-file/">
<meta property="og:description" content="I've been using the idiom below for some time now. And it seems to be the most
wide-spread, at least on the sites I've visited.
Is there a better/different way to read a file into a string in Java?
pr">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-02-17T00:29:31+08:00">
<meta property="article:tag" content="file">
<meta property="article:tag" content="file-io">
<meta property="article:tag" content="io">
<meta property="article:tag" content="java">
<meta property="article:tag" content="string">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">How do I create a Java string from the contents of a file?</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T00:29:31+08:00" itemprop="datePublished" title="2023-02-17 00:29">2023-02-17 00:29</time></a>
            </p>
            

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>I've been using the idiom below for some time now. And it seems to be the most
wide-spread, at least on the sites I've visited.</p>
<p>Is there a better/different way to read a file into a string in Java?</p>
<div class="code"><pre class="code literal-block"><span class="nv">private</span><span class="w"> </span><span class="nv">String</span><span class="w"> </span><span class="nv">readFile</span><span class="ss">(</span><span class="nv">String</span><span class="w"> </span><span class="nv">file</span><span class="ss">)</span><span class="w"> </span><span class="nv">throws</span><span class="w"> </span><span class="nv">IOException</span><span class="w"> </span>{
<span class="w">    </span><span class="nv">BufferedReader</span><span class="w"> </span><span class="nv">reader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">BufferedReader</span><span class="ss">(</span><span class="nv">new</span><span class="w"> </span><span class="nv">FileReader</span><span class="w"> </span><span class="ss">(</span><span class="nv">file</span><span class="ss">))</span><span class="c1">;</span>
<span class="w">    </span><span class="nv">String</span><span class="w">         </span><span class="nv">line</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">null</span><span class="c1">;</span>
<span class="w">    </span><span class="nv">StringBuilder</span><span class="w">  </span><span class="nv">stringBuilder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">StringBuilder</span><span class="ss">()</span><span class="c1">;</span>
<span class="w">    </span><span class="nv">String</span><span class="w">         </span><span class="nv">ls</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">System</span>.<span class="nv">getProperty</span><span class="ss">(</span><span class="s2">"line.separator"</span><span class="ss">)</span><span class="c1">;</span>

<span class="w">    </span><span class="nv">try</span><span class="w"> </span>{
<span class="w">        </span><span class="k">while</span><span class="ss">((</span><span class="nv">line</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">reader</span>.<span class="nv">readLine</span><span class="ss">())</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nv">null</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">            </span><span class="nv">stringBuilder</span>.<span class="nv">append</span><span class="ss">(</span><span class="nv">line</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">            </span><span class="nv">stringBuilder</span>.<span class="nv">append</span><span class="ss">(</span><span class="nv">ls</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">        </span>}

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nv">stringBuilder</span>.<span class="nv">toString</span><span class="ss">()</span><span class="c1">;</span>
<span class="w">    </span>}<span class="w"> </span><span class="nv">finally</span><span class="w"> </span>{
<span class="w">        </span><span class="nv">reader</span>.<span class="nv">close</span><span class="ss">()</span><span class="c1">;</span>
<span class="w">    </span>}
}
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<h3>Read all text from a file</h3>
<p>Java 11 added the readString() method to read small files as a <code>String</code>,
preserving line terminators:</p>
<div class="code"><pre class="code literal-block">String content = Files.readString(path, encoding);
</pre></div>

<p>For versions between Java 7 and 11, here's a compact, robust idiom, wrapped up
in a utility method:</p>
<div class="code"><pre class="code literal-block"><span class="nv">static</span><span class="w"> </span><span class="nv">String</span><span class="w"> </span><span class="nv">readFile</span><span class="ss">(</span><span class="nv">String</span><span class="w"> </span><span class="nv">path</span>,<span class="w"> </span><span class="nv">Charset</span><span class="w"> </span><span class="nv">encoding</span><span class="ss">)</span>
<span class="w">  </span><span class="nv">throws</span><span class="w"> </span><span class="nv">IOException</span>
{
<span class="w">  </span><span class="nv">byte</span>[]<span class="w"> </span><span class="nv">encoded</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">Files</span>.<span class="nv">readAllBytes</span><span class="ss">(</span><span class="nv">Paths</span>.<span class="nv">get</span><span class="ss">(</span><span class="nv">path</span><span class="ss">))</span><span class="c1">;</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">String</span><span class="ss">(</span><span class="nv">encoded</span>,<span class="w"> </span><span class="nv">encoding</span><span class="ss">)</span><span class="c1">;</span>
}
</pre></div>

<h3>Read lines of text from a file</h3>
<p>Java 7 added a convenience method to read a file as lines of text, represented
as a <code>List&lt;String&gt;</code>. This approach is "lossy" because the line separators are
stripped from the end of each line.</p>
<div class="code"><pre class="code literal-block">List&lt;String&gt; lines = Files.readAllLines(Paths.get(path), encoding);
</pre></div>

<p>Java 8 added the <code>Files.lines()</code> method to produce a <code>Stream&lt;String&gt;</code>. Again,
this method is lossy because line separators are stripped. If an <code>IOException</code>
is encountered while reading the file, it is wrapped in an
<code>UncheckedIOException</code>, since <code>Stream</code> doesn't accept lambdas that throw
checked exceptions.</p>
<div class="code"><pre class="code literal-block"><span class="nt">try</span><span class="w"> </span><span class="o">(</span><span class="nt">Stream</span><span class="o">&lt;</span><span class="nt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="nt">lines</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">Files</span><span class="p">.</span><span class="nc">lines</span><span class="o">(</span><span class="nt">path</span><span class="o">,</span><span class="w"> </span><span class="nt">encoding</span><span class="o">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="err">lines.forEach(System.</span><span class="n">out</span><span class="p">:</span><span class="o">:</span><span class="n">println</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>

<p>This <code>Stream</code> does need a <code>close()</code> call; this is poorly documented on the
API, and I suspect many people don't even notice <code>Stream</code> has a <code>close()</code>
method. Be sure to use an ARM-block as shown.</p>
<p>If you are working with a source other than a file, you can use the <code>lines()</code>
method in <code>BufferedReader</code> instead.</p>
<h3>Memory utilization</h3>
<p>If your file is small enough relative to your available memory, reading the
entire file at once might work fine. However, if your file is too large,
reading one line at a time, processing it, and then discarding it before
moving on to the next could be a better approach. Stream processing in this
way can eliminate the total file size as a factor in your memory requirement.</p>
<h3>Character encoding</h3>
<p>One thing that is missing from the sample in the original post is the
character encoding. This encoding generally can't be determined from the file
itself, and requires meta-data such as an HTTP header to convey this important
information.</p>
<p>The <code>StandardCharsets</code> class defines some constants for the encodings required
of all Java runtimes:</p>
<div class="code"><pre class="code literal-block">String content = readFile("test.txt", StandardCharsets.UTF_8);
</pre></div>

<p>The platform default is available from the <code>Charset</code> class itself:</p>
<div class="code"><pre class="code literal-block">String content = readFile("test.txt", Charset.defaultCharset());
</pre></div>

<p>There are some special cases where the platform default is what you want, but
they are rare. You should be able justify your choice, because the platform
default is not portable. One example where it might be correct is when reading
standard input or writing standard output.</p>
<hr>
<p>Note: This answer largely replaces my Java 6 version. The utility of Java 7
safely simplifies the code, and the old answer, which used a mapped byte
buffer, prevented the file that was read from being deleted until the mapped
buffer was garbage collected. You can view the old version via the "edited"
link on this answer.</p>
<p><br></p>
<h3>Suggest</h3>
<p>If you're willing to use an external library, check out Apache Commons IO
(200KB JAR). It contains an
<code>org.apache.commons.io.FileUtils.readFileToString()</code> method that allows you to
read an entire <code>File</code> into a <code>String</code> with one line of code.</p>
<p>Example:</p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="nn">java.io.</span><span class="o">*</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.nio.charset.</span><span class="o">*</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.apache.commons.io.</span><span class="o">*</span><span class="p">;</span>

<span class="n">public</span> <span class="n">String</span> <span class="n">readFile</span><span class="p">()</span> <span class="n">throws</span> <span class="n">IOException</span> <span class="p">{</span>
    <span class="n">File</span> <span class="n">file</span> <span class="o">=</span> <span class="n">new</span> <span class="n">File</span><span class="p">(</span><span class="s2">"data.txt"</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">FileUtils</span><span class="o">.</span><span class="n">readFileToString</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">StandardCharsets</span><span class="o">.</span><span class="n">UTF_8</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/file/" rel="tag">file</a></li>
            <li><a class="tag p-category" href="../../categories/file-io/" rel="tag">file-io</a></li>
            <li><a class="tag p-category" href="../../categories/io/" rel="tag">io</a></li>
            <li><a class="tag p-category" href="../../categories/java/" rel="tag">java</a></li>
            <li><a class="tag p-category" href="../../categories/string/" rel="tag">string</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../what-is-the-meaning-of-single-and-double-underscore-before-an-object-name/" rel="prev" title="What is the meaning of single and double underscore before an object name?">Previous post</a>
            </li>
            <li class="next">
                <a href="../what-is-a-lambda-expression-in-c-11/" rel="next" title="What is a lambda expression in C++11?">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="../../assets/js/search.js"></script>
</body>
</html>
