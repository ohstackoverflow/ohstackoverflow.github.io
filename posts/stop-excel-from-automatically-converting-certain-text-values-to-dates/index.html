<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Stop Excel from automatically converting certain text values to dates | StackOverflow Snapshot</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/posts/stop-excel-from-automatically-converting-certain-text-values-to-dates/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Arya">
<link rel="prev" href="../why-is-there-no-sortedlist-in-java/" title="Why is there no SortedList in Java?" type="text/html">
<link rel="next" href="../is-operator-behaves-unexpectedly-with-integers/" title='"is" operator behaves unexpectedly with integers' type="text/html">
<meta property="og:site_name" content="StackOverflow Snapshot">
<meta property="og:title" content="Stop Excel from automatically converting certain text values to dates">
<meta property="og:url" content="https://ohstackoverflow.netlify.app/posts/stop-excel-from-automatically-converting-certain-text-values-to-dates/">
<meta property="og:description" content="Does anyone happen to know if there is a token I can add to my csv for a
certain field so Excel doesn't try to convert it to a date?
I'm trying to write a .csv file from my application and one of the ">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-02-18T00:22:07+08:00">
<meta property="article:tag" content="csv">
<meta property="article:tag" content="excel">
<meta property="article:tag" content="import">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Stop Excel from automatically converting certain text values to dates</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T00:22:07+08:00" itemprop="datePublished" title="2023-02-18 00:22">2023-02-18 00:22</time></a>
            </p>
            

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>Does anyone happen to know if there is a token I can add to my csv for a
certain field so Excel doesn't try to convert it to a date?</p>
<p>I'm trying to write a .csv file from my application and one of the values
happens to look enough like a date that Excel is automatically converting it
from text to a date. I've tried putting all of my text fields (including the
one that looks like a date) within double quotes, but that has no effect.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>I have found that putting an '=' before the double quotes will accomplish what
you want. It forces the data to be text.</p>
<p>eg. ="2008-10-03",="more text"</p>
<p><strong>EDIT (according to other posts)</strong> : because of the Excel 2007 bug noted by
Jeffiekins one should use the solution proposed by Andrew: <code>"=""2008-10-03"""</code></p>
<p><br></p>
<h3>Suggest</h3>
<p>I know this is an old question, but the problem is not going away soon. CSV
files are easy to generate from most programming languages, rather small,
human-readable in a crunch with a plain text editor, and ubiquitous.</p>
<p>The problem is not only with <strong>dates</strong> in text fields, but <strong>anything
numeric</strong> also gets converted from text to numbers. A couple of examples where
this is problematic:</p>
<ul>
<li>ZIP/postal codes</li>
<li>telephone numbers</li>
<li>government ID numbers</li>
</ul>
<p>which sometimes <strong>can</strong> start with one or more zeroes (0), which get thrown
away when converted to numeric. Or the value contains characters that can be
confused with mathematical operators (as in dates: /, -).</p>
<p>Two cases that I can think of that the "prepending =" solution, as mentioned
previously, <strong>might not be ideal</strong> is</p>
<ul>
<li>where the file might be imported into a program other than MS Excel (MS Word's Mail Merge function comes to mind),</li>
<li>where human-readability might be important.</li>
</ul>
<h2>My hack to work around this</h2>
<p>If one pre/appends a non-numeric and/or non-date character in the value, the
value will be recognized as text and not converted. A non-printing character
would be good as it will not alter the displayed value. However, the plain old
space character (\s, ASCII 32) doesn't work for this as it gets chopped off by
Excel and then the value still gets converted. <strong>But</strong> there are various other
printing and non-printing space characters that will work well. <strong>The
easiest</strong> however is to <strong>append (add after) the simple tab character (\t,
ASCII 9).</strong></p>
<p>Benefits of this approach:</p>
<ul>
<li>Available from keyboard or with an easy-to-remember ASCII code (9),</li>
<li>It doesn't bother the importation,</li>
<li>
<em>Normally</em> does not bother Mail Merge results (depending on the template layout - but normally it just adds a wide space at the end of a line). (If this is however a problem, look at other characters e.g. the zero-width space (ZWSP, Unicode U+200B)</li>
<li>is not a big hindrance when viewing the CSV in Notepad (etc),</li>
<li>and could be removed by find/replace in Excel (or Notepad etc).</li>
<li>You don't need to <em>import</em> the CSV, but can simply double-click to <em>open</em> the CSV in Excel.</li>
</ul>
<p>If there's a reason you don't want to use the tab, look in an Unicode table
for something else suitable.</p>
<h2>Another option</h2>
<p>might be to generate XML files, for which a certain format also is accepted
for import by newer MS Excel versions, and which allows a lot more options
similar to .XLS format, but I don't have experience with this.</p>
<p>So there are various options. Depending on your requirements/application, one
might be better than another.</p>
<hr>
<h2>Addition</h2>
<p>It needs to be said that newer versions (2013+) of MS Excel don't open the CSV
in spreadsheet format any more - one more speedbump in one's workflow making
Excel less useful... At least, instructions exist for getting around it. See
e.g. this Stackoverflow: How to correctly display .csv files within Excel
2013? .</p>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/csv/" rel="tag">csv</a></li>
            <li><a class="tag p-category" href="../../categories/excel/" rel="tag">excel</a></li>
            <li><a class="tag p-category" href="../../categories/import/" rel="tag">import</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../why-is-there-no-sortedlist-in-java/" rel="prev" title="Why is there no SortedList in Java?">Previous post</a>
            </li>
            <li class="next">
                <a href="../is-operator-behaves-unexpectedly-with-integers/" rel="next" title='"is" operator behaves unexpectedly with integers'>Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="../../assets/js/search.js"></script>
</body>
</html>
