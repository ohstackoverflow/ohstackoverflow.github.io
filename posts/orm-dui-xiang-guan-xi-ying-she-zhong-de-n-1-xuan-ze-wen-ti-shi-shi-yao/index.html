<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ORM（对象关系映射）中的“N+1 选择问题”是什么？ | StackOverflow Snapshot</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/posts/orm-dui-xiang-guan-xi-ying-she-zhong-de-n-1-xuan-ze-wen-ti-shi-shi-yao/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Arya">
<link rel="prev" href="../cong-zui-xin-ti-jiao-zhong-shan-chu-wen-jian/" title="从最新提交中删除文件" type="text/html">
<link rel="next" href="../fang-fa-he-han-shu-you-shi-yao-qu-bie/" title="方法和函数有什么区别？" type="text/html">
<meta property="og:site_name" content="StackOverflow Snapshot">
<meta property="og:title" content="ORM（对象关系映射）中的“N+1 选择问题”是什么？">
<meta property="og:url" content="https://ohstackoverflow.netlify.app/posts/orm-dui-xiang-guan-xi-ying-she-zhong-de-n-1-xuan-ze-wen-ti-shi-shi-yao/">
<meta property="og:description" content="“N+1 选择问题”通常在对象关系映射 (ORM) 讨论中被表述为一个问题，我理解它与必须对对象中看似简单的内容进行大量数据库查询有关世界。
有人对问题有更详细的解释吗？

解答
假设您有一个Car对象集合（数据库行），每个对象Car都有一个对象集合Wheel（也是行）。换句话说，Car→Wheel是一对多的关系。
现在，假设您需要遍历所有汽车，并为每辆汽车打印出一个车轮列表。朴素的 O/R 实现">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-02-16T22:37:40+08:00">
<meta property="article:tag" content="database">
<meta property="article:tag" content="orm">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">ORM（对象关系映射）中的“N+1 选择问题”是什么？</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2023-02-16T22:37:40+08:00" itemprop="datePublished" title="2023-02-16 22:37">2023-02-16 22:37</time></a>
            </p>
            

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>“N+1 选择问题”通常在对象关系映射 (ORM) 讨论中被表述为一个问题，我理解它与必须对对象中看似简单的内容进行大量数据库查询有关世界。</p>
<p>有人对问题有更详细的解释吗？</p>
<p><br><br></p>
<h2>解答</h2>
<p>假设您有一个<code>Car</code>对象集合（数据库行），每个对象<code>Car</code>都有一个对象集合<code>Wheel</code>（也是行）。换句话说，<code>Car</code>→<code>Wheel</code>是一对多的关系。</p>
<p>现在，假设您需要遍历所有汽车，并为每辆汽车打印出一个车轮列表。朴素的 O/R 实现将执行以下操作：</p>
<div class="code"><pre class="code literal-block">SELECT * FROM Cars;
</pre></div>

<p>然后 <strong>对于每个<code>Car</code>：</strong></p>
<div class="code"><pre class="code literal-block">SELECT * FROM Wheel WHERE CarId = ?
</pre></div>

<p>换句话说，您有一个汽车选择，然后是 N 个附加选择，其中 N 是汽车总数。</p>
<p>或者，可以获取所有轮子并在内存中执行查找：</p>
<div class="code"><pre class="code literal-block">SELECT * FROM Wheel;
</pre></div>

<p>这将往返数据库的次数从 N+1 减少到 2。大多数 ORM 工具为您提供了几种方法来防止 N+1 选择。</p>
<p>参考： <em>Java Persistence with Hibernate</em> ，第 13 章。</p>
<p><br></p>
<h3>更多建议</h3>
<h3>什么是N+1查询问题</h3>
<p>N+1 查询问题发生在数据访问框架执行 N 个额外的 SQL 语句以获取在执行主 SQL 查询时可能已检索到的相同数据时。</p>
<p>N的值越大，执行的查询越多，对性能的影响越大。而且，与可以帮助您找到运行缓慢的查询的慢速查询日志不同，N+1
问题不会被发现，因为每个单独的附加查询都运行得足够快，不会触发慢速查询日志。</p>
<p>问题是执行大量额外的查询，总的来说，这些查询需要足够的时间来减慢响应时间。</p>
<p>假设我们有以下形成一对多表关系的 post 和 post_comments 数据库表：</p>
<p><img alt="post 和 post_comments 表" src="../../images/T1uWG.png"></p>
<p>我们将创建以下 4<code>post</code>行：</p>
<div class="code"><pre class="code literal-block">INSERT INTO post (title, id)
VALUES ('High-Performance Java Persistence - Part 1', 1)

INSERT INTO post (title, id)
VALUES ('High-Performance Java Persistence - Part 2', 2)

INSERT INTO post (title, id)
VALUES ('High-Performance Java Persistence - Part 3', 3)

INSERT INTO post (title, id)
VALUES ('High-Performance Java Persistence - Part 4', 4)
</pre></div>

<p>并且，我们还将创建 4<code>post_comment</code>个子记录：</p>
<div class="code"><pre class="code literal-block"><span class="nv">INSERT</span><span class="w"> </span><span class="nv">INTO</span><span class="w"> </span><span class="nv">post_comment</span><span class="w"> </span><span class="ss">(</span><span class="nv">post_id</span>,<span class="w"> </span><span class="nv">review</span>,<span class="w"> </span><span class="nv">id</span><span class="ss">)</span>
<span class="nv">VALUES</span><span class="w"> </span><span class="ss">(</span><span class="mi">1</span>,<span class="w"> </span><span class="s1">'Excellent book to understand Java Persistence'</span>,<span class="w"> </span><span class="mi">1</span><span class="ss">)</span>

<span class="nv">INSERT</span><span class="w"> </span><span class="nv">INTO</span><span class="w"> </span><span class="nv">post_comment</span><span class="w"> </span><span class="ss">(</span><span class="nv">post_id</span>,<span class="w"> </span><span class="nv">review</span>,<span class="w"> </span><span class="nv">id</span><span class="ss">)</span>
<span class="nv">VALUES</span><span class="w"> </span><span class="ss">(</span><span class="mi">2</span>,<span class="w"> </span><span class="s1">'Must-read for Java developers'</span>,<span class="w"> </span><span class="mi">2</span><span class="ss">)</span>

<span class="nv">INSERT</span><span class="w"> </span><span class="nv">INTO</span><span class="w"> </span><span class="nv">post_comment</span><span class="w"> </span><span class="ss">(</span><span class="nv">post_id</span>,<span class="w"> </span><span class="nv">review</span>,<span class="w"> </span><span class="nv">id</span><span class="ss">)</span>
<span class="nv">VALUES</span><span class="w"> </span><span class="ss">(</span><span class="mi">3</span>,<span class="w"> </span><span class="s1">'Five Stars'</span>,<span class="w"> </span><span class="mi">3</span><span class="ss">)</span>

<span class="nv">INSERT</span><span class="w"> </span><span class="nv">INTO</span><span class="w"> </span><span class="nv">post_comment</span><span class="w"> </span><span class="ss">(</span><span class="nv">post_id</span>,<span class="w"> </span><span class="nv">review</span>,<span class="w"> </span><span class="nv">id</span><span class="ss">)</span>
<span class="nv">VALUES</span><span class="w"> </span><span class="ss">(</span><span class="mi">4</span>,<span class="w"> </span><span class="s1">'A great reference book'</span>,<span class="w"> </span><span class="mi">4</span><span class="ss">)</span>
</pre></div>

<h3>普通 SQL 的 N+1 查询问题</h3>
<p>如果您选择<code>post_comments</code>使用此 SQL 查询：</p>
<div class="code"><pre class="code literal-block"><span class="nf">List</span><span class="err">&lt;</span><span class="no">Tuple</span><span class="err">&gt;</span><span class="w"> </span><span class="no">comments</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="no">entityManager.createNativeQuery</span><span class="p">(</span><span class="err">"""</span>
<span class="w">    </span><span class="nf">SELECT</span>
<span class="w">        </span><span class="nf">pc.id</span><span class="w"> </span><span class="no">AS</span><span class="w"> </span><span class="no">id</span><span class="p">,</span>
<span class="w">        </span><span class="nf">pc.review</span><span class="w"> </span><span class="no">AS</span><span class="w"> </span><span class="no">review</span><span class="p">,</span>
<span class="w">        </span><span class="nf">pc.post_id</span><span class="w"> </span><span class="no">AS</span><span class="w"> </span><span class="no">postId</span>
<span class="w">    </span><span class="nf">FROM</span><span class="w"> </span><span class="no">post_comment</span><span class="w"> </span><span class="no">pc</span>
<span class="w">    </span><span class="err">""",</span><span class="w"> </span><span class="nf">Tuple.class</span><span class="p">)</span>
<span class="na">.getResultList</span><span class="p">()</span><span class="c1">;</span>
</pre></div>

<p><code>post</code> <code>title</code>并且，稍后，您决定为每个获取关联<code>post_comment</code>：</p>
<div class="code"><pre class="code literal-block"><span class="k">for</span><span class="w"> </span><span class="ss">(</span><span class="nv">Tuple</span><span class="w"> </span><span class="nv">comment</span><span class="w"> </span>:<span class="w"> </span><span class="nv">comments</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">    </span><span class="nv">String</span><span class="w"> </span><span class="nv">review</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">(</span><span class="nv">String</span><span class="ss">)</span><span class="w"> </span><span class="nv">comment</span>.<span class="nv">get</span><span class="ss">(</span><span class="s2">"review"</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">    </span><span class="nv">Long</span><span class="w"> </span><span class="nv">postId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">((</span><span class="nv">Number</span><span class="ss">)</span><span class="w"> </span><span class="nv">comment</span>.<span class="nv">get</span><span class="ss">(</span><span class="s2">"postId"</span><span class="ss">))</span>.<span class="nv">longValue</span><span class="ss">()</span><span class="c1">;</span>

<span class="w">    </span><span class="nv">String</span><span class="w"> </span><span class="nv">postTitle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">(</span><span class="nv">String</span><span class="ss">)</span><span class="w"> </span><span class="nv">entityManager</span>.<span class="nv">createNativeQuery</span><span class="ss">(</span><span class="s2">""</span><span class="err">"</span>
<span class="err">        SELECT</span>
<span class="err">            p.title</span>
<span class="err">        FROM post p</span>
<span class="err">        WHERE p.id = :postId</span>
<span class="w">        </span><span class="s2">""</span><span class="err">")</span>
<span class="w">    </span>.<span class="nv">setParameter</span><span class="ss">(</span><span class="s2">"postId"</span>,<span class="w"> </span><span class="nv">postId</span><span class="ss">)</span>
<span class="w">    </span>.<span class="nv">getSingleResult</span><span class="ss">()</span><span class="c1">;</span>

<span class="w">    </span><span class="nv">LOGGER</span>.<span class="nv">info</span><span class="ss">(</span>
<span class="w">        </span><span class="s2">"The Post '{}' got this review '{}'"</span>,
<span class="w">        </span><span class="nv">postTitle</span>,
<span class="w">        </span><span class="nv">review</span>
<span class="w">    </span><span class="ss">)</span><span class="c1">;</span>
}
</pre></div>

<p>您将触发 N+1 查询问题，因为您执行了 5 (1 + 4) 次 SQL 查询，而不是一次 SQL 查询：</p>
<div class="code"><pre class="code literal-block"><span class="nv">SELECT</span>
<span class="w">    </span><span class="nv">pc</span>.<span class="nv">id</span><span class="w"> </span><span class="nv">AS</span><span class="w"> </span><span class="nv">id</span>,
<span class="w">    </span><span class="nv">pc</span>.<span class="nv">review</span><span class="w"> </span><span class="nv">AS</span><span class="w"> </span><span class="nv">review</span>,
<span class="w">    </span><span class="nv">pc</span>.<span class="nv">post_id</span><span class="w"> </span><span class="nv">AS</span><span class="w"> </span><span class="nv">postId</span>
<span class="nv">FROM</span><span class="w"> </span><span class="nv">post_comment</span><span class="w"> </span><span class="nv">pc</span>

<span class="nv">SELECT</span><span class="w"> </span><span class="nv">p</span>.<span class="nv">title</span><span class="w"> </span><span class="nv">FROM</span><span class="w"> </span><span class="nv">post</span><span class="w"> </span><span class="nv">p</span><span class="w"> </span><span class="nv">WHERE</span><span class="w"> </span><span class="nv">p</span>.<span class="nv">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="o">--</span><span class="w"> </span><span class="nv">The</span><span class="w"> </span><span class="nv">Post</span><span class="w"> </span><span class="s1">'High-Performance Java Persistence - Part 1'</span><span class="w"> </span><span class="nv">got</span><span class="w"> </span><span class="nv">this</span><span class="w"> </span><span class="nv">review</span>
<span class="o">--</span><span class="w"> </span><span class="s1">'Excellent book to understand Java Persistence'</span>

<span class="nv">SELECT</span><span class="w"> </span><span class="nv">p</span>.<span class="nv">title</span><span class="w"> </span><span class="nv">FROM</span><span class="w"> </span><span class="nv">post</span><span class="w"> </span><span class="nv">p</span><span class="w"> </span><span class="nv">WHERE</span><span class="w"> </span><span class="nv">p</span>.<span class="nv">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>
<span class="o">--</span><span class="w"> </span><span class="nv">The</span><span class="w"> </span><span class="nv">Post</span><span class="w"> </span><span class="s1">'High-Performance Java Persistence - Part 2'</span><span class="w"> </span><span class="nv">got</span><span class="w"> </span><span class="nv">this</span><span class="w"> </span><span class="nv">review</span>
<span class="o">--</span><span class="w"> </span><span class="s1">'Must-read for Java developers'</span>

<span class="nv">SELECT</span><span class="w"> </span><span class="nv">p</span>.<span class="nv">title</span><span class="w"> </span><span class="nv">FROM</span><span class="w"> </span><span class="nv">post</span><span class="w"> </span><span class="nv">p</span><span class="w"> </span><span class="nv">WHERE</span><span class="w"> </span><span class="nv">p</span>.<span class="nv">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span>
<span class="o">--</span><span class="w"> </span><span class="nv">The</span><span class="w"> </span><span class="nv">Post</span><span class="w"> </span><span class="s1">'High-Performance Java Persistence - Part 3'</span><span class="w"> </span><span class="nv">got</span><span class="w"> </span><span class="nv">this</span><span class="w"> </span><span class="nv">review</span>
<span class="o">--</span><span class="w"> </span><span class="s1">'Five Stars'</span>

<span class="nv">SELECT</span><span class="w"> </span><span class="nv">p</span>.<span class="nv">title</span><span class="w"> </span><span class="nv">FROM</span><span class="w"> </span><span class="nv">post</span><span class="w"> </span><span class="nv">p</span><span class="w"> </span><span class="nv">WHERE</span><span class="w"> </span><span class="nv">p</span>.<span class="nv">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span>
<span class="o">--</span><span class="w"> </span><span class="nv">The</span><span class="w"> </span><span class="nv">Post</span><span class="w"> </span><span class="s1">'High-Performance Java Persistence - Part 4'</span><span class="w"> </span><span class="nv">got</span><span class="w"> </span><span class="nv">this</span><span class="w"> </span><span class="nv">review</span>
<span class="o">--</span><span class="w"> </span><span class="s1">'A great reference book'</span>
</pre></div>

<p>修复 N+1 查询问题非常容易。您需要做的就是提取原始 SQL 查询中需要的所有数据，如下所示：</p>
<div class="code"><pre class="code literal-block"><span class="nf">List</span><span class="err">&lt;</span><span class="no">Tuple</span><span class="err">&gt;</span><span class="w"> </span><span class="no">comments</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="no">entityManager.createNativeQuery</span><span class="p">(</span><span class="err">"""</span>
<span class="w">    </span><span class="nf">SELECT</span>
<span class="w">        </span><span class="nf">pc.id</span><span class="w"> </span><span class="no">AS</span><span class="w"> </span><span class="no">id</span><span class="p">,</span>
<span class="w">        </span><span class="nf">pc.review</span><span class="w"> </span><span class="no">AS</span><span class="w"> </span><span class="no">review</span><span class="p">,</span>
<span class="w">        </span><span class="nf">p.title</span><span class="w"> </span><span class="no">AS</span><span class="w"> </span><span class="no">postTitle</span>
<span class="w">    </span><span class="nf">FROM</span><span class="w"> </span><span class="no">post_comment</span><span class="w"> </span><span class="no">pc</span>
<span class="w">    </span><span class="nf">JOIN</span><span class="w"> </span><span class="no">post</span><span class="w"> </span><span class="no">p</span><span class="w"> </span><span class="no">ON</span><span class="w"> </span><span class="no">pc.post_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="no">p.id</span>
<span class="w">    </span><span class="err">""",</span><span class="w"> </span><span class="nf">Tuple.class</span><span class="p">)</span>
<span class="na">.getResultList</span><span class="p">()</span><span class="c1">;</span>

<span class="nf">for</span><span class="w"> </span><span class="p">(</span><span class="no">Tuple</span><span class="w"> </span><span class="no">comment</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="no">comments</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nf">String</span><span class="w"> </span><span class="no">review</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="p">(</span><span class="no">String</span><span class="p">)</span><span class="w"> </span><span class="no">comment.get</span><span class="p">(</span><span class="err">"</span><span class="no">review</span><span class="err">"</span><span class="p">)</span><span class="c1">;</span>
<span class="w">    </span><span class="nf">String</span><span class="w"> </span><span class="no">postTitle</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="p">(</span><span class="no">String</span><span class="p">)</span><span class="w"> </span><span class="no">comment.get</span><span class="p">(</span><span class="err">"</span><span class="no">postTitle</span><span class="err">"</span><span class="p">)</span><span class="c1">;</span>

<span class="w">    </span><span class="nf">LOGGER.info</span><span class="p">(</span>
<span class="w">        </span><span class="err">"</span><span class="nf">The</span><span class="w"> </span><span class="no">Post</span><span class="w"> </span><span class="err">'</span><span class="p">{}</span><span class="err">'</span><span class="w"> </span><span class="no">got</span><span class="w"> </span><span class="no">this</span><span class="w"> </span><span class="no">review</span><span class="w"> </span><span class="err">'</span><span class="p">{}</span><span class="err">'"</span><span class="p">,</span>
<span class="w">        </span><span class="nf">postTitle</span><span class="p">,</span>
<span class="w">        </span><span class="nf">review</span>
<span class="w">    </span><span class="err">)</span><span class="c1">;</span>
<span class="err">}</span>
</pre></div>

<p>这一次，只执行一个 SQL 查询来获取我们进一步感兴趣使用的所有数据。</p>
<h3>JPA 和 Hibernate 的 N+1 查询问题</h3>
<p>使用 JPA 和 Hibernate 时，有几种方法可以触发 N+1 查询问题，因此了解如何避免这些情况非常重要。</p>
<p>对于下一个示例，考虑我们将<code>post</code>和<code>post_comments</code>表映射到以下实体：</p>
<p><img alt="Post 和 PostComment 实体" src="../../images/rZJne.png"></p>
<p>JPA 映射如下所示：</p>
<div class="code"><pre class="code literal-block"><span class="nv">@Entity</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">"Post"</span><span class="p">)</span>
<span class="nv">@Table</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">"post"</span><span class="p">)</span>
<span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">Post</span><span class="w"> </span><span class="err">{</span>

<span class="w">    </span><span class="nv">@Id</span>
<span class="w">    </span><span class="n">private</span><span class="w"> </span><span class="n">Long</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>

<span class="w">    </span><span class="n">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">title</span><span class="p">;</span>

<span class="w">    </span><span class="o">//</span><span class="n">Getters</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">setters</span><span class="w"> </span><span class="n">omitted</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">brevity</span>
<span class="err">}</span>

<span class="nv">@Entity</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">"PostComment"</span><span class="p">)</span>
<span class="nv">@Table</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">"post_comment"</span><span class="p">)</span>
<span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">PostComment</span><span class="w"> </span><span class="err">{</span>

<span class="w">    </span><span class="nv">@Id</span>
<span class="w">    </span><span class="n">private</span><span class="w"> </span><span class="n">Long</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>

<span class="w">    </span><span class="nv">@ManyToOne</span>
<span class="w">    </span><span class="n">private</span><span class="w"> </span><span class="n">Post</span><span class="w"> </span><span class="n">post</span><span class="p">;</span>

<span class="w">    </span><span class="n">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">review</span><span class="p">;</span>

<span class="w">    </span><span class="o">//</span><span class="n">Getters</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">setters</span><span class="w"> </span><span class="n">omitted</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">brevity</span>
<span class="err">}</span>
</pre></div>

<h3><code>FetchType.EAGER</code></h3>
<p>为您的 JPA
关联隐式或显式使用<code>FetchType.EAGER</code>都不是一个好主意，因为您将获取所需的更多数据。而且，该<code>FetchType.EAGER</code>策略也容易出现N+1查询问题。</p>
<p>不幸的是，默认情况下使用<code>@ManyToOne</code>和关联，因此如果您的映射如下所示：<code>@OneToOne``FetchType.EAGER</code></p>
<div class="code"><pre class="code literal-block"><span class="nv">@ManyToOne</span>
<span class="n">private</span><span class="w"> </span><span class="n">Post</span><span class="w"> </span><span class="n">post</span><span class="p">;</span>
</pre></div>

<p>您正在使用该策略，并且每次您在使用 JPQL 或 Criteria API 查询加载某些实体时<code>FetchType.EAGER</code>忘记使用：<code>JOIN
FETCH``PostComment</code></p>
<div class="code"><pre class="code literal-block"><span class="nf">List</span><span class="err">&lt;</span><span class="no">PostComment</span><span class="err">&gt;</span><span class="w"> </span><span class="no">comments</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="no">entityManager</span>
<span class="na">.createQuery</span><span class="p">(</span><span class="s">"""</span>
<span class="s">    select pc</span>
<span class="s">    from PostComment pc</span>
<span class="s">    """</span><span class="p">,</span><span class="w"> </span><span class="no">PostComment.class</span><span class="p">)</span>
<span class="na">.getResultList</span><span class="p">()</span><span class="c1">;</span>
</pre></div>

<p>您将触发 N+1 查询问题：</p>
<div class="code"><pre class="code literal-block">SELECT 
    pc.id AS id1_1_, 
    pc.post_id AS post_id3_1_, 
    pc.review AS review2_1_ 
FROM 
    post_comment pc

SELECT p.id AS id1_0_0_, p.title AS title2_0_0_ FROM post p WHERE p.id = 1
SELECT p.id AS id1_0_0_, p.title AS title2_0_0_ FROM post p WHERE p.id = 2
SELECT p.id AS id1_0_0_, p.title AS title2_0_0_ FROM post p WHERE p.id = 3
SELECT p.id AS id1_0_0_, p.title AS title2_0_0_ FROM post p WHERE p.id = 4
</pre></div>

<p>请注意执行的其他 SELECT 语句，因为<code>post</code>必须在返回实体之前获取<code>List</code>关联<code>PostComment</code>。</p>
<p>Unlike the default fetch plan, which you are using when calling the <code>find</code>
method of the <code>EntityManager</code>, a JPQL or Criteria API query defines an
explicit plan that Hibernate cannot change by injecting a JOIN FETCH
automatically. So, you need to do it manually.</p>
<p>If you didn't need the <code>post</code> association at all, you are out of luck when
using <code>FetchType.EAGER</code> because there is no way to avoid fetching it. That's
why it's better to use <code>FetchType.LAZY</code> by default.</p>
<p>But, if you wanted to use <code>post</code> association, then you can use <code>JOIN FETCH</code> to
avoid the N+1 query problem:</p>
<div class="code"><pre class="code literal-block"><span class="nf">List</span><span class="err">&lt;</span><span class="no">PostComment</span><span class="err">&gt;</span><span class="w"> </span><span class="no">comments</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="no">entityManager.createQuery</span><span class="p">(</span><span class="err">"""</span>
<span class="w">    </span><span class="nf">select</span><span class="w"> </span><span class="no">pc</span>
<span class="w">    </span><span class="nf">from</span><span class="w"> </span><span class="no">PostComment</span><span class="w"> </span><span class="no">pc</span>
<span class="w">    </span><span class="nf">join</span><span class="w"> </span><span class="no">fetch</span><span class="w"> </span><span class="no">pc.post</span><span class="w"> </span><span class="no">p</span>
<span class="w">    </span><span class="err">""",</span><span class="w"> </span><span class="nf">PostComment.class</span><span class="p">)</span>
<span class="na">.getResultList</span><span class="p">()</span><span class="c1">;</span>

<span class="nf">for</span><span class="p">(</span><span class="no">PostComment</span><span class="w"> </span><span class="no">comment</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="no">comments</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nf">LOGGER.info</span><span class="p">(</span>
<span class="w">        </span><span class="err">"</span><span class="nf">The</span><span class="w"> </span><span class="no">Post</span><span class="w"> </span><span class="err">'</span><span class="p">{}</span><span class="err">'</span><span class="w"> </span><span class="no">got</span><span class="w"> </span><span class="no">this</span><span class="w"> </span><span class="no">review</span><span class="w"> </span><span class="err">'</span><span class="p">{}</span><span class="err">'"</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="no">comment.getPost</span><span class="p">().</span><span class="no">getTitle</span><span class="p">(),</span><span class="w"> </span>
<span class="w">        </span><span class="no">comment.getReview</span><span class="p">()</span>
<span class="w">    </span><span class="err">)</span><span class="c1">;</span>
<span class="err">}</span>
</pre></div>

<p>This time, Hibernate will execute a single SQL statement:</p>
<div class="code"><pre class="code literal-block"><span class="nv">SELECT</span><span class="w"> </span>
<span class="w">    </span><span class="nv">pc</span>.<span class="nv">id</span><span class="w"> </span><span class="nv">as</span><span class="w"> </span><span class="nv">id1_1_0_</span>,<span class="w"> </span>
<span class="w">    </span><span class="nv">pc</span>.<span class="nv">post_id</span><span class="w"> </span><span class="nv">as</span><span class="w"> </span><span class="nv">post_id3_1_0_</span>,<span class="w"> </span>
<span class="w">    </span><span class="nv">pc</span>.<span class="nv">review</span><span class="w"> </span><span class="nv">as</span><span class="w"> </span><span class="nv">review2_1_0_</span>,<span class="w"> </span>
<span class="w">    </span><span class="nv">p</span>.<span class="nv">id</span><span class="w"> </span><span class="nv">as</span><span class="w"> </span><span class="nv">id1_0_1_</span>,<span class="w"> </span>
<span class="w">    </span><span class="nv">p</span>.<span class="nv">title</span><span class="w"> </span><span class="nv">as</span><span class="w"> </span><span class="nv">title2_0_1_</span><span class="w"> </span>
<span class="nv">FROM</span><span class="w"> </span>
<span class="w">    </span><span class="nv">post_comment</span><span class="w"> </span><span class="nv">pc</span><span class="w"> </span>
<span class="nv">INNER</span><span class="w"> </span><span class="nv">JOIN</span><span class="w"> </span>
<span class="w">    </span><span class="nv">post</span><span class="w"> </span><span class="nv">p</span><span class="w"> </span><span class="nv">ON</span><span class="w"> </span><span class="nv">pc</span>.<span class="nv">post_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">p</span>.<span class="nv">id</span>

<span class="o">--</span><span class="w"> </span><span class="nv">The</span><span class="w"> </span><span class="nv">Post</span><span class="w"> </span><span class="s1">'High-Performance Java Persistence - Part 1'</span><span class="w"> </span><span class="nv">got</span><span class="w"> </span><span class="nv">this</span><span class="w"> </span><span class="nv">review</span><span class="w"> </span>
<span class="o">--</span><span class="w"> </span><span class="s1">'Excellent book to understand Java Persistence'</span>

<span class="o">--</span><span class="w"> </span><span class="nv">The</span><span class="w"> </span><span class="nv">Post</span><span class="w"> </span><span class="s1">'High-Performance Java Persistence - Part 2'</span><span class="w"> </span><span class="nv">got</span><span class="w"> </span><span class="nv">this</span><span class="w"> </span><span class="nv">review</span><span class="w"> </span>
<span class="o">--</span><span class="w"> </span><span class="s1">'Must-read for Java developers'</span>

<span class="o">--</span><span class="w"> </span><span class="nv">The</span><span class="w"> </span><span class="nv">Post</span><span class="w"> </span><span class="s1">'High-Performance Java Persistence - Part 3'</span><span class="w"> </span><span class="nv">got</span><span class="w"> </span><span class="nv">this</span><span class="w"> </span><span class="nv">review</span><span class="w"> </span>
<span class="o">--</span><span class="w"> </span><span class="s1">'Five Stars'</span>

<span class="o">--</span><span class="w"> </span><span class="nv">The</span><span class="w"> </span><span class="nv">Post</span><span class="w"> </span><span class="s1">'High-Performance Java Persistence - Part 4'</span><span class="w"> </span><span class="nv">got</span><span class="w"> </span><span class="nv">this</span><span class="w"> </span><span class="nv">review</span><span class="w"> </span>
<span class="o">--</span><span class="w"> </span><span class="s1">'A great reference book'</span>
</pre></div>

<h3><code>FetchType.LAZY</code></h3>
<p>Even if you switch to using <code>FetchType.LAZY</code> explicitly for all associations,
you can still bump into the N+1 issue.</p>
<p>This time, the <code>post</code> association is mapped like this:</p>
<div class="code"><pre class="code literal-block"><span class="nv">@ManyToOne</span><span class="p">(</span><span class="k">fetch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FetchType</span><span class="p">.</span><span class="n">LAZY</span><span class="p">)</span>
<span class="n">private</span><span class="w"> </span><span class="n">Post</span><span class="w"> </span><span class="n">post</span><span class="p">;</span>
</pre></div>

<p>Now, when you fetch the <code>PostComment</code> entities:</p>
<div class="code"><pre class="code literal-block"><span class="nf">List</span><span class="err">&lt;</span><span class="no">PostComment</span><span class="err">&gt;</span><span class="w"> </span><span class="no">comments</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="no">entityManager</span>
<span class="na">.createQuery</span><span class="p">(</span><span class="s">"""</span>
<span class="s">    select pc</span>
<span class="s">    from PostComment pc</span>
<span class="s">    """</span><span class="p">,</span><span class="w"> </span><span class="no">PostComment.class</span><span class="p">)</span>
<span class="na">.getResultList</span><span class="p">()</span><span class="c1">;</span>
</pre></div>

<p>Hibernate will execute a single SQL statement:</p>
<div class="code"><pre class="code literal-block">SELECT 
    pc.id AS id1_1_, 
    pc.post_id AS post_id3_1_, 
    pc.review AS review2_1_ 
FROM 
    post_comment pc
</pre></div>

<p>But, if afterward, you are going to reference the lazy-loaded <code>post</code>
association:</p>
<div class="code"><pre class="code literal-block"><span class="k">for</span><span class="ss">(</span><span class="nv">PostComment</span><span class="w"> </span><span class="nv">comment</span><span class="w"> </span>:<span class="w"> </span><span class="nv">comments</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">    </span><span class="nv">LOGGER</span>.<span class="nv">info</span><span class="ss">(</span>
<span class="w">        </span><span class="s2">"The Post '{}' got this review '{}'"</span>,<span class="w"> </span>
<span class="w">        </span><span class="nv">comment</span>.<span class="nv">getPost</span><span class="ss">()</span>.<span class="k">getTitle</span><span class="ss">()</span>,<span class="w"> </span>
<span class="w">        </span><span class="nv">comment</span>.<span class="nv">getReview</span><span class="ss">()</span>
<span class="w">    </span><span class="ss">)</span><span class="c1">;</span>
}
</pre></div>

<p>You will get the N+1 query issue:</p>
<div class="code"><pre class="code literal-block"><span class="nv">SELECT</span><span class="w"> </span><span class="nv">p</span>.<span class="nv">id</span><span class="w"> </span><span class="nv">AS</span><span class="w"> </span><span class="nv">id1_0_0_</span>,<span class="w"> </span><span class="nv">p</span>.<span class="nv">title</span><span class="w"> </span><span class="nv">AS</span><span class="w"> </span><span class="nv">title2_0_0_</span><span class="w"> </span><span class="nv">FROM</span><span class="w"> </span><span class="nv">post</span><span class="w"> </span><span class="nv">p</span><span class="w"> </span><span class="nv">WHERE</span><span class="w"> </span><span class="nv">p</span>.<span class="nv">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="o">--</span><span class="w"> </span><span class="nv">The</span><span class="w"> </span><span class="nv">Post</span><span class="w"> </span><span class="s1">'High-Performance Java Persistence - Part 1'</span><span class="w"> </span><span class="nv">got</span><span class="w"> </span><span class="nv">this</span><span class="w"> </span><span class="nv">review</span><span class="w"> </span>
<span class="o">--</span><span class="w"> </span><span class="s1">'Excellent book to understand Java Persistence'</span>

<span class="nv">SELECT</span><span class="w"> </span><span class="nv">p</span>.<span class="nv">id</span><span class="w"> </span><span class="nv">AS</span><span class="w"> </span><span class="nv">id1_0_0_</span>,<span class="w"> </span><span class="nv">p</span>.<span class="nv">title</span><span class="w"> </span><span class="nv">AS</span><span class="w"> </span><span class="nv">title2_0_0_</span><span class="w"> </span><span class="nv">FROM</span><span class="w"> </span><span class="nv">post</span><span class="w"> </span><span class="nv">p</span><span class="w"> </span><span class="nv">WHERE</span><span class="w"> </span><span class="nv">p</span>.<span class="nv">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>
<span class="o">--</span><span class="w"> </span><span class="nv">The</span><span class="w"> </span><span class="nv">Post</span><span class="w"> </span><span class="s1">'High-Performance Java Persistence - Part 2'</span><span class="w"> </span><span class="nv">got</span><span class="w"> </span><span class="nv">this</span><span class="w"> </span><span class="nv">review</span><span class="w"> </span>
<span class="o">--</span><span class="w"> </span><span class="s1">'Must-read for Java developers'</span>

<span class="nv">SELECT</span><span class="w"> </span><span class="nv">p</span>.<span class="nv">id</span><span class="w"> </span><span class="nv">AS</span><span class="w"> </span><span class="nv">id1_0_0_</span>,<span class="w"> </span><span class="nv">p</span>.<span class="nv">title</span><span class="w"> </span><span class="nv">AS</span><span class="w"> </span><span class="nv">title2_0_0_</span><span class="w"> </span><span class="nv">FROM</span><span class="w"> </span><span class="nv">post</span><span class="w"> </span><span class="nv">p</span><span class="w"> </span><span class="nv">WHERE</span><span class="w"> </span><span class="nv">p</span>.<span class="nv">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span>
<span class="o">--</span><span class="w"> </span><span class="nv">The</span><span class="w"> </span><span class="nv">Post</span><span class="w"> </span><span class="s1">'High-Performance Java Persistence - Part 3'</span><span class="w"> </span><span class="nv">got</span><span class="w"> </span><span class="nv">this</span><span class="w"> </span><span class="nv">review</span><span class="w"> </span>
<span class="o">--</span><span class="w"> </span><span class="s1">'Five Stars'</span>

<span class="nv">SELECT</span><span class="w"> </span><span class="nv">p</span>.<span class="nv">id</span><span class="w"> </span><span class="nv">AS</span><span class="w"> </span><span class="nv">id1_0_0_</span>,<span class="w"> </span><span class="nv">p</span>.<span class="nv">title</span><span class="w"> </span><span class="nv">AS</span><span class="w"> </span><span class="nv">title2_0_0_</span><span class="w"> </span><span class="nv">FROM</span><span class="w"> </span><span class="nv">post</span><span class="w"> </span><span class="nv">p</span><span class="w"> </span><span class="nv">WHERE</span><span class="w"> </span><span class="nv">p</span>.<span class="nv">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span>
<span class="o">--</span><span class="w"> </span><span class="nv">The</span><span class="w"> </span><span class="nv">Post</span><span class="w"> </span><span class="s1">'High-Performance Java Persistence - Part 4'</span><span class="w"> </span><span class="nv">got</span><span class="w"> </span><span class="nv">this</span><span class="w"> </span><span class="nv">review</span><span class="w"> </span>
<span class="o">--</span><span class="w"> </span><span class="s1">'A great reference book'</span>
</pre></div>

<p>Because the <code>post</code> association is fetched lazily, a secondary SQL statement
will be executed when accessing the lazy association in order to build the log
message.</p>
<p>Again, the fix consists in adding a <code>JOIN FETCH</code> clause to the JPQL query:</p>
<div class="code"><pre class="code literal-block"><span class="nf">List</span><span class="err">&lt;</span><span class="no">PostComment</span><span class="err">&gt;</span><span class="w"> </span><span class="no">comments</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="no">entityManager.createQuery</span><span class="p">(</span><span class="err">"""</span>
<span class="w">    </span><span class="nf">select</span><span class="w"> </span><span class="no">pc</span>
<span class="w">    </span><span class="nf">from</span><span class="w"> </span><span class="no">PostComment</span><span class="w"> </span><span class="no">pc</span>
<span class="w">    </span><span class="nf">join</span><span class="w"> </span><span class="no">fetch</span><span class="w"> </span><span class="no">pc.post</span><span class="w"> </span><span class="no">p</span>
<span class="w">    </span><span class="err">""",</span><span class="w"> </span><span class="nf">PostComment.class</span><span class="p">)</span>
<span class="na">.getResultList</span><span class="p">()</span><span class="c1">;</span>

<span class="nf">for</span><span class="p">(</span><span class="no">PostComment</span><span class="w"> </span><span class="no">comment</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="no">comments</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nf">LOGGER.info</span><span class="p">(</span>
<span class="w">        </span><span class="err">"</span><span class="nf">The</span><span class="w"> </span><span class="no">Post</span><span class="w"> </span><span class="err">'</span><span class="p">{}</span><span class="err">'</span><span class="w"> </span><span class="no">got</span><span class="w"> </span><span class="no">this</span><span class="w"> </span><span class="no">review</span><span class="w"> </span><span class="err">'</span><span class="p">{}</span><span class="err">'"</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="no">comment.getPost</span><span class="p">().</span><span class="no">getTitle</span><span class="p">(),</span><span class="w"> </span>
<span class="w">        </span><span class="no">comment.getReview</span><span class="p">()</span>
<span class="w">    </span><span class="err">)</span><span class="c1">;</span>
<span class="err">}</span>
</pre></div>

<p>And, just like in the <code>FetchType.EAGER</code> example, this JPQL query will generate
a single SQL statement.</p>
<blockquote>
<p>Even if you are using <code>FetchType.LAZY</code> and don't reference the child
association of a bidirectional <code>@OneToOne</code> JPA relationship, you can still
trigger the N+1 query issue.</p>
</blockquote>
<h3>How to automatically detect the N+1 query issue</h3>
<p>If you want to automatically detect N+1 query issue in your data access layer,
you can use the <code>db-util</code> open-source project.</p>
<p>First, you need to add the following Maven dependency:</p>
<div class="code"><pre class="code literal-block"><span class="nt">&lt;dependency&gt;</span>
<span class="w">    </span><span class="nt">&lt;groupId&gt;</span>com.vladmihalcea<span class="nt">&lt;/groupId&gt;</span>
<span class="w">    </span><span class="nt">&lt;artifactId&gt;</span>db-util<span class="nt">&lt;/artifactId&gt;</span>
<span class="w">    </span><span class="nt">&lt;version&gt;</span><span class="cp">${</span><span class="n">db</span><span class="o">-</span><span class="n">util</span><span class="o">.</span><span class="n">version</span><span class="cp">}</span><span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</pre></div>

<p>Afterward, you just have to use <code>SQLStatementCountValidator</code> utility to assert
the underlying SQL statements that get generated:</p>
<div class="code"><pre class="code literal-block"><span class="nf">SQLStatementCountValidator.reset</span><span class="p">()</span><span class="c1">;</span>

<span class="nf">List</span><span class="err">&lt;</span><span class="no">PostComment</span><span class="err">&gt;</span><span class="w"> </span><span class="no">comments</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="no">entityManager.createQuery</span><span class="p">(</span><span class="err">"""</span>
<span class="w">    </span><span class="nf">select</span><span class="w"> </span><span class="no">pc</span>
<span class="w">    </span><span class="nf">from</span><span class="w"> </span><span class="no">PostComment</span><span class="w"> </span><span class="no">pc</span>
<span class="w">    </span><span class="err">""",</span><span class="w"> </span><span class="nf">PostComment.class</span><span class="p">)</span>
<span class="na">.getResultList</span><span class="p">()</span><span class="c1">;</span>

<span class="nf">SQLStatementCountValidator.assertSelectCount</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="c1">;</span>
</pre></div>

<p>In case you are using <code>FetchType.EAGER</code> and run the above test case, you will
get the following test case failure:</p>
<div class="code"><pre class="code literal-block">SELECT 
    pc.id as id1_1_, 
    pc.post_id as post_id3_1_, 
    pc.review as review2_1_ 
FROM 
    post_comment pc

SELECT p.id as id1_0_0_, p.title as title2_0_0_ FROM post p WHERE p.id = 1

SELECT p.id as id1_0_0_, p.title as title2_0_0_ FROM post p WHERE p.id = 2


-- SQLStatementCountMismatchException: Expected 1 statement(s) but recorded 3 instead!
</pre></div>

<p><br><br><a href="../what-is-the-n-1-selects-problem-in-orm-object-relational-mapping/">查看原文</a></p>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/database/" rel="tag">database</a></li>
            <li><a class="tag p-category" href="../../categories/orm/" rel="tag">orm</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../cong-zui-xin-ti-jiao-zhong-shan-chu-wen-jian/" rel="prev" title="从最新提交中删除文件">Previous post</a>
            </li>
            <li class="next">
                <a href="../fang-fa-he-han-shu-you-shi-yao-qu-bie/" rel="next" title="方法和函数有什么区别？">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="../../assets/js/search.js"></script>
</body>
</html>
