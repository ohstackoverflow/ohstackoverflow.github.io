<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>字符串格式：% vs.format vs. f-string literal | StackOverflow Snapshot</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/posts/zi-fu-chuan-ge-shi-vs-format-vs-f-string-literal/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Arya">
<link rel="prev" href="../ru-he-shi-yong-jquery-geng-gai-chao-lian-jie-de-href-shu-xing/" title="如何使用 jQuery 更改超链接的 href 属性" type="text/html">
<link rel="next" href="../ru-he-qiang-zhi-docker-gan-jing-di-gou-jian-tu-xiang/" title="如何强制 Docker 干净地构建图像" type="text/html">
<meta property="og:site_name" content="StackOverflow Snapshot">
<meta property="og:title" content="字符串格式：% vs.format vs. f-string literal">
<meta property="og:url" content="https://ohstackoverflow.netlify.app/posts/zi-fu-chuan-ge-shi-vs-format-vs-f-string-literal/">
<meta property="og:description" content='有多种字符串格式化方法：

蟒蛇&lt;2.6："Hello %s" % name
Python 2.6+：（"Hello {}".format(name) 使用str.format）
Python 3.6+：（f"{name}" 使用 f 字符串）

哪个更好，适用于什么情况？



下面这几种方法的结果是一样的，那么有什么区别呢？
name = "Alice"


"Hello %s" % name'>
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-02-17T02:20:54+08:00">
<meta property="article:tag" content="f-string">
<meta property="article:tag" content="performance">
<meta property="article:tag" content="python">
<meta property="article:tag" content="string-formatting">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">字符串格式：% vs.format vs. f-string literal</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T02:20:54+08:00" itemprop="datePublished" title="2023-02-17 02:20">2023-02-17 02:20</time></a>
            </p>
            

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>有多种字符串格式化方法：</p>
<ul>
<li>蟒蛇&lt;2.6：<code>"Hello %s" % name</code>
</li>
<li>Python 2.6+：（<code>"Hello {}".format(name)</code> 使用<code>str.format</code>）</li>
<li>Python 3.6+：（<code>f"{name}"</code> 使用 f 字符串）</li>
</ul>
<p>哪个更好，适用于什么情况？</p>
<hr>
<ol>
<li>
<p>下面这几种方法的结果是一样的，那么有什么区别呢？</p>
<div class="code"><pre class="code literal-block">name = "Alice"
</pre></div>

<p>"Hello %s" % name
"Hello {0}".format(name)
f"Hello {name}"</p>
<h2>Using named arguments:</h2>
<p>"Hello %(kwarg)s" % {'kwarg': name}
"Hello {kwarg}".format(kwarg=name)
f"Hello {name}"</p>
</li>
<li>
<p>字符串格式化何时运行，如何避免运行时性能损失？</p>
</li>
</ol>
<hr>
<p>如果您试图关闭只是寻找格式化字符串的方法的重复问题，请使用如何将变量的值放入字符串中？.</p>
<p><br><br></p>
<h2>解答</h2>
<p>回答你的第一个问题......<code>.format</code>只是在很多方面看起来更复杂。一个烦人的事情<code>%</code>也是它如何接受变量或元组。你会认为以下总是有效的：</p>
<div class="code"><pre class="code literal-block">"Hello %s" % name
</pre></div>

<p>然而，如果<code>name</code>碰巧是<code>(1, 2, 3)</code>，它会抛出一个<code>TypeError</code>. 为了保证它总是打印，你需要做</p>
<div class="code"><pre class="code literal-block">"Hello %s" % (name,)   # supply the single argument as a single-item tuple
</pre></div>

<p>这太丑了。<code>.format</code>没有那些问题。同样在你给出的第二个例子中，这个<code>.format</code>例子看起来更清晰。</p>
<p>仅将其用于与 Python 2.5 的向后兼容。</p>
<hr>
<p>要回答您的第二个问题，字符串格式化与任何其他操作同时发生 - 当评估字符串格式化表达式时。Python
不是惰性语言，它会在调用函数之前对表达式求值，因此表达式<code>log.debug("some debug info: %s" %
some_info)</code>会首先对字符串求值，例如<code>"some debug info: roflcopters are
active"</code>，然后将该字符串传递给<code>log.debug()</code>。</p>
<p><br></p>
<h3>更多建议</h3>
<p>模运算符（ % ）不能做的事情，afaik：</p>
<div class="code"><pre class="code literal-block">tu = (12,45,22222,103,6)
print '{0} {2} {1} {2} {3} {2} {4} {2}'.format(*tu)
</pre></div>

<p>结果</p>
<div class="code"><pre class="code literal-block"><span class="mf">12</span><span class="w"> </span><span class="mf">22222</span><span class="w"> </span><span class="mf">45</span><span class="w"> </span><span class="mf">22222</span><span class="w"> </span><span class="mf">103</span><span class="w"> </span><span class="mf">22222</span><span class="w"> </span><span class="mf">6</span><span class="w"> </span><span class="mf">22222</span>
</pre></div>

<p>很有用。</p>
<p>还有一点：<code>format()</code>作为一个函数，可以在其他函数中用作参数：</p>
<div class="code"><pre class="code literal-block"><span class="n">li</span> <span class="o">=</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">78</span><span class="p">,</span><span class="mi">784</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">69</span><span class="p">,</span><span class="mi">1254</span><span class="p">,</span><span class="mi">4785</span><span class="p">,</span><span class="mi">984</span><span class="p">]</span>
<span class="nb">print</span> <span class="nb">map</span><span class="p">(</span><span class="s1">'the number is </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">,</span><span class="n">li</span><span class="p">)</span>

<span class="nb">print</span>

<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span><span class="n">timedelta</span>

<span class="n">once_upon_a_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2010</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">delta</span> <span class="o">=</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">hours</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>  <span class="n">minutes</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="n">gen</span> <span class="o">=</span><span class="p">(</span><span class="n">once_upon_a_time</span> <span class="o">+</span><span class="n">x</span><span class="o">*</span><span class="n">delta</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>

<span class="nb">print</span> <span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="s1">'{:%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S}'</span><span class="o">.</span><span class="n">format</span><span class="p">,</span> <span class="n">gen</span><span class="p">))</span>
</pre></div>

<p>结果是：</p>
<div class="code"><pre class="code literal-block"><span class="k">['the number is 12', 'the number is 45', 'the number is 78', 'the number is 784', 'the number is 2', 'the number is 69', 'the number is 1254', 'the number is 4785', 'the number is 984']</span>

<span class="na">2010-07-01 12</span><span class="o">:</span><span class="s">00:00</span>
<span class="na">2010-07-14 20</span><span class="o">:</span><span class="s">20:00</span>
<span class="na">2010-07-28 04</span><span class="o">:</span><span class="s">40:00</span>
<span class="na">2010-08-10 13</span><span class="o">:</span><span class="s">00:00</span>
<span class="na">2010-08-23 21</span><span class="o">:</span><span class="s">20:00</span>
<span class="na">2010-09-06 05</span><span class="o">:</span><span class="s">40:00</span>
<span class="na">2010-09-19 14</span><span class="o">:</span><span class="s">00:00</span>
<span class="na">2010-10-02 22</span><span class="o">:</span><span class="s">20:00</span>
<span class="na">2010-10-16 06</span><span class="o">:</span><span class="s">40:00</span>
<span class="na">2010-10-29 15</span><span class="o">:</span><span class="s">00:00</span>
<span class="na">2010-11-11 23</span><span class="o">:</span><span class="s">20:00</span>
<span class="na">2010-11-25 07</span><span class="o">:</span><span class="s">40:00</span>
<span class="na">2010-12-08 16</span><span class="o">:</span><span class="s">00:00</span>
<span class="na">2010-12-22 00</span><span class="o">:</span><span class="s">20:00</span>
<span class="na">2011-01-04 08</span><span class="o">:</span><span class="s">40:00</span>
<span class="na">2011-01-17 17</span><span class="o">:</span><span class="s">00:00</span>
<span class="na">2011-01-31 01</span><span class="o">:</span><span class="s">20:00</span>
<span class="na">2011-02-13 09</span><span class="o">:</span><span class="s">40:00</span>
<span class="na">2011-02-26 18</span><span class="o">:</span><span class="s">00:00</span>
<span class="na">2011-03-12 02</span><span class="o">:</span><span class="s">20:00</span>
</pre></div>

<p><br><br><a href="../string-formatting-vs-format-vs-f-string-literal/">查看原文</a></p>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/f-string/" rel="tag">f-string</a></li>
            <li><a class="tag p-category" href="../../categories/performance/" rel="tag">performance</a></li>
            <li><a class="tag p-category" href="../../categories/python/" rel="tag">python</a></li>
            <li><a class="tag p-category" href="../../categories/string-formatting/" rel="tag">string-formatting</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../ru-he-shi-yong-jquery-geng-gai-chao-lian-jie-de-href-shu-xing/" rel="prev" title="如何使用 jQuery 更改超链接的 href 属性">Previous post</a>
            </li>
            <li class="next">
                <a href="../ru-he-qiang-zhi-docker-gan-jing-di-gou-jian-tu-xiang/" rel="next" title="如何强制 Docker 干净地构建图像">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="../../assets/js/search.js"></script>
</body>
</html>
