<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>What does the "yield" keyword do in Python? | StackOverflow Snapshot</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/posts/what-does-the-yield-keyword-do-in-python/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Arya">
<link rel="prev" href="../what-is-the-difference-between-git-pull-and-git-fetch/" title="What is the difference between 'git pull' and 'git fetch'?" type="text/html">
<link rel="next" href="../which-json-content-type-do-i-use/" title="Which JSON content type do I use?" type="text/html">
<meta property="og:site_name" content="StackOverflow Snapshot">
<meta property="og:title" content='What does the "yield" keyword do in Python?'>
<meta property="og:url" content="https://ohstackoverflow.netlify.app/posts/what-does-the-yield-keyword-do-in-python/">
<meta property="og:description" content="Want to improve this post? Provide detailed answers to this question,
including citations and an explanation of why your answer is correct. Answers
without enough detail may be edited or deleted.
What">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-02-16T18:13:21+08:00">
<meta property="article:tag" content="generator">
<meta property="article:tag" content="iterator">
<meta property="article:tag" content="python">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">What does the "yield" keyword do in Python?</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2023-02-16T18:13:21+08:00" itemprop="datePublished" title="2023-02-16 18:13">2023-02-16 18:13</time></a>
            </p>
            

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p><strong>Want to improve this post?</strong> Provide detailed answers to this question,
including citations and an explanation of why your answer is correct. Answers
without enough detail may be edited or deleted.</p>
<p>What is the use of the <code>yield</code> keyword in Python? What does it do?</p>
<p>For example, I'm trying to understand this code <strong>1</strong> :</p>
<div class="code"><pre class="code literal-block"><span class="nv">def</span><span class="w"> </span><span class="nv">_get_child_candidates</span><span class="ss">(</span><span class="nv">self</span>,<span class="w"> </span><span class="nv">distance</span>,<span class="w"> </span><span class="nv">min_dist</span>,<span class="w"> </span><span class="nv">max_dist</span><span class="ss">)</span>:
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nv">self</span>.<span class="nv">_leftchild</span><span class="w"> </span><span class="nv">and</span><span class="w"> </span><span class="nv">distance</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nv">max_dist</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nv">self</span>.<span class="nv">_median</span>:
<span class="w">        </span><span class="nv">yield</span><span class="w"> </span><span class="nv">self</span>.<span class="nv">_leftchild</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nv">self</span>.<span class="nv">_rightchild</span><span class="w"> </span><span class="nv">and</span><span class="w"> </span><span class="nv">distance</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nv">max_dist</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nv">self</span>.<span class="nv">_median</span>:
<span class="w">        </span><span class="nv">yield</span><span class="w"> </span><span class="nv">self</span>.<span class="nv">_rightchild</span>
</pre></div>

<p>And this is the caller:</p>
<div class="code"><pre class="code literal-block"><span class="k">result</span><span class="p">,</span><span class="w"> </span><span class="n">candidates</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">[]</span><span class="p">,</span><span class="w"> </span><span class="o">[</span><span class="n">self</span><span class="o">]</span>
<span class="k">while</span><span class="w"> </span><span class="nl">candidates</span><span class="p">:</span>
<span class="w">    </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">candidates</span><span class="p">.</span><span class="n">pop</span><span class="p">()</span>
<span class="w">    </span><span class="n">distance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="p">.</span><span class="n">_get_dist</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">distance</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">max_dist</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">distance</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nl">min_dist</span><span class="p">:</span>
<span class="w">        </span><span class="k">result</span><span class="p">.</span><span class="n">extend</span><span class="p">(</span><span class="n">node</span><span class="p">.</span><span class="n">_values</span><span class="p">)</span>
<span class="w">    </span><span class="n">candidates</span><span class="p">.</span><span class="n">extend</span><span class="p">(</span><span class="n">node</span><span class="p">.</span><span class="n">_get_child_candidates</span><span class="p">(</span><span class="n">distance</span><span class="p">,</span><span class="w"> </span><span class="n">min_dist</span><span class="p">,</span><span class="w"> </span><span class="n">max_dist</span><span class="p">))</span>
<span class="k">return</span><span class="w"> </span><span class="k">result</span>
</pre></div>

<p>What happens when the method <code>_get_child_candidates</code> is called? Is a list
returned? A single element? Is it called again? When will subsequent calls
stop?</p>
<hr>
<p>1. This piece of code was written by Jochen Schulz (jrschulz), who made a
great Python library for metric spaces. This is the link to the complete
source: Module mspace.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>To understand what <code>yield</code> does, you must understand what <em>generators</em> are.
And before you can understand generators, you must understand <em>iterables</em>.</p>
<h3>Iterables</h3>
<p>When you create a list, you can read its items one by one. Reading its items
one by one is called iteration:</p>
<div class="code"><pre class="code literal-block"><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="nv">mylist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>[<span class="mi">1</span>,<span class="w"> </span><span class="mi">2</span>,<span class="w"> </span><span class="mi">3</span>]
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">mylist</span>:
...<span class="w">    </span><span class="nv">print</span><span class="ss">(</span><span class="nv">i</span><span class="ss">)</span>
<span class="mi">1</span>
<span class="mi">2</span>
<span class="mi">3</span>
</pre></div>

<p><code>mylist</code> is an <em>iterable</em>. When you use a list comprehension, you create a
list, and so an iterable:</p>
<div class="code"><pre class="code literal-block"><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="nv">mylist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>[<span class="nv">x</span><span class="o">*</span><span class="nv">x</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">range</span><span class="ss">(</span><span class="mi">3</span><span class="ss">)</span>]
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">mylist</span>:
...<span class="w">    </span><span class="nv">print</span><span class="ss">(</span><span class="nv">i</span><span class="ss">)</span>
<span class="mi">0</span>
<span class="mi">1</span>
<span class="mi">4</span>
</pre></div>

<p>Everything you can use "<code>for... in...</code>" on is an iterable; <code>lists</code>, <code>strings</code>,
files...</p>
<p>These iterables are handy because you can read them as much as you wish, but
you store all the values in memory and this is not always what you want when
you have a lot of values.</p>
<h3>Generators</h3>
<p>Generators are iterators, a kind of iterable <strong>you can only iterate over
once</strong>. Generators do not store all the values in memory, <strong>they generate the
values on the fly</strong> :</p>
<div class="code"><pre class="code literal-block"><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="nv">mygenerator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">(</span><span class="nv">x</span><span class="o">*</span><span class="nv">x</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">range</span><span class="ss">(</span><span class="mi">3</span><span class="ss">))</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">mygenerator</span>:
...<span class="w">    </span><span class="nv">print</span><span class="ss">(</span><span class="nv">i</span><span class="ss">)</span>
<span class="mi">0</span>
<span class="mi">1</span>
<span class="mi">4</span>
</pre></div>

<p>It is just the same except you used <code>()</code> instead of <code>[]</code>. BUT, you <strong>cannot</strong>
perform <code>for i in mygenerator</code> a second time since generators can only be used
once: they calculate 0, then forget about it and calculate 1, and end
calculating 4, one by one.</p>
<h3>Yield</h3>
<p><code>yield</code> is a keyword that is used like <code>return</code>, except the function will
return a generator.</p>
<div class="code"><pre class="code literal-block"><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="nv">def</span><span class="w"> </span><span class="nv">create_generator</span><span class="ss">()</span>:
...<span class="w">    </span><span class="nv">mylist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">range</span><span class="ss">(</span><span class="mi">3</span><span class="ss">)</span>
...<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">mylist</span>:
...<span class="w">        </span><span class="nv">yield</span><span class="w"> </span><span class="nv">i</span><span class="o">*</span><span class="nv">i</span>
...
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="nv">mygenerator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">create_generator</span><span class="ss">()</span><span class="w"> </span>#<span class="w"> </span><span class="nv">create</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">generator</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="nv">print</span><span class="ss">(</span><span class="nv">mygenerator</span><span class="ss">)</span><span class="w"> </span>#<span class="w"> </span><span class="nv">mygenerator</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">an</span><span class="w"> </span><span class="nv">object</span><span class="o">!</span>
<span class="o">&lt;</span><span class="nv">generator</span><span class="w"> </span><span class="nv">object</span><span class="w"> </span><span class="nv">create_generator</span><span class="w"> </span><span class="nv">at</span><span class="w"> </span><span class="mi">0</span><span class="nv">xb7555c34</span><span class="o">&gt;</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">mygenerator</span>:
...<span class="w">     </span><span class="nv">print</span><span class="ss">(</span><span class="nv">i</span><span class="ss">)</span>
<span class="mi">0</span>
<span class="mi">1</span>
<span class="mi">4</span>
</pre></div>

<p>Here it's a useless example, but it's handy when you know your function will
return a huge set of values that you will only need to read once.</p>
<p>To master <code>yield</code>, you must understand that <strong>when you call the function, the
code you have written in the function body does not run.</strong> The function only
returns the generator object, this is a bit tricky.</p>
<p>Then, your code will continue from where it left off each time <code>for</code> uses the
generator.</p>
<p>Now the hard part:</p>
<p>The first time the <code>for</code> calls the generator object created from your
function, it will run the code in your function from the beginning until it
hits <code>yield</code>, then it'll return the first value of the loop. Then, each
subsequent call will run another iteration of the loop you have written in the
function and return the next value. This will continue until the generator is
considered empty, which happens when the function runs without hitting
<code>yield</code>. That can be because the loop has come to an end, or because you no
longer satisfy an <code>"if/else"</code>.</p>
<hr>
<h3>Your code explained</h3>
<p><em>Generator:</em></p>
<div class="code"><pre class="code literal-block">#<span class="w"> </span><span class="nv">Here</span><span class="w"> </span><span class="nv">you</span><span class="w"> </span><span class="nv">create</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">method</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">node</span><span class="w"> </span><span class="nv">object</span><span class="w"> </span><span class="nv">that</span><span class="w"> </span><span class="nv">will</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">generator</span>
<span class="nv">def</span><span class="w"> </span><span class="nv">_get_child_candidates</span><span class="ss">(</span><span class="nv">self</span>,<span class="w"> </span><span class="nv">distance</span>,<span class="w"> </span><span class="nv">min_dist</span>,<span class="w"> </span><span class="nv">max_dist</span><span class="ss">)</span>:

<span class="w">    </span>#<span class="w"> </span><span class="nv">Here</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">code</span><span class="w"> </span><span class="nv">that</span><span class="w"> </span><span class="nv">will</span><span class="w"> </span><span class="nv">be</span><span class="w"> </span><span class="nv">called</span><span class="w"> </span><span class="nv">each</span><span class="w"> </span><span class="nv">time</span><span class="w"> </span><span class="nv">you</span><span class="w"> </span><span class="nv">use</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">generator</span><span class="w"> </span><span class="nv">object</span>:

<span class="w">    </span>#<span class="w"> </span><span class="k">If</span><span class="w"> </span><span class="nv">there</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">still</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">child</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">node</span><span class="w"> </span><span class="nv">object</span><span class="w"> </span><span class="nv">on</span><span class="w"> </span><span class="nv">its</span><span class="w"> </span><span class="nv">left</span>
<span class="w">    </span>#<span class="w"> </span><span class="nv">AND</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">distance</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">ok</span>,<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="k">next</span><span class="w"> </span><span class="nv">child</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nv">self</span>.<span class="nv">_leftchild</span><span class="w"> </span><span class="nv">and</span><span class="w"> </span><span class="nv">distance</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nv">max_dist</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nv">self</span>.<span class="nv">_median</span>:
<span class="w">        </span><span class="nv">yield</span><span class="w"> </span><span class="nv">self</span>.<span class="nv">_leftchild</span>

<span class="w">    </span>#<span class="w"> </span><span class="k">If</span><span class="w"> </span><span class="nv">there</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">still</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">child</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">node</span><span class="w"> </span><span class="nv">object</span><span class="w"> </span><span class="nv">on</span><span class="w"> </span><span class="nv">its</span><span class="w"> </span><span class="nv">right</span>
<span class="w">    </span>#<span class="w"> </span><span class="nv">AND</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">distance</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">ok</span>,<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="k">next</span><span class="w"> </span><span class="nv">child</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nv">self</span>.<span class="nv">_rightchild</span><span class="w"> </span><span class="nv">and</span><span class="w"> </span><span class="nv">distance</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nv">max_dist</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nv">self</span>.<span class="nv">_median</span>:
<span class="w">        </span><span class="nv">yield</span><span class="w"> </span><span class="nv">self</span>.<span class="nv">_rightchild</span>

<span class="w">    </span>#<span class="w"> </span><span class="k">If</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">function</span><span class="w"> </span><span class="nv">arrives</span><span class="w"> </span><span class="nv">here</span>,<span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">generator</span><span class="w"> </span><span class="nv">will</span><span class="w"> </span><span class="nv">be</span><span class="w"> </span><span class="nv">considered</span><span class="w"> </span><span class="nv">empty</span>
<span class="w">    </span>#<span class="w"> </span><span class="nv">there</span><span class="w"> </span><span class="nv">are</span><span class="w"> </span><span class="nv">no</span><span class="w"> </span><span class="nv">more</span><span class="w"> </span><span class="nv">than</span><span class="w"> </span><span class="nv">two</span><span class="w"> </span><span class="nv">values</span>:<span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">left</span><span class="w"> </span><span class="nv">and</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">right</span><span class="w"> </span><span class="nv">children</span>
</pre></div>

<p><em>Caller:</em></p>
<div class="code"><pre class="code literal-block"><span class="err">#</span><span class="w"> </span><span class="k">Create</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">empty</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">current</span><span class="w"> </span><span class="k">object</span><span class="w"> </span><span class="n">reference</span>
<span class="k">result</span><span class="p">,</span><span class="w"> </span><span class="n">candidates</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">list</span><span class="p">(),</span><span class="w"> </span><span class="o">[</span><span class="n">self</span><span class="o">]</span>

<span class="err">#</span><span class="w"> </span><span class="n">Loop</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">candidates</span><span class="w"> </span><span class="p">(</span><span class="n">they</span><span class="w"> </span><span class="n">contain</span><span class="w"> </span><span class="k">only</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="k">element</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">beginning</span><span class="p">)</span>
<span class="k">while</span><span class="w"> </span><span class="nl">candidates</span><span class="p">:</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="k">Get</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">last</span><span class="w"> </span><span class="n">candidate</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">remove</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">list</span>
<span class="w">    </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">candidates</span><span class="p">.</span><span class="n">pop</span><span class="p">()</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="k">Get</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">distance</span><span class="w"> </span><span class="ow">between</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">candidate</span>
<span class="w">    </span><span class="n">distance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="p">.</span><span class="n">_get_dist</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="k">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">distance</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">ok</span><span class="p">,</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">result</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">distance</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">max_dist</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">distance</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nl">min_dist</span><span class="p">:</span>
<span class="w">        </span><span class="k">result</span><span class="p">.</span><span class="n">extend</span><span class="p">(</span><span class="n">node</span><span class="p">.</span><span class="n">_values</span><span class="p">)</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="k">Add</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">children</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">candidate</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">candidate</span><span class="err">'</span><span class="n">s</span><span class="w"> </span><span class="n">list</span>
<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">keep</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="n">until</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">looked</span>
<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="ow">all</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">children</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">children</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">children</span><span class="p">,</span><span class="w"> </span><span class="n">etc</span><span class="p">.</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">candidate</span>
<span class="w">    </span><span class="n">candidates</span><span class="p">.</span><span class="n">extend</span><span class="p">(</span><span class="n">node</span><span class="p">.</span><span class="n">_get_child_candidates</span><span class="p">(</span><span class="n">distance</span><span class="p">,</span><span class="w"> </span><span class="n">min_dist</span><span class="p">,</span><span class="w"> </span><span class="n">max_dist</span><span class="p">))</span>

<span class="k">return</span><span class="w"> </span><span class="k">result</span>
</pre></div>

<p>This code contains several smart parts:</p>
<ul>
<li>
<p>The loop iterates on a list, but the list expands while the loop is being iterated. It's a concise way to go through all these nested data even if it's a bit dangerous since you can end up with an infinite loop. In this case, <code>candidates.extend(node._get_child_candidates(distance, min_dist, max_dist))</code> exhausts all the values of the generator, but <code>while</code> keeps creating new generator objects which will produce different values from the previous ones since it's not applied on the same node.</p>
</li>
<li>
<p>The <code>extend()</code> method is a list object method that expects an iterable and adds its values to the list.</p>
</li>
</ul>
<p>Usually, we pass a list to it:</p>
<div class="code"><pre class="code literal-block">&gt;&gt;&gt; a = [1, 2]
&gt;&gt;&gt; b = [3, 4]
&gt;&gt;&gt; a.extend(b)
&gt;&gt;&gt; print(a)
[1, 2, 3, 4]
</pre></div>

<p>But in your code, it gets a generator, which is good because:</p>
<ol>
<li>You don't need to read the values twice.</li>
<li>You may have a lot of children and you don't want them all stored in memory.</li>
</ol>
<p>And it works because Python does not care if the argument of a method is a
list or not. Python expects iterables so it will work with strings, lists,
tuples, and generators! This is called duck typing and is one of the reasons
why Python is so cool. But this is another story, for another question...</p>
<p>You can stop here, or read a little bit to see an advanced use of a generator:</p>
<h3>Controlling a generator exhaustion</h3>
<div class="code"><pre class="code literal-block"><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="nv">class</span><span class="w"> </span><span class="nv">Bank</span><span class="ss">()</span>:<span class="w"> </span>#<span class="w"> </span><span class="nv">Let</span><span class="err">'s create a bank, building ATMs</span>
<span class="err">...    crisis = False</span>
<span class="err">...    def create_atm(self):</span>
<span class="err">...        while not self.crisis:</span>
<span class="err">...            yield "$100"</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="nv">hsbc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">Bank</span><span class="ss">()</span><span class="w"> </span>#<span class="w"> </span><span class="nv">When</span><span class="w"> </span><span class="nv">everything</span><span class="err">'s ok the ATM gives you as much as you want</span>
<span class="err">&gt;&gt;&gt; corner_street_atm = hsbc.create_atm()</span>
<span class="err">&gt;&gt;&gt; print(corner_street_atm.next())</span>
<span class="err">$100</span>
<span class="err">&gt;&gt;&gt; print(corner_street_atm.next())</span>
<span class="err">$100</span>
<span class="err">&gt;&gt;&gt; print([corner_street_atm.next() for cash in range(5)])</span>
[<span class="s1">'$100'</span>,<span class="w"> </span><span class="s1">'$100'</span>,<span class="w"> </span><span class="s1">'$100'</span>,<span class="w"> </span><span class="s1">'$100'</span>,<span class="w"> </span><span class="s1">'$100'</span>]
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="nv">hsbc</span>.<span class="nv">crisis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">True</span><span class="w"> </span>#<span class="w"> </span><span class="nv">Crisis</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">coming</span>,<span class="w"> </span><span class="nv">no</span><span class="w"> </span><span class="nv">more</span><span class="w"> </span><span class="nv">money</span><span class="o">!</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="nv">print</span><span class="ss">(</span><span class="nv">corner_street_atm</span>.<span class="k">next</span><span class="ss">())</span>
<span class="o">&lt;</span><span class="nv">type</span><span class="w"> </span><span class="s1">'exceptions.StopIteration'</span><span class="o">&gt;</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="nv">wall_street_atm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">hsbc</span>.<span class="nv">create_atm</span><span class="ss">()</span><span class="w"> </span>#<span class="w"> </span><span class="nv">It</span><span class="err">'s even true for new ATMs</span>
<span class="err">&gt;&gt;&gt; print(wall_street_atm.next())</span>
<span class="o">&lt;</span><span class="nv">type</span><span class="w"> </span><span class="s1">'exceptions.StopIteration'</span><span class="o">&gt;</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="nv">hsbc</span>.<span class="nv">crisis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">False</span><span class="w"> </span>#<span class="w"> </span><span class="nv">The</span><span class="w"> </span><span class="nv">trouble</span><span class="w"> </span><span class="nv">is</span>,<span class="w"> </span><span class="nv">even</span><span class="w"> </span><span class="nv">post</span><span class="o">-</span><span class="nv">crisis</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">ATM</span><span class="w"> </span><span class="nv">remains</span><span class="w"> </span><span class="nv">empty</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="nv">print</span><span class="ss">(</span><span class="nv">corner_street_atm</span>.<span class="k">next</span><span class="ss">())</span>
<span class="o">&lt;</span><span class="nv">type</span><span class="w"> </span><span class="s1">'exceptions.StopIteration'</span><span class="o">&gt;</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="nv">brand_new_atm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">hsbc</span>.<span class="nv">create_atm</span><span class="ss">()</span><span class="w"> </span>#<span class="w"> </span><span class="nv">Build</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">one</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">get</span><span class="w"> </span><span class="nv">back</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">business</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">cash</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">brand_new_atm</span>:
...<span class="w">    </span><span class="nv">print</span><span class="w"> </span><span class="nv">cash</span>
<span class="mh">$100</span>
<span class="mh">$100</span>
<span class="mh">$100</span>
<span class="mh">$100</span>
<span class="mh">$100</span>
<span class="mh">$100</span>
<span class="mh">$100</span>
<span class="mh">$100</span>
<span class="mh">$100</span>
...
</pre></div>

<p><strong>Note:</strong> For Python 3, use<code>print(corner_street_atm.__next__())</code> or
<code>print(next(corner_street_atm))</code></p>
<p>It can be useful for various things like controlling access to a resource.</p>
<h3>Itertools, your best friend</h3>
<p>The itertools module contains special functions to manipulate iterables. Ever
wish to duplicate a generator? Chain two generators? Group values in a nested
list with a one-liner? <code>Map / Zip</code> without creating another list?</p>
<p>Then just <code>import itertools</code>.</p>
<p>An example? Let's see the possible orders of arrival for a four-horse race:</p>
<div class="code"><pre class="code literal-block"><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">horses</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">races</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itertools</span><span class="o">.</span><span class="n">permutations</span><span class="p">(</span><span class="n">horses</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="nb">print</span><span class="p">(</span><span class="n">races</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">itertools</span><span class="o">.</span><span class="n">permutations</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="mh">0xb754f1dc</span><span class="o">&gt;</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="nb">print</span><span class="p">(</span><span class="n">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">permutations</span><span class="p">(</span><span class="n">horses</span><span class="p">)))</span>
<span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">),</span>
<span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span>
<span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">),</span>
<span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span>
<span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span>
<span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span>
<span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">),</span>
<span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span>
<span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">),</span>
<span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span>
<span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span>
<span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span>
<span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">),</span>
<span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span>
<span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">),</span>
<span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span>
<span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span>
<span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span>
<span class="w"> </span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span>
<span class="w"> </span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span>
<span class="w"> </span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span>
<span class="w"> </span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span>
<span class="w"> </span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span>
<span class="w"> </span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)]</span>
</pre></div>

<h3>Understanding the inner mechanisms of iteration</h3>
<p>Iteration is a process implying iterables (implementing the <code>__iter__()</code>
method) and iterators (implementing the <code>__next__()</code> method). Iterables are
any objects you can get an iterator from. Iterators are objects that let you
iterate on iterables.</p>
<p>There is more about it in this article about how <code>for</code> loops work.</p>
<p><br></p>
<h3>Suggest</h3>
<h3>Shortcut to understanding <code>yield</code>
</h3>
<p>When you see a function with <code>yield</code> statements, apply this easy trick to
understand what will happen:</p>
<ol>
<li>Insert a line <code>result = []</code> at the start of the function.</li>
<li>Replace each <code>yield expr</code> with <code>result.append(expr)</code>.</li>
<li>Insert a line <code>return result</code> at the bottom of the function.</li>
<li>Yay - no more <code>yield</code> statements! Read and figure out the code.</li>
<li>Compare function to the original definition.</li>
</ol>
<p>This trick may give you an idea of the logic behind the function, but what
actually happens with <code>yield</code> is significantly different than what happens in
the list-based approach. In many cases, the yield approach will be a lot more
memory efficient and faster too. In other cases, this trick will get you stuck
in an infinite loop, even though the original function works just fine. Read
on to learn more...</p>
<h3>Don't confuse your Iterables, Iterators, and Generators</h3>
<p>First, the <strong>iterator protocol</strong> - when you write</p>
<div class="code"><pre class="code literal-block"><span class="k">for</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">mylist</span>:
<span class="w">    </span>...<span class="k">loop</span><span class="w"> </span><span class="nv">body</span>...
</pre></div>

<p>Python performs the following two steps:</p>
<ol>
<li>Gets an iterator for <code>mylist</code>:</li>
</ol>
<p>Call <code>iter(mylist)</code> -&gt; this returns an object with a <code>next()</code> method (or
<code>__next__()</code> in Python 3).</p>
<p>[This is the step most people forget to tell you about]</p>
<ol>
<li>Uses the iterator to loop over items:</li>
</ol>
<p>Keep calling the <code>next()</code> method on the iterator returned from step 1. The
return value from <code>next()</code> is assigned to <code>x</code> and the loop body is executed.
If an exception <code>StopIteration</code> is raised from within <code>next()</code>, it means there
are no more values in the iterator and the loop is exited.</p>
<p>The truth is Python performs the above two steps anytime it wants to <em>loop
over</em> the contents of an object - so it could be a for loop, but it could also
be code like <code>otherlist.extend(mylist)</code> (where <code>otherlist</code> is a Python list).</p>
<p>Here <code>mylist</code> is an <em>iterable</em> because it implements the iterator protocol. In
a user-defined class, you can implement the <code>__iter__()</code> method to make
instances of your class iterable. This method should return an <em>iterator</em>. An
iterator is an object with a <code>next()</code> method. It is possible to implement both
<code>__iter__()</code> and <code>next()</code> on the same class, and have <code>__iter__()</code> return
<code>self</code>. This will work for simple cases, but not when you want two iterators
looping over the same object at the same time.</p>
<p>So that's the iterator protocol, many objects implement this protocol:</p>
<ol>
<li>Built-in lists, dictionaries, tuples, sets, and files.</li>
<li>User-defined classes that implement <code>__iter__()</code>.</li>
<li>Generators.</li>
</ol>
<p>Note that a <code>for</code> loop doesn't know what kind of object it's dealing with - it
just follows the iterator protocol, and is happy to get item after item as it
calls <code>next()</code>. Built-in lists return their items one by one, dictionaries
return the <em>keys</em> one by one, files return the <em>lines</em> one by one, etc. And
generators return... well that's where <code>yield</code> comes in:</p>
<div class="code"><pre class="code literal-block"><span class="nv">def</span><span class="w"> </span><span class="nv">f123</span><span class="ss">()</span>:
<span class="w">    </span><span class="nv">yield</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="nv">yield</span><span class="w"> </span><span class="mi">2</span>
<span class="w">    </span><span class="nv">yield</span><span class="w"> </span><span class="mi">3</span>

<span class="k">for</span><span class="w"> </span><span class="nv">item</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">f123</span><span class="ss">()</span>:
<span class="w">    </span><span class="nv">print</span><span class="w"> </span><span class="nv">item</span>
</pre></div>

<p>Instead of <code>yield</code> statements, if you had three <code>return</code> statements in
<code>f123()</code> only the first would get executed, and the function would exit. But
<code>f123()</code> is no ordinary function. When <code>f123()</code> is called, it <em>does not</em>
return any of the values in the yield statements! It returns a generator
object. Also, the function does not really exit - it goes into a suspended
state. When the <code>for</code> loop tries to loop over the generator object, the
function resumes from its suspended state at the very next line after the
<code>yield</code> it previously returned from, executes the next line of code, in this
case, a <code>yield</code> statement, and returns that as the next item. This happens
until the function exits, at which point the generator raises <code>StopIteration</code>,
and the loop exits.</p>
<p>So the generator object is sort of like an adapter - at one end it exhibits
the iterator protocol, by exposing <code>__iter__()</code> and <code>next()</code> methods to keep
the <code>for</code> loop happy. At the other end, however, it runs the function just
enough to get the next value out of it, and puts it back in suspended mode.</p>
<h3>Why Use Generators?</h3>
<p>Usually, you can write code that doesn't use generators but implements the
same logic. One option is to use the temporary list 'trick' I mentioned
before. That will not work in all cases, for e.g. if you have infinite loops,
or it may make inefficient use of memory when you have a really long list. The
other approach is to implement a new iterable class SomethingIter that keeps
the state in instance members and performs the next logical step in its
<code>next()</code> (or <code>__next__()</code> in Python 3) method. Depending on the logic, the
code inside the <code>next()</code> method may end up looking very complex and prone to
bugs. Here generators provide a clean and easy solution.</p>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/generator/" rel="tag">generator</a></li>
            <li><a class="tag p-category" href="../../categories/iterator/" rel="tag">iterator</a></li>
            <li><a class="tag p-category" href="../../categories/python/" rel="tag">python</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../what-is-the-difference-between-git-pull-and-git-fetch/" rel="prev" title="What is the difference between 'git pull' and 'git fetch'?">Previous post</a>
            </li>
            <li class="next">
                <a href="../which-json-content-type-do-i-use/" rel="next" title="Which JSON content type do I use?">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="../../assets/js/search.js"></script>
</body>
</html>
