<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Simple insecure two-way data "obfuscation"? | StackOverflow Snapshot</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/posts/simple-insecure-two-way-data-obfuscation/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Arya">
<link rel="prev" href="../git-can-t-undo-local-changes-error-path-is-unmerged/" title="Git: can't undo local changes (error: path ... is unmerged)" type="text/html">
<link rel="next" href="../access-control-allow-origin-wildcard-subdomains-ports-and-protocols/" title="Access-Control-Allow-Origin wildcard subdomains, ports and protocols" type="text/html">
<meta property="og:site_name" content="StackOverflow Snapshot">
<meta property="og:title" content='Simple insecure two-way data "obfuscation"?'>
<meta property="og:url" content="https://ohstackoverflow.netlify.app/posts/simple-insecure-two-way-data-obfuscation/">
<meta property="og:description" content="I'm looking for very simple obfuscation (like encrypt and decrypt but not
necessarily secure) functionality for some data. It's not mission critical. I
need something to keep honest people honest, but">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-03-03T12:50:34+08:00">
<meta property="article:tag" content=".net-c#">
<meta property="article:tag" content="obfuscation">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Simple insecure two-way data "obfuscation"?</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T12:50:34+08:00" itemprop="datePublished" title="2023-03-03 12:50">2023-03-03 12:50</time></a>
            </p>
            

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>I'm looking for very simple obfuscation (like encrypt and decrypt but not
necessarily secure) functionality for some data. It's not mission critical. I
need something to keep honest people honest, but something a little stronger
than ROT13 or Base64.</p>
<p>I'd prefer something that is already included in the .NET framework 2.0, so I
don't have to worry about any external dependencies.</p>
<p>I really don't want to have to mess around with public/private keys, etc. I
don't know much about encryption, but I do know enough to know that anything I
wrote would be less than worthless... In fact, I'd probably screw up the math
and make it trivial to crack.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Other answers here work fine, but AES is a more secure and up-to-date
encryption algorithm. This is a class that I obtained a few years ago to
perform AES encryption that I have modified over time to be more friendly for
web applications (e,g. I've built Encrypt/Decrypt methods that work with URL-
friendly string). It also has the methods that work with byte arrays.</p>
<p>NOTE: you should use different values in the Key (32 bytes) and Vector (16
bytes) arrays! You wouldn't want someone to figure out your keys by just
assuming that you used this code as-is! All you have to do is change some of
the numbers (must be &lt;= 255) in the Key and Vector arrays (I left one invalid
value in the Vector array to make sure you do this...). You can use
https://www.random.org/bytes/ to generate a new set easily:</p>
<ul>
<li>generate <code>Key</code>
</li>
<li>generate <code>Vector</code>
</li>
</ul>
<p>Using it is easy: just instantiate the class and then call (usually)
EncryptToString(string StringToEncrypt) and DecryptString(string
StringToDecrypt) as methods. It couldn't be any easier (or more secure) once
you have this class in place.</p>
<hr>
<div class="code"><pre class="code literal-block"><span class="k">using</span><span class="w"> </span><span class="k">System</span><span class="p">;</span>
<span class="k">using</span><span class="w"> </span><span class="k">System</span><span class="p">.</span><span class="k">Data</span><span class="p">;</span>
<span class="k">using</span><span class="w"> </span><span class="k">System</span><span class="p">.</span><span class="n">Security</span><span class="p">.</span><span class="n">Cryptography</span><span class="p">;</span>
<span class="k">using</span><span class="w"> </span><span class="k">System</span><span class="p">.</span><span class="n">IO</span><span class="p">;</span>


<span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">SimpleAES</span>
<span class="err">{</span>
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="n">Change</span><span class="w"> </span><span class="n">these</span><span class="w"> </span><span class="n">keys</span>
<span class="w">    </span><span class="n">private</span><span class="w"> </span><span class="n">byte</span><span class="err">[]</span><span class="w"> </span><span class="k">Key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">__Replace_Me__</span><span class="p">(</span><span class="err">{</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w"> </span><span class="mi">217</span><span class="p">,</span><span class="w"> </span><span class="mi">19</span><span class="p">,</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="mi">24</span><span class="p">,</span><span class="w"> </span><span class="mi">26</span><span class="p">,</span><span class="w"> </span><span class="mi">85</span><span class="p">,</span><span class="w"> </span><span class="mi">45</span><span class="p">,</span><span class="w"> </span><span class="mi">114</span><span class="p">,</span><span class="w"> </span><span class="mi">184</span><span class="p">,</span><span class="w"> </span><span class="mi">27</span><span class="p">,</span><span class="w"> </span><span class="mi">162</span><span class="p">,</span><span class="w"> </span><span class="mi">37</span><span class="p">,</span><span class="w"> </span><span class="mi">112</span><span class="p">,</span><span class="w"> </span><span class="mi">222</span><span class="p">,</span><span class="w"> </span><span class="mi">209</span><span class="p">,</span><span class="w"> </span><span class="mi">241</span><span class="p">,</span><span class="w"> </span><span class="mi">24</span><span class="p">,</span><span class="w"> </span><span class="mi">175</span><span class="p">,</span><span class="w"> </span><span class="mi">144</span><span class="p">,</span><span class="w"> </span><span class="mi">173</span><span class="p">,</span><span class="w"> </span><span class="mi">53</span><span class="p">,</span><span class="w"> </span><span class="mi">196</span><span class="p">,</span><span class="w"> </span><span class="mi">29</span><span class="p">,</span><span class="w"> </span><span class="mi">24</span><span class="p">,</span><span class="w"> </span><span class="mi">26</span><span class="p">,</span><span class="w"> </span><span class="mi">17</span><span class="p">,</span><span class="w"> </span><span class="mi">218</span><span class="p">,</span><span class="w"> </span><span class="mi">131</span><span class="p">,</span><span class="w"> </span><span class="mi">236</span><span class="p">,</span><span class="w"> </span><span class="mi">53</span><span class="p">,</span><span class="w"> </span><span class="mi">209</span><span class="w"> </span><span class="err">}</span><span class="p">);</span>

<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">hardcoded</span><span class="w"> </span><span class="n">IV</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">production</span><span class="w"> </span><span class="n">AES</span><span class="o">-</span><span class="n">CBC</span><span class="w"> </span><span class="n">code</span>
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="n">IVs</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">unpredictable</span><span class="w"> </span><span class="n">per</span><span class="w"> </span><span class="n">ciphertext</span>
<span class="w">    </span><span class="n">private</span><span class="w"> </span><span class="n">byte</span><span class="err">[]</span><span class="w"> </span><span class="n">Vector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">__Replace_Me__</span><span class="p">(</span><span class="err">{</span><span class="w"> </span><span class="mi">146</span><span class="p">,</span><span class="w"> </span><span class="mi">64</span><span class="p">,</span><span class="w"> </span><span class="mi">191</span><span class="p">,</span><span class="w"> </span><span class="mi">111</span><span class="p">,</span><span class="w"> </span><span class="mi">23</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">113</span><span class="p">,</span><span class="w"> </span><span class="mi">119</span><span class="p">,</span><span class="w"> </span><span class="mi">231</span><span class="p">,</span><span class="w"> </span><span class="mi">121</span><span class="p">,</span><span class="w"> </span><span class="mi">2521</span><span class="p">,</span><span class="w"> </span><span class="mi">112</span><span class="p">,</span><span class="w"> </span><span class="mi">79</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p">,</span><span class="w"> </span><span class="mi">114</span><span class="p">,</span><span class="w"> </span><span class="mi">156</span><span class="w"> </span><span class="err">}</span><span class="p">);</span>


<span class="w">    </span><span class="n">private</span><span class="w"> </span><span class="n">ICryptoTransform</span><span class="w"> </span><span class="n">EncryptorTransform</span><span class="p">,</span><span class="w"> </span><span class="n">DecryptorTransform</span><span class="p">;</span>
<span class="w">    </span><span class="n">private</span><span class="w"> </span><span class="k">System</span><span class="p">.</span><span class="nc">Text</span><span class="p">.</span><span class="n">UTF8Encoding</span><span class="w"> </span><span class="n">UTFEncoder</span><span class="p">;</span>

<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="n">SimpleAES</span><span class="p">()</span>
<span class="w">    </span><span class="err">{</span>
<span class="w">        </span><span class="o">//</span><span class="n">This</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">our</span><span class="w"> </span><span class="n">encryption</span><span class="w"> </span><span class="k">method</span>
<span class="w">        </span><span class="n">RijndaelManaged</span><span class="w"> </span><span class="n">rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">RijndaelManaged</span><span class="p">();</span>

<span class="w">        </span><span class="o">//</span><span class="k">Create</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">encryptor</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">decryptor</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="n">our</span><span class="w"> </span><span class="n">encryption</span><span class="w"> </span><span class="k">method</span><span class="p">,</span><span class="w"> </span><span class="k">key</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">vector</span><span class="p">.</span>
<span class="w">        </span><span class="n">EncryptorTransform</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rm</span><span class="p">.</span><span class="n">CreateEncryptor</span><span class="p">(</span><span class="n">this</span><span class="p">.</span><span class="k">Key</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="p">.</span><span class="n">Vector</span><span class="p">);</span>
<span class="w">        </span><span class="n">DecryptorTransform</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rm</span><span class="p">.</span><span class="n">CreateDecryptor</span><span class="p">(</span><span class="n">this</span><span class="p">.</span><span class="k">Key</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="p">.</span><span class="n">Vector</span><span class="p">);</span>

<span class="w">        </span><span class="o">//</span><span class="n">Used</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">translate</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="nc">text</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">vice</span><span class="w"> </span><span class="n">versa</span>
<span class="w">        </span><span class="n">UTFEncoder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="k">System</span><span class="p">.</span><span class="nc">Text</span><span class="p">.</span><span class="n">UTF8Encoding</span><span class="p">();</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="o">///</span><span class="w"> </span><span class="o">--------------</span><span class="w"> </span><span class="n">Two</span><span class="w"> </span><span class="n">Utility</span><span class="w"> </span><span class="n">Methods</span><span class="w"> </span><span class="p">(</span><span class="ow">not</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">useful</span><span class="p">)</span><span class="w"> </span><span class="o">-----------</span>
<span class="w">    </span><span class="o">///</span><span class="w"> </span><span class="n">Generates</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">encryption</span><span class="w"> </span><span class="k">key</span><span class="p">.</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">byte</span><span class="err">[]</span><span class="w"> </span><span class="n">GenerateEncryptionKey</span><span class="p">()</span>
<span class="w">    </span><span class="err">{</span>
<span class="w">        </span><span class="o">//</span><span class="n">Generate</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">Key</span><span class="p">.</span>
<span class="w">        </span><span class="n">RijndaelManaged</span><span class="w"> </span><span class="n">rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">RijndaelManaged</span><span class="p">();</span>
<span class="w">        </span><span class="n">rm</span><span class="p">.</span><span class="n">GenerateKey</span><span class="p">();</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">rm</span><span class="p">.</span><span class="k">Key</span><span class="p">;</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="o">///</span><span class="w"> </span><span class="n">Generates</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">unique</span><span class="w"> </span><span class="n">encryption</span><span class="w"> </span><span class="n">vector</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">byte</span><span class="err">[]</span><span class="w"> </span><span class="n">GenerateEncryptionVector</span><span class="p">()</span>
<span class="w">    </span><span class="err">{</span>
<span class="w">        </span><span class="o">//</span><span class="n">Generate</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">Vector</span>
<span class="w">        </span><span class="n">RijndaelManaged</span><span class="w"> </span><span class="n">rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">RijndaelManaged</span><span class="p">();</span>
<span class="w">        </span><span class="n">rm</span><span class="p">.</span><span class="n">GenerateIV</span><span class="p">();</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">rm</span><span class="p">.</span><span class="n">IV</span><span class="p">;</span>
<span class="w">    </span><span class="err">}</span>


<span class="w">    </span><span class="o">///</span><span class="w"> </span><span class="o">-----------</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">commonly</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">methods</span><span class="w"> </span><span class="o">------------------------------</span><span class="w">    </span>
<span class="w">    </span><span class="o">///</span><span class="w"> </span><span class="n">Encrypt</span><span class="w"> </span><span class="ow">some</span><span class="w"> </span><span class="nc">text</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">suitable</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">passing</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">URL</span><span class="p">.</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">EncryptToString</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">TextValue</span><span class="p">)</span>
<span class="w">    </span><span class="err">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ByteArrToString</span><span class="p">(</span><span class="n">Encrypt</span><span class="p">(</span><span class="n">TextValue</span><span class="p">));</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="o">///</span><span class="w"> </span><span class="n">Encrypt</span><span class="w"> </span><span class="ow">some</span><span class="w"> </span><span class="nc">text</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">encrypted</span><span class="w"> </span><span class="n">byte</span><span class="w"> </span><span class="k">array</span><span class="p">.</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="n">byte</span><span class="err">[]</span><span class="w"> </span><span class="n">Encrypt</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">TextValue</span><span class="p">)</span>
<span class="w">    </span><span class="err">{</span>
<span class="w">        </span><span class="o">//</span><span class="n">Translates</span><span class="w"> </span><span class="n">our</span><span class="w"> </span><span class="nc">text</span><span class="w"> </span><span class="k">value</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">byte</span><span class="w"> </span><span class="k">array</span><span class="p">.</span>
<span class="w">        </span><span class="n">Byte</span><span class="err">[]</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UTFEncoder</span><span class="p">.</span><span class="n">GetBytes</span><span class="p">(</span><span class="n">TextValue</span><span class="p">);</span>

<span class="w">        </span><span class="o">//</span><span class="n">Used</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">stream</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">data</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">out</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">CryptoStream</span><span class="p">.</span>
<span class="w">        </span><span class="n">MemoryStream</span><span class="w"> </span><span class="n">memoryStream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">MemoryStream</span><span class="p">();</span>

<span class="w">        </span><span class="cm">/*</span>
<span class="cm">         * We will have to write the unencrypted bytes to the stream,</span>
<span class="cm">         * then read the encrypted result back from the stream.</span>
<span class="cm">         */</span>
<span class="w">        </span><span class="n">#region</span><span class="w"> </span><span class="k">Write</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">decrypted</span><span class="w"> </span><span class="k">value</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">encryption</span><span class="w"> </span><span class="n">stream</span>
<span class="w">        </span><span class="n">CryptoStream</span><span class="w"> </span><span class="n">cs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">CryptoStream</span><span class="p">(</span><span class="n">memoryStream</span><span class="p">,</span><span class="w"> </span><span class="n">EncryptorTransform</span><span class="p">,</span><span class="w"> </span><span class="n">CryptoStreamMode</span><span class="p">.</span><span class="k">Write</span><span class="p">);</span>
<span class="w">        </span><span class="n">cs</span><span class="p">.</span><span class="k">Write</span><span class="p">(</span><span class="n">bytes</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">bytes</span><span class="p">.</span><span class="n">Length</span><span class="p">);</span>
<span class="w">        </span><span class="n">cs</span><span class="p">.</span><span class="n">FlushFinalBlock</span><span class="p">();</span>
<span class="w">        </span><span class="n">#endregion</span>

<span class="w">        </span><span class="n">#region</span><span class="w"> </span><span class="k">Read</span><span class="w"> </span><span class="n">encrypted</span><span class="w"> </span><span class="k">value</span><span class="w"> </span><span class="n">back</span><span class="w"> </span><span class="k">out</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">stream</span>
<span class="w">        </span><span class="n">memoryStream</span><span class="p">.</span><span class="k">Position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">        </span><span class="n">byte</span><span class="err">[]</span><span class="w"> </span><span class="n">encrypted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">byte</span><span class="o">[</span><span class="n">memoryStream.Length</span><span class="o">]</span><span class="p">;</span>
<span class="w">        </span><span class="n">memoryStream</span><span class="p">.</span><span class="k">Read</span><span class="p">(</span><span class="n">encrypted</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">encrypted</span><span class="p">.</span><span class="n">Length</span><span class="p">);</span>
<span class="w">        </span><span class="n">#endregion</span>

<span class="w">        </span><span class="o">//</span><span class="n">Clean</span><span class="w"> </span><span class="n">up</span><span class="p">.</span>
<span class="w">        </span><span class="n">cs</span><span class="p">.</span><span class="k">Close</span><span class="p">();</span>
<span class="w">        </span><span class="n">memoryStream</span><span class="p">.</span><span class="k">Close</span><span class="p">();</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">encrypted</span><span class="p">;</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="o">///</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="nl">side</span><span class="p">:</span><span class="w"> </span><span class="n">Decryption</span><span class="w"> </span><span class="n">methods</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">DecryptString</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">EncryptedString</span><span class="p">)</span>
<span class="w">    </span><span class="err">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Decrypt</span><span class="p">(</span><span class="n">StrToByteArray</span><span class="p">(</span><span class="n">EncryptedString</span><span class="p">));</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="o">///</span><span class="w"> </span><span class="n">Decryption</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="n">working</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">byte</span><span class="w"> </span><span class="n">arrays</span><span class="p">.</span><span class="w">    </span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">Decrypt</span><span class="p">(</span><span class="n">byte</span><span class="err">[]</span><span class="w"> </span><span class="n">EncryptedValue</span><span class="p">)</span>
<span class="w">    </span><span class="err">{</span>
<span class="w">        </span><span class="n">#region</span><span class="w"> </span><span class="k">Write</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">encrypted</span><span class="w"> </span><span class="k">value</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">decryption</span><span class="w"> </span><span class="n">stream</span>
<span class="w">        </span><span class="n">MemoryStream</span><span class="w"> </span><span class="n">encryptedStream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">MemoryStream</span><span class="p">();</span>
<span class="w">        </span><span class="n">CryptoStream</span><span class="w"> </span><span class="n">decryptStream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">CryptoStream</span><span class="p">(</span><span class="n">encryptedStream</span><span class="p">,</span><span class="w"> </span><span class="n">DecryptorTransform</span><span class="p">,</span><span class="w"> </span><span class="n">CryptoStreamMode</span><span class="p">.</span><span class="k">Write</span><span class="p">);</span>
<span class="w">        </span><span class="n">decryptStream</span><span class="p">.</span><span class="k">Write</span><span class="p">(</span><span class="n">EncryptedValue</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">EncryptedValue</span><span class="p">.</span><span class="n">Length</span><span class="p">);</span>
<span class="w">        </span><span class="n">decryptStream</span><span class="p">.</span><span class="n">FlushFinalBlock</span><span class="p">();</span>
<span class="w">        </span><span class="n">#endregion</span>

<span class="w">        </span><span class="n">#region</span><span class="w"> </span><span class="k">Read</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">decrypted</span><span class="w"> </span><span class="k">value</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">stream</span><span class="p">.</span>
<span class="w">        </span><span class="n">encryptedStream</span><span class="p">.</span><span class="k">Position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">        </span><span class="n">Byte</span><span class="err">[]</span><span class="w"> </span><span class="n">decryptedBytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Byte</span><span class="o">[</span><span class="n">encryptedStream.Length</span><span class="o">]</span><span class="p">;</span>
<span class="w">        </span><span class="n">encryptedStream</span><span class="p">.</span><span class="k">Read</span><span class="p">(</span><span class="n">decryptedBytes</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">decryptedBytes</span><span class="p">.</span><span class="n">Length</span><span class="p">);</span>
<span class="w">        </span><span class="n">encryptedStream</span><span class="p">.</span><span class="k">Close</span><span class="p">();</span>
<span class="w">        </span><span class="n">#endregion</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">UTFEncoder</span><span class="p">.</span><span class="n">GetString</span><span class="p">(</span><span class="n">decryptedBytes</span><span class="p">);</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="o">///</span><span class="w"> </span><span class="nf">Convert</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">byte</span><span class="w"> </span><span class="k">array</span><span class="p">.</span><span class="w">  </span><span class="nl">NOTE</span><span class="p">:</span><span class="w"> </span><span class="n">Normally</span><span class="w"> </span><span class="n">we</span><span class="err">'</span><span class="n">d</span><span class="w"> </span><span class="k">create</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">Byte</span><span class="w"> </span><span class="k">Array</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nf">ASCII</span><span class="w"> </span><span class="n">encoding</span><span class="w"> </span><span class="p">(</span><span class="ow">like</span><span class="w"> </span><span class="n">so</span><span class="p">).</span>
<span class="w">    </span><span class="o">//</span><span class="w">      </span><span class="k">System</span><span class="p">.</span><span class="nc">Text</span><span class="p">.</span><span class="n">ASCIIEncoding</span><span class="w"> </span><span class="n">encoding</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="k">System</span><span class="p">.</span><span class="nc">Text</span><span class="p">.</span><span class="n">ASCIIEncoding</span><span class="p">();</span>
<span class="w">    </span><span class="o">//</span><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">encoding</span><span class="p">.</span><span class="n">GetBytes</span><span class="p">(</span><span class="nf">str</span><span class="p">);</span>
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="n">However</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">results</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">character</span><span class="w"> </span><span class="k">values</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">cannot</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">passed</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">URL</span><span class="p">.</span><span class="w">  </span><span class="n">So</span><span class="p">,</span><span class="w"> </span><span class="n">instead</span><span class="p">,</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="n">just</span>
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="n">lay</span><span class="w"> </span><span class="k">out</span><span class="w"> </span><span class="ow">all</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">byte</span><span class="w"> </span><span class="k">values</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">long</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">numbers</span><span class="w"> </span><span class="p">(</span><span class="n">three</span><span class="w"> </span><span class="n">per</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="k">pad</span><span class="w"> </span><span class="n">numbers</span><span class="w"> </span><span class="k">less</span><span class="w"> </span><span class="k">than</span><span class="w"> </span><span class="mi">100</span><span class="p">).</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="n">byte</span><span class="err">[]</span><span class="w"> </span><span class="n">StrToByteArray</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="nf">str</span><span class="p">)</span>
<span class="w">    </span><span class="err">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nf">str</span><span class="p">.</span><span class="n">Length</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="k">Exception</span><span class="p">(</span><span class="ss">"Invalid string value in StrToByteArray"</span><span class="p">);</span>

<span class="w">        </span><span class="n">byte</span><span class="w"> </span><span class="n">val</span><span class="p">;</span>
<span class="w">        </span><span class="n">byte</span><span class="err">[]</span><span class="w"> </span><span class="n">byteArr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">byte</span><span class="o">[</span><span class="n">str.Length / 3</span><span class="o">]</span><span class="p">;</span>
<span class="w">        </span><span class="nc">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">        </span><span class="nc">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">        </span><span class="n">do</span>
<span class="w">        </span><span class="err">{</span>
<span class="w">            </span><span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">byte</span><span class="p">.</span><span class="nf">Parse</span><span class="p">(</span><span class="nf">str</span><span class="p">.</span><span class="nf">Substring</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">));</span>
<span class="w">            </span><span class="n">byteArr</span><span class="o">[</span><span class="n">j++</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">val</span><span class="p">;</span>
<span class="w">            </span><span class="n">i</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="w">        </span><span class="err">}</span>
<span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nf">str</span><span class="p">.</span><span class="n">Length</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">byteArr</span><span class="p">;</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="n">Same</span><span class="w"> </span><span class="n">comment</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">above</span><span class="p">.</span><span class="w">  </span><span class="n">Normally</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">conversion</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="k">use</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nf">ASCII</span><span class="w"> </span><span class="n">encoding</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="nl">direction</span><span class="p">:</span>
<span class="w">    </span><span class="o">//</span><span class="w">      </span><span class="k">System</span><span class="p">.</span><span class="nc">Text</span><span class="p">.</span><span class="n">ASCIIEncoding</span><span class="w"> </span><span class="n">enc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="k">System</span><span class="p">.</span><span class="nc">Text</span><span class="p">.</span><span class="n">ASCIIEncoding</span><span class="p">();</span>
<span class="w">    </span><span class="o">//</span><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">enc</span><span class="p">.</span><span class="n">GetString</span><span class="p">(</span><span class="n">byteArr</span><span class="p">);</span><span class="w">    </span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">ByteArrToString</span><span class="p">(</span><span class="n">byte</span><span class="err">[]</span><span class="w"> </span><span class="n">byteArr</span><span class="p">)</span>
<span class="w">    </span><span class="err">{</span>
<span class="w">        </span><span class="n">byte</span><span class="w"> </span><span class="n">val</span><span class="p">;</span>
<span class="w">        </span><span class="n">string</span><span class="w"> </span><span class="n">tempStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">""</span><span class="p">;</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nc">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">byteArr</span><span class="p">.</span><span class="n">GetUpperBound</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">        </span><span class="err">{</span>
<span class="w">            </span><span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">byteArr</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">;</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">val</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="p">(</span><span class="n">byte</span><span class="p">)</span><span class="mi">10</span><span class="p">)</span>
<span class="w">                </span><span class="n">tempStr</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="ss">"00"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">val</span><span class="p">.</span><span class="n">ToString</span><span class="p">();</span>
<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">val</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="p">(</span><span class="n">byte</span><span class="p">)</span><span class="mi">100</span><span class="p">)</span>
<span class="w">                </span><span class="n">tempStr</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="ss">"0"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">val</span><span class="p">.</span><span class="n">ToString</span><span class="p">();</span>
<span class="w">            </span><span class="k">else</span>
<span class="w">                </span><span class="n">tempStr</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">val</span><span class="p">.</span><span class="n">ToString</span><span class="p">();</span>
<span class="w">        </span><span class="err">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">tempStr</span><span class="p">;</span>
<span class="w">    </span><span class="err">}</span>
<span class="err">}</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>I cleaned up SimpleAES (above) for my use. Fixed convoluted encrypt/decrypt
methods; separated methods for encoding byte buffers, strings, and URL-
friendly strings; made use of existing libraries for URL encoding.</p>
<p>The code is small, simpler, faster and the output is more concise. For
instance, <code>johnsmith@gmail.com</code> produces:</p>
<div class="code"><pre class="code literal-block">SimpleAES: "096114178117140150104121138042115022037019164188092040214235183167012211175176167001017163166152"
SimplerAES: "YHKydYyWaHmKKnMWJROkvFwo1uu3pwzTr7CnARGjppg%3d"
</pre></div>

<p>Code:</p>
<div class="code"><pre class="code literal-block"><span class="nv">public</span><span class="w"> </span><span class="nv">class</span><span class="w"> </span><span class="nv">SimplerAES</span>
{
<span class="w">    </span><span class="nv">private</span><span class="w"> </span><span class="nv">static</span><span class="w"> </span><span class="nv">byte</span>[]<span class="w"> </span><span class="nv">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">__Replace_Me__</span><span class="ss">(</span>{<span class="w"> </span><span class="mi">123</span>,<span class="w"> </span><span class="mi">217</span>,<span class="w"> </span><span class="mi">19</span>,<span class="w"> </span><span class="mi">11</span>,<span class="w"> </span><span class="mi">24</span>,<span class="w"> </span><span class="mi">26</span>,<span class="w"> </span><span class="mi">85</span>,<span class="w"> </span><span class="mi">45</span>,<span class="w"> </span><span class="mi">114</span>,<span class="w"> </span><span class="mi">184</span>,<span class="w"> </span><span class="mi">27</span>,<span class="w"> </span><span class="mi">162</span>,<span class="w"> </span><span class="mi">37</span>,<span class="w"> </span><span class="mi">112</span>,<span class="w"> </span><span class="mi">222</span>,<span class="w"> </span><span class="mi">209</span>,<span class="w"> </span><span class="mi">241</span>,<span class="w"> </span><span class="mi">24</span>,<span class="w"> </span><span class="mi">175</span>,<span class="w"> </span><span class="mi">144</span>,<span class="w"> </span><span class="mi">173</span>,<span class="w"> </span><span class="mi">53</span>,<span class="w"> </span><span class="mi">196</span>,<span class="w"> </span><span class="mi">29</span>,<span class="w"> </span><span class="mi">24</span>,<span class="w"> </span><span class="mi">26</span>,<span class="w"> </span><span class="mi">17</span>,<span class="w"> </span><span class="mi">218</span>,<span class="w"> </span><span class="mi">131</span>,<span class="w"> </span><span class="mi">236</span>,<span class="w"> </span><span class="mi">53</span>,<span class="w"> </span><span class="mi">209</span><span class="w"> </span>}<span class="ss">)</span><span class="c1">;</span>

<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">hardcoded</span><span class="w"> </span><span class="nv">IV</span><span class="w"> </span><span class="nv">should</span><span class="w"> </span><span class="nv">not</span><span class="w"> </span><span class="nv">be</span><span class="w"> </span><span class="nv">used</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">production</span><span class="w"> </span><span class="nv">AES</span><span class="o">-</span><span class="nv">CBC</span><span class="w"> </span><span class="nv">code</span>
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="nv">IVs</span><span class="w"> </span><span class="nv">should</span><span class="w"> </span><span class="nv">be</span><span class="w"> </span><span class="nv">unpredictable</span><span class="w"> </span><span class="nv">per</span><span class="w"> </span><span class="nv">ciphertext</span>
<span class="w">    </span><span class="nv">private</span><span class="w"> </span><span class="nv">static</span><span class="w"> </span><span class="nv">byte</span>[]<span class="w"> </span><span class="nv">vector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">__Replace_Me_</span><span class="ss">(</span>{<span class="w"> </span><span class="mi">146</span>,<span class="w"> </span><span class="mi">64</span>,<span class="w"> </span><span class="mi">191</span>,<span class="w"> </span><span class="mi">111</span>,<span class="w"> </span><span class="mi">23</span>,<span class="w"> </span><span class="mi">3</span>,<span class="w"> </span><span class="mi">113</span>,<span class="w"> </span><span class="mi">119</span>,<span class="w"> </span><span class="mi">231</span>,<span class="w"> </span><span class="mi">121</span>,<span class="w"> </span><span class="mi">221</span>,<span class="w"> </span><span class="mi">112</span>,<span class="w"> </span><span class="mi">79</span>,<span class="w"> </span><span class="mi">32</span>,<span class="w"> </span><span class="mi">114</span>,<span class="w"> </span><span class="mi">156</span><span class="w"> </span>}<span class="ss">)</span><span class="c1">;</span>

<span class="w">    </span><span class="nv">private</span><span class="w"> </span><span class="nv">ICryptoTransform</span><span class="w"> </span><span class="nv">encryptor</span>,<span class="w"> </span><span class="nv">decryptor</span><span class="c1">;</span>
<span class="w">    </span><span class="nv">private</span><span class="w"> </span><span class="nv">UTF8Encoding</span><span class="w"> </span><span class="nv">encoder</span><span class="c1">;</span>

<span class="w">    </span><span class="nv">public</span><span class="w"> </span><span class="nv">SimplerAES</span><span class="ss">()</span>
<span class="w">    </span>{
<span class="w">        </span><span class="nv">RijndaelManaged</span><span class="w"> </span><span class="nv">rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">RijndaelManaged</span><span class="ss">()</span><span class="c1">;</span>
<span class="w">        </span><span class="nv">encryptor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">rm</span>.<span class="nv">CreateEncryptor</span><span class="ss">(</span><span class="nv">key</span>,<span class="w"> </span><span class="nv">vector</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">        </span><span class="nv">decryptor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">rm</span>.<span class="nv">CreateDecryptor</span><span class="ss">(</span><span class="nv">key</span>,<span class="w"> </span><span class="nv">vector</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">        </span><span class="nv">encoder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">UTF8Encoding</span><span class="ss">()</span><span class="c1">;</span>
<span class="w">    </span>}

<span class="w">    </span><span class="nv">public</span><span class="w"> </span><span class="nv">string</span><span class="w"> </span><span class="nv">Encrypt</span><span class="ss">(</span><span class="nv">string</span><span class="w"> </span><span class="nv">unencrypted</span><span class="ss">)</span>
<span class="w">    </span>{
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nv">Convert</span>.<span class="nv">ToBase64String</span><span class="ss">(</span><span class="nv">Encrypt</span><span class="ss">(</span><span class="nv">encoder</span>.<span class="nv">GetBytes</span><span class="ss">(</span><span class="nv">unencrypted</span><span class="ss">)))</span><span class="c1">;</span>
<span class="w">    </span>}

<span class="w">    </span><span class="nv">public</span><span class="w"> </span><span class="nv">string</span><span class="w"> </span><span class="nv">Decrypt</span><span class="ss">(</span><span class="nv">string</span><span class="w"> </span><span class="nv">encrypted</span><span class="ss">)</span>
<span class="w">    </span>{
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nv">encoder</span>.<span class="nv">GetString</span><span class="ss">(</span><span class="nv">Decrypt</span><span class="ss">(</span><span class="nv">Convert</span>.<span class="nv">FromBase64String</span><span class="ss">(</span><span class="nv">encrypted</span><span class="ss">)))</span><span class="c1">;</span>
<span class="w">    </span>}

<span class="w">    </span><span class="nv">public</span><span class="w"> </span><span class="nv">byte</span>[]<span class="w"> </span><span class="nv">Encrypt</span><span class="ss">(</span><span class="nv">byte</span>[]<span class="w"> </span><span class="nv">buffer</span><span class="ss">)</span>
<span class="w">    </span>{
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nv">Transform</span><span class="ss">(</span><span class="nv">buffer</span>,<span class="w"> </span><span class="nv">encryptor</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">    </span>}

<span class="w">    </span><span class="nv">public</span><span class="w"> </span><span class="nv">byte</span>[]<span class="w"> </span><span class="nv">Decrypt</span><span class="ss">(</span><span class="nv">byte</span>[]<span class="w"> </span><span class="nv">buffer</span><span class="ss">)</span>
<span class="w">    </span>{
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nv">Transform</span><span class="ss">(</span><span class="nv">buffer</span>,<span class="w"> </span><span class="nv">decryptor</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">    </span>}

<span class="w">    </span><span class="nv">protected</span><span class="w"> </span><span class="nv">byte</span>[]<span class="w"> </span><span class="nv">Transform</span><span class="ss">(</span><span class="nv">byte</span>[]<span class="w"> </span><span class="nv">buffer</span>,<span class="w"> </span><span class="nv">ICryptoTransform</span><span class="w"> </span><span class="nv">transform</span><span class="ss">)</span>
<span class="w">    </span>{
<span class="w">        </span><span class="nv">MemoryStream</span><span class="w"> </span><span class="nv">stream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">MemoryStream</span><span class="ss">()</span><span class="c1">;</span>
<span class="w">        </span><span class="nv">using</span><span class="w"> </span><span class="ss">(</span><span class="nv">CryptoStream</span><span class="w"> </span><span class="nv">cs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">CryptoStream</span><span class="ss">(</span><span class="nv">stream</span>,<span class="w"> </span><span class="nv">transform</span>,<span class="w"> </span><span class="nv">CryptoStreamMode</span>.<span class="nv">Write</span><span class="ss">))</span>
<span class="w">        </span>{
<span class="w">            </span><span class="nv">cs</span>.<span class="nv">Write</span><span class="ss">(</span><span class="nv">buffer</span>,<span class="w"> </span><span class="mi">0</span>,<span class="w"> </span><span class="nv">buffer</span>.<span class="nv">Length</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">        </span>}
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nv">stream</span>.<span class="nv">ToArray</span><span class="ss">()</span><span class="c1">;</span>
<span class="w">    </span>}
}
</pre></div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/net-c/" rel="tag">.net-c#</a></li>
            <li><a class="tag p-category" href="../../categories/obfuscation/" rel="tag">obfuscation</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../git-can-t-undo-local-changes-error-path-is-unmerged/" rel="prev" title="Git: can't undo local changes (error: path ... is unmerged)">Previous post</a>
            </li>
            <li class="next">
                <a href="../access-control-allow-origin-wildcard-subdomains-ports-and-protocols/" rel="next" title="Access-Control-Allow-Origin wildcard subdomains, ports and protocols">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="../../assets/js/search.js"></script>
</body>
</html>
