<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Declaring a custom android UI element using XML | StackOverflow Snapshot</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/posts/declaring-a-custom-android-ui-element-using-xml/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Arya">
<link rel="prev" href="../how-to-replace-plain-urls-with-links/" title="How to replace plain URLs with links?" type="text/html">
<link rel="next" href="../what-does-fatal-error-unexpectedly-found-nil-while-unwrapping-an-optional-value-mean/" title='What does "Fatal error: Unexpectedly found nil while unwrapping an Optional value" mean?' type="text/html">
<meta property="og:site_name" content="StackOverflow Snapshot">
<meta property="og:title" content="Declaring a custom android UI element using XML">
<meta property="og:url" content="https://ohstackoverflow.netlify.app/posts/declaring-a-custom-android-ui-element-using-xml/">
<meta property="og:description" content="How do I declare an Android UI element using XML?

Answer
The Android Developer Guide has a section called Building Custom Components.
Unfortunately, the discussion of XML attributes only covers decla">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-03-03T06:43:51+08:00">
<meta property="article:tag" content="android">
<meta property="article:tag" content="user-interface">
<meta property="article:tag" content="xml">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Declaring a custom android UI element using XML</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T06:43:51+08:00" itemprop="datePublished" title="2023-03-03 06:43">2023-03-03 06:43</time></a>
            </p>
            

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>How do I declare an Android UI element using XML?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>The Android Developer Guide has a section called Building Custom Components.
Unfortunately, the discussion of XML attributes only covers declaring the
control inside the layout file and not actually handling the values inside the
class initialisation. The steps are as follows:</p>
<h4>1. Declare attributes in <code>values\attrs.xml</code>
</h4>
<div class="code"><pre class="code literal-block"><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="nt">&lt;resources&gt;</span>
<span class="w">    </span><span class="nt">&lt;declare-styleable</span><span class="w"> </span><span class="na">name=</span><span class="s">"MyCustomView"</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;attr</span><span class="w"> </span><span class="na">name=</span><span class="s">"android:text"</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;attr</span><span class="w"> </span><span class="na">name=</span><span class="s">"android:textColor"</span><span class="nt">/&gt;</span><span class="w">            </span>
<span class="w">        </span><span class="nt">&lt;attr</span><span class="w"> </span><span class="na">name=</span><span class="s">"extraInformation"</span><span class="w"> </span><span class="na">format=</span><span class="s">"string"</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/declare-styleable&gt;</span>
<span class="nt">&lt;/resources&gt;</span>
</pre></div>

<p>Notice the use of an unqualified name in the <code>declare-styleable</code> tag. Non-
standard android attributes like <code>extraInformation</code> need to have their type
declared. Tags declared in the superclass will be available in subclasses
without having to be redeclared.</p>
<h4>2. Create constructors</h4>
<p>Since there are two constructors that use an <code>AttributeSet</code> for
initialisation, it is convenient to create a separate initialisation method
for the constructors to call.</p>
<div class="code"><pre class="code literal-block">private void init(AttributeSet attrs) { 
    TypedArray a=getContext().obtainStyledAttributes(
         attrs,
         R.styleable.MyCustomView);

    //Use a
    Log.i("test",a.getString(
         R.styleable.MyCustomView_android_text));
    Log.i("test",""+a.getColor(
         R.styleable.MyCustomView_android_textColor, Color.BLACK));
    Log.i("test",a.getString(
         R.styleable.MyCustomView_extraInformation));

    //Don't forget this
    a.recycle();
}
</pre></div>

<p><code>R.styleable.MyCustomView</code> is an autogenerated <code>int[]</code> resource where each
element is the ID of an attribute. Attributes are generated for each property
in the XML by appending the attribute name to the element name. For example,
<code>R.styleable.MyCustomView_android_text</code> contains the <code>android_text</code> attribute
for <code>MyCustomView</code>. Attributes can then be retrieved from the <code>TypedArray</code>
using various <code>get</code> functions. If the attribute is not defined in the defined
in the XML, then <code>null</code> is returned. Except, of course, if the return type is
a primitive, in which case the second argument is returned.</p>
<p>If you don't want to retrieve all of the attributes, it is possible to create
this array manually.The ID for standard android attributes are included in
<code>android.R.attr</code>, while attributes for this project are in <code>R.attr</code>.</p>
<div class="code"><pre class="code literal-block">int attrsWanted[]=new int[]{android.R.attr.text, R.attr.textColor};
</pre></div>

<p>Please note that you should <strong>not</strong> use anything in <code>android.R.styleable</code>, as
per this thread it may change in the future. It is still in the documentation
as being to view all these constants in the one place is useful.</p>
<h4>3. Use it in a layout files such as <code>layout\main.xml</code>
</h4>
<p>Include the namespace declaration
<code>xmlns:app="http://schemas.android.com/apk/res-auto"</code> in the top level xml
element. Namespaces provide a method to avoid the conflicts that sometimes
occur when different schemas use the same element names (see this article for
more info). The URL is simply a manner of uniquely identifying schemas -
nothing actually needs to be hosted at that URL. If this doesn't appear to be
doing anything, it is because you don't actually need to add the namespace
prefix unless you need to resolve a conflict.</p>
<div class="code"><pre class="code literal-block"><span class="o">&lt;</span><span class="n">com</span><span class="p">.</span><span class="n">mycompany</span><span class="p">.</span><span class="n">projectname</span><span class="p">.</span><span class="n">MyCustomView</span>
<span class="w">    </span><span class="nl">android</span><span class="p">:</span><span class="n">layout_width</span><span class="o">=</span><span class="ss">"wrap_content"</span>
<span class="w">    </span><span class="nl">android</span><span class="p">:</span><span class="n">layout_height</span><span class="o">=</span><span class="ss">"wrap_content"</span>
<span class="w">    </span><span class="nl">android</span><span class="p">:</span><span class="n">background</span><span class="o">=</span><span class="ss">"@android:color/transparent"</span>
<span class="w">    </span><span class="nl">android</span><span class="p">:</span><span class="nc">text</span><span class="o">=</span><span class="ss">"Test text"</span>
<span class="w">    </span><span class="nl">android</span><span class="p">:</span><span class="n">textColor</span><span class="o">=</span><span class="ss">"#FFFFFF"</span>
<span class="w">    </span><span class="nl">app</span><span class="p">:</span><span class="n">extraInformation</span><span class="o">=</span><span class="ss">"My extra information"</span>
<span class="o">/&gt;</span>
</pre></div>

<p>Reference the custom view using the fully qualified name.</p>
<h4>Android LabelView Sample</h4>
<p>If you want a complete example, look at the android label view sample.</p>
<p>LabelView.java</p>
<div class="code"><pre class="code literal-block"> TypedArray a=context.obtainStyledAttributes(attrs, R.styleable.LabelView);
 CharSequences=a.getString(R.styleable.LabelView_text);
</pre></div>

<p>attrs.xml</p>
<div class="code"><pre class="code literal-block"><span class="nt">&lt;declare-styleable</span><span class="w"> </span><span class="na">name=</span><span class="s">"LabelView"</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;attr</span><span class="w"> </span><span class="na">name=</span><span class="s">"text"</span><span class="na">format=</span><span class="s">"string"</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;attr</span><span class="w"> </span><span class="na">name=</span><span class="s">"textColor"</span><span class="na">format=</span><span class="s">"color"</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;attr</span><span class="w"> </span><span class="na">name=</span><span class="s">"textSize"</span><span class="na">format=</span><span class="s">"dimension"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/declare-styleable&gt;</span>
</pre></div>

<p>custom_view_1.xml</p>
<div class="code"><pre class="code literal-block"><span class="o">&lt;</span><span class="n">com</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">android</span><span class="p">.</span><span class="n">apis</span><span class="p">.</span><span class="k">view</span><span class="p">.</span><span class="n">LabelView</span>
<span class="w">    </span><span class="nl">android</span><span class="p">:</span><span class="n">background</span><span class="o">=</span><span class="ss">"@drawable/blue"</span>
<span class="w">    </span><span class="nl">android</span><span class="p">:</span><span class="n">layout_width</span><span class="o">=</span><span class="ss">"fill_parent"</span>
<span class="w">    </span><span class="nl">android</span><span class="p">:</span><span class="n">layout_height</span><span class="o">=</span><span class="ss">"wrap_content"</span>
<span class="w">    </span><span class="nl">app</span><span class="p">:</span><span class="nc">text</span><span class="o">=</span><span class="ss">"Blue"</span><span class="w"> </span><span class="nl">app</span><span class="p">:</span><span class="k">textSize</span><span class="o">=</span><span class="ss">"20dp"</span><span class="o">/&gt;</span>
</pre></div>

<p>This is contained in a <code>LinearLayout</code> with a namespace attribute:
<code>xmlns:app="http://schemas.android.com/apk/res-auto"</code></p>
<h4>Links</h4>
<ul>
<li>StackOverflow Thread: Retrieving an XML attribute for custom control</li>
<li>How do I use obtainStyledAttributes with internal themes of Android</li>
<li>Defining custom attributes + list of supported attribute formats</li>
</ul>
<p><br></p>
<h3>Suggest</h3>
<p>Great reference. Thanks! An addition to it:</p>
<p>If you happen to have a library project included which has declared custom
attributes for a custom view, you have to declare your project namespace, not
the library one's. Eg:</p>
<p>Given that the library has the package "com.example.library.customview" and
the working project has the package "com.example.customview", then:</p>
<p>Will not work (shows the error " error: No resource identifier found for
attribute 'newAttr' in package 'com.example.library.customview'" ):</p>
<div class="code"><pre class="code literal-block">&lt;com.library.CustomView
        xmlns:android="http://schemas.android.com/apk/res/android"
        xmlns:app="http://schemas.android.com/apk/res/com.example.library.customview"
        android:id="@+id/myView"
        app:newAttr="value" /&gt;
</pre></div>

<p>Will work:</p>
<div class="code"><pre class="code literal-block">&lt;com.library.CustomView
        xmlns:android="http://schemas.android.com/apk/res/android"
        xmlns:app="http://schemas.android.com/apk/res/com.example.customview"
        android:id="@+id/myView"
        app:newAttr="value" /&gt;
</pre></div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/android/" rel="tag">android</a></li>
            <li><a class="tag p-category" href="../../categories/user-interface/" rel="tag">user-interface</a></li>
            <li><a class="tag p-category" href="../../categories/xml/" rel="tag">xml</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../how-to-replace-plain-urls-with-links/" rel="prev" title="How to replace plain URLs with links?">Previous post</a>
            </li>
            <li class="next">
                <a href="../what-does-fatal-error-unexpectedly-found-nil-while-unwrapping-an-optional-value-mean/" rel="next" title='What does "Fatal error: Unexpectedly found nil while unwrapping an Optional value" mean?'>Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="../../assets/js/search.js"></script>
</body>
</html>
