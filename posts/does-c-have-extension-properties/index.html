<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Does C# have extension properties? | StackOverflow Snapshot</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/posts/does-c-have-extension-properties/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Arya">
<link rel="prev" href="../why-is-null-an-object-and-what-s-the-difference-between-null-and-undefined/" title="Why is null an object and what's the difference between null and undefined?" type="text/html">
<link rel="next" href="../how-to-send-an-object-from-one-android-activity-to-another-using-intents/" title="How to send an object from one Android Activity to another using Intents?" type="text/html">
<meta property="og:site_name" content="StackOverflow Snapshot">
<meta property="og:title" content="Does C# have extension properties?">
<meta property="og:url" content="https://ohstackoverflow.netlify.app/posts/does-c-have-extension-properties/">
<meta property="og:description" content='Does C# have extension properties?
For example, can I add an extension property to DateTimeFormatInfo called
ShortDateLongTimeFormat which would return ShortDatePattern + " " +
LongTimePattern?

Answe'>
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-02-17T09:24:34+08:00">
<meta property="article:tag" content=".net-c#">
<meta property="article:tag" content="extension-methods">
<meta property="article:tag" content="properties">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Does C# have extension properties?</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T09:24:34+08:00" itemprop="datePublished" title="2023-02-17 09:24">2023-02-17 09:24</time></a>
            </p>
            

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>Does C# have extension properties?</p>
<p>For example, can I add an extension property to <code>DateTimeFormatInfo</code> called
<code>ShortDateLongTimeFormat</code> which would return <code>ShortDatePattern + " " +
LongTimePattern</code>?</p>
<p><br><br></p>
<h2>Answer</h2>
<h4>For the moment it is still not supported out of the box by Roslyn compiler</h4>
<p>...</p>
<p>Until now, the extension properties were not seen as valuable enough to be
included in the previous versions of C# standard. Various <strong>C#</strong> versions
(maybe all of them?) have seen this as proposal champion but it wasn't
released yet, most of all because even if there is already an implementation,
they want to make it right.</p>
<h4>But it will maybe... one day ...</h4>
<p><em><strong>Update 2022:</strong></em></p>
<p>The features seems to be still in discussion <strong>here</strong>.</p>
<h4>Moreover you can use a workaround</h4>
<p>As specified in this article, you can use the <code>TypeDescriptor</code> capability to
attach an attribute to an object instance at runtime. However, it is not using
the syntax of the standard properties.<br>
It's a little bit different from just syntactic sugar adding a possibility to
define an extended property like<br><code>string Data(this MyClass instance)</code> as an alias for extension method<br><code>string GetData(this MyClass instance)</code> as it stores data into the class.</p>
<p>I hope that C# will soon provide a full featured extension everything
(properties and fields), however on that point, only time will tell.</p>
<p>And feel free to contribute as the software of tomorrow will come from the
community.</p>
<h4>Post processing approach</h4>
<p>If you are allowed to do so, you could also add dynamically a property on a
class in your assembly after compilation with tools like <em><strong>PostSharp</strong></em> ,
<em><strong>Mono.Cecil</strong></em> (or similar code/IL rewrite tool).</p>
<p>However, as a developer explained in the <strong>above discussion</strong> , rewriting code
won't let the compiler knows your intent and thus it will probably fail at
optimizing your resulting code. As a language feature, the result is expected
to be better.</p>
<h4>A bit of history</h4>
<p>There was an <strong>extension members</strong> item in the <strong>C# 7 work list</strong> so I thought
it might be supported in the near future. The current status of extension
property can be found on Github under the related item.</p>
<p>However, there is an even more promising topic which is the "extend
everything" with a focus on especially properties and static classes or even
fields.</p>
<p><em><strong>Update: August 2016</strong></em></p>
<p>As dotnet team published what's new in C# 7.0 and from a comment of Mads
Torgensen:</p>
<blockquote>
<p>Extension properties: we had a (brilliant!) intern implement them over the
summer as an experiment, along with other kinds of extension members. We
remain interested in this, but it’s a big change and we need to feel
confident that it’s worth it.</p>
</blockquote>
<p>It seems that extension properties and other members, are still good
candidates to be included in a future release of Roslyn, but maybe not the 7.0
one.</p>
<p><em><strong>Update: May 2017</strong></em></p>
<p><strong>The extension members</strong> has been closed as duplicate of <strong>extension
everything issue</strong> which is closed too. The main discussion was in fact about
Type extensibility in a broad sense. The feature is now tracked <strong>here as a
proposal</strong> and has been removed from <strong>7.0 milestone</strong>.</p>
<p><em><strong>Update: August, 2017 - C# 8.0 proposed feature</strong></em></p>
<p>While it still remains only a <em>proposed</em> feature, we have now a clearer view
of what would be its syntax. Keep in mind that this will be the new syntax for
extension methods as well:</p>
<div class="code"><pre class="code literal-block"><span class="n">public</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="n">IEmployee</span><span class="w"> </span>
<span class="p">{</span>
<span class="w">    </span><span class="n">public</span><span class="w"> </span><span class="n">decimal</span><span class="w"> </span><span class="n">Salary</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">get</span><span class="p">;</span><span class="w"> </span><span class="n">set</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="p">}</span>

<span class="n">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">Employee</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">public</span><span class="w"> </span><span class="n">decimal</span><span class="w"> </span><span class="n">Salary</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">get</span><span class="p">;</span><span class="w"> </span><span class="n">set</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="p">}</span>

<span class="n">public</span><span class="w"> </span><span class="n">extension</span><span class="w"> </span><span class="n">MyPersonExtension</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="n">Person</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">IEmployee</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">private</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">readonly</span><span class="w"> </span><span class="n">ConditionalWeakTable</span><span class="o">&lt;</span><span class="n">Person</span><span class="p">,</span><span class="w"> </span><span class="n">Employee</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_employees</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<span class="w">        </span><span class="n">new</span><span class="w"> </span><span class="n">ConditionalWeakTable</span><span class="o">&lt;</span><span class="n">Person</span><span class="p">,</span><span class="w"> </span><span class="n">Employee</span><span class="o">&gt;</span><span class="p">();</span>


<span class="w">    </span><span class="n">public</span><span class="w"> </span><span class="n">decimal</span><span class="w"> </span><span class="n">Salary</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">get</span><span class="w"> </span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="o">//</span><span class="w"> </span><span class="err">`</span><span class="n">this</span><span class="err">`</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">instance</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">Person</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">_employees</span><span class="o">.</span><span class="n">GetOrCreate</span><span class="p">(</span><span class="n">this</span><span class="p">)</span><span class="o">.</span><span class="n">Salary</span><span class="p">;</span><span class="w"> </span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">set</span><span class="w"> </span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="n">Employee</span><span class="w"> </span><span class="n">employee</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb nb-Type">null</span><span class="p">;</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">_employees</span><span class="o">.</span><span class="n">TryGetValue</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="n">employee</span><span class="p">)</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">                </span><span class="n">employee</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_employees</span><span class="o">.</span><span class="n">GetOrCreate</span><span class="p">(</span><span class="n">this</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="n">employee</span><span class="o">.</span><span class="n">Salary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="n">IEmployee</span><span class="w"> </span><span class="n">person</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">Person</span><span class="p">();</span>
<span class="k">var</span><span class="w"> </span><span class="n">salary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">person</span><span class="o">.</span><span class="n">Salary</span><span class="p">;</span>
</pre></div>

<p>Similar to partial classes, but compiled as a separate class/type in a
different assembly. Note you will also be able to add static members and
operators this way. As mentioned in Mads Torgensen podcast, <em><strong>the extension
won't have any state (so it cannot add private instance members to the class)
which means you won't be able to add private instance data linked to the
instance</strong></em>. The reason invoked for that is it would imply to manage
internally dictionaries and it could be difficult (memory management, etc...).
For this, you can still use the <code>TypeDescriptor</code>/<code>ConditionalWeakTable</code>
technique described earlier and with the property extension, hides it under a
nice property.</p>
<p>Syntax is still subject to change as implies this issue. For example,
<code>extends</code> could be replaced by <code>for</code> which some may feel more natural and less
java related.</p>
<p><strong>Update December 2018 - Roles, Extensions and static interface members</strong></p>
<p><em>Extension everything</em> didn't make it to C# 8.0, because of some of drawbacks
explained as the end of this GitHub ticket. So, there was an exploration to
improve the design. Here, Mads Torgensen explains what are <strong>roles and
extensions</strong> and how they differs:</p>
<blockquote>
<p>Roles allow interfaces to be implemented on specific values of a given type.
Extensions allow interfaces to be implemented on all values of a given type,
within a specific region of code.</p>
</blockquote>
<p>It can be seen at a split of previous proposal in two use cases. The <strong>new
syntax for extension</strong> would be like this:</p>
<div class="code"><pre class="code literal-block"><span class="nv">public</span><span class="w"> </span><span class="nv">extension</span><span class="w"> </span><span class="nv">ULongEnumerable</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">ulong</span>
{
<span class="w">    </span><span class="nv">public</span><span class="w"> </span><span class="nv">IEnumerator</span><span class="o">&lt;</span><span class="nv">byte</span><span class="o">&gt;</span><span class="w"> </span><span class="nv">GetEnumerator</span><span class="ss">()</span>
<span class="w">    </span>{
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="ss">(</span><span class="nv">int</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">sizeof</span><span class="ss">(</span><span class="nv">ulong</span><span class="ss">)</span><span class="c1">; i &gt; 0; i--)</span>
<span class="w">        </span>{
<span class="w">            </span><span class="nv">yield</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nv">unchecked</span><span class="ss">((</span><span class="nv">byte</span><span class="ss">)(</span><span class="nv">this</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="ss">(</span><span class="nv">i</span><span class="o">-</span><span class="mi">1</span><span class="ss">)</span><span class="o">*</span><span class="mi">8</span><span class="ss">))</span><span class="c1">;</span>
<span class="w">        </span>}
<span class="w">    </span>}
}
</pre></div>

<p>then you would be able to do this:</p>
<div class="code"><pre class="code literal-block"><span class="nt">foreach</span><span class="w"> </span><span class="o">(</span><span class="nt">byte</span><span class="w"> </span><span class="nt">b</span><span class="w"> </span><span class="nt">in</span><span class="w"> </span><span class="nt">0x_3A_9E_F1_C5_DA_F7_30_16ul</span><span class="o">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="err">WriteLine($"{e.</span><span class="n">Current</span><span class="p">:</span><span class="n">X</span><span class="p">}</span><span class="err">"</span><span class="o">);</span>
<span class="err">}</span>
</pre></div>

<p>And for a <strong>static interface</strong> :</p>
<div class="code"><pre class="code literal-block">public interface IMonoid&lt;T&gt; where T : IMonoid&lt;T&gt;
{
    static T operator +(T t1, T t2);
    static T Zero { get; }
}
</pre></div>

<p>Add an <strong>extension property</strong> on <code>int</code> and treat the <code>int</code> as <code>IMonoid&lt;int&gt;</code>:</p>
<div class="code"><pre class="code literal-block">public extension IntMonoid of int : IMonoid&lt;int&gt;
{
    public static int Zero =&gt; 0;
}
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>No they do not exist in C# 3.0 and will not be added in 4.0. It's on the list
of feature wants for C# so it may be added at a future date.</p>
<p>At this point the best you can do is GetXXX style extension methods.</p>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/net-c/" rel="tag">.net-c#</a></li>
            <li><a class="tag p-category" href="../../categories/extension-methods/" rel="tag">extension-methods</a></li>
            <li><a class="tag p-category" href="../../categories/properties/" rel="tag">properties</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../why-is-null-an-object-and-what-s-the-difference-between-null-and-undefined/" rel="prev" title="Why is null an object and what's the difference between null and undefined?">Previous post</a>
            </li>
            <li class="next">
                <a href="../how-to-send-an-object-from-one-android-activity-to-another-using-intents/" rel="next" title="How to send an object from one Android Activity to another using Intents?">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="../../assets/js/search.js"></script>
</body>
</html>
