<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>为什么 RecyclerView 没有 onItemClickListener()？ | StackOverflow Snapshot</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/posts/wei-shi-yao-recyclerview-mei-you-onitemclicklistener/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Arya">
<link rel="prev" href="../ru-he-ji-suan-git-zhong-liang-ci-ti-jiao-zhi-jian-geng-gai-de-xing-shu/" title="如何计算 Git 中两次提交之间更改的行数？" type="text/html">
<link rel="next" href="../zhi-biao-fu-kong-jian-er-bu-shi-duo-ge-bu-jian-duan-kong-ge-nbsp/" title="制表符空间而不是多个不间断空格（“nbsp”）？" type="text/html">
<meta property="og:site_name" content="StackOverflow Snapshot">
<meta property="og:title" content="为什么 RecyclerView 没有 onItemClickListener()？">
<meta property="og:url" content="https://ohstackoverflow.netlify.app/posts/wei-shi-yao-recyclerview-mei-you-onitemclicklistener/">
<meta property="og:description" content="我正在探索RecyclerView，我很惊讶地发现RecyclerView没有onItemClickListener().
我有两个问题。
主要问题
我想知道为什么谷歌删除onItemClickListener()？
是否存在性能问题或其他问题？
次要问题
onClick我通过写在我的解决了我的问题RecyclerView.Adapter：
public static class ViewHold">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-02-17T06:58:24+08:00">
<meta property="article:tag" content="android">
<meta property="article:tag" content="android-recyclerview">
<meta property="article:tag" content="java">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">为什么 RecyclerView 没有 onItemClickListener()？</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T06:58:24+08:00" itemprop="datePublished" title="2023-02-17 06:58">2023-02-17 06:58</time></a>
            </p>
            

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>我正在探索<code>RecyclerView</code>，我很惊讶地发现<code>RecyclerView</code>没有<code>onItemClickListener()</code>.</p>
<p>我有两个问题。</p>
<h2>主要问题</h2>
<p>我想知道为什么谷歌删除<code>onItemClickListener()</code>？</p>
<p>是否存在性能问题或其他问题？</p>
<h2>次要问题</h2>
<p><code>onClick</code>我通过写在我的解决了我的问题<code>RecyclerView.Adapter</code>：</p>
<div class="code"><pre class="code literal-block"><span class="n">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">ViewHolder</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="n">RecyclerView</span><span class="o">.</span><span class="n">ViewHolder</span><span class="w"> </span><span class="n">implements</span><span class="w"> </span><span class="n">OnClickListener</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="n">public</span><span class="w"> </span><span class="n">TextView</span><span class="w"> </span><span class="n">txtViewTitle</span><span class="p">;</span>
<span class="w">    </span><span class="n">public</span><span class="w"> </span><span class="n">ImageView</span><span class="w"> </span><span class="n">imgViewIcon</span><span class="p">;</span>

<span class="w">    </span><span class="n">public</span><span class="w"> </span><span class="n">ViewHolder</span><span class="p">(</span><span class="n">View</span><span class="w"> </span><span class="n">itemLayoutView</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">super</span><span class="p">(</span><span class="n">itemLayoutView</span><span class="p">);</span>
<span class="w">        </span><span class="n">txtViewTitle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">TextView</span><span class="p">)</span><span class="w"> </span><span class="n">itemLayoutView</span><span class="o">.</span><span class="n">findViewById</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">item_title</span><span class="p">);</span>
<span class="w">        </span><span class="n">imgViewIcon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">ImageView</span><span class="p">)</span><span class="w"> </span><span class="n">itemLayoutView</span><span class="o">.</span><span class="n">findViewById</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">item_icon</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="err">@</span><span class="n">Override</span>
<span class="w">    </span><span class="n">public</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="w"> </span><span class="n">onClick</span><span class="p">(</span><span class="n">View</span><span class="w"> </span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p>这样可以吗/有没有更好的方法？</p>
<p><br><br></p>
<h2>解答</h2>
<p><strong>tl; dr 2016</strong> 使用 RxJava 和 PublishSubject 为点击公开 Observable。</p>
<div class="code"><pre class="code literal-block"><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">ReactiveAdapter</span><span class="w"> </span><span class="n">extends</span><span class="w"> </span><span class="n">RecyclerView</span><span class="p">.</span><span class="n">Adapter</span><span class="o">&lt;</span><span class="n">MyAdapter</span><span class="p">.</span><span class="n">ViewHolder</span><span class="o">&gt;</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="n">String</span><span class="err">[]</span><span class="w"> </span><span class="n">mDataset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="ss">"Data"</span><span class="p">,</span><span class="w"> </span><span class="ss">"In"</span><span class="p">,</span><span class="w"> </span><span class="ss">"Adapter"</span><span class="w"> </span><span class="err">}</span><span class="p">;</span>

<span class="w">    </span><span class="n">private</span><span class="w"> </span><span class="n">final</span><span class="w"> </span><span class="n">PublishSubject</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">onClickSubject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PublishSubject</span><span class="p">.</span><span class="k">create</span><span class="p">();</span>

<span class="w">    </span><span class="nv">@Override</span><span class="w"> </span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="n">onBindViewHolder</span><span class="p">(</span><span class="n">final</span><span class="w"> </span><span class="n">ViewHolder</span><span class="w"> </span><span class="n">holder</span><span class="p">,</span><span class="w"> </span><span class="nc">int</span><span class="w"> </span><span class="k">position</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="n">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="k">element</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mDataset</span><span class="o">[</span><span class="n">position</span><span class="o">]</span><span class="p">;</span>

<span class="w">        </span><span class="n">holder</span><span class="p">.</span><span class="n">itemView</span><span class="p">.</span><span class="n">setOnClickListener</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="k">View</span><span class="p">.</span><span class="n">OnClickListener</span><span class="p">()</span><span class="w"> </span><span class="err">{</span>
<span class="w">            </span><span class="nv">@Override</span>
<span class="w">            </span><span class="k">public</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="n">onClick</span><span class="p">(</span><span class="k">View</span><span class="w"> </span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">               </span><span class="n">onClickSubject</span><span class="p">.</span><span class="n">onNext</span><span class="p">(</span><span class="k">element</span><span class="p">);</span>
<span class="w">            </span><span class="err">}</span>
<span class="w">        </span><span class="err">}</span><span class="p">);</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="n">Observable</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">getPositionClicks</span><span class="p">()</span><span class="err">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">onClickSubject</span><span class="p">.</span><span class="n">asObservable</span><span class="p">();</span>
<span class="w">    </span><span class="err">}</span>
<span class="err">}</span>
</pre></div>

<p><strong>原帖：</strong></p>
<p>自推出以来<code>ListView</code>，<code>onItemClickListener</code>一直存在问题。当你有任何内部元素的点击监听器时，回调不会被触发，但它没有被通知或被很好地记录（如果有的话）所以有很多困惑和关于它的问题。</p>
<p>鉴于这<code>RecyclerView</code>更进一步并且没有行/列的概念，而是任意布置的子级数量，他们已将 onClick 委托给每个子级，或委托给程序员实现。</p>
<p><code>Recyclerview</code>不要将其视为<code>ListView</code>1:1
的替代品，而应将其视为复杂用例的更灵活的组件。正如您所说，您的解决方案正是谷歌对您的期望。现在您有了一个适配器，它可以将 onClick
委托给传递给构造函数的接口，这对于 和 都是正确的<code>ListView</code>模式<code>Recyclerview</code>。</p>
<div class="code"><pre class="code literal-block"><span class="n">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">ViewHolder</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="n">RecyclerView</span><span class="o">.</span><span class="n">ViewHolder</span><span class="w"> </span><span class="n">implements</span><span class="w"> </span><span class="n">OnClickListener</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="n">public</span><span class="w"> </span><span class="n">TextView</span><span class="w"> </span><span class="n">txtViewTitle</span><span class="p">;</span>
<span class="w">    </span><span class="n">public</span><span class="w"> </span><span class="n">ImageView</span><span class="w"> </span><span class="n">imgViewIcon</span><span class="p">;</span>
<span class="w">    </span><span class="n">public</span><span class="w"> </span><span class="n">IMyViewHolderClicks</span><span class="w"> </span><span class="n">mListener</span><span class="p">;</span>

<span class="w">    </span><span class="n">public</span><span class="w"> </span><span class="n">ViewHolder</span><span class="p">(</span><span class="n">View</span><span class="w"> </span><span class="n">itemLayoutView</span><span class="p">,</span><span class="w"> </span><span class="n">IMyViewHolderClicks</span><span class="w"> </span><span class="n">listener</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">super</span><span class="p">(</span><span class="n">itemLayoutView</span><span class="p">);</span>
<span class="w">        </span><span class="n">mListener</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">listener</span><span class="p">;</span>
<span class="w">        </span><span class="n">txtViewTitle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">TextView</span><span class="p">)</span><span class="w"> </span><span class="n">itemLayoutView</span><span class="o">.</span><span class="n">findViewById</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">item_title</span><span class="p">);</span>
<span class="w">        </span><span class="n">imgViewIcon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">ImageView</span><span class="p">)</span><span class="w"> </span><span class="n">itemLayoutView</span><span class="o">.</span><span class="n">findViewById</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">item_icon</span><span class="p">);</span>
<span class="w">        </span><span class="n">imgViewIcon</span><span class="o">.</span><span class="n">setOnClickListener</span><span class="p">(</span><span class="n">this</span><span class="p">);</span>
<span class="w">        </span><span class="n">itemLayoutView</span><span class="o">.</span><span class="n">setOnClickListener</span><span class="p">(</span><span class="n">this</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="err">@</span><span class="n">Override</span>
<span class="w">    </span><span class="n">public</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="w"> </span><span class="n">onClick</span><span class="p">(</span><span class="n">View</span><span class="w"> </span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="w"> </span><span class="n">instanceof</span><span class="w"> </span><span class="n">ImageView</span><span class="p">){</span>
<span class="w">           </span><span class="n">mListener</span><span class="o">.</span><span class="n">onTomato</span><span class="p">((</span><span class="n">ImageView</span><span class="p">)</span><span class="n">v</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">           </span><span class="n">mListener</span><span class="o">.</span><span class="n">onPotato</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="n">IMyViewHolderClicks</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">public</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="w"> </span><span class="n">onPotato</span><span class="p">(</span><span class="n">View</span><span class="w"> </span><span class="n">caller</span><span class="p">);</span>
<span class="w">        </span><span class="n">public</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="w"> </span><span class="n">onTomato</span><span class="p">(</span><span class="n">ImageView</span><span class="w"> </span><span class="n">callerImage</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="p">}</span>
</pre></div>

<p>然后在你的适配器上</p>
<div class="code"><pre class="code literal-block"><span class="n">public</span> <span class="k">class</span> <span class="n">MyAdapter</span> <span class="n">extends</span> <span class="n">RecyclerView</span>.<span class="n">Adapter</span><span class="s">&lt;MyAdapter.ViewHolder&gt;</span> {

   <span class="n">String</span>[] <span class="n">mDataset</span> = { <span class="s">"Data"</span> };

   <span class="nv">@Override</span>
   <span class="n">public</span> <span class="n">MyAdapter</span>.<span class="n">ViewHolder</span> <span class="n">onCreateViewHolder</span>(<span class="n">ViewGroup</span> <span class="nb">parent</span>, <span class="n">int</span> <span class="n">viewType</span>) {
       <span class="n">View</span> <span class="n">v</span> = <span class="n">LayoutInflater</span>.<span class="nb">from</span>(<span class="nb">parent</span>.<span class="n">getContext</span>()).<span class="n">inflate</span>(<span class="n">R</span>.<span class="n">layout</span>.<span class="n">my_layout</span>, <span class="nb">parent</span>, <span class="n">false</span>);

       <span class="n">MyAdapter</span>.<span class="n">ViewHolder</span> <span class="n">vh</span> = <span class="nb">new</span> <span class="n">ViewHolder</span>(<span class="n">v</span>, <span class="nb">new</span> <span class="n">MyAdapter</span>.<span class="n">ViewHolder</span>.<span class="n">IMyViewHolderClicks</span>() { 
           <span class="n">public</span> <span class="n">void</span> <span class="n">onPotato</span>(<span class="n">View</span> <span class="n">caller</span>) { <span class="n">Log</span>.<span class="nb">d</span>(<span class="s">"VEGETABLES"</span>, <span class="s">"Poh-tah-tos"</span>); };
           <span class="n">public</span> <span class="n">void</span> <span class="n">onTomato</span>(<span class="n">ImageView</span> <span class="n">callerImage</span>) { <span class="n">Log</span>.<span class="nb">d</span>(<span class="s">"VEGETABLES"</span>, <span class="s">"To-m8-tohs"</span>); }
        });
        <span class="k">return</span> <span class="n">vh</span>;
    }

    // <span class="n">Replace</span> <span class="n">the</span> <span class="nb">contents</span> <span class="nb">of</span> <span class="n">a</span> <span class="n">view</span> (<span class="n">invoked</span> <span class="n">by</span> <span class="n">the</span> <span class="n">layout</span> <span class="n">manager</span>) 
    <span class="nv">@Override</span> 
    <span class="n">public</span> <span class="n">void</span> <span class="n">onBindViewHolder</span>(<span class="n">ViewHolder</span> <span class="n">holder</span>, <span class="n">int</span> <span class="n">position</span>) {
        // <span class="n">Get</span> <span class="n">element</span> <span class="nb">from</span> <span class="n">your</span> <span class="n">dataset</span> <span class="nb">at</span> <span class="n">this</span> <span class="n">position</span> 
        // <span class="n">Replace</span> <span class="n">the</span> <span class="nb">contents</span> <span class="nb">of</span> <span class="n">the</span> <span class="n">view</span> <span class="k">with</span> <span class="n">that</span> <span class="n">element</span> 
        // <span class="n">Clear</span> <span class="n">the</span> <span class="n">ones</span> <span class="n">that</span> <span class="n">won't</span> <span class="n">be</span> <span class="n">used</span>
        <span class="n">holder</span>.<span class="n">txtViewTitle</span>.<span class="n">setText</span>(<span class="n">mDataset</span>[<span class="n">position</span>]);
    }

    // <span class="n">Return</span> <span class="n">the</span> <span class="n">size</span> <span class="nb">of</span> <span class="n">your</span> <span class="n">dataset</span> (<span class="n">invoked</span> <span class="n">by</span> <span class="n">the</span> <span class="n">layout</span> <span class="n">manager</span>) 
    <span class="nv">@Override</span> 
    <span class="n">public</span> <span class="n">int</span> <span class="n">getItemCount</span>() { 
        <span class="k">return</span> <span class="n">mDataset</span>.<span class="n">length</span>;
    } 
  ...
</pre></div>

<p>现在查看最后一段代码：<code>onCreateViewHolder(ViewGroup parent, int
viewType)</code>签名已经建议了不同的视图类型。对于它们中的每一个，您也将需要一个不同的
viewholder，随后它们中的每一个都可以有一组不同的点击。或者您可以只创建一个通用的视图持有者，它接受任何视图和一个视图<code>onClickListener</code>并相应地应用。或者将一个级别委托给编排器，以便多个片段/活动具有相同的列表，但点击行为不同。同样，所有的灵活性都在你这边。</p>
<p>它是一个真正需要的组件，并且与我们<code>ListView</code>迄今为止的内部实现和改进非常接近。谷歌终于承认了，这很好。</p>
<p><br></p>
<h3>更多建议</h3>
<h2>为什么 RecyclerView 没有<code>onItemClickListener</code>
</h2>
<p>这<code>RecyclerView</code>是一个工具箱，与旧工具箱相比，<code>ListView</code>它具有更少的内置功能和更多的灵活性。这<code>onItemClickListener</code>不是从
ListView 中删除的唯一功能。但是它有很多听众和方法可以根据您的喜好扩展它，在合适的人手中它会更强大;)。</p>
<p>在我看来，其中删除的最复杂的功能<code>RecyclerView</code>是 <em>Fast Scroll</em> 。大多数其他功能都可以轻松地重新实现。</p>
<p>如果您想知道<code>RecyclerView</code>添加了哪些其他很酷的功能，请阅读另一个问题的答案。</p>
<h2>内存高效 - onItemClickListener 的嵌入式解决方案</h2>
<p>这个解决方案是由Android GDE <em>Hugo Visser</em> 在发布后立即提出的。他为您提供了一个免许可课程，您只需输入您的代码并使用它。
__<code>RecyclerView</code></p>
<p>它展示了通过<code>RecyclerView</code>使用<code>RecyclerView.OnChildAttachStateChangeListener</code>.</p>
<p><em><strong>编辑 2019</strong> ：我的 kotlin 版本，java one，来自 Hugo Visser，保留在下面</em></p>
<h3>科特林 / 爪哇</h3>
<p>创建一个文件<code>values/ids.xml</code>并将其放入其中：</p>
<div class="code"><pre class="code literal-block"><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="nt">&lt;resources&gt;</span>
<span class="w">    </span><span class="nt">&lt;item</span><span class="w"> </span><span class="na">name=</span><span class="s">"item_click_support"</span><span class="w"> </span><span class="na">type=</span><span class="s">"id"</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="nt">&lt;/resources&gt;</span>
</pre></div>

<p>然后将下面的代码添加到您的源代码中</p>
<h3>科特林</h3>
<p>用法：</p>
<div class="code"><pre class="code literal-block"><span class="n">recyclerView</span><span class="p">.</span><span class="n">onItemClick</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">recyclerView</span><span class="p">,</span><span class="w"> </span><span class="n">position</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">    </span><span class="c1">// do it</span>
<span class="p">}</span>
</pre></div>

<p>（它还支持长项目点击，请参阅下面我添加的另一个功能）。</p>
<p>实现（我对 Hugo Visser Java 代码的改编）：</p>
<div class="code"><pre class="code literal-block">typealias<span class="w"> </span>OnRecyclerViewItemClickListener<span class="w"> </span>=<span class="w"> </span>(recyclerView:<span class="w"> </span>RecyclerView,<span class="w"> </span>position:<span class="w"> </span>Int,<span class="w"> </span>v:<span class="w"> </span>View)<span class="w"> </span>-&gt;<span class="w"> </span>Unit
typealias<span class="w"> </span>OnRecyclerViewItemLongClickListener<span class="w"> </span>=<span class="w"> </span>(recyclerView:<span class="w"> </span>RecyclerView,<span class="w"> </span>position:<span class="w"> </span>Int,<span class="w"> </span>v:<span class="w"> </span>View)<span class="w"> </span>-&gt;<span class="w"> </span>Boolean

class<span class="w"> </span>ItemClickSupport<span class="w"> </span>private<span class="w"> </span>constructor(private<span class="w"> </span>val<span class="w"> </span>recyclerView:<span class="w"> </span>RecyclerView)<span class="w"> </span>{

<span class="w">    </span>private<span class="w"> </span>var<span class="w"> </span>onItemClickListener:<span class="w"> </span>OnRecyclerViewItemClickListener?<span class="w"> </span>=<span class="w"> </span>null
<span class="w">    </span>private<span class="w"> </span>var<span class="w"> </span>onItemLongClickListener:<span class="w"> </span>OnRecyclerViewItemLongClickListener?<span class="w"> </span>=<span class="w"> </span>null

<span class="w">    </span>private<span class="w"> </span>val<span class="w"> </span>attachListener:<span class="w"> </span>RecyclerView.OnChildAttachStateChangeListener<span class="w"> </span>=<span class="w"> </span>object<span class="w"> </span>:<span class="w"> </span>RecyclerView.OnChildAttachStateChangeListener<span class="w"> </span>{
<span class="w">        </span>override<span class="w"> </span>fun<span class="w"> </span>onChildViewAttachedToWindow(view:<span class="w"> </span>View)<span class="w"> </span>{
<span class="w">            </span>//<span class="w"> </span>every<span class="w"> </span>time<span class="w"> </span>a<span class="w"> </span>new<span class="w"> </span>child<span class="w"> </span>view<span class="w"> </span>is<span class="w"> </span>attached<span class="w"> </span>add<span class="w"> </span>click<span class="w"> </span>listeners<span class="w"> </span>to<span class="w"> </span>it
<span class="w">            </span>val<span class="w"> </span>holder<span class="w"> </span>=<span class="w"> </span>this@ItemClickSupport.recyclerView.getChildViewHolder(view)
<span class="w">                    </span>.takeIf<span class="w"> </span>{<span class="w"> </span>it<span class="w"> </span>is<span class="w"> </span>ItemClickSupportViewHolder<span class="w"> </span>}<span class="w"> </span>as?<span class="w"> </span>ItemClickSupportViewHolder

<span class="w">            </span>if<span class="w"> </span>(onItemClickListener<span class="w"> </span>!=<span class="w"> </span>null<span class="w"> </span><span class="err">&amp;&amp;</span><span class="w"> </span>holder?.isClickable<span class="w"> </span>!=<span class="w"> </span>false)<span class="w"> </span>{
<span class="w">                </span>view.setOnClickListener(onClickListener)
<span class="w">            </span>}
<span class="w">            </span>if<span class="w"> </span>(onItemLongClickListener<span class="w"> </span>!=<span class="w"> </span>null<span class="w"> </span><span class="err">&amp;&amp;</span><span class="w"> </span>holder?.isLongClickable<span class="w"> </span>!=<span class="w"> </span>false)<span class="w"> </span>{
<span class="w">                </span>view.setOnLongClickListener(onLongClickListener)
<span class="w">            </span>}
<span class="w">        </span>}

<span class="w">        </span>override<span class="w"> </span>fun<span class="w"> </span>onChildViewDetachedFromWindow(view:<span class="w"> </span>View)<span class="w"> </span>{

<span class="w">        </span>}
<span class="w">    </span>}

<span class="w">    </span>init<span class="w"> </span>{
<span class="w">        </span>//<span class="w"> </span>the<span class="w"> </span>ID<span class="w"> </span>must<span class="w"> </span>be<span class="w"> </span>declared<span class="w"> </span>in<span class="w"> </span>XML,<span class="w"> </span>used<span class="w"> </span>to<span class="w"> </span>avoid
<span class="w">        </span>//<span class="w"> </span>replacing<span class="w"> </span>the<span class="w"> </span>ItemClickSupport<span class="w"> </span>without<span class="w"> </span>removing
<span class="w">        </span>//<span class="w"> </span>the<span class="w"> </span>old<span class="w"> </span>one<span class="w"> </span>from<span class="w"> </span>the<span class="w"> </span>RecyclerView
<span class="w">        </span>this.recyclerView.setTag(R.id.item_click_support,<span class="w"> </span>this)
<span class="w">        </span>this.recyclerView.addOnChildAttachStateChangeListener(attachListener)
<span class="w">    </span>}

<span class="w">    </span>companion<span class="w"> </span>object<span class="w"> </span>{
<span class="w">        </span>fun<span class="w"> </span>addTo(view:<span class="w"> </span>RecyclerView):<span class="w"> </span>ItemClickSupport<span class="w"> </span>{
<span class="w">            </span>//<span class="w"> </span>if<span class="w"> </span>there's<span class="w"> </span>already<span class="w"> </span>an<span class="w"> </span>ItemClickSupport<span class="w"> </span>attached
<span class="w">            </span>//<span class="w"> </span>to<span class="w"> </span>this<span class="w"> </span>RecyclerView<span class="w"> </span>do<span class="w"> </span>not<span class="w"> </span>replace<span class="w"> </span>it,<span class="w"> </span>use<span class="w"> </span>it
<span class="w">            </span>var<span class="w"> </span>support:<span class="w"> </span>ItemClickSupport?<span class="w"> </span>=<span class="w"> </span>view.getTag(R.id.item_click_support)<span class="w"> </span>as?<span class="w"> </span>ItemClickSupport
<span class="w">            </span>if<span class="w"> </span>(support<span class="w"> </span>==<span class="w"> </span>null)<span class="w"> </span>{
<span class="w">                </span>support<span class="w"> </span>=<span class="w"> </span>ItemClickSupport(view)
<span class="w">            </span>}
<span class="w">            </span>return<span class="w"> </span>support
<span class="w">        </span>}

<span class="w">        </span>fun<span class="w"> </span>removeFrom(view:<span class="w"> </span>RecyclerView):<span class="w"> </span>ItemClickSupport?<span class="w"> </span>{
<span class="w">            </span>val<span class="w"> </span>support<span class="w"> </span>=<span class="w"> </span>view.getTag(R.id.item_click_support)<span class="w"> </span>as?<span class="w"> </span>ItemClickSupport
<span class="w">            </span>support?.detach(view)
<span class="w">            </span>return<span class="w"> </span>support
<span class="w">        </span>}
<span class="w">    </span>}

<span class="w">    </span>private<span class="w"> </span>val<span class="w"> </span>onClickListener<span class="w"> </span>=<span class="w"> </span>View.OnClickListener<span class="w"> </span>{<span class="w"> </span>v<span class="w"> </span>-&gt;
<span class="w">        </span>val<span class="w"> </span>listener<span class="w"> </span>=<span class="w"> </span>onItemClickListener<span class="w"> </span>?:<span class="w"> </span>return@OnClickListener
<span class="w">        </span>//<span class="w"> </span>ask<span class="w"> </span>the<span class="w"> </span>RecyclerView<span class="w"> </span>for<span class="w"> </span>the<span class="w"> </span>viewHolder<span class="w"> </span>of<span class="w"> </span>this<span class="w"> </span>view.
<span class="w">        </span>//<span class="w"> </span>then<span class="w"> </span>use<span class="w"> </span>it<span class="w"> </span>to<span class="w"> </span>get<span class="w"> </span>the<span class="w"> </span>position<span class="w"> </span>for<span class="w"> </span>the<span class="w"> </span>adapter
<span class="w">        </span>val<span class="w"> </span>holder<span class="w"> </span>=<span class="w"> </span>this.recyclerView.getChildViewHolder(v)
<span class="w">        </span>listener.invoke(this.recyclerView,<span class="w"> </span>holder.adapterPosition,<span class="w"> </span>v)
<span class="w">    </span>}

<span class="w">    </span>private<span class="w"> </span>val<span class="w"> </span>onLongClickListener<span class="w"> </span>=<span class="w"> </span>View.OnLongClickListener<span class="w"> </span>{<span class="w"> </span>v<span class="w"> </span>-&gt;
<span class="w">        </span>val<span class="w"> </span>listener<span class="w"> </span>=<span class="w"> </span>onItemLongClickListener<span class="w"> </span>?:<span class="w"> </span>return@OnLongClickListener<span class="w"> </span>false
<span class="w">        </span>val<span class="w"> </span>holder<span class="w"> </span>=<span class="w"> </span>this.recyclerView.getChildViewHolder(v)
<span class="w">        </span>return@OnLongClickListener<span class="w"> </span>listener.invoke(this.recyclerView,<span class="w"> </span>holder.adapterPosition,<span class="w"> </span>v)
<span class="w">    </span>}

<span class="w">    </span>private<span class="w"> </span>fun<span class="w"> </span>detach(view:<span class="w"> </span>RecyclerView)<span class="w"> </span>{
<span class="w">        </span>view.removeOnChildAttachStateChangeListener(attachListener)
<span class="w">        </span>view.setTag(R.id.item_click_support,<span class="w"> </span>null)
<span class="w">    </span>}

<span class="w">    </span>fun<span class="w"> </span>onItemClick(listener:<span class="w"> </span>OnRecyclerViewItemClickListener?):<span class="w"> </span>ItemClickSupport<span class="w"> </span>{
<span class="w">        </span>onItemClickListener<span class="w"> </span>=<span class="w"> </span>listener
<span class="w">        </span>return<span class="w"> </span>this
<span class="w">    </span>}

<span class="w">    </span>fun<span class="w"> </span>onItemLongClick(listener:<span class="w"> </span>OnRecyclerViewItemLongClickListener?):<span class="w"> </span>ItemClickSupport<span class="w"> </span>{
<span class="w">        </span>onItemLongClickListener<span class="w"> </span>=<span class="w"> </span>listener
<span class="w">        </span>return<span class="w"> </span>this
<span class="w">    </span>}

}

/**<span class="w"> </span>Give<span class="w"> </span>click-ability<span class="w"> </span>and<span class="w"> </span>long-click-ability<span class="w"> </span>control<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>ViewHolder<span class="w"> </span>*/
interface<span class="w"> </span>ItemClickSupportViewHolder<span class="w"> </span>{
<span class="w">    </span>val<span class="w"> </span>isClickable:<span class="w"> </span>Boolean<span class="w"> </span>get()<span class="w"> </span>=<span class="w"> </span>true
<span class="w">    </span>val<span class="w"> </span>isLongClickable:<span class="w"> </span>Boolean<span class="w"> </span>get()<span class="w"> </span>=<span class="w"> </span>true
}

//<span class="w"> </span>Extension<span class="w"> </span>function
fun<span class="w"> </span>RecyclerView.addItemClickSupport(configuration:<span class="w"> </span>ItemClickSupport.()<span class="w"> </span>-&gt;<span class="w"> </span>Unit<span class="w"> </span>=<span class="w"> </span>{})<span class="w"> </span>=<span class="w"> </span>ItemClickSupport.addTo(this).apply(configuration)

fun<span class="w"> </span>RecyclerView.removeItemClickSupport()<span class="w"> </span>=<span class="w"> </span>ItemClickSupport.removeFrom(this)

fun<span class="w"> </span>RecyclerView.onItemClick(onClick:<span class="w"> </span>OnRecyclerViewItemClickListener)<span class="w"> </span>{
<span class="w">    </span>addItemClickSupport<span class="w"> </span>{<span class="w"> </span>onItemClick(onClick)<span class="w"> </span>}
}
fun<span class="w"> </span>RecyclerView.onItemLongClick(onLongClick:<span class="w"> </span>OnRecyclerViewItemLongClickListener)<span class="w"> </span>{
<span class="w">    </span>addItemClickSupport<span class="w"> </span>{<span class="w"> </span>onItemLongClick(onLongClick)<span class="w"> </span>}
}
</pre></div>

<p>（请记住，您还需要添加一个 XML 文件，请参阅本节上方）</p>
<h4>Kotlin 版本的额外功能</h4>
<p>有时您不希望 RecyclerView 的所有项目都是可点击的。</p>
<p>为了处理这个问题，我引入了一个<code>ItemClickSupportViewHolder</code>界面，您可以使用<code>ViewHolder</code>该界面来控制可点击的项目。</p>
<p>例子：</p>
<div class="code"><pre class="code literal-block">class<span class="w"> </span>MyViewHolder(view):<span class="w"> </span>RecyclerView.ViewHolder(view),<span class="w"> </span>ItemClickSupportViewHolder<span class="w"> </span>{
<span class="w">    </span>override<span class="w"> </span>val<span class="w"> </span>isClickable:<span class="w"> </span>Boolean<span class="w"> </span>get()<span class="w"> </span>=<span class="w"> </span>false
<span class="w">    </span>override<span class="w"> </span>val<span class="w"> </span>isLongClickable:<span class="w"> </span>Boolean<span class="w"> </span>get()<span class="w"> </span>=<span class="w"> </span>false
}
</pre></div>

<h3>爪哇</h3>
<p>用法：</p>
<div class="code"><pre class="code literal-block"><span class="n">ItemClickSupport</span><span class="p">.</span><span class="n">addTo</span><span class="p">(</span><span class="n">mRecyclerView</span><span class="p">)</span>
<span class="w">        </span><span class="p">.</span><span class="n">setOnItemClickListener</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">ItemClickSupport</span><span class="p">.</span><span class="n">OnItemClickListener</span><span class="p">()</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="nv">@Override</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="n">onItemClicked</span><span class="p">(</span><span class="n">RecyclerView</span><span class="w"> </span><span class="n">recyclerView</span><span class="p">,</span><span class="w"> </span><span class="nc">int</span><span class="w"> </span><span class="k">position</span><span class="p">,</span><span class="w"> </span><span class="k">View</span><span class="w"> </span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="o">//</span><span class="w"> </span><span class="n">do</span><span class="w"> </span><span class="n">it</span>
<span class="w">    </span><span class="err">}</span>
<span class="err">}</span><span class="p">);</span>
</pre></div>

<p>（它也支持长项目点击）</p>
<p>实施（我添加的评论）：</p>
<div class="code"><pre class="code literal-block"><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">ItemClickSupport</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="n">private</span><span class="w"> </span><span class="n">final</span><span class="w"> </span><span class="n">RecyclerView</span><span class="w"> </span><span class="n">mRecyclerView</span><span class="p">;</span>
<span class="w">    </span><span class="n">private</span><span class="w"> </span><span class="n">OnItemClickListener</span><span class="w"> </span><span class="n">mOnItemClickListener</span><span class="p">;</span>
<span class="w">    </span><span class="n">private</span><span class="w"> </span><span class="n">OnItemLongClickListener</span><span class="w"> </span><span class="n">mOnItemLongClickListener</span><span class="p">;</span>
<span class="w">    </span><span class="n">private</span><span class="w"> </span><span class="k">View</span><span class="p">.</span><span class="n">OnClickListener</span><span class="w"> </span><span class="n">mOnClickListener</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="k">View</span><span class="p">.</span><span class="n">OnClickListener</span><span class="p">()</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="nv">@Override</span>
<span class="w">        </span><span class="k">public</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="n">onClick</span><span class="p">(</span><span class="k">View</span><span class="w"> </span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mOnItemClickListener</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">null</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">                </span><span class="o">//</span><span class="w"> </span><span class="n">ask</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">RecyclerView</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">viewHolder</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="k">view</span><span class="p">.</span>
<span class="w">                </span><span class="o">//</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">use</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">position</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">adapter</span>
<span class="w">                </span><span class="n">RecyclerView</span><span class="p">.</span><span class="n">ViewHolder</span><span class="w"> </span><span class="n">holder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mRecyclerView</span><span class="p">.</span><span class="n">getChildViewHolder</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
<span class="w">                </span><span class="n">mOnItemClickListener</span><span class="p">.</span><span class="n">onItemClicked</span><span class="p">(</span><span class="n">mRecyclerView</span><span class="p">,</span><span class="w"> </span><span class="n">holder</span><span class="p">.</span><span class="n">getAdapterPosition</span><span class="p">(),</span><span class="w"> </span><span class="n">v</span><span class="p">);</span>
<span class="w">            </span><span class="err">}</span>
<span class="w">        </span><span class="err">}</span>
<span class="w">    </span><span class="err">}</span><span class="p">;</span>
<span class="w">    </span><span class="n">private</span><span class="w"> </span><span class="k">View</span><span class="p">.</span><span class="n">OnLongClickListener</span><span class="w"> </span><span class="n">mOnLongClickListener</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="k">View</span><span class="p">.</span><span class="n">OnLongClickListener</span><span class="p">()</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="nv">@Override</span>
<span class="w">        </span><span class="k">public</span><span class="w"> </span><span class="k">boolean</span><span class="w"> </span><span class="n">onLongClick</span><span class="p">(</span><span class="k">View</span><span class="w"> </span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mOnItemLongClickListener</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">null</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">                </span><span class="n">RecyclerView</span><span class="p">.</span><span class="n">ViewHolder</span><span class="w"> </span><span class="n">holder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mRecyclerView</span><span class="p">.</span><span class="n">getChildViewHolder</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">mOnItemLongClickListener</span><span class="p">.</span><span class="n">onItemLongClicked</span><span class="p">(</span><span class="n">mRecyclerView</span><span class="p">,</span><span class="w"> </span><span class="n">holder</span><span class="p">.</span><span class="n">getAdapterPosition</span><span class="p">(),</span><span class="w"> </span><span class="n">v</span><span class="p">);</span>
<span class="w">            </span><span class="err">}</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">false</span><span class="p">;</span>
<span class="w">        </span><span class="err">}</span>
<span class="w">    </span><span class="err">}</span><span class="p">;</span>
<span class="w">    </span><span class="n">private</span><span class="w"> </span><span class="n">RecyclerView</span><span class="p">.</span><span class="n">OnChildAttachStateChangeListener</span><span class="w"> </span><span class="n">mAttachListener</span>
<span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">RecyclerView</span><span class="p">.</span><span class="n">OnChildAttachStateChangeListener</span><span class="p">()</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="nv">@Override</span>
<span class="w">        </span><span class="k">public</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="n">onChildViewAttachedToWindow</span><span class="p">(</span><span class="k">View</span><span class="w"> </span><span class="k">view</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">            </span><span class="o">//</span><span class="w"> </span><span class="k">every</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">child</span><span class="w"> </span><span class="k">view</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">attached</span><span class="w"> </span><span class="k">add</span><span class="w"> </span><span class="n">click</span><span class="w"> </span><span class="n">listeners</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">it</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mOnItemClickListener</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">null</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">                </span><span class="k">view</span><span class="p">.</span><span class="n">setOnClickListener</span><span class="p">(</span><span class="n">mOnClickListener</span><span class="p">);</span>
<span class="w">            </span><span class="err">}</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mOnItemLongClickListener</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">null</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">                </span><span class="k">view</span><span class="p">.</span><span class="n">setOnLongClickListener</span><span class="p">(</span><span class="n">mOnLongClickListener</span><span class="p">);</span>
<span class="w">            </span><span class="err">}</span>
<span class="w">        </span><span class="err">}</span>

<span class="w">        </span><span class="nv">@Override</span>
<span class="w">        </span><span class="k">public</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="n">onChildViewDetachedFromWindow</span><span class="p">(</span><span class="k">View</span><span class="w"> </span><span class="k">view</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>

<span class="w">        </span><span class="err">}</span>
<span class="w">    </span><span class="err">}</span><span class="p">;</span>

<span class="w">    </span><span class="n">private</span><span class="w"> </span><span class="n">ItemClickSupport</span><span class="p">(</span><span class="n">RecyclerView</span><span class="w"> </span><span class="n">recyclerView</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="n">mRecyclerView</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">recyclerView</span><span class="p">;</span>
<span class="w">        </span><span class="o">//</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ID</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">declared</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">XML</span><span class="p">,</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">avoid</span>
<span class="w">        </span><span class="o">//</span><span class="w"> </span><span class="n">replacing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ItemClickSupport</span><span class="w"> </span><span class="k">without</span><span class="w"> </span><span class="n">removing</span>
<span class="w">        </span><span class="o">//</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">old</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">RecyclerView</span>
<span class="w">        </span><span class="n">mRecyclerView</span><span class="p">.</span><span class="n">setTag</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="n">id</span><span class="p">.</span><span class="n">item_click_support</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="p">);</span>
<span class="w">        </span><span class="n">mRecyclerView</span><span class="p">.</span><span class="n">addOnChildAttachStateChangeListener</span><span class="p">(</span><span class="n">mAttachListener</span><span class="p">);</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">ItemClickSupport</span><span class="w"> </span><span class="n">addTo</span><span class="p">(</span><span class="n">RecyclerView</span><span class="w"> </span><span class="k">view</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="o">//</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">there</span><span class="err">'</span><span class="n">s</span><span class="w"> </span><span class="n">already</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">ItemClickSupport</span><span class="w"> </span><span class="n">attached</span>
<span class="w">        </span><span class="o">//</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">RecyclerView</span><span class="w"> </span><span class="n">do</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nf">replace</span><span class="w"> </span><span class="n">it</span><span class="p">,</span><span class="w"> </span><span class="k">use</span><span class="w"> </span><span class="n">it</span>
<span class="w">        </span><span class="n">ItemClickSupport</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">ItemClickSupport</span><span class="p">)</span><span class="w"> </span><span class="k">view</span><span class="p">.</span><span class="n">getTag</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="n">id</span><span class="p">.</span><span class="n">item_click_support</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">support</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">null</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">            </span><span class="n">support</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ItemClickSupport</span><span class="p">(</span><span class="k">view</span><span class="p">);</span>
<span class="w">        </span><span class="err">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">support</span><span class="p">;</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">ItemClickSupport</span><span class="w"> </span><span class="n">removeFrom</span><span class="p">(</span><span class="n">RecyclerView</span><span class="w"> </span><span class="k">view</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="n">ItemClickSupport</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">ItemClickSupport</span><span class="p">)</span><span class="w"> </span><span class="k">view</span><span class="p">.</span><span class="n">getTag</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="n">id</span><span class="p">.</span><span class="n">item_click_support</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">support</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">null</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">            </span><span class="n">support</span><span class="p">.</span><span class="n">detach</span><span class="p">(</span><span class="k">view</span><span class="p">);</span>
<span class="w">        </span><span class="err">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">support</span><span class="p">;</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="n">ItemClickSupport</span><span class="w"> </span><span class="n">setOnItemClickListener</span><span class="p">(</span><span class="n">OnItemClickListener</span><span class="w"> </span><span class="n">listener</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="n">mOnItemClickListener</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">listener</span><span class="p">;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">this</span><span class="p">;</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="n">ItemClickSupport</span><span class="w"> </span><span class="n">setOnItemLongClickListener</span><span class="p">(</span><span class="n">OnItemLongClickListener</span><span class="w"> </span><span class="n">listener</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="n">mOnItemLongClickListener</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">listener</span><span class="p">;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">this</span><span class="p">;</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="n">private</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="n">detach</span><span class="p">(</span><span class="n">RecyclerView</span><span class="w"> </span><span class="k">view</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="k">view</span><span class="p">.</span><span class="n">removeOnChildAttachStateChangeListener</span><span class="p">(</span><span class="n">mAttachListener</span><span class="p">);</span>
<span class="w">        </span><span class="k">view</span><span class="p">.</span><span class="n">setTag</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="n">id</span><span class="p">.</span><span class="n">item_click_support</span><span class="p">,</span><span class="w"> </span><span class="k">null</span><span class="p">);</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="n">OnItemClickListener</span><span class="w"> </span><span class="err">{</span>

<span class="w">        </span><span class="n">void</span><span class="w"> </span><span class="n">onItemClicked</span><span class="p">(</span><span class="n">RecyclerView</span><span class="w"> </span><span class="n">recyclerView</span><span class="p">,</span><span class="w"> </span><span class="nc">int</span><span class="w"> </span><span class="k">position</span><span class="p">,</span><span class="w"> </span><span class="k">View</span><span class="w"> </span><span class="n">v</span><span class="p">);</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="n">OnItemLongClickListener</span><span class="w"> </span><span class="err">{</span>

<span class="w">        </span><span class="k">boolean</span><span class="w"> </span><span class="n">onItemLongClicked</span><span class="p">(</span><span class="n">RecyclerView</span><span class="w"> </span><span class="n">recyclerView</span><span class="p">,</span><span class="w"> </span><span class="nc">int</span><span class="w"> </span><span class="k">position</span><span class="p">,</span><span class="w"> </span><span class="k">View</span><span class="w"> </span><span class="n">v</span><span class="p">);</span>
<span class="w">    </span><span class="err">}</span>
<span class="err">}</span>
</pre></div>

<h3>它是如何工作的（为什么它有效）</h3>
<p>此类通过将 a 附加<code>RecyclerView.OnChildAttachStateChangeListener</code>到
来工作<code>RecyclerView</code>。每次孩子附加到 或从
中分离时，都会通知此侦听器<code>RecyclerView</code>。代码使用它来将点击/长按侦听器附加到视图。该听众询问<code>RecyclerView</code>包含<code>RecyclerView.ViewHolder</code>位置的。</p>
<p><code>RecyclerView</code>这比其他解决方案更有效，因为它避免为每个视图创建多个侦听器，并在滚动时不断销毁和创建它们。</p>
<p>如果您需要更多，您还可以调整代码以将持有人本身还给您。</p>
<h2>最后的评论</h2>
<p>请记住，通过在列表的每个视图上设置一个点击侦听器，在您的适配器中处理它是完全可以的，就像其他建议的答案一样。</p>
<p>这不是最有效的做法（每次重用视图时都会创建一个新的侦听器）但它可以工作并且在大多数情况下这不是问题。</p>
<p>这也有点反对关注点分离，因为委托点击事件并不是适配器的真正职责。</p>
<p><br><br><a href="../why-doesn-t-recyclerview-have-onitemclicklistener/">查看原文</a></p>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/android/" rel="tag">android</a></li>
            <li><a class="tag p-category" href="../../categories/android-recyclerview/" rel="tag">android-recyclerview</a></li>
            <li><a class="tag p-category" href="../../categories/java/" rel="tag">java</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../ru-he-ji-suan-git-zhong-liang-ci-ti-jiao-zhi-jian-geng-gai-de-xing-shu/" rel="prev" title="如何计算 Git 中两次提交之间更改的行数？">Previous post</a>
            </li>
            <li class="next">
                <a href="../zhi-biao-fu-kong-jian-er-bu-shi-duo-ge-bu-jian-duan-kong-ge-nbsp/" rel="next" title="制表符空间而不是多个不间断空格（“nbsp”）？">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="../../assets/js/search.js"></script>
</body>
</html>
