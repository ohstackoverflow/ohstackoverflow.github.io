<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>What is the difference between using a Makefile and CMake to compile the code? | StackOverflow Snapshot</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/posts/what-is-the-difference-between-using-a-makefile-and-cmake-to-compile-the-code/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Arya">
<link rel="prev" href="../how-to-find-the-statistical-mode/" title="How to find the statistical mode?" type="text/html">
<link rel="next" href="../what-is-the-best-way-to-compare-floats-for-almost-equality-in-python/" title="What is the best way to compare floats for almost-equality in Python?" type="text/html">
<meta property="og:site_name" content="StackOverflow Snapshot">
<meta property="og:title" content="What is the difference between using a Makefile and CMake to compile t">
<meta property="og:url" content="https://ohstackoverflow.netlify.app/posts/what-is-the-difference-between-using-a-makefile-and-cmake-to-compile-the-code/">
<meta property="og:description" content="I code in C/C++ and use a (GNU) Makefile to compile the code. I can do the
same with CMake and get a Makefile. However, what is the difference between
using a Makefile and CMake to compile the code?

">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-03-03T06:45:43+08:00">
<meta property="article:tag" content="c">
<meta property="article:tag" content="c++">
<meta property="article:tag" content="cmake">
<meta property="article:tag" content="makefile">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">What is the difference between using a Makefile and CMake to compile the code?</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T06:45:43+08:00" itemprop="datePublished" title="2023-03-03 06:45">2023-03-03 06:45</time></a>
            </p>
            

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>I code in C/C++ and use a (GNU) Makefile to compile the code. I can do the
same with CMake and get a Makefile. However, what is the difference between
using a Makefile and CMake to compile the code?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Make (or rather a Makefile) is a buildsystem - it drives the compiler and
other build tools to build your code.</p>
<p>CMake is a generator of buildsystems. It can produce Makefiles, it can produce
Ninja build files, it can produce KDEvelop or Xcode projects, it can produce
Visual Studio solutions. From the same starting point, the same CMakeLists.txt
file. So if you have a platform-independent project, CMake is a way to make it
buildsystem-independent as well.</p>
<p>If you have Windows developers used to Visual Studio and Unix developers who
swear by GNU Make, CMake is (one of) the way(s) to go.</p>
<p>I would always recommend using CMake (or another buildsystem generator, but
CMake is my personal preference) if you intend your project to be multi-
platform or widely usable. CMake itself also provides some nice features like
dependency detection, library interface management, or integration with CTest,
CDash and CPack.</p>
<p>Using a buildsystem generator makes your project more future-proof. Even if
you're GNU-Make-only now, what if you later decide to expand to other
platforms (be it Windows or something embedded), or just want to use an IDE?</p>
<p><br></p>
<h3>Suggest</h3>
<p>The statement about CMake being a "build generator" is a common misconception.</p>
<p>It's not technically wrong; it just describes HOW it works, but not WHAT it
does.</p>
<p>In the context of the question, they do the same thing: take a bunch of C/C++
files and turn them into a binary.</p>
<p>So, what is the real difference?</p>
<ul>
<li>
<p>CMake is much more high-level. It's tailored to compile C++, for which you write much less build code, but can be also used for general purpose build. <code>make</code> has some built-in C/C++ rules as well, but they are useless at best.</p>
</li>
<li>
<p><code>CMake</code> does a two-step build: it generates a low-level build script in <code>ninja</code> or <code>make</code> or many other generators, and then you run it. All the shell script pieces that are normally piled into <code>Makefile</code> are only executed at the generation stage. Thus, <code>CMake</code> build can be orders of magnitude faster.</p>
</li>
<li>
<p>The grammar of <code>CMake</code> is much easier to support for external tools than make's.</p>
</li>
<li>
<p>Once <code>make</code> builds an artifact, it forgets how it was built. What sources it was built from, what compiler flags? <code>CMake</code> tracks it, <code>make</code> leaves it up to you. If one of library sources was removed since the previous version of <code>Makefile</code>, <code>make</code> won't rebuild it.</p>
</li>
<li>
<p>Modern <code>CMake</code> (starting with version 3.something) works in terms of dependencies between "targets". A target is still a single output file, but it can have transitive ("public"/"interface" in CMake terms) dependencies. These transitive dependencies can be exposed to or hidden from the dependent packages. <code>CMake</code> will manage directories for you. With <code>make</code>, you're stuck on a file-by-file and manage-directories-by-hand level.</p>
</li>
</ul>
<p>You could code up something in <code>make</code> using intermediate files to cover the
last two gaps, but you're on your own. <code>make</code> does contain a Turing complete
language (even two, sometimes three counting Guile); the first two are
horrible and the Guile is practically never used.</p>
<p>To be honest, this is what <code>CMake</code> and <code>make</code> have in common -- their
languages are pretty horrible. Here's what comes to mind:</p>
<ul>
<li>They have no user-defined types;</li>
<li>
<code>CMake</code> has three data types: string, list, and a target with properties. <code>make</code> has one: string;</li>
<li>you normally pass arguments to functions by setting global variables. <ul>
<li>This is partially dealt with in modern CMake - you can set a target's properties: <code>set_property(TARGET helloworld APPEND PROPERTY INCLUDE_DIRECTORIES "${CMAKE_CURRENT_SOURCE_DIR}")</code>;</li>
</ul>
</li>
<li>referring to an undefined variable is silently ignored by default;</li>
</ul>
</div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/c/" rel="tag">c</a></li>
            <li><a class="tag p-category" href="../../categories/c%2B%2B/" rel="tag">c++</a></li>
            <li><a class="tag p-category" href="../../categories/cmake/" rel="tag">cmake</a></li>
            <li><a class="tag p-category" href="../../categories/makefile/" rel="tag">makefile</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../how-to-find-the-statistical-mode/" rel="prev" title="How to find the statistical mode?">Previous post</a>
            </li>
            <li class="next">
                <a href="../what-is-the-best-way-to-compare-floats-for-almost-equality-in-python/" rel="next" title="What is the best way to compare floats for almost-equality in Python?">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="../../assets/js/search.js"></script>
</body>
</html>
