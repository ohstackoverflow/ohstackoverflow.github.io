<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>How to make an Android Spinner with initial text "Select One"? | StackOverflow Snapshot</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/posts/how-to-make-an-android-spinner-with-initial-text-select-one/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Arya">
<link rel="prev" href="../checking-if-a-variable-is-defined/" title="Checking if a variable is defined?" type="text/html">
<link rel="next" href="../misconf-redis-is-configured-to-save-rdb-snapshots/" title="MISCONF Redis is configured to save RDB snapshots" type="text/html">
<meta property="og:site_name" content="StackOverflow Snapshot">
<meta property="og:title" content='How to make an Android Spinner with initial text "Select One"?'>
<meta property="og:url" content="https://ohstackoverflow.netlify.app/posts/how-to-make-an-android-spinner-with-initial-text-select-one/">
<meta property="og:description" content='I want to use a Spinner that initially (when the user has not made a selection
yet) displays the text "Select One". When the user clicks the spinner, the
list of items is displayed and the user select'>
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-02-18T00:32:38+08:00">
<meta property="article:tag" content="android">
<meta property="article:tag" content="android-spinner">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">How to make an Android Spinner with initial text "Select One"?</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2023-02-18T00:32:38+08:00" itemprop="datePublished" title="2023-02-18 00:32">2023-02-18 00:32</time></a>
            </p>
            

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>I want to use a Spinner that initially (when the user has not made a selection
yet) displays the text "Select One". When the user clicks the spinner, the
list of items is displayed and the user selects one of the options. After the
user has made a selection, the selected item is displayed in the Spinner
instead of "Select One".</p>
<p>I have the following code to create a Spinner:</p>
<div class="code"><pre class="code literal-block">String[] items = new String[] {"One", "Two", "Three"};
Spinner spinner = (Spinner) findViewById(R.id.mySpinner);
ArrayAdapter&lt;String&gt; adapter = new ArrayAdapter&lt;String&gt;(this,
            android.R.layout.simple_spinner_item, items);
adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
spinner.setAdapter(adapter);
</pre></div>

<p>With this code, initially the item "One" is displayed. I could just add a new
item "Select One" to the items, but then "Select One" would also be displayed
in the dropdown list as first item, which is not what I want.</p>
<p>How can I fix this problem?</p>
<p><br><br></p>
<h2>Answer</h2>
<p>Here's a general solution that overrides the <code>Spinner</code> view. It overrides
<code>setAdapter()</code> to set the initial position to -1, and proxies the supplied
<code>SpinnerAdapter</code> to display the prompt string for position less than 0.</p>
<p>This has been tested on Android 1.5 through 4.2, but buyer beware! Because
this solution relies on reflection to call the private
<code>AdapterView.setNextSelectedPositionInt()</code> and
<code>AdapterView.setSelectedPositionInt()</code>, it's not guaranteed to work in future
OS updates. It seems likely that it will, but it is by no means guaranteed.</p>
<p>Normally I wouldn't condone something like this, but this question has been
asked enough times and it seems like a reasonable enough request that I
thought I would post my solution.</p>
<div class="code"><pre class="code literal-block"><span class="o">/**</span>
<span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="n">modified</span><span class="w"> </span><span class="n">Spinner</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">doesn</span><span class="s1">'t automatically select the first entry in the list.</span>
<span class="w"> </span><span class="o">*</span>
<span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Shows</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">prompt</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">nothing</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">selected</span><span class="o">.</span>
<span class="w"> </span><span class="o">*</span>
<span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Limitations</span><span class="p">:</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">display</span><span class="w"> </span><span class="n">prompt</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">empty</span><span class="o">.</span>
<span class="w"> </span><span class="o">*/</span>
<span class="n">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">NoDefaultSpinner</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="n">Spinner</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="n">public</span><span class="w"> </span><span class="n">NoDefaultSpinner</span><span class="p">(</span><span class="n">Context</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">super</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">public</span><span class="w"> </span><span class="n">NoDefaultSpinner</span><span class="p">(</span><span class="n">Context</span><span class="w"> </span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">AttributeSet</span><span class="w"> </span><span class="n">attrs</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">super</span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">attrs</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">public</span><span class="w"> </span><span class="n">NoDefaultSpinner</span><span class="p">(</span><span class="n">Context</span><span class="w"> </span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">AttributeSet</span><span class="w"> </span><span class="n">attrs</span><span class="p">,</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">defStyle</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">super</span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">attrs</span><span class="p">,</span><span class="w"> </span><span class="n">defStyle</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="err">@</span><span class="n">Override</span>
<span class="w">    </span><span class="n">public</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="w"> </span><span class="n">setAdapter</span><span class="p">(</span><span class="n">SpinnerAdapter</span><span class="w"> </span><span class="n">orig</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">final</span><span class="w"> </span><span class="n">SpinnerAdapter</span><span class="w"> </span><span class="n">adapter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newProxy</span><span class="p">(</span><span class="n">orig</span><span class="p">);</span>

<span class="w">        </span><span class="n">super</span><span class="o">.</span><span class="n">setAdapter</span><span class="p">(</span><span class="n">adapter</span><span class="p">);</span>

<span class="w">        </span><span class="n">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">final</span><span class="w"> </span><span class="n">Method</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AdapterView</span><span class="o">.</span><span class="k">class</span><span class="o">.</span><span class="n">getDeclaredMethod</span><span class="p">(</span>
<span class="w">                               </span><span class="s2">"setNextSelectedPositionInt"</span><span class="p">,</span><span class="nb nb-Type">int</span><span class="o">.</span><span class="k">class</span><span class="p">);</span>
<span class="w">            </span><span class="n">m</span><span class="o">.</span><span class="n">setAccessible</span><span class="p">(</span><span class="bp">true</span><span class="p">);</span>
<span class="w">            </span><span class="n">m</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>

<span class="w">            </span><span class="n">final</span><span class="w"> </span><span class="n">Method</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AdapterView</span><span class="o">.</span><span class="k">class</span><span class="o">.</span><span class="n">getDeclaredMethod</span><span class="p">(</span>
<span class="w">                               </span><span class="s2">"setSelectedPositionInt"</span><span class="p">,</span><span class="nb nb-Type">int</span><span class="o">.</span><span class="k">class</span><span class="p">);</span>
<span class="w">            </span><span class="n">n</span><span class="o">.</span><span class="n">setAccessible</span><span class="p">(</span><span class="bp">true</span><span class="p">);</span>
<span class="w">            </span><span class="n">n</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span>
<span class="w">        </span><span class="n">catch</span><span class="p">(</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">throw</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">RuntimeException</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">protected</span><span class="w"> </span><span class="n">SpinnerAdapter</span><span class="w"> </span><span class="n">newProxy</span><span class="p">(</span><span class="n">SpinnerAdapter</span><span class="w"> </span><span class="n">obj</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">SpinnerAdapter</span><span class="p">)</span><span class="w"> </span><span class="n">java</span><span class="o">.</span><span class="n">lang</span><span class="o">.</span><span class="n">reflect</span><span class="o">.</span><span class="n">Proxy</span><span class="o">.</span><span class="n">newProxyInstance</span><span class="p">(</span>
<span class="w">                </span><span class="n">obj</span><span class="o">.</span><span class="n">getClass</span><span class="p">()</span><span class="o">.</span><span class="n">getClassLoader</span><span class="p">(),</span>
<span class="w">                </span><span class="n">new</span><span class="w"> </span><span class="n">Class</span><span class="p">[]{</span><span class="n">SpinnerAdapter</span><span class="o">.</span><span class="k">class</span><span class="p">},</span>
<span class="w">                </span><span class="n">new</span><span class="w"> </span><span class="n">SpinnerAdapterProxy</span><span class="p">(</span><span class="n">obj</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>



<span class="w">    </span><span class="o">/**</span>
<span class="w">     </span><span class="o">*</span><span class="w"> </span><span class="n">Intercepts</span><span class="w"> </span><span class="n">getView</span><span class="p">()</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">display</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">prompt</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">position</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span>
<span class="w">     </span><span class="o">*/</span>
<span class="w">    </span><span class="n">protected</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">SpinnerAdapterProxy</span><span class="w"> </span><span class="n">implements</span><span class="w"> </span><span class="n">InvocationHandler</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="n">protected</span><span class="w"> </span><span class="n">SpinnerAdapter</span><span class="w"> </span><span class="n">obj</span><span class="p">;</span>
<span class="w">        </span><span class="n">protected</span><span class="w"> </span><span class="n">Method</span><span class="w"> </span><span class="n">getView</span><span class="p">;</span>


<span class="w">        </span><span class="n">protected</span><span class="w"> </span><span class="n">SpinnerAdapterProxy</span><span class="p">(</span><span class="n">SpinnerAdapter</span><span class="w"> </span><span class="n">obj</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">this</span><span class="o">.</span><span class="n">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obj</span><span class="p">;</span>
<span class="w">            </span><span class="n">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">this</span><span class="o">.</span><span class="n">getView</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SpinnerAdapter</span><span class="o">.</span><span class="k">class</span><span class="o">.</span><span class="n">getMethod</span><span class="p">(</span>
<span class="w">                                 </span><span class="s2">"getView"</span><span class="p">,</span><span class="nb nb-Type">int</span><span class="o">.</span><span class="k">class</span><span class="p">,</span><span class="n">View</span><span class="o">.</span><span class="k">class</span><span class="p">,</span><span class="n">ViewGroup</span><span class="o">.</span><span class="k">class</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span>
<span class="w">            </span><span class="n">catch</span><span class="p">(</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">throw</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">RuntimeException</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">public</span><span class="w"> </span><span class="nb nb-Type">Object</span><span class="w"> </span><span class="n">invoke</span><span class="p">(</span><span class="nb nb-Type">Object</span><span class="w"> </span><span class="n">proxy</span><span class="p">,</span><span class="w"> </span><span class="n">Method</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="nb nb-Type">Object</span><span class="p">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="n">throws</span><span class="w"> </span><span class="n">Throwable</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">m</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">getView</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>
<span class="w">                       </span><span class="p">(</span><span class="n">Integer</span><span class="p">)(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">&lt;</span><span class="mi">0</span><span class="w"> </span><span class="err">?</span><span class="w"> </span>
<span class="w">                         </span><span class="n">getView</span><span class="p">((</span><span class="n">Integer</span><span class="p">)</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],(</span><span class="n">View</span><span class="p">)</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">],(</span><span class="n">ViewGroup</span><span class="p">)</span><span class="n">args</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"> </span><span class="p">:</span><span class="w"> </span>
<span class="w">                         </span><span class="n">m</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span>
<span class="w">            </span><span class="n">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InvocationTargetException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">throw</span><span class="w"> </span><span class="n">e</span><span class="o">.</span><span class="n">getTargetException</span><span class="p">();</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span>
<span class="w">            </span><span class="n">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">throw</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">RuntimeException</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">protected</span><span class="w"> </span><span class="n">View</span><span class="w"> </span><span class="n">getView</span><span class="p">(</span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">position</span><span class="p">,</span><span class="w"> </span><span class="n">View</span><span class="w"> </span><span class="n">convertView</span><span class="p">,</span><span class="w"> </span><span class="n">ViewGroup</span><span class="w"> </span><span class="n">parent</span><span class="p">)</span><span class="w"> </span>
<span class="w">          </span><span class="n">throws</span><span class="w"> </span><span class="n">IllegalAccessException</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">position</span><span class="o">&lt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">final</span><span class="w"> </span><span class="n">TextView</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<span class="w">                  </span><span class="p">(</span><span class="n">TextView</span><span class="p">)</span><span class="w"> </span><span class="p">((</span><span class="n">LayoutInflater</span><span class="p">)</span><span class="n">getContext</span><span class="p">()</span><span class="o">.</span><span class="n">getSystemService</span><span class="p">(</span>
<span class="w">                    </span><span class="n">Context</span><span class="o">.</span><span class="n">LAYOUT_INFLATER_SERVICE</span><span class="p">))</span><span class="o">.</span><span class="n">inflate</span><span class="p">(</span>
<span class="w">                      </span><span class="n">android</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">simple_spinner_item</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="bp">false</span><span class="p">);</span>
<span class="w">                </span><span class="n">v</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">getPrompt</span><span class="p">());</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">v</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">obj</span><span class="o">.</span><span class="n">getView</span><span class="p">(</span><span class="n">position</span><span class="p">,</span><span class="n">convertView</span><span class="p">,</span><span class="n">parent</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>Here's a general solution that overrides the <code>Spinner</code> view. It overrides
<code>setAdapter()</code> to set the initial position to -1, and proxies the supplied
<code>SpinnerAdapter</code> to display the prompt string for position less than 0.</p>
<p>This has been tested on Android 1.5 through 4.2, but buyer beware! Because
this solution relies on reflection to call the private
<code>AdapterView.setNextSelectedPositionInt()</code> and
<code>AdapterView.setSelectedPositionInt()</code>, it's not guaranteed to work in future
OS updates. It seems likely that it will, but it is by no means guaranteed.</p>
<p>Normally I wouldn't condone something like this, but this question has been
asked enough times and it seems like a reasonable enough request that I
thought I would post my solution.</p>
<div class="code"><pre class="code literal-block"><span class="o">/**</span>
<span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="n">modified</span><span class="w"> </span><span class="n">Spinner</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">doesn</span><span class="s1">'t automatically select the first entry in the list.</span>
<span class="w"> </span><span class="o">*</span>
<span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Shows</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">prompt</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">nothing</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">selected</span><span class="o">.</span>
<span class="w"> </span><span class="o">*</span>
<span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Limitations</span><span class="p">:</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">display</span><span class="w"> </span><span class="n">prompt</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">empty</span><span class="o">.</span>
<span class="w"> </span><span class="o">*/</span>
<span class="n">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">NoDefaultSpinner</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="n">Spinner</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="n">public</span><span class="w"> </span><span class="n">NoDefaultSpinner</span><span class="p">(</span><span class="n">Context</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">super</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">public</span><span class="w"> </span><span class="n">NoDefaultSpinner</span><span class="p">(</span><span class="n">Context</span><span class="w"> </span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">AttributeSet</span><span class="w"> </span><span class="n">attrs</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">super</span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">attrs</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">public</span><span class="w"> </span><span class="n">NoDefaultSpinner</span><span class="p">(</span><span class="n">Context</span><span class="w"> </span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">AttributeSet</span><span class="w"> </span><span class="n">attrs</span><span class="p">,</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">defStyle</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">super</span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">attrs</span><span class="p">,</span><span class="w"> </span><span class="n">defStyle</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="err">@</span><span class="n">Override</span>
<span class="w">    </span><span class="n">public</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="w"> </span><span class="n">setAdapter</span><span class="p">(</span><span class="n">SpinnerAdapter</span><span class="w"> </span><span class="n">orig</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">final</span><span class="w"> </span><span class="n">SpinnerAdapter</span><span class="w"> </span><span class="n">adapter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newProxy</span><span class="p">(</span><span class="n">orig</span><span class="p">);</span>

<span class="w">        </span><span class="n">super</span><span class="o">.</span><span class="n">setAdapter</span><span class="p">(</span><span class="n">adapter</span><span class="p">);</span>

<span class="w">        </span><span class="n">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">final</span><span class="w"> </span><span class="n">Method</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AdapterView</span><span class="o">.</span><span class="k">class</span><span class="o">.</span><span class="n">getDeclaredMethod</span><span class="p">(</span>
<span class="w">                               </span><span class="s2">"setNextSelectedPositionInt"</span><span class="p">,</span><span class="nb nb-Type">int</span><span class="o">.</span><span class="k">class</span><span class="p">);</span>
<span class="w">            </span><span class="n">m</span><span class="o">.</span><span class="n">setAccessible</span><span class="p">(</span><span class="bp">true</span><span class="p">);</span>
<span class="w">            </span><span class="n">m</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>

<span class="w">            </span><span class="n">final</span><span class="w"> </span><span class="n">Method</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AdapterView</span><span class="o">.</span><span class="k">class</span><span class="o">.</span><span class="n">getDeclaredMethod</span><span class="p">(</span>
<span class="w">                               </span><span class="s2">"setSelectedPositionInt"</span><span class="p">,</span><span class="nb nb-Type">int</span><span class="o">.</span><span class="k">class</span><span class="p">);</span>
<span class="w">            </span><span class="n">n</span><span class="o">.</span><span class="n">setAccessible</span><span class="p">(</span><span class="bp">true</span><span class="p">);</span>
<span class="w">            </span><span class="n">n</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span>
<span class="w">        </span><span class="n">catch</span><span class="p">(</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">throw</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">RuntimeException</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">protected</span><span class="w"> </span><span class="n">SpinnerAdapter</span><span class="w"> </span><span class="n">newProxy</span><span class="p">(</span><span class="n">SpinnerAdapter</span><span class="w"> </span><span class="n">obj</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">SpinnerAdapter</span><span class="p">)</span><span class="w"> </span><span class="n">java</span><span class="o">.</span><span class="n">lang</span><span class="o">.</span><span class="n">reflect</span><span class="o">.</span><span class="n">Proxy</span><span class="o">.</span><span class="n">newProxyInstance</span><span class="p">(</span>
<span class="w">                </span><span class="n">obj</span><span class="o">.</span><span class="n">getClass</span><span class="p">()</span><span class="o">.</span><span class="n">getClassLoader</span><span class="p">(),</span>
<span class="w">                </span><span class="n">new</span><span class="w"> </span><span class="n">Class</span><span class="p">[]{</span><span class="n">SpinnerAdapter</span><span class="o">.</span><span class="k">class</span><span class="p">},</span>
<span class="w">                </span><span class="n">new</span><span class="w"> </span><span class="n">SpinnerAdapterProxy</span><span class="p">(</span><span class="n">obj</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>



<span class="w">    </span><span class="o">/**</span>
<span class="w">     </span><span class="o">*</span><span class="w"> </span><span class="n">Intercepts</span><span class="w"> </span><span class="n">getView</span><span class="p">()</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">display</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">prompt</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">position</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span>
<span class="w">     </span><span class="o">*/</span>
<span class="w">    </span><span class="n">protected</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">SpinnerAdapterProxy</span><span class="w"> </span><span class="n">implements</span><span class="w"> </span><span class="n">InvocationHandler</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="n">protected</span><span class="w"> </span><span class="n">SpinnerAdapter</span><span class="w"> </span><span class="n">obj</span><span class="p">;</span>
<span class="w">        </span><span class="n">protected</span><span class="w"> </span><span class="n">Method</span><span class="w"> </span><span class="n">getView</span><span class="p">;</span>


<span class="w">        </span><span class="n">protected</span><span class="w"> </span><span class="n">SpinnerAdapterProxy</span><span class="p">(</span><span class="n">SpinnerAdapter</span><span class="w"> </span><span class="n">obj</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">this</span><span class="o">.</span><span class="n">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obj</span><span class="p">;</span>
<span class="w">            </span><span class="n">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">this</span><span class="o">.</span><span class="n">getView</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SpinnerAdapter</span><span class="o">.</span><span class="k">class</span><span class="o">.</span><span class="n">getMethod</span><span class="p">(</span>
<span class="w">                                 </span><span class="s2">"getView"</span><span class="p">,</span><span class="nb nb-Type">int</span><span class="o">.</span><span class="k">class</span><span class="p">,</span><span class="n">View</span><span class="o">.</span><span class="k">class</span><span class="p">,</span><span class="n">ViewGroup</span><span class="o">.</span><span class="k">class</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span>
<span class="w">            </span><span class="n">catch</span><span class="p">(</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">throw</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">RuntimeException</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">public</span><span class="w"> </span><span class="nb nb-Type">Object</span><span class="w"> </span><span class="n">invoke</span><span class="p">(</span><span class="nb nb-Type">Object</span><span class="w"> </span><span class="n">proxy</span><span class="p">,</span><span class="w"> </span><span class="n">Method</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="nb nb-Type">Object</span><span class="p">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="n">throws</span><span class="w"> </span><span class="n">Throwable</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">m</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">getView</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>
<span class="w">                       </span><span class="p">(</span><span class="n">Integer</span><span class="p">)(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">&lt;</span><span class="mi">0</span><span class="w"> </span><span class="err">?</span><span class="w"> </span>
<span class="w">                         </span><span class="n">getView</span><span class="p">((</span><span class="n">Integer</span><span class="p">)</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],(</span><span class="n">View</span><span class="p">)</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">],(</span><span class="n">ViewGroup</span><span class="p">)</span><span class="n">args</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"> </span><span class="p">:</span><span class="w"> </span>
<span class="w">                         </span><span class="n">m</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span>
<span class="w">            </span><span class="n">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InvocationTargetException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">throw</span><span class="w"> </span><span class="n">e</span><span class="o">.</span><span class="n">getTargetException</span><span class="p">();</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span>
<span class="w">            </span><span class="n">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">throw</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">RuntimeException</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">protected</span><span class="w"> </span><span class="n">View</span><span class="w"> </span><span class="n">getView</span><span class="p">(</span><span class="nb nb-Type">int</span><span class="w"> </span><span class="n">position</span><span class="p">,</span><span class="w"> </span><span class="n">View</span><span class="w"> </span><span class="n">convertView</span><span class="p">,</span><span class="w"> </span><span class="n">ViewGroup</span><span class="w"> </span><span class="n">parent</span><span class="p">)</span><span class="w"> </span>
<span class="w">          </span><span class="n">throws</span><span class="w"> </span><span class="n">IllegalAccessException</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">position</span><span class="o">&lt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">final</span><span class="w"> </span><span class="n">TextView</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<span class="w">                  </span><span class="p">(</span><span class="n">TextView</span><span class="p">)</span><span class="w"> </span><span class="p">((</span><span class="n">LayoutInflater</span><span class="p">)</span><span class="n">getContext</span><span class="p">()</span><span class="o">.</span><span class="n">getSystemService</span><span class="p">(</span>
<span class="w">                    </span><span class="n">Context</span><span class="o">.</span><span class="n">LAYOUT_INFLATER_SERVICE</span><span class="p">))</span><span class="o">.</span><span class="n">inflate</span><span class="p">(</span>
<span class="w">                      </span><span class="n">android</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">simple_spinner_item</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="bp">false</span><span class="p">);</span>
<span class="w">                </span><span class="n">v</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">getPrompt</span><span class="p">());</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">v</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">obj</span><span class="o">.</span><span class="n">getView</span><span class="p">(</span><span class="n">position</span><span class="p">,</span><span class="n">convertView</span><span class="p">,</span><span class="n">parent</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/android/" rel="tag">android</a></li>
            <li><a class="tag p-category" href="../../categories/android-spinner/" rel="tag">android-spinner</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../checking-if-a-variable-is-defined/" rel="prev" title="Checking if a variable is defined?">Previous post</a>
            </li>
            <li class="next">
                <a href="../misconf-redis-is-configured-to-save-rdb-snapshots/" rel="next" title="MISCONF Redis is configured to save RDB snapshots">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="../../assets/js/search.js"></script>
</body>
</html>
