<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>How do I get current date/time on the Windows command line in a suitable format for usage in a file/folder name? | StackOverflow Snapshot</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/posts/how-do-i-get-current-date-time-on-the-windows-command-line-in-a-suitable-format-for-usage-in-a-file-folder-name/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Arya">
<link rel="prev" href="../how-to-check-if-a-dictionary-is-empty/" title="How to check if a dictionary is empty?" type="text/html">
<link rel="next" href="../ngif-and-ngfor-on-same-element-causing-error/" title="*ngIf and *ngFor on same element causing error" type="text/html">
<meta property="og:site_name" content="StackOverflow Snapshot">
<meta property="og:title" content="How do I get current date/time on the Windows command line in a suitab">
<meta property="og:url" content="https://ohstackoverflow.netlify.app/posts/how-do-i-get-current-date-time-on-the-windows-command-line-in-a-suitable-format-for-usage-in-a-file-folder-name/">
<meta property="og:description" content="Update: Now that it's 2016 I'd use PowerShell for this unless there's a really
compelling backwards-compatible reason for it, particularly because of the
regional settings issue with using date. See @">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-02-17T23:16:37+08:00">
<meta property="article:tag" content="batch-file">
<meta property="article:tag" content="cmd">
<meta property="article:tag" content="datetime">
<meta property="article:tag" content="windows">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">How do I get current date/time on the Windows command line in a suitable format for usage in a file/folder name?</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T23:16:37+08:00" itemprop="datePublished" title="2023-02-17 23:16">2023-02-17 23:16</time></a>
            </p>
            

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>Update: Now that it's 2016 I'd use PowerShell for this unless there's a really
compelling backwards-compatible reason for it, particularly because of the
regional settings issue with using <code>date</code>. See @npocmaka's
https://stackoverflow.com/a/19799236/8479</p>
<hr>
<p>What's a Windows command line statement(s) I can use to get the current
datetime in a format that I can put into a filename?</p>
<p>I want to have a .bat file that zips up a directory into an archive with the
current date and time as part of the name, for example,
<code>Code_2008-10-14_2257.zip</code>. Is there any easy way I can do this, independent
of the regional settings of the machine?</p>
<p>I don't really mind about the date format, ideally it'd be yyyy-mm-dd, but
anything simple is fine.</p>
<p>So far I've got this, which on my machine gives me <code>Tue_10_14_2008_230050_91</code>:</p>
<div class="code"><pre class="code literal-block"><span class="n">rem</span><span class="w"> </span><span class="k">Get</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">datetime</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nf">format</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="k">go</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">filename</span><span class="p">.</span>
<span class="k">set</span><span class="w"> </span><span class="n">_my_datetime</span><span class="o">=%</span><span class="nc">date</span><span class="o">%</span><span class="n">_</span><span class="o">%</span><span class="nc">time</span><span class="o">%</span>
<span class="k">set</span><span class="w"> </span><span class="n">_my_datetime</span><span class="o">=%</span><span class="nl">_my_datetime</span><span class="p">:</span><span class="w"> </span><span class="o">=</span><span class="n">_</span><span class="o">%</span>
<span class="k">set</span><span class="w"> </span><span class="n">_my_datetime</span><span class="o">=%</span><span class="nl">_my_datetime</span><span class="p">:</span><span class="err">:</span><span class="o">=%</span>
<span class="k">set</span><span class="w"> </span><span class="n">_my_datetime</span><span class="o">=%</span><span class="nl">_my_datetime</span><span class="p">:</span><span class="o">/=</span><span class="n">_</span><span class="o">%</span>
<span class="k">set</span><span class="w"> </span><span class="n">_my_datetime</span><span class="o">=%</span><span class="nl">_my_datetime</span><span class="p">:.</span><span class="o">=</span><span class="n">_</span><span class="o">%</span>

<span class="n">rem</span><span class="w"> </span><span class="n">Now</span><span class="w"> </span><span class="k">use</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">timestamp</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ZIP</span><span class="w"> </span><span class="k">file</span><span class="w"> </span><span class="n">name</span><span class="p">.</span>
<span class="ss">"d:\Program Files\7-Zip\7z.exe"</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">-</span><span class="n">r</span><span class="w"> </span><span class="n">Code_</span><span class="o">%</span><span class="n">_my_datetime</span><span class="o">%</span><span class="p">.</span><span class="n">zip</span><span class="w"> </span><span class="n">Code</span>
</pre></div>

<p>I can live with this, but it seems a bit clunky. Ideally it'd be briefer and
have the format mentioned earlier.</p>
<p>I'm using Windows Server 2003 and Windows XP Professional. I don't want to
install additional utilities to achieve this (although I realise there are
some that will do nice date formatting).</p>
<p><br><br></p>
<h2>Answer</h2>
<p>See <em>Windows Batch File (.bat) to get current date in MMDDYYYY format</em> :</p>
<div class="code"><pre class="code literal-block"><span class="nv">@echo</span><span class="w"> </span><span class="k">off</span>
<span class="k">For</span><span class="w"> </span><span class="o">/</span><span class="n">f</span><span class="w"> </span><span class="ss">"tokens=2-4 delims=/ "</span><span class="w"> </span><span class="o">%%</span><span class="n">a</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="p">(</span><span class="s1">'date /t'</span><span class="p">)</span><span class="w"> </span><span class="n">do</span><span class="w"> </span><span class="p">(</span><span class="k">set</span><span class="w"> </span><span class="n">mydate</span><span class="o">=%%</span><span class="n">c</span><span class="o">-%%</span><span class="n">a</span><span class="o">-%%</span><span class="n">b</span><span class="p">)</span>
<span class="k">For</span><span class="w"> </span><span class="o">/</span><span class="n">f</span><span class="w"> </span><span class="ss">"tokens=1-2 delims=/:"</span><span class="w"> </span><span class="o">%%</span><span class="n">a</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="p">(</span><span class="s1">'time /t'</span><span class="p">)</span><span class="w"> </span><span class="n">do</span><span class="w"> </span><span class="p">(</span><span class="k">set</span><span class="w"> </span><span class="n">mytime</span><span class="o">=%%</span><span class="n">a</span><span class="o">%%</span><span class="n">b</span><span class="p">)</span>
<span class="n">echo</span><span class="w"> </span><span class="o">%</span><span class="n">mydate</span><span class="o">%</span><span class="n">_</span><span class="o">%</span><span class="n">mytime</span><span class="o">%</span>
</pre></div>

<p>If you prefer the time in 24 hour/military format, you can replace the second
FOR line with this:</p>
<div class="code"><pre class="code literal-block"><span class="k">For</span><span class="w"> </span><span class="o">/</span><span class="nv">f</span><span class="w"> </span><span class="s2">"tokens=1-2 delims=/:"</span><span class="w"> </span><span class="o">%%</span><span class="nv">a</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="ss">(</span><span class="s2">"%TIME%"</span><span class="ss">)</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="ss">(</span><span class="nv">set</span><span class="w"> </span><span class="nv">mytime</span><span class="o">=%%</span><span class="nv">a</span><span class="o">%%</span><span class="nv">b</span><span class="ss">)</span>
</pre></div>

<blockquote>
<p>C:&gt; .\date.bat<br>
 2008-10-14_0642</p>
</blockquote>
<p>If you want the date independently of the region day/month order, you can use
"WMIC os GET LocalDateTime" as a source, since it's in ISO order:</p>
<div class="code"><pre class="code literal-block"><span class="nv">@echo</span><span class="w"> </span><span class="k">off</span>
<span class="k">for</span><span class="w"> </span><span class="o">/</span><span class="n">F</span><span class="w"> </span><span class="ss">"usebackq tokens=1,2 delims=="</span><span class="w"> </span><span class="o">%%</span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="p">(</span><span class="err">`</span><span class="n">wmic</span><span class="w"> </span><span class="n">os</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">LocalDateTime</span><span class="w"> </span><span class="o">/</span><span class="k">VALUE</span><span class="w"> </span><span class="mi">2</span><span class="o">^&gt;</span><span class="n">NUL</span><span class="err">`</span><span class="p">)</span><span class="w"> </span><span class="n">do</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="s1">'.%%i.'</span><span class="o">==</span><span class="s1">'.LocalDateTime.'</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="n">ldt</span><span class="o">=%%</span><span class="n">j</span>
<span class="k">set</span><span class="w"> </span><span class="n">ldt</span><span class="o">=%</span><span class="nl">ldt</span><span class="p">:</span><span class="o">~</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="o">%-%</span><span class="nl">ldt</span><span class="p">:</span><span class="o">~</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="o">%-%</span><span class="nl">ldt</span><span class="p">:</span><span class="o">~</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="o">%</span><span class="w"> </span><span class="o">%</span><span class="nl">ldt</span><span class="p">:</span><span class="o">~</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="o">%</span><span class="err">:</span><span class="o">%</span><span class="nl">ldt</span><span class="p">:</span><span class="o">~</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="o">%</span><span class="err">:</span><span class="o">%</span><span class="nl">ldt</span><span class="p">:</span><span class="o">~</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="o">%</span>
<span class="n">echo</span><span class="w"> </span><span class="k">Local</span><span class="w"> </span><span class="nc">date</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="o">[</span><span class="n">%ldt%</span><span class="o">]</span>
</pre></div>

<blockquote>
<p>C:&gt;test.cmd<br>
 Local date is [2012-06-19 10:23:47.048]</p>
</blockquote>
<p><br></p>
<h3>Suggest</h3>
<p>Two more ways that do not depend on the time settings (both taken from :How
get data/time independent from localization:). And both also get the day of
the week and none of them requires admin permissions!:</p>
<ol>
<li>
<strong>MAKECAB</strong> - will work on EVERY Windows system (fast, but creates a small temp file) (the foxidrive script):<div class="code"><pre class="code literal-block"><span class="nv">@echo</span><span class="w"> </span><span class="k">off</span>
</pre></div>

<p>pushd "%temp%"
makecab /D RptFileName=~.rpt /D InfFileName=~.inf /f nul &gt;nul
for /f "tokens=3-7" %%a in ('find /i "makecab"^&lt;~.rpt') do (
   set "current-date=%%e-%%b-%%c"
   set "current-time=%%d"
   set "weekday=%%a"
)
del ~.*
popd
echo %weekday% %current-date% %current-time%
pause</p>
</li>
</ol>
<p>More information about get-date function.</p>
<ol>
<li>
<p><strong>ROBOCOPY</strong> - it's not native command for Windows XP and Windows Server 2003, but it can be downloaded from microsoft site. But is built-in in everything from Windows Vista and above:</p>
<div class="code"><pre class="code literal-block"><span class="nv">@echo</span><span class="w"> </span><span class="k">off</span>
</pre></div>

<p>setlocal
for /f "skip=8 tokens=2,3,4,5,6,7,8 delims=: " %%D in ('robocopy /l * \ \ /ns /nc /ndl /nfl /np /njh /XF * /XD *') do (
 set "dow=%%D"
 set "month=%%E"
 set "day=%%F"
 set "HH=%%G"
 set "MM=%%H"
 set "SS=%%I"
 set "year=%%J"
)</p>
<p>echo Day of the week: %dow%
echo Day of the month : %day%
echo Month : %month%
echo hour : %HH%
echo minutes : %MM%
echo seconds : %SS%
echo year : %year%
endlocal</p>
</li>
</ol>
<p>And three more ways that uses other Windows script languages. They will give
you more flexibility e.g. you can get week of the year, time in milliseconds
and so on.</p>
<ol>
<li>
<p><strong>JScript/batch</strong> hybrid (need to be saved as <code>.bat</code>). JScript is available on every system form NT and above, as a part of Windows Script Host (though can be disabled through the registry it's a rare case):</p>
<div class="code"><pre class="code literal-block"><span class="p">@</span><span class="k">if</span><span class="w"> </span><span class="p">(@</span><span class="n">X</span><span class="p">)</span><span class="o">==</span><span class="p">(@</span><span class="n">Y</span><span class="p">)</span><span class="w"> </span><span class="k">@end</span><span class="w"> </span><span class="cm">/* ---Harmless hybrid line that begins a JScript comment</span>
</pre></div>

<p>@echo off
cscript //E:JScript //nologo "%~f0"
exit /b 0
<em>------------------------------------------------------------------------------</em>/</p>
<p>function GetCurrentDate() {
        // Today date time which will used to set as default date.
        var todayDate = new Date();
        todayDate = todayDate.getFullYear() + "-" +
                       ("0" + (todayDate.getMonth() + 1)).slice(-2) + "-" +
                       ("0" + todayDate.getDate()).slice(-2) + " " + ("0" + todayDate.getHours()).slice(-2) + ":" +
                       ("0" + todayDate.getMinutes()).slice(-2);</p>
<div class="code"><pre class="code literal-block"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nv">todayDate</span><span class="c1">;</span>
}
</pre></div>

<p>WScript.Echo(GetCurrentDate());</p>
</li>
<li>
<p><strong>VSCRIPT/BATCH</strong> hybrid ( <em>Is it possible to embed and execute VBScript within a batch file without using a temporary file?</em> ) same case as JScript, but hybridization is not so perfect:</p>
<div class="code"><pre class="code literal-block"><span class="nl">:sub</span><span class="w"> </span><span class="nv">echo</span><span class="ss">(</span><span class="nv">str</span><span class="ss">)</span><span class="w"> </span>:<span class="k">end</span><span class="w"> </span><span class="nv">sub</span>
</pre></div>

<p>echo off
'&gt;nul 2&gt;&amp;1|| copy /Y %windir%\System32\doskey.exe %windir%\System32\'.exe &gt;nul
'&amp; echo current date:
'&amp; cscript /nologo /E:vbscript "%~f0"
'&amp; exit /b</p>
<p>'0 = vbGeneralDate - Default. Returns date: mm/dd/yy and time if specified: hh:mm:ss PM/AM.
'1 = vbLongDate - Returns date: weekday, monthname, year
'2 = vbShortDate - Returns date: mm/dd/yy
'3 = vbLongTime - Returns time: hh:mm:ss PM/AM
'4 = vbShortTime - Return time: hh:mm</p>
<p>WScript.echo  Replace(FormatDateTime(Date,1),", ","-")</p>
</li>
<li>
<p><strong>PowerShell</strong> - can be installed on every machine that has .NET - download from Microsoft (v1, v2, v3 (only for Windows 7 and above)). It is installed by default on everything from Windows 7/Windows Server 2008 and above:</p>
<div class="code"><pre class="code literal-block">C:\&gt; powershell get-date -format "{dd-MMM-yyyy HH:mm}"
</pre></div>

</li>
</ol>
<p>To use it from a batch file:</p>
<div class="code"><pre class="code literal-block"><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="o">/</span><span class="n">f</span><span class="w"> </span><span class="ss">"delims="</span><span class="w"> </span><span class="o">%%</span><span class="err">#</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="p">(</span><span class="s1">'powershell get-date -format "{dd-MMM-yyyy HH:mm}"'</span><span class="p">)</span><span class="w"> </span><span class="n">do</span><span class="w"> </span><span class="nv">@set</span><span class="w"> </span><span class="n">_date</span><span class="o">=%%</span><span class="err">#</span>
</pre></div>

<ol>
<li>
<p><strong>Self-compiled jscript.net/batch</strong> (never seen a Windows machine without .NET, so I think this is a pretty portable):</p>
<div class="code"><pre class="code literal-block"><span class="p">@</span><span class="k">if</span><span class="w"> </span><span class="p">(@</span><span class="n">X</span><span class="p">)</span><span class="o">==</span><span class="p">(@</span><span class="n">Y</span><span class="p">)</span><span class="w"> </span><span class="k">@end</span><span class="w"> </span><span class="cm">/****** silent line that start JScript comment ******</span>
</pre></div>

<p>@echo off
::::::::::::::::::::::::::::::::::::
:::       Compile the script    ::::
::::::::::::::::::::::::::::::::::::
setlocal
if exist "%~n0.exe" goto :skip_compilation</p>
<p>set "frm=%SystemRoot%\Microsoft.NET\Framework\"</p>
<p>:: Searching the latest installed .NET framework
for /f "tokens=<em> delims=" %%v in ('dir /b /s /a:d /o:-n "%SystemRoot%\Microsoft.NET\Framework\v</em>"') do (
    if exist "%%v\jsc.exe" (
        rem :: the javascript.net compiler
        set "jsc=%%~dpsnfxv\jsc.exe"
        goto :break_loop
    )
)
echo jsc.exe not found &amp;&amp; exit /b 0
:break_loop</p>
<p>call %jsc% /nologo /out:"%~n0.exe" "%~dpsfnx0"
::::::::::::::::::::::::::::::::::::
:::       End of compilation    ::::
::::::::::::::::::::::::::::::::::::
:skip_compilation</p>
<p>"%~n0.exe"</p>
<p>exit /b 0</p>
<p><strong><em>*</em>* End of JScript comment </strong>****/
import System;
import System.IO;</p>
<p>var dt=DateTime.Now;
Console.WriteLine(dt.ToString("yyyy-MM-dd hh:mm:ss"));</p>
</li>
<li>
<p><strong>Logman</strong> This cannot get the year and day of the week. It's comparatively slow and also creates a temporary file and is based on the time stamps that logman puts on its log files. It will work on everything from Windows XP and above. It probably will be never used by anybody - including me - but is one more way...</p>
<div class="code"><pre class="code literal-block"><span class="nv">@echo</span><span class="w"> </span><span class="k">off</span>
</pre></div>

<p>setlocal
del /q /f %temp%\timestampfile_*</p>
<p>Logman.exe stop ts-CPU 1&gt;nul 2&gt;&amp;1
Logman.exe delete ts-CPU 1&gt;nul 2&gt;&amp;1</p>
<p>Logman.exe create counter ts-CPU  -sc 2 -v mmddhhmm -max 250 -c "\Processor(<em>Total)\%% Processor Time" -o %temp%\timestampfile</em> &gt;nul
Logman.exe start ts-CPU 1&gt;nul 2&gt;&amp;1</p>
<p>Logman.exe stop ts-CPU &gt;nul 2&gt;&amp;1
Logman.exe delete ts-CPU &gt;nul 2&gt;&amp;1
for /f "tokens=2 delims=<em>." %%t in  ('dir /b %temp%\timestampfile</em><em>^&amp;del /q/f %temp%\timestampfile_</em>') do set timestamp=%%t</p>
<p>echo %timestamp%
echo MM: %timestamp:~0,2%
echo dd: %timestamp:~2,2%
echo hh: %timestamp:~4,2%
echo mm: %timestamp:~6,2%</p>
<p>endlocal
exit /b 0</p>
</li>
<li>
<p>One more way with <strong>WMIC</strong> which also gives week of the year and the day of the week, but not the milliseconds (for milliseconds check foxidrive's answer):</p>
<div class="code"><pre class="code literal-block"><span class="k">for</span><span class="w"> </span><span class="o">/</span><span class="n">f</span><span class="w"> </span><span class="o">%%</span><span class="err">#</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="p">(</span><span class="s1">'wMIC Path Win32_LocalTime Get /Format:value'</span><span class="p">)</span><span class="w"> </span><span class="n">do</span><span class="w"> </span><span class="nv">@for</span><span class="w"> </span><span class="o">/</span><span class="n">f</span><span class="w"> </span><span class="o">%%</span><span class="err">@</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="p">(</span><span class="ss">"%%#"</span><span class="p">)</span><span class="w"> </span><span class="n">do</span><span class="w"> </span><span class="nv">@set</span><span class="w"> </span><span class="o">%%</span><span class="err">@</span>
</pre></div>

<p>echo %day%
echo %DayOfWeek%
echo %hour%
echo %minute%
echo %month%
echo %quarter%
echo %second%
echo %weekinmonth%
echo %year%</p>
</li>
<li>
<p>Using <strong>TYPEPERF</strong> with some efforts to be fast and compatible with different language settings and as fast as possible:</p>
<div class="code"><pre class="code literal-block"><span class="nv">@echo</span><span class="w"> </span><span class="k">off</span>
</pre></div>

<p>setlocal</p>
<p>:: Check if Windows is Windows XP and use Windows XP valid counter for UDP performance
::if defined USERDOMAIN_roamingprofile (set "v=v4") else (set "v=")</p>
<p>for /f "tokens=4 delims=. " %%# in ('ver') do if %%# GTR 5 (set "v=v4") else ("v=")
set "mon="
for /f "skip=2 delims=," %%# in ('typeperf "\UDP%v%*" -si 0 -sc 1') do (
   if not defined mon (
      for /f "tokens=1-7 delims=.:/ " %%a in (%%#) do (
        set mon=%%a
        set date=%%b
        set year=%%c
        set hour=%%d
        set minute=%%e
        set sec=%%f
        set ms=%%g
      )
   )
)
echo %year%.%mon%.%date%
echo %hour%:%minute%:%sec%.%ms%
endlocal</p>
</li>
<li>
<p><strong>MSHTA</strong> allows calling JavaScript methods similar to the JScript method demonstrated in #3 above. Bear in mind that JavaScript's Date object properties involving month values are numbered from 0 to 11, not 1 to 12. So a value of 9 means October.</p>
<div class="code"><pre class="code literal-block">&lt;!-- : Batch portion
</pre></div>

<p>@echo off
setlocal</p>
<p>for /f "delims=" %%I in ('mshta "%~f0"') do set "now.%%~I"</p>
<p>rem Display all variables beginning with "now."
set now.</p>
<p>goto :EOF</p>
<p>end batch / begin HTA --&gt;</p>
<p><script>
    resizeTo(0,0)
    var fso = new ActiveXObject('Scripting.FileSystemObject').GetStandardStream(1),
        now = new Date(),
        props=['getDate','getDay','getFullYear','getHours','getMilliseconds','getMinutes',
            'getMonth','getSeconds','getTime','getTimezoneOffset','getUTCDate','getUTCDay',
            'getUTCFullYear','getUTCHours','getUTCMilliseconds','getUTCMinutes','getUTCMonth',
            'getUTCSeconds','getYear','toDateString','toGMTString','toLocaleDateString',
            'toLocaleTimeString','toString','toTimeString','toUTCString','valueOf'],
        output = [];</p>
<div class="code"><pre class="code literal-block"><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nf">var</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">props</span><span class="p">)</span><span class="w"> </span><span class="err">{</span><span class="k">output</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">props</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;()=&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">now</span><span class="o">[</span><span class="n">props[i</span><span class="o">]</span><span class="err">]</span><span class="p">())</span><span class="err">}</span>
<span class="k">close</span><span class="p">(</span><span class="n">fso</span><span class="p">.</span><span class="k">Write</span><span class="p">(</span><span class="k">output</span><span class="p">.</span><span class="k">join</span><span class="p">(</span><span class="s1">&#39;\n&#39;</span><span class="p">)));</span>
</pre></div>

</script></p>
</li>
</ol>
</div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/batch-file/" rel="tag">batch-file</a></li>
            <li><a class="tag p-category" href="../../categories/cmd/" rel="tag">cmd</a></li>
            <li><a class="tag p-category" href="../../categories/datetime/" rel="tag">datetime</a></li>
            <li><a class="tag p-category" href="../../categories/windows/" rel="tag">windows</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../how-to-check-if-a-dictionary-is-empty/" rel="prev" title="How to check if a dictionary is empty?">Previous post</a>
            </li>
            <li class="next">
                <a href="../ngif-and-ngfor-on-same-element-causing-error/" rel="next" title="*ngIf and *ngFor on same element causing error">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="../../assets/js/search.js"></script>
</body>
</html>
