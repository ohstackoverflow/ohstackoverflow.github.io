<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Git error: "Host Key Verification Failed" when connecting to remote repository | StackOverflow Snapshot</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/posts/git-error-host-key-verification-failed-when-connecting-to-remote-repository/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Arya">
<link rel="prev" href="../mac-os-x-and-multiple-java-versions/" title="Mac OS X and multiple Java versions" type="text/html">
<link rel="next" href="../alternate-output-format-for-psql-showing-one-column-per-line-with-column-name/" title="Alternate output format for psql showing one column per line with column name" type="text/html">
<meta property="og:site_name" content="StackOverflow Snapshot">
<meta property="og:title" content='Git error: "Host Key Verification Failed" when connecting to remote re'>
<meta property="og:url" content="https://ohstackoverflow.netlify.app/posts/git-error-host-key-verification-failed-when-connecting-to-remote-repository/">
<meta property="og:description" content="I am trying to connect to a remote Git repository that resides on my web
server and clone it to my machine.
I am using the following format for my command:
git clone ssh://username@domain.example/repo">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-03-03T12:19:52+08:00">
<meta property="article:tag" content="git">
<meta property="article:tag" content="ssh">
<meta property="article:tag" content="ssh-keys">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Git error: "Host Key Verification Failed" when connecting to remote repository</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T12:19:52+08:00" itemprop="datePublished" title="2023-03-03 12:19">2023-03-03 12:19</time></a>
            </p>
            

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>I am trying to connect to a remote Git repository that resides on my web
server and clone it to my machine.</p>
<p>I am using the following format for my command:</p>
<div class="code"><pre class="code literal-block"><span class="n">git</span><span class="w"> </span><span class="n">clone</span><span class="w"> </span><span class="nl">ssh</span><span class="p">:</span><span class="o">//</span><span class="n">username</span><span class="nv">@domain</span><span class="p">.</span><span class="n">example</span><span class="o">/</span><span class="n">repository</span><span class="p">.</span><span class="n">git</span>
</pre></div>

<p>This has worked fine for most of my team members. Usually after running this
command Git will prompt for the user's password, and then run the cloning.
However, when running on one of my machines I get the following error:</p>
<blockquote>
<p>Host key verification failed.</p>
<p>fatal: Could not read from remote repository.</p>
</blockquote>
<p>We are not using SSH keys to connect to this repository, so I'm not sure why
Git is checking for one on this particular machine.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>You are connecting via the SSH protocol, as indicated by the <code>ssh://</code> prefix
on your clone URL. Using SSH, every host has a key. Clients remember the host
key associated with a particular address and refuse to connect if a host key
appears to change. This prevents man in the middle attacks.</p>
<p>The host key for <code>domain.example</code> has changed. <strong>If this does not seem fishy
to you</strong> , remove the old key from your local cache by editing
<code>${HOME}/.ssh/known_hosts</code> to remove the line for <code>domain.example</code> or letting
an SSH utility do it for you with</p>
<div class="code"><pre class="code literal-block">ssh-keygen -R domain.example
</pre></div>

<p>From here, record the updated key either by doing it yourself with</p>
<div class="code"><pre class="code literal-block">ssh-keyscan -t rsa domain.example &gt;&gt; ~/.ssh/known_hosts
</pre></div>

<p>or, equivalently, let <code>ssh</code> do it for you next time you connect with <code>git
fetch</code>, <code>git pull</code>, or <code>git push</code> (or even a plain ol’ <code>ssh domain.example</code>)
by answering yes when prompted</p>
<div class="code"><pre class="code literal-block"><span class="nv">The</span><span class="w"> </span><span class="nv">authenticity</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">host</span><span class="w"> </span><span class="s1">'domain.example (a.b.c.d)'</span><span class="w"> </span><span class="nv">can</span><span class="err">'t be established.</span>
<span class="err">RSA key fingerprint is XX:XX:...:XX.</span>
<span class="err">Are you sure you want to continue connecting (yes/no)?</span>
</pre></div>

<p>The reason for this prompt is <code>domain.example</code> is no longer in your
<code>known_hosts</code> after deleting it and presumably not in the system’s
<code>/etc/ssh/ssh_known_hosts</code>, so <code>ssh</code> has no way to know whether the host on
the other end of the connection is really <code>domain.example</code>. (If the wrong key
is in <code>/etc</code>, someone with administrative privileges will have to update the
system-wide file.)</p>
<p>I strongly encourage you to consider having users authenticate with keys as
well. That way, <code>ssh-agent</code> can store key material for convenience (rather
than everyone having to enter her password for each connection to the server),
and passwords do not go over the network.</p>
<p><br></p>
<h3>Suggest</h3>
<p>You are connecting via the SSH protocol, as indicated by the <code>ssh://</code> prefix
on your clone URL. Using SSH, every host has a key. Clients remember the host
key associated with a particular address and refuse to connect if a host key
appears to change. This prevents man in the middle attacks.</p>
<p>The host key for <code>domain.example</code> has changed. <strong>If this does not seem fishy
to you</strong> , remove the old key from your local cache by editing
<code>${HOME}/.ssh/known_hosts</code> to remove the line for <code>domain.example</code> or letting
an SSH utility do it for you with</p>
<div class="code"><pre class="code literal-block">ssh-keygen -R domain.example
</pre></div>

<p>From here, record the updated key either by doing it yourself with</p>
<div class="code"><pre class="code literal-block">ssh-keyscan -t rsa domain.example &gt;&gt; ~/.ssh/known_hosts
</pre></div>

<p>or, equivalently, let <code>ssh</code> do it for you next time you connect with <code>git
fetch</code>, <code>git pull</code>, or <code>git push</code> (or even a plain ol’ <code>ssh domain.example</code>)
by answering yes when prompted</p>
<div class="code"><pre class="code literal-block"><span class="nv">The</span><span class="w"> </span><span class="nv">authenticity</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">host</span><span class="w"> </span><span class="s1">'domain.example (a.b.c.d)'</span><span class="w"> </span><span class="nv">can</span><span class="err">'t be established.</span>
<span class="err">RSA key fingerprint is XX:XX:...:XX.</span>
<span class="err">Are you sure you want to continue connecting (yes/no)?</span>
</pre></div>

<p>The reason for this prompt is <code>domain.example</code> is no longer in your
<code>known_hosts</code> after deleting it and presumably not in the system’s
<code>/etc/ssh/ssh_known_hosts</code>, so <code>ssh</code> has no way to know whether the host on
the other end of the connection is really <code>domain.example</code>. (If the wrong key
is in <code>/etc</code>, someone with administrative privileges will have to update the
system-wide file.)</p>
<p>I strongly encourage you to consider having users authenticate with keys as
well. That way, <code>ssh-agent</code> can store key material for convenience (rather
than everyone having to enter her password for each connection to the server),
and passwords do not go over the network.</p>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/git/" rel="tag">git</a></li>
            <li><a class="tag p-category" href="../../categories/ssh/" rel="tag">ssh</a></li>
            <li><a class="tag p-category" href="../../categories/ssh-keys/" rel="tag">ssh-keys</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../mac-os-x-and-multiple-java-versions/" rel="prev" title="Mac OS X and multiple Java versions">Previous post</a>
            </li>
            <li class="next">
                <a href="../alternate-output-format-for-psql-showing-one-column-per-line-with-column-name/" rel="next" title="Alternate output format for psql showing one column per line with column name">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="../../assets/js/search.js"></script>
</body>
</html>
