<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Response to preflight request doesn't pass access control check | StackOverflow Snapshot</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/posts/response-to-preflight-request-doesn-t-pass-access-control-check/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Arya">
<link rel="prev" href="../are-the-days-of-passing-const-std-string-as-a-parameter-over/" title="Are the days of passing const std::string &amp; as a parameter over?" type="text/html">
<link rel="next" href="../how-to-extract-numbers-from-a-string-in-python/" title="How to extract numbers from a string in Python?" type="text/html">
<meta property="og:site_name" content="StackOverflow Snapshot">
<meta property="og:title" content="Response to preflight request doesn't pass access control check">
<meta property="og:url" content="https://ohstackoverflow.netlify.app/posts/response-to-preflight-request-doesn-t-pass-access-control-check/">
<meta property="og:description" content="I'm getting this error using ngResource to call a REST API on Amazon Web
Services:

XMLHttpRequest cannot load
http://server.apiurl.com:8000/s/login?login=facebook. Response to preflight
request doesn">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-02-17T19:03:31+08:00">
<meta property="article:tag" content="ajax">
<meta property="article:tag" content="cors">
<meta property="article:tag" content="http">
<meta property="article:tag" content="http-status-code-405">
<meta property="article:tag" content="javascript">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Response to preflight request doesn't pass access control check</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T19:03:31+08:00" itemprop="datePublished" title="2023-02-17 19:03">2023-02-17 19:03</time></a>
            </p>
            

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>I'm getting this error using ngResource to call a REST API on Amazon Web
Services:</p>
<blockquote>
<p>XMLHttpRequest cannot load
http://server.apiurl.com:8000/s/login?login=facebook. Response to preflight
request doesn't pass access control check: No 'Access-Control-Allow-Origin'
header is present on the requested resource. Origin 'http://localhost' is
therefore not allowed access. <em>Error 405</em></p>
</blockquote>
<p>Service:</p>
<div class="code"><pre class="code literal-block"><span class="n">socialMarkt</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="s1">'loginService'</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="s1">'$resource'</span><span class="p">,</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="p">(</span><span class="o">$</span><span class="n">resource</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">apiAddress</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"http://server.apiurl.com:8000/s/login/"</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">$</span><span class="n">resource</span><span class="p">(</span><span class="n">apiAddress</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">login</span><span class="p">:</span><span class="w"> </span><span class="s2">"facebook"</span><span class="p">,</span>
<span class="w">        </span><span class="n">access_token</span><span class="p">:</span><span class="w"> </span><span class="s2">"@access_token"</span><span class="p">,</span>
<span class="w">        </span><span class="n">facebook_id</span><span class="p">:</span><span class="w"> </span><span class="s2">"@facebook_id"</span>
<span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">getUser</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">method</span><span class="p">:</span><span class="w"> </span><span class="s1">'POST'</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">});</span>
<span class="p">}]);</span>
</pre></div>

<p>Controller:</p>
<div class="code"><pre class="code literal-block"><span class="k">[...]</span>
<span class="na">loginService.getUser(JSON.stringify(fbObj)),</span>
<span class="w">    </span><span class="na">function (data) {</span>
<span class="w">        </span><span class="na">console.log(data);</span>
<span class="w">    </span><span class="na">},</span>
<span class="w">    </span><span class="na">function (result) {</span>
<span class="w">        </span><span class="na">console.error('Error', result.status);</span>
<span class="w">    </span><span class="na">}</span>
<span class="k">[...]</span>
</pre></div>

<p>I'm using Chrome. What else can I do in order to fix this problem?</p>
<p>I've even configured the server to accept headers from origin <code>localhost</code>.</p>
<p><br><br></p>
<h2>Answer</h2>
<p>You are running into CORS issues.</p>
<p>There are several ways to fix or workaround this.</p>
<ol>
<li>Turn off CORS. For example: How to turn off CORS in Chrome</li>
<li>Use a plugin for your browser</li>
<li>Use a proxy, such as nginx. Example of how to set up</li>
<li>Go through the necessary setup for your server. This is more a factor of the web server you have loaded on your EC2 instance (presuming this is what you mean by "Amazon web service"). For your specific server, you can refer to the enable CORS website.</li>
</ol>
<p>More verbosely, you are trying to access <em>api.serverurl.com</em> from localhost.
This is the exact definition of a cross-domain request.</p>
<p>By either turning it off just to get your work done (OK, but poor security for
you if you visit other sites and just kicks the can down the road) or you can
use a proxy which makes your browser think all requests come from the local
host when really you have a local server that then calls the remote server.</p>
<p>So <em>api.serverurl.com</em> might become <em>localhost:8000/api</em> , and your local
nginx or other proxy will send to the correct destination.</p>
<hr>
<p>Now by popular demand, 100% more CORS information—the same great taste!</p>
<hr>
<p>Bypassing CORS is exactly what is shown for those simply learning the front
end. <em>HTTP Example with Promises</em></p>
<p><br></p>
<h3>Suggest</h3>
<p>My "API Server" is a PHP application, so to solve this problem I found the
below solution to work:</p>
<p>Place these lines in file <em>index.php</em> :</p>
<div class="code"><pre class="code literal-block"><span class="nt">header</span><span class="o">(</span><span class="s1">'Access-Control-Allow-Origin: *'</span><span class="o">);</span>
<span class="nt">header</span><span class="o">(</span><span class="s1">'Access-Control-Allow-Methods: GET, POST, PATCH, PUT, DELETE, OPTIONS'</span><span class="o">);</span>
<span class="nt">header</span><span class="o">(</span><span class="s1">'Access-Control-Allow-Headers: Origin, Content-Type, X-Auth-Token'</span><span class="o">);</span>
</pre></div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/ajax/" rel="tag">ajax</a></li>
            <li><a class="tag p-category" href="../../categories/cors/" rel="tag">cors</a></li>
            <li><a class="tag p-category" href="../../categories/http/" rel="tag">http</a></li>
            <li><a class="tag p-category" href="../../categories/http-status-code-405/" rel="tag">http-status-code-405</a></li>
            <li><a class="tag p-category" href="../../categories/javascript/" rel="tag">javascript</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../are-the-days-of-passing-const-std-string-as-a-parameter-over/" rel="prev" title="Are the days of passing const std::string &amp; as a parameter over?">Previous post</a>
            </li>
            <li class="next">
                <a href="../how-to-extract-numbers-from-a-string-in-python/" rel="next" title="How to extract numbers from a string in Python?">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="../../assets/js/search.js"></script>
</body>
</html>
