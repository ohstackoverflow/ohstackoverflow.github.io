<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>When are you supposed to use escape instead of encodeURI / encodeURIComponent? | StackOverflow Snapshot</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/posts/when-are-you-supposed-to-use-escape-instead-of-encodeuri-encodeuricomponent/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Arya">
<link rel="prev" href="../merge-flatten-an-array-of-arrays/" title="Merge/flatten an array of arrays" type="text/html">
<link rel="next" href="../passing-data-between-view-controllers/" title="Passing data between view controllers" type="text/html">
<meta property="og:site_name" content="StackOverflow Snapshot">
<meta property="og:title" content="When are you supposed to use escape instead of encodeURI / encodeURICo">
<meta property="og:url" content="https://ohstackoverflow.netlify.app/posts/when-are-you-supposed-to-use-escape-instead-of-encodeuri-encodeuricomponent/">
<meta property="og:description" content='When encoding a query string to be sent to a web server - when do you use
escape() and when do you use encodeURI() or encodeURIComponent():
Use escape:
escape("% +&amp;=");


OR
use encodeURI() / encodeUR'>
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-02-17T01:55:48+08:00">
<meta property="article:tag" content="encoding">
<meta property="article:tag" content="javascript">
<meta property="article:tag" content="query-string">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">When are you supposed to use escape instead of encodeURI / encodeURIComponent?</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T01:55:48+08:00" itemprop="datePublished" title="2023-02-17 01:55">2023-02-17 01:55</time></a>
            </p>
            

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>When encoding a query string to be sent to a web server - when do you use
<code>escape()</code> and when do you use <code>encodeURI()</code> or <code>encodeURIComponent()</code>:</p>
<p>Use escape:</p>
<div class="code"><pre class="code literal-block">escape("% +&amp;=");
</pre></div>

<p>OR</p>
<p>use encodeURI() / encodeURIComponent()</p>
<div class="code"><pre class="code literal-block"><span class="n">encodeURI</span><span class="p">(</span><span class="s2">"http://www.google.com?var1=value1&amp;var2=value2"</span><span class="p">);</span>

<span class="n">encodeURIComponent</span><span class="p">(</span><span class="s2">"var1=value1&amp;var2=value2"</span><span class="p">);</span>
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<h2>escape()</h2>
<p>Don't use it! <code>escape()</code> is defined in section B.2.1.1 escape and the
introduction text of Annex B says:</p>
<blockquote>
<p>... All of the language features and behaviours specified in this annex have
one or more undesirable characteristics and in the absence of legacy usage
would be removed from this specification. ...<br>
 ... Programmers should not use or assume the existence of these features
and behaviours when writing new ECMAScript code....</p>
</blockquote>
<p>Behaviour:</p>
<p>https://developer.mozilla.org/en-
US/docs/Web/JavaScript/Reference/Global_Objects/escape</p>
<p>Special characters are encoded with the exception of: @*_+-./</p>
<p>The hexadecimal form for characters, whose code unit value is 0xFF or less, is
a two-digit escape sequence: <code>%xx</code>.</p>
<p>For characters with a greater code unit, the four-digit format <code>%uxxxx</code> is
used. This is not allowed within a query string (as defined in RFC3986):</p>
<div class="code"><pre class="code literal-block"><span class="n">query</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="w"> </span><span class="n">pchar</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s">"/"</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s">"?"</span><span class="w"> </span><span class="p">)</span>
<span class="n">pchar</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="n">unreserved</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">pct</span><span class="o">-</span><span class="n">encoded</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">sub</span><span class="o">-</span><span class="n">delims</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s">":"</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s">"@"</span>
<span class="n">unreserved</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">ALPHA</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">DIGIT</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s">"-"</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s">"."</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s">"_"</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s">"~"</span>
<span class="n">pct</span><span class="o">-</span><span class="n">encoded</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="s">"%"</span><span class="w"> </span><span class="n">HEXDIG</span><span class="w"> </span><span class="n">HEXDIG</span>
<span class="n">sub</span><span class="o">-</span><span class="n">delims</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="s">"!"</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s">"$"</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s">"&amp;"</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s">"'"</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s">"("</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s">")"</span>
<span class="w">              </span><span class="o">/</span><span class="w"> </span><span class="s">"*"</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s">"+"</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s">","</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s">";"</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s">"="</span>
</pre></div>

<p>A percent sign is only allowed if it is directly followed by two hexdigits,
percent followed by <code>u</code> is not allowed.</p>
<h2>encodeURI()</h2>
<p>Use encodeURI when you want a working URL. Make this call:</p>
<div class="code"><pre class="code literal-block">encodeURI("http://www.example.org/a file with spaces.html")
</pre></div>

<p>to get:</p>
<div class="code"><pre class="code literal-block">http://www.example.org/a%20file%20with%20spaces.html
</pre></div>

<p>Don't call encodeURIComponent since it would destroy the URL and return</p>
<div class="code"><pre class="code literal-block">http%3A%2F%2Fwww.example.org%2Fa%20file%20with%20spaces.html
</pre></div>

<p>Note that encodeURI, like encodeURIComponent, does not escape the ' character.</p>
<h2>encodeURIComponent()</h2>
<p>Use encodeURIComponent when you want to encode the value of a URL parameter.</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">p1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">encodeURIComponent</span><span class="p">(</span><span class="s2">"http://example.org/?a=12&amp;b=55"</span><span class="p">)</span>
</pre></div>

<p>Then you may create the URL you need:</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"http://example.net/?param1="</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">"&amp;param2=99"</span><span class="p">;</span>
</pre></div>

<p>And you will get this complete URL:</p>
<p><code>http://example.net/?param1=http%3A%2F%2Fexample.org%2F%Ffa%3D12%26b%3D55&amp;param2=99</code></p>
<p>Note that encodeURIComponent does not escape the <code>'</code> character. A common bug
is to use it to create html attributes such as <code>href='MyUrl'</code>, which could
suffer an injection bug. If you are constructing html from strings, either use
<code>"</code> instead of <code>'</code> for attribute quotes, or add an extra layer of encoding
(<code>'</code> can be encoded as %27).</p>
<p>For more information on this type of encoding you can check:
http://en.wikipedia.org/wiki/Percent-encoding</p>
<p><br></p>
<h3>Suggest</h3>
<p>The difference between <code>encodeURI()</code> and <code>encodeURIComponent()</code> are exactly 11
characters encoded by encodeURIComponent but not by encodeURI:</p>
<p><img alt="Table with the ten differences between encodeURI and
encodeURIComponent" src="https://i.imgur.com/rHWC1r1.png"></p>
<p>I generated this table easily with <strong>console.table</strong> in Google Chrome with
this code:</p>
<div class="code"><pre class="code literal-block"><span class="k">var</span><span class="w"> </span><span class="n">arr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
<span class="k">for</span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">256</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">var</span><span class="w"> </span><span class="nb">char</span><span class="o">=</span><span class="nb nb-Type">String</span><span class="o">.</span><span class="n">fromCharCode</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="p">(</span><span class="n">encodeURI</span><span class="p">(</span><span class="nb">char</span><span class="p">)</span><span class="o">!==</span><span class="n">encodeURIComponent</span><span class="p">(</span><span class="nb">char</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">arr</span><span class="o">.</span><span class="n">push</span><span class="p">({</span>
<span class="w">      </span><span class="n">character</span><span class="p">:</span><span class="nb">char</span><span class="p">,</span>
<span class="w">      </span><span class="n">encodeURI</span><span class="p">:</span><span class="n">encodeURI</span><span class="p">(</span><span class="nb">char</span><span class="p">),</span>
<span class="w">      </span><span class="n">encodeURIComponent</span><span class="p">:</span><span class="n">encodeURIComponent</span><span class="p">(</span><span class="nb">char</span><span class="p">)</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
<span class="n">console</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">arr</span><span class="p">);</span>
</pre></div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/encoding/" rel="tag">encoding</a></li>
            <li><a class="tag p-category" href="../../categories/javascript/" rel="tag">javascript</a></li>
            <li><a class="tag p-category" href="../../categories/query-string/" rel="tag">query-string</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../merge-flatten-an-array-of-arrays/" rel="prev" title="Merge/flatten an array of arrays">Previous post</a>
            </li>
            <li class="next">
                <a href="../passing-data-between-view-controllers/" rel="next" title="Passing data between view controllers">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="../../assets/js/search.js"></script>
</body>
</html>
