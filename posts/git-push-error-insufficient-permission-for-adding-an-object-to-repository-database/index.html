<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Git Push Error: insufficient permission for adding an object to repository database | StackOverflow Snapshot</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/posts/git-push-error-insufficient-permission-for-adding-an-object-to-repository-database/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Arya">
<link rel="prev" href="../getting-started-with-haskell/" title="Getting started with Haskell" type="text/html">
<link rel="next" href="../using-linq-to-remove-elements-from-a-list-t/" title="Using LINQ to remove elements from a List&lt;T&gt;" type="text/html">
<meta property="og:site_name" content="StackOverflow Snapshot">
<meta property="og:title" content="Git Push Error: insufficient permission for adding an object to reposi">
<meta property="og:url" content="https://ohstackoverflow.netlify.app/posts/git-push-error-insufficient-permission-for-adding-an-object-to-repository-database/">
<meta property="og:description" content="When I try to push to a shared git remote, I get the following error:
insufficient permission for adding an object to repository database
Then I read about a fix here: Fix This worked for the next pus">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-02-17T15:14:07+08:00">
<meta property="article:tag" content="git">
<meta property="article:tag" content="push">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Git Push Error: insufficient permission for adding an object to repository database</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T15:14:07+08:00" itemprop="datePublished" title="2023-02-17 15:14">2023-02-17 15:14</time></a>
            </p>
            

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>When I try to push to a shared git remote, I get the following error:
<code>insufficient permission for adding an object to repository database</code></p>
<p>Then I read about a fix here: Fix This worked for the next push, since all of
the files were of the correct group, but the next time someone pushed up a
change it made a new item in the objects folder that had their default group
as the group. The only thing I can think of is to change all of the
developer's default group for items they check in, but that seems like a hack.
Any ideas? Thanks.</p>
<p><br><br></p>
<h2>Answer</h2>
<h3>Repair Permissions</h3>
<p>After you have identified and fixed the underlying cause (see below), you'll
want to repair the permissions:</p>
<div class="code"><pre class="code literal-block"><span class="nv">cd</span><span class="w"> </span><span class="o">/</span><span class="nv">path</span><span class="o">/</span><span class="nv">to</span><span class="o">/</span><span class="nv">repo</span><span class="o">/</span>.<span class="nv">git</span>
<span class="nv">sudo</span><span class="w"> </span><span class="nv">chgrp</span><span class="w"> </span><span class="o">-</span><span class="nv">R</span><span class="w"> </span><span class="nv">groupname</span><span class="w"> </span>.
<span class="nv">sudo</span><span class="w"> </span><span class="nv">chmod</span><span class="w"> </span><span class="o">-</span><span class="nv">R</span><span class="w"> </span><span class="nv">g</span><span class="o">+</span><span class="nv">rwX</span><span class="w"> </span>.
<span class="nv">sudo</span><span class="w"> </span><span class="nv">find</span><span class="w"> </span>.<span class="w"> </span><span class="o">-</span><span class="nv">type</span><span class="w"> </span><span class="nv">d</span><span class="w"> </span><span class="o">-</span><span class="k">exec</span><span class="w"> </span><span class="nv">chmod</span><span class="w"> </span><span class="nv">g</span><span class="o">+</span><span class="nv">s</span><span class="w"> </span><span class="s1">'{}'</span><span class="w"> </span><span class="o">+</span>
</pre></div>

<p>Note if you want everyone to be able to modify the repository, you don't need
the <code>chgrp</code> and you will want to change the chmod to <code>sudo chmod -R a+rwX .</code></p>
<p>If you do not fix the underlying cause, the error will keep coming back and
you'll have to keep re-running the above commands over and over again.</p>
<h3>Underlying Causes</h3>
<p>The error could be caused by one of the following:</p>
<ul>
<li>The repository isn't configured to be a shared repository (see <code>core.sharedRepository</code> in <code>git help config</code>). If the output of:<div class="code"><pre class="code literal-block"> git config core.sharedRepository
</pre></div>

</li>
</ul>
<p>is not <code>group</code> or <code>true</code> or <code>1</code> or some mask, try running:</p>
<div class="code"><pre class="code literal-block">     git config core.sharedRepository group
</pre></div>

<p>and then re-run the recursive <code>chmod</code> and <code>chgrp</code> (see "Repair Permissions"
above).</p>
<ul>
<li>The operating system doesn't interpret a setgid bit on directories as "all new files and subdirectories should inherit the group owner".</li>
</ul>
<p>When <code>core.sharedRepository</code> is <code>true</code> or <code>group</code>, Git relies on a feature of
GNU operating systems (e.g., every Linux distribution) to ensure that newly
created subdirectories are owned by the correct group (the group that all of
the repository's users are in). This feature is documented in the GNU
coreutils documentation:</p>
<blockquote>
<p>... [If] a directory's set-group-ID bit is set, newly created subfiles
inherit the same group as the directory, and newly created subdirectories
inherit the set-group-ID bit of the parent directory. ... [This mechanism
lets] users share files more easily, by lessening the need to use <code>chmod</code> or
<code>chown</code> to share new files.</p>
</blockquote>
<p>However, not all operating systems have this feature (NetBSD is one example).
For those operating systems, you should make sure that all of your Git users
have the same default group. Alternatively, you can make the repository world-
writable by running <code>git config core.sharedRepository world</code> (but be
careful—this is less secure).</p>
<ul>
<li>
<p>The file system doesn't support the setgid bit (e.g., FAT). ext2, ext3, ext4 all support the setgid bit. As far as I know, the file systems that don't support the setgid bit also don't support the concept of group ownership so all files and directories will be owned by the same group anyway (which group is a mount option). In this case, make sure all Git users are in the group that owns all the files in the file system.</p>
</li>
<li>
<p>Not all of the Git users are in the same group that owns the repository directories. Make sure the group owner on the directories is correct and that all users are in that group.</p>
</li>
</ul>
<p><br></p>
<h3>Suggest</h3>
<p>For Ubuntu (or any Linux)</p>
<p>From project root,</p>
<div class="code"><pre class="code literal-block">cd .git/objects
ls -al
sudo chown -R yourname:yourgroup *
</pre></div>

<p>You can tell yourname and yourgroup by:</p>
<div class="code"><pre class="code literal-block">#<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">yourname</span>
<span class="nv">whoami</span>
#<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">yourgroup</span>
<span class="nv">id</span><span class="w"> </span><span class="o">-</span><span class="nv">g</span><span class="w"> </span><span class="o">-</span><span class="nv">n</span><span class="w"> </span><span class="o">&lt;</span><span class="nv">yourname</span><span class="o">&gt;</span>
</pre></div>

<p>Note: remember the star at the end of the sudo line</p>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/git/" rel="tag">git</a></li>
            <li><a class="tag p-category" href="../../categories/push/" rel="tag">push</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../getting-started-with-haskell/" rel="prev" title="Getting started with Haskell">Previous post</a>
            </li>
            <li class="next">
                <a href="../using-linq-to-remove-elements-from-a-list-t/" rel="next" title="Using LINQ to remove elements from a List&lt;T&gt;">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="../../assets/js/search.js"></script>
</body>
</html>
