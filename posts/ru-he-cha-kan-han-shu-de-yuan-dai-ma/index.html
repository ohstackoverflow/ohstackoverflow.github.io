<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>如何查看函数的源代码？ | StackOverflow Snapshot</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/posts/ru-he-cha-kan-han-shu-de-yuan-dai-ma/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Arya">
<link rel="prev" href="../cong-fu-ye-mian-diao-yong-iframe-zhong-de-javascript-dai-ma/" title="从父页面调用 iframe 中的 JavaScript 代码" type="text/html">
<link rel="next" href="../wei-shi-yao-git-mo-ren-zhi-xing-kuai-jin-he-bing/" title="为什么 git 默认执行快进合并？" type="text/html">
<meta property="og:site_name" content="StackOverflow Snapshot">
<meta property="og:title" content="如何查看函数的源代码？">
<meta property="og:url" content="https://ohstackoverflow.netlify.app/posts/ru-he-cha-kan-han-shu-de-yuan-dai-ma/">
<meta property="og:description" content='我想查看一个函数的源代码，看看它是如何工作的。我知道我可以通过在提示符下输入函数名称来打印函数：
&gt; t
function (x) 
UseMethod("t")
&lt;bytecode: 0x2332948&gt;
&lt;environment: namespace:base&gt;


在这种情况下，什么UseMethod("t")意思？我如何找到实际使用的源代码，例如：t(1:10)？
UseMethod当我看'>
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-02-17T19:28:23+08:00">
<meta property="article:tag" content="debugging">
<meta property="article:tag" content="function">
<meta property="article:tag" content="r">
<meta property="article:tag" content="r-faq">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">如何查看函数的源代码？</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2023-02-17T19:28:23+08:00" itemprop="datePublished" title="2023-02-17 19:28">2023-02-17 19:28</time></a>
            </p>
            

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>我想查看一个函数的源代码，看看它是如何工作的。我知道我可以通过在提示符下输入函数名称来打印函数：</p>
<div class="code"><pre class="code literal-block">&gt; t
function (x) 
UseMethod("t")
&lt;bytecode: 0x2332948&gt;
&lt;environment: namespace:base&gt;
</pre></div>

<p>在这种情况下，什么<code>UseMethod("t")</code>意思？我如何找到实际使用的源代码，例如：<code>t(1:10)</code>？</p>
<p><code>UseMethod</code>当我看到和当我看到<code>standardGeneric</code>和<code>showMethods</code>时有区别吗<code>with</code>？</p>
<div class="code"><pre class="code literal-block"><span class="o">&gt;</span><span class="w"> </span><span class="nv">with</span>
<span class="nv">standardGeneric</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="s2">"with"</span><span class="w"> </span><span class="nv">defined</span><span class="w"> </span><span class="nv">from</span><span class="w"> </span><span class="nv">package</span><span class="w"> </span><span class="s2">"base"</span>

<span class="nv">function</span><span class="w"> </span><span class="ss">(</span><span class="nv">data</span>,<span class="w"> </span><span class="nv">expr</span>,<span class="w"> </span>...<span class="ss">)</span><span class="w"> </span>
<span class="nv">standardGeneric</span><span class="ss">(</span><span class="s2">"with"</span><span class="ss">)</span>
<span class="o">&lt;</span><span class="nv">bytecode</span>:<span class="w"> </span><span class="mi">0</span><span class="nv">x102fb3fc0</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="nv">environment</span>:<span class="w"> </span><span class="mi">0</span><span class="nv">x102fab988</span><span class="o">&gt;</span>
<span class="nv">Methods</span><span class="w"> </span><span class="nv">may</span><span class="w"> </span><span class="nv">be</span><span class="w"> </span><span class="nv">defined</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">arguments</span>:<span class="w"> </span><span class="nv">data</span>
<span class="nv">Use</span><span class="w">  </span><span class="nv">showMethods</span><span class="ss">(</span><span class="s2">"with"</span><span class="ss">)</span><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="nv">currently</span><span class="w"> </span><span class="nv">available</span><span class="w"> </span><span class="nv">ones</span>.
</pre></div>

<p>在其他情况下，我可以看到正在调用 R 函数，但我找不到这些函数的源代码。</p>
<div class="code"><pre class="code literal-block"><span class="err">&gt;</span><span class="w"> </span><span class="nf">ts.union</span>
<span class="nf">function</span><span class="w"> </span><span class="p">(...,</span><span class="w"> </span><span class="no">dframe</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="no">FALSE</span><span class="p">)</span><span class="w"> </span>
<span class="no">.cbind.ts</span><span class="p">(</span><span class="no">list</span><span class="p">(...),</span><span class="w"> </span><span class="no">.makeNamesTs</span><span class="p">(...),</span><span class="w"> </span><span class="no">dframe</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="no">dframe</span><span class="p">,</span><span class="w"> </span><span class="no">union</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="no">TRUE</span><span class="p">)</span>
<span class="err">&lt;</span><span class="nl">bytecode:</span><span class="w"> </span><span class="err">0</span><span class="nf">x36fbf88</span><span class="err">&gt;</span>
<span class="err">&lt;</span><span class="nl">environment:</span><span class="w"> </span><span class="nl">namespace:</span><span class="nf">stats</span><span class="err">&gt;</span>
<span class="err">&gt;</span><span class="w"> </span><span class="na">.cbindts</span>
<span class="nl">Error:</span><span class="w"> </span><span class="nf">object</span><span class="w"> </span><span class="err">'</span><span class="no">.cbindts</span><span class="err">'</span><span class="w"> </span><span class="no">not</span><span class="w"> </span><span class="no">found</span>
<span class="err">&gt;</span><span class="w"> </span><span class="na">.makeNamesTs</span>
<span class="nl">Error:</span><span class="w"> </span><span class="nf">object</span><span class="w"> </span><span class="err">'</span><span class="no">.makeNamesTs</span><span class="err">'</span><span class="w"> </span><span class="no">not</span><span class="w"> </span><span class="no">found</span>
</pre></div>

<p>我如何找到像<code>.cbindts</code>和这样的功能<code>.makeNamesTs</code>？</p>
<p>在其他情况下，有一些 R 代码，但大部分工作似乎是在其他地方完成的。</p>
<div class="code"><pre class="code literal-block"><span class="o">&gt;</span><span class="w"> </span><span class="n">matrix</span>
<span class="nf">function </span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">ncol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">byrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">dimnames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span><span class="p">)</span><span class="w"> </span>
<span class="p">{</span>
<span class="w">    </span><span class="nf">if </span><span class="p">(</span><span class="nf">is.object</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">!</span><span class="nf">is.atomic</span><span class="p">(</span><span class="n">data</span><span class="p">))</span><span class="w"> </span>
<span class="w">        </span><span class="n">data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.vector</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="w">    </span><span class="nf">.Internal</span><span class="p">(</span><span class="nf">matrix</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">nrow</span><span class="p">,</span><span class="w"> </span><span class="n">ncol</span><span class="p">,</span><span class="w"> </span><span class="n">byrow</span><span class="p">,</span><span class="w"> </span><span class="n">dimnames</span><span class="p">,</span><span class="w"> </span><span class="nf">missing</span><span class="p">(</span><span class="n">nrow</span><span class="p">),</span><span class="w"> </span>
<span class="w">        </span><span class="nf">missing</span><span class="p">(</span><span class="n">ncol</span><span class="p">)))</span>
<span class="p">}</span>
<span class="o">&lt;</span><span class="n">bytecode</span><span class="o">:</span><span class="w"> </span><span class="mh">0x134bd10</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">environment</span><span class="o">:</span><span class="w"> </span><span class="n">namespace</span><span class="o">:</span><span class="n">base</span><span class="o">&gt;</span>
<span class="o">&gt;</span><span class="w"> </span><span class="n">.Internal</span>
<span class="nf">function </span><span class="p">(</span><span class="n">call</span><span class="p">)</span><span class="w">  </span><span class="nf">.Primitive</span><span class="p">(</span><span class="s">".Internal"</span><span class="p">)</span>
<span class="o">&gt;</span><span class="w"> </span><span class="n">.Primitive</span>
<span class="nf">function </span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="w">  </span><span class="nf">.Primitive</span><span class="p">(</span><span class="s">".Primitive"</span><span class="p">)</span>
</pre></div>

<p>我如何找出函数的作用<code>.Primitive</code>？同样，一些函数调用<code>.C</code>、<code>.Call</code>、<code>.Fortran</code>、<code>.External</code>或<code>.Internal</code>。我怎样才能找到那些的源代码？</p>
<p><br><br></p>
<h2>解答</h2>
<p><code>UseMethod("t")</code>告诉您这<code>t()</code>是一个 ( S3 ) 泛型函数，它具有针对不同对象类的方法。</p>
<h2>S3方法调度系统</h2>
<p>对于 S3 类，您可以使用<code>methods</code>函数列出特定通用函数或类的方法。</p>
<div class="code"><pre class="code literal-block"><span class="o">&gt;</span><span class="w"> </span><span class="nf">methods</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="n">t.data.frame</span><span class="w"> </span><span class="n">t.default</span><span class="w">    </span><span class="n">t.ts</span><span class="o">*</span>

<span class="w">   </span><span class="n">Non</span><span class="o">-</span><span class="n">visible</span><span class="w"> </span><span class="n">functions</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">asterisked</span>
<span class="o">&gt;</span><span class="w"> </span><span class="nf">methods</span><span class="p">(</span><span class="n">class</span><span class="o">=</span><span class="s">"ts"</span><span class="p">)</span>
<span class="w"> </span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="n">aggregate.ts</span><span class="w">     </span><span class="n">as.data.frame.ts</span><span class="w"> </span><span class="n">cbind.ts</span><span class="o">*</span><span class="w">        </span><span class="n">cycle.ts</span><span class="o">*</span><span class="w">       </span>
<span class="w"> </span><span class="p">[</span><span class="m">5</span><span class="p">]</span><span class="w"> </span><span class="n">diffinv.ts</span><span class="o">*</span><span class="w">      </span><span class="n">diff.ts</span><span class="w">          </span><span class="n">kernapply.ts</span><span class="o">*</span><span class="w">    </span><span class="n">lines.ts</span><span class="w">        </span>
<span class="w"> </span><span class="p">[</span><span class="m">9</span><span class="p">]</span><span class="w"> </span><span class="n">monthplot.ts</span><span class="o">*</span><span class="w">    </span><span class="n">na.omit.ts</span><span class="o">*</span><span class="w">      </span><span class="n">Ops.ts</span><span class="o">*</span><span class="w">          </span><span class="n">plot.ts</span><span class="w">         </span>
<span class="p">[</span><span class="m">13</span><span class="p">]</span><span class="w"> </span><span class="n">print.ts</span><span class="w">         </span><span class="n">time.ts</span><span class="o">*</span><span class="w">         </span><span class="p">[</span><span class="o">&lt;-</span><span class="n">.ts</span><span class="o">*</span><span class="w">          </span><span class="p">[</span><span class="n">.ts</span><span class="o">*</span><span class="w">           </span>
<span class="p">[</span><span class="m">17</span><span class="p">]</span><span class="w"> </span><span class="n">t.ts</span><span class="o">*</span><span class="w">            </span><span class="n">window</span><span class="o">&lt;-</span><span class="n">.ts</span><span class="o">*</span><span class="w">     </span><span class="n">window.ts</span><span class="o">*</span>

<span class="w">   </span><span class="n">Non</span><span class="o">-</span><span class="n">visible</span><span class="w"> </span><span class="n">functions</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">asterisked</span>
</pre></div>

<p>“不可见函数带有星号”表示该函数未从其包的命名空间中导出。您仍然可以通过函数<code>:::</code>（即<code>stats:::t.ts</code>）或使用<code>getAnywhere()</code>.
<code>getAnywhere()</code>很有用，因为您不必知道函数来自哪个包。</p>
<div class="code"><pre class="code literal-block"><span class="o">&gt;</span><span class="w"> </span><span class="n">getAnywhere</span><span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="n">ts</span><span class="p">)</span>
<span class="n">A</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="k">object</span><span class="w"> </span><span class="n">matching</span><span class="w"> </span><span class="err">‘</span><span class="n">t</span><span class="p">.</span><span class="n">ts</span><span class="err">’</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="k">found</span>
<span class="n">It</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="k">found</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="n">places</span>
<span class="w">  </span><span class="n">registered</span><span class="w"> </span><span class="n">S3</span><span class="w"> </span><span class="k">method</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">namespace</span><span class="w"> </span><span class="n">stats</span>
<span class="w">  </span><span class="nl">namespace</span><span class="p">:</span><span class="n">stats</span>
<span class="k">with</span><span class="w"> </span><span class="k">value</span>

<span class="k">function</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span>
<span class="err">{</span>
<span class="w">    </span><span class="n">cl</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">oldClass</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="w">    </span><span class="n">other</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="err">!</span><span class="p">(</span><span class="n">cl</span><span class="w"> </span><span class="o">%</span><span class="ow">in</span><span class="o">%</span><span class="w"> </span><span class="n">c</span><span class="p">(</span><span class="ss">"ts"</span><span class="p">,</span><span class="w"> </span><span class="ss">"mts"</span><span class="p">))</span>
<span class="w">    </span><span class="k">class</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">any</span><span class="p">(</span><span class="n">other</span><span class="p">))</span><span class="w"> </span>
<span class="w">        </span><span class="n">cl</span><span class="o">[</span><span class="n">other</span><span class="o">]</span>
<span class="w">    </span><span class="n">attr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="ss">"tsp"</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">NULL</span>
<span class="w">    </span><span class="n">t</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="err">}</span>
<span class="o">&lt;</span><span class="nl">bytecode</span><span class="p">:</span><span class="w"> </span><span class="mh">0x294e410</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="nl">environment</span><span class="p">:</span><span class="w"> </span><span class="nl">namespace</span><span class="p">:</span><span class="n">stats</span><span class="o">&gt;</span>
</pre></div>

<h2>S4方法调度系统</h2>
<p>S4系统是较新的方法调度系统，是S3系统的替代品。以下是 S4 函数的示例：</p>
<div class="code"><pre class="code literal-block"><span class="o">&gt;</span><span class="w"> </span><span class="nv">library</span><span class="ss">(</span><span class="nv">Matrix</span><span class="ss">)</span>
<span class="nv">Loading</span><span class="w"> </span><span class="nv">required</span><span class="w"> </span><span class="nv">package</span>:<span class="w"> </span><span class="nv">lattice</span>
<span class="o">&gt;</span><span class="w"> </span><span class="nv">chol2inv</span>
<span class="nv">standardGeneric</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="s2">"chol2inv"</span><span class="w"> </span><span class="nv">defined</span><span class="w"> </span><span class="nv">from</span><span class="w"> </span><span class="nv">package</span><span class="w"> </span><span class="s2">"base"</span>

<span class="nv">function</span><span class="w"> </span><span class="ss">(</span><span class="nv">x</span>,<span class="w"> </span>...<span class="ss">)</span><span class="w"> </span>
<span class="nv">standardGeneric</span><span class="ss">(</span><span class="s2">"chol2inv"</span><span class="ss">)</span>
<span class="o">&lt;</span><span class="nv">bytecode</span>:<span class="w"> </span><span class="mi">0</span><span class="nv">x000000000eafd790</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="nv">environment</span>:<span class="w"> </span><span class="mi">0</span><span class="nv">x000000000eb06f10</span><span class="o">&gt;</span>
<span class="nv">Methods</span><span class="w"> </span><span class="nv">may</span><span class="w"> </span><span class="nv">be</span><span class="w"> </span><span class="nv">defined</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">arguments</span>:<span class="w"> </span><span class="nv">x</span>
<span class="nv">Use</span><span class="w">  </span><span class="nv">showMethods</span><span class="ss">(</span><span class="s2">"chol2inv"</span><span class="ss">)</span><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="nv">currently</span><span class="w"> </span><span class="nv">available</span><span class="w"> </span><span class="nv">ones</span>.
</pre></div>

<p>输出已经提供了大量信息。<code>standardGeneric</code>是 S4 功能的指标。提供查看已定义 S4 方法的方法很有帮助：</p>
<div class="code"><pre class="code literal-block">&gt; showMethods(chol2inv)
Function: chol2inv (package base)
x="ANY"
x="CHMfactor"
x="denseMatrix"
x="diagonalMatrix"
x="dtrMatrix"
x="sparseMatrix"
</pre></div>

<p><code>getMethod</code>可以用来查看其中一种方法的源代码：</p>
<div class="code"><pre class="code literal-block">&gt; getMethod("chol2inv", "diagonalMatrix")
Method Definition:

function (x, ...) 
{
    chk.s(...)
    tcrossprod(solve(x))
}
&lt;bytecode: 0x000000000ea2cc70&gt;
&lt;environment: namespace:Matrix&gt;

Signatures:
        x               
target  "diagonalMatrix"
defined "diagonalMatrix"
</pre></div>

<p>还有一些方法，每个方法都有更复杂的签名，例如</p>
<div class="code"><pre class="code literal-block">require(raster)
showMethods(extract)
Function: extract (package raster)
x="Raster", y="data.frame"
x="Raster", y="Extent"
x="Raster", y="matrix"
x="Raster", y="SpatialLines"
x="Raster", y="SpatialPoints"
x="Raster", y="SpatialPolygons"
x="Raster", y="vector"
</pre></div>

<p>要查看这些方法之一的源代码，必须提供整个签名，例如</p>
<div class="code"><pre class="code literal-block">getMethod("extract" , signature = c( x = "Raster" , y = "SpatialPolygons") )
</pre></div>

<p>仅提供部分签名是不够的</p>
<div class="code"><pre class="code literal-block"><span class="nv">getMethod</span><span class="ss">(</span><span class="s2">"extract"</span>,<span class="nv">signature</span><span class="o">=</span><span class="s2">"SpatialPolygons"</span><span class="ss">)</span>
#<span class="nv">Error</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">getMethod</span><span class="ss">(</span><span class="s2">"extract"</span>,<span class="w"> </span><span class="nv">signature</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"SpatialPolygons"</span><span class="ss">)</span><span class="w"> </span>:<span class="w"> </span>
#<span class="w">  </span><span class="nv">No</span><span class="w"> </span><span class="nv">method</span><span class="w"> </span><span class="nv">found</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">function</span><span class="w"> </span><span class="s2">"extract"</span><span class="w"> </span><span class="nv">and</span><span class="w"> </span><span class="nv">signature</span><span class="w"> </span><span class="nv">SpatialPolygons</span>
</pre></div>

<h2>调用未导出函数的函数</h2>
<p>对于<code>ts.union</code>,<code>.cbindts</code>和<code>.makeNamesTs</code>是命名空间中未导出的函数<code>stats</code>。您可以使用<code>:::</code>运算符或查看未导出函数的源代码<code>getAnywhere</code>。</p>
<div class="code"><pre class="code literal-block"><span class="o">&gt;</span><span class="w"> </span><span class="nl">stats</span><span class="p">:</span><span class="o">::</span><span class="p">.</span><span class="n">makeNamesTs</span>
<span class="k">function</span><span class="w"> </span><span class="p">(...)</span><span class="w"> </span>
<span class="err">{</span>
<span class="w">    </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">as</span><span class="p">.</span><span class="n">list</span><span class="p">(</span><span class="n">substitute</span><span class="p">(</span><span class="n">list</span><span class="p">(...)))</span><span class="o">[</span><span class="n">-1L</span><span class="o">]</span>
<span class="w">    </span><span class="n">nm</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">names</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="w">    </span><span class="n">fixup</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">is</span><span class="p">.</span><span class="k">null</span><span class="p">(</span><span class="n">nm</span><span class="p">))</span><span class="w"> </span>
<span class="w">        </span><span class="n">seq_along</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="n">nm</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="ss">""</span>
<span class="w">    </span><span class="n">dep</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sapply</span><span class="p">(</span><span class="n">l</span><span class="o">[</span><span class="n">fixup</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="n">deparse</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">[</span><span class="n">1L</span><span class="o">]</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">is</span><span class="p">.</span><span class="k">null</span><span class="p">(</span><span class="n">nm</span><span class="p">))</span><span class="w"> </span>
<span class="w">        </span><span class="k">return</span><span class="p">(</span><span class="n">dep</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">any</span><span class="p">(</span><span class="n">fixup</span><span class="p">))</span><span class="w"> </span>
<span class="w">        </span><span class="n">nm</span><span class="o">[</span><span class="n">fixup</span><span class="o">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dep</span>
<span class="w">    </span><span class="n">nm</span>
<span class="err">}</span>
<span class="o">&lt;</span><span class="nl">bytecode</span><span class="p">:</span><span class="w"> </span><span class="mh">0x38140d0</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="nl">environment</span><span class="p">:</span><span class="w"> </span><span class="nl">namespace</span><span class="p">:</span><span class="n">stats</span><span class="o">&gt;</span>
</pre></div>

<h2>调用编译代码的函数</h2>
<p>请注意，“已编译”不是指由 <strong>编译器</strong> 包创建的字节编译 R 代码。上面输出中的一行<code>&lt;bytecode:
0x294e410&gt;</code>表明该函数是字节编译的，您仍然可以从 R 命令行查看源代码。</p>
<p>Functions that call <code>.C</code>, <code>.Call</code>, <code>.Fortran</code>, <code>.External</code>, <code>.Internal</code>, or
<code>.Primitive</code> are calling entry points in compiled code, so you will have to
look at sources of the compiled code if you want to fully understand the
function. This GitHub mirror of the R source code is a decent place to start.
The function <code>pryr::show_c_source</code> can be a useful tool as it will take you
directly to a GitHub page for <code>.Internal</code> and <code>.Primitive</code> calls. Packages may
use <code>.C</code>, <code>.Call</code>, <code>.Fortran</code>, and <code>.External</code>; but not <code>.Internal</code> or
<code>.Primitive</code>, because these are used to call functions built into the R
interpreter.</p>
<p>Calls to some of the above functions may use an object instead of a character
string to reference the compiled function. In those cases, the object is of
class <code>"NativeSymbolInfo"</code>, <code>"RegisteredNativeSymbol"</code>, or <code>"NativeSymbol"</code>;
and printing the object yields useful information. For example, <code>optim</code> calls
<code>.External2(C_optimhess, res$par, fn1, gr1, con)</code> (note that's <code>C_optimhess</code>,
not <code>"C_optimhess"</code>). <code>optim</code> is in the stats package, so you can type
<code>stats:::C_optimhess</code> to see information about the compiled function being
called.</p>
<h3>Compiled code in a package</h3>
<p>If you want to view compiled code in a package, you will need to
download/unpack the package source. The installed binaries are not sufficient.
A package's source code is available from the same CRAN (or CRAN compatible)
repository that the package was originally installed from. The
<code>download.packages()</code> function can get the package source for you.</p>
<div class="code"><pre class="code literal-block"><span class="n">download</span><span class="o">.</span><span class="n">packages</span><span class="p">(</span><span class="n">pkgs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Matrix"</span><span class="p">,</span><span class="w"> </span>
<span class="w">                  </span><span class="n">destdir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"."</span><span class="p">,</span>
<span class="w">                  </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"source"</span><span class="p">)</span>
</pre></div>

<p>This will download the source version of the Matrix package and save the
corresponding <code>.tar.gz</code> file in the current directory. Source code for
compiled functions can be found in the <code>src</code> directory of the uncompressed and
untared file. The uncompressing and untaring step can be done outside of <code>R</code>,
or from within <code>R</code> using the <code>untar()</code> function. It is possible to combine the
download and expansion step into a single call (note that only one package at
a time can be downloaded and unpacked in this way):</p>
<div class="code"><pre class="code literal-block"><span class="n">untar</span><span class="p">(</span><span class="n">download</span><span class="o">.</span><span class="n">packages</span><span class="p">(</span><span class="n">pkgs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Matrix"</span><span class="p">,</span>
<span class="w">                        </span><span class="n">destdir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"."</span><span class="p">,</span>
<span class="w">                        </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"source"</span><span class="p">)[,</span><span class="mi">2</span><span class="p">])</span>
</pre></div>

<p>Alternatively, if the package development is hosted publicly (e.g. via GitHub,
R-Forge, or RForge.net), you can probably browse the source code online.</p>
<h3>Compiled code in a base package</h3>
<p>Certain packages are considered "base" packages. These packages ship with R
and their version is locked to the version of R. Examples include <code>base</code>,
<code>compiler</code>, <code>stats</code>, and <code>utils</code>. As such, they are not available as separate
downloadable packages on CRAN as described above. Rather, they are part of the
R source tree in individual package directories under <code>/src/library/</code>. How to
access the R source is described in the next section.</p>
<h3>Compiled code built into the R interpreter</h3>
<p>If you want to view the code built-in to the R interpreter, you will need to
download/unpack the R sources; or you can view the sources online via the R
Subversion repository or Winston Chang's github mirror.</p>
<p>Uwe Ligges 的R 新闻文章 (PDF)（第 43
页）是有关如何查看<code>.Internal</code>和函数源代码的很好的一般参考<code>.Primitive</code>。基本步骤是先在
中查找函数名<code>src/main/names.c</code>，然后在<code>src/main/*</code>.</p>
<p><br></p>
<h3>更多建议</h3>
<p>除了关于这个问题及其重复项的其他答案之外，这里还有一个很好的方法来获取包函数的源代码，而无需知道它在哪个包中。例如，如果我们想要源代码<code>randomForest::rfcv()</code>：</p>
<h4>要在弹出窗口中 <strong>查看/编辑它：</strong>
</h4>
<div class="code"><pre class="code literal-block">edit(getAnywhere('rfcv'), file='source_rfcv.r')

View(getAnywhere('rfcv'), file='source_rfcv.r')
</pre></div>

<p>请注意，<code>edit()</code>打开文本编辑器（用户选择），而<code>View()</code>调用电子表格样式的数据查看器。</p>
<ul>
<li>
<code>View()</code>非常适合浏览（多列） <strong>数据</strong> ，但对于玩具长度以外的任何 <strong>代码通常都很糟糕。</strong>
</li>
<li>所以当只想查看 <strong>代码</strong> 时，<code>edit()</code>IMO 实际上比 好得多<code>View()</code>，因为有了它，<code>edit()</code>您可以折叠/隐藏/模拟所有 arg-parsing/checking/default/error-message 逻辑，这些逻辑可能占 R 函数的 70% ，然后到达函数实际操作的部分（！），它的返回类型是什么类型的对象，它是否递归以及如何递归等。</li>
</ul>
<h4>要 <strong>重定向到一个单独的文件</strong> （这样你就可以在你最喜欢的 IDE/编辑器中调出代码/使用 grep/等处理它）：</h4>
<div class="code"><pre class="code literal-block">capture.output(getAnywhere('rfcv'), file='source_rfcv.r')
</pre></div>

<p><br><br><a href="../how-can-i-view-the-source-code-for-a-function/">查看原文</a></p>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/debugging/" rel="tag">debugging</a></li>
            <li><a class="tag p-category" href="../../categories/function/" rel="tag">function</a></li>
            <li><a class="tag p-category" href="../../categories/r/" rel="tag">r</a></li>
            <li><a class="tag p-category" href="../../categories/r-faq/" rel="tag">r-faq</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../cong-fu-ye-mian-diao-yong-iframe-zhong-de-javascript-dai-ma/" rel="prev" title="从父页面调用 iframe 中的 JavaScript 代码">Previous post</a>
            </li>
            <li class="next">
                <a href="../wei-shi-yao-git-mo-ren-zhi-xing-kuai-jin-he-bing/" rel="next" title="为什么 git 默认执行快进合并？">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow-ZH</a>  
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="../../assets/js/search.js"></script>
</body>
</html>
