<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>How to pretty print XML from Java? | StackOverflow Snapshot</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://ohstackoverflow.netlify.app/posts/how-to-pretty-print-xml-from-java/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Arya">
<link rel="prev" href="../non-greedy-reluctant-regex-matching-in-sed/" title="Non greedy (reluctant) regex matching in sed?" type="text/html">
<link rel="next" href="../how-can-i-do-three-table-joins-in-an-update-query/" title="How can I do three table JOINs in an UPDATE query?" type="text/html">
<meta property="og:site_name" content="StackOverflow Snapshot">
<meta property="og:title" content="How to pretty print XML from Java?">
<meta property="og:url" content="https://ohstackoverflow.netlify.app/posts/how-to-pretty-print-xml-from-java/">
<meta property="og:description" content='I have a Java String that contains XML, with no line feeds or indentations. I
would like to turn it into a String with nicely formatted XML. How do I do
this?
String unformattedXml = "&lt;tag&gt;&lt;nested&gt;hel'>
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-03-03T06:11:55+08:00">
<meta property="article:tag" content="java">
<meta property="article:tag" content="pretty-print">
<meta property="article:tag" content="xml">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ohstackoverflow.netlify.app/">

                <span id="blog-title">StackOverflow Snapshot</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<div style="display:table;min-height:5rem;min-width:27rem;">
					<div class="input-group" style="display: table-cell;vertical-align: middle;">
						<input id="words" type="text" class="form-control" style="max-width:22rem;" onkeydown="if(event.keyCode==13){btn.click()}"><span class="input-group-btn" style="float:left">
							<button id="btn" class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
								<span class="glyphicon glyphicon-search">
							</span></button>
						</span>
					</div>
<!-- /input-group -->
				</div>

				
                
                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><!-- 模态框（Modal） --><div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					查找结果
				</h4>
			</div>
			<div class="modal-body">
				<div id="search-count" style="min-height:4rem;">
				查找中，请稍后...
				</div>
				<div id="search-result">
				</div>

				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">
					关闭
				</button>
			</div>
		</div>
<!-- /.modal-content -->
	</div>
<!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">How to pretty print XML from Java?</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../authors/arya/">Arya</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2023-03-03T06:11:55+08:00" itemprop="datePublished" title="2023-03-03 06:11">2023-03-03 06:11</time></a>
            </p>
            

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>I have a Java String that contains XML, with no line feeds or indentations. I
would like to turn it into a String with nicely formatted XML. How do I do
this?</p>
<div class="code"><pre class="code literal-block"><span class="n">String</span><span class="w"> </span><span class="n">unformattedXml</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">"&lt;tag&gt;&lt;nested&gt;hello&lt;/nested&gt;&lt;/tag&gt;"</span><span class="p">;</span>
<span class="n">String</span><span class="w"> </span><span class="n">formattedXml</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="o">[</span><span class="n">UnknownClass</span><span class="o">]</span><span class="p">().</span><span class="nf">format</span><span class="p">(</span><span class="n">unformattedXml</span><span class="p">);</span>
</pre></div>

<p>Note: My input is a <strong>String</strong>. My output is a <strong>String</strong>.</p>
<p>(Basic) mock result:</p>
<div class="code"><pre class="code literal-block"><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;root&gt;</span>
<span class="w">  </span><span class="nt">&lt;tag&gt;</span>
<span class="w">    </span><span class="nt">&lt;nested&gt;</span>hello<span class="nt">&lt;/nested&gt;</span>
<span class="w">  </span><span class="nt">&lt;/tag&gt;</span>
<span class="nt">&lt;/root&gt;</span>
</pre></div>

<p><br><br></p>
<h2>Answer</h2>
<p>Now it's 2012 and Java can do more than it used to with XML, I'd like to add
an alternative to my accepted answer. This has no dependencies outside of Java
6.</p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="nn">org.w3c.dom.Node</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.w3c.dom.bootstrap.DOMImplementationRegistry</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.w3c.dom.ls.DOMImplementationLS</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.w3c.dom.ls.LSSerializer</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.xml.sax.InputSource</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">javax.xml.parsers.DocumentBuilderFactory</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.io.StringReader</span><span class="p">;</span>

<span class="o">/**</span>
 <span class="o">*</span> <span class="n">Pretty</span><span class="o">-</span><span class="n">prints</span> <span class="n">xml</span><span class="p">,</span> <span class="n">supplied</span> <span class="k">as</span> <span class="n">a</span> <span class="n">string</span><span class="o">.</span>
 <span class="o">*</span> <span class="o">&lt;</span><span class="n">p</span><span class="o">/&gt;</span>
 <span class="o">*</span> <span class="n">eg</span><span class="o">.</span>
 <span class="o">*</span> <span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span>
 <span class="o">*</span> <span class="n">String</span> <span class="n">formattedXml</span> <span class="o">=</span> <span class="n">new</span> <span class="n">XmlFormatter</span><span class="p">()</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"&lt;tag&gt;&lt;nested&gt;hello&lt;/nested&gt;&lt;/tag&gt;"</span><span class="p">);</span>
 <span class="o">*</span> <span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;</span>
 <span class="o">*/</span>
<span class="n">public</span> <span class="k">class</span> <span class="nc">XmlFormatter</span> <span class="p">{</span>

    <span class="n">public</span> <span class="n">String</span> <span class="nb">format</span><span class="p">(</span><span class="n">String</span> <span class="n">xml</span><span class="p">)</span> <span class="p">{</span>

        <span class="k">try</span> <span class="p">{</span>
            <span class="n">final</span> <span class="n">InputSource</span> <span class="n">src</span> <span class="o">=</span> <span class="n">new</span> <span class="n">InputSource</span><span class="p">(</span><span class="n">new</span> <span class="n">StringReader</span><span class="p">(</span><span class="n">xml</span><span class="p">));</span>
            <span class="n">final</span> <span class="n">Node</span> <span class="n">document</span> <span class="o">=</span> <span class="n">DocumentBuilderFactory</span><span class="o">.</span><span class="n">newInstance</span><span class="p">()</span><span class="o">.</span><span class="n">newDocumentBuilder</span><span class="p">()</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="o">.</span><span class="n">getDocumentElement</span><span class="p">();</span>
            <span class="n">final</span> <span class="n">Boolean</span> <span class="n">keepDeclaration</span> <span class="o">=</span> <span class="n">Boolean</span><span class="o">.</span><span class="n">valueOf</span><span class="p">(</span><span class="n">xml</span><span class="o">.</span><span class="n">startsWith</span><span class="p">(</span><span class="s2">"&lt;?xml"</span><span class="p">));</span>

        <span class="o">//</span><span class="n">May</span> <span class="n">need</span> <span class="n">this</span><span class="p">:</span> <span class="n">System</span><span class="o">.</span><span class="n">setProperty</span><span class="p">(</span><span class="n">DOMImplementationRegistry</span><span class="o">.</span><span class="n">PROPERTY</span><span class="p">,</span><span class="s2">"com.sun.org.apache.xerces.internal.dom.DOMImplementationSourceImpl"</span><span class="p">);</span>


            <span class="n">final</span> <span class="n">DOMImplementationRegistry</span> <span class="n">registry</span> <span class="o">=</span> <span class="n">DOMImplementationRegistry</span><span class="o">.</span><span class="n">newInstance</span><span class="p">();</span>
            <span class="n">final</span> <span class="n">DOMImplementationLS</span> <span class="n">impl</span> <span class="o">=</span> <span class="p">(</span><span class="n">DOMImplementationLS</span><span class="p">)</span> <span class="n">registry</span><span class="o">.</span><span class="n">getDOMImplementation</span><span class="p">(</span><span class="s2">"LS"</span><span class="p">);</span>
            <span class="n">final</span> <span class="n">LSSerializer</span> <span class="n">writer</span> <span class="o">=</span> <span class="n">impl</span><span class="o">.</span><span class="n">createLSSerializer</span><span class="p">();</span>

            <span class="n">writer</span><span class="o">.</span><span class="n">getDomConfig</span><span class="p">()</span><span class="o">.</span><span class="n">setParameter</span><span class="p">(</span><span class="s2">"format-pretty-print"</span><span class="p">,</span> <span class="n">Boolean</span><span class="o">.</span><span class="n">TRUE</span><span class="p">);</span> <span class="o">//</span> <span class="n">Set</span> <span class="n">this</span> <span class="n">to</span> <span class="n">true</span> <span class="k">if</span> <span class="n">the</span> <span class="n">output</span> <span class="n">needs</span> <span class="n">to</span> <span class="n">be</span> <span class="n">beautified</span><span class="o">.</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">getDomConfig</span><span class="p">()</span><span class="o">.</span><span class="n">setParameter</span><span class="p">(</span><span class="s2">"xml-declaration"</span><span class="p">,</span> <span class="n">keepDeclaration</span><span class="p">);</span> <span class="o">//</span> <span class="n">Set</span> <span class="n">this</span> <span class="n">to</span> <span class="n">true</span> <span class="k">if</span> <span class="n">the</span> <span class="n">declaration</span> <span class="ow">is</span> <span class="n">needed</span> <span class="n">to</span> <span class="n">be</span> <span class="n">outputted</span><span class="o">.</span>

            <span class="k">return</span> <span class="n">writer</span><span class="o">.</span><span class="n">writeToString</span><span class="p">(</span><span class="n">document</span><span class="p">);</span>
        <span class="p">}</span> <span class="n">catch</span> <span class="p">(</span><span class="ne">Exception</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">throw</span> <span class="n">new</span> <span class="n">RuntimeException</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="n">public</span> <span class="n">static</span> <span class="n">void</span> <span class="n">main</span><span class="p">(</span><span class="n">String</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">String</span> <span class="n">unformattedXml</span> <span class="o">=</span>
                <span class="s2">"&lt;?xml version=</span><span class="se">\"</span><span class="s2">1.0</span><span class="se">\"</span><span class="s2"> encoding=</span><span class="se">\"</span><span class="s2">UTF-8</span><span class="se">\"</span><span class="s2">?&gt;&lt;QueryMessage</span><span class="se">\n</span><span class="s2">"</span> <span class="o">+</span>
                        <span class="s2">"        xmlns=</span><span class="se">\"</span><span class="s2">http://www.SDMX.org/resources/SDMXML/schemas/v2_0/message</span><span class="se">\"\n</span><span class="s2">"</span> <span class="o">+</span>
                        <span class="s2">"        xmlns:query=</span><span class="se">\"</span><span class="s2">http://www.SDMX.org/resources/SDMXML/schemas/v2_0/query</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span> <span class="o">+</span>
                        <span class="s2">"    &lt;Query&gt;</span><span class="se">\n</span><span class="s2">"</span> <span class="o">+</span>
                        <span class="s2">"        &lt;query:CategorySchemeWhere&gt;</span><span class="se">\n</span><span class="s2">"</span> <span class="o">+</span>
                        <span class="s2">"   </span><span class="se">\t\t\t\t\t</span><span class="s2">         &lt;query:AgencyID&gt;ECB</span><span class="se">\n\n\n\n</span><span class="s2">&lt;/query:AgencyID&gt;</span><span class="se">\n</span><span class="s2">"</span> <span class="o">+</span>
                        <span class="s2">"        &lt;/query:CategorySchemeWhere&gt;</span><span class="se">\n</span><span class="s2">"</span> <span class="o">+</span>
                        <span class="s2">"    &lt;/Query&gt;</span><span class="se">\n\n\n\n\n</span><span class="s2">"</span> <span class="o">+</span>
                        <span class="s2">"&lt;/QueryMessage&gt;"</span><span class="p">;</span>

        <span class="n">System</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">println</span><span class="p">(</span><span class="n">new</span> <span class="n">XmlFormatter</span><span class="p">()</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">unformattedXml</span><span class="p">));</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p><br></p>
<h3>Suggest</h3>
<p>a simpler solution based on this answer:</p>
<div class="code"><pre class="code literal-block"><span class="nv">public</span><span class="w"> </span><span class="nv">static</span><span class="w"> </span><span class="nv">String</span><span class="w"> </span><span class="nv">prettyFormat</span><span class="ss">(</span><span class="nv">String</span><span class="w"> </span><span class="nv">input</span>,<span class="w"> </span><span class="nv">int</span><span class="w"> </span><span class="nv">indent</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">    </span><span class="nv">try</span><span class="w"> </span>{
<span class="w">        </span><span class="nv">Source</span><span class="w"> </span><span class="nv">xmlInput</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">StreamSource</span><span class="ss">(</span><span class="nv">new</span><span class="w"> </span><span class="nv">StringReader</span><span class="ss">(</span><span class="nv">input</span><span class="ss">))</span><span class="c1">;</span>
<span class="w">        </span><span class="nv">StringWriter</span><span class="w"> </span><span class="nv">stringWriter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">StringWriter</span><span class="ss">()</span><span class="c1">;</span>
<span class="w">        </span><span class="nv">StreamResult</span><span class="w"> </span><span class="nv">xmlOutput</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">StreamResult</span><span class="ss">(</span><span class="nv">stringWriter</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">        </span><span class="nv">TransformerFactory</span><span class="w"> </span><span class="nv">transformerFactory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">TransformerFactory</span>.<span class="nv">newInstance</span><span class="ss">()</span><span class="c1">;</span>
<span class="w">        </span><span class="nv">transformerFactory</span>.<span class="nv">setAttribute</span><span class="ss">(</span><span class="s2">"indent-number"</span>,<span class="w"> </span><span class="nv">indent</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">        </span><span class="nv">transformerFactory</span>.<span class="nv">setAttribute</span><span class="ss">(</span><span class="nv">XMLConstants</span>.<span class="nv">ACCESS_EXTERNAL_DTD</span>,<span class="w"> </span><span class="s2">""</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">        </span><span class="nv">transformerFactory</span>.<span class="nv">setAttribute</span><span class="ss">(</span><span class="nv">XMLConstants</span>.<span class="nv">ACCESS_EXTERNAL_STYLESHEET</span>,<span class="w"> </span><span class="s2">""</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">        </span><span class="nv">Transformer</span><span class="w"> </span><span class="nv">transformer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">transformerFactory</span>.<span class="nv">newTransformer</span><span class="ss">()</span><span class="c1">; </span>
<span class="w">        </span><span class="nv">transformer</span>.<span class="nv">setOutputProperty</span><span class="ss">(</span><span class="nv">OutputKeys</span>.<span class="nv">INDENT</span>,<span class="w"> </span><span class="s2">"yes"</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">        </span><span class="nv">transformer</span>.<span class="nv">transform</span><span class="ss">(</span><span class="nv">xmlInput</span>,<span class="w"> </span><span class="nv">xmlOutput</span><span class="ss">)</span><span class="c1">;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nv">xmlOutput</span>.<span class="nv">getWriter</span><span class="ss">()</span>.<span class="nv">toString</span><span class="ss">()</span><span class="c1">;</span>
<span class="w">    </span>}<span class="w"> </span><span class="nv">catch</span><span class="w"> </span><span class="ss">(</span><span class="nv">Exception</span><span class="w"> </span><span class="nv">e</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">        </span><span class="nv">throw</span><span class="w"> </span><span class="nv">new</span><span class="w"> </span><span class="nv">RuntimeException</span><span class="ss">(</span><span class="nv">e</span><span class="ss">)</span><span class="c1">; // simple exception handling, please review it</span>
<span class="w">    </span>}
}

<span class="nv">public</span><span class="w"> </span><span class="nv">static</span><span class="w"> </span><span class="nv">String</span><span class="w"> </span><span class="nv">prettyFormat</span><span class="ss">(</span><span class="nv">String</span><span class="w"> </span><span class="nv">input</span><span class="ss">)</span><span class="w"> </span>{
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nv">prettyFormat</span><span class="ss">(</span><span class="nv">input</span>,<span class="w"> </span><span class="mi">2</span><span class="ss">)</span><span class="c1">;</span>
}
</pre></div>

<p>testcase:</p>
<div class="code"><pre class="code literal-block">prettyFormat("<span class="nt">&lt;root&gt;&lt;child&gt;</span>aaa<span class="nt">&lt;/child&gt;&lt;child/&gt;&lt;/root&gt;</span>");
</pre></div>

<p>returns:</p>
<div class="code"><pre class="code literal-block"><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;root&gt;</span>
<span class="w">  </span><span class="nt">&lt;child&gt;</span>aaa<span class="nt">&lt;/child&gt;</span>
<span class="w">  </span><span class="nt">&lt;child/&gt;</span>
<span class="nt">&lt;/root&gt;</span>
</pre></div>

<p>//Ignore: Original edit just needs missing s in the Class name in code.
redundant six characters added to get over 6 characters validation on SO</p>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/java/" rel="tag">java</a></li>
            <li><a class="tag p-category" href="../../categories/pretty-print/" rel="tag">pretty-print</a></li>
            <li><a class="tag p-category" href="../../categories/xml/" rel="tag">xml</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../non-greedy-reluctant-regex-matching-in-sed/" rel="prev" title="Non greedy (reluctant) regex matching in sed?">Previous post</a>
            </li>
            <li class="next">
                <a href="../how-can-i-do-three-table-joins-in-an-update-query/" rel="next" title="How can I do three table JOINs in an UPDATE query?">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         Go to StackOverflow Chinese Site  <a href="http://stackoverflow.ink">StackOverflow中文网</a>  
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><script src="../../assets/js/search.js"></script>
</body>
</html>
